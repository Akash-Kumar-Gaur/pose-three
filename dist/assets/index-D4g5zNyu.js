(function(){const _=document.createElement("link").relList;if(_&&_.supports&&_.supports("modulepreload"))return;for(const ee of document.querySelectorAll('link[rel="modulepreload"]'))$(ee);new MutationObserver(ee=>{for(const re of ee)if(re.type==="childList")for(const ae of re.addedNodes)ae.tagName==="LINK"&&ae.rel==="modulepreload"&&$(ae)}).observe(document,{childList:!0,subtree:!0});function b(ee){const re={};return ee.integrity&&(re.integrity=ee.integrity),ee.referrerPolicy&&(re.referrerPolicy=ee.referrerPolicy),ee.crossOrigin==="use-credentials"?re.credentials="include":ee.crossOrigin==="anonymous"?re.credentials="omit":re.credentials="same-origin",re}function $(ee){if(ee.ep)return;ee.ep=!0;const re=b(ee);fetch(ee.href,re)}})();function getDefaultExportFromCjs(H){return H&&H.__esModule&&Object.prototype.hasOwnProperty.call(H,"default")?H.default:H}var react={exports:{}},react_production={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var H=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),$=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),re=Symbol.for("react.consumer"),ae=Symbol.for("react.context"),xe=Symbol.for("react.forward_ref"),le=Symbol.for("react.suspense"),fe=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),Se=Symbol.iterator;function Ee(Ct){return Ct===null||typeof Ct!="object"?null:(Ct=Se&&Ct[Se]||Ct["@@iterator"],typeof Ct=="function"?Ct:null)}var Ce={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ie=Object.assign,De={};function Be(Ct,Ft,sn){this.props=Ct,this.context=Ft,this.refs=De,this.updater=sn||Ce}Be.prototype.isReactComponent={},Be.prototype.setState=function(Ct,Ft){if(typeof Ct!="object"&&typeof Ct!="function"&&Ct!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ct,Ft,"setState")},Be.prototype.forceUpdate=function(Ct){this.updater.enqueueForceUpdate(this,Ct,"forceUpdate")};function Ne(){}Ne.prototype=Be.prototype;function qe(Ct,Ft,sn){this.props=Ct,this.context=Ft,this.refs=De,this.updater=sn||Ce}var Xe=qe.prototype=new Ne;Xe.constructor=qe,Ie(Xe,Be.prototype),Xe.isPureReactComponent=!0;var Ye=Array.isArray,Qe={H:null,A:null,T:null,S:null,V:null},rt=Object.prototype.hasOwnProperty;function ot(Ct,Ft,sn,cn,en,yn){return sn=yn.ref,{$$typeof:H,type:Ct,key:Ft,ref:sn!==void 0?sn:null,props:yn}}function ct(Ct,Ft){return ot(Ct.type,Ft,void 0,void 0,void 0,Ct.props)}function mt(Ct){return typeof Ct=="object"&&Ct!==null&&Ct.$$typeof===H}function _t(Ct){var Ft={"=":"=0",":":"=2"};return"$"+Ct.replace(/[=:]/g,function(sn){return Ft[sn]})}var Lt=/\/+/g;function Vt(Ct,Ft){return typeof Ct=="object"&&Ct!==null&&Ct.key!=null?_t(""+Ct.key):Ft.toString(36)}function Gt(){}function $t(Ct){switch(Ct.status){case"fulfilled":return Ct.value;case"rejected":throw Ct.reason;default:switch(typeof Ct.status=="string"?Ct.then(Gt,Gt):(Ct.status="pending",Ct.then(function(Ft){Ct.status==="pending"&&(Ct.status="fulfilled",Ct.value=Ft)},function(Ft){Ct.status==="pending"&&(Ct.status="rejected",Ct.reason=Ft)})),Ct.status){case"fulfilled":return Ct.value;case"rejected":throw Ct.reason}}throw Ct}function Qt(Ct,Ft,sn,cn,en){var yn=typeof Ct;(yn==="undefined"||yn==="boolean")&&(Ct=null);var Pn=!1;if(Ct===null)Pn=!0;else switch(yn){case"bigint":case"string":case"number":Pn=!0;break;case"object":switch(Ct.$$typeof){case H:case _:Pn=!0;break;case ve:return Pn=Ct._init,Qt(Pn(Ct._payload),Ft,sn,cn,en)}}if(Pn)return en=en(Ct),Pn=cn===""?"."+Vt(Ct,0):cn,Ye(en)?(sn="",Pn!=null&&(sn=Pn.replace(Lt,"$&/")+"/"),Qt(en,Ft,sn,"",function(Fr){return Fr})):en!=null&&(mt(en)&&(en=ct(en,sn+(en.key==null||Ct&&Ct.key===en.key?"":(""+en.key).replace(Lt,"$&/")+"/")+Pn)),Ft.push(en)),1;Pn=0;var tr=cn===""?".":cn+":";if(Ye(Ct))for(var nr=0;nr<Ct.length;nr++)cn=Ct[nr],yn=tr+Vt(cn,nr),Pn+=Qt(cn,Ft,sn,yn,en);else if(nr=Ee(Ct),typeof nr=="function")for(Ct=nr.call(Ct),nr=0;!(cn=Ct.next()).done;)cn=cn.value,yn=tr+Vt(cn,nr++),Pn+=Qt(cn,Ft,sn,yn,en);else if(yn==="object"){if(typeof Ct.then=="function")return Qt($t(Ct),Ft,sn,cn,en);throw Ft=String(Ct),Error("Objects are not valid as a React child (found: "+(Ft==="[object Object]"?"object with keys {"+Object.keys(Ct).join(", ")+"}":Ft)+"). If you meant to render a collection of children, use an array instead.")}return Pn}function vt(Ct,Ft,sn){if(Ct==null)return Ct;var cn=[],en=0;return Qt(Ct,cn,"","",function(yn){return Ft.call(sn,yn,en++)}),cn}function It(Ct){if(Ct._status===-1){var Ft=Ct._result;Ft=Ft(),Ft.then(function(sn){(Ct._status===0||Ct._status===-1)&&(Ct._status=1,Ct._result=sn)},function(sn){(Ct._status===0||Ct._status===-1)&&(Ct._status=2,Ct._result=sn)}),Ct._status===-1&&(Ct._status=0,Ct._result=Ft)}if(Ct._status===1)return Ct._result.default;throw Ct._result}var gt=typeof reportError=="function"?reportError:function(Ct){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ft=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ct=="object"&&Ct!==null&&typeof Ct.message=="string"?String(Ct.message):String(Ct),error:Ct});if(!window.dispatchEvent(Ft))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ct);return}console.error(Ct)};function Tt(){}return react_production.Children={map:vt,forEach:function(Ct,Ft,sn){vt(Ct,function(){Ft.apply(this,arguments)},sn)},count:function(Ct){var Ft=0;return vt(Ct,function(){Ft++}),Ft},toArray:function(Ct){return vt(Ct,function(Ft){return Ft})||[]},only:function(Ct){if(!mt(Ct))throw Error("React.Children.only expected to receive a single React element child.");return Ct}},react_production.Component=Be,react_production.Fragment=b,react_production.Profiler=ee,react_production.PureComponent=qe,react_production.StrictMode=$,react_production.Suspense=le,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Qe,react_production.__COMPILER_RUNTIME={__proto__:null,c:function(Ct){return Qe.H.useMemoCache(Ct)}},react_production.cache=function(Ct){return function(){return Ct.apply(null,arguments)}},react_production.cloneElement=function(Ct,Ft,sn){if(Ct==null)throw Error("The argument must be a React element, but you passed "+Ct+".");var cn=Ie({},Ct.props),en=Ct.key,yn=void 0;if(Ft!=null)for(Pn in Ft.ref!==void 0&&(yn=void 0),Ft.key!==void 0&&(en=""+Ft.key),Ft)!rt.call(Ft,Pn)||Pn==="key"||Pn==="__self"||Pn==="__source"||Pn==="ref"&&Ft.ref===void 0||(cn[Pn]=Ft[Pn]);var Pn=arguments.length-2;if(Pn===1)cn.children=sn;else if(1<Pn){for(var tr=Array(Pn),nr=0;nr<Pn;nr++)tr[nr]=arguments[nr+2];cn.children=tr}return ot(Ct.type,en,void 0,void 0,yn,cn)},react_production.createContext=function(Ct){return Ct={$$typeof:ae,_currentValue:Ct,_currentValue2:Ct,_threadCount:0,Provider:null,Consumer:null},Ct.Provider=Ct,Ct.Consumer={$$typeof:re,_context:Ct},Ct},react_production.createElement=function(Ct,Ft,sn){var cn,en={},yn=null;if(Ft!=null)for(cn in Ft.key!==void 0&&(yn=""+Ft.key),Ft)rt.call(Ft,cn)&&cn!=="key"&&cn!=="__self"&&cn!=="__source"&&(en[cn]=Ft[cn]);var Pn=arguments.length-2;if(Pn===1)en.children=sn;else if(1<Pn){for(var tr=Array(Pn),nr=0;nr<Pn;nr++)tr[nr]=arguments[nr+2];en.children=tr}if(Ct&&Ct.defaultProps)for(cn in Pn=Ct.defaultProps,Pn)en[cn]===void 0&&(en[cn]=Pn[cn]);return ot(Ct,yn,void 0,void 0,null,en)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(Ct){return{$$typeof:xe,render:Ct}},react_production.isValidElement=mt,react_production.lazy=function(Ct){return{$$typeof:ve,_payload:{_status:-1,_result:Ct},_init:It}},react_production.memo=function(Ct,Ft){return{$$typeof:fe,type:Ct,compare:Ft===void 0?null:Ft}},react_production.startTransition=function(Ct){var Ft=Qe.T,sn={};Qe.T=sn;try{var cn=Ct(),en=Qe.S;en!==null&&en(sn,cn),typeof cn=="object"&&cn!==null&&typeof cn.then=="function"&&cn.then(Tt,gt)}catch(yn){gt(yn)}finally{Qe.T=Ft}},react_production.unstable_useCacheRefresh=function(){return Qe.H.useCacheRefresh()},react_production.use=function(Ct){return Qe.H.use(Ct)},react_production.useActionState=function(Ct,Ft,sn){return Qe.H.useActionState(Ct,Ft,sn)},react_production.useCallback=function(Ct,Ft){return Qe.H.useCallback(Ct,Ft)},react_production.useContext=function(Ct){return Qe.H.useContext(Ct)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(Ct,Ft){return Qe.H.useDeferredValue(Ct,Ft)},react_production.useEffect=function(Ct,Ft,sn){var cn=Qe.H;if(typeof sn=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return cn.useEffect(Ct,Ft)},react_production.useId=function(){return Qe.H.useId()},react_production.useImperativeHandle=function(Ct,Ft,sn){return Qe.H.useImperativeHandle(Ct,Ft,sn)},react_production.useInsertionEffect=function(Ct,Ft){return Qe.H.useInsertionEffect(Ct,Ft)},react_production.useLayoutEffect=function(Ct,Ft){return Qe.H.useLayoutEffect(Ct,Ft)},react_production.useMemo=function(Ct,Ft){return Qe.H.useMemo(Ct,Ft)},react_production.useOptimistic=function(Ct,Ft){return Qe.H.useOptimistic(Ct,Ft)},react_production.useReducer=function(Ct,Ft,sn){return Qe.H.useReducer(Ct,Ft,sn)},react_production.useRef=function(Ct){return Qe.H.useRef(Ct)},react_production.useState=function(Ct){return Qe.H.useState(Ct)},react_production.useSyncExternalStore=function(Ct,Ft,sn){return Qe.H.useSyncExternalStore(Ct,Ft,sn)},react_production.useTransition=function(){return Qe.H.useTransition()},react_production.version="19.1.0",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,function(H){function _(vt,It){var gt=vt.length;vt.push(It);e:for(;0<gt;){var Tt=gt-1>>>1,Ct=vt[Tt];if(0<ee(Ct,It))vt[Tt]=It,vt[gt]=Ct,gt=Tt;else break e}}function b(vt){return vt.length===0?null:vt[0]}function $(vt){if(vt.length===0)return null;var It=vt[0],gt=vt.pop();if(gt!==It){vt[0]=gt;e:for(var Tt=0,Ct=vt.length,Ft=Ct>>>1;Tt<Ft;){var sn=2*(Tt+1)-1,cn=vt[sn],en=sn+1,yn=vt[en];if(0>ee(cn,gt))en<Ct&&0>ee(yn,cn)?(vt[Tt]=yn,vt[en]=gt,Tt=en):(vt[Tt]=cn,vt[sn]=gt,Tt=sn);else if(en<Ct&&0>ee(yn,gt))vt[Tt]=yn,vt[en]=gt,Tt=en;else break e}}return It}function ee(vt,It){var gt=vt.sortIndex-It.sortIndex;return gt!==0?gt:vt.id-It.id}if(H.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var re=performance;H.unstable_now=function(){return re.now()}}else{var ae=Date,xe=ae.now();H.unstable_now=function(){return ae.now()-xe}}var le=[],fe=[],ve=1,Se=null,Ee=3,Ce=!1,Ie=!1,De=!1,Be=!1,Ne=typeof setTimeout=="function"?setTimeout:null,qe=typeof clearTimeout=="function"?clearTimeout:null,Xe=typeof setImmediate<"u"?setImmediate:null;function Ye(vt){for(var It=b(fe);It!==null;){if(It.callback===null)$(fe);else if(It.startTime<=vt)$(fe),It.sortIndex=It.expirationTime,_(le,It);else break;It=b(fe)}}function Qe(vt){if(De=!1,Ye(vt),!Ie)if(b(le)!==null)Ie=!0,rt||(rt=!0,Vt());else{var It=b(fe);It!==null&&Qt(Qe,It.startTime-vt)}}var rt=!1,ot=-1,ct=5,mt=-1;function _t(){return Be?!0:!(H.unstable_now()-mt<ct)}function Lt(){if(Be=!1,rt){var vt=H.unstable_now();mt=vt;var It=!0;try{e:{Ie=!1,De&&(De=!1,qe(ot),ot=-1),Ce=!0;var gt=Ee;try{t:{for(Ye(vt),Se=b(le);Se!==null&&!(Se.expirationTime>vt&&_t());){var Tt=Se.callback;if(typeof Tt=="function"){Se.callback=null,Ee=Se.priorityLevel;var Ct=Tt(Se.expirationTime<=vt);if(vt=H.unstable_now(),typeof Ct=="function"){Se.callback=Ct,Ye(vt),It=!0;break t}Se===b(le)&&$(le),Ye(vt)}else $(le);Se=b(le)}if(Se!==null)It=!0;else{var Ft=b(fe);Ft!==null&&Qt(Qe,Ft.startTime-vt),It=!1}}break e}finally{Se=null,Ee=gt,Ce=!1}It=void 0}}finally{It?Vt():rt=!1}}}var Vt;if(typeof Xe=="function")Vt=function(){Xe(Lt)};else if(typeof MessageChannel<"u"){var Gt=new MessageChannel,$t=Gt.port2;Gt.port1.onmessage=Lt,Vt=function(){$t.postMessage(null)}}else Vt=function(){Ne(Lt,0)};function Qt(vt,It){ot=Ne(function(){vt(H.unstable_now())},It)}H.unstable_IdlePriority=5,H.unstable_ImmediatePriority=1,H.unstable_LowPriority=4,H.unstable_NormalPriority=3,H.unstable_Profiling=null,H.unstable_UserBlockingPriority=2,H.unstable_cancelCallback=function(vt){vt.callback=null},H.unstable_forceFrameRate=function(vt){0>vt||125<vt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ct=0<vt?Math.floor(1e3/vt):5},H.unstable_getCurrentPriorityLevel=function(){return Ee},H.unstable_next=function(vt){switch(Ee){case 1:case 2:case 3:var It=3;break;default:It=Ee}var gt=Ee;Ee=It;try{return vt()}finally{Ee=gt}},H.unstable_requestPaint=function(){Be=!0},H.unstable_runWithPriority=function(vt,It){switch(vt){case 1:case 2:case 3:case 4:case 5:break;default:vt=3}var gt=Ee;Ee=vt;try{return It()}finally{Ee=gt}},H.unstable_scheduleCallback=function(vt,It,gt){var Tt=H.unstable_now();switch(typeof gt=="object"&&gt!==null?(gt=gt.delay,gt=typeof gt=="number"&&0<gt?Tt+gt:Tt):gt=Tt,vt){case 1:var Ct=-1;break;case 2:Ct=250;break;case 5:Ct=1073741823;break;case 4:Ct=1e4;break;default:Ct=5e3}return Ct=gt+Ct,vt={id:ve++,callback:It,priorityLevel:vt,startTime:gt,expirationTime:Ct,sortIndex:-1},gt>Tt?(vt.sortIndex=gt,_(fe,vt),b(le)===null&&vt===b(fe)&&(De?(qe(ot),ot=-1):De=!0,Qt(Qe,gt-Tt))):(vt.sortIndex=Ct,_(le,vt),Ie||Ce||(Ie=!0,rt||(rt=!0,Vt()))),vt},H.unstable_shouldYield=_t,H.unstable_wrapCallback=function(vt){var It=Ee;return function(){var gt=Ee;Ee=It;try{return vt.apply(this,arguments)}finally{Ee=gt}}}}(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var reactDom={exports:{}},reactDom_production={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var H=requireReact();function _(le){var fe="https://react.dev/errors/"+le;if(1<arguments.length){fe+="?args[]="+encodeURIComponent(arguments[1]);for(var ve=2;ve<arguments.length;ve++)fe+="&args[]="+encodeURIComponent(arguments[ve])}return"Minified React error #"+le+"; visit "+fe+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function b(){}var $={d:{f:b,r:function(){throw Error(_(522))},D:b,C:b,L:b,m:b,X:b,S:b,M:b},p:0,findDOMNode:null},ee=Symbol.for("react.portal");function re(le,fe,ve){var Se=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ee,key:Se==null?null:""+Se,children:le,containerInfo:fe,implementation:ve}}var ae=H.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function xe(le,fe){if(le==="font")return"";if(typeof fe=="string")return fe==="use-credentials"?fe:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$,reactDom_production.createPortal=function(le,fe){var ve=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fe||fe.nodeType!==1&&fe.nodeType!==9&&fe.nodeType!==11)throw Error(_(299));return re(le,fe,null,ve)},reactDom_production.flushSync=function(le){var fe=ae.T,ve=$.p;try{if(ae.T=null,$.p=2,le)return le()}finally{ae.T=fe,$.p=ve,$.d.f()}},reactDom_production.preconnect=function(le,fe){typeof le=="string"&&(fe?(fe=fe.crossOrigin,fe=typeof fe=="string"?fe==="use-credentials"?fe:"":void 0):fe=null,$.d.C(le,fe))},reactDom_production.prefetchDNS=function(le){typeof le=="string"&&$.d.D(le)},reactDom_production.preinit=function(le,fe){if(typeof le=="string"&&fe&&typeof fe.as=="string"){var ve=fe.as,Se=xe(ve,fe.crossOrigin),Ee=typeof fe.integrity=="string"?fe.integrity:void 0,Ce=typeof fe.fetchPriority=="string"?fe.fetchPriority:void 0;ve==="style"?$.d.S(le,typeof fe.precedence=="string"?fe.precedence:void 0,{crossOrigin:Se,integrity:Ee,fetchPriority:Ce}):ve==="script"&&$.d.X(le,{crossOrigin:Se,integrity:Ee,fetchPriority:Ce,nonce:typeof fe.nonce=="string"?fe.nonce:void 0})}},reactDom_production.preinitModule=function(le,fe){if(typeof le=="string")if(typeof fe=="object"&&fe!==null){if(fe.as==null||fe.as==="script"){var ve=xe(fe.as,fe.crossOrigin);$.d.M(le,{crossOrigin:ve,integrity:typeof fe.integrity=="string"?fe.integrity:void 0,nonce:typeof fe.nonce=="string"?fe.nonce:void 0})}}else fe==null&&$.d.M(le)},reactDom_production.preload=function(le,fe){if(typeof le=="string"&&typeof fe=="object"&&fe!==null&&typeof fe.as=="string"){var ve=fe.as,Se=xe(ve,fe.crossOrigin);$.d.L(le,ve,{crossOrigin:Se,integrity:typeof fe.integrity=="string"?fe.integrity:void 0,nonce:typeof fe.nonce=="string"?fe.nonce:void 0,type:typeof fe.type=="string"?fe.type:void 0,fetchPriority:typeof fe.fetchPriority=="string"?fe.fetchPriority:void 0,referrerPolicy:typeof fe.referrerPolicy=="string"?fe.referrerPolicy:void 0,imageSrcSet:typeof fe.imageSrcSet=="string"?fe.imageSrcSet:void 0,imageSizes:typeof fe.imageSizes=="string"?fe.imageSizes:void 0,media:typeof fe.media=="string"?fe.media:void 0})}},reactDom_production.preloadModule=function(le,fe){if(typeof le=="string")if(fe){var ve=xe(fe.as,fe.crossOrigin);$.d.m(le,{as:typeof fe.as=="string"&&fe.as!=="script"?fe.as:void 0,crossOrigin:ve,integrity:typeof fe.integrity=="string"?fe.integrity:void 0})}else $.d.m(le)},reactDom_production.requestFormReset=function(le){$.d.r(le)},reactDom_production.unstable_batchedUpdates=function(le,fe){return le(fe)},reactDom_production.useFormState=function(le,fe,ve){return ae.H.useFormState(le,fe,ve)},reactDom_production.useFormStatus=function(){return ae.H.useHostTransitionStatus()},reactDom_production.version="19.1.0",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function H(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(H)}catch(_){console.error(_)}}return H(),reactDom.exports=requireReactDom_production(),reactDom.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var H=requireScheduler(),_=requireReact(),b=requireReactDom();function $(ye){var _e="https://react.dev/errors/"+ye;if(1<arguments.length){_e+="?args[]="+encodeURIComponent(arguments[1]);for(var Pe=2;Pe<arguments.length;Pe++)_e+="&args[]="+encodeURIComponent(arguments[Pe])}return"Minified React error #"+ye+"; visit "+_e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function ee(ye){return!(!ye||ye.nodeType!==1&&ye.nodeType!==9&&ye.nodeType!==11)}function re(ye){var _e=ye,Pe=ye;if(ye.alternate)for(;_e.return;)_e=_e.return;else{ye=_e;do _e=ye,(_e.flags&4098)!==0&&(Pe=_e.return),ye=_e.return;while(ye)}return _e.tag===3?Pe:null}function ae(ye){if(ye.tag===13){var _e=ye.memoizedState;if(_e===null&&(ye=ye.alternate,ye!==null&&(_e=ye.memoizedState)),_e!==null)return _e.dehydrated}return null}function xe(ye){if(re(ye)!==ye)throw Error($(188))}function le(ye){var _e=ye.alternate;if(!_e){if(_e=re(ye),_e===null)throw Error($(188));return _e!==ye?null:ye}for(var Pe=ye,$e=_e;;){var tt=Pe.return;if(tt===null)break;var lt=tt.alternate;if(lt===null){if($e=tt.return,$e!==null){Pe=$e;continue}break}if(tt.child===lt.child){for(lt=tt.child;lt;){if(lt===Pe)return xe(tt),ye;if(lt===$e)return xe(tt),_e;lt=lt.sibling}throw Error($(188))}if(Pe.return!==$e.return)Pe=tt,$e=lt;else{for(var Dt=!1,qt=tt.child;qt;){if(qt===Pe){Dt=!0,Pe=tt,$e=lt;break}if(qt===$e){Dt=!0,$e=tt,Pe=lt;break}qt=qt.sibling}if(!Dt){for(qt=lt.child;qt;){if(qt===Pe){Dt=!0,Pe=lt,$e=tt;break}if(qt===$e){Dt=!0,$e=lt,Pe=tt;break}qt=qt.sibling}if(!Dt)throw Error($(189))}}if(Pe.alternate!==$e)throw Error($(190))}if(Pe.tag!==3)throw Error($(188));return Pe.stateNode.current===Pe?ye:_e}function fe(ye){var _e=ye.tag;if(_e===5||_e===26||_e===27||_e===6)return ye;for(ye=ye.child;ye!==null;){if(_e=fe(ye),_e!==null)return _e;ye=ye.sibling}return null}var ve=Object.assign,Se=Symbol.for("react.element"),Ee=Symbol.for("react.transitional.element"),Ce=Symbol.for("react.portal"),Ie=Symbol.for("react.fragment"),De=Symbol.for("react.strict_mode"),Be=Symbol.for("react.profiler"),Ne=Symbol.for("react.provider"),qe=Symbol.for("react.consumer"),Xe=Symbol.for("react.context"),Ye=Symbol.for("react.forward_ref"),Qe=Symbol.for("react.suspense"),rt=Symbol.for("react.suspense_list"),ot=Symbol.for("react.memo"),ct=Symbol.for("react.lazy"),mt=Symbol.for("react.activity"),_t=Symbol.for("react.memo_cache_sentinel"),Lt=Symbol.iterator;function Vt(ye){return ye===null||typeof ye!="object"?null:(ye=Lt&&ye[Lt]||ye["@@iterator"],typeof ye=="function"?ye:null)}var Gt=Symbol.for("react.client.reference");function $t(ye){if(ye==null)return null;if(typeof ye=="function")return ye.$$typeof===Gt?null:ye.displayName||ye.name||null;if(typeof ye=="string")return ye;switch(ye){case Ie:return"Fragment";case Be:return"Profiler";case De:return"StrictMode";case Qe:return"Suspense";case rt:return"SuspenseList";case mt:return"Activity"}if(typeof ye=="object")switch(ye.$$typeof){case Ce:return"Portal";case Xe:return(ye.displayName||"Context")+".Provider";case qe:return(ye._context.displayName||"Context")+".Consumer";case Ye:var _e=ye.render;return ye=ye.displayName,ye||(ye=_e.displayName||_e.name||"",ye=ye!==""?"ForwardRef("+ye+")":"ForwardRef"),ye;case ot:return _e=ye.displayName||null,_e!==null?_e:$t(ye.type)||"Memo";case ct:_e=ye._payload,ye=ye._init;try{return $t(ye(_e))}catch{}}return null}var Qt=Array.isArray,vt=_.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,It=b.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,gt={pending:!1,data:null,method:null,action:null},Tt=[],Ct=-1;function Ft(ye){return{current:ye}}function sn(ye){0>Ct||(ye.current=Tt[Ct],Tt[Ct]=null,Ct--)}function cn(ye,_e){Ct++,Tt[Ct]=ye.current,ye.current=_e}var en=Ft(null),yn=Ft(null),Pn=Ft(null),tr=Ft(null);function nr(ye,_e){switch(cn(Pn,_e),cn(yn,ye),cn(en,null),_e.nodeType){case 9:case 11:ye=(ye=_e.documentElement)&&(ye=ye.namespaceURI)?Qd(ye):0;break;default:if(ye=_e.tagName,_e=_e.namespaceURI)_e=Qd(_e),ye=Zd(_e,ye);else switch(ye){case"svg":ye=1;break;case"math":ye=2;break;default:ye=0}}sn(en),cn(en,ye)}function Fr(){sn(en),sn(yn),sn(Pn)}function Ur(ye){ye.memoizedState!==null&&cn(tr,ye);var _e=en.current,Pe=Zd(_e,ye.type);_e!==Pe&&(cn(yn,ye),cn(en,Pe))}function Kr(ye){yn.current===ye&&(sn(en),sn(yn)),tr.current===ye&&(sn(tr),$l._currentValue=gt)}var on=Object.prototype.hasOwnProperty,qr=H.unstable_scheduleCallback,rr=H.unstable_cancelCallback,Qr=H.unstable_shouldYield,Ir=H.unstable_requestPaint,ai=H.unstable_now,Hr=H.unstable_getCurrentPriorityLevel,Vr=H.unstable_ImmediatePriority,xn=H.unstable_UserBlockingPriority,Ht=H.unstable_NormalPriority,In=H.unstable_LowPriority,er=H.unstable_IdlePriority,Hn=H.log,Zn=H.unstable_setDisableYieldValue,Dr=null,zn=null;function Nr(ye){if(typeof Hn=="function"&&Zn(ye),zn&&typeof zn.setStrictMode=="function")try{zn.setStrictMode(Dr,ye)}catch{}}var vr=Math.clz32?Math.clz32:gi,Sr=Math.log,zr=Math.LN2;function gi(ye){return ye>>>=0,ye===0?32:31-(Sr(ye)/zr|0)|0}var oi=256,Gr=4194304;function ri(ye){var _e=ye&42;if(_e!==0)return _e;switch(ye&-ye){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return ye&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return ye&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return ye}}function yi(ye,_e,Pe){var $e=ye.pendingLanes;if($e===0)return 0;var tt=0,lt=ye.suspendedLanes,Dt=ye.pingedLanes;ye=ye.warmLanes;var qt=$e&134217727;return qt!==0?($e=qt&~lt,$e!==0?tt=ri($e):(Dt&=qt,Dt!==0?tt=ri(Dt):Pe||(Pe=qt&~ye,Pe!==0&&(tt=ri(Pe))))):(qt=$e&~lt,qt!==0?tt=ri(qt):Dt!==0?tt=ri(Dt):Pe||(Pe=$e&~ye,Pe!==0&&(tt=ri(Pe)))),tt===0?0:_e!==0&&_e!==tt&&(_e&lt)===0&&(lt=tt&-tt,Pe=_e&-_e,lt>=Pe||lt===32&&(Pe&4194048)!==0)?_e:tt}function Ci(ye,_e){return(ye.pendingLanes&~(ye.suspendedLanes&~ye.pingedLanes)&_e)===0}function wn(ye,_e){switch(ye){case 1:case 2:case 4:case 8:case 64:return _e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pr(){var ye=oi;return oi<<=1,(oi&4194048)===0&&(oi=256),ye}function xr(){var ye=Gr;return Gr<<=1,(Gr&62914560)===0&&(Gr=4194304),ye}function gr(ye){for(var _e=[],Pe=0;31>Pe;Pe++)_e.push(ye);return _e}function Mr(ye,_e){ye.pendingLanes|=_e,_e!==268435456&&(ye.suspendedLanes=0,ye.pingedLanes=0,ye.warmLanes=0)}function ci(ye,_e,Pe,$e,tt,lt){var Dt=ye.pendingLanes;ye.pendingLanes=Pe,ye.suspendedLanes=0,ye.pingedLanes=0,ye.warmLanes=0,ye.expiredLanes&=Pe,ye.entangledLanes&=Pe,ye.errorRecoveryDisabledLanes&=Pe,ye.shellSuspendCounter=0;var qt=ye.entanglements,dn=ye.expirationTimes,Gn=ye.hiddenUpdates;for(Pe=Dt&~Pe;0<Pe;){var mr=31-vr(Pe),Er=1<<mr;qt[mr]=0,dn[mr]=-1;var Yn=Gn[mr];if(Yn!==null)for(Gn[mr]=null,mr=0;mr<Yn.length;mr++){var Qn=Yn[mr];Qn!==null&&(Qn.lane&=-536870913)}Pe&=~Er}$e!==0&&fi(ye,$e,0),lt!==0&&tt===0&&ye.tag!==0&&(ye.suspendedLanes|=lt&~(Dt&~_e))}function fi(ye,_e,Pe){ye.pendingLanes|=_e,ye.suspendedLanes&=~_e;var $e=31-vr(_e);ye.entangledLanes|=_e,ye.entanglements[$e]=ye.entanglements[$e]|1073741824|Pe&4194090}function Ui(ye,_e){var Pe=ye.entangledLanes|=_e;for(ye=ye.entanglements;Pe;){var $e=31-vr(Pe),tt=1<<$e;tt&_e|ye[$e]&_e&&(ye[$e]|=_e),Pe&=~tt}}function Vi(ye){switch(ye){case 2:ye=1;break;case 8:ye=4;break;case 32:ye=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:ye=128;break;case 268435456:ye=134217728;break;default:ye=0}return ye}function bi(ye){return ye&=-ye,2<ye?8<ye?(ye&134217727)!==0?32:268435456:8:2}function Ga(){var ye=It.p;return ye!==0?ye:(ye=window.event,ye===void 0?32:gp(ye.type))}function Ra(ye,_e){var Pe=It.p;try{return It.p=ye,_e()}finally{It.p=Pe}}var sa=Math.random().toString(36).slice(2),$i="__reactFiber$"+sa,Fi="__reactProps$"+sa,Ss="__reactContainer$"+sa,ta="__reactEvents$"+sa,Na="__reactListeners$"+sa,is="__reactHandles$"+sa,Hs="__reactResources$"+sa,$s="__reactMarker$"+sa;function v0(ye){delete ye[$i],delete ye[Fi],delete ye[ta],delete ye[Na],delete ye[is]}function Qs(ye){var _e=ye[$i];if(_e)return _e;for(var Pe=ye.parentNode;Pe;){if(_e=Pe[Ss]||Pe[$i]){if(Pe=_e.alternate,_e.child!==null||Pe!==null&&Pe.child!==null)for(ye=tp(ye);ye!==null;){if(Pe=ye[$i])return Pe;ye=tp(ye)}return _e}ye=Pe,Pe=ye.parentNode}return null}function Zs(ye){if(ye=ye[$i]||ye[Ss]){var _e=ye.tag;if(_e===5||_e===6||_e===13||_e===26||_e===27||_e===3)return ye}return null}function as(ye){var _e=ye.tag;if(_e===5||_e===26||_e===27||_e===6)return ye.stateNode;throw Error($(33))}function Jt(ye){var _e=ye[Hs];return _e||(_e=ye[Hs]={hoistableStyles:new Map,hoistableScripts:new Map}),_e}function vn(ye){ye[$s]=!0}var $n=new Set,Wn={};function An(ye,_e){Cr(ye,_e),Cr(ye+"Capture",_e)}function Cr(ye,_e){for(Wn[ye]=_e,ye=0;ye<_e.length;ye++)$n.add(_e[ye])}var $r=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Xr={},Yr={};function ui(ye){return on.call(Yr,ye)?!0:on.call(Xr,ye)?!1:$r.test(ye)?Yr[ye]=!0:(Xr[ye]=!0,!1)}function ii(ye,_e,Pe){if(ui(_e))if(Pe===null)ye.removeAttribute(_e);else{switch(typeof Pe){case"undefined":case"function":case"symbol":ye.removeAttribute(_e);return;case"boolean":var $e=_e.toLowerCase().slice(0,5);if($e!=="data-"&&$e!=="aria-"){ye.removeAttribute(_e);return}}ye.setAttribute(_e,""+Pe)}}function jr(ye,_e,Pe){if(Pe===null)ye.removeAttribute(_e);else{switch(typeof Pe){case"undefined":case"function":case"symbol":case"boolean":ye.removeAttribute(_e);return}ye.setAttribute(_e,""+Pe)}}function di(ye,_e,Pe,$e){if($e===null)ye.removeAttribute(Pe);else{switch(typeof $e){case"undefined":case"function":case"symbol":case"boolean":ye.removeAttribute(Pe);return}ye.setAttributeNS(_e,Pe,""+$e)}}var Pi,Ai;function xa(ye){if(Pi===void 0)try{throw Error()}catch(Pe){var _e=Pe.stack.trim().match(/\n( *(at )?)/);Pi=_e&&_e[1]||"",Ai=-1<Pe.stack.indexOf(`
    at`)?" (<anonymous>)":-1<Pe.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Pi+ye+Ai}var Mi=!1;function Jr(ye,_e){if(!ye||Mi)return"";Mi=!0;var Pe=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var $e={DetermineComponentFrameRoot:function(){try{if(_e){var Er=function(){throw Error()};if(Object.defineProperty(Er.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Er,[])}catch(Qn){var Yn=Qn}Reflect.construct(ye,[],Er)}else{try{Er.call()}catch(Qn){Yn=Qn}ye.call(Er.prototype)}}else{try{throw Error()}catch(Qn){Yn=Qn}(Er=ye())&&typeof Er.catch=="function"&&Er.catch(function(){})}}catch(Qn){if(Qn&&Yn&&typeof Qn.stack=="string")return[Qn.stack,Yn.stack]}return[null,null]}};$e.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var tt=Object.getOwnPropertyDescriptor($e.DetermineComponentFrameRoot,"name");tt&&tt.configurable&&Object.defineProperty($e.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var lt=$e.DetermineComponentFrameRoot(),Dt=lt[0],qt=lt[1];if(Dt&&qt){var dn=Dt.split(`
`),Gn=qt.split(`
`);for(tt=$e=0;$e<dn.length&&!dn[$e].includes("DetermineComponentFrameRoot");)$e++;for(;tt<Gn.length&&!Gn[tt].includes("DetermineComponentFrameRoot");)tt++;if($e===dn.length||tt===Gn.length)for($e=dn.length-1,tt=Gn.length-1;1<=$e&&0<=tt&&dn[$e]!==Gn[tt];)tt--;for(;1<=$e&&0<=tt;$e--,tt--)if(dn[$e]!==Gn[tt]){if($e!==1||tt!==1)do if($e--,tt--,0>tt||dn[$e]!==Gn[tt]){var mr=`
`+dn[$e].replace(" at new "," at ");return ye.displayName&&mr.includes("<anonymous>")&&(mr=mr.replace("<anonymous>",ye.displayName)),mr}while(1<=$e&&0<=tt);break}}}finally{Mi=!1,Error.prepareStackTrace=Pe}return(Pe=ye?ye.displayName||ye.name:"")?xa(Pe):""}function Zi(ye){switch(ye.tag){case 26:case 27:case 5:return xa(ye.type);case 16:return xa("Lazy");case 13:return xa("Suspense");case 19:return xa("SuspenseList");case 0:case 15:return Jr(ye.type,!1);case 11:return Jr(ye.type.render,!1);case 1:return Jr(ye.type,!0);case 31:return xa("Activity");default:return""}}function Ri(ye){try{var _e="";do _e+=Zi(ye),ye=ye.return;while(ye);return _e}catch(Pe){return`
Error generating stack: `+Pe.message+`
`+Pe.stack}}function zi(ye){switch(typeof ye){case"bigint":case"boolean":case"number":case"string":case"undefined":return ye;case"object":return ye;default:return""}}function Ws(ye){var _e=ye.type;return(ye=ye.nodeName)&&ye.toLowerCase()==="input"&&(_e==="checkbox"||_e==="radio")}function Da(ye){var _e=Ws(ye)?"checked":"value",Pe=Object.getOwnPropertyDescriptor(ye.constructor.prototype,_e),$e=""+ye[_e];if(!ye.hasOwnProperty(_e)&&typeof Pe<"u"&&typeof Pe.get=="function"&&typeof Pe.set=="function"){var tt=Pe.get,lt=Pe.set;return Object.defineProperty(ye,_e,{configurable:!0,get:function(){return tt.call(this)},set:function(Dt){$e=""+Dt,lt.call(this,Dt)}}),Object.defineProperty(ye,_e,{enumerable:Pe.enumerable}),{getValue:function(){return $e},setValue:function(Dt){$e=""+Dt},stopTracking:function(){ye._valueTracker=null,delete ye[_e]}}}}function Js(ye){ye._valueTracker||(ye._valueTracker=Da(ye))}function Ji(ye){if(!ye)return!1;var _e=ye._valueTracker;if(!_e)return!0;var Pe=_e.getValue(),$e="";return ye&&($e=Ws(ye)?ye.checked?"true":"false":ye.value),ye=$e,ye!==Pe?(_e.setValue(ye),!0):!1}function ss(ye){if(ye=ye||(typeof document<"u"?document:void 0),typeof ye>"u")return null;try{return ye.activeElement||ye.body}catch{return ye.body}}var qs=/[\n"\\]/g;function Di(ye){return ye.replace(qs,function(_e){return"\\"+_e.charCodeAt(0).toString(16)+" "})}function Ts(ye,_e,Pe,$e,tt,lt,Dt,qt){ye.name="",Dt!=null&&typeof Dt!="function"&&typeof Dt!="symbol"&&typeof Dt!="boolean"?ye.type=Dt:ye.removeAttribute("type"),_e!=null?Dt==="number"?(_e===0&&ye.value===""||ye.value!=_e)&&(ye.value=""+zi(_e)):ye.value!==""+zi(_e)&&(ye.value=""+zi(_e)):Dt!=="submit"&&Dt!=="reset"||ye.removeAttribute("value"),_e!=null?js(ye,Dt,zi(_e)):Pe!=null?js(ye,Dt,zi(Pe)):$e!=null&&ye.removeAttribute("value"),tt==null&&lt!=null&&(ye.defaultChecked=!!lt),tt!=null&&(ye.checked=tt&&typeof tt!="function"&&typeof tt!="symbol"),qt!=null&&typeof qt!="function"&&typeof qt!="symbol"&&typeof qt!="boolean"?ye.name=""+zi(qt):ye.removeAttribute("name")}function Pa(ye,_e,Pe,$e,tt,lt,Dt,qt){if(lt!=null&&typeof lt!="function"&&typeof lt!="symbol"&&typeof lt!="boolean"&&(ye.type=lt),_e!=null||Pe!=null){if(!(lt!=="submit"&&lt!=="reset"||_e!=null))return;Pe=Pe!=null?""+zi(Pe):"",_e=_e!=null?""+zi(_e):Pe,qt||_e===ye.value||(ye.value=_e),ye.defaultValue=_e}$e=$e??tt,$e=typeof $e!="function"&&typeof $e!="symbol"&&!!$e,ye.checked=qt?ye.checked:!!$e,ye.defaultChecked=!!$e,Dt!=null&&typeof Dt!="function"&&typeof Dt!="symbol"&&typeof Dt!="boolean"&&(ye.name=Dt)}function js(ye,_e,Pe){_e==="number"&&ss(ye.ownerDocument)===ye||ye.defaultValue===""+Pe||(ye.defaultValue=""+Pe)}function Ys(ye,_e,Pe,$e){if(ye=ye.options,_e){_e={};for(var tt=0;tt<Pe.length;tt++)_e["$"+Pe[tt]]=!0;for(Pe=0;Pe<ye.length;Pe++)tt=_e.hasOwnProperty("$"+ye[Pe].value),ye[Pe].selected!==tt&&(ye[Pe].selected=tt),tt&&$e&&(ye[Pe].defaultSelected=!0)}else{for(Pe=""+zi(Pe),_e=null,tt=0;tt<ye.length;tt++){if(ye[tt].value===Pe){ye[tt].selected=!0,$e&&(ye[tt].defaultSelected=!0);return}_e!==null||ye[tt].disabled||(_e=ye[tt])}_e!==null&&(_e.selected=!0)}}function yx(ye,_e,Pe){if(_e!=null&&(_e=""+zi(_e),_e!==ye.value&&(ye.value=_e),Pe==null)){ye.defaultValue!==_e&&(ye.defaultValue=_e);return}ye.defaultValue=Pe!=null?""+zi(Pe):""}function ka(ye,_e,Pe,$e){if(_e==null){if($e!=null){if(Pe!=null)throw Error($(92));if(Qt($e)){if(1<$e.length)throw Error($(93));$e=$e[0]}Pe=$e}Pe==null&&(Pe=""),_e=Pe}Pe=zi(_e),ye.defaultValue=Pe,$e=ye.textContent,$e===Pe&&$e!==""&&$e!==null&&(ye.value=$e)}function e0(ye,_e){if(_e){var Pe=ye.firstChild;if(Pe&&Pe===ye.lastChild&&Pe.nodeType===3){Pe.nodeValue=_e;return}}ye.textContent=_e}var Yx=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function _0(ye,_e,Pe){var $e=_e.indexOf("--")===0;Pe==null||typeof Pe=="boolean"||Pe===""?$e?ye.setProperty(_e,""):_e==="float"?ye.cssFloat="":ye[_e]="":$e?ye.setProperty(_e,Pe):typeof Pe!="number"||Pe===0||Yx.has(_e)?_e==="float"?ye.cssFloat=Pe:ye[_e]=(""+Pe).trim():ye[_e]=Pe+"px"}function gx(ye,_e,Pe){if(_e!=null&&typeof _e!="object")throw Error($(62));if(ye=ye.style,Pe!=null){for(var $e in Pe)!Pe.hasOwnProperty($e)||_e!=null&&_e.hasOwnProperty($e)||($e.indexOf("--")===0?ye.setProperty($e,""):$e==="float"?ye.cssFloat="":ye[$e]="");for(var tt in _e)$e=_e[tt],_e.hasOwnProperty(tt)&&Pe[tt]!==$e&&_0(ye,tt,$e)}else for(var lt in _e)_e.hasOwnProperty(lt)&&_0(ye,lt,_e[lt])}function K0(ye){if(ye.indexOf("-")===-1)return!1;switch(ye){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xx=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Kx=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function O0(ye){return Kx.test(""+ye)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":ye}var B0=null;function os(ye){return ye=ye.target||ye.srcElement||window,ye.correspondingUseElement&&(ye=ye.correspondingUseElement),ye.nodeType===3?ye.parentNode:ye}var x0=null,t0=null;function vx(ye){var _e=Zs(ye);if(_e&&(ye=_e.stateNode)){var Pe=ye[Fi]||null;e:switch(ye=_e.stateNode,_e.type){case"input":if(Ts(ye,Pe.value,Pe.defaultValue,Pe.defaultValue,Pe.checked,Pe.defaultChecked,Pe.type,Pe.name),_e=Pe.name,Pe.type==="radio"&&_e!=null){for(Pe=ye;Pe.parentNode;)Pe=Pe.parentNode;for(Pe=Pe.querySelectorAll('input[name="'+Di(""+_e)+'"][type="radio"]'),_e=0;_e<Pe.length;_e++){var $e=Pe[_e];if($e!==ye&&$e.form===ye.form){var tt=$e[Fi]||null;if(!tt)throw Error($(90));Ts($e,tt.value,tt.defaultValue,tt.defaultValue,tt.checked,tt.defaultChecked,tt.type,tt.name)}}for(_e=0;_e<Pe.length;_e++)$e=Pe[_e],$e.form===ye.form&&Ji($e)}break e;case"textarea":yx(ye,Pe.value,Pe.defaultValue);break e;case"select":_e=Pe.value,_e!=null&&Ys(ye,!!Pe.multiple,_e,!1)}}}var La=!1;function bx(ye,_e,Pe){if(La)return ye(_e,Pe);La=!0;try{var $e=ye(_e);return $e}finally{if(La=!1,(x0!==null||t0!==null)&&(P2(),x0&&(_e=x0,ye=t0,t0=x0=null,vx(_e),ye)))for(_e=0;_e<ye.length;_e++)vx(ye[_e])}}function o0(ye,_e){var Pe=ye.stateNode;if(Pe===null)return null;var $e=Pe[Fi]||null;if($e===null)return null;Pe=$e[_e];e:switch(_e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":($e=!$e.disabled)||(ye=ye.type,$e=!(ye==="button"||ye==="input"||ye==="select"||ye==="textarea")),ye=!$e;break e;default:ye=!1}if(ye)return null;if(Pe&&typeof Pe!="function")throw Error($(231,_e,typeof Pe));return Pe}var Xs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Q0=!1;if(Xs)try{var D0={};Object.defineProperty(D0,"passive",{get:function(){Q0=!0}}),window.addEventListener("test",D0,D0),window.removeEventListener("test",D0,D0)}catch{Q0=!1}var n0=null,Z0=null,U0=null;function Sx(){if(U0)return U0;var ye,_e=Z0,Pe=_e.length,$e,tt="value"in n0?n0.value:n0.textContent,lt=tt.length;for(ye=0;ye<Pe&&_e[ye]===tt[ye];ye++);var Dt=Pe-ye;for($e=1;$e<=Dt&&_e[Pe-$e]===tt[lt-$e];$e++);return U0=tt.slice(ye,1<$e?1-$e:void 0)}function V0(ye){var _e=ye.keyCode;return"charCode"in ye?(ye=ye.charCode,ye===0&&_e===13&&(ye=13)):ye=_e,ye===10&&(ye=13),32<=ye||ye===13?ye:0}function z0(){return!0}function J0(){return!1}function Ha(ye){function _e(Pe,$e,tt,lt,Dt){this._reactName=Pe,this._targetInst=tt,this.type=$e,this.nativeEvent=lt,this.target=Dt,this.currentTarget=null;for(var qt in ye)ye.hasOwnProperty(qt)&&(Pe=ye[qt],this[qt]=Pe?Pe(lt):lt[qt]);return this.isDefaultPrevented=(lt.defaultPrevented!=null?lt.defaultPrevented:lt.returnValue===!1)?z0:J0,this.isPropagationStopped=J0,this}return ve(_e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var Pe=this.nativeEvent;Pe&&(Pe.preventDefault?Pe.preventDefault():typeof Pe.returnValue!="unknown"&&(Pe.returnValue=!1),this.isDefaultPrevented=z0)},stopPropagation:function(){var Pe=this.nativeEvent;Pe&&(Pe.stopPropagation?Pe.stopPropagation():typeof Pe.cancelBubble!="unknown"&&(Pe.cancelBubble=!0),this.isPropagationStopped=z0)},persist:function(){},isPersistent:z0}),_e}var l0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(ye){return ye.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},G0=Ha(l0),S0=ve({},l0,{view:0,detail:0}),Tx=Ha(S0),j0,Es,ls,T0=ve({},S0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fn,button:0,buttons:0,relatedTarget:function(ye){return ye.relatedTarget===void 0?ye.fromElement===ye.srcElement?ye.toElement:ye.fromElement:ye.relatedTarget},movementX:function(ye){return"movementX"in ye?ye.movementX:(ye!==ls&&(ls&&ye.type==="mousemove"?(j0=ye.screenX-ls.screenX,Es=ye.screenY-ls.screenY):Es=j0=0,ls=ye),j0)},movementY:function(ye){return"movementY"in ye?ye.movementY:Es}}),ex=Ha(T0),Ns=ve({},T0,{dataTransfer:0}),ds=Ha(Ns),H0=ve({},S0,{relatedTarget:0}),zt=Ha(H0),Ot=ve({},l0,{animationName:0,elapsedTime:0,pseudoElement:0}),un=Ha(Ot),kn=ve({},l0,{clipboardData:function(ye){return"clipboardData"in ye?ye.clipboardData:window.clipboardData}}),Mt=Ha(kn),Rt=ve({},l0,{data:0}),Zt=Ha(Rt),an={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dn(ye){var _e=this.nativeEvent;return _e.getModifierState?_e.getModifierState(ye):(ye=Cn[ye])?!!_e[ye]:!1}function Fn(){return Dn}var yr=ve({},S0,{key:function(ye){if(ye.key){var _e=an[ye.key]||ye.key;if(_e!=="Unidentified")return _e}return ye.type==="keypress"?(ye=V0(ye),ye===13?"Enter":String.fromCharCode(ye)):ye.type==="keydown"||ye.type==="keyup"?_n[ye.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fn,charCode:function(ye){return ye.type==="keypress"?V0(ye):0},keyCode:function(ye){return ye.type==="keydown"||ye.type==="keyup"?ye.keyCode:0},which:function(ye){return ye.type==="keypress"?V0(ye):ye.type==="keydown"||ye.type==="keyup"?ye.keyCode:0}}),wr=Ha(yr),Ar=ve({},T0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),li=Ha(Ar),vi=ve({},S0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fn}),Ei=Ha(vi),Gi=ve({},l0,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ki=Ha(Gi),Ii=ve({},T0,{deltaX:function(ye){return"deltaX"in ye?ye.deltaX:"wheelDeltaX"in ye?-ye.wheelDeltaX:0},deltaY:function(ye){return"deltaY"in ye?ye.deltaY:"wheelDeltaY"in ye?-ye.wheelDeltaY:"wheelDelta"in ye?-ye.wheelDelta:0},deltaZ:0,deltaMode:0}),Wi=Ha(Ii),Fa=ve({},l0,{newState:0,oldState:0}),cs=Ha(Fa),$a=[9,13,27,32],ws=Xs&&"CompositionEvent"in window,E0=null;Xs&&"documentMode"in document&&(E0=document.documentMode);var Co=Xs&&"TextEvent"in window&&!E0,Ex=Xs&&(!ws||E0&&8<E0&&11>=E0),Qx=" ",zs=!1;function tx(ye,_e){switch(ye){case"keyup":return $a.indexOf(_e.keyCode)!==-1;case"keydown":return _e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function c0(ye){return ye=ye.detail,typeof ye=="object"&&"data"in ye?ye.data:null}var nx=!1;function Kl(ye,_e){switch(ye){case"compositionend":return c0(_e);case"keypress":return _e.which!==32?null:(zs=!0,Qx);case"textInput":return ye=_e.data,ye===Qx&&zs?null:ye;default:return null}}function Ro(ye,_e){if(nx)return ye==="compositionend"||!ws&&tx(ye,_e)?(ye=Sx(),U0=Z0=n0=null,nx=!1,ye):null;switch(ye){case"paste":return null;case"keypress":if(!(_e.ctrlKey||_e.altKey||_e.metaKey)||_e.ctrlKey&&_e.altKey){if(_e.char&&1<_e.char.length)return _e.char;if(_e.which)return String.fromCharCode(_e.which)}return null;case"compositionend":return Ex&&_e.locale!=="ko"?null:_e.data;default:return null}}var Ql={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pt(ye){var _e=ye&&ye.nodeName&&ye.nodeName.toLowerCase();return _e==="input"?!!Ql[ye.type]:_e==="textarea"}function wt(ye,_e,Pe,$e){x0?t0?t0.push($e):t0=[$e]:x0=$e,_e=F2(_e,"onChange"),0<_e.length&&(Pe=new G0("onChange","change",null,Pe,$e),ye.push({event:Pe,listeners:_e}))}var jt=null,pn=null;function qn(ye){Wd(ye,0)}function Jn(ye){var _e=as(ye);if(Ji(_e))return ye}function dr(ye,_e){if(ye==="change")return _e}var jn=!1;if(Xs){var Lr;if(Xs){var Wr="oninput"in document;if(!Wr){var Br=document.createElement("div");Br.setAttribute("oninput","return;"),Wr=typeof Br.oninput=="function"}Lr=Wr}else Lr=!1;jn=Lr&&(!document.documentMode||9<document.documentMode)}function _i(){jt&&(jt.detachEvent("onpropertychange",mi),pn=jt=null)}function mi(ye){if(ye.propertyName==="value"&&Jn(pn)){var _e=[];wt(_e,pn,ye,os(ye)),bx(qn,_e)}}function ki(ye,_e,Pe){ye==="focusin"?(_i(),jt=_e,pn=Pe,jt.attachEvent("onpropertychange",mi)):ye==="focusout"&&_i()}function va(ye){if(ye==="selectionchange"||ye==="keyup"||ye==="keydown")return Jn(pn)}function wa(ye,_e){if(ye==="click")return Jn(_e)}function Aa(ye,_e){if(ye==="input"||ye==="change")return Jn(_e)}function Ma(ye,_e){return ye===_e&&(ye!==0||1/ye===1/_e)||ye!==ye&&_e!==_e}var Tr=typeof Object.is=="function"?Object.is:Ma;function xi(ye,_e){if(Tr(ye,_e))return!0;if(typeof ye!="object"||ye===null||typeof _e!="object"||_e===null)return!1;var Pe=Object.keys(ye),$e=Object.keys(_e);if(Pe.length!==$e.length)return!1;for($e=0;$e<Pe.length;$e++){var tt=Pe[$e];if(!on.call(_e,tt)||!Tr(ye[tt],_e[tt]))return!1}return!0}function qi(ye){for(;ye&&ye.firstChild;)ye=ye.firstChild;return ye}function ji(ye,_e){var Pe=qi(ye);ye=0;for(var $e;Pe;){if(Pe.nodeType===3){if($e=ye+Pe.textContent.length,ye<=_e&&$e>=_e)return{node:Pe,offset:_e-ye};ye=$e}e:{for(;Pe;){if(Pe.nextSibling){Pe=Pe.nextSibling;break e}Pe=Pe.parentNode}Pe=void 0}Pe=qi(Pe)}}function hi(ye,_e){return ye&&_e?ye===_e?!0:ye&&ye.nodeType===3?!1:_e&&_e.nodeType===3?hi(ye,_e.parentNode):"contains"in ye?ye.contains(_e):ye.compareDocumentPosition?!!(ye.compareDocumentPosition(_e)&16):!1:!1}function w0(ye){ye=ye!=null&&ye.ownerDocument!=null&&ye.ownerDocument.defaultView!=null?ye.ownerDocument.defaultView:window;for(var _e=ss(ye.document);_e instanceof ye.HTMLIFrameElement;){try{var Pe=typeof _e.contentWindow.location.href=="string"}catch{Pe=!1}if(Pe)ye=_e.contentWindow;else break;_e=ss(ye.document)}return _e}function h0(ye){var _e=ye&&ye.nodeName&&ye.nodeName.toLowerCase();return _e&&(_e==="input"&&(ye.type==="text"||ye.type==="search"||ye.type==="tel"||ye.type==="url"||ye.type==="password")||_e==="textarea"||ye.contentEditable==="true")}var rx=Xs&&"documentMode"in document&&11>=document.documentMode,na=null,u0=null,hs=null,Zx=!1;function Jx(ye,_e,Pe){var $e=Pe.window===Pe?Pe.document:Pe.nodeType===9?Pe:Pe.ownerDocument;Zx||na==null||na!==ss($e)||($e=na,"selectionStart"in $e&&h0($e)?$e={start:$e.selectionStart,end:$e.selectionEnd}:($e=($e.ownerDocument&&$e.ownerDocument.defaultView||window).getSelection(),$e={anchorNode:$e.anchorNode,anchorOffset:$e.anchorOffset,focusNode:$e.focusNode,focusOffset:$e.focusOffset}),hs&&xi(hs,$e)||(hs=$e,$e=F2(u0,"onSelect"),0<$e.length&&(_e=new G0("onSelect","select",null,_e,Pe),ye.push({event:_e,listeners:$e}),_e.target=na)))}function Yi(ye,_e){var Pe={};return Pe[ye.toLowerCase()]=_e.toLowerCase(),Pe["Webkit"+ye]="webkit"+_e,Pe["Moz"+ye]="moz"+_e,Pe}var ps={animationend:Yi("Animation","AnimationEnd"),animationiteration:Yi("Animation","AnimationIteration"),animationstart:Yi("Animation","AnimationStart"),transitionrun:Yi("Transition","TransitionRun"),transitionstart:Yi("Transition","TransitionStart"),transitioncancel:Yi("Transition","TransitionCancel"),transitionend:Yi("Transition","TransitionEnd")},r0={},Gh={};Xs&&(Gh=document.createElement("div").style,"AnimationEvent"in window||(delete ps.animationend.animation,delete ps.animationiteration.animation,delete ps.animationstart.animation),"TransitionEvent"in window||delete ps.transitionend.transition);function jx(ye){if(r0[ye])return r0[ye];if(!ps[ye])return ye;var _e=ps[ye],Pe;for(Pe in _e)if(_e.hasOwnProperty(Pe)&&Pe in Gh)return r0[ye]=_e[Pe];return ye}var Hh=jx("animationend"),$h=jx("animationiteration"),Wh=jx("animationstart"),Np=jx("transitionrun"),Dp=jx("transitionstart"),kp=jx("transitioncancel"),qh=jx("transitionend"),Yh=new Map,j2="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");j2.push("scrollEnd");function k0(ye,_e){Yh.set(ye,_e),An(_e,[ye])}var Xh=new WeakMap;function A0(ye,_e){if(typeof ye=="object"&&ye!==null){var Pe=Xh.get(ye);return Pe!==void 0?Pe:(_e={value:ye,source:_e,stack:Ri(_e)},Xh.set(ye,_e),_e)}return{value:ye,source:_e,stack:Ri(_e)}}var M0=[],Po=0,ec=0;function Zl(){for(var ye=Po,_e=ec=Po=0;_e<ye;){var Pe=M0[_e];M0[_e++]=null;var $e=M0[_e];M0[_e++]=null;var tt=M0[_e];M0[_e++]=null;var lt=M0[_e];if(M0[_e++]=null,$e!==null&&tt!==null){var Dt=$e.pending;Dt===null?tt.next=tt:(tt.next=Dt.next,Dt.next=tt),$e.pending=tt}lt!==0&&Kh(Pe,tt,lt)}}function Jl(ye,_e,Pe,$e){M0[Po++]=ye,M0[Po++]=_e,M0[Po++]=Pe,M0[Po++]=$e,ec|=$e,ye.lanes|=$e,ye=ye.alternate,ye!==null&&(ye.lanes|=$e)}function tc(ye,_e,Pe,$e){return Jl(ye,_e,Pe,$e),jl(ye)}function Io(ye,_e){return Jl(ye,null,null,_e),jl(ye)}function Kh(ye,_e,Pe){ye.lanes|=Pe;var $e=ye.alternate;$e!==null&&($e.lanes|=Pe);for(var tt=!1,lt=ye.return;lt!==null;)lt.childLanes|=Pe,$e=lt.alternate,$e!==null&&($e.childLanes|=Pe),lt.tag===22&&(ye=lt.stateNode,ye===null||ye._visibility&1||(tt=!0)),ye=lt,lt=lt.return;return ye.tag===3?(lt=ye.stateNode,tt&&_e!==null&&(tt=31-vr(Pe),ye=lt.hiddenUpdates,$e=ye[tt],$e===null?ye[tt]=[_e]:$e.push(_e),_e.lane=Pe|536870912),lt):null}function jl(ye){if(50<Fl)throw Fl=0,ch=null,Error($(185));for(var _e=ye.return;_e!==null;)ye=_e,_e=ye.return;return ye.tag===3?ye.stateNode:null}var No={};function Lp(ye,_e,Pe,$e){this.tag=ye,this.key=Pe,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=_e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=$e,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function f0(ye,_e,Pe,$e){return new Lp(ye,_e,Pe,$e)}function nc(ye){return ye=ye.prototype,!(!ye||!ye.isReactComponent)}function ix(ye,_e){var Pe=ye.alternate;return Pe===null?(Pe=f0(ye.tag,_e,ye.key,ye.mode),Pe.elementType=ye.elementType,Pe.type=ye.type,Pe.stateNode=ye.stateNode,Pe.alternate=ye,ye.alternate=Pe):(Pe.pendingProps=_e,Pe.type=ye.type,Pe.flags=0,Pe.subtreeFlags=0,Pe.deletions=null),Pe.flags=ye.flags&65011712,Pe.childLanes=ye.childLanes,Pe.lanes=ye.lanes,Pe.child=ye.child,Pe.memoizedProps=ye.memoizedProps,Pe.memoizedState=ye.memoizedState,Pe.updateQueue=ye.updateQueue,_e=ye.dependencies,Pe.dependencies=_e===null?null:{lanes:_e.lanes,firstContext:_e.firstContext},Pe.sibling=ye.sibling,Pe.index=ye.index,Pe.ref=ye.ref,Pe.refCleanup=ye.refCleanup,Pe}function Zh(ye,_e){ye.flags&=65011714;var Pe=ye.alternate;return Pe===null?(ye.childLanes=0,ye.lanes=_e,ye.child=null,ye.subtreeFlags=0,ye.memoizedProps=null,ye.memoizedState=null,ye.updateQueue=null,ye.dependencies=null,ye.stateNode=null):(ye.childLanes=Pe.childLanes,ye.lanes=Pe.lanes,ye.child=Pe.child,ye.subtreeFlags=0,ye.deletions=null,ye.memoizedProps=Pe.memoizedProps,ye.memoizedState=Pe.memoizedState,ye.updateQueue=Pe.updateQueue,ye.type=Pe.type,_e=Pe.dependencies,ye.dependencies=_e===null?null:{lanes:_e.lanes,firstContext:_e.firstContext}),ye}function e2(ye,_e,Pe,$e,tt,lt){var Dt=0;if($e=ye,typeof ye=="function")nc(ye)&&(Dt=1);else if(typeof ye=="string")Dt=Bm(ye,Pe,en.current)?26:ye==="html"||ye==="head"||ye==="body"?27:5;else e:switch(ye){case mt:return ye=f0(31,Pe,_e,tt),ye.elementType=mt,ye.lanes=lt,ye;case Ie:return xo(Pe.children,tt,lt,_e);case De:Dt=8,tt|=24;break;case Be:return ye=f0(12,Pe,_e,tt|2),ye.elementType=Be,ye.lanes=lt,ye;case Qe:return ye=f0(13,Pe,_e,tt),ye.elementType=Qe,ye.lanes=lt,ye;case rt:return ye=f0(19,Pe,_e,tt),ye.elementType=rt,ye.lanes=lt,ye;default:if(typeof ye=="object"&&ye!==null)switch(ye.$$typeof){case Ne:case Xe:Dt=10;break e;case qe:Dt=9;break e;case Ye:Dt=11;break e;case ot:Dt=14;break e;case ct:Dt=16,$e=null;break e}Dt=29,Pe=Error($(130,ye===null?"null":typeof ye,"")),$e=null}return _e=f0(Dt,Pe,_e,tt),_e.elementType=ye,_e.type=$e,_e.lanes=lt,_e}function xo(ye,_e,Pe,$e){return ye=f0(7,ye,$e,_e),ye.lanes=Pe,ye}function rc(ye,_e,Pe){return ye=f0(6,ye,null,_e),ye.lanes=Pe,ye}function ic(ye,_e,Pe){return _e=f0(4,ye.children!==null?ye.children:[],ye.key,_e),_e.lanes=Pe,_e.stateNode={containerInfo:ye.containerInfo,pendingChildren:null,implementation:ye.implementation},_e}var Do=[],ko=0,t2=null,n2=0,C0=[],R0=0,fo=null,ax=1,sx="";function mo(ye,_e){Do[ko++]=n2,Do[ko++]=t2,t2=ye,n2=_e}function Jh(ye,_e,Pe){C0[R0++]=ax,C0[R0++]=sx,C0[R0++]=fo,fo=ye;var $e=ax;ye=sx;var tt=32-vr($e)-1;$e&=~(1<<tt),Pe+=1;var lt=32-vr(_e)+tt;if(30<lt){var Dt=tt-tt%5;lt=($e&(1<<Dt)-1).toString(32),$e>>=Dt,tt-=Dt,ax=1<<32-vr(_e)+tt|Pe<<tt|$e,sx=lt+ye}else ax=1<<lt|Pe<<tt|$e,sx=ye}function ac(ye){ye.return!==null&&(mo(ye,1),Jh(ye,1,0))}function sc(ye){for(;ye===t2;)t2=Do[--ko],Do[ko]=null,n2=Do[--ko],Do[ko]=null;for(;ye===fo;)fo=C0[--R0],C0[R0]=null,sx=C0[--R0],C0[R0]=null,ax=C0[--R0],C0[R0]=null}var Ks=null,Ba=null,Qi=!1,yo=null,$0=!1,xc=Error($(519));function go(ye){var _e=Error($(418,""));throw dl(A0(_e,ye)),xc}function jh(ye){var _e=ye.stateNode,Pe=ye.type,$e=ye.memoizedProps;switch(_e[$i]=ye,_e[Fi]=$e,Pe){case"dialog":Bi("cancel",_e),Bi("close",_e);break;case"iframe":case"object":case"embed":Bi("load",_e);break;case"video":case"audio":for(Pe=0;Pe<Bl.length;Pe++)Bi(Bl[Pe],_e);break;case"source":Bi("error",_e);break;case"img":case"image":case"link":Bi("error",_e),Bi("load",_e);break;case"details":Bi("toggle",_e);break;case"input":Bi("invalid",_e),Pa(_e,$e.value,$e.defaultValue,$e.checked,$e.defaultChecked,$e.type,$e.name,!0),Js(_e);break;case"select":Bi("invalid",_e);break;case"textarea":Bi("invalid",_e),ka(_e,$e.value,$e.defaultValue,$e.children),Js(_e)}Pe=$e.children,typeof Pe!="string"&&typeof Pe!="number"&&typeof Pe!="bigint"||_e.textContent===""+Pe||$e.suppressHydrationWarning===!0||Kd(_e.textContent,Pe)?($e.popover!=null&&(Bi("beforetoggle",_e),Bi("toggle",_e)),$e.onScroll!=null&&Bi("scroll",_e),$e.onScrollEnd!=null&&Bi("scrollend",_e),$e.onClick!=null&&(_e.onclick=O2),_e=!0):_e=!1,_e||go(ye)}function eu(ye){for(Ks=ye.return;Ks;)switch(Ks.tag){case 5:case 13:$0=!1;return;case 27:case 3:$0=!0;return;default:Ks=Ks.return}}function ul(ye){if(ye!==Ks)return!1;if(!Qi)return eu(ye),Qi=!0,!1;var _e=ye.tag,Pe;if((Pe=_e!==3&&_e!==27)&&((Pe=_e===5)&&(Pe=ye.type,Pe=!(Pe!=="form"&&Pe!=="button")||Mh(ye.type,ye.memoizedProps)),Pe=!Pe),Pe&&Ba&&go(ye),eu(ye),_e===13){if(ye=ye.memoizedState,ye=ye!==null?ye.dehydrated:null,!ye)throw Error($(317));e:{for(ye=ye.nextSibling,_e=0;ye;){if(ye.nodeType===8)if(Pe=ye.data,Pe==="/$"){if(_e===0){Ba=F0(ye.nextSibling);break e}_e--}else Pe!=="$"&&Pe!=="$!"&&Pe!=="$?"||_e++;ye=ye.nextSibling}Ba=null}}else _e===27?(_e=Ba,zx(ye.type)?(ye=Ih,Ih=null,Ba=ye):Ba=_e):Ba=Ks?F0(ye.stateNode.nextSibling):null;return!0}function fl(){Ba=Ks=null,Qi=!1}function tu(){var ye=yo;return ye!==null&&(s0===null?s0=ye:s0.push.apply(s0,ye),yo=null),ye}function dl(ye){yo===null?yo=[ye]:yo.push(ye)}var oc=Ft(null),vo=null,xx=null;function wx(ye,_e,Pe){cn(oc,_e._currentValue),_e._currentValue=Pe}function ox(ye){ye._currentValue=oc.current,sn(oc)}function lc(ye,_e,Pe){for(;ye!==null;){var $e=ye.alternate;if((ye.childLanes&_e)!==_e?(ye.childLanes|=_e,$e!==null&&($e.childLanes|=_e)):$e!==null&&($e.childLanes&_e)!==_e&&($e.childLanes|=_e),ye===Pe)break;ye=ye.return}}function cc(ye,_e,Pe,$e){var tt=ye.child;for(tt!==null&&(tt.return=ye);tt!==null;){var lt=tt.dependencies;if(lt!==null){var Dt=tt.child;lt=lt.firstContext;e:for(;lt!==null;){var qt=lt;lt=tt;for(var dn=0;dn<_e.length;dn++)if(qt.context===_e[dn]){lt.lanes|=Pe,qt=lt.alternate,qt!==null&&(qt.lanes|=Pe),lc(lt.return,Pe,ye),$e||(Dt=null);break e}lt=qt.next}}else if(tt.tag===18){if(Dt=tt.return,Dt===null)throw Error($(341));Dt.lanes|=Pe,lt=Dt.alternate,lt!==null&&(lt.lanes|=Pe),lc(Dt,Pe,ye),Dt=null}else Dt=tt.child;if(Dt!==null)Dt.return=tt;else for(Dt=tt;Dt!==null;){if(Dt===ye){Dt=null;break}if(tt=Dt.sibling,tt!==null){tt.return=Dt.return,Dt=tt;break}Dt=Dt.return}tt=Dt}}function pl(ye,_e,Pe,$e){ye=null;for(var tt=_e,lt=!1;tt!==null;){if(!lt){if((tt.flags&524288)!==0)lt=!0;else if((tt.flags&262144)!==0)break}if(tt.tag===10){var Dt=tt.alternate;if(Dt===null)throw Error($(387));if(Dt=Dt.memoizedProps,Dt!==null){var qt=tt.type;Tr(tt.pendingProps.value,Dt.value)||(ye!==null?ye.push(qt):ye=[qt])}}else if(tt===tr.current){if(Dt=tt.alternate,Dt===null)throw Error($(387));Dt.memoizedState.memoizedState!==tt.memoizedState.memoizedState&&(ye!==null?ye.push($l):ye=[$l])}tt=tt.return}ye!==null&&cc(_e,ye,Pe,$e),_e.flags|=262144}function r2(ye){for(ye=ye.firstContext;ye!==null;){if(!Tr(ye.context._currentValue,ye.memoizedValue))return!0;ye=ye.next}return!1}function _o(ye){vo=ye,xx=null,ye=ye.dependencies,ye!==null&&(ye.firstContext=null)}function Gs(ye){return _u(vo,ye)}function i2(ye,_e){return vo===null&&_o(ye),_u(ye,_e)}function _u(ye,_e){var Pe=_e._currentValue;if(_e={context:_e,memoizedValue:Pe,next:null},xx===null){if(ye===null)throw Error($(308));xx=_e,ye.dependencies={lanes:0,firstContext:_e},ye.flags|=524288}else xx=xx.next=_e;return Pe}var Fp=typeof AbortController<"u"?AbortController:function(){var ye=[],_e=this.signal={aborted:!1,addEventListener:function(Pe,$e){ye.push($e)}};this.abort=function(){_e.aborted=!0,ye.forEach(function(Pe){return Pe()})}},Op=H.unstable_scheduleCallback,Bp=H.unstable_NormalPriority,us={$$typeof:Xe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function hc(){return{controller:new Fp,data:new Map,refCount:0}}function ml(ye){ye.refCount--,ye.refCount===0&&Op(Bp,function(){ye.controller.abort()})}var yl=null,uc=0,Lo=0,Fo=null;function Up(ye,_e){if(yl===null){var Pe=yl=[];uc=0,Lo=yh(),Fo={status:"pending",value:void 0,then:function($e){Pe.push($e)}}}return uc++,_e.then(Mu,Mu),_e}function Mu(){if(--uc===0&&yl!==null){Fo!==null&&(Fo.status="fulfilled");var ye=yl;yl=null,Lo=0,Fo=null;for(var _e=0;_e<ye.length;_e++)(0,ye[_e])()}}function Vp(ye,_e){var Pe=[],$e={status:"pending",value:null,reason:null,then:function(tt){Pe.push(tt)}};return ye.then(function(){$e.status="fulfilled",$e.value=_e;for(var tt=0;tt<Pe.length;tt++)(0,Pe[tt])(_e)},function(tt){for($e.status="rejected",$e.reason=tt,tt=0;tt<Pe.length;tt++)(0,Pe[tt])(void 0)}),$e}var Pu=vt.S;vt.S=function(ye,_e){typeof _e=="object"&&_e!==null&&typeof _e.then=="function"&&Up(ye,_e),Pu!==null&&Pu(ye,_e)};var bo=Ft(null);function fc(){var ye=bo.current;return ye!==null?ye:Ca.pooledCache}function a2(ye,_e){_e===null?cn(bo,bo.current):cn(bo,_e.pool)}function Du(){var ye=fc();return ye===null?null:{parent:us._currentValue,pool:ye}}var gl=Error($(460)),Lu=Error($(474)),s2=Error($(542)),dc={then:function(){}};function Bu(ye){return ye=ye.status,ye==="fulfilled"||ye==="rejected"}function x2(){}function Uu(ye,_e,Pe){switch(Pe=ye[Pe],Pe===void 0?ye.push(_e):Pe!==_e&&(_e.then(x2,x2),_e=Pe),_e.status){case"fulfilled":return _e.value;case"rejected":throw ye=_e.reason,zu(ye),ye;default:if(typeof _e.status=="string")_e.then(x2,x2);else{if(ye=Ca,ye!==null&&100<ye.shellSuspendCounter)throw Error($(482));ye=_e,ye.status="pending",ye.then(function($e){if(_e.status==="pending"){var tt=_e;tt.status="fulfilled",tt.value=$e}},function($e){if(_e.status==="pending"){var tt=_e;tt.status="rejected",tt.reason=$e}})}switch(_e.status){case"fulfilled":return _e.value;case"rejected":throw ye=_e.reason,zu(ye),ye}throw vl=_e,gl}}var vl=null;function Vu(){if(vl===null)throw Error($(459));var ye=vl;return vl=null,ye}function zu(ye){if(ye===gl||ye===s2)throw Error($(483))}var Mx=!1;function pc(ye){ye.updateQueue={baseState:ye.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function mc(ye,_e){ye=ye.updateQueue,_e.updateQueue===ye&&(_e.updateQueue={baseState:ye.baseState,firstBaseUpdate:ye.firstBaseUpdate,lastBaseUpdate:ye.lastBaseUpdate,shared:ye.shared,callbacks:null})}function Cx(ye){return{lane:ye,tag:0,payload:null,callback:null,next:null}}function Rx(ye,_e,Pe){var $e=ye.updateQueue;if($e===null)return null;if($e=$e.shared,(ra&2)!==0){var tt=$e.pending;return tt===null?_e.next=_e:(_e.next=tt.next,tt.next=_e),$e.pending=_e,_e=jl(ye),Kh(ye,null,Pe),_e}return Jl(ye,$e,_e,Pe),jl(ye)}function _l(ye,_e,Pe){if(_e=_e.updateQueue,_e!==null&&(_e=_e.shared,(Pe&4194048)!==0)){var $e=_e.lanes;$e&=ye.pendingLanes,Pe|=$e,_e.lanes=Pe,Ui(ye,Pe)}}function yc(ye,_e){var Pe=ye.updateQueue,$e=ye.alternate;if($e!==null&&($e=$e.updateQueue,Pe===$e)){var tt=null,lt=null;if(Pe=Pe.firstBaseUpdate,Pe!==null){do{var Dt={lane:Pe.lane,tag:Pe.tag,payload:Pe.payload,callback:null,next:null};lt===null?tt=lt=Dt:lt=lt.next=Dt,Pe=Pe.next}while(Pe!==null);lt===null?tt=lt=_e:lt=lt.next=_e}else tt=lt=_e;Pe={baseState:$e.baseState,firstBaseUpdate:tt,lastBaseUpdate:lt,shared:$e.shared,callbacks:$e.callbacks},ye.updateQueue=Pe;return}ye=Pe.lastBaseUpdate,ye===null?Pe.firstBaseUpdate=_e:ye.next=_e,Pe.lastBaseUpdate=_e}var gc=!1;function bl(){if(gc){var ye=Fo;if(ye!==null)throw ye}}function Sl(ye,_e,Pe,$e){gc=!1;var tt=ye.updateQueue;Mx=!1;var lt=tt.firstBaseUpdate,Dt=tt.lastBaseUpdate,qt=tt.shared.pending;if(qt!==null){tt.shared.pending=null;var dn=qt,Gn=dn.next;dn.next=null,Dt===null?lt=Gn:Dt.next=Gn,Dt=dn;var mr=ye.alternate;mr!==null&&(mr=mr.updateQueue,qt=mr.lastBaseUpdate,qt!==Dt&&(qt===null?mr.firstBaseUpdate=Gn:qt.next=Gn,mr.lastBaseUpdate=dn))}if(lt!==null){var Er=tt.baseState;Dt=0,mr=Gn=dn=null,qt=lt;do{var Yn=qt.lane&-536870913,Qn=Yn!==qt.lane;if(Qn?(Hi&Yn)===Yn:($e&Yn)===Yn){Yn!==0&&Yn===Lo&&(gc=!0),mr!==null&&(mr=mr.next={lane:0,tag:qt.tag,payload:qt.payload,callback:null,next:null});e:{var wi=ye,Si=qt;Yn=_e;var Ta=Pe;switch(Si.tag){case 1:if(wi=Si.payload,typeof wi=="function"){Er=wi.call(Ta,Er,Yn);break e}Er=wi;break e;case 3:wi.flags=wi.flags&-65537|128;case 0:if(wi=Si.payload,Yn=typeof wi=="function"?wi.call(Ta,Er,Yn):wi,Yn==null)break e;Er=ve({},Er,Yn);break e;case 2:Mx=!0}}Yn=qt.callback,Yn!==null&&(ye.flags|=64,Qn&&(ye.flags|=8192),Qn=tt.callbacks,Qn===null?tt.callbacks=[Yn]:Qn.push(Yn))}else Qn={lane:Yn,tag:qt.tag,payload:qt.payload,callback:qt.callback,next:null},mr===null?(Gn=mr=Qn,dn=Er):mr=mr.next=Qn,Dt|=Yn;if(qt=qt.next,qt===null){if(qt=tt.shared.pending,qt===null)break;Qn=qt,qt=Qn.next,Qn.next=null,tt.lastBaseUpdate=Qn,tt.shared.pending=null}}while(!0);mr===null&&(dn=Er),tt.baseState=dn,tt.firstBaseUpdate=Gn,tt.lastBaseUpdate=mr,lt===null&&(tt.shared.lanes=0),Ox|=Dt,ye.lanes=Dt,ye.memoizedState=Er}}function Gu(ye,_e){if(typeof ye!="function")throw Error($(191,ye));ye.call(_e)}function Hu(ye,_e){var Pe=ye.callbacks;if(Pe!==null)for(ye.callbacks=null,ye=0;ye<Pe.length;ye++)Gu(Pe[ye],_e)}var Oo=Ft(null),o2=Ft(0);function $u(ye,_e){ye=px,cn(o2,ye),cn(Oo,_e),px=ye|_e.baseLanes}function vc(){cn(o2,px),cn(Oo,Oo.current)}function _c(){px=o2.current,sn(Oo),sn(o2)}var Px=0,Ni=null,_a=null,Wa=null,l2=!1,Bo=!1,So=!1,c2=0,Tl=0,Uo=null,zp=0;function Va(){throw Error($(321))}function Sc(ye,_e){if(_e===null)return!1;for(var Pe=0;Pe<_e.length&&Pe<ye.length;Pe++)if(!Tr(ye[Pe],_e[Pe]))return!1;return!0}function Tc(ye,_e,Pe,$e,tt,lt){return Px=lt,Ni=_e,_e.memoizedState=null,_e.updateQueue=null,_e.lanes=0,vt.H=ye===null||ye.memoizedState===null?Rf:Pf,So=!1,lt=Pe($e,tt),So=!1,Bo&&(lt=qu(_e,Pe,$e,tt)),Wu(ye),lt}function Wu(ye){vt.H=m2;var _e=_a!==null&&_a.next!==null;if(Px=0,Wa=_a=Ni=null,l2=!1,Tl=0,Uo=null,_e)throw Error($(300));ye===null||vs||(ye=ye.dependencies,ye!==null&&r2(ye)&&(vs=!0))}function qu(ye,_e,Pe,$e){Ni=ye;var tt=0;do{if(Bo&&(Uo=null),Tl=0,Bo=!1,25<=tt)throw Error($(301));if(tt+=1,Wa=_a=null,ye.updateQueue!=null){var lt=ye.updateQueue;lt.lastEffect=null,lt.events=null,lt.stores=null,lt.memoCache!=null&&(lt.memoCache.index=0)}vt.H=Xp,lt=_e(Pe,$e)}while(Bo);return lt}function Gp(){var ye=vt.H,_e=ye.useState()[0];return _e=typeof _e.then=="function"?El(_e):_e,ye=ye.useState()[0],(_a!==null?_a.memoizedState:null)!==ye&&(Ni.flags|=1024),_e}function Ec(){var ye=c2!==0;return c2=0,ye}function wc(ye,_e,Pe){_e.updateQueue=ye.updateQueue,_e.flags&=-2053,ye.lanes&=~Pe}function Ac(ye){if(l2){for(ye=ye.memoizedState;ye!==null;){var _e=ye.queue;_e!==null&&(_e.pending=null),ye=ye.next}l2=!1}Px=0,Wa=_a=Ni=null,Bo=!1,Tl=c2=0,Uo=null}function i0(){var ye={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wa===null?Ni.memoizedState=Wa=ye:Wa=Wa.next=ye,Wa}function ja(){if(_a===null){var ye=Ni.alternate;ye=ye!==null?ye.memoizedState:null}else ye=_a.next;var _e=Wa===null?Ni.memoizedState:Wa.next;if(_e!==null)Wa=_e,_a=ye;else{if(ye===null)throw Ni.alternate===null?Error($(467)):Error($(310));_a=ye,ye={memoizedState:_a.memoizedState,baseState:_a.baseState,baseQueue:_a.baseQueue,queue:_a.queue,next:null},Wa===null?Ni.memoizedState=Wa=ye:Wa=Wa.next=ye}return Wa}function Mc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function El(ye){var _e=Tl;return Tl+=1,Uo===null&&(Uo=[]),ye=Uu(Uo,ye,_e),_e=Ni,(Wa===null?_e.memoizedState:Wa.next)===null&&(_e=_e.alternate,vt.H=_e===null||_e.memoizedState===null?Rf:Pf),ye}function h2(ye){if(ye!==null&&typeof ye=="object"){if(typeof ye.then=="function")return El(ye);if(ye.$$typeof===Xe)return Gs(ye)}throw Error($(438,String(ye)))}function Cc(ye){var _e=null,Pe=Ni.updateQueue;if(Pe!==null&&(_e=Pe.memoCache),_e==null){var $e=Ni.alternate;$e!==null&&($e=$e.updateQueue,$e!==null&&($e=$e.memoCache,$e!=null&&(_e={data:$e.data.map(function(tt){return tt.slice()}),index:0})))}if(_e==null&&(_e={data:[],index:0}),Pe===null&&(Pe=Mc(),Ni.updateQueue=Pe),Pe.memoCache=_e,Pe=_e.data[_e.index],Pe===void 0)for(Pe=_e.data[_e.index]=Array(ye),$e=0;$e<ye;$e++)Pe[$e]=_t;return _e.index++,Pe}function lx(ye,_e){return typeof _e=="function"?_e(ye):_e}function u2(ye){var _e=ja();return Rc(_e,_a,ye)}function Rc(ye,_e,Pe){var $e=ye.queue;if($e===null)throw Error($(311));$e.lastRenderedReducer=Pe;var tt=ye.baseQueue,lt=$e.pending;if(lt!==null){if(tt!==null){var Dt=tt.next;tt.next=lt.next,lt.next=Dt}_e.baseQueue=tt=lt,$e.pending=null}if(lt=ye.baseState,tt===null)ye.memoizedState=lt;else{_e=tt.next;var qt=Dt=null,dn=null,Gn=_e,mr=!1;do{var Er=Gn.lane&-536870913;if(Er!==Gn.lane?(Hi&Er)===Er:(Px&Er)===Er){var Yn=Gn.revertLane;if(Yn===0)dn!==null&&(dn=dn.next={lane:0,revertLane:0,action:Gn.action,hasEagerState:Gn.hasEagerState,eagerState:Gn.eagerState,next:null}),Er===Lo&&(mr=!0);else if((Px&Yn)===Yn){Gn=Gn.next,Yn===Lo&&(mr=!0);continue}else Er={lane:0,revertLane:Gn.revertLane,action:Gn.action,hasEagerState:Gn.hasEagerState,eagerState:Gn.eagerState,next:null},dn===null?(qt=dn=Er,Dt=lt):dn=dn.next=Er,Ni.lanes|=Yn,Ox|=Yn;Er=Gn.action,So&&Pe(lt,Er),lt=Gn.hasEagerState?Gn.eagerState:Pe(lt,Er)}else Yn={lane:Er,revertLane:Gn.revertLane,action:Gn.action,hasEagerState:Gn.hasEagerState,eagerState:Gn.eagerState,next:null},dn===null?(qt=dn=Yn,Dt=lt):dn=dn.next=Yn,Ni.lanes|=Er,Ox|=Er;Gn=Gn.next}while(Gn!==null&&Gn!==_e);if(dn===null?Dt=lt:dn.next=qt,!Tr(lt,ye.memoizedState)&&(vs=!0,mr&&(Pe=Fo,Pe!==null)))throw Pe;ye.memoizedState=lt,ye.baseState=Dt,ye.baseQueue=dn,$e.lastRenderedState=lt}return tt===null&&($e.lanes=0),[ye.memoizedState,$e.dispatch]}function Pc(ye){var _e=ja(),Pe=_e.queue;if(Pe===null)throw Error($(311));Pe.lastRenderedReducer=ye;var $e=Pe.dispatch,tt=Pe.pending,lt=_e.memoizedState;if(tt!==null){Pe.pending=null;var Dt=tt=tt.next;do lt=ye(lt,Dt.action),Dt=Dt.next;while(Dt!==tt);Tr(lt,_e.memoizedState)||(vs=!0),_e.memoizedState=lt,_e.baseQueue===null&&(_e.baseState=lt),Pe.lastRenderedState=lt}return[lt,$e]}function Yu(ye,_e,Pe){var $e=Ni,tt=ja(),lt=Qi;if(lt){if(Pe===void 0)throw Error($(407));Pe=Pe()}else Pe=_e();var Dt=!Tr((_a||tt).memoizedState,Pe);Dt&&(tt.memoizedState=Pe,vs=!0),tt=tt.queue;var qt=Qu.bind(null,$e,tt,ye);if(wl(2048,8,qt,[ye]),tt.getSnapshot!==_e||Dt||Wa!==null&&Wa.memoizedState.tag&1){if($e.flags|=2048,Vo(9,f2(),Ku.bind(null,$e,tt,Pe,_e),null),Ca===null)throw Error($(349));lt||(Px&124)!==0||Xu($e,_e,Pe)}return Pe}function Xu(ye,_e,Pe){ye.flags|=16384,ye={getSnapshot:_e,value:Pe},_e=Ni.updateQueue,_e===null?(_e=Mc(),Ni.updateQueue=_e,_e.stores=[ye]):(Pe=_e.stores,Pe===null?_e.stores=[ye]:Pe.push(ye))}function Ku(ye,_e,Pe,$e){_e.value=Pe,_e.getSnapshot=$e,Zu(_e)&&Ju(ye)}function Qu(ye,_e,Pe){return Pe(function(){Zu(_e)&&Ju(ye)})}function Zu(ye){var _e=ye.getSnapshot;ye=ye.value;try{var Pe=_e();return!Tr(ye,Pe)}catch{return!0}}function Ju(ye){var _e=Io(ye,2);_e!==null&&g0(_e,ye,2)}function Ic(ye){var _e=i0();if(typeof ye=="function"){var Pe=ye;if(ye=Pe(),So){Nr(!0);try{Pe()}finally{Nr(!1)}}}return _e.memoizedState=_e.baseState=ye,_e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:lx,lastRenderedState:ye},_e}function ju(ye,_e,Pe,$e){return ye.baseState=Pe,Rc(ye,_a,typeof $e=="function"?$e:lx)}function Hp(ye,_e,Pe,$e,tt){if(p2(ye))throw Error($(485));if(ye=_e.action,ye!==null){var lt={payload:tt,action:ye,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Dt){lt.listeners.push(Dt)}};vt.T!==null?Pe(!0):lt.isTransition=!1,$e(lt),Pe=_e.pending,Pe===null?(lt.next=_e.pending=lt,ef(_e,lt)):(lt.next=Pe.next,_e.pending=Pe.next=lt)}}function ef(ye,_e){var Pe=_e.action,$e=_e.payload,tt=ye.state;if(_e.isTransition){var lt=vt.T,Dt={};vt.T=Dt;try{var qt=Pe(tt,$e),dn=vt.S;dn!==null&&dn(Dt,qt),tf(ye,_e,qt)}catch(Gn){Nc(ye,_e,Gn)}finally{vt.T=lt}}else try{lt=Pe(tt,$e),tf(ye,_e,lt)}catch(Gn){Nc(ye,_e,Gn)}}function tf(ye,_e,Pe){Pe!==null&&typeof Pe=="object"&&typeof Pe.then=="function"?Pe.then(function($e){nf(ye,_e,$e)},function($e){return Nc(ye,_e,$e)}):nf(ye,_e,Pe)}function nf(ye,_e,Pe){_e.status="fulfilled",_e.value=Pe,rf(_e),ye.state=Pe,_e=ye.pending,_e!==null&&(Pe=_e.next,Pe===_e?ye.pending=null:(Pe=Pe.next,_e.next=Pe,ef(ye,Pe)))}function Nc(ye,_e,Pe){var $e=ye.pending;if(ye.pending=null,$e!==null){$e=$e.next;do _e.status="rejected",_e.reason=Pe,rf(_e),_e=_e.next;while(_e!==$e)}ye.action=null}function rf(ye){ye=ye.listeners;for(var _e=0;_e<ye.length;_e++)(0,ye[_e])()}function af(ye,_e){return _e}function sf(ye,_e){if(Qi){var Pe=Ca.formState;if(Pe!==null){e:{var $e=Ni;if(Qi){if(Ba){t:{for(var tt=Ba,lt=$0;tt.nodeType!==8;){if(!lt){tt=null;break t}if(tt=F0(tt.nextSibling),tt===null){tt=null;break t}}lt=tt.data,tt=lt==="F!"||lt==="F"?tt:null}if(tt){Ba=F0(tt.nextSibling),$e=tt.data==="F!";break e}}go($e)}$e=!1}$e&&(_e=Pe[0])}}return Pe=i0(),Pe.memoizedState=Pe.baseState=_e,$e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:af,lastRenderedState:_e},Pe.queue=$e,Pe=Af.bind(null,Ni,$e),$e.dispatch=Pe,$e=Ic(!1),lt=Uc.bind(null,Ni,!1,$e.queue),$e=i0(),tt={state:_e,dispatch:null,action:ye,pending:null},$e.queue=tt,Pe=Hp.bind(null,Ni,tt,lt,Pe),tt.dispatch=Pe,$e.memoizedState=ye,[_e,Pe,!1]}function xf(ye){var _e=ja();return of(_e,_a,ye)}function of(ye,_e,Pe){if(_e=Rc(ye,_e,af)[0],ye=u2(lx)[0],typeof _e=="object"&&_e!==null&&typeof _e.then=="function")try{var $e=El(_e)}catch(Dt){throw Dt===gl?s2:Dt}else $e=_e;_e=ja();var tt=_e.queue,lt=tt.dispatch;return Pe!==_e.memoizedState&&(Ni.flags|=2048,Vo(9,f2(),$p.bind(null,tt,Pe),null)),[$e,lt,ye]}function $p(ye,_e){ye.action=_e}function lf(ye){var _e=ja(),Pe=_a;if(Pe!==null)return of(_e,Pe,ye);ja(),_e=_e.memoizedState,Pe=ja();var $e=Pe.queue.dispatch;return Pe.memoizedState=ye,[_e,$e,!1]}function Vo(ye,_e,Pe,$e){return ye={tag:ye,create:Pe,deps:$e,inst:_e,next:null},_e=Ni.updateQueue,_e===null&&(_e=Mc(),Ni.updateQueue=_e),Pe=_e.lastEffect,Pe===null?_e.lastEffect=ye.next=ye:($e=Pe.next,Pe.next=ye,ye.next=$e,_e.lastEffect=ye),ye}function f2(){return{destroy:void 0,resource:void 0}}function cf(){return ja().memoizedState}function d2(ye,_e,Pe,$e){var tt=i0();$e=$e===void 0?null:$e,Ni.flags|=ye,tt.memoizedState=Vo(1|_e,f2(),Pe,$e)}function wl(ye,_e,Pe,$e){var tt=ja();$e=$e===void 0?null:$e;var lt=tt.memoizedState.inst;_a!==null&&$e!==null&&Sc($e,_a.memoizedState.deps)?tt.memoizedState=Vo(_e,lt,Pe,$e):(Ni.flags|=ye,tt.memoizedState=Vo(1|_e,lt,Pe,$e))}function hf(ye,_e){d2(8390656,8,ye,_e)}function uf(ye,_e){wl(2048,8,ye,_e)}function ff(ye,_e){return wl(4,2,ye,_e)}function df(ye,_e){return wl(4,4,ye,_e)}function pf(ye,_e){if(typeof _e=="function"){ye=ye();var Pe=_e(ye);return function(){typeof Pe=="function"?Pe():_e(null)}}if(_e!=null)return ye=ye(),_e.current=ye,function(){_e.current=null}}function mf(ye,_e,Pe){Pe=Pe!=null?Pe.concat([ye]):null,wl(4,4,pf.bind(null,_e,ye),Pe)}function Dc(){}function yf(ye,_e){var Pe=ja();_e=_e===void 0?null:_e;var $e=Pe.memoizedState;return _e!==null&&Sc(_e,$e[1])?$e[0]:(Pe.memoizedState=[ye,_e],ye)}function gf(ye,_e){var Pe=ja();_e=_e===void 0?null:_e;var $e=Pe.memoizedState;if(_e!==null&&Sc(_e,$e[1]))return $e[0];if($e=ye(),So){Nr(!0);try{ye()}finally{Nr(!1)}}return Pe.memoizedState=[$e,_e],$e}function Lc(ye,_e,Pe){return Pe===void 0||(Px&1073741824)!==0?ye.memoizedState=_e:(ye.memoizedState=Pe,ye=Sd(),Ni.lanes|=ye,Ox|=ye,Pe)}function vf(ye,_e,Pe,$e){return Tr(Pe,_e)?Pe:Oo.current!==null?(ye=Lc(ye,Pe,$e),Tr(ye,_e)||(vs=!0),ye):(Px&42)===0?(vs=!0,ye.memoizedState=Pe):(ye=Sd(),Ni.lanes|=ye,Ox|=ye,_e)}function _f(ye,_e,Pe,$e,tt){var lt=It.p;It.p=lt!==0&&8>lt?lt:8;var Dt=vt.T,qt={};vt.T=qt,Uc(ye,!1,_e,Pe);try{var dn=tt(),Gn=vt.S;if(Gn!==null&&Gn(qt,dn),dn!==null&&typeof dn=="object"&&typeof dn.then=="function"){var mr=Vp(dn,$e);Al(ye,_e,mr,y0(ye))}else Al(ye,_e,$e,y0(ye))}catch(Er){Al(ye,_e,{then:function(){},status:"rejected",reason:Er},y0())}finally{It.p=lt,vt.T=Dt}}function Wp(){}function Fc(ye,_e,Pe,$e){if(ye.tag!==5)throw Error($(476));var tt=Sf(ye).queue;_f(ye,tt,_e,gt,Pe===null?Wp:function(){return Tf(ye),Pe($e)})}function Sf(ye){var _e=ye.memoizedState;if(_e!==null)return _e;_e={memoizedState:gt,baseState:gt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:lx,lastRenderedState:gt},next:null};var Pe={};return _e.next={memoizedState:Pe,baseState:Pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:lx,lastRenderedState:Pe},next:null},ye.memoizedState=_e,ye=ye.alternate,ye!==null&&(ye.memoizedState=_e),_e}function Tf(ye){var _e=Sf(ye).next.queue;Al(ye,_e,{},y0())}function Bc(){return Gs($l)}function Ef(){return ja().memoizedState}function wf(){return ja().memoizedState}function qp(ye){for(var _e=ye.return;_e!==null;){switch(_e.tag){case 24:case 3:var Pe=y0();ye=Cx(Pe);var $e=Rx(_e,ye,Pe);$e!==null&&(g0($e,_e,Pe),_l($e,_e,Pe)),_e={cache:hc()},ye.payload=_e;return}_e=_e.return}}function Yp(ye,_e,Pe){var $e=y0();Pe={lane:$e,revertLane:0,action:Pe,hasEagerState:!1,eagerState:null,next:null},p2(ye)?Mf(_e,Pe):(Pe=tc(ye,_e,Pe,$e),Pe!==null&&(g0(Pe,ye,$e),Cf(Pe,_e,$e)))}function Af(ye,_e,Pe){var $e=y0();Al(ye,_e,Pe,$e)}function Al(ye,_e,Pe,$e){var tt={lane:$e,revertLane:0,action:Pe,hasEagerState:!1,eagerState:null,next:null};if(p2(ye))Mf(_e,tt);else{var lt=ye.alternate;if(ye.lanes===0&&(lt===null||lt.lanes===0)&&(lt=_e.lastRenderedReducer,lt!==null))try{var Dt=_e.lastRenderedState,qt=lt(Dt,Pe);if(tt.hasEagerState=!0,tt.eagerState=qt,Tr(qt,Dt))return Jl(ye,_e,tt,0),Ca===null&&Zl(),!1}catch{}finally{}if(Pe=tc(ye,_e,tt,$e),Pe!==null)return g0(Pe,ye,$e),Cf(Pe,_e,$e),!0}return!1}function Uc(ye,_e,Pe,$e){if($e={lane:2,revertLane:yh(),action:$e,hasEagerState:!1,eagerState:null,next:null},p2(ye)){if(_e)throw Error($(479))}else _e=tc(ye,Pe,$e,2),_e!==null&&g0(_e,ye,2)}function p2(ye){var _e=ye.alternate;return ye===Ni||_e!==null&&_e===Ni}function Mf(ye,_e){Bo=l2=!0;var Pe=ye.pending;Pe===null?_e.next=_e:(_e.next=Pe.next,Pe.next=_e),ye.pending=_e}function Cf(ye,_e,Pe){if((Pe&4194048)!==0){var $e=_e.lanes;$e&=ye.pendingLanes,Pe|=$e,_e.lanes=Pe,Ui(ye,Pe)}}var m2={readContext:Gs,use:h2,useCallback:Va,useContext:Va,useEffect:Va,useImperativeHandle:Va,useLayoutEffect:Va,useInsertionEffect:Va,useMemo:Va,useReducer:Va,useRef:Va,useState:Va,useDebugValue:Va,useDeferredValue:Va,useTransition:Va,useSyncExternalStore:Va,useId:Va,useHostTransitionStatus:Va,useFormState:Va,useActionState:Va,useOptimistic:Va,useMemoCache:Va,useCacheRefresh:Va},Rf={readContext:Gs,use:h2,useCallback:function(ye,_e){return i0().memoizedState=[ye,_e===void 0?null:_e],ye},useContext:Gs,useEffect:hf,useImperativeHandle:function(ye,_e,Pe){Pe=Pe!=null?Pe.concat([ye]):null,d2(4194308,4,pf.bind(null,_e,ye),Pe)},useLayoutEffect:function(ye,_e){return d2(4194308,4,ye,_e)},useInsertionEffect:function(ye,_e){d2(4,2,ye,_e)},useMemo:function(ye,_e){var Pe=i0();_e=_e===void 0?null:_e;var $e=ye();if(So){Nr(!0);try{ye()}finally{Nr(!1)}}return Pe.memoizedState=[$e,_e],$e},useReducer:function(ye,_e,Pe){var $e=i0();if(Pe!==void 0){var tt=Pe(_e);if(So){Nr(!0);try{Pe(_e)}finally{Nr(!1)}}}else tt=_e;return $e.memoizedState=$e.baseState=tt,ye={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ye,lastRenderedState:tt},$e.queue=ye,ye=ye.dispatch=Yp.bind(null,Ni,ye),[$e.memoizedState,ye]},useRef:function(ye){var _e=i0();return ye={current:ye},_e.memoizedState=ye},useState:function(ye){ye=Ic(ye);var _e=ye.queue,Pe=Af.bind(null,Ni,_e);return _e.dispatch=Pe,[ye.memoizedState,Pe]},useDebugValue:Dc,useDeferredValue:function(ye,_e){var Pe=i0();return Lc(Pe,ye,_e)},useTransition:function(){var ye=Ic(!1);return ye=_f.bind(null,Ni,ye.queue,!0,!1),i0().memoizedState=ye,[!1,ye]},useSyncExternalStore:function(ye,_e,Pe){var $e=Ni,tt=i0();if(Qi){if(Pe===void 0)throw Error($(407));Pe=Pe()}else{if(Pe=_e(),Ca===null)throw Error($(349));(Hi&124)!==0||Xu($e,_e,Pe)}tt.memoizedState=Pe;var lt={value:Pe,getSnapshot:_e};return tt.queue=lt,hf(Qu.bind(null,$e,lt,ye),[ye]),$e.flags|=2048,Vo(9,f2(),Ku.bind(null,$e,lt,Pe,_e),null),Pe},useId:function(){var ye=i0(),_e=Ca.identifierPrefix;if(Qi){var Pe=sx,$e=ax;Pe=($e&~(1<<32-vr($e)-1)).toString(32)+Pe,_e=""+_e+"R"+Pe,Pe=c2++,0<Pe&&(_e+="H"+Pe.toString(32)),_e+=""}else Pe=zp++,_e=""+_e+"r"+Pe.toString(32)+"";return ye.memoizedState=_e},useHostTransitionStatus:Bc,useFormState:sf,useActionState:sf,useOptimistic:function(ye){var _e=i0();_e.memoizedState=_e.baseState=ye;var Pe={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return _e.queue=Pe,_e=Uc.bind(null,Ni,!0,Pe),Pe.dispatch=_e,[ye,_e]},useMemoCache:Cc,useCacheRefresh:function(){return i0().memoizedState=qp.bind(null,Ni)}},Pf={readContext:Gs,use:h2,useCallback:yf,useContext:Gs,useEffect:uf,useImperativeHandle:mf,useInsertionEffect:ff,useLayoutEffect:df,useMemo:gf,useReducer:u2,useRef:cf,useState:function(){return u2(lx)},useDebugValue:Dc,useDeferredValue:function(ye,_e){var Pe=ja();return vf(Pe,_a.memoizedState,ye,_e)},useTransition:function(){var ye=u2(lx)[0],_e=ja().memoizedState;return[typeof ye=="boolean"?ye:El(ye),_e]},useSyncExternalStore:Yu,useId:Ef,useHostTransitionStatus:Bc,useFormState:xf,useActionState:xf,useOptimistic:function(ye,_e){var Pe=ja();return ju(Pe,_a,ye,_e)},useMemoCache:Cc,useCacheRefresh:wf},Xp={readContext:Gs,use:h2,useCallback:yf,useContext:Gs,useEffect:uf,useImperativeHandle:mf,useInsertionEffect:ff,useLayoutEffect:df,useMemo:gf,useReducer:Pc,useRef:cf,useState:function(){return Pc(lx)},useDebugValue:Dc,useDeferredValue:function(ye,_e){var Pe=ja();return _a===null?Lc(Pe,ye,_e):vf(Pe,_a.memoizedState,ye,_e)},useTransition:function(){var ye=Pc(lx)[0],_e=ja().memoizedState;return[typeof ye=="boolean"?ye:El(ye),_e]},useSyncExternalStore:Yu,useId:Ef,useHostTransitionStatus:Bc,useFormState:lf,useActionState:lf,useOptimistic:function(ye,_e){var Pe=ja();return _a!==null?ju(Pe,_a,ye,_e):(Pe.baseState=ye,[ye,Pe.queue.dispatch])},useMemoCache:Cc,useCacheRefresh:wf},zo=null,Ml=0;function y2(ye){var _e=Ml;return Ml+=1,zo===null&&(zo=[]),Uu(zo,ye,_e)}function Cl(ye,_e){_e=_e.props.ref,ye.ref=_e!==void 0?_e:null}function g2(ye,_e){throw _e.$$typeof===Se?Error($(525)):(ye=Object.prototype.toString.call(_e),Error($(31,ye==="[object Object]"?"object with keys {"+Object.keys(_e).join(", ")+"}":ye)))}function If(ye){var _e=ye._init;return _e(ye._payload)}function Nf(ye){function _e(Rn,Tn){if(ye){var On=Rn.deletions;On===null?(Rn.deletions=[Tn],Rn.flags|=16):On.push(Tn)}}function Pe(Rn,Tn){if(!ye)return null;for(;Tn!==null;)_e(Rn,Tn),Tn=Tn.sibling;return null}function $e(Rn){for(var Tn=new Map;Rn!==null;)Rn.key!==null?Tn.set(Rn.key,Rn):Tn.set(Rn.index,Rn),Rn=Rn.sibling;return Tn}function tt(Rn,Tn){return Rn=ix(Rn,Tn),Rn.index=0,Rn.sibling=null,Rn}function lt(Rn,Tn,On){return Rn.index=On,ye?(On=Rn.alternate,On!==null?(On=On.index,On<Tn?(Rn.flags|=67108866,Tn):On):(Rn.flags|=67108866,Tn)):(Rn.flags|=1048576,Tn)}function Dt(Rn){return ye&&Rn.alternate===null&&(Rn.flags|=67108866),Rn}function qt(Rn,Tn,On,_r){return Tn===null||Tn.tag!==6?(Tn=rc(On,Rn.mode,_r),Tn.return=Rn,Tn):(Tn=tt(Tn,On),Tn.return=Rn,Tn)}function dn(Rn,Tn,On,_r){var si=On.type;return si===Ie?mr(Rn,Tn,On.props.children,_r,On.key):Tn!==null&&(Tn.elementType===si||typeof si=="object"&&si!==null&&si.$$typeof===ct&&If(si)===Tn.type)?(Tn=tt(Tn,On.props),Cl(Tn,On),Tn.return=Rn,Tn):(Tn=e2(On.type,On.key,On.props,null,Rn.mode,_r),Cl(Tn,On),Tn.return=Rn,Tn)}function Gn(Rn,Tn,On,_r){return Tn===null||Tn.tag!==4||Tn.stateNode.containerInfo!==On.containerInfo||Tn.stateNode.implementation!==On.implementation?(Tn=ic(On,Rn.mode,_r),Tn.return=Rn,Tn):(Tn=tt(Tn,On.children||[]),Tn.return=Rn,Tn)}function mr(Rn,Tn,On,_r,si){return Tn===null||Tn.tag!==7?(Tn=xo(On,Rn.mode,_r,si),Tn.return=Rn,Tn):(Tn=tt(Tn,On),Tn.return=Rn,Tn)}function Er(Rn,Tn,On){if(typeof Tn=="string"&&Tn!==""||typeof Tn=="number"||typeof Tn=="bigint")return Tn=rc(""+Tn,Rn.mode,On),Tn.return=Rn,Tn;if(typeof Tn=="object"&&Tn!==null){switch(Tn.$$typeof){case Ee:return On=e2(Tn.type,Tn.key,Tn.props,null,Rn.mode,On),Cl(On,Tn),On.return=Rn,On;case Ce:return Tn=ic(Tn,Rn.mode,On),Tn.return=Rn,Tn;case ct:var _r=Tn._init;return Tn=_r(Tn._payload),Er(Rn,Tn,On)}if(Qt(Tn)||Vt(Tn))return Tn=xo(Tn,Rn.mode,On,null),Tn.return=Rn,Tn;if(typeof Tn.then=="function")return Er(Rn,y2(Tn),On);if(Tn.$$typeof===Xe)return Er(Rn,i2(Rn,Tn),On);g2(Rn,Tn)}return null}function Yn(Rn,Tn,On,_r){var si=Tn!==null?Tn.key:null;if(typeof On=="string"&&On!==""||typeof On=="number"||typeof On=="bigint")return si!==null?null:qt(Rn,Tn,""+On,_r);if(typeof On=="object"&&On!==null){switch(On.$$typeof){case Ee:return On.key===si?dn(Rn,Tn,On,_r):null;case Ce:return On.key===si?Gn(Rn,Tn,On,_r):null;case ct:return si=On._init,On=si(On._payload),Yn(Rn,Tn,On,_r)}if(Qt(On)||Vt(On))return si!==null?null:mr(Rn,Tn,On,_r,null);if(typeof On.then=="function")return Yn(Rn,Tn,y2(On),_r);if(On.$$typeof===Xe)return Yn(Rn,Tn,i2(Rn,On),_r);g2(Rn,On)}return null}function Qn(Rn,Tn,On,_r,si){if(typeof _r=="string"&&_r!==""||typeof _r=="number"||typeof _r=="bigint")return Rn=Rn.get(On)||null,qt(Tn,Rn,""+_r,si);if(typeof _r=="object"&&_r!==null){switch(_r.$$typeof){case Ee:return Rn=Rn.get(_r.key===null?On:_r.key)||null,dn(Tn,Rn,_r,si);case Ce:return Rn=Rn.get(_r.key===null?On:_r.key)||null,Gn(Tn,Rn,_r,si);case ct:var Li=_r._init;return _r=Li(_r._payload),Qn(Rn,Tn,On,_r,si)}if(Qt(_r)||Vt(_r))return Rn=Rn.get(On)||null,mr(Tn,Rn,_r,si,null);if(typeof _r.then=="function")return Qn(Rn,Tn,On,y2(_r),si);if(_r.$$typeof===Xe)return Qn(Rn,Tn,On,i2(Tn,_r),si);g2(Tn,_r)}return null}function wi(Rn,Tn,On,_r){for(var si=null,Li=null,pi=Tn,Ti=Tn=0,bs=null;pi!==null&&Ti<On.length;Ti++){pi.index>Ti?(bs=pi,pi=null):bs=pi.sibling;var Xi=Yn(Rn,pi,On[Ti],_r);if(Xi===null){pi===null&&(pi=bs);break}ye&&pi&&Xi.alternate===null&&_e(Rn,pi),Tn=lt(Xi,Tn,Ti),Li===null?si=Xi:Li.sibling=Xi,Li=Xi,pi=bs}if(Ti===On.length)return Pe(Rn,pi),Qi&&mo(Rn,Ti),si;if(pi===null){for(;Ti<On.length;Ti++)pi=Er(Rn,On[Ti],_r),pi!==null&&(Tn=lt(pi,Tn,Ti),Li===null?si=pi:Li.sibling=pi,Li=pi);return Qi&&mo(Rn,Ti),si}for(pi=$e(pi);Ti<On.length;Ti++)bs=Qn(pi,Rn,Ti,On[Ti],_r),bs!==null&&(ye&&bs.alternate!==null&&pi.delete(bs.key===null?Ti:bs.key),Tn=lt(bs,Tn,Ti),Li===null?si=bs:Li.sibling=bs,Li=bs);return ye&&pi.forEach(function(qx){return _e(Rn,qx)}),Qi&&mo(Rn,Ti),si}function Si(Rn,Tn,On,_r){if(On==null)throw Error($(151));for(var si=null,Li=null,pi=Tn,Ti=Tn=0,bs=null,Xi=On.next();pi!==null&&!Xi.done;Ti++,Xi=On.next()){pi.index>Ti?(bs=pi,pi=null):bs=pi.sibling;var qx=Yn(Rn,pi,Xi.value,_r);if(qx===null){pi===null&&(pi=bs);break}ye&&pi&&qx.alternate===null&&_e(Rn,pi),Tn=lt(qx,Tn,Ti),Li===null?si=qx:Li.sibling=qx,Li=qx,pi=bs}if(Xi.done)return Pe(Rn,pi),Qi&&mo(Rn,Ti),si;if(pi===null){for(;!Xi.done;Ti++,Xi=On.next())Xi=Er(Rn,Xi.value,_r),Xi!==null&&(Tn=lt(Xi,Tn,Ti),Li===null?si=Xi:Li.sibling=Xi,Li=Xi);return Qi&&mo(Rn,Ti),si}for(pi=$e(pi);!Xi.done;Ti++,Xi=On.next())Xi=Qn(pi,Rn,Ti,Xi.value,_r),Xi!==null&&(ye&&Xi.alternate!==null&&pi.delete(Xi.key===null?Ti:Xi.key),Tn=lt(Xi,Tn,Ti),Li===null?si=Xi:Li.sibling=Xi,Li=Xi);return ye&&pi.forEach(function(Qm){return _e(Rn,Qm)}),Qi&&mo(Rn,Ti),si}function Ta(Rn,Tn,On,_r){if(typeof On=="object"&&On!==null&&On.type===Ie&&On.key===null&&(On=On.props.children),typeof On=="object"&&On!==null){switch(On.$$typeof){case Ee:e:{for(var si=On.key;Tn!==null;){if(Tn.key===si){if(si=On.type,si===Ie){if(Tn.tag===7){Pe(Rn,Tn.sibling),_r=tt(Tn,On.props.children),_r.return=Rn,Rn=_r;break e}}else if(Tn.elementType===si||typeof si=="object"&&si!==null&&si.$$typeof===ct&&If(si)===Tn.type){Pe(Rn,Tn.sibling),_r=tt(Tn,On.props),Cl(_r,On),_r.return=Rn,Rn=_r;break e}Pe(Rn,Tn);break}else _e(Rn,Tn);Tn=Tn.sibling}On.type===Ie?(_r=xo(On.props.children,Rn.mode,_r,On.key),_r.return=Rn,Rn=_r):(_r=e2(On.type,On.key,On.props,null,Rn.mode,_r),Cl(_r,On),_r.return=Rn,Rn=_r)}return Dt(Rn);case Ce:e:{for(si=On.key;Tn!==null;){if(Tn.key===si)if(Tn.tag===4&&Tn.stateNode.containerInfo===On.containerInfo&&Tn.stateNode.implementation===On.implementation){Pe(Rn,Tn.sibling),_r=tt(Tn,On.children||[]),_r.return=Rn,Rn=_r;break e}else{Pe(Rn,Tn);break}else _e(Rn,Tn);Tn=Tn.sibling}_r=ic(On,Rn.mode,_r),_r.return=Rn,Rn=_r}return Dt(Rn);case ct:return si=On._init,On=si(On._payload),Ta(Rn,Tn,On,_r)}if(Qt(On))return wi(Rn,Tn,On,_r);if(Vt(On)){if(si=Vt(On),typeof si!="function")throw Error($(150));return On=si.call(On),Si(Rn,Tn,On,_r)}if(typeof On.then=="function")return Ta(Rn,Tn,y2(On),_r);if(On.$$typeof===Xe)return Ta(Rn,Tn,i2(Rn,On),_r);g2(Rn,On)}return typeof On=="string"&&On!==""||typeof On=="number"||typeof On=="bigint"?(On=""+On,Tn!==null&&Tn.tag===6?(Pe(Rn,Tn.sibling),_r=tt(Tn,On),_r.return=Rn,Rn=_r):(Pe(Rn,Tn),_r=rc(On,Rn.mode,_r),_r.return=Rn,Rn=_r),Dt(Rn)):Pe(Rn,Tn)}return function(Rn,Tn,On,_r){try{Ml=0;var si=Ta(Rn,Tn,On,_r);return zo=null,si}catch(pi){if(pi===gl||pi===s2)throw pi;var Li=f0(29,pi,null,Rn.mode);return Li.lanes=_r,Li.return=Rn,Li}finally{}}}var Go=Nf(!0),Df=Nf(!1),P0=Ft(null),W0=null;function Ix(ye){var _e=ye.alternate;cn(fs,fs.current&1),cn(P0,ye),W0===null&&(_e===null||Oo.current!==null||_e.memoizedState!==null)&&(W0=ye)}function kf(ye){if(ye.tag===22){if(cn(fs,fs.current),cn(P0,ye),W0===null){var _e=ye.alternate;_e!==null&&_e.memoizedState!==null&&(W0=ye)}}else Nx()}function Nx(){cn(fs,fs.current),cn(P0,P0.current)}function cx(ye){sn(P0),W0===ye&&(W0=null),sn(fs)}var fs=Ft(0);function v2(ye){for(var _e=ye;_e!==null;){if(_e.tag===13){var Pe=_e.memoizedState;if(Pe!==null&&(Pe=Pe.dehydrated,Pe===null||Pe.data==="$?"||Ph(Pe)))return _e}else if(_e.tag===19&&_e.memoizedProps.revealOrder!==void 0){if((_e.flags&128)!==0)return _e}else if(_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===ye)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===ye)return null;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}return null}function Vc(ye,_e,Pe,$e){_e=ye.memoizedState,Pe=Pe($e,_e),Pe=Pe==null?_e:ve({},_e,Pe),ye.memoizedState=Pe,ye.lanes===0&&(ye.updateQueue.baseState=Pe)}var zc={enqueueSetState:function(ye,_e,Pe){ye=ye._reactInternals;var $e=y0(),tt=Cx($e);tt.payload=_e,Pe!=null&&(tt.callback=Pe),_e=Rx(ye,tt,$e),_e!==null&&(g0(_e,ye,$e),_l(_e,ye,$e))},enqueueReplaceState:function(ye,_e,Pe){ye=ye._reactInternals;var $e=y0(),tt=Cx($e);tt.tag=1,tt.payload=_e,Pe!=null&&(tt.callback=Pe),_e=Rx(ye,tt,$e),_e!==null&&(g0(_e,ye,$e),_l(_e,ye,$e))},enqueueForceUpdate:function(ye,_e){ye=ye._reactInternals;var Pe=y0(),$e=Cx(Pe);$e.tag=2,_e!=null&&($e.callback=_e),_e=Rx(ye,$e,Pe),_e!==null&&(g0(_e,ye,Pe),_l(_e,ye,Pe))}};function Lf(ye,_e,Pe,$e,tt,lt,Dt){return ye=ye.stateNode,typeof ye.shouldComponentUpdate=="function"?ye.shouldComponentUpdate($e,lt,Dt):_e.prototype&&_e.prototype.isPureReactComponent?!xi(Pe,$e)||!xi(tt,lt):!0}function Ff(ye,_e,Pe,$e){ye=_e.state,typeof _e.componentWillReceiveProps=="function"&&_e.componentWillReceiveProps(Pe,$e),typeof _e.UNSAFE_componentWillReceiveProps=="function"&&_e.UNSAFE_componentWillReceiveProps(Pe,$e),_e.state!==ye&&zc.enqueueReplaceState(_e,_e.state,null)}function To(ye,_e){var Pe=_e;if("ref"in _e){Pe={};for(var $e in _e)$e!=="ref"&&(Pe[$e]=_e[$e])}if(ye=ye.defaultProps){Pe===_e&&(Pe=ve({},Pe));for(var tt in ye)Pe[tt]===void 0&&(Pe[tt]=ye[tt])}return Pe}var _2=typeof reportError=="function"?reportError:function(ye){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ye=="object"&&ye!==null&&typeof ye.message=="string"?String(ye.message):String(ye),error:ye});if(!window.dispatchEvent(_e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ye);return}console.error(ye)};function Of(ye){_2(ye)}function Bf(ye){console.error(ye)}function Uf(ye){_2(ye)}function S2(ye,_e){try{var Pe=ye.onUncaughtError;Pe(_e.value,{componentStack:_e.stack})}catch($e){setTimeout(function(){throw $e})}}function Vf(ye,_e,Pe){try{var $e=ye.onCaughtError;$e(Pe.value,{componentStack:Pe.stack,errorBoundary:_e.tag===1?_e.stateNode:null})}catch(tt){setTimeout(function(){throw tt})}}function Gc(ye,_e,Pe){return Pe=Cx(Pe),Pe.tag=3,Pe.payload={element:null},Pe.callback=function(){S2(ye,_e)},Pe}function zf(ye){return ye=Cx(ye),ye.tag=3,ye}function Gf(ye,_e,Pe,$e){var tt=Pe.type.getDerivedStateFromError;if(typeof tt=="function"){var lt=$e.value;ye.payload=function(){return tt(lt)},ye.callback=function(){Vf(_e,Pe,$e)}}var Dt=Pe.stateNode;Dt!==null&&typeof Dt.componentDidCatch=="function"&&(ye.callback=function(){Vf(_e,Pe,$e),typeof tt!="function"&&(Bx===null?Bx=new Set([this]):Bx.add(this));var qt=$e.stack;this.componentDidCatch($e.value,{componentStack:qt!==null?qt:""})})}function Kp(ye,_e,Pe,$e,tt){if(Pe.flags|=32768,$e!==null&&typeof $e=="object"&&typeof $e.then=="function"){if(_e=Pe.alternate,_e!==null&&pl(_e,Pe,tt,!0),Pe=P0.current,Pe!==null){switch(Pe.tag){case 13:return W0===null?uh():Pe.alternate===null&&Ua===0&&(Ua=3),Pe.flags&=-257,Pe.flags|=65536,Pe.lanes=tt,$e===dc?Pe.flags|=16384:(_e=Pe.updateQueue,_e===null?Pe.updateQueue=new Set([$e]):_e.add($e),dh(ye,$e,tt)),!1;case 22:return Pe.flags|=65536,$e===dc?Pe.flags|=16384:(_e=Pe.updateQueue,_e===null?(_e={transitions:null,markerInstances:null,retryQueue:new Set([$e])},Pe.updateQueue=_e):(Pe=_e.retryQueue,Pe===null?_e.retryQueue=new Set([$e]):Pe.add($e)),dh(ye,$e,tt)),!1}throw Error($(435,Pe.tag))}return dh(ye,$e,tt),uh(),!1}if(Qi)return _e=P0.current,_e!==null?((_e.flags&65536)===0&&(_e.flags|=256),_e.flags|=65536,_e.lanes=tt,$e!==xc&&(ye=Error($(422),{cause:$e}),dl(A0(ye,Pe)))):($e!==xc&&(_e=Error($(423),{cause:$e}),dl(A0(_e,Pe))),ye=ye.current.alternate,ye.flags|=65536,tt&=-tt,ye.lanes|=tt,$e=A0($e,Pe),tt=Gc(ye.stateNode,$e,tt),yc(ye,tt),Ua!==4&&(Ua=2)),!1;var lt=Error($(520),{cause:$e});if(lt=A0(lt,Pe),Ll===null?Ll=[lt]:Ll.push(lt),Ua!==4&&(Ua=2),_e===null)return!0;$e=A0($e,Pe),Pe=_e;do{switch(Pe.tag){case 3:return Pe.flags|=65536,ye=tt&-tt,Pe.lanes|=ye,ye=Gc(Pe.stateNode,$e,ye),yc(Pe,ye),!1;case 1:if(_e=Pe.type,lt=Pe.stateNode,(Pe.flags&128)===0&&(typeof _e.getDerivedStateFromError=="function"||lt!==null&&typeof lt.componentDidCatch=="function"&&(Bx===null||!Bx.has(lt))))return Pe.flags|=65536,tt&=-tt,Pe.lanes|=tt,tt=zf(tt),Gf(tt,ye,Pe,$e),yc(Pe,tt),!1}Pe=Pe.return}while(Pe!==null);return!1}var Hf=Error($(461)),vs=!1;function As(ye,_e,Pe,$e){_e.child=ye===null?Df(_e,null,Pe,$e):Go(_e,ye.child,Pe,$e)}function $f(ye,_e,Pe,$e,tt){Pe=Pe.render;var lt=_e.ref;if("ref"in $e){var Dt={};for(var qt in $e)qt!=="ref"&&(Dt[qt]=$e[qt])}else Dt=$e;return _o(_e),$e=Tc(ye,_e,Pe,Dt,lt,tt),qt=Ec(),ye!==null&&!vs?(wc(ye,_e,tt),hx(ye,_e,tt)):(Qi&&qt&&ac(_e),_e.flags|=1,As(ye,_e,$e,tt),_e.child)}function Wf(ye,_e,Pe,$e,tt){if(ye===null){var lt=Pe.type;return typeof lt=="function"&&!nc(lt)&&lt.defaultProps===void 0&&Pe.compare===null?(_e.tag=15,_e.type=lt,qf(ye,_e,lt,$e,tt)):(ye=e2(Pe.type,null,$e,_e,_e.mode,tt),ye.ref=_e.ref,ye.return=_e,_e.child=ye)}if(lt=ye.child,!Qc(ye,tt)){var Dt=lt.memoizedProps;if(Pe=Pe.compare,Pe=Pe!==null?Pe:xi,Pe(Dt,$e)&&ye.ref===_e.ref)return hx(ye,_e,tt)}return _e.flags|=1,ye=ix(lt,$e),ye.ref=_e.ref,ye.return=_e,_e.child=ye}function qf(ye,_e,Pe,$e,tt){if(ye!==null){var lt=ye.memoizedProps;if(xi(lt,$e)&&ye.ref===_e.ref)if(vs=!1,_e.pendingProps=$e=lt,Qc(ye,tt))(ye.flags&131072)!==0&&(vs=!0);else return _e.lanes=ye.lanes,hx(ye,_e,tt)}return Hc(ye,_e,Pe,$e,tt)}function Yf(ye,_e,Pe){var $e=_e.pendingProps,tt=$e.children,lt=ye!==null?ye.memoizedState:null;if($e.mode==="hidden"){if((_e.flags&128)!==0){if($e=lt!==null?lt.baseLanes|Pe:Pe,ye!==null){for(tt=_e.child=ye.child,lt=0;tt!==null;)lt=lt|tt.lanes|tt.childLanes,tt=tt.sibling;_e.childLanes=lt&~$e}else _e.childLanes=0,_e.child=null;return Xf(ye,_e,$e,Pe)}if((Pe&536870912)!==0)_e.memoizedState={baseLanes:0,cachePool:null},ye!==null&&a2(_e,lt!==null?lt.cachePool:null),lt!==null?$u(_e,lt):vc(),kf(_e);else return _e.lanes=_e.childLanes=536870912,Xf(ye,_e,lt!==null?lt.baseLanes|Pe:Pe,Pe)}else lt!==null?(a2(_e,lt.cachePool),$u(_e,lt),Nx(),_e.memoizedState=null):(ye!==null&&a2(_e,null),vc(),Nx());return As(ye,_e,tt,Pe),_e.child}function Xf(ye,_e,Pe,$e){var tt=fc();return tt=tt===null?null:{parent:us._currentValue,pool:tt},_e.memoizedState={baseLanes:Pe,cachePool:tt},ye!==null&&a2(_e,null),vc(),kf(_e),ye!==null&&pl(ye,_e,$e,!0),null}function T2(ye,_e){var Pe=_e.ref;if(Pe===null)ye!==null&&ye.ref!==null&&(_e.flags|=4194816);else{if(typeof Pe!="function"&&typeof Pe!="object")throw Error($(284));(ye===null||ye.ref!==Pe)&&(_e.flags|=4194816)}}function Hc(ye,_e,Pe,$e,tt){return _o(_e),Pe=Tc(ye,_e,Pe,$e,void 0,tt),$e=Ec(),ye!==null&&!vs?(wc(ye,_e,tt),hx(ye,_e,tt)):(Qi&&$e&&ac(_e),_e.flags|=1,As(ye,_e,Pe,tt),_e.child)}function Kf(ye,_e,Pe,$e,tt,lt){return _o(_e),_e.updateQueue=null,Pe=qu(_e,$e,Pe,tt),Wu(ye),$e=Ec(),ye!==null&&!vs?(wc(ye,_e,lt),hx(ye,_e,lt)):(Qi&&$e&&ac(_e),_e.flags|=1,As(ye,_e,Pe,lt),_e.child)}function Qf(ye,_e,Pe,$e,tt){if(_o(_e),_e.stateNode===null){var lt=No,Dt=Pe.contextType;typeof Dt=="object"&&Dt!==null&&(lt=Gs(Dt)),lt=new Pe($e,lt),_e.memoizedState=lt.state!==null&&lt.state!==void 0?lt.state:null,lt.updater=zc,_e.stateNode=lt,lt._reactInternals=_e,lt=_e.stateNode,lt.props=$e,lt.state=_e.memoizedState,lt.refs={},pc(_e),Dt=Pe.contextType,lt.context=typeof Dt=="object"&&Dt!==null?Gs(Dt):No,lt.state=_e.memoizedState,Dt=Pe.getDerivedStateFromProps,typeof Dt=="function"&&(Vc(_e,Pe,Dt,$e),lt.state=_e.memoizedState),typeof Pe.getDerivedStateFromProps=="function"||typeof lt.getSnapshotBeforeUpdate=="function"||typeof lt.UNSAFE_componentWillMount!="function"&&typeof lt.componentWillMount!="function"||(Dt=lt.state,typeof lt.componentWillMount=="function"&&lt.componentWillMount(),typeof lt.UNSAFE_componentWillMount=="function"&&lt.UNSAFE_componentWillMount(),Dt!==lt.state&&zc.enqueueReplaceState(lt,lt.state,null),Sl(_e,$e,lt,tt),bl(),lt.state=_e.memoizedState),typeof lt.componentDidMount=="function"&&(_e.flags|=4194308),$e=!0}else if(ye===null){lt=_e.stateNode;var qt=_e.memoizedProps,dn=To(Pe,qt);lt.props=dn;var Gn=lt.context,mr=Pe.contextType;Dt=No,typeof mr=="object"&&mr!==null&&(Dt=Gs(mr));var Er=Pe.getDerivedStateFromProps;mr=typeof Er=="function"||typeof lt.getSnapshotBeforeUpdate=="function",qt=_e.pendingProps!==qt,mr||typeof lt.UNSAFE_componentWillReceiveProps!="function"&&typeof lt.componentWillReceiveProps!="function"||(qt||Gn!==Dt)&&Ff(_e,lt,$e,Dt),Mx=!1;var Yn=_e.memoizedState;lt.state=Yn,Sl(_e,$e,lt,tt),bl(),Gn=_e.memoizedState,qt||Yn!==Gn||Mx?(typeof Er=="function"&&(Vc(_e,Pe,Er,$e),Gn=_e.memoizedState),(dn=Mx||Lf(_e,Pe,dn,$e,Yn,Gn,Dt))?(mr||typeof lt.UNSAFE_componentWillMount!="function"&&typeof lt.componentWillMount!="function"||(typeof lt.componentWillMount=="function"&&lt.componentWillMount(),typeof lt.UNSAFE_componentWillMount=="function"&&lt.UNSAFE_componentWillMount()),typeof lt.componentDidMount=="function"&&(_e.flags|=4194308)):(typeof lt.componentDidMount=="function"&&(_e.flags|=4194308),_e.memoizedProps=$e,_e.memoizedState=Gn),lt.props=$e,lt.state=Gn,lt.context=Dt,$e=dn):(typeof lt.componentDidMount=="function"&&(_e.flags|=4194308),$e=!1)}else{lt=_e.stateNode,mc(ye,_e),Dt=_e.memoizedProps,mr=To(Pe,Dt),lt.props=mr,Er=_e.pendingProps,Yn=lt.context,Gn=Pe.contextType,dn=No,typeof Gn=="object"&&Gn!==null&&(dn=Gs(Gn)),qt=Pe.getDerivedStateFromProps,(Gn=typeof qt=="function"||typeof lt.getSnapshotBeforeUpdate=="function")||typeof lt.UNSAFE_componentWillReceiveProps!="function"&&typeof lt.componentWillReceiveProps!="function"||(Dt!==Er||Yn!==dn)&&Ff(_e,lt,$e,dn),Mx=!1,Yn=_e.memoizedState,lt.state=Yn,Sl(_e,$e,lt,tt),bl();var Qn=_e.memoizedState;Dt!==Er||Yn!==Qn||Mx||ye!==null&&ye.dependencies!==null&&r2(ye.dependencies)?(typeof qt=="function"&&(Vc(_e,Pe,qt,$e),Qn=_e.memoizedState),(mr=Mx||Lf(_e,Pe,mr,$e,Yn,Qn,dn)||ye!==null&&ye.dependencies!==null&&r2(ye.dependencies))?(Gn||typeof lt.UNSAFE_componentWillUpdate!="function"&&typeof lt.componentWillUpdate!="function"||(typeof lt.componentWillUpdate=="function"&&lt.componentWillUpdate($e,Qn,dn),typeof lt.UNSAFE_componentWillUpdate=="function"&&lt.UNSAFE_componentWillUpdate($e,Qn,dn)),typeof lt.componentDidUpdate=="function"&&(_e.flags|=4),typeof lt.getSnapshotBeforeUpdate=="function"&&(_e.flags|=1024)):(typeof lt.componentDidUpdate!="function"||Dt===ye.memoizedProps&&Yn===ye.memoizedState||(_e.flags|=4),typeof lt.getSnapshotBeforeUpdate!="function"||Dt===ye.memoizedProps&&Yn===ye.memoizedState||(_e.flags|=1024),_e.memoizedProps=$e,_e.memoizedState=Qn),lt.props=$e,lt.state=Qn,lt.context=dn,$e=mr):(typeof lt.componentDidUpdate!="function"||Dt===ye.memoizedProps&&Yn===ye.memoizedState||(_e.flags|=4),typeof lt.getSnapshotBeforeUpdate!="function"||Dt===ye.memoizedProps&&Yn===ye.memoizedState||(_e.flags|=1024),$e=!1)}return lt=$e,T2(ye,_e),$e=(_e.flags&128)!==0,lt||$e?(lt=_e.stateNode,Pe=$e&&typeof Pe.getDerivedStateFromError!="function"?null:lt.render(),_e.flags|=1,ye!==null&&$e?(_e.child=Go(_e,ye.child,null,tt),_e.child=Go(_e,null,Pe,tt)):As(ye,_e,Pe,tt),_e.memoizedState=lt.state,ye=_e.child):ye=hx(ye,_e,tt),ye}function Zf(ye,_e,Pe,$e){return fl(),_e.flags|=256,As(ye,_e,Pe,$e),_e.child}var $c={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Wc(ye){return{baseLanes:ye,cachePool:Du()}}function qc(ye,_e,Pe){return ye=ye!==null?ye.childLanes&~Pe:0,_e&&(ye|=I0),ye}function Jf(ye,_e,Pe){var $e=_e.pendingProps,tt=!1,lt=(_e.flags&128)!==0,Dt;if((Dt=lt)||(Dt=ye!==null&&ye.memoizedState===null?!1:(fs.current&2)!==0),Dt&&(tt=!0,_e.flags&=-129),Dt=(_e.flags&32)!==0,_e.flags&=-33,ye===null){if(Qi){if(tt?Ix(_e):Nx(),Qi){var qt=Ba,dn;if(dn=qt){e:{for(dn=qt,qt=$0;dn.nodeType!==8;){if(!qt){qt=null;break e}if(dn=F0(dn.nextSibling),dn===null){qt=null;break e}}qt=dn}qt!==null?(_e.memoizedState={dehydrated:qt,treeContext:fo!==null?{id:ax,overflow:sx}:null,retryLane:536870912,hydrationErrors:null},dn=f0(18,null,null,0),dn.stateNode=qt,dn.return=_e,_e.child=dn,Ks=_e,Ba=null,dn=!0):dn=!1}dn||go(_e)}if(qt=_e.memoizedState,qt!==null&&(qt=qt.dehydrated,qt!==null))return Ph(qt)?_e.lanes=32:_e.lanes=536870912,null;cx(_e)}return qt=$e.children,$e=$e.fallback,tt?(Nx(),tt=_e.mode,qt=E2({mode:"hidden",children:qt},tt),$e=xo($e,tt,Pe,null),qt.return=_e,$e.return=_e,qt.sibling=$e,_e.child=qt,tt=_e.child,tt.memoizedState=Wc(Pe),tt.childLanes=qc(ye,Dt,Pe),_e.memoizedState=$c,$e):(Ix(_e),Yc(_e,qt))}if(dn=ye.memoizedState,dn!==null&&(qt=dn.dehydrated,qt!==null)){if(lt)_e.flags&256?(Ix(_e),_e.flags&=-257,_e=Xc(ye,_e,Pe)):_e.memoizedState!==null?(Nx(),_e.child=ye.child,_e.flags|=128,_e=null):(Nx(),tt=$e.fallback,qt=_e.mode,$e=E2({mode:"visible",children:$e.children},qt),tt=xo(tt,qt,Pe,null),tt.flags|=2,$e.return=_e,tt.return=_e,$e.sibling=tt,_e.child=$e,Go(_e,ye.child,null,Pe),$e=_e.child,$e.memoizedState=Wc(Pe),$e.childLanes=qc(ye,Dt,Pe),_e.memoizedState=$c,_e=tt);else if(Ix(_e),Ph(qt)){if(Dt=qt.nextSibling&&qt.nextSibling.dataset,Dt)var Gn=Dt.dgst;Dt=Gn,$e=Error($(419)),$e.stack="",$e.digest=Dt,dl({value:$e,source:null,stack:null}),_e=Xc(ye,_e,Pe)}else if(vs||pl(ye,_e,Pe,!1),Dt=(Pe&ye.childLanes)!==0,vs||Dt){if(Dt=Ca,Dt!==null&&($e=Pe&-Pe,$e=($e&42)!==0?1:Vi($e),$e=($e&(Dt.suspendedLanes|Pe))!==0?0:$e,$e!==0&&$e!==dn.retryLane))throw dn.retryLane=$e,Io(ye,$e),g0(Dt,ye,$e),Hf;qt.data==="$?"||uh(),_e=Xc(ye,_e,Pe)}else qt.data==="$?"?(_e.flags|=192,_e.child=ye.child,_e=null):(ye=dn.treeContext,Ba=F0(qt.nextSibling),Ks=_e,Qi=!0,yo=null,$0=!1,ye!==null&&(C0[R0++]=ax,C0[R0++]=sx,C0[R0++]=fo,ax=ye.id,sx=ye.overflow,fo=_e),_e=Yc(_e,$e.children),_e.flags|=4096);return _e}return tt?(Nx(),tt=$e.fallback,qt=_e.mode,dn=ye.child,Gn=dn.sibling,$e=ix(dn,{mode:"hidden",children:$e.children}),$e.subtreeFlags=dn.subtreeFlags&65011712,Gn!==null?tt=ix(Gn,tt):(tt=xo(tt,qt,Pe,null),tt.flags|=2),tt.return=_e,$e.return=_e,$e.sibling=tt,_e.child=$e,$e=tt,tt=_e.child,qt=ye.child.memoizedState,qt===null?qt=Wc(Pe):(dn=qt.cachePool,dn!==null?(Gn=us._currentValue,dn=dn.parent!==Gn?{parent:Gn,pool:Gn}:dn):dn=Du(),qt={baseLanes:qt.baseLanes|Pe,cachePool:dn}),tt.memoizedState=qt,tt.childLanes=qc(ye,Dt,Pe),_e.memoizedState=$c,$e):(Ix(_e),Pe=ye.child,ye=Pe.sibling,Pe=ix(Pe,{mode:"visible",children:$e.children}),Pe.return=_e,Pe.sibling=null,ye!==null&&(Dt=_e.deletions,Dt===null?(_e.deletions=[ye],_e.flags|=16):Dt.push(ye)),_e.child=Pe,_e.memoizedState=null,Pe)}function Yc(ye,_e){return _e=E2({mode:"visible",children:_e},ye.mode),_e.return=ye,ye.child=_e}function E2(ye,_e){return ye=f0(22,ye,null,_e),ye.lanes=0,ye.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},ye}function Xc(ye,_e,Pe){return Go(_e,ye.child,null,Pe),ye=Yc(_e,_e.pendingProps.children),ye.flags|=2,_e.memoizedState=null,ye}function jf(ye,_e,Pe){ye.lanes|=_e;var $e=ye.alternate;$e!==null&&($e.lanes|=_e),lc(ye.return,_e,Pe)}function Kc(ye,_e,Pe,$e,tt){var lt=ye.memoizedState;lt===null?ye.memoizedState={isBackwards:_e,rendering:null,renderingStartTime:0,last:$e,tail:Pe,tailMode:tt}:(lt.isBackwards=_e,lt.rendering=null,lt.renderingStartTime=0,lt.last=$e,lt.tail=Pe,lt.tailMode=tt)}function ed(ye,_e,Pe){var $e=_e.pendingProps,tt=$e.revealOrder,lt=$e.tail;if(As(ye,_e,$e.children,Pe),$e=fs.current,($e&2)!==0)$e=$e&1|2,_e.flags|=128;else{if(ye!==null&&(ye.flags&128)!==0)e:for(ye=_e.child;ye!==null;){if(ye.tag===13)ye.memoizedState!==null&&jf(ye,Pe,_e);else if(ye.tag===19)jf(ye,Pe,_e);else if(ye.child!==null){ye.child.return=ye,ye=ye.child;continue}if(ye===_e)break e;for(;ye.sibling===null;){if(ye.return===null||ye.return===_e)break e;ye=ye.return}ye.sibling.return=ye.return,ye=ye.sibling}$e&=1}switch(cn(fs,$e),tt){case"forwards":for(Pe=_e.child,tt=null;Pe!==null;)ye=Pe.alternate,ye!==null&&v2(ye)===null&&(tt=Pe),Pe=Pe.sibling;Pe=tt,Pe===null?(tt=_e.child,_e.child=null):(tt=Pe.sibling,Pe.sibling=null),Kc(_e,!1,tt,Pe,lt);break;case"backwards":for(Pe=null,tt=_e.child,_e.child=null;tt!==null;){if(ye=tt.alternate,ye!==null&&v2(ye)===null){_e.child=tt;break}ye=tt.sibling,tt.sibling=Pe,Pe=tt,tt=ye}Kc(_e,!0,Pe,null,lt);break;case"together":Kc(_e,!1,null,null,void 0);break;default:_e.memoizedState=null}return _e.child}function hx(ye,_e,Pe){if(ye!==null&&(_e.dependencies=ye.dependencies),Ox|=_e.lanes,(Pe&_e.childLanes)===0)if(ye!==null){if(pl(ye,_e,Pe,!1),(Pe&_e.childLanes)===0)return null}else return null;if(ye!==null&&_e.child!==ye.child)throw Error($(153));if(_e.child!==null){for(ye=_e.child,Pe=ix(ye,ye.pendingProps),_e.child=Pe,Pe.return=_e;ye.sibling!==null;)ye=ye.sibling,Pe=Pe.sibling=ix(ye,ye.pendingProps),Pe.return=_e;Pe.sibling=null}return _e.child}function Qc(ye,_e){return(ye.lanes&_e)!==0?!0:(ye=ye.dependencies,!!(ye!==null&&r2(ye)))}function Qp(ye,_e,Pe){switch(_e.tag){case 3:nr(_e,_e.stateNode.containerInfo),wx(_e,us,ye.memoizedState.cache),fl();break;case 27:case 5:Ur(_e);break;case 4:nr(_e,_e.stateNode.containerInfo);break;case 10:wx(_e,_e.type,_e.memoizedProps.value);break;case 13:var $e=_e.memoizedState;if($e!==null)return $e.dehydrated!==null?(Ix(_e),_e.flags|=128,null):(Pe&_e.child.childLanes)!==0?Jf(ye,_e,Pe):(Ix(_e),ye=hx(ye,_e,Pe),ye!==null?ye.sibling:null);Ix(_e);break;case 19:var tt=(ye.flags&128)!==0;if($e=(Pe&_e.childLanes)!==0,$e||(pl(ye,_e,Pe,!1),$e=(Pe&_e.childLanes)!==0),tt){if($e)return ed(ye,_e,Pe);_e.flags|=128}if(tt=_e.memoizedState,tt!==null&&(tt.rendering=null,tt.tail=null,tt.lastEffect=null),cn(fs,fs.current),$e)break;return null;case 22:case 23:return _e.lanes=0,Yf(ye,_e,Pe);case 24:wx(_e,us,ye.memoizedState.cache)}return hx(ye,_e,Pe)}function td(ye,_e,Pe){if(ye!==null)if(ye.memoizedProps!==_e.pendingProps)vs=!0;else{if(!Qc(ye,Pe)&&(_e.flags&128)===0)return vs=!1,Qp(ye,_e,Pe);vs=(ye.flags&131072)!==0}else vs=!1,Qi&&(_e.flags&1048576)!==0&&Jh(_e,n2,_e.index);switch(_e.lanes=0,_e.tag){case 16:e:{ye=_e.pendingProps;var $e=_e.elementType,tt=$e._init;if($e=tt($e._payload),_e.type=$e,typeof $e=="function")nc($e)?(ye=To($e,ye),_e.tag=1,_e=Qf(null,_e,$e,ye,Pe)):(_e.tag=0,_e=Hc(null,_e,$e,ye,Pe));else{if($e!=null){if(tt=$e.$$typeof,tt===Ye){_e.tag=11,_e=$f(null,_e,$e,ye,Pe);break e}else if(tt===ot){_e.tag=14,_e=Wf(null,_e,$e,ye,Pe);break e}}throw _e=$t($e)||$e,Error($(306,_e,""))}}return _e;case 0:return Hc(ye,_e,_e.type,_e.pendingProps,Pe);case 1:return $e=_e.type,tt=To($e,_e.pendingProps),Qf(ye,_e,$e,tt,Pe);case 3:e:{if(nr(_e,_e.stateNode.containerInfo),ye===null)throw Error($(387));$e=_e.pendingProps;var lt=_e.memoizedState;tt=lt.element,mc(ye,_e),Sl(_e,$e,null,Pe);var Dt=_e.memoizedState;if($e=Dt.cache,wx(_e,us,$e),$e!==lt.cache&&cc(_e,[us],Pe,!0),bl(),$e=Dt.element,lt.isDehydrated)if(lt={element:$e,isDehydrated:!1,cache:Dt.cache},_e.updateQueue.baseState=lt,_e.memoizedState=lt,_e.flags&256){_e=Zf(ye,_e,$e,Pe);break e}else if($e!==tt){tt=A0(Error($(424)),_e),dl(tt),_e=Zf(ye,_e,$e,Pe);break e}else{switch(ye=_e.stateNode.containerInfo,ye.nodeType){case 9:ye=ye.body;break;default:ye=ye.nodeName==="HTML"?ye.ownerDocument.body:ye}for(Ba=F0(ye.firstChild),Ks=_e,Qi=!0,yo=null,$0=!0,Pe=Df(_e,null,$e,Pe),_e.child=Pe;Pe;)Pe.flags=Pe.flags&-3|4096,Pe=Pe.sibling}else{if(fl(),$e===tt){_e=hx(ye,_e,Pe);break e}As(ye,_e,$e,Pe)}_e=_e.child}return _e;case 26:return T2(ye,_e),ye===null?(Pe=sp(_e.type,null,_e.pendingProps,null))?_e.memoizedState=Pe:Qi||(Pe=_e.type,ye=_e.pendingProps,$e=B2(Pn.current).createElement(Pe),$e[$i]=_e,$e[Fi]=ye,Is($e,Pe,ye),vn($e),_e.stateNode=$e):_e.memoizedState=sp(_e.type,ye.memoizedProps,_e.pendingProps,ye.memoizedState),null;case 27:return Ur(_e),ye===null&&Qi&&($e=_e.stateNode=np(_e.type,_e.pendingProps,Pn.current),Ks=_e,$0=!0,tt=Ba,zx(_e.type)?(Ih=tt,Ba=F0($e.firstChild)):Ba=tt),As(ye,_e,_e.pendingProps.children,Pe),T2(ye,_e),ye===null&&(_e.flags|=4194304),_e.child;case 5:return ye===null&&Qi&&((tt=$e=Ba)&&($e=wm($e,_e.type,_e.pendingProps,$0),$e!==null?(_e.stateNode=$e,Ks=_e,Ba=F0($e.firstChild),$0=!1,tt=!0):tt=!1),tt||go(_e)),Ur(_e),tt=_e.type,lt=_e.pendingProps,Dt=ye!==null?ye.memoizedProps:null,$e=lt.children,Mh(tt,lt)?$e=null:Dt!==null&&Mh(tt,Dt)&&(_e.flags|=32),_e.memoizedState!==null&&(tt=Tc(ye,_e,Gp,null,null,Pe),$l._currentValue=tt),T2(ye,_e),As(ye,_e,$e,Pe),_e.child;case 6:return ye===null&&Qi&&((ye=Pe=Ba)&&(Pe=Am(Pe,_e.pendingProps,$0),Pe!==null?(_e.stateNode=Pe,Ks=_e,Ba=null,ye=!0):ye=!1),ye||go(_e)),null;case 13:return Jf(ye,_e,Pe);case 4:return nr(_e,_e.stateNode.containerInfo),$e=_e.pendingProps,ye===null?_e.child=Go(_e,null,$e,Pe):As(ye,_e,$e,Pe),_e.child;case 11:return $f(ye,_e,_e.type,_e.pendingProps,Pe);case 7:return As(ye,_e,_e.pendingProps,Pe),_e.child;case 8:return As(ye,_e,_e.pendingProps.children,Pe),_e.child;case 12:return As(ye,_e,_e.pendingProps.children,Pe),_e.child;case 10:return $e=_e.pendingProps,wx(_e,_e.type,$e.value),As(ye,_e,$e.children,Pe),_e.child;case 9:return tt=_e.type._context,$e=_e.pendingProps.children,_o(_e),tt=Gs(tt),$e=$e(tt),_e.flags|=1,As(ye,_e,$e,Pe),_e.child;case 14:return Wf(ye,_e,_e.type,_e.pendingProps,Pe);case 15:return qf(ye,_e,_e.type,_e.pendingProps,Pe);case 19:return ed(ye,_e,Pe);case 31:return $e=_e.pendingProps,Pe=_e.mode,$e={mode:$e.mode,children:$e.children},ye===null?(Pe=E2($e,Pe),Pe.ref=_e.ref,_e.child=Pe,Pe.return=_e,_e=Pe):(Pe=ix(ye.child,$e),Pe.ref=_e.ref,_e.child=Pe,Pe.return=_e,_e=Pe),_e;case 22:return Yf(ye,_e,Pe);case 24:return _o(_e),$e=Gs(us),ye===null?(tt=fc(),tt===null&&(tt=Ca,lt=hc(),tt.pooledCache=lt,lt.refCount++,lt!==null&&(tt.pooledCacheLanes|=Pe),tt=lt),_e.memoizedState={parent:$e,cache:tt},pc(_e),wx(_e,us,tt)):((ye.lanes&Pe)!==0&&(mc(ye,_e),Sl(_e,null,null,Pe),bl()),tt=ye.memoizedState,lt=_e.memoizedState,tt.parent!==$e?(tt={parent:$e,cache:$e},_e.memoizedState=tt,_e.lanes===0&&(_e.memoizedState=_e.updateQueue.baseState=tt),wx(_e,us,$e)):($e=lt.cache,wx(_e,us,$e),$e!==tt.cache&&cc(_e,[us],Pe,!0))),As(ye,_e,_e.pendingProps.children,Pe),_e.child;case 29:throw _e.pendingProps}throw Error($(156,_e.tag))}function ux(ye){ye.flags|=4}function nd(ye,_e){if(_e.type!=="stylesheet"||(_e.state.loading&4)!==0)ye.flags&=-16777217;else if(ye.flags|=16777216,!up(_e)){if(_e=P0.current,_e!==null&&((Hi&4194048)===Hi?W0!==null:(Hi&62914560)!==Hi&&(Hi&536870912)===0||_e!==W0))throw vl=dc,Lu;ye.flags|=8192}}function w2(ye,_e){_e!==null&&(ye.flags|=4),ye.flags&16384&&(_e=ye.tag!==22?xr():536870912,ye.lanes|=_e,tl|=_e)}function Rl(ye,_e){if(!Qi)switch(ye.tailMode){case"hidden":_e=ye.tail;for(var Pe=null;_e!==null;)_e.alternate!==null&&(Pe=_e),_e=_e.sibling;Pe===null?ye.tail=null:Pe.sibling=null;break;case"collapsed":Pe=ye.tail;for(var $e=null;Pe!==null;)Pe.alternate!==null&&($e=Pe),Pe=Pe.sibling;$e===null?_e||ye.tail===null?ye.tail=null:ye.tail.sibling=null:$e.sibling=null}}function Oa(ye){var _e=ye.alternate!==null&&ye.alternate.child===ye.child,Pe=0,$e=0;if(_e)for(var tt=ye.child;tt!==null;)Pe|=tt.lanes|tt.childLanes,$e|=tt.subtreeFlags&65011712,$e|=tt.flags&65011712,tt.return=ye,tt=tt.sibling;else for(tt=ye.child;tt!==null;)Pe|=tt.lanes|tt.childLanes,$e|=tt.subtreeFlags,$e|=tt.flags,tt.return=ye,tt=tt.sibling;return ye.subtreeFlags|=$e,ye.childLanes=Pe,_e}function Zp(ye,_e,Pe){var $e=_e.pendingProps;switch(sc(_e),_e.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oa(_e),null;case 1:return Oa(_e),null;case 3:return Pe=_e.stateNode,$e=null,ye!==null&&($e=ye.memoizedState.cache),_e.memoizedState.cache!==$e&&(_e.flags|=2048),ox(us),Fr(),Pe.pendingContext&&(Pe.context=Pe.pendingContext,Pe.pendingContext=null),(ye===null||ye.child===null)&&(ul(_e)?ux(_e):ye===null||ye.memoizedState.isDehydrated&&(_e.flags&256)===0||(_e.flags|=1024,tu())),Oa(_e),null;case 26:return Pe=_e.memoizedState,ye===null?(ux(_e),Pe!==null?(Oa(_e),nd(_e,Pe)):(Oa(_e),_e.flags&=-16777217)):Pe?Pe!==ye.memoizedState?(ux(_e),Oa(_e),nd(_e,Pe)):(Oa(_e),_e.flags&=-16777217):(ye.memoizedProps!==$e&&ux(_e),Oa(_e),_e.flags&=-16777217),null;case 27:Kr(_e),Pe=Pn.current;var tt=_e.type;if(ye!==null&&_e.stateNode!=null)ye.memoizedProps!==$e&&ux(_e);else{if(!$e){if(_e.stateNode===null)throw Error($(166));return Oa(_e),null}ye=en.current,ul(_e)?jh(_e):(ye=np(tt,$e,Pe),_e.stateNode=ye,ux(_e))}return Oa(_e),null;case 5:if(Kr(_e),Pe=_e.type,ye!==null&&_e.stateNode!=null)ye.memoizedProps!==$e&&ux(_e);else{if(!$e){if(_e.stateNode===null)throw Error($(166));return Oa(_e),null}if(ye=en.current,ul(_e))jh(_e);else{switch(tt=B2(Pn.current),ye){case 1:ye=tt.createElementNS("http://www.w3.org/2000/svg",Pe);break;case 2:ye=tt.createElementNS("http://www.w3.org/1998/Math/MathML",Pe);break;default:switch(Pe){case"svg":ye=tt.createElementNS("http://www.w3.org/2000/svg",Pe);break;case"math":ye=tt.createElementNS("http://www.w3.org/1998/Math/MathML",Pe);break;case"script":ye=tt.createElement("div"),ye.innerHTML="<script><\/script>",ye=ye.removeChild(ye.firstChild);break;case"select":ye=typeof $e.is=="string"?tt.createElement("select",{is:$e.is}):tt.createElement("select"),$e.multiple?ye.multiple=!0:$e.size&&(ye.size=$e.size);break;default:ye=typeof $e.is=="string"?tt.createElement(Pe,{is:$e.is}):tt.createElement(Pe)}}ye[$i]=_e,ye[Fi]=$e;e:for(tt=_e.child;tt!==null;){if(tt.tag===5||tt.tag===6)ye.appendChild(tt.stateNode);else if(tt.tag!==4&&tt.tag!==27&&tt.child!==null){tt.child.return=tt,tt=tt.child;continue}if(tt===_e)break e;for(;tt.sibling===null;){if(tt.return===null||tt.return===_e)break e;tt=tt.return}tt.sibling.return=tt.return,tt=tt.sibling}_e.stateNode=ye;e:switch(Is(ye,Pe,$e),Pe){case"button":case"input":case"select":case"textarea":ye=!!$e.autoFocus;break e;case"img":ye=!0;break e;default:ye=!1}ye&&ux(_e)}}return Oa(_e),_e.flags&=-16777217,null;case 6:if(ye&&_e.stateNode!=null)ye.memoizedProps!==$e&&ux(_e);else{if(typeof $e!="string"&&_e.stateNode===null)throw Error($(166));if(ye=Pn.current,ul(_e)){if(ye=_e.stateNode,Pe=_e.memoizedProps,$e=null,tt=Ks,tt!==null)switch(tt.tag){case 27:case 5:$e=tt.memoizedProps}ye[$i]=_e,ye=!!(ye.nodeValue===Pe||$e!==null&&$e.suppressHydrationWarning===!0||Kd(ye.nodeValue,Pe)),ye||go(_e)}else ye=B2(ye).createTextNode($e),ye[$i]=_e,_e.stateNode=ye}return Oa(_e),null;case 13:if($e=_e.memoizedState,ye===null||ye.memoizedState!==null&&ye.memoizedState.dehydrated!==null){if(tt=ul(_e),$e!==null&&$e.dehydrated!==null){if(ye===null){if(!tt)throw Error($(318));if(tt=_e.memoizedState,tt=tt!==null?tt.dehydrated:null,!tt)throw Error($(317));tt[$i]=_e}else fl(),(_e.flags&128)===0&&(_e.memoizedState=null),_e.flags|=4;Oa(_e),tt=!1}else tt=tu(),ye!==null&&ye.memoizedState!==null&&(ye.memoizedState.hydrationErrors=tt),tt=!0;if(!tt)return _e.flags&256?(cx(_e),_e):(cx(_e),null)}if(cx(_e),(_e.flags&128)!==0)return _e.lanes=Pe,_e;if(Pe=$e!==null,ye=ye!==null&&ye.memoizedState!==null,Pe){$e=_e.child,tt=null,$e.alternate!==null&&$e.alternate.memoizedState!==null&&$e.alternate.memoizedState.cachePool!==null&&(tt=$e.alternate.memoizedState.cachePool.pool);var lt=null;$e.memoizedState!==null&&$e.memoizedState.cachePool!==null&&(lt=$e.memoizedState.cachePool.pool),lt!==tt&&($e.flags|=2048)}return Pe!==ye&&Pe&&(_e.child.flags|=8192),w2(_e,_e.updateQueue),Oa(_e),null;case 4:return Fr(),ye===null&&Sh(_e.stateNode.containerInfo),Oa(_e),null;case 10:return ox(_e.type),Oa(_e),null;case 19:if(sn(fs),tt=_e.memoizedState,tt===null)return Oa(_e),null;if($e=(_e.flags&128)!==0,lt=tt.rendering,lt===null)if($e)Rl(tt,!1);else{if(Ua!==0||ye!==null&&(ye.flags&128)!==0)for(ye=_e.child;ye!==null;){if(lt=v2(ye),lt!==null){for(_e.flags|=128,Rl(tt,!1),ye=lt.updateQueue,_e.updateQueue=ye,w2(_e,ye),_e.subtreeFlags=0,ye=Pe,Pe=_e.child;Pe!==null;)Zh(Pe,ye),Pe=Pe.sibling;return cn(fs,fs.current&1|2),_e.child}ye=ye.sibling}tt.tail!==null&&ai()>C2&&(_e.flags|=128,$e=!0,Rl(tt,!1),_e.lanes=4194304)}else{if(!$e)if(ye=v2(lt),ye!==null){if(_e.flags|=128,$e=!0,ye=ye.updateQueue,_e.updateQueue=ye,w2(_e,ye),Rl(tt,!0),tt.tail===null&&tt.tailMode==="hidden"&&!lt.alternate&&!Qi)return Oa(_e),null}else 2*ai()-tt.renderingStartTime>C2&&Pe!==536870912&&(_e.flags|=128,$e=!0,Rl(tt,!1),_e.lanes=4194304);tt.isBackwards?(lt.sibling=_e.child,_e.child=lt):(ye=tt.last,ye!==null?ye.sibling=lt:_e.child=lt,tt.last=lt)}return tt.tail!==null?(_e=tt.tail,tt.rendering=_e,tt.tail=_e.sibling,tt.renderingStartTime=ai(),_e.sibling=null,ye=fs.current,cn(fs,$e?ye&1|2:ye&1),_e):(Oa(_e),null);case 22:case 23:return cx(_e),_c(),$e=_e.memoizedState!==null,ye!==null?ye.memoizedState!==null!==$e&&(_e.flags|=8192):$e&&(_e.flags|=8192),$e?(Pe&536870912)!==0&&(_e.flags&128)===0&&(Oa(_e),_e.subtreeFlags&6&&(_e.flags|=8192)):Oa(_e),Pe=_e.updateQueue,Pe!==null&&w2(_e,Pe.retryQueue),Pe=null,ye!==null&&ye.memoizedState!==null&&ye.memoizedState.cachePool!==null&&(Pe=ye.memoizedState.cachePool.pool),$e=null,_e.memoizedState!==null&&_e.memoizedState.cachePool!==null&&($e=_e.memoizedState.cachePool.pool),$e!==Pe&&(_e.flags|=2048),ye!==null&&sn(bo),null;case 24:return Pe=null,ye!==null&&(Pe=ye.memoizedState.cache),_e.memoizedState.cache!==Pe&&(_e.flags|=2048),ox(us),Oa(_e),null;case 25:return null;case 30:return null}throw Error($(156,_e.tag))}function Jp(ye,_e){switch(sc(_e),_e.tag){case 1:return ye=_e.flags,ye&65536?(_e.flags=ye&-65537|128,_e):null;case 3:return ox(us),Fr(),ye=_e.flags,(ye&65536)!==0&&(ye&128)===0?(_e.flags=ye&-65537|128,_e):null;case 26:case 27:case 5:return Kr(_e),null;case 13:if(cx(_e),ye=_e.memoizedState,ye!==null&&ye.dehydrated!==null){if(_e.alternate===null)throw Error($(340));fl()}return ye=_e.flags,ye&65536?(_e.flags=ye&-65537|128,_e):null;case 19:return sn(fs),null;case 4:return Fr(),null;case 10:return ox(_e.type),null;case 22:case 23:return cx(_e),_c(),ye!==null&&sn(bo),ye=_e.flags,ye&65536?(_e.flags=ye&-65537|128,_e):null;case 24:return ox(us),null;case 25:return null;default:return null}}function rd(ye,_e){switch(sc(_e),_e.tag){case 3:ox(us),Fr();break;case 26:case 27:case 5:Kr(_e);break;case 4:Fr();break;case 13:cx(_e);break;case 19:sn(fs);break;case 10:ox(_e.type);break;case 22:case 23:cx(_e),_c(),ye!==null&&sn(bo);break;case 24:ox(us)}}function Pl(ye,_e){try{var Pe=_e.updateQueue,$e=Pe!==null?Pe.lastEffect:null;if($e!==null){var tt=$e.next;Pe=tt;do{if((Pe.tag&ye)===ye){$e=void 0;var lt=Pe.create,Dt=Pe.inst;$e=lt(),Dt.destroy=$e}Pe=Pe.next}while(Pe!==tt)}}catch(qt){Ea(_e,_e.return,qt)}}function Dx(ye,_e,Pe){try{var $e=_e.updateQueue,tt=$e!==null?$e.lastEffect:null;if(tt!==null){var lt=tt.next;$e=lt;do{if(($e.tag&ye)===ye){var Dt=$e.inst,qt=Dt.destroy;if(qt!==void 0){Dt.destroy=void 0,tt=_e;var dn=Pe,Gn=qt;try{Gn()}catch(mr){Ea(tt,dn,mr)}}}$e=$e.next}while($e!==lt)}}catch(mr){Ea(_e,_e.return,mr)}}function id(ye){var _e=ye.updateQueue;if(_e!==null){var Pe=ye.stateNode;try{Hu(_e,Pe)}catch($e){Ea(ye,ye.return,$e)}}}function ad(ye,_e,Pe){Pe.props=To(ye.type,ye.memoizedProps),Pe.state=ye.memoizedState;try{Pe.componentWillUnmount()}catch($e){Ea(ye,_e,$e)}}function Il(ye,_e){try{var Pe=ye.ref;if(Pe!==null){switch(ye.tag){case 26:case 27:case 5:var $e=ye.stateNode;break;case 30:$e=ye.stateNode;break;default:$e=ye.stateNode}typeof Pe=="function"?ye.refCleanup=Pe($e):Pe.current=$e}}catch(tt){Ea(ye,_e,tt)}}function q0(ye,_e){var Pe=ye.ref,$e=ye.refCleanup;if(Pe!==null)if(typeof $e=="function")try{$e()}catch(tt){Ea(ye,_e,tt)}finally{ye.refCleanup=null,ye=ye.alternate,ye!=null&&(ye.refCleanup=null)}else if(typeof Pe=="function")try{Pe(null)}catch(tt){Ea(ye,_e,tt)}else Pe.current=null}function sd(ye){var _e=ye.type,Pe=ye.memoizedProps,$e=ye.stateNode;try{e:switch(_e){case"button":case"input":case"select":case"textarea":Pe.autoFocus&&$e.focus();break e;case"img":Pe.src?$e.src=Pe.src:Pe.srcSet&&($e.srcset=Pe.srcSet)}}catch(tt){Ea(ye,ye.return,tt)}}function Zc(ye,_e,Pe){try{var $e=ye.stateNode;vm($e,ye.type,Pe,_e),$e[Fi]=_e}catch(tt){Ea(ye,ye.return,tt)}}function xd(ye){return ye.tag===5||ye.tag===3||ye.tag===26||ye.tag===27&&zx(ye.type)||ye.tag===4}function Jc(ye){e:for(;;){for(;ye.sibling===null;){if(ye.return===null||xd(ye.return))return null;ye=ye.return}for(ye.sibling.return=ye.return,ye=ye.sibling;ye.tag!==5&&ye.tag!==6&&ye.tag!==18;){if(ye.tag===27&&zx(ye.type)||ye.flags&2||ye.child===null||ye.tag===4)continue e;ye.child.return=ye,ye=ye.child}if(!(ye.flags&2))return ye.stateNode}}function jc(ye,_e,Pe){var $e=ye.tag;if($e===5||$e===6)ye=ye.stateNode,_e?(Pe.nodeType===9?Pe.body:Pe.nodeName==="HTML"?Pe.ownerDocument.body:Pe).insertBefore(ye,_e):(_e=Pe.nodeType===9?Pe.body:Pe.nodeName==="HTML"?Pe.ownerDocument.body:Pe,_e.appendChild(ye),Pe=Pe._reactRootContainer,Pe!=null||_e.onclick!==null||(_e.onclick=O2));else if($e!==4&&($e===27&&zx(ye.type)&&(Pe=ye.stateNode,_e=null),ye=ye.child,ye!==null))for(jc(ye,_e,Pe),ye=ye.sibling;ye!==null;)jc(ye,_e,Pe),ye=ye.sibling}function A2(ye,_e,Pe){var $e=ye.tag;if($e===5||$e===6)ye=ye.stateNode,_e?Pe.insertBefore(ye,_e):Pe.appendChild(ye);else if($e!==4&&($e===27&&zx(ye.type)&&(Pe=ye.stateNode),ye=ye.child,ye!==null))for(A2(ye,_e,Pe),ye=ye.sibling;ye!==null;)A2(ye,_e,Pe),ye=ye.sibling}function od(ye){var _e=ye.stateNode,Pe=ye.memoizedProps;try{for(var $e=ye.type,tt=_e.attributes;tt.length;)_e.removeAttributeNode(tt[0]);Is(_e,$e,Pe),_e[$i]=ye,_e[Fi]=Pe}catch(lt){Ea(ye,ye.return,lt)}}var fx=!1,za=!1,eh=!1,ld=typeof WeakSet=="function"?WeakSet:Set,_s=null;function jp(ye,_e){if(ye=ye.containerInfo,wh=$2,ye=w0(ye),h0(ye)){if("selectionStart"in ye)var Pe={start:ye.selectionStart,end:ye.selectionEnd};else e:{Pe=(Pe=ye.ownerDocument)&&Pe.defaultView||window;var $e=Pe.getSelection&&Pe.getSelection();if($e&&$e.rangeCount!==0){Pe=$e.anchorNode;var tt=$e.anchorOffset,lt=$e.focusNode;$e=$e.focusOffset;try{Pe.nodeType,lt.nodeType}catch{Pe=null;break e}var Dt=0,qt=-1,dn=-1,Gn=0,mr=0,Er=ye,Yn=null;t:for(;;){for(var Qn;Er!==Pe||tt!==0&&Er.nodeType!==3||(qt=Dt+tt),Er!==lt||$e!==0&&Er.nodeType!==3||(dn=Dt+$e),Er.nodeType===3&&(Dt+=Er.nodeValue.length),(Qn=Er.firstChild)!==null;)Yn=Er,Er=Qn;for(;;){if(Er===ye)break t;if(Yn===Pe&&++Gn===tt&&(qt=Dt),Yn===lt&&++mr===$e&&(dn=Dt),(Qn=Er.nextSibling)!==null)break;Er=Yn,Yn=Er.parentNode}Er=Qn}Pe=qt===-1||dn===-1?null:{start:qt,end:dn}}else Pe=null}Pe=Pe||{start:0,end:0}}else Pe=null;for(Ah={focusedElem:ye,selectionRange:Pe},$2=!1,_s=_e;_s!==null;)if(_e=_s,ye=_e.child,(_e.subtreeFlags&1024)!==0&&ye!==null)ye.return=_e,_s=ye;else for(;_s!==null;){switch(_e=_s,lt=_e.alternate,ye=_e.flags,_e.tag){case 0:break;case 11:case 15:break;case 1:if((ye&1024)!==0&&lt!==null){ye=void 0,Pe=_e,tt=lt.memoizedProps,lt=lt.memoizedState,$e=Pe.stateNode;try{var wi=To(Pe.type,tt,Pe.elementType===Pe.type);ye=$e.getSnapshotBeforeUpdate(wi,lt),$e.__reactInternalSnapshotBeforeUpdate=ye}catch(Si){Ea(Pe,Pe.return,Si)}}break;case 3:if((ye&1024)!==0){if(ye=_e.stateNode.containerInfo,Pe=ye.nodeType,Pe===9)Rh(ye);else if(Pe===1)switch(ye.nodeName){case"HEAD":case"HTML":case"BODY":Rh(ye);break;default:ye.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((ye&1024)!==0)throw Error($(163))}if(ye=_e.sibling,ye!==null){ye.return=_e.return,_s=ye;break}_s=_e.return}}function cd(ye,_e,Pe){var $e=Pe.flags;switch(Pe.tag){case 0:case 11:case 15:kx(ye,Pe),$e&4&&Pl(5,Pe);break;case 1:if(kx(ye,Pe),$e&4)if(ye=Pe.stateNode,_e===null)try{ye.componentDidMount()}catch(Dt){Ea(Pe,Pe.return,Dt)}else{var tt=To(Pe.type,_e.memoizedProps);_e=_e.memoizedState;try{ye.componentDidUpdate(tt,_e,ye.__reactInternalSnapshotBeforeUpdate)}catch(Dt){Ea(Pe,Pe.return,Dt)}}$e&64&&id(Pe),$e&512&&Il(Pe,Pe.return);break;case 3:if(kx(ye,Pe),$e&64&&(ye=Pe.updateQueue,ye!==null)){if(_e=null,Pe.child!==null)switch(Pe.child.tag){case 27:case 5:_e=Pe.child.stateNode;break;case 1:_e=Pe.child.stateNode}try{Hu(ye,_e)}catch(Dt){Ea(Pe,Pe.return,Dt)}}break;case 27:_e===null&&$e&4&&od(Pe);case 26:case 5:kx(ye,Pe),_e===null&&$e&4&&sd(Pe),$e&512&&Il(Pe,Pe.return);break;case 12:kx(ye,Pe);break;case 13:kx(ye,Pe),$e&4&&fd(ye,Pe),$e&64&&(ye=Pe.memoizedState,ye!==null&&(ye=ye.dehydrated,ye!==null&&(Pe=om.bind(null,Pe),Mm(ye,Pe))));break;case 22:if($e=Pe.memoizedState!==null||fx,!$e){_e=_e!==null&&_e.memoizedState!==null||za,tt=fx;var lt=za;fx=$e,(za=_e)&&!lt?Lx(ye,Pe,(Pe.subtreeFlags&8772)!==0):kx(ye,Pe),fx=tt,za=lt}break;case 30:break;default:kx(ye,Pe)}}function hd(ye){var _e=ye.alternate;_e!==null&&(ye.alternate=null,hd(_e)),ye.child=null,ye.deletions=null,ye.sibling=null,ye.tag===5&&(_e=ye.stateNode,_e!==null&&v0(_e)),ye.stateNode=null,ye.return=null,ye.dependencies=null,ye.memoizedProps=null,ye.memoizedState=null,ye.pendingProps=null,ye.stateNode=null,ye.updateQueue=null}var Ia=null,a0=!1;function dx(ye,_e,Pe){for(Pe=Pe.child;Pe!==null;)ud(ye,_e,Pe),Pe=Pe.sibling}function ud(ye,_e,Pe){if(zn&&typeof zn.onCommitFiberUnmount=="function")try{zn.onCommitFiberUnmount(Dr,Pe)}catch{}switch(Pe.tag){case 26:za||q0(Pe,_e),dx(ye,_e,Pe),Pe.memoizedState?Pe.memoizedState.count--:Pe.stateNode&&(Pe=Pe.stateNode,Pe.parentNode.removeChild(Pe));break;case 27:za||q0(Pe,_e);var $e=Ia,tt=a0;zx(Pe.type)&&(Ia=Pe.stateNode,a0=!1),dx(ye,_e,Pe),Vl(Pe.stateNode),Ia=$e,a0=tt;break;case 5:za||q0(Pe,_e);case 6:if($e=Ia,tt=a0,Ia=null,dx(ye,_e,Pe),Ia=$e,a0=tt,Ia!==null)if(a0)try{(Ia.nodeType===9?Ia.body:Ia.nodeName==="HTML"?Ia.ownerDocument.body:Ia).removeChild(Pe.stateNode)}catch(lt){Ea(Pe,_e,lt)}else try{Ia.removeChild(Pe.stateNode)}catch(lt){Ea(Pe,_e,lt)}break;case 18:Ia!==null&&(a0?(ye=Ia,ep(ye.nodeType===9?ye.body:ye.nodeName==="HTML"?ye.ownerDocument.body:ye,Pe.stateNode),Xl(ye)):ep(Ia,Pe.stateNode));break;case 4:$e=Ia,tt=a0,Ia=Pe.stateNode.containerInfo,a0=!0,dx(ye,_e,Pe),Ia=$e,a0=tt;break;case 0:case 11:case 14:case 15:za||Dx(2,Pe,_e),za||Dx(4,Pe,_e),dx(ye,_e,Pe);break;case 1:za||(q0(Pe,_e),$e=Pe.stateNode,typeof $e.componentWillUnmount=="function"&&ad(Pe,_e,$e)),dx(ye,_e,Pe);break;case 21:dx(ye,_e,Pe);break;case 22:za=($e=za)||Pe.memoizedState!==null,dx(ye,_e,Pe),za=$e;break;default:dx(ye,_e,Pe)}}function fd(ye,_e){if(_e.memoizedState===null&&(ye=_e.alternate,ye!==null&&(ye=ye.memoizedState,ye!==null&&(ye=ye.dehydrated,ye!==null))))try{Xl(ye)}catch(Pe){Ea(_e,_e.return,Pe)}}function em(ye){switch(ye.tag){case 13:case 19:var _e=ye.stateNode;return _e===null&&(_e=ye.stateNode=new ld),_e;case 22:return ye=ye.stateNode,_e=ye._retryCache,_e===null&&(_e=ye._retryCache=new ld),_e;default:throw Error($(435,ye.tag))}}function th(ye,_e){var Pe=em(ye);_e.forEach(function($e){var tt=lm.bind(null,ye,$e);Pe.has($e)||(Pe.add($e),$e.then(tt,tt))})}function d0(ye,_e){var Pe=_e.deletions;if(Pe!==null)for(var $e=0;$e<Pe.length;$e++){var tt=Pe[$e],lt=ye,Dt=_e,qt=Dt;e:for(;qt!==null;){switch(qt.tag){case 27:if(zx(qt.type)){Ia=qt.stateNode,a0=!1;break e}break;case 5:Ia=qt.stateNode,a0=!1;break e;case 3:case 4:Ia=qt.stateNode.containerInfo,a0=!0;break e}qt=qt.return}if(Ia===null)throw Error($(160));ud(lt,Dt,tt),Ia=null,a0=!1,lt=tt.alternate,lt!==null&&(lt.return=null),tt.return=null}if(_e.subtreeFlags&13878)for(_e=_e.child;_e!==null;)dd(_e,ye),_e=_e.sibling}var L0=null;function dd(ye,_e){var Pe=ye.alternate,$e=ye.flags;switch(ye.tag){case 0:case 11:case 14:case 15:d0(_e,ye),p0(ye),$e&4&&(Dx(3,ye,ye.return),Pl(3,ye),Dx(5,ye,ye.return));break;case 1:d0(_e,ye),p0(ye),$e&512&&(za||Pe===null||q0(Pe,Pe.return)),$e&64&&fx&&(ye=ye.updateQueue,ye!==null&&($e=ye.callbacks,$e!==null&&(Pe=ye.shared.hiddenCallbacks,ye.shared.hiddenCallbacks=Pe===null?$e:Pe.concat($e))));break;case 26:var tt=L0;if(d0(_e,ye),p0(ye),$e&512&&(za||Pe===null||q0(Pe,Pe.return)),$e&4){var lt=Pe!==null?Pe.memoizedState:null;if($e=ye.memoizedState,Pe===null)if($e===null)if(ye.stateNode===null){e:{$e=ye.type,Pe=ye.memoizedProps,tt=tt.ownerDocument||tt;t:switch($e){case"title":lt=tt.getElementsByTagName("title")[0],(!lt||lt[$s]||lt[$i]||lt.namespaceURI==="http://www.w3.org/2000/svg"||lt.hasAttribute("itemprop"))&&(lt=tt.createElement($e),tt.head.insertBefore(lt,tt.querySelector("head > title"))),Is(lt,$e,Pe),lt[$i]=ye,vn(lt),$e=lt;break e;case"link":var Dt=cp("link","href",tt).get($e+(Pe.href||""));if(Dt){for(var qt=0;qt<Dt.length;qt++)if(lt=Dt[qt],lt.getAttribute("href")===(Pe.href==null||Pe.href===""?null:Pe.href)&&lt.getAttribute("rel")===(Pe.rel==null?null:Pe.rel)&&lt.getAttribute("title")===(Pe.title==null?null:Pe.title)&&lt.getAttribute("crossorigin")===(Pe.crossOrigin==null?null:Pe.crossOrigin)){Dt.splice(qt,1);break t}}lt=tt.createElement($e),Is(lt,$e,Pe),tt.head.appendChild(lt);break;case"meta":if(Dt=cp("meta","content",tt).get($e+(Pe.content||""))){for(qt=0;qt<Dt.length;qt++)if(lt=Dt[qt],lt.getAttribute("content")===(Pe.content==null?null:""+Pe.content)&&lt.getAttribute("name")===(Pe.name==null?null:Pe.name)&&lt.getAttribute("property")===(Pe.property==null?null:Pe.property)&&lt.getAttribute("http-equiv")===(Pe.httpEquiv==null?null:Pe.httpEquiv)&&lt.getAttribute("charset")===(Pe.charSet==null?null:Pe.charSet)){Dt.splice(qt,1);break t}}lt=tt.createElement($e),Is(lt,$e,Pe),tt.head.appendChild(lt);break;default:throw Error($(468,$e))}lt[$i]=ye,vn(lt),$e=lt}ye.stateNode=$e}else hp(tt,ye.type,ye.stateNode);else ye.stateNode=lp(tt,$e,ye.memoizedProps);else lt!==$e?(lt===null?Pe.stateNode!==null&&(Pe=Pe.stateNode,Pe.parentNode.removeChild(Pe)):lt.count--,$e===null?hp(tt,ye.type,ye.stateNode):lp(tt,$e,ye.memoizedProps)):$e===null&&ye.stateNode!==null&&Zc(ye,ye.memoizedProps,Pe.memoizedProps)}break;case 27:d0(_e,ye),p0(ye),$e&512&&(za||Pe===null||q0(Pe,Pe.return)),Pe!==null&&$e&4&&Zc(ye,ye.memoizedProps,Pe.memoizedProps);break;case 5:if(d0(_e,ye),p0(ye),$e&512&&(za||Pe===null||q0(Pe,Pe.return)),ye.flags&32){tt=ye.stateNode;try{e0(tt,"")}catch(Qn){Ea(ye,ye.return,Qn)}}$e&4&&ye.stateNode!=null&&(tt=ye.memoizedProps,Zc(ye,tt,Pe!==null?Pe.memoizedProps:tt)),$e&1024&&(eh=!0);break;case 6:if(d0(_e,ye),p0(ye),$e&4){if(ye.stateNode===null)throw Error($(162));$e=ye.memoizedProps,Pe=ye.stateNode;try{Pe.nodeValue=$e}catch(Qn){Ea(ye,ye.return,Qn)}}break;case 3:if(z2=null,tt=L0,L0=U2(_e.containerInfo),d0(_e,ye),L0=tt,p0(ye),$e&4&&Pe!==null&&Pe.memoizedState.isDehydrated)try{Xl(_e.containerInfo)}catch(Qn){Ea(ye,ye.return,Qn)}eh&&(eh=!1,pd(ye));break;case 4:$e=L0,L0=U2(ye.stateNode.containerInfo),d0(_e,ye),p0(ye),L0=$e;break;case 12:d0(_e,ye),p0(ye);break;case 13:d0(_e,ye),p0(ye),ye.child.flags&8192&&ye.memoizedState!==null!=(Pe!==null&&Pe.memoizedState!==null)&&(xh=ai()),$e&4&&($e=ye.updateQueue,$e!==null&&(ye.updateQueue=null,th(ye,$e)));break;case 22:tt=ye.memoizedState!==null;var dn=Pe!==null&&Pe.memoizedState!==null,Gn=fx,mr=za;if(fx=Gn||tt,za=mr||dn,d0(_e,ye),za=mr,fx=Gn,p0(ye),$e&8192)e:for(_e=ye.stateNode,_e._visibility=tt?_e._visibility&-2:_e._visibility|1,tt&&(Pe===null||dn||fx||za||Eo(ye)),Pe=null,_e=ye;;){if(_e.tag===5||_e.tag===26){if(Pe===null){dn=Pe=_e;try{if(lt=dn.stateNode,tt)Dt=lt.style,typeof Dt.setProperty=="function"?Dt.setProperty("display","none","important"):Dt.display="none";else{qt=dn.stateNode;var Er=dn.memoizedProps.style,Yn=Er!=null&&Er.hasOwnProperty("display")?Er.display:null;qt.style.display=Yn==null||typeof Yn=="boolean"?"":(""+Yn).trim()}}catch(Qn){Ea(dn,dn.return,Qn)}}}else if(_e.tag===6){if(Pe===null){dn=_e;try{dn.stateNode.nodeValue=tt?"":dn.memoizedProps}catch(Qn){Ea(dn,dn.return,Qn)}}}else if((_e.tag!==22&&_e.tag!==23||_e.memoizedState===null||_e===ye)&&_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===ye)break e;for(;_e.sibling===null;){if(_e.return===null||_e.return===ye)break e;Pe===_e&&(Pe=null),_e=_e.return}Pe===_e&&(Pe=null),_e.sibling.return=_e.return,_e=_e.sibling}$e&4&&($e=ye.updateQueue,$e!==null&&(Pe=$e.retryQueue,Pe!==null&&($e.retryQueue=null,th(ye,Pe))));break;case 19:d0(_e,ye),p0(ye),$e&4&&($e=ye.updateQueue,$e!==null&&(ye.updateQueue=null,th(ye,$e)));break;case 30:break;case 21:break;default:d0(_e,ye),p0(ye)}}function p0(ye){var _e=ye.flags;if(_e&2){try{for(var Pe,$e=ye.return;$e!==null;){if(xd($e)){Pe=$e;break}$e=$e.return}if(Pe==null)throw Error($(160));switch(Pe.tag){case 27:var tt=Pe.stateNode,lt=Jc(ye);A2(ye,lt,tt);break;case 5:var Dt=Pe.stateNode;Pe.flags&32&&(e0(Dt,""),Pe.flags&=-33);var qt=Jc(ye);A2(ye,qt,Dt);break;case 3:case 4:var dn=Pe.stateNode.containerInfo,Gn=Jc(ye);jc(ye,Gn,dn);break;default:throw Error($(161))}}catch(mr){Ea(ye,ye.return,mr)}ye.flags&=-3}_e&4096&&(ye.flags&=-4097)}function pd(ye){if(ye.subtreeFlags&1024)for(ye=ye.child;ye!==null;){var _e=ye;pd(_e),_e.tag===5&&_e.flags&1024&&_e.stateNode.reset(),ye=ye.sibling}}function kx(ye,_e){if(_e.subtreeFlags&8772)for(_e=_e.child;_e!==null;)cd(ye,_e.alternate,_e),_e=_e.sibling}function Eo(ye){for(ye=ye.child;ye!==null;){var _e=ye;switch(_e.tag){case 0:case 11:case 14:case 15:Dx(4,_e,_e.return),Eo(_e);break;case 1:q0(_e,_e.return);var Pe=_e.stateNode;typeof Pe.componentWillUnmount=="function"&&ad(_e,_e.return,Pe),Eo(_e);break;case 27:Vl(_e.stateNode);case 26:case 5:q0(_e,_e.return),Eo(_e);break;case 22:_e.memoizedState===null&&Eo(_e);break;case 30:Eo(_e);break;default:Eo(_e)}ye=ye.sibling}}function Lx(ye,_e,Pe){for(Pe=Pe&&(_e.subtreeFlags&8772)!==0,_e=_e.child;_e!==null;){var $e=_e.alternate,tt=ye,lt=_e,Dt=lt.flags;switch(lt.tag){case 0:case 11:case 15:Lx(tt,lt,Pe),Pl(4,lt);break;case 1:if(Lx(tt,lt,Pe),$e=lt,tt=$e.stateNode,typeof tt.componentDidMount=="function")try{tt.componentDidMount()}catch(Gn){Ea($e,$e.return,Gn)}if($e=lt,tt=$e.updateQueue,tt!==null){var qt=$e.stateNode;try{var dn=tt.shared.hiddenCallbacks;if(dn!==null)for(tt.shared.hiddenCallbacks=null,tt=0;tt<dn.length;tt++)Gu(dn[tt],qt)}catch(Gn){Ea($e,$e.return,Gn)}}Pe&&Dt&64&&id(lt),Il(lt,lt.return);break;case 27:od(lt);case 26:case 5:Lx(tt,lt,Pe),Pe&&$e===null&&Dt&4&&sd(lt),Il(lt,lt.return);break;case 12:Lx(tt,lt,Pe);break;case 13:Lx(tt,lt,Pe),Pe&&Dt&4&&fd(tt,lt);break;case 22:lt.memoizedState===null&&Lx(tt,lt,Pe),Il(lt,lt.return);break;case 30:break;default:Lx(tt,lt,Pe)}_e=_e.sibling}}function nh(ye,_e){var Pe=null;ye!==null&&ye.memoizedState!==null&&ye.memoizedState.cachePool!==null&&(Pe=ye.memoizedState.cachePool.pool),ye=null,_e.memoizedState!==null&&_e.memoizedState.cachePool!==null&&(ye=_e.memoizedState.cachePool.pool),ye!==Pe&&(ye!=null&&ye.refCount++,Pe!=null&&ml(Pe))}function rh(ye,_e){ye=null,_e.alternate!==null&&(ye=_e.alternate.memoizedState.cache),_e=_e.memoizedState.cache,_e!==ye&&(_e.refCount++,ye!=null&&ml(ye))}function Y0(ye,_e,Pe,$e){if(_e.subtreeFlags&10256)for(_e=_e.child;_e!==null;)md(ye,_e,Pe,$e),_e=_e.sibling}function md(ye,_e,Pe,$e){var tt=_e.flags;switch(_e.tag){case 0:case 11:case 15:Y0(ye,_e,Pe,$e),tt&2048&&Pl(9,_e);break;case 1:Y0(ye,_e,Pe,$e);break;case 3:Y0(ye,_e,Pe,$e),tt&2048&&(ye=null,_e.alternate!==null&&(ye=_e.alternate.memoizedState.cache),_e=_e.memoizedState.cache,_e!==ye&&(_e.refCount++,ye!=null&&ml(ye)));break;case 12:if(tt&2048){Y0(ye,_e,Pe,$e),ye=_e.stateNode;try{var lt=_e.memoizedProps,Dt=lt.id,qt=lt.onPostCommit;typeof qt=="function"&&qt(Dt,_e.alternate===null?"mount":"update",ye.passiveEffectDuration,-0)}catch(dn){Ea(_e,_e.return,dn)}}else Y0(ye,_e,Pe,$e);break;case 13:Y0(ye,_e,Pe,$e);break;case 23:break;case 22:lt=_e.stateNode,Dt=_e.alternate,_e.memoizedState!==null?lt._visibility&2?Y0(ye,_e,Pe,$e):Nl(ye,_e):lt._visibility&2?Y0(ye,_e,Pe,$e):(lt._visibility|=2,$o(ye,_e,Pe,$e,(_e.subtreeFlags&10256)!==0)),tt&2048&&nh(Dt,_e);break;case 24:Y0(ye,_e,Pe,$e),tt&2048&&rh(_e.alternate,_e);break;default:Y0(ye,_e,Pe,$e)}}function $o(ye,_e,Pe,$e,tt){for(tt=tt&&(_e.subtreeFlags&10256)!==0,_e=_e.child;_e!==null;){var lt=ye,Dt=_e,qt=Pe,dn=$e,Gn=Dt.flags;switch(Dt.tag){case 0:case 11:case 15:$o(lt,Dt,qt,dn,tt),Pl(8,Dt);break;case 23:break;case 22:var mr=Dt.stateNode;Dt.memoizedState!==null?mr._visibility&2?$o(lt,Dt,qt,dn,tt):Nl(lt,Dt):(mr._visibility|=2,$o(lt,Dt,qt,dn,tt)),tt&&Gn&2048&&nh(Dt.alternate,Dt);break;case 24:$o(lt,Dt,qt,dn,tt),tt&&Gn&2048&&rh(Dt.alternate,Dt);break;default:$o(lt,Dt,qt,dn,tt)}_e=_e.sibling}}function Nl(ye,_e){if(_e.subtreeFlags&10256)for(_e=_e.child;_e!==null;){var Pe=ye,$e=_e,tt=$e.flags;switch($e.tag){case 22:Nl(Pe,$e),tt&2048&&nh($e.alternate,$e);break;case 24:Nl(Pe,$e),tt&2048&&rh($e.alternate,$e);break;default:Nl(Pe,$e)}_e=_e.sibling}}var Dl=8192;function Wo(ye){if(ye.subtreeFlags&Dl)for(ye=ye.child;ye!==null;)yd(ye),ye=ye.sibling}function yd(ye){switch(ye.tag){case 26:Wo(ye),ye.flags&Dl&&ye.memoizedState!==null&&Vm(L0,ye.memoizedState,ye.memoizedProps);break;case 5:Wo(ye);break;case 3:case 4:var _e=L0;L0=U2(ye.stateNode.containerInfo),Wo(ye),L0=_e;break;case 22:ye.memoizedState===null&&(_e=ye.alternate,_e!==null&&_e.memoizedState!==null?(_e=Dl,Dl=16777216,Wo(ye),Dl=_e):Wo(ye));break;default:Wo(ye)}}function gd(ye){var _e=ye.alternate;if(_e!==null&&(ye=_e.child,ye!==null)){_e.child=null;do _e=ye.sibling,ye.sibling=null,ye=_e;while(ye!==null)}}function kl(ye){var _e=ye.deletions;if((ye.flags&16)!==0){if(_e!==null)for(var Pe=0;Pe<_e.length;Pe++){var $e=_e[Pe];_s=$e,_d($e,ye)}gd(ye)}if(ye.subtreeFlags&10256)for(ye=ye.child;ye!==null;)vd(ye),ye=ye.sibling}function vd(ye){switch(ye.tag){case 0:case 11:case 15:kl(ye),ye.flags&2048&&Dx(9,ye,ye.return);break;case 3:kl(ye);break;case 12:kl(ye);break;case 22:var _e=ye.stateNode;ye.memoizedState!==null&&_e._visibility&2&&(ye.return===null||ye.return.tag!==13)?(_e._visibility&=-3,M2(ye)):kl(ye);break;default:kl(ye)}}function M2(ye){var _e=ye.deletions;if((ye.flags&16)!==0){if(_e!==null)for(var Pe=0;Pe<_e.length;Pe++){var $e=_e[Pe];_s=$e,_d($e,ye)}gd(ye)}for(ye=ye.child;ye!==null;){switch(_e=ye,_e.tag){case 0:case 11:case 15:Dx(8,_e,_e.return),M2(_e);break;case 22:Pe=_e.stateNode,Pe._visibility&2&&(Pe._visibility&=-3,M2(_e));break;default:M2(_e)}ye=ye.sibling}}function _d(ye,_e){for(;_s!==null;){var Pe=_s;switch(Pe.tag){case 0:case 11:case 15:Dx(8,Pe,_e);break;case 23:case 22:if(Pe.memoizedState!==null&&Pe.memoizedState.cachePool!==null){var $e=Pe.memoizedState.cachePool.pool;$e!=null&&$e.refCount++}break;case 24:ml(Pe.memoizedState.cache)}if($e=Pe.child,$e!==null)$e.return=Pe,_s=$e;else e:for(Pe=ye;_s!==null;){$e=_s;var tt=$e.sibling,lt=$e.return;if(hd($e),$e===Pe){_s=null;break e}if(tt!==null){tt.return=lt,_s=tt;break e}_s=lt}}}var tm={getCacheForType:function(ye){var _e=Gs(us),Pe=_e.data.get(ye);return Pe===void 0&&(Pe=ye(),_e.data.set(ye,Pe)),Pe}},nm=typeof WeakMap=="function"?WeakMap:Map,ra=0,Ca=null,Oi=null,Hi=0,aa=0,m0=null,Fx=!1,el=!1,ih=!1,px=0,Ua=0,Ox=0,wo=0,ah=0,I0=0,tl=0,Ll=null,s0=null,sh=!1,xh=0,C2=1/0,R2=null,Bx=null,Cs=0,Ux=null,nl=null,rl=0,oh=0,lh=null,bd=null,Fl=0,ch=null;function y0(){if((ra&2)!==0&&Hi!==0)return Hi&-Hi;if(vt.T!==null){var ye=Lo;return ye!==0?ye:yh()}return Ga()}function Sd(){I0===0&&(I0=(Hi&536870912)===0||Qi?Pr():536870912);var ye=P0.current;return ye!==null&&(ye.flags|=32),I0}function g0(ye,_e,Pe){(ye===Ca&&(aa===2||aa===9)||ye.cancelPendingCommit!==null)&&(il(ye,0),Vx(ye,Hi,I0,!1)),Mr(ye,Pe),((ra&2)===0||ye!==Ca)&&(ye===Ca&&((ra&2)===0&&(wo|=Pe),Ua===4&&Vx(ye,Hi,I0,!1)),X0(ye))}function Td(ye,_e,Pe){if((ra&6)!==0)throw Error($(327));var $e=!Pe&&(_e&124)===0&&(_e&ye.expiredLanes)===0||Ci(ye,_e),tt=$e?am(ye,_e):fh(ye,_e,!0),lt=$e;do{if(tt===0){el&&!$e&&Vx(ye,_e,0,!1);break}else{if(Pe=ye.current.alternate,lt&&!rm(Pe)){tt=fh(ye,_e,!1),lt=!1;continue}if(tt===2){if(lt=_e,ye.errorRecoveryDisabledLanes&lt)var Dt=0;else Dt=ye.pendingLanes&-536870913,Dt=Dt!==0?Dt:Dt&536870912?536870912:0;if(Dt!==0){_e=Dt;e:{var qt=ye;tt=Ll;var dn=qt.current.memoizedState.isDehydrated;if(dn&&(il(qt,Dt).flags|=256),Dt=fh(qt,Dt,!1),Dt!==2){if(ih&&!dn){qt.errorRecoveryDisabledLanes|=lt,wo|=lt,tt=4;break e}lt=s0,s0=tt,lt!==null&&(s0===null?s0=lt:s0.push.apply(s0,lt))}tt=Dt}if(lt=!1,tt!==2)continue}}if(tt===1){il(ye,0),Vx(ye,_e,0,!0);break}e:{switch($e=ye,lt=tt,lt){case 0:case 1:throw Error($(345));case 4:if((_e&4194048)!==_e)break;case 6:Vx($e,_e,I0,!Fx);break e;case 2:s0=null;break;case 3:case 5:break;default:throw Error($(329))}if((_e&62914560)===_e&&(tt=xh+300-ai(),10<tt)){if(Vx($e,_e,I0,!Fx),yi($e,0,!0)!==0)break e;$e.timeoutHandle=Jd(Ed.bind(null,$e,Pe,s0,R2,sh,_e,I0,wo,tl,Fx,lt,2,-0,0),tt);break e}Ed($e,Pe,s0,R2,sh,_e,I0,wo,tl,Fx,lt,0,-0,0)}}break}while(!0);X0(ye)}function Ed(ye,_e,Pe,$e,tt,lt,Dt,qt,dn,Gn,mr,Er,Yn,Qn){if(ye.timeoutHandle=-1,Er=_e.subtreeFlags,(Er&8192||(Er&16785408)===16785408)&&(Hl={stylesheets:null,count:0,unsuspend:Um},yd(_e),Er=zm(),Er!==null)){ye.cancelPendingCommit=Er(Id.bind(null,ye,_e,lt,Pe,$e,tt,Dt,qt,dn,mr,1,Yn,Qn)),Vx(ye,lt,Dt,!Gn);return}Id(ye,_e,lt,Pe,$e,tt,Dt,qt,dn)}function rm(ye){for(var _e=ye;;){var Pe=_e.tag;if((Pe===0||Pe===11||Pe===15)&&_e.flags&16384&&(Pe=_e.updateQueue,Pe!==null&&(Pe=Pe.stores,Pe!==null)))for(var $e=0;$e<Pe.length;$e++){var tt=Pe[$e],lt=tt.getSnapshot;tt=tt.value;try{if(!Tr(lt(),tt))return!1}catch{return!1}}if(Pe=_e.child,_e.subtreeFlags&16384&&Pe!==null)Pe.return=_e,_e=Pe;else{if(_e===ye)break;for(;_e.sibling===null;){if(_e.return===null||_e.return===ye)return!0;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}}return!0}function Vx(ye,_e,Pe,$e){_e&=~ah,_e&=~wo,ye.suspendedLanes|=_e,ye.pingedLanes&=~_e,$e&&(ye.warmLanes|=_e),$e=ye.expirationTimes;for(var tt=_e;0<tt;){var lt=31-vr(tt),Dt=1<<lt;$e[lt]=-1,tt&=~Dt}Pe!==0&&fi(ye,Pe,_e)}function P2(){return(ra&6)===0?(Ol(0),!1):!0}function hh(){if(Oi!==null){if(aa===0)var ye=Oi.return;else ye=Oi,xx=vo=null,Ac(ye),zo=null,Ml=0,ye=Oi;for(;ye!==null;)rd(ye.alternate,ye),ye=ye.return;Oi=null}}function il(ye,_e){var Pe=ye.timeoutHandle;Pe!==-1&&(ye.timeoutHandle=-1,Sm(Pe)),Pe=ye.cancelPendingCommit,Pe!==null&&(ye.cancelPendingCommit=null,Pe()),hh(),Ca=ye,Oi=Pe=ix(ye.current,null),Hi=_e,aa=0,m0=null,Fx=!1,el=Ci(ye,_e),ih=!1,tl=I0=ah=wo=Ox=Ua=0,s0=Ll=null,sh=!1,(_e&8)!==0&&(_e|=_e&32);var $e=ye.entangledLanes;if($e!==0)for(ye=ye.entanglements,$e&=_e;0<$e;){var tt=31-vr($e),lt=1<<tt;_e|=ye[tt],$e&=~lt}return px=_e,Zl(),Pe}function wd(ye,_e){Ni=null,vt.H=m2,_e===gl||_e===s2?(_e=Vu(),aa=3):_e===Lu?(_e=Vu(),aa=4):aa=_e===Hf?8:_e!==null&&typeof _e=="object"&&typeof _e.then=="function"?6:1,m0=_e,Oi===null&&(Ua=1,S2(ye,A0(_e,ye.current)))}function Ad(){var ye=vt.H;return vt.H=m2,ye===null?m2:ye}function Md(){var ye=vt.A;return vt.A=tm,ye}function uh(){Ua=4,Fx||(Hi&4194048)!==Hi&&P0.current!==null||(el=!0),(Ox&134217727)===0&&(wo&134217727)===0||Ca===null||Vx(Ca,Hi,I0,!1)}function fh(ye,_e,Pe){var $e=ra;ra|=2;var tt=Ad(),lt=Md();(Ca!==ye||Hi!==_e)&&(R2=null,il(ye,_e)),_e=!1;var Dt=Ua;e:do try{if(aa!==0&&Oi!==null){var qt=Oi,dn=m0;switch(aa){case 8:hh(),Dt=6;break e;case 3:case 2:case 9:case 6:P0.current===null&&(_e=!0);var Gn=aa;if(aa=0,m0=null,al(ye,qt,dn,Gn),Pe&&el){Dt=0;break e}break;default:Gn=aa,aa=0,m0=null,al(ye,qt,dn,Gn)}}im(),Dt=Ua;break}catch(mr){wd(ye,mr)}while(!0);return _e&&ye.shellSuspendCounter++,xx=vo=null,ra=$e,vt.H=tt,vt.A=lt,Oi===null&&(Ca=null,Hi=0,Zl()),Dt}function im(){for(;Oi!==null;)Cd(Oi)}function am(ye,_e){var Pe=ra;ra|=2;var $e=Ad(),tt=Md();Ca!==ye||Hi!==_e?(R2=null,C2=ai()+500,il(ye,_e)):el=Ci(ye,_e);e:do try{if(aa!==0&&Oi!==null){_e=Oi;var lt=m0;t:switch(aa){case 1:aa=0,m0=null,al(ye,_e,lt,1);break;case 2:case 9:if(Bu(lt)){aa=0,m0=null,Rd(_e);break}_e=function(){aa!==2&&aa!==9||Ca!==ye||(aa=7),X0(ye)},lt.then(_e,_e);break e;case 3:aa=7;break e;case 4:aa=5;break e;case 7:Bu(lt)?(aa=0,m0=null,Rd(_e)):(aa=0,m0=null,al(ye,_e,lt,7));break;case 5:var Dt=null;switch(Oi.tag){case 26:Dt=Oi.memoizedState;case 5:case 27:var qt=Oi;if(!Dt||up(Dt)){aa=0,m0=null;var dn=qt.sibling;if(dn!==null)Oi=dn;else{var Gn=qt.return;Gn!==null?(Oi=Gn,I2(Gn)):Oi=null}break t}}aa=0,m0=null,al(ye,_e,lt,5);break;case 6:aa=0,m0=null,al(ye,_e,lt,6);break;case 8:hh(),Ua=6;break e;default:throw Error($(462))}}sm();break}catch(mr){wd(ye,mr)}while(!0);return xx=vo=null,vt.H=$e,vt.A=tt,ra=Pe,Oi!==null?0:(Ca=null,Hi=0,Zl(),Ua)}function sm(){for(;Oi!==null&&!Qr();)Cd(Oi)}function Cd(ye){var _e=td(ye.alternate,ye,px);ye.memoizedProps=ye.pendingProps,_e===null?I2(ye):Oi=_e}function Rd(ye){var _e=ye,Pe=_e.alternate;switch(_e.tag){case 15:case 0:_e=Kf(Pe,_e,_e.pendingProps,_e.type,void 0,Hi);break;case 11:_e=Kf(Pe,_e,_e.pendingProps,_e.type.render,_e.ref,Hi);break;case 5:Ac(_e);default:rd(Pe,_e),_e=Oi=Zh(_e,px),_e=td(Pe,_e,px)}ye.memoizedProps=ye.pendingProps,_e===null?I2(ye):Oi=_e}function al(ye,_e,Pe,$e){xx=vo=null,Ac(_e),zo=null,Ml=0;var tt=_e.return;try{if(Kp(ye,tt,_e,Pe,Hi)){Ua=1,S2(ye,A0(Pe,ye.current)),Oi=null;return}}catch(lt){if(tt!==null)throw Oi=tt,lt;Ua=1,S2(ye,A0(Pe,ye.current)),Oi=null;return}_e.flags&32768?(Qi||$e===1?ye=!0:el||(Hi&536870912)!==0?ye=!1:(Fx=ye=!0,($e===2||$e===9||$e===3||$e===6)&&($e=P0.current,$e!==null&&$e.tag===13&&($e.flags|=16384))),Pd(_e,ye)):I2(_e)}function I2(ye){var _e=ye;do{if((_e.flags&32768)!==0){Pd(_e,Fx);return}ye=_e.return;var Pe=Zp(_e.alternate,_e,px);if(Pe!==null){Oi=Pe;return}if(_e=_e.sibling,_e!==null){Oi=_e;return}Oi=_e=ye}while(_e!==null);Ua===0&&(Ua=5)}function Pd(ye,_e){do{var Pe=Jp(ye.alternate,ye);if(Pe!==null){Pe.flags&=32767,Oi=Pe;return}if(Pe=ye.return,Pe!==null&&(Pe.flags|=32768,Pe.subtreeFlags=0,Pe.deletions=null),!_e&&(ye=ye.sibling,ye!==null)){Oi=ye;return}Oi=ye=Pe}while(ye!==null);Ua=6,Oi=null}function Id(ye,_e,Pe,$e,tt,lt,Dt,qt,dn){ye.cancelPendingCommit=null;do N2();while(Cs!==0);if((ra&6)!==0)throw Error($(327));if(_e!==null){if(_e===ye.current)throw Error($(177));if(lt=_e.lanes|_e.childLanes,lt|=ec,ci(ye,Pe,lt,Dt,qt,dn),ye===Ca&&(Oi=Ca=null,Hi=0),nl=_e,Ux=ye,rl=Pe,oh=lt,lh=tt,bd=$e,(_e.subtreeFlags&10256)!==0||(_e.flags&10256)!==0?(ye.callbackNode=null,ye.callbackPriority=0,cm(Ht,function(){return Fd(),null})):(ye.callbackNode=null,ye.callbackPriority=0),$e=(_e.flags&13878)!==0,(_e.subtreeFlags&13878)!==0||$e){$e=vt.T,vt.T=null,tt=It.p,It.p=2,Dt=ra,ra|=4;try{jp(ye,_e,Pe)}finally{ra=Dt,It.p=tt,vt.T=$e}}Cs=1,Nd(),Dd(),kd()}}function Nd(){if(Cs===1){Cs=0;var ye=Ux,_e=nl,Pe=(_e.flags&13878)!==0;if((_e.subtreeFlags&13878)!==0||Pe){Pe=vt.T,vt.T=null;var $e=It.p;It.p=2;var tt=ra;ra|=4;try{dd(_e,ye);var lt=Ah,Dt=w0(ye.containerInfo),qt=lt.focusedElem,dn=lt.selectionRange;if(Dt!==qt&&qt&&qt.ownerDocument&&hi(qt.ownerDocument.documentElement,qt)){if(dn!==null&&h0(qt)){var Gn=dn.start,mr=dn.end;if(mr===void 0&&(mr=Gn),"selectionStart"in qt)qt.selectionStart=Gn,qt.selectionEnd=Math.min(mr,qt.value.length);else{var Er=qt.ownerDocument||document,Yn=Er&&Er.defaultView||window;if(Yn.getSelection){var Qn=Yn.getSelection(),wi=qt.textContent.length,Si=Math.min(dn.start,wi),Ta=dn.end===void 0?Si:Math.min(dn.end,wi);!Qn.extend&&Si>Ta&&(Dt=Ta,Ta=Si,Si=Dt);var Rn=ji(qt,Si),Tn=ji(qt,Ta);if(Rn&&Tn&&(Qn.rangeCount!==1||Qn.anchorNode!==Rn.node||Qn.anchorOffset!==Rn.offset||Qn.focusNode!==Tn.node||Qn.focusOffset!==Tn.offset)){var On=Er.createRange();On.setStart(Rn.node,Rn.offset),Qn.removeAllRanges(),Si>Ta?(Qn.addRange(On),Qn.extend(Tn.node,Tn.offset)):(On.setEnd(Tn.node,Tn.offset),Qn.addRange(On))}}}}for(Er=[],Qn=qt;Qn=Qn.parentNode;)Qn.nodeType===1&&Er.push({element:Qn,left:Qn.scrollLeft,top:Qn.scrollTop});for(typeof qt.focus=="function"&&qt.focus(),qt=0;qt<Er.length;qt++){var _r=Er[qt];_r.element.scrollLeft=_r.left,_r.element.scrollTop=_r.top}}$2=!!wh,Ah=wh=null}finally{ra=tt,It.p=$e,vt.T=Pe}}ye.current=_e,Cs=2}}function Dd(){if(Cs===2){Cs=0;var ye=Ux,_e=nl,Pe=(_e.flags&8772)!==0;if((_e.subtreeFlags&8772)!==0||Pe){Pe=vt.T,vt.T=null;var $e=It.p;It.p=2;var tt=ra;ra|=4;try{cd(ye,_e.alternate,_e)}finally{ra=tt,It.p=$e,vt.T=Pe}}Cs=3}}function kd(){if(Cs===4||Cs===3){Cs=0,Ir();var ye=Ux,_e=nl,Pe=rl,$e=bd;(_e.subtreeFlags&10256)!==0||(_e.flags&10256)!==0?Cs=5:(Cs=0,nl=Ux=null,Ld(ye,ye.pendingLanes));var tt=ye.pendingLanes;if(tt===0&&(Bx=null),bi(Pe),_e=_e.stateNode,zn&&typeof zn.onCommitFiberRoot=="function")try{zn.onCommitFiberRoot(Dr,_e,void 0,(_e.current.flags&128)===128)}catch{}if($e!==null){_e=vt.T,tt=It.p,It.p=2,vt.T=null;try{for(var lt=ye.onRecoverableError,Dt=0;Dt<$e.length;Dt++){var qt=$e[Dt];lt(qt.value,{componentStack:qt.stack})}}finally{vt.T=_e,It.p=tt}}(rl&3)!==0&&N2(),X0(ye),tt=ye.pendingLanes,(Pe&4194090)!==0&&(tt&42)!==0?ye===ch?Fl++:(Fl=0,ch=ye):Fl=0,Ol(0)}}function Ld(ye,_e){(ye.pooledCacheLanes&=_e)===0&&(_e=ye.pooledCache,_e!=null&&(ye.pooledCache=null,ml(_e)))}function N2(ye){return Nd(),Dd(),kd(),Fd()}function Fd(){if(Cs!==5)return!1;var ye=Ux,_e=oh;oh=0;var Pe=bi(rl),$e=vt.T,tt=It.p;try{It.p=32>Pe?32:Pe,vt.T=null,Pe=lh,lh=null;var lt=Ux,Dt=rl;if(Cs=0,nl=Ux=null,rl=0,(ra&6)!==0)throw Error($(331));var qt=ra;if(ra|=4,vd(lt.current),md(lt,lt.current,Dt,Pe),ra=qt,Ol(0,!1),zn&&typeof zn.onPostCommitFiberRoot=="function")try{zn.onPostCommitFiberRoot(Dr,lt)}catch{}return!0}finally{It.p=tt,vt.T=$e,Ld(ye,_e)}}function Od(ye,_e,Pe){_e=A0(Pe,_e),_e=Gc(ye.stateNode,_e,2),ye=Rx(ye,_e,2),ye!==null&&(Mr(ye,2),X0(ye))}function Ea(ye,_e,Pe){if(ye.tag===3)Od(ye,ye,Pe);else for(;_e!==null;){if(_e.tag===3){Od(_e,ye,Pe);break}else if(_e.tag===1){var $e=_e.stateNode;if(typeof _e.type.getDerivedStateFromError=="function"||typeof $e.componentDidCatch=="function"&&(Bx===null||!Bx.has($e))){ye=A0(Pe,ye),Pe=zf(2),$e=Rx(_e,Pe,2),$e!==null&&(Gf(Pe,$e,_e,ye),Mr($e,2),X0($e));break}}_e=_e.return}}function dh(ye,_e,Pe){var $e=ye.pingCache;if($e===null){$e=ye.pingCache=new nm;var tt=new Set;$e.set(_e,tt)}else tt=$e.get(_e),tt===void 0&&(tt=new Set,$e.set(_e,tt));tt.has(Pe)||(ih=!0,tt.add(Pe),ye=xm.bind(null,ye,_e,Pe),_e.then(ye,ye))}function xm(ye,_e,Pe){var $e=ye.pingCache;$e!==null&&$e.delete(_e),ye.pingedLanes|=ye.suspendedLanes&Pe,ye.warmLanes&=~Pe,Ca===ye&&(Hi&Pe)===Pe&&(Ua===4||Ua===3&&(Hi&62914560)===Hi&&300>ai()-xh?(ra&2)===0&&il(ye,0):ah|=Pe,tl===Hi&&(tl=0)),X0(ye)}function Bd(ye,_e){_e===0&&(_e=xr()),ye=Io(ye,_e),ye!==null&&(Mr(ye,_e),X0(ye))}function om(ye){var _e=ye.memoizedState,Pe=0;_e!==null&&(Pe=_e.retryLane),Bd(ye,Pe)}function lm(ye,_e){var Pe=0;switch(ye.tag){case 13:var $e=ye.stateNode,tt=ye.memoizedState;tt!==null&&(Pe=tt.retryLane);break;case 19:$e=ye.stateNode;break;case 22:$e=ye.stateNode._retryCache;break;default:throw Error($(314))}$e!==null&&$e.delete(_e),Bd(ye,Pe)}function cm(ye,_e){return qr(ye,_e)}var D2=null,sl=null,ph=!1,k2=!1,mh=!1,Mo=0;function X0(ye){ye!==sl&&ye.next===null&&(sl===null?D2=sl=ye:sl=sl.next=ye),k2=!0,ph||(ph=!0,um())}function Ol(ye,_e){if(!mh&&k2){mh=!0;do for(var Pe=!1,$e=D2;$e!==null;){if(ye!==0){var tt=$e.pendingLanes;if(tt===0)var lt=0;else{var Dt=$e.suspendedLanes,qt=$e.pingedLanes;lt=(1<<31-vr(42|ye)+1)-1,lt&=tt&~(Dt&~qt),lt=lt&201326741?lt&201326741|1:lt?lt|2:0}lt!==0&&(Pe=!0,Gd($e,lt))}else lt=Hi,lt=yi($e,$e===Ca?lt:0,$e.cancelPendingCommit!==null||$e.timeoutHandle!==-1),(lt&3)===0||Ci($e,lt)||(Pe=!0,Gd($e,lt));$e=$e.next}while(Pe);mh=!1}}function hm(){Ud()}function Ud(){k2=ph=!1;var ye=0;Mo!==0&&(_m()&&(ye=Mo),Mo=0);for(var _e=ai(),Pe=null,$e=D2;$e!==null;){var tt=$e.next,lt=Vd($e,_e);lt===0?($e.next=null,Pe===null?D2=tt:Pe.next=tt,tt===null&&(sl=Pe)):(Pe=$e,(ye!==0||(lt&3)!==0)&&(k2=!0)),$e=tt}Ol(ye)}function Vd(ye,_e){for(var Pe=ye.suspendedLanes,$e=ye.pingedLanes,tt=ye.expirationTimes,lt=ye.pendingLanes&-62914561;0<lt;){var Dt=31-vr(lt),qt=1<<Dt,dn=tt[Dt];dn===-1?((qt&Pe)===0||(qt&$e)!==0)&&(tt[Dt]=wn(qt,_e)):dn<=_e&&(ye.expiredLanes|=qt),lt&=~qt}if(_e=Ca,Pe=Hi,Pe=yi(ye,ye===_e?Pe:0,ye.cancelPendingCommit!==null||ye.timeoutHandle!==-1),$e=ye.callbackNode,Pe===0||ye===_e&&(aa===2||aa===9)||ye.cancelPendingCommit!==null)return $e!==null&&$e!==null&&rr($e),ye.callbackNode=null,ye.callbackPriority=0;if((Pe&3)===0||Ci(ye,Pe)){if(_e=Pe&-Pe,_e===ye.callbackPriority)return _e;switch($e!==null&&rr($e),bi(Pe)){case 2:case 8:Pe=xn;break;case 32:Pe=Ht;break;case 268435456:Pe=er;break;default:Pe=Ht}return $e=zd.bind(null,ye),Pe=qr(Pe,$e),ye.callbackPriority=_e,ye.callbackNode=Pe,_e}return $e!==null&&$e!==null&&rr($e),ye.callbackPriority=2,ye.callbackNode=null,2}function zd(ye,_e){if(Cs!==0&&Cs!==5)return ye.callbackNode=null,ye.callbackPriority=0,null;var Pe=ye.callbackNode;if(N2()&&ye.callbackNode!==Pe)return null;var $e=Hi;return $e=yi(ye,ye===Ca?$e:0,ye.cancelPendingCommit!==null||ye.timeoutHandle!==-1),$e===0?null:(Td(ye,$e,_e),Vd(ye,ai()),ye.callbackNode!=null&&ye.callbackNode===Pe?zd.bind(null,ye):null)}function Gd(ye,_e){if(N2())return null;Td(ye,_e,!0)}function um(){Tm(function(){(ra&6)!==0?qr(Vr,hm):Ud()})}function yh(){return Mo===0&&(Mo=Pr()),Mo}function Hd(ye){return ye==null||typeof ye=="symbol"||typeof ye=="boolean"?null:typeof ye=="function"?ye:O0(""+ye)}function $d(ye,_e){var Pe=_e.ownerDocument.createElement("input");return Pe.name=_e.name,Pe.value=_e.value,ye.id&&Pe.setAttribute("form",ye.id),_e.parentNode.insertBefore(Pe,_e),ye=new FormData(ye),Pe.parentNode.removeChild(Pe),ye}function fm(ye,_e,Pe,$e,tt){if(_e==="submit"&&Pe&&Pe.stateNode===tt){var lt=Hd((tt[Fi]||null).action),Dt=$e.submitter;Dt&&(_e=(_e=Dt[Fi]||null)?Hd(_e.formAction):Dt.getAttribute("formAction"),_e!==null&&(lt=_e,Dt=null));var qt=new G0("action","action",null,$e,tt);ye.push({event:qt,listeners:[{instance:null,listener:function(){if($e.defaultPrevented){if(Mo!==0){var dn=Dt?$d(tt,Dt):new FormData(tt);Fc(Pe,{pending:!0,data:dn,method:tt.method,action:lt},null,dn)}}else typeof lt=="function"&&(qt.preventDefault(),dn=Dt?$d(tt,Dt):new FormData(tt),Fc(Pe,{pending:!0,data:dn,method:tt.method,action:lt},lt,dn))},currentTarget:tt}]})}}for(var gh=0;gh<j2.length;gh++){var vh=j2[gh],dm=vh.toLowerCase(),pm=vh[0].toUpperCase()+vh.slice(1);k0(dm,"on"+pm)}k0(Hh,"onAnimationEnd"),k0($h,"onAnimationIteration"),k0(Wh,"onAnimationStart"),k0("dblclick","onDoubleClick"),k0("focusin","onFocus"),k0("focusout","onBlur"),k0(Np,"onTransitionRun"),k0(Dp,"onTransitionStart"),k0(kp,"onTransitionCancel"),k0(qh,"onTransitionEnd"),Cr("onMouseEnter",["mouseout","mouseover"]),Cr("onMouseLeave",["mouseout","mouseover"]),Cr("onPointerEnter",["pointerout","pointerover"]),Cr("onPointerLeave",["pointerout","pointerover"]),An("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),An("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),An("onBeforeInput",["compositionend","keypress","textInput","paste"]),An("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),An("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),An("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mm=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bl));function Wd(ye,_e){_e=(_e&4)!==0;for(var Pe=0;Pe<ye.length;Pe++){var $e=ye[Pe],tt=$e.event;$e=$e.listeners;e:{var lt=void 0;if(_e)for(var Dt=$e.length-1;0<=Dt;Dt--){var qt=$e[Dt],dn=qt.instance,Gn=qt.currentTarget;if(qt=qt.listener,dn!==lt&&tt.isPropagationStopped())break e;lt=qt,tt.currentTarget=Gn;try{lt(tt)}catch(mr){_2(mr)}tt.currentTarget=null,lt=dn}else for(Dt=0;Dt<$e.length;Dt++){if(qt=$e[Dt],dn=qt.instance,Gn=qt.currentTarget,qt=qt.listener,dn!==lt&&tt.isPropagationStopped())break e;lt=qt,tt.currentTarget=Gn;try{lt(tt)}catch(mr){_2(mr)}tt.currentTarget=null,lt=dn}}}}function Bi(ye,_e){var Pe=_e[ta];Pe===void 0&&(Pe=_e[ta]=new Set);var $e=ye+"__bubble";Pe.has($e)||(qd(_e,ye,2,!1),Pe.add($e))}function _h(ye,_e,Pe){var $e=0;_e&&($e|=4),qd(Pe,ye,$e,_e)}var L2="_reactListening"+Math.random().toString(36).slice(2);function Sh(ye){if(!ye[L2]){ye[L2]=!0,$n.forEach(function(Pe){Pe!=="selectionchange"&&(mm.has(Pe)||_h(Pe,!1,ye),_h(Pe,!0,ye))});var _e=ye.nodeType===9?ye:ye.ownerDocument;_e===null||_e[L2]||(_e[L2]=!0,_h("selectionchange",!1,_e))}}function qd(ye,_e,Pe,$e){switch(gp(_e)){case 2:var tt=$m;break;case 8:tt=Wm;break;default:tt=Fh}Pe=tt.bind(null,_e,Pe,ye),tt=void 0,!Q0||_e!=="touchstart"&&_e!=="touchmove"&&_e!=="wheel"||(tt=!0),$e?tt!==void 0?ye.addEventListener(_e,Pe,{capture:!0,passive:tt}):ye.addEventListener(_e,Pe,!0):tt!==void 0?ye.addEventListener(_e,Pe,{passive:tt}):ye.addEventListener(_e,Pe,!1)}function Th(ye,_e,Pe,$e,tt){var lt=$e;if((_e&1)===0&&(_e&2)===0&&$e!==null)e:for(;;){if($e===null)return;var Dt=$e.tag;if(Dt===3||Dt===4){var qt=$e.stateNode.containerInfo;if(qt===tt)break;if(Dt===4)for(Dt=$e.return;Dt!==null;){var dn=Dt.tag;if((dn===3||dn===4)&&Dt.stateNode.containerInfo===tt)return;Dt=Dt.return}for(;qt!==null;){if(Dt=Qs(qt),Dt===null)return;if(dn=Dt.tag,dn===5||dn===6||dn===26||dn===27){$e=lt=Dt;continue e}qt=qt.parentNode}}$e=$e.return}bx(function(){var Gn=lt,mr=os(Pe),Er=[];e:{var Yn=Yh.get(ye);if(Yn!==void 0){var Qn=G0,wi=ye;switch(ye){case"keypress":if(V0(Pe)===0)break e;case"keydown":case"keyup":Qn=wr;break;case"focusin":wi="focus",Qn=zt;break;case"focusout":wi="blur",Qn=zt;break;case"beforeblur":case"afterblur":Qn=zt;break;case"click":if(Pe.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qn=ex;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qn=ds;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qn=Ei;break;case Hh:case $h:case Wh:Qn=un;break;case qh:Qn=Ki;break;case"scroll":case"scrollend":Qn=Tx;break;case"wheel":Qn=Wi;break;case"copy":case"cut":case"paste":Qn=Mt;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qn=li;break;case"toggle":case"beforetoggle":Qn=cs}var Si=(_e&4)!==0,Ta=!Si&&(ye==="scroll"||ye==="scrollend"),Rn=Si?Yn!==null?Yn+"Capture":null:Yn;Si=[];for(var Tn=Gn,On;Tn!==null;){var _r=Tn;if(On=_r.stateNode,_r=_r.tag,_r!==5&&_r!==26&&_r!==27||On===null||Rn===null||(_r=o0(Tn,Rn),_r!=null&&Si.push(Ul(Tn,_r,On))),Ta)break;Tn=Tn.return}0<Si.length&&(Yn=new Qn(Yn,wi,null,Pe,mr),Er.push({event:Yn,listeners:Si}))}}if((_e&7)===0){e:{if(Yn=ye==="mouseover"||ye==="pointerover",Qn=ye==="mouseout"||ye==="pointerout",Yn&&Pe!==B0&&(wi=Pe.relatedTarget||Pe.fromElement)&&(Qs(wi)||wi[Ss]))break e;if((Qn||Yn)&&(Yn=mr.window===mr?mr:(Yn=mr.ownerDocument)?Yn.defaultView||Yn.parentWindow:window,Qn?(wi=Pe.relatedTarget||Pe.toElement,Qn=Gn,wi=wi?Qs(wi):null,wi!==null&&(Ta=re(wi),Si=wi.tag,wi!==Ta||Si!==5&&Si!==27&&Si!==6)&&(wi=null)):(Qn=null,wi=Gn),Qn!==wi)){if(Si=ex,_r="onMouseLeave",Rn="onMouseEnter",Tn="mouse",(ye==="pointerout"||ye==="pointerover")&&(Si=li,_r="onPointerLeave",Rn="onPointerEnter",Tn="pointer"),Ta=Qn==null?Yn:as(Qn),On=wi==null?Yn:as(wi),Yn=new Si(_r,Tn+"leave",Qn,Pe,mr),Yn.target=Ta,Yn.relatedTarget=On,_r=null,Qs(mr)===Gn&&(Si=new Si(Rn,Tn+"enter",wi,Pe,mr),Si.target=On,Si.relatedTarget=Ta,_r=Si),Ta=_r,Qn&&wi)t:{for(Si=Qn,Rn=wi,Tn=0,On=Si;On;On=xl(On))Tn++;for(On=0,_r=Rn;_r;_r=xl(_r))On++;for(;0<Tn-On;)Si=xl(Si),Tn--;for(;0<On-Tn;)Rn=xl(Rn),On--;for(;Tn--;){if(Si===Rn||Rn!==null&&Si===Rn.alternate)break t;Si=xl(Si),Rn=xl(Rn)}Si=null}else Si=null;Qn!==null&&Yd(Er,Yn,Qn,Si,!1),wi!==null&&Ta!==null&&Yd(Er,Ta,wi,Si,!0)}}e:{if(Yn=Gn?as(Gn):window,Qn=Yn.nodeName&&Yn.nodeName.toLowerCase(),Qn==="select"||Qn==="input"&&Yn.type==="file")var si=dr;else if(Pt(Yn))if(jn)si=Aa;else{si=va;var Li=ki}else Qn=Yn.nodeName,!Qn||Qn.toLowerCase()!=="input"||Yn.type!=="checkbox"&&Yn.type!=="radio"?Gn&&K0(Gn.elementType)&&(si=dr):si=wa;if(si&&(si=si(ye,Gn))){wt(Er,si,Pe,mr);break e}Li&&Li(ye,Yn,Gn),ye==="focusout"&&Gn&&Yn.type==="number"&&Gn.memoizedProps.value!=null&&js(Yn,"number",Yn.value)}switch(Li=Gn?as(Gn):window,ye){case"focusin":(Pt(Li)||Li.contentEditable==="true")&&(na=Li,u0=Gn,hs=null);break;case"focusout":hs=u0=na=null;break;case"mousedown":Zx=!0;break;case"contextmenu":case"mouseup":case"dragend":Zx=!1,Jx(Er,Pe,mr);break;case"selectionchange":if(rx)break;case"keydown":case"keyup":Jx(Er,Pe,mr)}var pi;if(ws)e:{switch(ye){case"compositionstart":var Ti="onCompositionStart";break e;case"compositionend":Ti="onCompositionEnd";break e;case"compositionupdate":Ti="onCompositionUpdate";break e}Ti=void 0}else nx?tx(ye,Pe)&&(Ti="onCompositionEnd"):ye==="keydown"&&Pe.keyCode===229&&(Ti="onCompositionStart");Ti&&(Ex&&Pe.locale!=="ko"&&(nx||Ti!=="onCompositionStart"?Ti==="onCompositionEnd"&&nx&&(pi=Sx()):(n0=mr,Z0="value"in n0?n0.value:n0.textContent,nx=!0)),Li=F2(Gn,Ti),0<Li.length&&(Ti=new Zt(Ti,ye,null,Pe,mr),Er.push({event:Ti,listeners:Li}),pi?Ti.data=pi:(pi=c0(Pe),pi!==null&&(Ti.data=pi)))),(pi=Co?Kl(ye,Pe):Ro(ye,Pe))&&(Ti=F2(Gn,"onBeforeInput"),0<Ti.length&&(Li=new Zt("onBeforeInput","beforeinput",null,Pe,mr),Er.push({event:Li,listeners:Ti}),Li.data=pi)),fm(Er,ye,Gn,Pe,mr)}Wd(Er,_e)})}function Ul(ye,_e,Pe){return{instance:ye,listener:_e,currentTarget:Pe}}function F2(ye,_e){for(var Pe=_e+"Capture",$e=[];ye!==null;){var tt=ye,lt=tt.stateNode;if(tt=tt.tag,tt!==5&&tt!==26&&tt!==27||lt===null||(tt=o0(ye,Pe),tt!=null&&$e.unshift(Ul(ye,tt,lt)),tt=o0(ye,_e),tt!=null&&$e.push(Ul(ye,tt,lt))),ye.tag===3)return $e;ye=ye.return}return[]}function xl(ye){if(ye===null)return null;do ye=ye.return;while(ye&&ye.tag!==5&&ye.tag!==27);return ye||null}function Yd(ye,_e,Pe,$e,tt){for(var lt=_e._reactName,Dt=[];Pe!==null&&Pe!==$e;){var qt=Pe,dn=qt.alternate,Gn=qt.stateNode;if(qt=qt.tag,dn!==null&&dn===$e)break;qt!==5&&qt!==26&&qt!==27||Gn===null||(dn=Gn,tt?(Gn=o0(Pe,lt),Gn!=null&&Dt.unshift(Ul(Pe,Gn,dn))):tt||(Gn=o0(Pe,lt),Gn!=null&&Dt.push(Ul(Pe,Gn,dn)))),Pe=Pe.return}Dt.length!==0&&ye.push({event:_e,listeners:Dt})}var ym=/\r\n?/g,gm=/\u0000|\uFFFD/g;function Xd(ye){return(typeof ye=="string"?ye:""+ye).replace(ym,`
`).replace(gm,"")}function Kd(ye,_e){return _e=Xd(_e),Xd(ye)===_e}function O2(){}function Sa(ye,_e,Pe,$e,tt,lt){switch(Pe){case"children":typeof $e=="string"?_e==="body"||_e==="textarea"&&$e===""||e0(ye,$e):(typeof $e=="number"||typeof $e=="bigint")&&_e!=="body"&&e0(ye,""+$e);break;case"className":jr(ye,"class",$e);break;case"tabIndex":jr(ye,"tabindex",$e);break;case"dir":case"role":case"viewBox":case"width":case"height":jr(ye,Pe,$e);break;case"style":gx(ye,$e,lt);break;case"data":if(_e!=="object"){jr(ye,"data",$e);break}case"src":case"href":if($e===""&&(_e!=="a"||Pe!=="href")){ye.removeAttribute(Pe);break}if($e==null||typeof $e=="function"||typeof $e=="symbol"||typeof $e=="boolean"){ye.removeAttribute(Pe);break}$e=O0(""+$e),ye.setAttribute(Pe,$e);break;case"action":case"formAction":if(typeof $e=="function"){ye.setAttribute(Pe,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof lt=="function"&&(Pe==="formAction"?(_e!=="input"&&Sa(ye,_e,"name",tt.name,tt,null),Sa(ye,_e,"formEncType",tt.formEncType,tt,null),Sa(ye,_e,"formMethod",tt.formMethod,tt,null),Sa(ye,_e,"formTarget",tt.formTarget,tt,null)):(Sa(ye,_e,"encType",tt.encType,tt,null),Sa(ye,_e,"method",tt.method,tt,null),Sa(ye,_e,"target",tt.target,tt,null)));if($e==null||typeof $e=="symbol"||typeof $e=="boolean"){ye.removeAttribute(Pe);break}$e=O0(""+$e),ye.setAttribute(Pe,$e);break;case"onClick":$e!=null&&(ye.onclick=O2);break;case"onScroll":$e!=null&&Bi("scroll",ye);break;case"onScrollEnd":$e!=null&&Bi("scrollend",ye);break;case"dangerouslySetInnerHTML":if($e!=null){if(typeof $e!="object"||!("__html"in $e))throw Error($(61));if(Pe=$e.__html,Pe!=null){if(tt.children!=null)throw Error($(60));ye.innerHTML=Pe}}break;case"multiple":ye.multiple=$e&&typeof $e!="function"&&typeof $e!="symbol";break;case"muted":ye.muted=$e&&typeof $e!="function"&&typeof $e!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if($e==null||typeof $e=="function"||typeof $e=="boolean"||typeof $e=="symbol"){ye.removeAttribute("xlink:href");break}Pe=O0(""+$e),ye.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Pe);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":$e!=null&&typeof $e!="function"&&typeof $e!="symbol"?ye.setAttribute(Pe,""+$e):ye.removeAttribute(Pe);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":$e&&typeof $e!="function"&&typeof $e!="symbol"?ye.setAttribute(Pe,""):ye.removeAttribute(Pe);break;case"capture":case"download":$e===!0?ye.setAttribute(Pe,""):$e!==!1&&$e!=null&&typeof $e!="function"&&typeof $e!="symbol"?ye.setAttribute(Pe,$e):ye.removeAttribute(Pe);break;case"cols":case"rows":case"size":case"span":$e!=null&&typeof $e!="function"&&typeof $e!="symbol"&&!isNaN($e)&&1<=$e?ye.setAttribute(Pe,$e):ye.removeAttribute(Pe);break;case"rowSpan":case"start":$e==null||typeof $e=="function"||typeof $e=="symbol"||isNaN($e)?ye.removeAttribute(Pe):ye.setAttribute(Pe,$e);break;case"popover":Bi("beforetoggle",ye),Bi("toggle",ye),ii(ye,"popover",$e);break;case"xlinkActuate":di(ye,"http://www.w3.org/1999/xlink","xlink:actuate",$e);break;case"xlinkArcrole":di(ye,"http://www.w3.org/1999/xlink","xlink:arcrole",$e);break;case"xlinkRole":di(ye,"http://www.w3.org/1999/xlink","xlink:role",$e);break;case"xlinkShow":di(ye,"http://www.w3.org/1999/xlink","xlink:show",$e);break;case"xlinkTitle":di(ye,"http://www.w3.org/1999/xlink","xlink:title",$e);break;case"xlinkType":di(ye,"http://www.w3.org/1999/xlink","xlink:type",$e);break;case"xmlBase":di(ye,"http://www.w3.org/XML/1998/namespace","xml:base",$e);break;case"xmlLang":di(ye,"http://www.w3.org/XML/1998/namespace","xml:lang",$e);break;case"xmlSpace":di(ye,"http://www.w3.org/XML/1998/namespace","xml:space",$e);break;case"is":ii(ye,"is",$e);break;case"innerText":case"textContent":break;default:(!(2<Pe.length)||Pe[0]!=="o"&&Pe[0]!=="O"||Pe[1]!=="n"&&Pe[1]!=="N")&&(Pe=Xx.get(Pe)||Pe,ii(ye,Pe,$e))}}function Eh(ye,_e,Pe,$e,tt,lt){switch(Pe){case"style":gx(ye,$e,lt);break;case"dangerouslySetInnerHTML":if($e!=null){if(typeof $e!="object"||!("__html"in $e))throw Error($(61));if(Pe=$e.__html,Pe!=null){if(tt.children!=null)throw Error($(60));ye.innerHTML=Pe}}break;case"children":typeof $e=="string"?e0(ye,$e):(typeof $e=="number"||typeof $e=="bigint")&&e0(ye,""+$e);break;case"onScroll":$e!=null&&Bi("scroll",ye);break;case"onScrollEnd":$e!=null&&Bi("scrollend",ye);break;case"onClick":$e!=null&&(ye.onclick=O2);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wn.hasOwnProperty(Pe))e:{if(Pe[0]==="o"&&Pe[1]==="n"&&(tt=Pe.endsWith("Capture"),_e=Pe.slice(2,tt?Pe.length-7:void 0),lt=ye[Fi]||null,lt=lt!=null?lt[Pe]:null,typeof lt=="function"&&ye.removeEventListener(_e,lt,tt),typeof $e=="function")){typeof lt!="function"&&lt!==null&&(Pe in ye?ye[Pe]=null:ye.hasAttribute(Pe)&&ye.removeAttribute(Pe)),ye.addEventListener(_e,$e,tt);break e}Pe in ye?ye[Pe]=$e:$e===!0?ye.setAttribute(Pe,""):ii(ye,Pe,$e)}}}function Is(ye,_e,Pe){switch(_e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Bi("error",ye),Bi("load",ye);var $e=!1,tt=!1,lt;for(lt in Pe)if(Pe.hasOwnProperty(lt)){var Dt=Pe[lt];if(Dt!=null)switch(lt){case"src":$e=!0;break;case"srcSet":tt=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error($(137,_e));default:Sa(ye,_e,lt,Dt,Pe,null)}}tt&&Sa(ye,_e,"srcSet",Pe.srcSet,Pe,null),$e&&Sa(ye,_e,"src",Pe.src,Pe,null);return;case"input":Bi("invalid",ye);var qt=lt=Dt=tt=null,dn=null,Gn=null;for($e in Pe)if(Pe.hasOwnProperty($e)){var mr=Pe[$e];if(mr!=null)switch($e){case"name":tt=mr;break;case"type":Dt=mr;break;case"checked":dn=mr;break;case"defaultChecked":Gn=mr;break;case"value":lt=mr;break;case"defaultValue":qt=mr;break;case"children":case"dangerouslySetInnerHTML":if(mr!=null)throw Error($(137,_e));break;default:Sa(ye,_e,$e,mr,Pe,null)}}Pa(ye,lt,qt,dn,Gn,Dt,tt,!1),Js(ye);return;case"select":Bi("invalid",ye),$e=Dt=lt=null;for(tt in Pe)if(Pe.hasOwnProperty(tt)&&(qt=Pe[tt],qt!=null))switch(tt){case"value":lt=qt;break;case"defaultValue":Dt=qt;break;case"multiple":$e=qt;default:Sa(ye,_e,tt,qt,Pe,null)}_e=lt,Pe=Dt,ye.multiple=!!$e,_e!=null?Ys(ye,!!$e,_e,!1):Pe!=null&&Ys(ye,!!$e,Pe,!0);return;case"textarea":Bi("invalid",ye),lt=tt=$e=null;for(Dt in Pe)if(Pe.hasOwnProperty(Dt)&&(qt=Pe[Dt],qt!=null))switch(Dt){case"value":$e=qt;break;case"defaultValue":tt=qt;break;case"children":lt=qt;break;case"dangerouslySetInnerHTML":if(qt!=null)throw Error($(91));break;default:Sa(ye,_e,Dt,qt,Pe,null)}ka(ye,$e,tt,lt),Js(ye);return;case"option":for(dn in Pe)if(Pe.hasOwnProperty(dn)&&($e=Pe[dn],$e!=null))switch(dn){case"selected":ye.selected=$e&&typeof $e!="function"&&typeof $e!="symbol";break;default:Sa(ye,_e,dn,$e,Pe,null)}return;case"dialog":Bi("beforetoggle",ye),Bi("toggle",ye),Bi("cancel",ye),Bi("close",ye);break;case"iframe":case"object":Bi("load",ye);break;case"video":case"audio":for($e=0;$e<Bl.length;$e++)Bi(Bl[$e],ye);break;case"image":Bi("error",ye),Bi("load",ye);break;case"details":Bi("toggle",ye);break;case"embed":case"source":case"link":Bi("error",ye),Bi("load",ye);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Gn in Pe)if(Pe.hasOwnProperty(Gn)&&($e=Pe[Gn],$e!=null))switch(Gn){case"children":case"dangerouslySetInnerHTML":throw Error($(137,_e));default:Sa(ye,_e,Gn,$e,Pe,null)}return;default:if(K0(_e)){for(mr in Pe)Pe.hasOwnProperty(mr)&&($e=Pe[mr],$e!==void 0&&Eh(ye,_e,mr,$e,Pe,void 0));return}}for(qt in Pe)Pe.hasOwnProperty(qt)&&($e=Pe[qt],$e!=null&&Sa(ye,_e,qt,$e,Pe,null))}function vm(ye,_e,Pe,$e){switch(_e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var tt=null,lt=null,Dt=null,qt=null,dn=null,Gn=null,mr=null;for(Qn in Pe){var Er=Pe[Qn];if(Pe.hasOwnProperty(Qn)&&Er!=null)switch(Qn){case"checked":break;case"value":break;case"defaultValue":dn=Er;default:$e.hasOwnProperty(Qn)||Sa(ye,_e,Qn,null,$e,Er)}}for(var Yn in $e){var Qn=$e[Yn];if(Er=Pe[Yn],$e.hasOwnProperty(Yn)&&(Qn!=null||Er!=null))switch(Yn){case"type":lt=Qn;break;case"name":tt=Qn;break;case"checked":Gn=Qn;break;case"defaultChecked":mr=Qn;break;case"value":Dt=Qn;break;case"defaultValue":qt=Qn;break;case"children":case"dangerouslySetInnerHTML":if(Qn!=null)throw Error($(137,_e));break;default:Qn!==Er&&Sa(ye,_e,Yn,Qn,$e,Er)}}Ts(ye,Dt,qt,dn,Gn,mr,lt,tt);return;case"select":Qn=Dt=qt=Yn=null;for(lt in Pe)if(dn=Pe[lt],Pe.hasOwnProperty(lt)&&dn!=null)switch(lt){case"value":break;case"multiple":Qn=dn;default:$e.hasOwnProperty(lt)||Sa(ye,_e,lt,null,$e,dn)}for(tt in $e)if(lt=$e[tt],dn=Pe[tt],$e.hasOwnProperty(tt)&&(lt!=null||dn!=null))switch(tt){case"value":Yn=lt;break;case"defaultValue":qt=lt;break;case"multiple":Dt=lt;default:lt!==dn&&Sa(ye,_e,tt,lt,$e,dn)}_e=qt,Pe=Dt,$e=Qn,Yn!=null?Ys(ye,!!Pe,Yn,!1):!!$e!=!!Pe&&(_e!=null?Ys(ye,!!Pe,_e,!0):Ys(ye,!!Pe,Pe?[]:"",!1));return;case"textarea":Qn=Yn=null;for(qt in Pe)if(tt=Pe[qt],Pe.hasOwnProperty(qt)&&tt!=null&&!$e.hasOwnProperty(qt))switch(qt){case"value":break;case"children":break;default:Sa(ye,_e,qt,null,$e,tt)}for(Dt in $e)if(tt=$e[Dt],lt=Pe[Dt],$e.hasOwnProperty(Dt)&&(tt!=null||lt!=null))switch(Dt){case"value":Yn=tt;break;case"defaultValue":Qn=tt;break;case"children":break;case"dangerouslySetInnerHTML":if(tt!=null)throw Error($(91));break;default:tt!==lt&&Sa(ye,_e,Dt,tt,$e,lt)}yx(ye,Yn,Qn);return;case"option":for(var wi in Pe)if(Yn=Pe[wi],Pe.hasOwnProperty(wi)&&Yn!=null&&!$e.hasOwnProperty(wi))switch(wi){case"selected":ye.selected=!1;break;default:Sa(ye,_e,wi,null,$e,Yn)}for(dn in $e)if(Yn=$e[dn],Qn=Pe[dn],$e.hasOwnProperty(dn)&&Yn!==Qn&&(Yn!=null||Qn!=null))switch(dn){case"selected":ye.selected=Yn&&typeof Yn!="function"&&typeof Yn!="symbol";break;default:Sa(ye,_e,dn,Yn,$e,Qn)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Si in Pe)Yn=Pe[Si],Pe.hasOwnProperty(Si)&&Yn!=null&&!$e.hasOwnProperty(Si)&&Sa(ye,_e,Si,null,$e,Yn);for(Gn in $e)if(Yn=$e[Gn],Qn=Pe[Gn],$e.hasOwnProperty(Gn)&&Yn!==Qn&&(Yn!=null||Qn!=null))switch(Gn){case"children":case"dangerouslySetInnerHTML":if(Yn!=null)throw Error($(137,_e));break;default:Sa(ye,_e,Gn,Yn,$e,Qn)}return;default:if(K0(_e)){for(var Ta in Pe)Yn=Pe[Ta],Pe.hasOwnProperty(Ta)&&Yn!==void 0&&!$e.hasOwnProperty(Ta)&&Eh(ye,_e,Ta,void 0,$e,Yn);for(mr in $e)Yn=$e[mr],Qn=Pe[mr],!$e.hasOwnProperty(mr)||Yn===Qn||Yn===void 0&&Qn===void 0||Eh(ye,_e,mr,Yn,$e,Qn);return}}for(var Rn in Pe)Yn=Pe[Rn],Pe.hasOwnProperty(Rn)&&Yn!=null&&!$e.hasOwnProperty(Rn)&&Sa(ye,_e,Rn,null,$e,Yn);for(Er in $e)Yn=$e[Er],Qn=Pe[Er],!$e.hasOwnProperty(Er)||Yn===Qn||Yn==null&&Qn==null||Sa(ye,_e,Er,Yn,$e,Qn)}var wh=null,Ah=null;function B2(ye){return ye.nodeType===9?ye:ye.ownerDocument}function Qd(ye){switch(ye){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Zd(ye,_e){if(ye===0)switch(_e){case"svg":return 1;case"math":return 2;default:return 0}return ye===1&&_e==="foreignObject"?0:ye}function Mh(ye,_e){return ye==="textarea"||ye==="noscript"||typeof _e.children=="string"||typeof _e.children=="number"||typeof _e.children=="bigint"||typeof _e.dangerouslySetInnerHTML=="object"&&_e.dangerouslySetInnerHTML!==null&&_e.dangerouslySetInnerHTML.__html!=null}var Ch=null;function _m(){var ye=window.event;return ye&&ye.type==="popstate"?ye===Ch?!1:(Ch=ye,!0):(Ch=null,!1)}var Jd=typeof setTimeout=="function"?setTimeout:void 0,Sm=typeof clearTimeout=="function"?clearTimeout:void 0,jd=typeof Promise=="function"?Promise:void 0,Tm=typeof queueMicrotask=="function"?queueMicrotask:typeof jd<"u"?function(ye){return jd.resolve(null).then(ye).catch(Em)}:Jd;function Em(ye){setTimeout(function(){throw ye})}function zx(ye){return ye==="head"}function ep(ye,_e){var Pe=_e,$e=0,tt=0;do{var lt=Pe.nextSibling;if(ye.removeChild(Pe),lt&&lt.nodeType===8)if(Pe=lt.data,Pe==="/$"){if(0<$e&&8>$e){Pe=$e;var Dt=ye.ownerDocument;if(Pe&1&&Vl(Dt.documentElement),Pe&2&&Vl(Dt.body),Pe&4)for(Pe=Dt.head,Vl(Pe),Dt=Pe.firstChild;Dt;){var qt=Dt.nextSibling,dn=Dt.nodeName;Dt[$s]||dn==="SCRIPT"||dn==="STYLE"||dn==="LINK"&&Dt.rel.toLowerCase()==="stylesheet"||Pe.removeChild(Dt),Dt=qt}}if(tt===0){ye.removeChild(lt),Xl(_e);return}tt--}else Pe==="$"||Pe==="$?"||Pe==="$!"?tt++:$e=Pe.charCodeAt(0)-48;else $e=0;Pe=lt}while(Pe);Xl(_e)}function Rh(ye){var _e=ye.firstChild;for(_e&&_e.nodeType===10&&(_e=_e.nextSibling);_e;){var Pe=_e;switch(_e=_e.nextSibling,Pe.nodeName){case"HTML":case"HEAD":case"BODY":Rh(Pe),v0(Pe);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(Pe.rel.toLowerCase()==="stylesheet")continue}ye.removeChild(Pe)}}function wm(ye,_e,Pe,$e){for(;ye.nodeType===1;){var tt=Pe;if(ye.nodeName.toLowerCase()!==_e.toLowerCase()){if(!$e&&(ye.nodeName!=="INPUT"||ye.type!=="hidden"))break}else if($e){if(!ye[$s])switch(_e){case"meta":if(!ye.hasAttribute("itemprop"))break;return ye;case"link":if(lt=ye.getAttribute("rel"),lt==="stylesheet"&&ye.hasAttribute("data-precedence"))break;if(lt!==tt.rel||ye.getAttribute("href")!==(tt.href==null||tt.href===""?null:tt.href)||ye.getAttribute("crossorigin")!==(tt.crossOrigin==null?null:tt.crossOrigin)||ye.getAttribute("title")!==(tt.title==null?null:tt.title))break;return ye;case"style":if(ye.hasAttribute("data-precedence"))break;return ye;case"script":if(lt=ye.getAttribute("src"),(lt!==(tt.src==null?null:tt.src)||ye.getAttribute("type")!==(tt.type==null?null:tt.type)||ye.getAttribute("crossorigin")!==(tt.crossOrigin==null?null:tt.crossOrigin))&&lt&&ye.hasAttribute("async")&&!ye.hasAttribute("itemprop"))break;return ye;default:return ye}}else if(_e==="input"&&ye.type==="hidden"){var lt=tt.name==null?null:""+tt.name;if(tt.type==="hidden"&&ye.getAttribute("name")===lt)return ye}else return ye;if(ye=F0(ye.nextSibling),ye===null)break}return null}function Am(ye,_e,Pe){if(_e==="")return null;for(;ye.nodeType!==3;)if((ye.nodeType!==1||ye.nodeName!=="INPUT"||ye.type!=="hidden")&&!Pe||(ye=F0(ye.nextSibling),ye===null))return null;return ye}function Ph(ye){return ye.data==="$!"||ye.data==="$?"&&ye.ownerDocument.readyState==="complete"}function Mm(ye,_e){var Pe=ye.ownerDocument;if(ye.data!=="$?"||Pe.readyState==="complete")_e();else{var $e=function(){_e(),Pe.removeEventListener("DOMContentLoaded",$e)};Pe.addEventListener("DOMContentLoaded",$e),ye._reactRetry=$e}}function F0(ye){for(;ye!=null;ye=ye.nextSibling){var _e=ye.nodeType;if(_e===1||_e===3)break;if(_e===8){if(_e=ye.data,_e==="$"||_e==="$!"||_e==="$?"||_e==="F!"||_e==="F")break;if(_e==="/$")return null}}return ye}var Ih=null;function tp(ye){ye=ye.previousSibling;for(var _e=0;ye;){if(ye.nodeType===8){var Pe=ye.data;if(Pe==="$"||Pe==="$!"||Pe==="$?"){if(_e===0)return ye;_e--}else Pe==="/$"&&_e++}ye=ye.previousSibling}return null}function np(ye,_e,Pe){switch(_e=B2(Pe),ye){case"html":if(ye=_e.documentElement,!ye)throw Error($(452));return ye;case"head":if(ye=_e.head,!ye)throw Error($(453));return ye;case"body":if(ye=_e.body,!ye)throw Error($(454));return ye;default:throw Error($(451))}}function Vl(ye){for(var _e=ye.attributes;_e.length;)ye.removeAttributeNode(_e[0]);v0(ye)}var N0=new Map,rp=new Set;function U2(ye){return typeof ye.getRootNode=="function"?ye.getRootNode():ye.nodeType===9?ye:ye.ownerDocument}var mx=It.d;It.d={f:Cm,r:Rm,D:Pm,C:Im,L:Nm,m:Dm,X:Lm,S:km,M:Fm};function Cm(){var ye=mx.f(),_e=P2();return ye||_e}function Rm(ye){var _e=Zs(ye);_e!==null&&_e.tag===5&&_e.type==="form"?Tf(_e):mx.r(ye)}var ol=typeof document>"u"?null:document;function ap(ye,_e,Pe){var $e=ol;if($e&&typeof _e=="string"&&_e){var tt=Di(_e);tt='link[rel="'+ye+'"][href="'+tt+'"]',typeof Pe=="string"&&(tt+='[crossorigin="'+Pe+'"]'),rp.has(tt)||(rp.add(tt),ye={rel:ye,crossOrigin:Pe,href:_e},$e.querySelector(tt)===null&&(_e=$e.createElement("link"),Is(_e,"link",ye),vn(_e),$e.head.appendChild(_e)))}}function Pm(ye){mx.D(ye),ap("dns-prefetch",ye,null)}function Im(ye,_e){mx.C(ye,_e),ap("preconnect",ye,_e)}function Nm(ye,_e,Pe){mx.L(ye,_e,Pe);var $e=ol;if($e&&ye&&_e){var tt='link[rel="preload"][as="'+Di(_e)+'"]';_e==="image"&&Pe&&Pe.imageSrcSet?(tt+='[imagesrcset="'+Di(Pe.imageSrcSet)+'"]',typeof Pe.imageSizes=="string"&&(tt+='[imagesizes="'+Di(Pe.imageSizes)+'"]')):tt+='[href="'+Di(ye)+'"]';var lt=tt;switch(_e){case"style":lt=ll(ye);break;case"script":lt=cl(ye)}N0.has(lt)||(ye=ve({rel:"preload",href:_e==="image"&&Pe&&Pe.imageSrcSet?void 0:ye,as:_e},Pe),N0.set(lt,ye),$e.querySelector(tt)!==null||_e==="style"&&$e.querySelector(zl(lt))||_e==="script"&&$e.querySelector(Gl(lt))||(_e=$e.createElement("link"),Is(_e,"link",ye),vn(_e),$e.head.appendChild(_e)))}}function Dm(ye,_e){mx.m(ye,_e);var Pe=ol;if(Pe&&ye){var $e=_e&&typeof _e.as=="string"?_e.as:"script",tt='link[rel="modulepreload"][as="'+Di($e)+'"][href="'+Di(ye)+'"]',lt=tt;switch($e){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":lt=cl(ye)}if(!N0.has(lt)&&(ye=ve({rel:"modulepreload",href:ye},_e),N0.set(lt,ye),Pe.querySelector(tt)===null)){switch($e){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(Pe.querySelector(Gl(lt)))return}$e=Pe.createElement("link"),Is($e,"link",ye),vn($e),Pe.head.appendChild($e)}}}function km(ye,_e,Pe){mx.S(ye,_e,Pe);var $e=ol;if($e&&ye){var tt=Jt($e).hoistableStyles,lt=ll(ye);_e=_e||"default";var Dt=tt.get(lt);if(!Dt){var qt={loading:0,preload:null};if(Dt=$e.querySelector(zl(lt)))qt.loading=5;else{ye=ve({rel:"stylesheet",href:ye,"data-precedence":_e},Pe),(Pe=N0.get(lt))&&Nh(ye,Pe);var dn=Dt=$e.createElement("link");vn(dn),Is(dn,"link",ye),dn._p=new Promise(function(Gn,mr){dn.onload=Gn,dn.onerror=mr}),dn.addEventListener("load",function(){qt.loading|=1}),dn.addEventListener("error",function(){qt.loading|=2}),qt.loading|=4,V2(Dt,_e,$e)}Dt={type:"stylesheet",instance:Dt,count:1,state:qt},tt.set(lt,Dt)}}}function Lm(ye,_e){mx.X(ye,_e);var Pe=ol;if(Pe&&ye){var $e=Jt(Pe).hoistableScripts,tt=cl(ye),lt=$e.get(tt);lt||(lt=Pe.querySelector(Gl(tt)),lt||(ye=ve({src:ye,async:!0},_e),(_e=N0.get(tt))&&Dh(ye,_e),lt=Pe.createElement("script"),vn(lt),Is(lt,"link",ye),Pe.head.appendChild(lt)),lt={type:"script",instance:lt,count:1,state:null},$e.set(tt,lt))}}function Fm(ye,_e){mx.M(ye,_e);var Pe=ol;if(Pe&&ye){var $e=Jt(Pe).hoistableScripts,tt=cl(ye),lt=$e.get(tt);lt||(lt=Pe.querySelector(Gl(tt)),lt||(ye=ve({src:ye,async:!0,type:"module"},_e),(_e=N0.get(tt))&&Dh(ye,_e),lt=Pe.createElement("script"),vn(lt),Is(lt,"link",ye),Pe.head.appendChild(lt)),lt={type:"script",instance:lt,count:1,state:null},$e.set(tt,lt))}}function sp(ye,_e,Pe,$e){var tt=(tt=Pn.current)?U2(tt):null;if(!tt)throw Error($(446));switch(ye){case"meta":case"title":return null;case"style":return typeof Pe.precedence=="string"&&typeof Pe.href=="string"?(_e=ll(Pe.href),Pe=Jt(tt).hoistableStyles,$e=Pe.get(_e),$e||($e={type:"style",instance:null,count:0,state:null},Pe.set(_e,$e)),$e):{type:"void",instance:null,count:0,state:null};case"link":if(Pe.rel==="stylesheet"&&typeof Pe.href=="string"&&typeof Pe.precedence=="string"){ye=ll(Pe.href);var lt=Jt(tt).hoistableStyles,Dt=lt.get(ye);if(Dt||(tt=tt.ownerDocument||tt,Dt={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},lt.set(ye,Dt),(lt=tt.querySelector(zl(ye)))&&!lt._p&&(Dt.instance=lt,Dt.state.loading=5),N0.has(ye)||(Pe={rel:"preload",as:"style",href:Pe.href,crossOrigin:Pe.crossOrigin,integrity:Pe.integrity,media:Pe.media,hrefLang:Pe.hrefLang,referrerPolicy:Pe.referrerPolicy},N0.set(ye,Pe),lt||Om(tt,ye,Pe,Dt.state))),_e&&$e===null)throw Error($(528,""));return Dt}if(_e&&$e!==null)throw Error($(529,""));return null;case"script":return _e=Pe.async,Pe=Pe.src,typeof Pe=="string"&&_e&&typeof _e!="function"&&typeof _e!="symbol"?(_e=cl(Pe),Pe=Jt(tt).hoistableScripts,$e=Pe.get(_e),$e||($e={type:"script",instance:null,count:0,state:null},Pe.set(_e,$e)),$e):{type:"void",instance:null,count:0,state:null};default:throw Error($(444,ye))}}function ll(ye){return'href="'+Di(ye)+'"'}function zl(ye){return'link[rel="stylesheet"]['+ye+"]"}function xp(ye){return ve({},ye,{"data-precedence":ye.precedence,precedence:null})}function Om(ye,_e,Pe,$e){ye.querySelector('link[rel="preload"][as="style"]['+_e+"]")?$e.loading=1:(_e=ye.createElement("link"),$e.preload=_e,_e.addEventListener("load",function(){return $e.loading|=1}),_e.addEventListener("error",function(){return $e.loading|=2}),Is(_e,"link",Pe),vn(_e),ye.head.appendChild(_e))}function cl(ye){return'[src="'+Di(ye)+'"]'}function Gl(ye){return"script[async]"+ye}function lp(ye,_e,Pe){if(_e.count++,_e.instance===null)switch(_e.type){case"style":var $e=ye.querySelector('style[data-href~="'+Di(Pe.href)+'"]');if($e)return _e.instance=$e,vn($e),$e;var tt=ve({},Pe,{"data-href":Pe.href,"data-precedence":Pe.precedence,href:null,precedence:null});return $e=(ye.ownerDocument||ye).createElement("style"),vn($e),Is($e,"style",tt),V2($e,Pe.precedence,ye),_e.instance=$e;case"stylesheet":tt=ll(Pe.href);var lt=ye.querySelector(zl(tt));if(lt)return _e.state.loading|=4,_e.instance=lt,vn(lt),lt;$e=xp(Pe),(tt=N0.get(tt))&&Nh($e,tt),lt=(ye.ownerDocument||ye).createElement("link"),vn(lt);var Dt=lt;return Dt._p=new Promise(function(qt,dn){Dt.onload=qt,Dt.onerror=dn}),Is(lt,"link",$e),_e.state.loading|=4,V2(lt,Pe.precedence,ye),_e.instance=lt;case"script":return lt=cl(Pe.src),(tt=ye.querySelector(Gl(lt)))?(_e.instance=tt,vn(tt),tt):($e=Pe,(tt=N0.get(lt))&&($e=ve({},Pe),Dh($e,tt)),ye=ye.ownerDocument||ye,tt=ye.createElement("script"),vn(tt),Is(tt,"link",$e),ye.head.appendChild(tt),_e.instance=tt);case"void":return null;default:throw Error($(443,_e.type))}else _e.type==="stylesheet"&&(_e.state.loading&4)===0&&($e=_e.instance,_e.state.loading|=4,V2($e,Pe.precedence,ye));return _e.instance}function V2(ye,_e,Pe){for(var $e=Pe.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),tt=$e.length?$e[$e.length-1]:null,lt=tt,Dt=0;Dt<$e.length;Dt++){var qt=$e[Dt];if(qt.dataset.precedence===_e)lt=qt;else if(lt!==tt)break}lt?lt.parentNode.insertBefore(ye,lt.nextSibling):(_e=Pe.nodeType===9?Pe.head:Pe,_e.insertBefore(ye,_e.firstChild))}function Nh(ye,_e){ye.crossOrigin==null&&(ye.crossOrigin=_e.crossOrigin),ye.referrerPolicy==null&&(ye.referrerPolicy=_e.referrerPolicy),ye.title==null&&(ye.title=_e.title)}function Dh(ye,_e){ye.crossOrigin==null&&(ye.crossOrigin=_e.crossOrigin),ye.referrerPolicy==null&&(ye.referrerPolicy=_e.referrerPolicy),ye.integrity==null&&(ye.integrity=_e.integrity)}var z2=null;function cp(ye,_e,Pe){if(z2===null){var $e=new Map,tt=z2=new Map;tt.set(Pe,$e)}else tt=z2,$e=tt.get(Pe),$e||($e=new Map,tt.set(Pe,$e));if($e.has(ye))return $e;for($e.set(ye,null),Pe=Pe.getElementsByTagName(ye),tt=0;tt<Pe.length;tt++){var lt=Pe[tt];if(!(lt[$s]||lt[$i]||ye==="link"&&lt.getAttribute("rel")==="stylesheet")&&lt.namespaceURI!=="http://www.w3.org/2000/svg"){var Dt=lt.getAttribute(_e)||"";Dt=ye+Dt;var qt=$e.get(Dt);qt?qt.push(lt):$e.set(Dt,[lt])}}return $e}function hp(ye,_e,Pe){ye=ye.ownerDocument||ye,ye.head.insertBefore(Pe,_e==="title"?ye.querySelector("head > title"):null)}function Bm(ye,_e,Pe){if(Pe===1||_e.itemProp!=null)return!1;switch(ye){case"meta":case"title":return!0;case"style":if(typeof _e.precedence!="string"||typeof _e.href!="string"||_e.href==="")break;return!0;case"link":if(typeof _e.rel!="string"||typeof _e.href!="string"||_e.href===""||_e.onLoad||_e.onError)break;switch(_e.rel){case"stylesheet":return ye=_e.disabled,typeof _e.precedence=="string"&&ye==null;default:return!0}case"script":if(_e.async&&typeof _e.async!="function"&&typeof _e.async!="symbol"&&!_e.onLoad&&!_e.onError&&_e.src&&typeof _e.src=="string")return!0}return!1}function up(ye){return!(ye.type==="stylesheet"&&(ye.state.loading&3)===0)}var Hl=null;function Um(){}function Vm(ye,_e,Pe){if(Hl===null)throw Error($(475));var $e=Hl;if(_e.type==="stylesheet"&&(typeof Pe.media!="string"||matchMedia(Pe.media).matches!==!1)&&(_e.state.loading&4)===0){if(_e.instance===null){var tt=ll(Pe.href),lt=ye.querySelector(zl(tt));if(lt){ye=lt._p,ye!==null&&typeof ye=="object"&&typeof ye.then=="function"&&($e.count++,$e=G2.bind($e),ye.then($e,$e)),_e.state.loading|=4,_e.instance=lt,vn(lt);return}lt=ye.ownerDocument||ye,Pe=xp(Pe),(tt=N0.get(tt))&&Nh(Pe,tt),lt=lt.createElement("link"),vn(lt);var Dt=lt;Dt._p=new Promise(function(qt,dn){Dt.onload=qt,Dt.onerror=dn}),Is(lt,"link",Pe),_e.instance=lt}$e.stylesheets===null&&($e.stylesheets=new Map),$e.stylesheets.set(_e,ye),(ye=_e.state.preload)&&(_e.state.loading&3)===0&&($e.count++,_e=G2.bind($e),ye.addEventListener("load",_e),ye.addEventListener("error",_e))}}function zm(){if(Hl===null)throw Error($(475));var ye=Hl;return ye.stylesheets&&ye.count===0&&kh(ye,ye.stylesheets),0<ye.count?function(_e){var Pe=setTimeout(function(){if(ye.stylesheets&&kh(ye,ye.stylesheets),ye.unsuspend){var $e=ye.unsuspend;ye.unsuspend=null,$e()}},6e4);return ye.unsuspend=_e,function(){ye.unsuspend=null,clearTimeout(Pe)}}:null}function G2(){if(this.count--,this.count===0){if(this.stylesheets)kh(this,this.stylesheets);else if(this.unsuspend){var ye=this.unsuspend;this.unsuspend=null,ye()}}}var H2=null;function kh(ye,_e){ye.stylesheets=null,ye.unsuspend!==null&&(ye.count++,H2=new Map,_e.forEach(Gm,ye),H2=null,G2.call(ye))}function Gm(ye,_e){if(!(_e.state.loading&4)){var Pe=H2.get(ye);if(Pe)var $e=Pe.get(null);else{Pe=new Map,H2.set(ye,Pe);for(var tt=ye.querySelectorAll("link[data-precedence],style[data-precedence]"),lt=0;lt<tt.length;lt++){var Dt=tt[lt];(Dt.nodeName==="LINK"||Dt.getAttribute("media")!=="not all")&&(Pe.set(Dt.dataset.precedence,Dt),$e=Dt)}$e&&Pe.set(null,$e)}tt=_e.instance,Dt=tt.getAttribute("data-precedence"),lt=Pe.get(Dt)||$e,lt===$e&&Pe.set(null,tt),Pe.set(Dt,tt),this.count++,$e=G2.bind(this),tt.addEventListener("load",$e),tt.addEventListener("error",$e),lt?lt.parentNode.insertBefore(tt,lt.nextSibling):(ye=ye.nodeType===9?ye.head:ye,ye.insertBefore(tt,ye.firstChild)),_e.state.loading|=4}}var $l={$$typeof:Xe,Provider:null,Consumer:null,_currentValue:gt,_currentValue2:gt,_threadCount:0};function Hm(ye,_e,Pe,$e,tt,lt,Dt,qt){this.tag=1,this.containerInfo=ye,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gr(0),this.hiddenUpdates=gr(null),this.identifierPrefix=$e,this.onUncaughtError=tt,this.onCaughtError=lt,this.onRecoverableError=Dt,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=qt,this.incompleteTransitions=new Map}function fp(ye,_e,Pe,$e,tt,lt,Dt,qt,dn,Gn,mr,Er){return ye=new Hm(ye,_e,Pe,Dt,qt,dn,Gn,Er),_e=1,lt===!0&&(_e|=24),lt=f0(3,null,null,_e),ye.current=lt,lt.stateNode=ye,_e=hc(),_e.refCount++,ye.pooledCache=_e,_e.refCount++,lt.memoizedState={element:$e,isDehydrated:Pe,cache:_e},pc(lt),ye}function dp(ye){return ye?(ye=No,ye):No}function pp(ye,_e,Pe,$e,tt,lt){tt=dp(tt),$e.context===null?$e.context=tt:$e.pendingContext=tt,$e=Cx(_e),$e.payload={element:Pe},lt=lt===void 0?null:lt,lt!==null&&($e.callback=lt),Pe=Rx(ye,$e,_e),Pe!==null&&(g0(Pe,ye,_e),_l(Pe,ye,_e))}function mp(ye,_e){if(ye=ye.memoizedState,ye!==null&&ye.dehydrated!==null){var Pe=ye.retryLane;ye.retryLane=Pe!==0&&Pe<_e?Pe:_e}}function Lh(ye,_e){mp(ye,_e),(ye=ye.alternate)&&mp(ye,_e)}function yp(ye){if(ye.tag===13){var _e=Io(ye,67108864);_e!==null&&g0(_e,ye,67108864),Lh(ye,67108864)}}var $2=!0;function $m(ye,_e,Pe,$e){var tt=vt.T;vt.T=null;var lt=It.p;try{It.p=2,Fh(ye,_e,Pe,$e)}finally{It.p=lt,vt.T=tt}}function Wm(ye,_e,Pe,$e){var tt=vt.T;vt.T=null;var lt=It.p;try{It.p=8,Fh(ye,_e,Pe,$e)}finally{It.p=lt,vt.T=tt}}function Fh(ye,_e,Pe,$e){if($2){var tt=Oh($e);if(tt===null)Th(ye,_e,$e,W2,Pe),vp(ye,$e);else if(Ym(tt,ye,_e,Pe,$e))$e.stopPropagation();else if(vp(ye,$e),_e&4&&-1<qm.indexOf(ye)){for(;tt!==null;){var lt=Zs(tt);if(lt!==null)switch(lt.tag){case 3:if(lt=lt.stateNode,lt.current.memoizedState.isDehydrated){var Dt=ri(lt.pendingLanes);if(Dt!==0){var qt=lt;for(qt.pendingLanes|=2,qt.entangledLanes|=2;Dt;){var dn=1<<31-vr(Dt);qt.entanglements[1]|=dn,Dt&=~dn}X0(lt),(ra&6)===0&&(C2=ai()+500,Ol(0))}}break;case 13:qt=Io(lt,2),qt!==null&&g0(qt,lt,2),P2(),Lh(lt,2)}if(lt=Oh($e),lt===null&&Th(ye,_e,$e,W2,Pe),lt===tt)break;tt=lt}tt!==null&&$e.stopPropagation()}else Th(ye,_e,$e,null,Pe)}}function Oh(ye){return ye=os(ye),Bh(ye)}var W2=null;function Bh(ye){if(W2=null,ye=Qs(ye),ye!==null){var _e=re(ye);if(_e===null)ye=null;else{var Pe=_e.tag;if(Pe===13){if(ye=ae(_e),ye!==null)return ye;ye=null}else if(Pe===3){if(_e.stateNode.current.memoizedState.isDehydrated)return _e.tag===3?_e.stateNode.containerInfo:null;ye=null}else _e!==ye&&(ye=null)}}return W2=ye,null}function gp(ye){switch(ye){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Hr()){case Vr:return 2;case xn:return 8;case Ht:case In:return 32;case er:return 268435456;default:return 32}default:return 32}}var Uh=!1,Gx=null,Hx=null,$x=null,Wl=new Map,ql=new Map,Wx=[],qm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vp(ye,_e){switch(ye){case"focusin":case"focusout":Gx=null;break;case"dragenter":case"dragleave":Hx=null;break;case"mouseover":case"mouseout":$x=null;break;case"pointerover":case"pointerout":Wl.delete(_e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ql.delete(_e.pointerId)}}function Yl(ye,_e,Pe,$e,tt,lt){return ye===null||ye.nativeEvent!==lt?(ye={blockedOn:_e,domEventName:Pe,eventSystemFlags:$e,nativeEvent:lt,targetContainers:[tt]},_e!==null&&(_e=Zs(_e),_e!==null&&yp(_e)),ye):(ye.eventSystemFlags|=$e,_e=ye.targetContainers,tt!==null&&_e.indexOf(tt)===-1&&_e.push(tt),ye)}function Ym(ye,_e,Pe,$e,tt){switch(_e){case"focusin":return Gx=Yl(Gx,ye,_e,Pe,$e,tt),!0;case"dragenter":return Hx=Yl(Hx,ye,_e,Pe,$e,tt),!0;case"mouseover":return $x=Yl($x,ye,_e,Pe,$e,tt),!0;case"pointerover":var lt=tt.pointerId;return Wl.set(lt,Yl(Wl.get(lt)||null,ye,_e,Pe,$e,tt)),!0;case"gotpointercapture":return lt=tt.pointerId,ql.set(lt,Yl(ql.get(lt)||null,ye,_e,Pe,$e,tt)),!0}return!1}function _p(ye){var _e=Qs(ye.target);if(_e!==null){var Pe=re(_e);if(Pe!==null){if(_e=Pe.tag,_e===13){if(_e=ae(Pe),_e!==null){ye.blockedOn=_e,Ra(ye.priority,function(){if(Pe.tag===13){var $e=y0();$e=Vi($e);var tt=Io(Pe,$e);tt!==null&&g0(tt,Pe,$e),Lh(Pe,$e)}});return}}else if(_e===3&&Pe.stateNode.current.memoizedState.isDehydrated){ye.blockedOn=Pe.tag===3?Pe.stateNode.containerInfo:null;return}}}ye.blockedOn=null}function q2(ye){if(ye.blockedOn!==null)return!1;for(var _e=ye.targetContainers;0<_e.length;){var Pe=Oh(ye.nativeEvent);if(Pe===null){Pe=ye.nativeEvent;var $e=new Pe.constructor(Pe.type,Pe);B0=$e,Pe.target.dispatchEvent($e),B0=null}else return _e=Zs(Pe),_e!==null&&yp(_e),ye.blockedOn=Pe,!1;_e.shift()}return!0}function Sp(ye,_e,Pe){q2(ye)&&Pe.delete(_e)}function Xm(){Uh=!1,Gx!==null&&q2(Gx)&&(Gx=null),Hx!==null&&q2(Hx)&&(Hx=null),$x!==null&&q2($x)&&($x=null),Wl.forEach(Sp),ql.forEach(Sp)}function Y2(ye,_e){ye.blockedOn===_e&&(ye.blockedOn=null,Uh||(Uh=!0,H.unstable_scheduleCallback(H.unstable_NormalPriority,Xm)))}var X2=null;function Tp(ye){X2!==ye&&(X2=ye,H.unstable_scheduleCallback(H.unstable_NormalPriority,function(){X2===ye&&(X2=null);for(var _e=0;_e<ye.length;_e+=3){var Pe=ye[_e],$e=ye[_e+1],tt=ye[_e+2];if(typeof $e!="function"){if(Bh($e||Pe)===null)continue;break}var lt=Zs(Pe);lt!==null&&(ye.splice(_e,3),_e-=3,Fc(lt,{pending:!0,data:tt,method:Pe.method,action:$e},$e,tt))}}))}function Xl(ye){function _e(dn){return Y2(dn,ye)}Gx!==null&&Y2(Gx,ye),Hx!==null&&Y2(Hx,ye),$x!==null&&Y2($x,ye),Wl.forEach(_e),ql.forEach(_e);for(var Pe=0;Pe<Wx.length;Pe++){var $e=Wx[Pe];$e.blockedOn===ye&&($e.blockedOn=null)}for(;0<Wx.length&&(Pe=Wx[0],Pe.blockedOn===null);)_p(Pe),Pe.blockedOn===null&&Wx.shift();if(Pe=(ye.ownerDocument||ye).$$reactFormReplay,Pe!=null)for($e=0;$e<Pe.length;$e+=3){var tt=Pe[$e],lt=Pe[$e+1],Dt=tt[Fi]||null;if(typeof lt=="function")Dt||Tp(Pe);else if(Dt){var qt=null;if(lt&&lt.hasAttribute("formAction")){if(tt=lt,Dt=lt[Fi]||null)qt=Dt.formAction;else if(Bh(tt)!==null)continue}else qt=Dt.action;typeof qt=="function"?Pe[$e+1]=qt:(Pe.splice($e,3),$e-=3),Tp(Pe)}}}function Vh(ye){this._internalRoot=ye}K2.prototype.render=Vh.prototype.render=function(ye){var _e=this._internalRoot;if(_e===null)throw Error($(409));var Pe=_e.current,$e=y0();pp(Pe,$e,ye,_e,null,null)},K2.prototype.unmount=Vh.prototype.unmount=function(){var ye=this._internalRoot;if(ye!==null){this._internalRoot=null;var _e=ye.containerInfo;pp(ye.current,2,null,ye,null,null),P2(),_e[Ss]=null}};function K2(ye){this._internalRoot=ye}K2.prototype.unstable_scheduleHydration=function(ye){if(ye){var _e=Ga();ye={blockedOn:null,target:ye,priority:_e};for(var Pe=0;Pe<Wx.length&&_e!==0&&_e<Wx[Pe].priority;Pe++);Wx.splice(Pe,0,ye),Pe===0&&_p(ye)}};var Ep=_.version;if(Ep!=="19.1.0")throw Error($(527,Ep,"19.1.0"));It.findDOMNode=function(ye){var _e=ye._reactInternals;if(_e===void 0)throw typeof ye.render=="function"?Error($(188)):(ye=Object.keys(ye).join(","),Error($(268,ye)));return ye=le(_e),ye=ye!==null?fe(ye):null,ye=ye===null?null:ye.stateNode,ye};var Km={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:vt,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Q2=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Q2.isDisabled&&Q2.supportsFiber)try{Dr=Q2.inject(Km),zn=Q2}catch{}}return reactDomClient_production.createRoot=function(ye,_e){if(!ee(ye))throw Error($(299));var Pe=!1,$e="",tt=Of,lt=Bf,Dt=Uf,qt=null;return _e!=null&&(_e.unstable_strictMode===!0&&(Pe=!0),_e.identifierPrefix!==void 0&&($e=_e.identifierPrefix),_e.onUncaughtError!==void 0&&(tt=_e.onUncaughtError),_e.onCaughtError!==void 0&&(lt=_e.onCaughtError),_e.onRecoverableError!==void 0&&(Dt=_e.onRecoverableError),_e.unstable_transitionCallbacks!==void 0&&(qt=_e.unstable_transitionCallbacks)),_e=fp(ye,1,!1,null,null,Pe,$e,tt,lt,Dt,qt,null),ye[Ss]=_e.current,Sh(ye),new Vh(_e)},reactDomClient_production.hydrateRoot=function(ye,_e,Pe){if(!ee(ye))throw Error($(299));var $e=!1,tt="",lt=Of,Dt=Bf,qt=Uf,dn=null,Gn=null;return Pe!=null&&(Pe.unstable_strictMode===!0&&($e=!0),Pe.identifierPrefix!==void 0&&(tt=Pe.identifierPrefix),Pe.onUncaughtError!==void 0&&(lt=Pe.onUncaughtError),Pe.onCaughtError!==void 0&&(Dt=Pe.onCaughtError),Pe.onRecoverableError!==void 0&&(qt=Pe.onRecoverableError),Pe.unstable_transitionCallbacks!==void 0&&(dn=Pe.unstable_transitionCallbacks),Pe.formState!==void 0&&(Gn=Pe.formState)),_e=fp(ye,1,!0,_e,Pe??null,$e,tt,lt,Dt,qt,dn,Gn),_e.context=dp(null),Pe=_e.current,$e=y0(),$e=Vi($e),tt=Cx($e),tt.callback=null,Rx(Pe,tt,$e),Pe=$e,_e.current.lanes=Pe,Mr(_e,Pe),X0(_e),ye[Ss]=_e.current,Sh(ye),new K2(_e)},reactDomClient_production.version="19.1.0",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function H(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(H)}catch(_){console.error(_)}}return H(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient(),reactWebcam$1={exports:{}},reactWebcam=reactWebcam$1.exports,hasRequiredReactWebcam;function requireReactWebcam(){return hasRequiredReactWebcam||(hasRequiredReactWebcam=1,function(H,_){(function($,ee){H.exports=ee(requireReact())})(reactWebcam,function(b){return function($){var ee={};function re(ae){if(ee[ae])return ee[ae].exports;var xe=ee[ae]={i:ae,l:!1,exports:{}};return $[ae].call(xe.exports,xe,xe.exports,re),xe.l=!0,xe.exports}return re.m=$,re.c=ee,re.d=function(ae,xe,le){re.o(ae,xe)||Object.defineProperty(ae,xe,{enumerable:!0,get:le})},re.r=function(ae){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(ae,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(ae,"__esModule",{value:!0})},re.t=function(ae,xe){if(xe&1&&(ae=re(ae)),xe&8||xe&4&&typeof ae=="object"&&ae&&ae.__esModule)return ae;var le=Object.create(null);if(re.r(le),Object.defineProperty(le,"default",{enumerable:!0,value:ae}),xe&2&&typeof ae!="string")for(var fe in ae)re.d(le,fe,(function(ve){return ae[ve]}).bind(null,fe));return le},re.n=function(ae){var xe=ae&&ae.__esModule?function(){return ae.default}:function(){return ae};return re.d(xe,"a",xe),xe},re.o=function(ae,xe){return Object.prototype.hasOwnProperty.call(ae,xe)},re.p="",re(re.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function($,ee,re){re.r(ee);var ae=re("react"),xe=function(){var Ee=function(Ce,Ie){return Ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(De,Be){De.__proto__=Be}||function(De,Be){for(var Ne in Be)Be.hasOwnProperty(Ne)&&(De[Ne]=Be[Ne])},Ee(Ce,Ie)};return function(Ce,Ie){Ee(Ce,Ie);function De(){this.constructor=Ce}Ce.prototype=Ie===null?Object.create(Ie):(De.prototype=Ie.prototype,new De)}}(),le=function(){return le=Object.assign||function(Ee){for(var Ce,Ie=1,De=arguments.length;Ie<De;Ie++){Ce=arguments[Ie];for(var Be in Ce)Object.prototype.hasOwnProperty.call(Ce,Be)&&(Ee[Be]=Ce[Be])}return Ee},le.apply(this,arguments)},fe=function(Ee,Ce){var Ie={};for(var De in Ee)Object.prototype.hasOwnProperty.call(Ee,De)&&Ce.indexOf(De)<0&&(Ie[De]=Ee[De]);if(Ee!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Be=0,De=Object.getOwnPropertySymbols(Ee);Be<De.length;Be++)Ce.indexOf(De[Be])<0&&Object.prototype.propertyIsEnumerable.call(Ee,De[Be])&&(Ie[De[Be]]=Ee[De[Be]]);return Ie};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(Ce){var Ie=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return Ie?new Promise(function(De,Be){Ie.call(navigator,Ce,De,Be)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function ve(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var Se=function(Ee){xe(Ce,Ee);function Ce(Ie){var De=Ee.call(this,Ie)||this;return De.canvas=null,De.ctx=null,De.requestUserMediaId=0,De.unmounted=!1,De.state={hasUserMedia:!1},De}return Ce.prototype.componentDidMount=function(){var Ie=this,De=Ie.state,Be=Ie.props;if(this.unmounted=!1,!ve()){Be.onUserMediaError("getUserMedia not supported");return}De.hasUserMedia||this.requestUserMedia(),Be.children&&typeof Be.children!="function"&&console.warn("children must be a function")},Ce.prototype.componentDidUpdate=function(Ie){var De=this.props;if(!ve()){De.onUserMediaError("getUserMedia not supported");return}var Be=JSON.stringify(Ie.audioConstraints)!==JSON.stringify(De.audioConstraints),Ne=JSON.stringify(Ie.videoConstraints)!==JSON.stringify(De.videoConstraints),qe=Ie.minScreenshotWidth!==De.minScreenshotWidth,Xe=Ie.minScreenshotHeight!==De.minScreenshotHeight;(Ne||qe||Xe)&&(this.canvas=null,this.ctx=null),(Be||Ne)&&(this.stopAndCleanup(),this.requestUserMedia())},Ce.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},Ce.stopMediaStream=function(Ie){Ie&&(Ie.getVideoTracks&&Ie.getAudioTracks?(Ie.getVideoTracks().map(function(De){Ie.removeTrack(De),De.stop()}),Ie.getAudioTracks().map(function(De){Ie.removeTrack(De),De.stop()})):Ie.stop())},Ce.prototype.stopAndCleanup=function(){var Ie=this.state;Ie.hasUserMedia&&(Ce.stopMediaStream(this.stream),Ie.src&&window.URL.revokeObjectURL(Ie.src))},Ce.prototype.getScreenshot=function(Ie){var De=this,Be=De.state,Ne=De.props;if(!Be.hasUserMedia)return null;var qe=this.getCanvas(Ie);return qe&&qe.toDataURL(Ne.screenshotFormat,Ne.screenshotQuality)},Ce.prototype.getCanvas=function(Ie){var De=this,Be=De.state,Ne=De.props;if(!this.video||!Be.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var qe=this.video.videoWidth,Xe=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var Ye=qe/Xe;qe=Ne.minScreenshotWidth||this.video.clientWidth,Xe=qe/Ye,Ne.minScreenshotHeight&&Xe<Ne.minScreenshotHeight&&(Xe=Ne.minScreenshotHeight,qe=Xe*Ye)}this.canvas=document.createElement("canvas"),this.canvas.width=(Ie==null?void 0:Ie.width)||qe,this.canvas.height=(Ie==null?void 0:Ie.height)||Xe,this.ctx=this.canvas.getContext("2d")}var Qe=this,rt=Qe.ctx,ot=Qe.canvas;return rt&&ot&&(ot.width=(Ie==null?void 0:Ie.width)||ot.width,ot.height=(Ie==null?void 0:Ie.height)||ot.height,Ne.mirrored&&(rt.translate(ot.width,0),rt.scale(-1,1)),rt.imageSmoothingEnabled=Ne.imageSmoothing,rt.drawImage(this.video,0,0,(Ie==null?void 0:Ie.width)||ot.width,(Ie==null?void 0:Ie.height)||ot.height),Ne.mirrored&&(rt.scale(-1,1),rt.translate(-ot.width,0))),ot},Ce.prototype.requestUserMedia=function(){var Ie=this,De=this.props,Be=function(Xe,Ye){var Qe={video:typeof Ye<"u"?Ye:!0};De.audio&&(Qe.audio=typeof Xe<"u"?Xe:!0),Ie.requestUserMediaId++;var rt=Ie.requestUserMediaId;navigator.mediaDevices.getUserMedia(Qe).then(function(ot){Ie.unmounted||rt!==Ie.requestUserMediaId?Ce.stopMediaStream(ot):Ie.handleUserMedia(null,ot)}).catch(function(ot){Ie.handleUserMedia(ot)})};if("mediaDevices"in navigator)Be(De.audioConstraints,De.videoConstraints);else{var Ne=function(Xe){return{optional:[{sourceId:Xe}]}},qe=function(Xe){var Ye=Xe.deviceId;return typeof Ye=="string"?Ye:Array.isArray(Ye)&&Ye.length>0?Ye[0]:typeof Ye=="object"&&Ye.ideal?Ye.ideal:null};MediaStreamTrack.getSources(function(Xe){var Ye=null,Qe=null;Xe.forEach(function(ct){ct.kind==="audio"?Ye=ct.id:ct.kind==="video"&&(Qe=ct.id)});var rt=qe(De.audioConstraints);rt&&(Ye=rt);var ot=qe(De.videoConstraints);ot&&(Qe=ot),Be(Ne(Ye),Ne(Qe))})}},Ce.prototype.handleUserMedia=function(Ie,De){var Be=this.props;if(Ie||!De){this.setState({hasUserMedia:!1}),Be.onUserMediaError(Ie);return}this.stream=De;try{this.video&&(this.video.srcObject=De),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(De)})}Be.onUserMedia(De)},Ce.prototype.render=function(){var Ie=this,De=this,Be=De.state,Ne=De.props,qe=Ne.audio;Ne.forceScreenshotSourceSize;var Xe=Ne.disablePictureInPicture;Ne.onUserMedia,Ne.onUserMediaError,Ne.screenshotFormat,Ne.screenshotQuality,Ne.minScreenshotWidth,Ne.minScreenshotHeight,Ne.audioConstraints,Ne.videoConstraints,Ne.imageSmoothing;var Ye=Ne.mirrored,Qe=Ne.style,rt=Qe===void 0?{}:Qe,ot=Ne.children,ct=fe(Ne,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),mt=Ye?le(le({},rt),{transform:(rt.transform||"")+" scaleX(-1)"}):rt,_t={getScreenshot:this.getScreenshot.bind(this)};return ae.createElement(ae.Fragment,null,ae.createElement("video",le({autoPlay:!0,disablePictureInPicture:Xe,src:Be.src,muted:!qe,playsInline:!0,ref:function(Lt){Ie.video=Lt},style:mt},ct)),ot&&ot(_t))},Ce.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},Ce}(ae.Component);ee.default=Se},react:function($,ee){$.exports=b}}).default})}(reactWebcam$1)),reactWebcam$1.exports}requireReactWebcam();const yts=""+new URL("ytshopping-BZXPZTN2.png",import.meta.url).href,capture=""+new URL("clickBtn-DeSTx9Wq.png",import.meta.url).href,back=""+new URL("backBtn-CnNRIIT8.png",import.meta.url).href,appWrapper="_appWrapper_1egqn_1",qrBox="_qrBox_1egqn_7",topLeft$1="_topLeft_1egqn_13",resultWrapper="_resultWrapper_1egqn_78",resultImg="_resultImg_1egqn_86",leftAbs$1="_leftAbs_1egqn_91",rightAbs$1="_rightAbs_1egqn_92",retake="_retake_1egqn_95",actions="_actions_1egqn_113",styles$2={appWrapper,qrBox,topLeft:topLeft$1,resultWrapper,resultImg,leftAbs:leftAbs$1,rightAbs:rightAbs$1,retake,actions},bagRight=""+new URL("bagRight-BDgHnFuS.png",import.meta.url).href,entryPage="_entryPage_19v78_1",content="_content_19v78_11",headline="_headline_19v78_18",tagline="_tagline_19v78_26",leftAbs="_leftAbs_19v78_29",rightAbs="_rightAbs_19v78_30",styles$1={entryPage,content,headline,tagline,leftAbs,rightAbs},ytLogo=""+new URL("ytLogo-DDxpBXig.png",import.meta.url).href,start$1=""+new URL("start-C3V2VgPH.png",import.meta.url).href,membership=""+new URL("membership-BzkQ9aWx.png",import.meta.url).href,bag=""+new URL("bag-DJXCQPYb.png",import.meta.url).href;function Entry({setCurrentState:H}){return React.createElement("div",{className:styles$1.entryPage},React.createElement("div",{className:styles$1.content,style:{maxWidth:pixelsToVW(803)}},React.createElement("div",{className:styles$1.mainLogo,style:{width:pixelsToVW(803)}},React.createElement("img",{src:ytLogo,alt:"atsa"})),React.createElement("div",{className:styles$1.text},React.createElement("div",{className:styles$1.headline,style:{fontSize:pixelsToVH(70)}},"LIKE IT. STYLE IT. OWN IT.",React.createElement("div",{className:styles$1.leftAbs,style:{width:pixelsToVW(88.5),height:"auto",top:pixelsToVH(-130),left:pixelsToVW(-60)}},React.createElement("img",{src:membership,alt:"membership"})),React.createElement("div",{className:styles$1.rightAbs,style:{width:pixelsToVW(161.3),height:"auto",top:pixelsToVH(-160),right:pixelsToVW(-60)}},React.createElement("img",{src:bag,alt:"bag"}))),React.createElement("div",{className:styles$1.tagline,style:{fontSize:pixelsToVH(47),marginTop:pixelsToVH(50)}},"Level up your look with YouTube AR Try-On!")),React.createElement("div",{className:styles$1.action,style:{width:pixelsToVW(590),height:"auto",fontSize:pixelsToVH(31),position:"relative",zIndex:50}},"Click here to start the experience.",React.createElement("img",{src:start$1,alt:"start",onClick:()=>H(1)}))))}const happy=""+new URL("happy-B35AesBk.png",import.meta.url).href,confirm=""+new URL("confirm-DKx8aWWQ.png",import.meta.url).href,home=""+new URL("home-CRieSzQS.png",import.meta.url).href,scanme=""+new URL("scanme-LrtccXU1.png",import.meta.url).href,v$1="4.5.6",fr=29.9700012207031,ip=0,op=62.0000025253118,w$1=400,h$2=400,ddd=0,assets=[],layers=[{ddd:0,ind:0,ty:3,nm:"Null 1",ks:{o:{a:0,k:0},r:{a:0,k:0},p:{a:0,k:[212.949,197.563,0]},a:{a:0,k:[50.687,51.173,0]},s:{a:1,k:[{i:{x:[.667,.667,.667],y:[1,1,.667]},o:{x:[.333,.333,.333],y:[0,0,.333]},n:["0p667_1_0p333_0","0p667_1_0p333_0","0p667_0p667_0p333_0p333"],t:0,s:[100,100,100],e:[132,132,100]},{i:{x:[.667,.667,.667],y:[1,1,.667]},o:{x:[.333,.333,.333],y:[0,0,.333]},n:["0p667_1_0p333_0","0p667_1_0p333_0","0p667_0p667_0p333_0p333"],t:30,s:[132,132,100],e:[100,100,100]},{t:60.0000024438501}]}},ao:0,ip:0,op:900.000036657751,st:0,bm:0,sr:1},{ddd:0,ind:1,ty:4,nm:"Shape Layer 1",parent:0,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[50.687,49.508,0]},a:{a:0,k:[9.781,0,0]},s:{a:1,k:[{i:{x:[.667,.667,.667],y:[1,1,.667]},o:{x:[.333,.333,.333],y:[0,0,.333]},n:["0p667_1_0p333_0","0p667_1_0p333_0","0p667_0p667_0p333_0p333"],t:0,s:[84.211,84.211,100],e:[106.211,106.211,100]},{i:{x:[.667,.667,.667],y:[1,1,.667]},o:{x:[.333,.333,.333],y:[0,0,.333]},n:["0p667_1_0p333_0","0p667_1_0p333_0","0p667_0p667_0p333_0p333"],t:31,s:[106.211,106.211,100],e:[84.211,84.211,100]},{t:61.0000024845809}]}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,-1],[0,0]],o:[[0,0],[0,1],[0,0]],v:[[-130.031,-96.688],[-131,3],[-44.188,-47.25]],c:!0}},nm:"Path 1",mn:"ADBE Vector Shape - Group"},{ty:"st",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},w:{a:0,k:0},lc:1,lj:1,ml:4,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},nm:"Fill 1",mn:"ADBE Vector Graphic - Fill"},{ty:"tr",p:{a:0,k:[8.313,3.688],ix:2},a:{a:0,k:[-89.062,-45.125],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Shape 1",np:3,mn:"ADBE Vector Group"}],ip:0,op:900.000036657751,st:0,bm:0,sr:1},{ddd:0,ind:2,ty:4,nm:"base",parent:0,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[33.738,51.61,0]},a:{a:0,k:[0,0,0]},s:{a:0,k:[77.945,77.945,100]}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[331.855,331.855]},p:{a:0,k:[0,0]},nm:"Ellipse Path 1",mn:"ADBE Vector Shape - Ellipse"},{ty:"st",c:{a:0,k:[0,0,0,1]},o:{a:0,k:100},w:{a:0,k:0},lc:1,lj:1,ml:4,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke"},{ty:"fl",c:{a:0,k:[.961,.173,0,1]},o:{a:0,k:100},nm:"Fill 1",mn:"ADBE Vector Graphic - Fill"},{ty:"tr",p:{a:0,k:[11.178,-2.697],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[75.704,75.704],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Ellipse 1",np:3,mn:"ADBE Vector Group"}],ip:0,op:900.000036657751,st:0,bm:0,sr:1},{ddd:0,ind:3,ty:4,nm:"base 2",parent:0,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[31.738,51.61,0]},a:{a:0,k:[0,0,0]},s:{a:0,k:[94.312,94.312,100]}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[331.855,331.855]},p:{a:0,k:[0,0]},nm:"Ellipse Path 1",mn:"ADBE Vector Shape - Ellipse"},{ty:"st",c:{a:0,k:[0,0,0,1]},o:{a:0,k:100},w:{a:0,k:0},lc:1,lj:1,ml:4,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},nm:"Fill 1",mn:"ADBE Vector Graphic - Fill"},{ty:"tr",p:{a:0,k:[11.178,-2.697],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[75.704,75.704],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Ellipse 1",np:3,mn:"ADBE Vector Group"}],ip:0,op:900.000036657751,st:0,bm:0,sr:1},{ddd:0,ind:4,ty:4,nm:"Base Layer 4",parent:0,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:20,s:[49],e:[0]},{t:45.0000018328876}]},r:{a:0,k:0},p:{a:0,k:[33.738,51.61,0]},a:{a:0,k:[0,0,0]},s:{a:1,k:[{i:{x:[.833,.833,.833],y:[.833,.833,.833]},o:{x:[.167,.167,.167],y:[.167,.167,.167]},n:["0p833_0p833_0p167_0p167","0p833_0p833_0p167_0p167","0p833_0p833_0p167_0p167"],t:0,s:[31.532,31.532,100],e:[69.368,69.368,100]},{i:{x:[.833,.833,.833],y:[.833,.833,.833]},o:{x:[.167,.167,.167],y:[.167,.167,.167]},n:["0p833_0p833_0p167_0p167","0p833_0p833_0p167_0p167","0p833_0p833_0p167_0p167"],t:20,s:[69.368,69.368,100],e:[84.882,84.882,100]},{t:45.0000018328876}]}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[331.855,331.855]},p:{a:0,k:[0,0]},nm:"Ellipse Path 1",mn:"ADBE Vector Shape - Ellipse"},{ty:"st",c:{a:0,k:[0,0,0,1]},o:{a:0,k:100},w:{a:0,k:0},lc:1,lj:1,ml:4,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke"},{ty:"fl",c:{a:0,k:[.961,.173,0,1]},o:{a:0,k:100},nm:"Fill 1",mn:"ADBE Vector Graphic - Fill"},{ty:"tr",p:{a:0,k:[11.178,-2.697],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[97.195,97.195],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Ellipse 1",np:3,mn:"ADBE Vector Group"}],ip:0,op:900.000036657751,st:0,bm:0,sr:1},{ddd:0,ind:5,ty:4,nm:"Base Layer 3",parent:0,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:34,s:[27],e:[0]},{t:59.0000024031193}]},r:{a:0,k:0},p:{a:0,k:[33.738,51.61,0]},a:{a:0,k:[0,0,0]},s:{a:1,k:[{i:{x:[.833,.833,.833],y:[.833,.833,.833]},o:{x:[.167,.167,.167],y:[.167,.167,.167]},n:["0p833_0p833_0p167_0p167","0p833_0p833_0p167_0p167","0p833_0p833_0p167_0p167"],t:14,s:[31.532,31.532,100],e:[69.368,69.368,100]},{i:{x:[.833,.833,.833],y:[.833,.833,.833]},o:{x:[.167,.167,.167],y:[.167,.167,.167]},n:["0p833_0p833_0p167_0p167","0p833_0p833_0p167_0p167","0p833_0p833_0p167_0p167"],t:34,s:[69.368,69.368,100],e:[84.882,84.882,100]},{t:59.0000024031193}]}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[331.855,331.855]},p:{a:0,k:[0,0]},nm:"Ellipse Path 1",mn:"ADBE Vector Shape - Ellipse"},{ty:"st",c:{a:0,k:[0,0,0,1]},o:{a:0,k:100},w:{a:0,k:0},lc:1,lj:1,ml:4,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke"},{ty:"fl",c:{a:0,k:[.961,.173,0,1]},o:{a:0,k:100},nm:"Fill 1",mn:"ADBE Vector Graphic - Fill"},{ty:"tr",p:{a:0,k:[11.178,-2.697],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[97.195,97.195],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Ellipse 1",np:3,mn:"ADBE Vector Group"}],ip:0,op:900.000036657751,st:0,bm:0,sr:1}],play={v:v$1,fr,ip,op,w:w$1,h:h$2,ddd,assets,layers};var lottie$2={exports:{}},lottie$1=lottie$2.exports,hasRequiredLottie;function requireLottie(){return hasRequiredLottie||(hasRequiredLottie=1,function(module,exports){typeof document<"u"&&typeof navigator<"u"&&function(H,_){module.exports=_()}(lottie$1,function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(_){_useWebWorker=!!_},getWebWorker=function(){return _useWebWorker},setLocationHref=function(_){locationHref=_},getLocationHref=function(){return locationHref};function createTag(H){return document.createElement(H)}function extendPrototype(H,_){var b,$=H.length,ee;for(b=0;b<$;b+=1){ee=H[b].prototype;for(var re in ee)Object.prototype.hasOwnProperty.call(ee,re)&&(_.prototype[re]=ee[re])}}function getDescriptor(H,_){return Object.getOwnPropertyDescriptor(H,_)}function createProxyFunction(H){function _(){}return _.prototype=H,_}var audioControllerFactory=function(){function H(_){this.audios=[],this.audioFactory=_,this._volume=1,this._isMuted=!1}return H.prototype={addAudio:function(b){this.audios.push(b)},pause:function(){var b,$=this.audios.length;for(b=0;b<$;b+=1)this.audios[b].pause()},resume:function(){var b,$=this.audios.length;for(b=0;b<$;b+=1)this.audios[b].resume()},setRate:function(b){var $,ee=this.audios.length;for($=0;$<ee;$+=1)this.audios[$].setRate(b)},createAudio:function(b){return this.audioFactory?this.audioFactory(b):window.Howl?new window.Howl({src:[b]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(b){this.audioFactory=b},setVolume:function(b){this._volume=b,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var b,$=this.audios.length;for(b=0;b<$;b+=1)this.audios[b].volume(this._volume*(this._isMuted?0:1))}},function(){return new H}}(),createTypedArray=function(){function H(b,$){var ee=0,re=[],ae;switch(b){case"int16":case"uint8c":ae=1;break;default:ae=1.1;break}for(ee=0;ee<$;ee+=1)re.push(ae);return re}function _(b,$){return b==="float32"?new Float32Array($):b==="int16"?new Int16Array($):b==="uint8c"?new Uint8ClampedArray($):H(b,$)}return typeof Uint8ClampedArray=="function"&&typeof Float32Array=="function"?_:H}();function createSizedArray(H){return Array.apply(null,{length:H})}function _typeof$6(H){"@babel/helpers - typeof";return _typeof$6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},_typeof$6(H)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};(function(){var H=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],_,b=H.length;for(_=0;_<b;_+=1)BMMath[H[_]]=Math[H[_]]})(),BMMath.random=Math.random,BMMath.abs=function(H){var _=_typeof$6(H);if(_==="object"&&H.length){var b=createSizedArray(H.length),$,ee=H.length;for($=0;$<ee;$+=1)b[$]=Math.abs(H[$]);return b}return Math.abs(H)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function styleDiv(H){H.style.position="absolute",H.style.top=0,H.style.left=0,H.style.display="block",H.style.transformOrigin="0 0",H.style.webkitTransformOrigin="0 0",H.style.backfaceVisibility="visible",H.style.webkitBackfaceVisibility="visible",H.style.transformStyle="preserve-3d",H.style.webkitTransformStyle="preserve-3d",H.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(H,_,b,$){this.type=H,this.currentTime=_,this.totalTime=b,this.direction=$<0?-1:1}function BMCompleteEvent(H,_){this.type=H,this.direction=_<0?-1:1}function BMCompleteLoopEvent(H,_,b,$){this.type=H,this.currentLoop=b,this.totalLoops=_,this.direction=$<0?-1:1}function BMSegmentStartEvent(H,_,b){this.type=H,this.firstFrame=_,this.totalFrames=b}function BMDestroyEvent(H,_){this.type=H,this.target=_}function BMRenderFrameErrorEvent(H,_){this.type="renderFrameError",this.nativeError=H,this.currentTime=_}function BMConfigErrorEvent(H){this.type="configError",this.nativeError=H}var createElementID=function(){var H=0;return function(){return H+=1,idPrefix$1+"__lottie_element_"+H}}();function HSVtoRGB(H,_,b){var $,ee,re,ae,xe,le,fe,ve;switch(ae=Math.floor(H*6),xe=H*6-ae,le=b*(1-_),fe=b*(1-xe*_),ve=b*(1-(1-xe)*_),ae%6){case 0:$=b,ee=ve,re=le;break;case 1:$=fe,ee=b,re=le;break;case 2:$=le,ee=b,re=ve;break;case 3:$=le,ee=fe,re=b;break;case 4:$=ve,ee=le,re=b;break;case 5:$=b,ee=le,re=fe;break}return[$,ee,re]}function RGBtoHSV(H,_,b){var $=Math.max(H,_,b),ee=Math.min(H,_,b),re=$-ee,ae,xe=$===0?0:re/$,le=$/255;switch($){case ee:ae=0;break;case H:ae=_-b+re*(_<b?6:0),ae/=6*re;break;case _:ae=b-H+re*2,ae/=6*re;break;case b:ae=H-_+re*4,ae/=6*re;break}return[ae,xe,le]}function addSaturationToRGB(H,_){var b=RGBtoHSV(H[0]*255,H[1]*255,H[2]*255);return b[1]+=_,b[1]>1?b[1]=1:b[1]<=0&&(b[1]=0),HSVtoRGB(b[0],b[1],b[2])}function addBrightnessToRGB(H,_){var b=RGBtoHSV(H[0]*255,H[1]*255,H[2]*255);return b[2]+=_,b[2]>1?b[2]=1:b[2]<0&&(b[2]=0),HSVtoRGB(b[0],b[1],b[2])}function addHueToRGB(H,_){var b=RGBtoHSV(H[0]*255,H[1]*255,H[2]*255);return b[0]+=_/360,b[0]>1?b[0]-=1:b[0]<0&&(b[0]+=1),HSVtoRGB(b[0],b[1],b[2])}var rgbToHex=function(){var H=[],_,b;for(_=0;_<256;_+=1)b=_.toString(16),H[_]=b.length===1?"0"+b:b;return function($,ee,re){return $<0&&($=0),ee<0&&(ee=0),re<0&&(re=0),"#"+H[$]+H[ee]+H[re]}}(),setSubframeEnabled=function(_){subframeEnabled=!!_},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(_){expressionsPlugin=_},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(_){expressionsInterfaces=_},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(_){defaultCurveSegments=_},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(_){idPrefix$1=_};function createNS(H){return document.createElementNS(svgNS,H)}function _typeof$5(H){"@babel/helpers - typeof";return _typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},_typeof$5(H)}var dataManager=function(){var H=1,_=[],b,$,ee={onmessage:function(){},postMessage:function(Ce){b({data:Ce})}},re={postMessage:function(Ce){ee.onmessage({data:Ce})}};function ae(Ee){if(window.Worker&&window.Blob&&getWebWorker()){var Ce=new Blob(["var _workerSelf = self; self.onmessage = ",Ee.toString()],{type:"text/javascript"}),Ie=URL.createObjectURL(Ce);return new Worker(Ie)}return b=Ee,ee}function xe(){$||($=ae(function(Ce){function Ie(){function Be(Qt,vt){var It,gt,Tt=Qt.length,Ct,Ft,sn,cn;for(gt=0;gt<Tt;gt+=1)if(It=Qt[gt],"ks"in It&&!It.completed){if(It.completed=!0,It.hasMask){var en=It.masksProperties;for(Ft=en.length,Ct=0;Ct<Ft;Ct+=1)if(en[Ct].pt.k.i)Qe(en[Ct].pt.k);else for(cn=en[Ct].pt.k.length,sn=0;sn<cn;sn+=1)en[Ct].pt.k[sn].s&&Qe(en[Ct].pt.k[sn].s[0]),en[Ct].pt.k[sn].e&&Qe(en[Ct].pt.k[sn].e[0])}It.ty===0?(It.layers=Xe(It.refId,vt),Be(It.layers,vt)):It.ty===4?Ye(It.shapes):It.ty===5&&Gt(It)}}function Ne(Qt,vt){if(Qt){var It=0,gt=Qt.length;for(It=0;It<gt;It+=1)Qt[It].t===1&&(Qt[It].data.layers=Xe(Qt[It].data.refId,vt),Be(Qt[It].data.layers,vt))}}function qe(Qt,vt){for(var It=0,gt=vt.length;It<gt;){if(vt[It].id===Qt)return vt[It];It+=1}return null}function Xe(Qt,vt){var It=qe(Qt,vt);return It?It.layers.__used?JSON.parse(JSON.stringify(It.layers)):(It.layers.__used=!0,It.layers):null}function Ye(Qt){var vt,It=Qt.length,gt,Tt;for(vt=It-1;vt>=0;vt-=1)if(Qt[vt].ty==="sh")if(Qt[vt].ks.k.i)Qe(Qt[vt].ks.k);else for(Tt=Qt[vt].ks.k.length,gt=0;gt<Tt;gt+=1)Qt[vt].ks.k[gt].s&&Qe(Qt[vt].ks.k[gt].s[0]),Qt[vt].ks.k[gt].e&&Qe(Qt[vt].ks.k[gt].e[0]);else Qt[vt].ty==="gr"&&Ye(Qt[vt].it)}function Qe(Qt){var vt,It=Qt.i.length;for(vt=0;vt<It;vt+=1)Qt.i[vt][0]+=Qt.v[vt][0],Qt.i[vt][1]+=Qt.v[vt][1],Qt.o[vt][0]+=Qt.v[vt][0],Qt.o[vt][1]+=Qt.v[vt][1]}function rt(Qt,vt){var It=vt?vt.split("."):[100,100,100];return Qt[0]>It[0]?!0:It[0]>Qt[0]?!1:Qt[1]>It[1]?!0:It[1]>Qt[1]?!1:Qt[2]>It[2]?!0:It[2]>Qt[2]?!1:null}var ot=function(){var Qt=[4,4,14];function vt(gt){var Tt=gt.t.d;gt.t.d={k:[{s:Tt,t:0}]}}function It(gt){var Tt,Ct=gt.length;for(Tt=0;Tt<Ct;Tt+=1)gt[Tt].ty===5&&vt(gt[Tt])}return function(gt){if(rt(Qt,gt.v)&&(It(gt.layers),gt.assets)){var Tt,Ct=gt.assets.length;for(Tt=0;Tt<Ct;Tt+=1)gt.assets[Tt].layers&&It(gt.assets[Tt].layers)}}}(),ct=function(){var Qt=[4,7,99];return function(vt){if(vt.chars&&!rt(Qt,vt.v)){var It,gt=vt.chars.length;for(It=0;It<gt;It+=1){var Tt=vt.chars[It];Tt.data&&Tt.data.shapes&&(Ye(Tt.data.shapes),Tt.data.ip=0,Tt.data.op=99999,Tt.data.st=0,Tt.data.sr=1,Tt.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},vt.chars[It].t||(Tt.data.shapes.push({ty:"no"}),Tt.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}}(),mt=function(){var Qt=[5,7,15];function vt(gt){var Tt=gt.t.p;typeof Tt.a=="number"&&(Tt.a={a:0,k:Tt.a}),typeof Tt.p=="number"&&(Tt.p={a:0,k:Tt.p}),typeof Tt.r=="number"&&(Tt.r={a:0,k:Tt.r})}function It(gt){var Tt,Ct=gt.length;for(Tt=0;Tt<Ct;Tt+=1)gt[Tt].ty===5&&vt(gt[Tt])}return function(gt){if(rt(Qt,gt.v)&&(It(gt.layers),gt.assets)){var Tt,Ct=gt.assets.length;for(Tt=0;Tt<Ct;Tt+=1)gt.assets[Tt].layers&&It(gt.assets[Tt].layers)}}}(),_t=function(){var Qt=[4,1,9];function vt(gt){var Tt,Ct=gt.length,Ft,sn;for(Tt=0;Tt<Ct;Tt+=1)if(gt[Tt].ty==="gr")vt(gt[Tt].it);else if(gt[Tt].ty==="fl"||gt[Tt].ty==="st")if(gt[Tt].c.k&&gt[Tt].c.k[0].i)for(sn=gt[Tt].c.k.length,Ft=0;Ft<sn;Ft+=1)gt[Tt].c.k[Ft].s&&(gt[Tt].c.k[Ft].s[0]/=255,gt[Tt].c.k[Ft].s[1]/=255,gt[Tt].c.k[Ft].s[2]/=255,gt[Tt].c.k[Ft].s[3]/=255),gt[Tt].c.k[Ft].e&&(gt[Tt].c.k[Ft].e[0]/=255,gt[Tt].c.k[Ft].e[1]/=255,gt[Tt].c.k[Ft].e[2]/=255,gt[Tt].c.k[Ft].e[3]/=255);else gt[Tt].c.k[0]/=255,gt[Tt].c.k[1]/=255,gt[Tt].c.k[2]/=255,gt[Tt].c.k[3]/=255}function It(gt){var Tt,Ct=gt.length;for(Tt=0;Tt<Ct;Tt+=1)gt[Tt].ty===4&&vt(gt[Tt].shapes)}return function(gt){if(rt(Qt,gt.v)&&(It(gt.layers),gt.assets)){var Tt,Ct=gt.assets.length;for(Tt=0;Tt<Ct;Tt+=1)gt.assets[Tt].layers&&It(gt.assets[Tt].layers)}}}(),Lt=function(){var Qt=[4,4,18];function vt(gt){var Tt,Ct=gt.length,Ft,sn;for(Tt=Ct-1;Tt>=0;Tt-=1)if(gt[Tt].ty==="sh")if(gt[Tt].ks.k.i)gt[Tt].ks.k.c=gt[Tt].closed;else for(sn=gt[Tt].ks.k.length,Ft=0;Ft<sn;Ft+=1)gt[Tt].ks.k[Ft].s&&(gt[Tt].ks.k[Ft].s[0].c=gt[Tt].closed),gt[Tt].ks.k[Ft].e&&(gt[Tt].ks.k[Ft].e[0].c=gt[Tt].closed);else gt[Tt].ty==="gr"&&vt(gt[Tt].it)}function It(gt){var Tt,Ct,Ft=gt.length,sn,cn,en,yn;for(Ct=0;Ct<Ft;Ct+=1){if(Tt=gt[Ct],Tt.hasMask){var Pn=Tt.masksProperties;for(cn=Pn.length,sn=0;sn<cn;sn+=1)if(Pn[sn].pt.k.i)Pn[sn].pt.k.c=Pn[sn].cl;else for(yn=Pn[sn].pt.k.length,en=0;en<yn;en+=1)Pn[sn].pt.k[en].s&&(Pn[sn].pt.k[en].s[0].c=Pn[sn].cl),Pn[sn].pt.k[en].e&&(Pn[sn].pt.k[en].e[0].c=Pn[sn].cl)}Tt.ty===4&&vt(Tt.shapes)}}return function(gt){if(rt(Qt,gt.v)&&(It(gt.layers),gt.assets)){var Tt,Ct=gt.assets.length;for(Tt=0;Tt<Ct;Tt+=1)gt.assets[Tt].layers&&It(gt.assets[Tt].layers)}}}();function Vt(Qt){Qt.__complete||(_t(Qt),ot(Qt),ct(Qt),mt(Qt),Lt(Qt),Be(Qt.layers,Qt.assets),Ne(Qt.chars,Qt.assets),Qt.__complete=!0)}function Gt(Qt){Qt.t.a.length===0&&"m"in Qt.t.p}var $t={};return $t.completeData=Vt,$t.checkColors=_t,$t.checkChars=ct,$t.checkPathProperties=mt,$t.checkShapes=Lt,$t.completeLayers=Be,$t}if(re.dataManager||(re.dataManager=Ie()),re.assetLoader||(re.assetLoader=function(){function Be(qe){var Xe=qe.getResponseHeader("content-type");return Xe&&qe.responseType==="json"&&Xe.indexOf("json")!==-1||qe.response&&_typeof$5(qe.response)==="object"?qe.response:qe.response&&typeof qe.response=="string"?JSON.parse(qe.response):qe.responseText?JSON.parse(qe.responseText):null}function Ne(qe,Xe,Ye,Qe){var rt,ot=new XMLHttpRequest;try{ot.responseType="json"}catch{}ot.onreadystatechange=function(){if(ot.readyState===4)if(ot.status===200)rt=Be(ot),Ye(rt);else try{rt=Be(ot),Ye(rt)}catch(ct){Qe&&Qe(ct)}};try{ot.open(["G","E","T"].join(""),qe,!0)}catch{ot.open(["G","E","T"].join(""),Xe+"/"+qe,!0)}ot.send()}return{load:Ne}}()),Ce.data.type==="loadAnimation")re.assetLoader.load(Ce.data.path,Ce.data.fullPath,function(Be){re.dataManager.completeData(Be),re.postMessage({id:Ce.data.id,payload:Be,status:"success"})},function(){re.postMessage({id:Ce.data.id,status:"error"})});else if(Ce.data.type==="complete"){var De=Ce.data.animation;re.dataManager.completeData(De),re.postMessage({id:Ce.data.id,payload:De,status:"success"})}else Ce.data.type==="loadData"&&re.assetLoader.load(Ce.data.path,Ce.data.fullPath,function(Be){re.postMessage({id:Ce.data.id,payload:Be,status:"success"})},function(){re.postMessage({id:Ce.data.id,status:"error"})})}),$.onmessage=function(Ee){var Ce=Ee.data,Ie=Ce.id,De=_[Ie];_[Ie]=null,Ce.status==="success"?De.onComplete(Ce.payload):De.onError&&De.onError()})}function le(Ee,Ce){H+=1;var Ie="processId_"+H;return _[Ie]={onComplete:Ee,onError:Ce},Ie}function fe(Ee,Ce,Ie){xe();var De=le(Ce,Ie);$.postMessage({type:"loadAnimation",path:Ee,fullPath:window.location.origin+window.location.pathname,id:De})}function ve(Ee,Ce,Ie){xe();var De=le(Ce,Ie);$.postMessage({type:"loadData",path:Ee,fullPath:window.location.origin+window.location.pathname,id:De})}function Se(Ee,Ce,Ie){xe();var De=le(Ce,Ie);$.postMessage({type:"complete",animation:Ee,id:De})}return{loadAnimation:fe,loadData:ve,completeAnimation:Se}}(),ImagePreloader=function(){var H=function(){var Ne=createTag("canvas");Ne.width=1,Ne.height=1;var qe=Ne.getContext("2d");return qe.fillStyle="rgba(0,0,0,0)",qe.fillRect(0,0,1,1),Ne}();function _(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function b(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function $(Ne,qe,Xe){var Ye="";if(Ne.e)Ye=Ne.p;else if(qe){var Qe=Ne.p;Qe.indexOf("images/")!==-1&&(Qe=Qe.split("/")[1]),Ye=qe+Qe}else Ye=Xe,Ye+=Ne.u?Ne.u:"",Ye+=Ne.p;return Ye}function ee(Ne){var qe=0,Xe=setInterval((function(){var Ye=Ne.getBBox();(Ye.width||qe>500)&&(this._imageLoaded(),clearInterval(Xe)),qe+=1}).bind(this),50)}function re(Ne){var qe=$(Ne,this.assetsPath,this.path),Xe=createNS("image");isSafari?this.testImageLoaded(Xe):Xe.addEventListener("load",this._imageLoaded,!1),Xe.addEventListener("error",(function(){Ye.img=H,this._imageLoaded()}).bind(this),!1),Xe.setAttributeNS("http://www.w3.org/1999/xlink","href",qe),this._elementHelper.append?this._elementHelper.append(Xe):this._elementHelper.appendChild(Xe);var Ye={img:Xe,assetData:Ne};return Ye}function ae(Ne){var qe=$(Ne,this.assetsPath,this.path),Xe=createTag("img");Xe.crossOrigin="anonymous",Xe.addEventListener("load",this._imageLoaded,!1),Xe.addEventListener("error",(function(){Ye.img=H,this._imageLoaded()}).bind(this),!1),Xe.src=qe;var Ye={img:Xe,assetData:Ne};return Ye}function xe(Ne){var qe={assetData:Ne},Xe=$(Ne,this.assetsPath,this.path);return dataManager.loadData(Xe,(function(Ye){qe.img=Ye,this._footageLoaded()}).bind(this),(function(){qe.img={},this._footageLoaded()}).bind(this)),qe}function le(Ne,qe){this.imagesLoadedCb=qe;var Xe,Ye=Ne.length;for(Xe=0;Xe<Ye;Xe+=1)Ne[Xe].layers||(!Ne[Xe].t||Ne[Xe].t==="seq"?(this.totalImages+=1,this.images.push(this._createImageData(Ne[Xe]))):Ne[Xe].t===3&&(this.totalFootages+=1,this.images.push(this.createFootageData(Ne[Xe]))))}function fe(Ne){this.path=Ne||""}function ve(Ne){this.assetsPath=Ne||""}function Se(Ne){for(var qe=0,Xe=this.images.length;qe<Xe;){if(this.images[qe].assetData===Ne)return this.images[qe].img;qe+=1}return null}function Ee(){this.imagesLoadedCb=null,this.images.length=0}function Ce(){return this.totalImages===this.loadedAssets}function Ie(){return this.totalFootages===this.loadedFootagesCount}function De(Ne,qe){Ne==="svg"?(this._elementHelper=qe,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}function Be(){this._imageLoaded=_.bind(this),this._footageLoaded=b.bind(this),this.testImageLoaded=ee.bind(this),this.createFootageData=xe.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return Be.prototype={loadAssets:le,setAssetsPath:ve,setPath:fe,loadedImages:Ce,loadedFootages:Ie,destroy:Ee,getAsset:Se,createImgData:ae,createImageData:re,imageLoaded:_,footageLoaded:b,setCacheType:De},Be}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(_,b){if(this._cbs[_])for(var $=this._cbs[_],ee=0;ee<$.length;ee+=1)$[ee](b)},addEventListener:function(_,b){return this._cbs[_]||(this._cbs[_]=[]),this._cbs[_].push(b),(function(){this.removeEventListener(_,b)}).bind(this)},removeEventListener:function(_,b){if(!b)this._cbs[_]=null;else if(this._cbs[_]){for(var $=0,ee=this._cbs[_].length;$<ee;)this._cbs[_][$]===b&&(this._cbs[_].splice($,1),$-=1,ee-=1),$+=1;this._cbs[_].length||(this._cbs[_]=null)}}};var markerParser=function(){function H(_){for(var b=_.split(`\r
`),$={},ee,re=0,ae=0;ae<b.length;ae+=1)ee=b[ae].split(":"),ee.length===2&&($[ee[0]]=ee[1].trim(),re+=1);if(re===0)throw new Error;return $}return function(_){for(var b=[],$=0;$<_.length;$+=1){var ee=_[$],re={time:ee.tm,duration:ee.dr};try{re.payload=JSON.parse(_[$].cm)}catch{try{re.payload=H(_[$].cm)}catch{re.payload={name:_[$].cm}}}b.push(re)}return b}}(),ProjectInterface=function(){function H(_){this.compositions.push(_)}return function(){function _(b){for(var $=0,ee=this.compositions.length;$<ee;){if(this.compositions[$].data&&this.compositions[$].data.nm===b)return this.compositions[$].prepareFrame&&this.compositions[$].data.xt&&this.compositions[$].prepareFrame(this.currentFrame),this.compositions[$].compInterface;$+=1}return null}return _.compositions=[],_.currentFrame=0,_.registerComposition=H,_}}(),renderers={},registerRenderer=function(_,b){renderers[_]=b};function getRenderer(H){return renderers[H]}function getRegisteredRenderer(){if(renderers.canvas)return"canvas";for(var H in renderers)if(renderers[H])return H;return""}function _typeof$4(H){"@babel/helpers - typeof";return _typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},_typeof$4(H)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0),this.expressionsPlugin=getExpressionsPlugin()};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(H){(H.wrapper||H.container)&&(this.wrapper=H.wrapper||H.container);var _="svg";H.animType?_=H.animType:H.renderer&&(_=H.renderer);var b=getRenderer(_);this.renderer=new b(this,H.rendererSettings),this.imagePreloader.setCacheType(_,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=_,H.loop===""||H.loop===null||H.loop===void 0||H.loop===!0?this.loop=!0:H.loop===!1?this.loop=!1:this.loop=parseInt(H.loop,10),this.autoplay="autoplay"in H?H.autoplay:!0,this.name=H.name?H.name:"",this.autoloadSegments=Object.prototype.hasOwnProperty.call(H,"autoloadSegments")?H.autoloadSegments:!0,this.assetsPath=H.assetsPath,this.initialSegment=H.initialSegment,H.audioFactory&&this.audioController.setAudioFactory(H.audioFactory),H.animationData?this.setupAnimation(H.animationData):H.path&&(H.path.lastIndexOf("\\")!==-1?this.path=H.path.substr(0,H.path.lastIndexOf("\\")+1):this.path=H.path.substr(0,H.path.lastIndexOf("/")+1),this.fileName=H.path.substr(H.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(H.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(H){dataManager.completeAnimation(H,this.configAnimation)},AnimationItem.prototype.setData=function(H,_){_&&_typeof$4(_)!=="object"&&(_=JSON.parse(_));var b={wrapper:H,animationData:_},$=H.attributes;b.path=$.getNamedItem("data-animation-path")?$.getNamedItem("data-animation-path").value:$.getNamedItem("data-bm-path")?$.getNamedItem("data-bm-path").value:$.getNamedItem("bm-path")?$.getNamedItem("bm-path").value:"",b.animType=$.getNamedItem("data-anim-type")?$.getNamedItem("data-anim-type").value:$.getNamedItem("data-bm-type")?$.getNamedItem("data-bm-type").value:$.getNamedItem("bm-type")?$.getNamedItem("bm-type").value:$.getNamedItem("data-bm-renderer")?$.getNamedItem("data-bm-renderer").value:$.getNamedItem("bm-renderer")?$.getNamedItem("bm-renderer").value:getRegisteredRenderer()||"canvas";var ee=$.getNamedItem("data-anim-loop")?$.getNamedItem("data-anim-loop").value:$.getNamedItem("data-bm-loop")?$.getNamedItem("data-bm-loop").value:$.getNamedItem("bm-loop")?$.getNamedItem("bm-loop").value:"";ee==="false"?b.loop=!1:ee==="true"?b.loop=!0:ee!==""&&(b.loop=parseInt(ee,10));var re=$.getNamedItem("data-anim-autoplay")?$.getNamedItem("data-anim-autoplay").value:$.getNamedItem("data-bm-autoplay")?$.getNamedItem("data-bm-autoplay").value:$.getNamedItem("bm-autoplay")?$.getNamedItem("bm-autoplay").value:!0;b.autoplay=re!=="false",b.name=$.getNamedItem("data-name")?$.getNamedItem("data-name").value:$.getNamedItem("data-bm-name")?$.getNamedItem("data-bm-name").value:$.getNamedItem("bm-name")?$.getNamedItem("bm-name").value:"";var ae=$.getNamedItem("data-anim-prerender")?$.getNamedItem("data-anim-prerender").value:$.getNamedItem("data-bm-prerender")?$.getNamedItem("data-bm-prerender").value:$.getNamedItem("bm-prerender")?$.getNamedItem("bm-prerender").value:"";ae==="false"&&(b.prerender=!1),b.path?this.setParams(b):this.trigger("destroy")},AnimationItem.prototype.includeLayers=function(H){H.op>this.animationData.op&&(this.animationData.op=H.op,this.totalFrames=Math.floor(H.op-this.animationData.ip));var _=this.animationData.layers,b,$=_.length,ee=H.layers,re,ae=ee.length;for(re=0;re<ae;re+=1)for(b=0;b<$;){if(_[b].id===ee[re].id){_[b]=ee[re];break}b+=1}if((H.chars||H.fonts)&&(this.renderer.globalData.fontManager.addChars(H.chars),this.renderer.globalData.fontManager.addFonts(H.fonts,this.renderer.globalData.defs)),H.assets)for($=H.assets.length,b=0;b<$;b+=1)this.animationData.assets.push(H.assets[b]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(H){this.animationData=H;var _=getExpressionsPlugin();_&&_.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var H=this.animationData.segments;if(!H||H.length===0||!this.autoloadSegments){this.trigger("data_ready"),this.timeCompleted=this.totalFrames;return}var _=H.shift();this.timeCompleted=_.time*this.frameRate;var b=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(b,this.includeLayers.bind(this),(function(){this.trigger("data_failed")}).bind(this))},AnimationItem.prototype.loadSegments=function(){var H=this.animationData.segments;H||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(H){if(this.renderer)try{this.animationData=H,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(H),H.assets||(H.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(H.assets),this.markers=markerParser(H.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(_){this.triggerConfigError(_)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||this.renderer.rendererType!=="canvas")&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var H=getExpressionsPlugin();H&&H.initExpressions(this),this.renderer.initItems(),setTimeout((function(){this.trigger("DOMLoaded")}).bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(H,_){var b=typeof H=="number"?H:void 0,$=typeof _=="number"?_:void 0;this.renderer.updateContainerSize(b,$)},AnimationItem.prototype.setSubframe=function(H){this.isSubframeEnabled=!!H},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!(this.isLoaded===!1||!this.renderer))try{this.expressionsPlugin&&this.expressionsPlugin.resetFrame(),this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(H){this.triggerRenderFrameError(H)}},AnimationItem.prototype.play=function(H){H&&this.name!==H||this.isPaused===!0&&(this.isPaused=!1,this.trigger("_play"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(H){H&&this.name!==H||this.isPaused===!1&&(this.isPaused=!0,this.trigger("_pause"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(H){H&&this.name!==H||(this.isPaused===!0?this.play():this.pause())},AnimationItem.prototype.stop=function(H){H&&this.name!==H||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(H){for(var _,b=0;b<this.markers.length;b+=1)if(_=this.markers[b],_.payload&&_.payload.name===H)return _;return null},AnimationItem.prototype.goToAndStop=function(H,_,b){if(!(b&&this.name!==b)){var $=Number(H);if(isNaN($)){var ee=this.getMarkerData(H);ee&&this.goToAndStop(ee.time,!0)}else _?this.setCurrentRawFrameValue(H):this.setCurrentRawFrameValue(H*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(H,_,b){if(!(b&&this.name!==b)){var $=Number(H);if(isNaN($)){var ee=this.getMarkerData(H);ee&&(ee.duration?this.playSegments([ee.time,ee.time+ee.duration],!0):this.goToAndStop(ee.time,!0))}else this.goToAndStop($,_,b);this.play()}},AnimationItem.prototype.advanceTime=function(H){if(!(this.isPaused===!0||this.isLoaded===!1)){var _=this.currentRawFrame+H*this.frameModifier,b=!1;_>=this.totalFrames-1&&this.frameModifier>0?!this.loop||this.playCount===this.loop?this.checkSegments(_>this.totalFrames?_%this.totalFrames:0)||(b=!0,_=this.totalFrames-1):_>=this.totalFrames?(this.playCount+=1,this.checkSegments(_%this.totalFrames)||(this.setCurrentRawFrameValue(_%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(_):_<0?this.checkSegments(_%this.totalFrames)||(this.loop&&!(this.playCount--<=0&&this.loop!==!0)?(this.setCurrentRawFrameValue(this.totalFrames+_%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0):(b=!0,_=0)):this.setCurrentRawFrameValue(_),b&&(this.setCurrentRawFrameValue(_),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(H,_){this.playCount=0,H[1]<H[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=H[0]-H[1],this.timeCompleted=this.totalFrames,this.firstFrame=H[1],this.setCurrentRawFrameValue(this.totalFrames-.001-_)):H[1]>H[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=H[1]-H[0],this.timeCompleted=this.totalFrames,this.firstFrame=H[0],this.setCurrentRawFrameValue(.001+_)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(H,_){var b=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<H?b=H:this.currentRawFrame+this.firstFrame>_&&(b=_-H)),this.firstFrame=H,this.totalFrames=_-H,this.timeCompleted=this.totalFrames,b!==-1&&this.goToAndStop(b,!0)},AnimationItem.prototype.playSegments=function(H,_){if(_&&(this.segments.length=0),_typeof$4(H[0])==="object"){var b,$=H.length;for(b=0;b<$;b+=1)this.segments.push(H[b])}else this.segments.push(H);this.segments.length&&_&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(H){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),H&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(H){return this.segments.length?(this.adjustSegment(this.segments.shift(),H),!0):!1},AnimationItem.prototype.destroy=function(H){H&&this.name!==H||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.expressionsPlugin=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(H){this.currentRawFrame=H,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(H){this.playSpeed=H,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(H){this.playDirection=H<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setLoop=function(H){this.loop=H},AnimationItem.prototype.setVolume=function(H,_){_&&this.name!==_||this.audioController.setVolume(H)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(H){H&&this.name!==H||this.audioController.mute()},AnimationItem.prototype.unmute=function(H){H&&this.name!==H||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(H){var _="";if(H.e)_=H.p;else if(this.assetsPath){var b=H.p;b.indexOf("images/")!==-1&&(b=b.split("/")[1]),_=this.assetsPath+b}else _=this.path,_+=H.u?H.u:"",_+=H.p;return _},AnimationItem.prototype.getAssetData=function(H){for(var _=0,b=this.assets.length;_<b;){if(H===this.assets[_].id)return this.assets[_];_+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(H){return H?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(H,_,b){try{var $=this.renderer.getElementByPath(H);$.updateDocumentData(_,b)}catch{}},AnimationItem.prototype.trigger=function(H){if(this._cbs&&this._cbs[H])switch(H){case"enterFrame":this.triggerEvent(H,new BMEnterFrameEvent(H,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(H,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(H,new BMCompleteLoopEvent(H,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(H,new BMCompleteEvent(H,this.frameMult));break;case"segmentStart":this.triggerEvent(H,new BMSegmentStartEvent(H,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(H,new BMDestroyEvent(H,this));break;default:this.triggerEvent(H)}H==="enterFrame"&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(H,this.currentFrame,this.totalFrames,this.frameMult)),H==="loopComplete"&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(H,this.loop,this.playCount,this.frameMult)),H==="complete"&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(H,this.frameMult)),H==="segmentStart"&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(H,this.firstFrame,this.totalFrames)),H==="destroy"&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(H,this))},AnimationItem.prototype.triggerRenderFrameError=function(H){var _=new BMRenderFrameErrorEvent(H,this.currentFrame);this.triggerEvent("error",_),this.onError&&this.onError.call(this,_)},AnimationItem.prototype.triggerConfigError=function(H){var _=new BMConfigErrorEvent(H,this.currentFrame);this.triggerEvent("error",_),this.onError&&this.onError.call(this,_)};var animationManager=function(){var H={},_=[],b=0,$=0,ee=0,re=!0,ae=!1;function xe(vt){for(var It=0,gt=vt.target;It<$;)_[It].animation===gt&&(_.splice(It,1),It-=1,$-=1,gt.isPaused||Se()),It+=1}function le(vt,It){if(!vt)return null;for(var gt=0;gt<$;){if(_[gt].elem===vt&&_[gt].elem!==null)return _[gt].animation;gt+=1}var Tt=new AnimationItem;return Ee(Tt,vt),Tt.setData(vt,It),Tt}function fe(){var vt,It=_.length,gt=[];for(vt=0;vt<It;vt+=1)gt.push(_[vt].animation);return gt}function ve(){ee+=1,_t()}function Se(){ee-=1}function Ee(vt,It){vt.addEventListener("destroy",xe),vt.addEventListener("_active",ve),vt.addEventListener("_idle",Se),_.push({elem:It,animation:vt}),$+=1}function Ce(vt){var It=new AnimationItem;return Ee(It,null),It.setParams(vt),It}function Ie(vt,It){var gt;for(gt=0;gt<$;gt+=1)_[gt].animation.setSpeed(vt,It)}function De(vt,It){var gt;for(gt=0;gt<$;gt+=1)_[gt].animation.setDirection(vt,It)}function Be(vt){var It;for(It=0;It<$;It+=1)_[It].animation.play(vt)}function Ne(vt){var It=vt-b,gt;for(gt=0;gt<$;gt+=1)_[gt].animation.advanceTime(It);b=vt,ee&&!ae?window.requestAnimationFrame(Ne):re=!0}function qe(vt){b=vt,window.requestAnimationFrame(Ne)}function Xe(vt){var It;for(It=0;It<$;It+=1)_[It].animation.pause(vt)}function Ye(vt,It,gt){var Tt;for(Tt=0;Tt<$;Tt+=1)_[Tt].animation.goToAndStop(vt,It,gt)}function Qe(vt){var It;for(It=0;It<$;It+=1)_[It].animation.stop(vt)}function rt(vt){var It;for(It=0;It<$;It+=1)_[It].animation.togglePause(vt)}function ot(vt){var It;for(It=$-1;It>=0;It-=1)_[It].animation.destroy(vt)}function ct(vt,It,gt){var Tt=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),Ct,Ft=Tt.length;for(Ct=0;Ct<Ft;Ct+=1)gt&&Tt[Ct].setAttribute("data-bm-type",gt),le(Tt[Ct],vt);if(It&&Ft===0){gt||(gt="svg");var sn=document.getElementsByTagName("body")[0];sn.innerText="";var cn=createTag("div");cn.style.width="100%",cn.style.height="100%",cn.setAttribute("data-bm-type",gt),sn.appendChild(cn),le(cn,vt)}}function mt(){var vt;for(vt=0;vt<$;vt+=1)_[vt].animation.resize()}function _t(){!ae&&ee&&re&&(window.requestAnimationFrame(qe),re=!1)}function Lt(){ae=!0}function Vt(){ae=!1,_t()}function Gt(vt,It){var gt;for(gt=0;gt<$;gt+=1)_[gt].animation.setVolume(vt,It)}function $t(vt){var It;for(It=0;It<$;It+=1)_[It].animation.mute(vt)}function Qt(vt){var It;for(It=0;It<$;It+=1)_[It].animation.unmute(vt)}return H.registerAnimation=le,H.loadAnimation=Ce,H.setSpeed=Ie,H.setDirection=De,H.play=Be,H.pause=Xe,H.stop=Qe,H.togglePause=rt,H.searchAnimations=ct,H.resize=mt,H.goToAndStop=Ye,H.destroy=ot,H.freeze=Lt,H.unfreeze=Vt,H.setVolume=Gt,H.mute=$t,H.unmute=Qt,H.getRegisteredAnimations=fe,H}(),BezierFactory=function(){var H={};H.getBezierEasing=b;var _={};function b(qe,Xe,Ye,Qe,rt){var ot=rt||("bez_"+qe+"_"+Xe+"_"+Ye+"_"+Qe).replace(/\./g,"p");if(_[ot])return _[ot];var ct=new Ne([qe,Xe,Ye,Qe]);return _[ot]=ct,ct}var $=4,ee=.001,re=1e-7,ae=10,xe=11,le=1/(xe-1),fe=typeof Float32Array=="function";function ve(qe,Xe){return 1-3*Xe+3*qe}function Se(qe,Xe){return 3*Xe-6*qe}function Ee(qe){return 3*qe}function Ce(qe,Xe,Ye){return((ve(Xe,Ye)*qe+Se(Xe,Ye))*qe+Ee(Xe))*qe}function Ie(qe,Xe,Ye){return 3*ve(Xe,Ye)*qe*qe+2*Se(Xe,Ye)*qe+Ee(Xe)}function De(qe,Xe,Ye,Qe,rt){var ot,ct,mt=0;do ct=Xe+(Ye-Xe)/2,ot=Ce(ct,Qe,rt)-qe,ot>0?Ye=ct:Xe=ct;while(Math.abs(ot)>re&&++mt<ae);return ct}function Be(qe,Xe,Ye,Qe){for(var rt=0;rt<$;++rt){var ot=Ie(Xe,Ye,Qe);if(ot===0)return Xe;var ct=Ce(Xe,Ye,Qe)-qe;Xe-=ct/ot}return Xe}function Ne(qe){this._p=qe,this._mSampleValues=fe?new Float32Array(xe):new Array(xe),this._precomputed=!1,this.get=this.get.bind(this)}return Ne.prototype={get:function(Xe){var Ye=this._p[0],Qe=this._p[1],rt=this._p[2],ot=this._p[3];return this._precomputed||this._precompute(),Ye===Qe&&rt===ot?Xe:Xe===0?0:Xe===1?1:Ce(this._getTForX(Xe),Qe,ot)},_precompute:function(){var Xe=this._p[0],Ye=this._p[1],Qe=this._p[2],rt=this._p[3];this._precomputed=!0,(Xe!==Ye||Qe!==rt)&&this._calcSampleValues()},_calcSampleValues:function(){for(var Xe=this._p[0],Ye=this._p[2],Qe=0;Qe<xe;++Qe)this._mSampleValues[Qe]=Ce(Qe*le,Xe,Ye)},_getTForX:function(Xe){for(var Ye=this._p[0],Qe=this._p[2],rt=this._mSampleValues,ot=0,ct=1,mt=xe-1;ct!==mt&&rt[ct]<=Xe;++ct)ot+=le;--ct;var _t=(Xe-rt[ct])/(rt[ct+1]-rt[ct]),Lt=ot+_t*le,Vt=Ie(Lt,Ye,Qe);return Vt>=ee?Be(Xe,Lt,Ye,Qe):Vt===0?Lt:De(Xe,ot,ot+le,Ye,Qe)}},H}(),pooling=function(){function H(_){return _.concat(createSizedArray(_.length))}return{double:H}}(),poolFactory=function(){return function(H,_,b){var $=0,ee=H,re=createSizedArray(ee),ae={newElement:xe,release:le};function xe(){var fe;return $?($-=1,fe=re[$]):fe=_(),fe}function le(fe){$===ee&&(re=pooling.double(re),ee*=2),b&&b(fe),re[$]=fe,$+=1}return ae}}(),bezierLengthPool=function(){function H(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}}return poolFactory(8,H)}(),segmentsLengthPool=function(){function H(){return{lengths:[],totalLength:0}}function _(b){var $,ee=b.lengths.length;for($=0;$<ee;$+=1)bezierLengthPool.release(b.lengths[$]);b.lengths.length=0}return poolFactory(8,H,_)}();function bezFunction(){var H=Math;function _(Ee,Ce,Ie,De,Be,Ne){var qe=Ee*De+Ce*Be+Ie*Ne-Be*De-Ne*Ee-Ie*Ce;return qe>-.001&&qe<.001}function b(Ee,Ce,Ie,De,Be,Ne,qe,Xe,Ye){if(Ie===0&&Ne===0&&Ye===0)return _(Ee,Ce,De,Be,qe,Xe);var Qe=H.sqrt(H.pow(De-Ee,2)+H.pow(Be-Ce,2)+H.pow(Ne-Ie,2)),rt=H.sqrt(H.pow(qe-Ee,2)+H.pow(Xe-Ce,2)+H.pow(Ye-Ie,2)),ot=H.sqrt(H.pow(qe-De,2)+H.pow(Xe-Be,2)+H.pow(Ye-Ne,2)),ct;return Qe>rt?Qe>ot?ct=Qe-rt-ot:ct=ot-rt-Qe:ot>rt?ct=ot-rt-Qe:ct=rt-Qe-ot,ct>-1e-4&&ct<1e-4}var $=function(){return function(Ee,Ce,Ie,De){var Be=getDefaultCurveSegments(),Ne,qe,Xe,Ye,Qe,rt=0,ot,ct=[],mt=[],_t=bezierLengthPool.newElement();for(Xe=Ie.length,Ne=0;Ne<Be;Ne+=1){for(Qe=Ne/(Be-1),ot=0,qe=0;qe<Xe;qe+=1)Ye=bmPow(1-Qe,3)*Ee[qe]+3*bmPow(1-Qe,2)*Qe*Ie[qe]+3*(1-Qe)*bmPow(Qe,2)*De[qe]+bmPow(Qe,3)*Ce[qe],ct[qe]=Ye,mt[qe]!==null&&(ot+=bmPow(ct[qe]-mt[qe],2)),mt[qe]=ct[qe];ot&&(ot=bmSqrt(ot),rt+=ot),_t.percents[Ne]=Qe,_t.lengths[Ne]=rt}return _t.addedLength=rt,_t}}();function ee(Ee){var Ce=segmentsLengthPool.newElement(),Ie=Ee.c,De=Ee.v,Be=Ee.o,Ne=Ee.i,qe,Xe=Ee._length,Ye=Ce.lengths,Qe=0;for(qe=0;qe<Xe-1;qe+=1)Ye[qe]=$(De[qe],De[qe+1],Be[qe],Ne[qe+1]),Qe+=Ye[qe].addedLength;return Ie&&Xe&&(Ye[qe]=$(De[qe],De[0],Be[qe],Ne[0]),Qe+=Ye[qe].addedLength),Ce.totalLength=Qe,Ce}function re(Ee){this.segmentLength=0,this.points=new Array(Ee)}function ae(Ee,Ce){this.partialLength=Ee,this.point=Ce}var xe=function(){var Ee={};return function(Ce,Ie,De,Be){var Ne=(Ce[0]+"_"+Ce[1]+"_"+Ie[0]+"_"+Ie[1]+"_"+De[0]+"_"+De[1]+"_"+Be[0]+"_"+Be[1]).replace(/\./g,"p");if(!Ee[Ne]){var qe=getDefaultCurveSegments(),Xe,Ye,Qe,rt,ot,ct=0,mt,_t,Lt=null;Ce.length===2&&(Ce[0]!==Ie[0]||Ce[1]!==Ie[1])&&_(Ce[0],Ce[1],Ie[0],Ie[1],Ce[0]+De[0],Ce[1]+De[1])&&_(Ce[0],Ce[1],Ie[0],Ie[1],Ie[0]+Be[0],Ie[1]+Be[1])&&(qe=2);var Vt=new re(qe);for(Qe=De.length,Xe=0;Xe<qe;Xe+=1){for(_t=createSizedArray(Qe),ot=Xe/(qe-1),mt=0,Ye=0;Ye<Qe;Ye+=1)rt=bmPow(1-ot,3)*Ce[Ye]+3*bmPow(1-ot,2)*ot*(Ce[Ye]+De[Ye])+3*(1-ot)*bmPow(ot,2)*(Ie[Ye]+Be[Ye])+bmPow(ot,3)*Ie[Ye],_t[Ye]=rt,Lt!==null&&(mt+=bmPow(_t[Ye]-Lt[Ye],2));mt=bmSqrt(mt),ct+=mt,Vt.points[Xe]=new ae(mt,_t),Lt=_t}Vt.segmentLength=ct,Ee[Ne]=Vt}return Ee[Ne]}}();function le(Ee,Ce){var Ie=Ce.percents,De=Ce.lengths,Be=Ie.length,Ne=bmFloor((Be-1)*Ee),qe=Ee*Ce.addedLength,Xe=0;if(Ne===Be-1||Ne===0||qe===De[Ne])return Ie[Ne];for(var Ye=De[Ne]>qe?-1:1,Qe=!0;Qe;)if(De[Ne]<=qe&&De[Ne+1]>qe?(Xe=(qe-De[Ne])/(De[Ne+1]-De[Ne]),Qe=!1):Ne+=Ye,Ne<0||Ne>=Be-1){if(Ne===Be-1)return Ie[Ne];Qe=!1}return Ie[Ne]+(Ie[Ne+1]-Ie[Ne])*Xe}function fe(Ee,Ce,Ie,De,Be,Ne){var qe=le(Be,Ne),Xe=1-qe,Ye=H.round((Xe*Xe*Xe*Ee[0]+(qe*Xe*Xe+Xe*qe*Xe+Xe*Xe*qe)*Ie[0]+(qe*qe*Xe+Xe*qe*qe+qe*Xe*qe)*De[0]+qe*qe*qe*Ce[0])*1e3)/1e3,Qe=H.round((Xe*Xe*Xe*Ee[1]+(qe*Xe*Xe+Xe*qe*Xe+Xe*Xe*qe)*Ie[1]+(qe*qe*Xe+Xe*qe*qe+qe*Xe*qe)*De[1]+qe*qe*qe*Ce[1])*1e3)/1e3;return[Ye,Qe]}var ve=createTypedArray("float32",8);function Se(Ee,Ce,Ie,De,Be,Ne,qe){Be<0?Be=0:Be>1&&(Be=1);var Xe=le(Be,qe);Ne=Ne>1?1:Ne;var Ye=le(Ne,qe),Qe,rt=Ee.length,ot=1-Xe,ct=1-Ye,mt=ot*ot*ot,_t=Xe*ot*ot*3,Lt=Xe*Xe*ot*3,Vt=Xe*Xe*Xe,Gt=ot*ot*ct,$t=Xe*ot*ct+ot*Xe*ct+ot*ot*Ye,Qt=Xe*Xe*ct+ot*Xe*Ye+Xe*ot*Ye,vt=Xe*Xe*Ye,It=ot*ct*ct,gt=Xe*ct*ct+ot*Ye*ct+ot*ct*Ye,Tt=Xe*Ye*ct+ot*Ye*Ye+Xe*ct*Ye,Ct=Xe*Ye*Ye,Ft=ct*ct*ct,sn=Ye*ct*ct+ct*Ye*ct+ct*ct*Ye,cn=Ye*Ye*ct+ct*Ye*Ye+Ye*ct*Ye,en=Ye*Ye*Ye;for(Qe=0;Qe<rt;Qe+=1)ve[Qe*4]=H.round((mt*Ee[Qe]+_t*Ie[Qe]+Lt*De[Qe]+Vt*Ce[Qe])*1e3)/1e3,ve[Qe*4+1]=H.round((Gt*Ee[Qe]+$t*Ie[Qe]+Qt*De[Qe]+vt*Ce[Qe])*1e3)/1e3,ve[Qe*4+2]=H.round((It*Ee[Qe]+gt*Ie[Qe]+Tt*De[Qe]+Ct*Ce[Qe])*1e3)/1e3,ve[Qe*4+3]=H.round((Ft*Ee[Qe]+sn*Ie[Qe]+cn*De[Qe]+en*Ce[Qe])*1e3)/1e3;return ve}return{getSegmentsLength:ee,getNewSegment:Se,getPointInSegment:fe,buildBezierData:xe,pointOnLine2D:_,pointOnLine3D:b}}var bez=bezFunction(),initFrame=initialDefaultFrame,mathAbs=Math.abs;function interpolateValue(H,_){var b=this.offsetTime,$;this.propType==="multidimensional"&&($=createTypedArray("float32",this.pv.length));for(var ee=_.lastIndex,re=ee,ae=this.keyframes.length-1,xe=!0,le,fe,ve;xe;){if(le=this.keyframes[re],fe=this.keyframes[re+1],re===ae-1&&H>=fe.t-b){le.h&&(le=fe),ee=0;break}if(fe.t-b>H){ee=re;break}re<ae-1?re+=1:(ee=0,xe=!1)}ve=this.keyframesMetadata[re]||{};var Se,Ee,Ce,Ie,De,Be,Ne=fe.t-b,qe=le.t-b,Xe;if(le.to){ve.bezierData||(ve.bezierData=bez.buildBezierData(le.s,fe.s||le.e,le.to,le.ti));var Ye=ve.bezierData;if(H>=Ne||H<qe){var Qe=H>=Ne?Ye.points.length-1:0;for(Ee=Ye.points[Qe].point.length,Se=0;Se<Ee;Se+=1)$[Se]=Ye.points[Qe].point[Se]}else{ve.__fnct?Be=ve.__fnct:(Be=BezierFactory.getBezierEasing(le.o.x,le.o.y,le.i.x,le.i.y,le.n).get,ve.__fnct=Be),Ce=Be((H-qe)/(Ne-qe));var rt=Ye.segmentLength*Ce,ot,ct=_.lastFrame<H&&_._lastKeyframeIndex===re?_._lastAddedLength:0;for(De=_.lastFrame<H&&_._lastKeyframeIndex===re?_._lastPoint:0,xe=!0,Ie=Ye.points.length;xe;){if(ct+=Ye.points[De].partialLength,rt===0||Ce===0||De===Ye.points.length-1){for(Ee=Ye.points[De].point.length,Se=0;Se<Ee;Se+=1)$[Se]=Ye.points[De].point[Se];break}else if(rt>=ct&&rt<ct+Ye.points[De+1].partialLength){for(ot=(rt-ct)/Ye.points[De+1].partialLength,Ee=Ye.points[De].point.length,Se=0;Se<Ee;Se+=1)$[Se]=Ye.points[De].point[Se]+(Ye.points[De+1].point[Se]-Ye.points[De].point[Se])*ot;break}De<Ie-1?De+=1:xe=!1}_._lastPoint=De,_._lastAddedLength=ct-Ye.points[De].partialLength,_._lastKeyframeIndex=re}}else{var mt,_t,Lt,Vt,Gt;if(ae=le.s.length,Xe=fe.s||le.e,this.sh&&le.h!==1)if(H>=Ne)$[0]=Xe[0],$[1]=Xe[1],$[2]=Xe[2];else if(H<=qe)$[0]=le.s[0],$[1]=le.s[1],$[2]=le.s[2];else{var $t=createQuaternion(le.s),Qt=createQuaternion(Xe),vt=(H-qe)/(Ne-qe);quaternionToEuler($,slerp($t,Qt,vt))}else for(re=0;re<ae;re+=1)le.h!==1&&(H>=Ne?Ce=1:H<qe?Ce=0:(le.o.x.constructor===Array?(ve.__fnct||(ve.__fnct=[]),ve.__fnct[re]?Be=ve.__fnct[re]:(mt=le.o.x[re]===void 0?le.o.x[0]:le.o.x[re],_t=le.o.y[re]===void 0?le.o.y[0]:le.o.y[re],Lt=le.i.x[re]===void 0?le.i.x[0]:le.i.x[re],Vt=le.i.y[re]===void 0?le.i.y[0]:le.i.y[re],Be=BezierFactory.getBezierEasing(mt,_t,Lt,Vt).get,ve.__fnct[re]=Be)):ve.__fnct?Be=ve.__fnct:(mt=le.o.x,_t=le.o.y,Lt=le.i.x,Vt=le.i.y,Be=BezierFactory.getBezierEasing(mt,_t,Lt,Vt).get,le.keyframeMetadata=Be),Ce=Be((H-qe)/(Ne-qe)))),Xe=fe.s||le.e,Gt=le.h===1?le.s[re]:le.s[re]+(Xe[re]-le.s[re])*Ce,this.propType==="multidimensional"?$[re]=Gt:$=Gt}return _.lastIndex=ee,$}function slerp(H,_,b){var $=[],ee=H[0],re=H[1],ae=H[2],xe=H[3],le=_[0],fe=_[1],ve=_[2],Se=_[3],Ee,Ce,Ie,De,Be;return Ce=ee*le+re*fe+ae*ve+xe*Se,Ce<0&&(Ce=-Ce,le=-le,fe=-fe,ve=-ve,Se=-Se),1-Ce>1e-6?(Ee=Math.acos(Ce),Ie=Math.sin(Ee),De=Math.sin((1-b)*Ee)/Ie,Be=Math.sin(b*Ee)/Ie):(De=1-b,Be=b),$[0]=De*ee+Be*le,$[1]=De*re+Be*fe,$[2]=De*ae+Be*ve,$[3]=De*xe+Be*Se,$}function quaternionToEuler(H,_){var b=_[0],$=_[1],ee=_[2],re=_[3],ae=Math.atan2(2*$*re-2*b*ee,1-2*$*$-2*ee*ee),xe=Math.asin(2*b*$+2*ee*re),le=Math.atan2(2*b*re-2*$*ee,1-2*b*b-2*ee*ee);H[0]=ae/degToRads,H[1]=xe/degToRads,H[2]=le/degToRads}function createQuaternion(H){var _=H[0]*degToRads,b=H[1]*degToRads,$=H[2]*degToRads,ee=Math.cos(_/2),re=Math.cos(b/2),ae=Math.cos($/2),xe=Math.sin(_/2),le=Math.sin(b/2),fe=Math.sin($/2),ve=ee*re*ae-xe*le*fe,Se=xe*le*ae+ee*re*fe,Ee=xe*re*ae+ee*le*fe,Ce=ee*le*ae-xe*re*fe;return[Se,Ee,Ce,ve]}function getValueAtCurrentTime(){var H=this.comp.renderedFrame-this.offsetTime,_=this.keyframes[0].t-this.offsetTime,b=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(H===this._caching.lastFrame||this._caching.lastFrame!==initFrame&&(this._caching.lastFrame>=b&&H>=b||this._caching.lastFrame<_&&H<_))){this._caching.lastFrame>=H&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var $=this.interpolateValue(H,this._caching);this.pv=$}return this._caching.lastFrame=H,this.pv}function setVValue(H){var _;if(this.propType==="unidimensional")_=H*this.mult,mathAbs(this.v-_)>1e-5&&(this.v=_,this._mdf=!0);else for(var b=0,$=this.v.length;b<$;)_=H[b]*this.mult,mathAbs(this.v[b]-_)>1e-5&&(this.v[b]=_,this._mdf=!0),b+=1}function processEffectsSequence(){if(!(this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)){if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=this._isFirstFrame;var H,_=this.effectsSequence.length,b=this.kf?this.pv:this.data.k;for(H=0;H<_;H+=1)b=this.effectsSequence[H](b);this.setVValue(b),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function addEffect(H){this.effectsSequence.push(H),this.container.addDynamicProperty(this)}function ValueProperty(H,_,b,$){this.propType="unidimensional",this.mult=b||1,this.data=_,this.v=b?_.k*b:_.k,this.pv=_.k,this._mdf=!1,this.elem=H,this.container=$,this.comp=H.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function MultiDimensionalProperty(H,_,b,$){this.propType="multidimensional",this.mult=b||1,this.data=_,this._mdf=!1,this.elem=H,this.container=$,this.comp=H.comp,this.k=!1,this.kf=!1,this.frameId=-1;var ee,re=_.k.length;for(this.v=createTypedArray("float32",re),this.pv=createTypedArray("float32",re),this.vel=createTypedArray("float32",re),ee=0;ee<re;ee+=1)this.v[ee]=_.k[ee]*this.mult,this.pv[ee]=_.k[ee];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function KeyframedValueProperty(H,_,b,$){this.propType="unidimensional",this.keyframes=_.k,this.keyframesMetadata=[],this.offsetTime=H.data.st,this.frameId=-1,this._caching={lastFrame:initFrame,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=_,this.mult=b||1,this.elem=H,this.container=$,this.comp=H.comp,this.v=initFrame,this.pv=initFrame,this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.addEffect=addEffect}function KeyframedMultidimensionalProperty(H,_,b,$){this.propType="multidimensional";var ee,re=_.k.length,ae,xe,le,fe;for(ee=0;ee<re-1;ee+=1)_.k[ee].to&&_.k[ee].s&&_.k[ee+1]&&_.k[ee+1].s&&(ae=_.k[ee].s,xe=_.k[ee+1].s,le=_.k[ee].to,fe=_.k[ee].ti,(ae.length===2&&!(ae[0]===xe[0]&&ae[1]===xe[1])&&bez.pointOnLine2D(ae[0],ae[1],xe[0],xe[1],ae[0]+le[0],ae[1]+le[1])&&bez.pointOnLine2D(ae[0],ae[1],xe[0],xe[1],xe[0]+fe[0],xe[1]+fe[1])||ae.length===3&&!(ae[0]===xe[0]&&ae[1]===xe[1]&&ae[2]===xe[2])&&bez.pointOnLine3D(ae[0],ae[1],ae[2],xe[0],xe[1],xe[2],ae[0]+le[0],ae[1]+le[1],ae[2]+le[2])&&bez.pointOnLine3D(ae[0],ae[1],ae[2],xe[0],xe[1],xe[2],xe[0]+fe[0],xe[1]+fe[1],xe[2]+fe[2]))&&(_.k[ee].to=null,_.k[ee].ti=null),ae[0]===xe[0]&&ae[1]===xe[1]&&le[0]===0&&le[1]===0&&fe[0]===0&&fe[1]===0&&(ae.length===2||ae[2]===xe[2]&&le[2]===0&&fe[2]===0)&&(_.k[ee].to=null,_.k[ee].ti=null));this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.data=_,this.keyframes=_.k,this.keyframesMetadata=[],this.offsetTime=H.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=b||1,this.elem=H,this.container=$,this.comp=H.comp,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.frameId=-1;var ve=_.k[0].s.length;for(this.v=createTypedArray("float32",ve),this.pv=createTypedArray("float32",ve),ee=0;ee<ve;ee+=1)this.v[ee]=initFrame,this.pv[ee]=initFrame;this._caching={lastFrame:initFrame,lastIndex:0,value:createTypedArray("float32",ve)},this.addEffect=addEffect}var PropertyFactory=function(){function H(b,$,ee,re,ae){$.sid&&($=b.globalData.slotManager.getProp($));var xe;if(!$.k.length)xe=new ValueProperty(b,$,re,ae);else if(typeof $.k[0]=="number")xe=new MultiDimensionalProperty(b,$,re,ae);else switch(ee){case 0:xe=new KeyframedValueProperty(b,$,re,ae);break;case 1:xe=new KeyframedMultidimensionalProperty(b,$,re,ae);break}return xe.effectsSequence.length&&ae.addDynamicProperty(xe),xe}var _={getProp:H};return _}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(_){this.dynamicProperties.indexOf(_)===-1&&(this.dynamicProperties.push(_),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){this._mdf=!1;var _,b=this.dynamicProperties.length;for(_=0;_<b;_+=1)this.dynamicProperties[_].getValue(),this.dynamicProperties[_]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(_){this.container=_,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=function(){function H(){return createTypedArray("float32",2)}return poolFactory(8,H)}();function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(H,_){this.c=H,this.setLength(_);for(var b=0;b<_;)this.v[b]=pointPool.newElement(),this.o[b]=pointPool.newElement(),this.i[b]=pointPool.newElement(),b+=1},ShapePath.prototype.setLength=function(H){for(;this._maxLength<H;)this.doubleArrayLength();this._length=H},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(H,_,b,$,ee){var re;switch(this._length=Math.max(this._length,$+1),this._length>=this._maxLength&&this.doubleArrayLength(),b){case"v":re=this.v;break;case"i":re=this.i;break;case"o":re=this.o;break;default:re=[];break}(!re[$]||re[$]&&!ee)&&(re[$]=pointPool.newElement()),re[$][0]=H,re[$][1]=_},ShapePath.prototype.setTripleAt=function(H,_,b,$,ee,re,ae,xe){this.setXYAt(H,_,"v",ae,xe),this.setXYAt(b,$,"o",ae,xe),this.setXYAt(ee,re,"i",ae,xe)},ShapePath.prototype.reverse=function(){var H=new ShapePath;H.setPathData(this.c,this._length);var _=this.v,b=this.o,$=this.i,ee=0;this.c&&(H.setTripleAt(_[0][0],_[0][1],$[0][0],$[0][1],b[0][0],b[0][1],0,!1),ee=1);var re=this._length-1,ae=this._length,xe;for(xe=ee;xe<ae;xe+=1)H.setTripleAt(_[re][0],_[re][1],$[re][0],$[re][1],b[re][0],b[re][1],xe,!1),re-=1;return H},ShapePath.prototype.length=function(){return this._length};var shapePool=function(){function H(){return new ShapePath}function _(ee){var re=ee._length,ae;for(ae=0;ae<re;ae+=1)pointPool.release(ee.v[ae]),pointPool.release(ee.i[ae]),pointPool.release(ee.o[ae]),ee.v[ae]=null,ee.i[ae]=null,ee.o[ae]=null;ee._length=0,ee.c=!1}function b(ee){var re=$.newElement(),ae,xe=ee._length===void 0?ee.v.length:ee._length;for(re.setLength(xe),re.c=ee.c,ae=0;ae<xe;ae+=1)re.setTripleAt(ee.v[ae][0],ee.v[ae][1],ee.o[ae][0],ee.o[ae][1],ee.i[ae][0],ee.i[ae][1],ae);return re}var $=poolFactory(4,H,_);return $.clone=b,$}();function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(H){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=H,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var H;for(H=0;H<this._length;H+=1)shapePool.release(this.shapes[H]);this._length=0};var shapeCollectionPool=function(){var H={newShapeCollection:ee,release:re},_=0,b=4,$=createSizedArray(b);function ee(){var ae;return _?(_-=1,ae=$[_]):ae=new ShapeCollection,ae}function re(ae){var xe,le=ae._length;for(xe=0;xe<le;xe+=1)shapePool.release(ae.shapes[xe]);ae._length=0,_===b&&($=pooling.double($),b*=2),$[_]=ae,_+=1}return H}(),ShapePropertyFactory=function(){var H=-999999;function _(Ne,qe,Xe){var Ye=Xe.lastIndex,Qe,rt,ot,ct,mt,_t,Lt,Vt,Gt,$t=this.keyframes;if(Ne<$t[0].t-this.offsetTime)Qe=$t[0].s[0],ot=!0,Ye=0;else if(Ne>=$t[$t.length-1].t-this.offsetTime)Qe=$t[$t.length-1].s?$t[$t.length-1].s[0]:$t[$t.length-2].e[0],ot=!0;else{for(var Qt=Ye,vt=$t.length-1,It=!0,gt,Tt,Ct;It&&(gt=$t[Qt],Tt=$t[Qt+1],!(Tt.t-this.offsetTime>Ne));)Qt<vt-1?Qt+=1:It=!1;if(Ct=this.keyframesMetadata[Qt]||{},ot=gt.h===1,Ye=Qt,!ot){if(Ne>=Tt.t-this.offsetTime)Vt=1;else if(Ne<gt.t-this.offsetTime)Vt=0;else{var Ft;Ct.__fnct?Ft=Ct.__fnct:(Ft=BezierFactory.getBezierEasing(gt.o.x,gt.o.y,gt.i.x,gt.i.y).get,Ct.__fnct=Ft),Vt=Ft((Ne-(gt.t-this.offsetTime))/(Tt.t-this.offsetTime-(gt.t-this.offsetTime)))}rt=Tt.s?Tt.s[0]:gt.e[0]}Qe=gt.s[0]}for(_t=qe._length,Lt=Qe.i[0].length,Xe.lastIndex=Ye,ct=0;ct<_t;ct+=1)for(mt=0;mt<Lt;mt+=1)Gt=ot?Qe.i[ct][mt]:Qe.i[ct][mt]+(rt.i[ct][mt]-Qe.i[ct][mt])*Vt,qe.i[ct][mt]=Gt,Gt=ot?Qe.o[ct][mt]:Qe.o[ct][mt]+(rt.o[ct][mt]-Qe.o[ct][mt])*Vt,qe.o[ct][mt]=Gt,Gt=ot?Qe.v[ct][mt]:Qe.v[ct][mt]+(rt.v[ct][mt]-Qe.v[ct][mt])*Vt,qe.v[ct][mt]=Gt}function b(){var Ne=this.comp.renderedFrame-this.offsetTime,qe=this.keyframes[0].t-this.offsetTime,Xe=this.keyframes[this.keyframes.length-1].t-this.offsetTime,Ye=this._caching.lastFrame;return Ye!==H&&(Ye<qe&&Ne<qe||Ye>Xe&&Ne>Xe)||(this._caching.lastIndex=Ye<Ne?this._caching.lastIndex:0,this.interpolateShape(Ne,this.pv,this._caching)),this._caching.lastFrame=Ne,this.pv}function $(){this.paths=this.localShapeCollection}function ee(Ne,qe){if(Ne._length!==qe._length||Ne.c!==qe.c)return!1;var Xe,Ye=Ne._length;for(Xe=0;Xe<Ye;Xe+=1)if(Ne.v[Xe][0]!==qe.v[Xe][0]||Ne.v[Xe][1]!==qe.v[Xe][1]||Ne.o[Xe][0]!==qe.o[Xe][0]||Ne.o[Xe][1]!==qe.o[Xe][1]||Ne.i[Xe][0]!==qe.i[Xe][0]||Ne.i[Xe][1]!==qe.i[Xe][1])return!1;return!0}function re(Ne){ee(this.v,Ne)||(this.v=shapePool.clone(Ne),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function ae(){if(this.elem.globalData.frameId!==this.frameId){if(!this.effectsSequence.length){this._mdf=!1;return}if(this.lock){this.setVValue(this.pv);return}this.lock=!0,this._mdf=!1;var Ne;this.kf?Ne=this.pv:this.data.ks?Ne=this.data.ks.k:Ne=this.data.pt.k;var qe,Xe=this.effectsSequence.length;for(qe=0;qe<Xe;qe+=1)Ne=this.effectsSequence[qe](Ne);this.setVValue(Ne),this.lock=!1,this.frameId=this.elem.globalData.frameId}}function xe(Ne,qe,Xe){this.propType="shape",this.comp=Ne.comp,this.container=Ne,this.elem=Ne,this.data=qe,this.k=!1,this.kf=!1,this._mdf=!1;var Ye=Xe===3?qe.pt.k:qe.ks.k;this.v=shapePool.clone(Ye),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=$,this.effectsSequence=[]}function le(Ne){this.effectsSequence.push(Ne),this.container.addDynamicProperty(this)}xe.prototype.interpolateShape=_,xe.prototype.getValue=ae,xe.prototype.setVValue=re,xe.prototype.addEffect=le;function fe(Ne,qe,Xe){this.propType="shape",this.comp=Ne.comp,this.elem=Ne,this.container=Ne,this.offsetTime=Ne.data.st,this.keyframes=Xe===3?qe.pt.k:qe.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var Ye=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,Ye),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=H,this.reset=$,this._caching={lastFrame:H,lastIndex:0},this.effectsSequence=[b.bind(this)]}fe.prototype.getValue=ae,fe.prototype.interpolateShape=_,fe.prototype.setVValue=re,fe.prototype.addEffect=le;var ve=function(){var Ne=roundCorner;function qe(Xe,Ye){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=Ye.d,this.elem=Xe,this.comp=Xe.comp,this.frameId=-1,this.initDynamicPropertyContainer(Xe),this.p=PropertyFactory.getProp(Xe,Ye.p,1,0,this),this.s=PropertyFactory.getProp(Xe,Ye.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return qe.prototype={reset:$,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var Ye=this.p.v[0],Qe=this.p.v[1],rt=this.s.v[0]/2,ot=this.s.v[1]/2,ct=this.d!==3,mt=this.v;mt.v[0][0]=Ye,mt.v[0][1]=Qe-ot,mt.v[1][0]=ct?Ye+rt:Ye-rt,mt.v[1][1]=Qe,mt.v[2][0]=Ye,mt.v[2][1]=Qe+ot,mt.v[3][0]=ct?Ye-rt:Ye+rt,mt.v[3][1]=Qe,mt.i[0][0]=ct?Ye-rt*Ne:Ye+rt*Ne,mt.i[0][1]=Qe-ot,mt.i[1][0]=ct?Ye+rt:Ye-rt,mt.i[1][1]=Qe-ot*Ne,mt.i[2][0]=ct?Ye+rt*Ne:Ye-rt*Ne,mt.i[2][1]=Qe+ot,mt.i[3][0]=ct?Ye-rt:Ye+rt,mt.i[3][1]=Qe+ot*Ne,mt.o[0][0]=ct?Ye+rt*Ne:Ye-rt*Ne,mt.o[0][1]=Qe-ot,mt.o[1][0]=ct?Ye+rt:Ye-rt,mt.o[1][1]=Qe+ot*Ne,mt.o[2][0]=ct?Ye-rt*Ne:Ye+rt*Ne,mt.o[2][1]=Qe+ot,mt.o[3][0]=ct?Ye-rt:Ye+rt,mt.o[3][1]=Qe-ot*Ne}},extendPrototype([DynamicPropertyContainer],qe),qe}(),Se=function(){function Ne(qe,Xe){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=qe,this.comp=qe.comp,this.data=Xe,this.frameId=-1,this.d=Xe.d,this.initDynamicPropertyContainer(qe),Xe.sy===1?(this.ir=PropertyFactory.getProp(qe,Xe.ir,0,0,this),this.is=PropertyFactory.getProp(qe,Xe.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(qe,Xe.pt,0,0,this),this.p=PropertyFactory.getProp(qe,Xe.p,1,0,this),this.r=PropertyFactory.getProp(qe,Xe.r,0,degToRads,this),this.or=PropertyFactory.getProp(qe,Xe.or,0,0,this),this.os=PropertyFactory.getProp(qe,Xe.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return Ne.prototype={reset:$,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var Xe=Math.floor(this.pt.v)*2,Ye=Math.PI*2/Xe,Qe=!0,rt=this.or.v,ot=this.ir.v,ct=this.os.v,mt=this.is.v,_t=2*Math.PI*rt/(Xe*2),Lt=2*Math.PI*ot/(Xe*2),Vt,Gt,$t,Qt,vt=-Math.PI/2;vt+=this.r.v;var It=this.data.d===3?-1:1;for(this.v._length=0,Vt=0;Vt<Xe;Vt+=1){Gt=Qe?rt:ot,$t=Qe?ct:mt,Qt=Qe?_t:Lt;var gt=Gt*Math.cos(vt),Tt=Gt*Math.sin(vt),Ct=gt===0&&Tt===0?0:Tt/Math.sqrt(gt*gt+Tt*Tt),Ft=gt===0&&Tt===0?0:-gt/Math.sqrt(gt*gt+Tt*Tt);gt+=+this.p.v[0],Tt+=+this.p.v[1],this.v.setTripleAt(gt,Tt,gt-Ct*Qt*$t*It,Tt-Ft*Qt*$t*It,gt+Ct*Qt*$t*It,Tt+Ft*Qt*$t*It,Vt,!0),Qe=!Qe,vt+=Ye*It}},convertPolygonToPath:function(){var Xe=Math.floor(this.pt.v),Ye=Math.PI*2/Xe,Qe=this.or.v,rt=this.os.v,ot=2*Math.PI*Qe/(Xe*4),ct,mt=-Math.PI*.5,_t=this.data.d===3?-1:1;for(mt+=this.r.v,this.v._length=0,ct=0;ct<Xe;ct+=1){var Lt=Qe*Math.cos(mt),Vt=Qe*Math.sin(mt),Gt=Lt===0&&Vt===0?0:Vt/Math.sqrt(Lt*Lt+Vt*Vt),$t=Lt===0&&Vt===0?0:-Lt/Math.sqrt(Lt*Lt+Vt*Vt);Lt+=+this.p.v[0],Vt+=+this.p.v[1],this.v.setTripleAt(Lt,Vt,Lt-Gt*ot*rt*_t,Vt-$t*ot*rt*_t,Lt+Gt*ot*rt*_t,Vt+$t*ot*rt*_t,ct,!0),mt+=Ye*_t}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],Ne),Ne}(),Ee=function(){function Ne(qe,Xe){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=qe,this.comp=qe.comp,this.frameId=-1,this.d=Xe.d,this.initDynamicPropertyContainer(qe),this.p=PropertyFactory.getProp(qe,Xe.p,1,0,this),this.s=PropertyFactory.getProp(qe,Xe.s,1,0,this),this.r=PropertyFactory.getProp(qe,Xe.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return Ne.prototype={convertRectToPath:function(){var Xe=this.p.v[0],Ye=this.p.v[1],Qe=this.s.v[0]/2,rt=this.s.v[1]/2,ot=bmMin(Qe,rt,this.r.v),ct=ot*(1-roundCorner);this.v._length=0,this.d===2||this.d===1?(this.v.setTripleAt(Xe+Qe,Ye-rt+ot,Xe+Qe,Ye-rt+ot,Xe+Qe,Ye-rt+ct,0,!0),this.v.setTripleAt(Xe+Qe,Ye+rt-ot,Xe+Qe,Ye+rt-ct,Xe+Qe,Ye+rt-ot,1,!0),ot!==0?(this.v.setTripleAt(Xe+Qe-ot,Ye+rt,Xe+Qe-ot,Ye+rt,Xe+Qe-ct,Ye+rt,2,!0),this.v.setTripleAt(Xe-Qe+ot,Ye+rt,Xe-Qe+ct,Ye+rt,Xe-Qe+ot,Ye+rt,3,!0),this.v.setTripleAt(Xe-Qe,Ye+rt-ot,Xe-Qe,Ye+rt-ot,Xe-Qe,Ye+rt-ct,4,!0),this.v.setTripleAt(Xe-Qe,Ye-rt+ot,Xe-Qe,Ye-rt+ct,Xe-Qe,Ye-rt+ot,5,!0),this.v.setTripleAt(Xe-Qe+ot,Ye-rt,Xe-Qe+ot,Ye-rt,Xe-Qe+ct,Ye-rt,6,!0),this.v.setTripleAt(Xe+Qe-ot,Ye-rt,Xe+Qe-ct,Ye-rt,Xe+Qe-ot,Ye-rt,7,!0)):(this.v.setTripleAt(Xe-Qe,Ye+rt,Xe-Qe+ct,Ye+rt,Xe-Qe,Ye+rt,2),this.v.setTripleAt(Xe-Qe,Ye-rt,Xe-Qe,Ye-rt+ct,Xe-Qe,Ye-rt,3))):(this.v.setTripleAt(Xe+Qe,Ye-rt+ot,Xe+Qe,Ye-rt+ct,Xe+Qe,Ye-rt+ot,0,!0),ot!==0?(this.v.setTripleAt(Xe+Qe-ot,Ye-rt,Xe+Qe-ot,Ye-rt,Xe+Qe-ct,Ye-rt,1,!0),this.v.setTripleAt(Xe-Qe+ot,Ye-rt,Xe-Qe+ct,Ye-rt,Xe-Qe+ot,Ye-rt,2,!0),this.v.setTripleAt(Xe-Qe,Ye-rt+ot,Xe-Qe,Ye-rt+ot,Xe-Qe,Ye-rt+ct,3,!0),this.v.setTripleAt(Xe-Qe,Ye+rt-ot,Xe-Qe,Ye+rt-ct,Xe-Qe,Ye+rt-ot,4,!0),this.v.setTripleAt(Xe-Qe+ot,Ye+rt,Xe-Qe+ot,Ye+rt,Xe-Qe+ct,Ye+rt,5,!0),this.v.setTripleAt(Xe+Qe-ot,Ye+rt,Xe+Qe-ct,Ye+rt,Xe+Qe-ot,Ye+rt,6,!0),this.v.setTripleAt(Xe+Qe,Ye+rt-ot,Xe+Qe,Ye+rt-ot,Xe+Qe,Ye+rt-ct,7,!0)):(this.v.setTripleAt(Xe-Qe,Ye-rt,Xe-Qe+ct,Ye-rt,Xe-Qe,Ye-rt,1,!0),this.v.setTripleAt(Xe-Qe,Ye+rt,Xe-Qe,Ye+rt-ct,Xe-Qe,Ye+rt,2,!0),this.v.setTripleAt(Xe+Qe,Ye+rt,Xe+Qe-ct,Ye+rt,Xe+Qe,Ye+rt,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:$},extendPrototype([DynamicPropertyContainer],Ne),Ne}();function Ce(Ne,qe,Xe){var Ye;if(Xe===3||Xe===4){var Qe=Xe===3?qe.pt:qe.ks,rt=Qe.k;rt.length?Ye=new fe(Ne,qe,Xe):Ye=new xe(Ne,qe,Xe)}else Xe===5?Ye=new Ee(Ne,qe):Xe===6?Ye=new ve(Ne,qe):Xe===7&&(Ye=new Se(Ne,qe));return Ye.k&&Ne.addDynamicProperty(Ye),Ye}function Ie(){return xe}function De(){return fe}var Be={};return Be.getShapeProp=Ce,Be.getConstructorFunction=Ie,Be.getKeyframedConstructorFunction=De,Be}();/*!
 Transformation Matrix v2.0
 (c) Epistemex 2014-2015
 www.epistemex.com
 By Ken Fyrstenberg
 Contributions by leeoniya.
 License: MIT, header required.
 */var Matrix=function(){var H=Math.cos,_=Math.sin,b=Math.tan,$=Math.round;function ee(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function re(gt){if(gt===0)return this;var Tt=H(gt),Ct=_(gt);return this._t(Tt,-Ct,0,0,Ct,Tt,0,0,0,0,1,0,0,0,0,1)}function ae(gt){if(gt===0)return this;var Tt=H(gt),Ct=_(gt);return this._t(1,0,0,0,0,Tt,-Ct,0,0,Ct,Tt,0,0,0,0,1)}function xe(gt){if(gt===0)return this;var Tt=H(gt),Ct=_(gt);return this._t(Tt,0,Ct,0,0,1,0,0,-Ct,0,Tt,0,0,0,0,1)}function le(gt){if(gt===0)return this;var Tt=H(gt),Ct=_(gt);return this._t(Tt,-Ct,0,0,Ct,Tt,0,0,0,0,1,0,0,0,0,1)}function fe(gt,Tt){return this._t(1,Tt,gt,1,0,0)}function ve(gt,Tt){return this.shear(b(gt),b(Tt))}function Se(gt,Tt){var Ct=H(Tt),Ft=_(Tt);return this._t(Ct,Ft,0,0,-Ft,Ct,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,b(gt),1,0,0,0,0,1,0,0,0,0,1)._t(Ct,-Ft,0,0,Ft,Ct,0,0,0,0,1,0,0,0,0,1)}function Ee(gt,Tt,Ct){return!Ct&&Ct!==0&&(Ct=1),gt===1&&Tt===1&&Ct===1?this:this._t(gt,0,0,0,0,Tt,0,0,0,0,Ct,0,0,0,0,1)}function Ce(gt,Tt,Ct,Ft,sn,cn,en,yn,Pn,tr,nr,Fr,Ur,Kr,on,qr){return this.props[0]=gt,this.props[1]=Tt,this.props[2]=Ct,this.props[3]=Ft,this.props[4]=sn,this.props[5]=cn,this.props[6]=en,this.props[7]=yn,this.props[8]=Pn,this.props[9]=tr,this.props[10]=nr,this.props[11]=Fr,this.props[12]=Ur,this.props[13]=Kr,this.props[14]=on,this.props[15]=qr,this}function Ie(gt,Tt,Ct){return Ct=Ct||0,gt!==0||Tt!==0||Ct!==0?this._t(1,0,0,0,0,1,0,0,0,0,1,0,gt,Tt,Ct,1):this}function De(gt,Tt,Ct,Ft,sn,cn,en,yn,Pn,tr,nr,Fr,Ur,Kr,on,qr){var rr=this.props;if(gt===1&&Tt===0&&Ct===0&&Ft===0&&sn===0&&cn===1&&en===0&&yn===0&&Pn===0&&tr===0&&nr===1&&Fr===0)return rr[12]=rr[12]*gt+rr[15]*Ur,rr[13]=rr[13]*cn+rr[15]*Kr,rr[14]=rr[14]*nr+rr[15]*on,rr[15]*=qr,this._identityCalculated=!1,this;var Qr=rr[0],Ir=rr[1],ai=rr[2],Hr=rr[3],Vr=rr[4],xn=rr[5],Ht=rr[6],In=rr[7],er=rr[8],Hn=rr[9],Zn=rr[10],Dr=rr[11],zn=rr[12],Nr=rr[13],vr=rr[14],Sr=rr[15];return rr[0]=Qr*gt+Ir*sn+ai*Pn+Hr*Ur,rr[1]=Qr*Tt+Ir*cn+ai*tr+Hr*Kr,rr[2]=Qr*Ct+Ir*en+ai*nr+Hr*on,rr[3]=Qr*Ft+Ir*yn+ai*Fr+Hr*qr,rr[4]=Vr*gt+xn*sn+Ht*Pn+In*Ur,rr[5]=Vr*Tt+xn*cn+Ht*tr+In*Kr,rr[6]=Vr*Ct+xn*en+Ht*nr+In*on,rr[7]=Vr*Ft+xn*yn+Ht*Fr+In*qr,rr[8]=er*gt+Hn*sn+Zn*Pn+Dr*Ur,rr[9]=er*Tt+Hn*cn+Zn*tr+Dr*Kr,rr[10]=er*Ct+Hn*en+Zn*nr+Dr*on,rr[11]=er*Ft+Hn*yn+Zn*Fr+Dr*qr,rr[12]=zn*gt+Nr*sn+vr*Pn+Sr*Ur,rr[13]=zn*Tt+Nr*cn+vr*tr+Sr*Kr,rr[14]=zn*Ct+Nr*en+vr*nr+Sr*on,rr[15]=zn*Ft+Nr*yn+vr*Fr+Sr*qr,this._identityCalculated=!1,this}function Be(gt){var Tt=gt.props;return this.transform(Tt[0],Tt[1],Tt[2],Tt[3],Tt[4],Tt[5],Tt[6],Tt[7],Tt[8],Tt[9],Tt[10],Tt[11],Tt[12],Tt[13],Tt[14],Tt[15])}function Ne(){return this._identityCalculated||(this._identity=!(this.props[0]!==1||this.props[1]!==0||this.props[2]!==0||this.props[3]!==0||this.props[4]!==0||this.props[5]!==1||this.props[6]!==0||this.props[7]!==0||this.props[8]!==0||this.props[9]!==0||this.props[10]!==1||this.props[11]!==0||this.props[12]!==0||this.props[13]!==0||this.props[14]!==0||this.props[15]!==1),this._identityCalculated=!0),this._identity}function qe(gt){for(var Tt=0;Tt<16;){if(gt.props[Tt]!==this.props[Tt])return!1;Tt+=1}return!0}function Xe(gt){var Tt;for(Tt=0;Tt<16;Tt+=1)gt.props[Tt]=this.props[Tt];return gt}function Ye(gt){var Tt;for(Tt=0;Tt<16;Tt+=1)this.props[Tt]=gt[Tt]}function Qe(gt,Tt,Ct){return{x:gt*this.props[0]+Tt*this.props[4]+Ct*this.props[8]+this.props[12],y:gt*this.props[1]+Tt*this.props[5]+Ct*this.props[9]+this.props[13],z:gt*this.props[2]+Tt*this.props[6]+Ct*this.props[10]+this.props[14]}}function rt(gt,Tt,Ct){return gt*this.props[0]+Tt*this.props[4]+Ct*this.props[8]+this.props[12]}function ot(gt,Tt,Ct){return gt*this.props[1]+Tt*this.props[5]+Ct*this.props[9]+this.props[13]}function ct(gt,Tt,Ct){return gt*this.props[2]+Tt*this.props[6]+Ct*this.props[10]+this.props[14]}function mt(){var gt=this.props[0]*this.props[5]-this.props[1]*this.props[4],Tt=this.props[5]/gt,Ct=-this.props[1]/gt,Ft=-this.props[4]/gt,sn=this.props[0]/gt,cn=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/gt,en=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/gt,yn=new Matrix;return yn.props[0]=Tt,yn.props[1]=Ct,yn.props[4]=Ft,yn.props[5]=sn,yn.props[12]=cn,yn.props[13]=en,yn}function _t(gt){var Tt=this.getInverseMatrix();return Tt.applyToPointArray(gt[0],gt[1],gt[2]||0)}function Lt(gt){var Tt,Ct=gt.length,Ft=[];for(Tt=0;Tt<Ct;Tt+=1)Ft[Tt]=_t(gt[Tt]);return Ft}function Vt(gt,Tt,Ct){var Ft=createTypedArray("float32",6);if(this.isIdentity())Ft[0]=gt[0],Ft[1]=gt[1],Ft[2]=Tt[0],Ft[3]=Tt[1],Ft[4]=Ct[0],Ft[5]=Ct[1];else{var sn=this.props[0],cn=this.props[1],en=this.props[4],yn=this.props[5],Pn=this.props[12],tr=this.props[13];Ft[0]=gt[0]*sn+gt[1]*en+Pn,Ft[1]=gt[0]*cn+gt[1]*yn+tr,Ft[2]=Tt[0]*sn+Tt[1]*en+Pn,Ft[3]=Tt[0]*cn+Tt[1]*yn+tr,Ft[4]=Ct[0]*sn+Ct[1]*en+Pn,Ft[5]=Ct[0]*cn+Ct[1]*yn+tr}return Ft}function Gt(gt,Tt,Ct){var Ft;return this.isIdentity()?Ft=[gt,Tt,Ct]:Ft=[gt*this.props[0]+Tt*this.props[4]+Ct*this.props[8]+this.props[12],gt*this.props[1]+Tt*this.props[5]+Ct*this.props[9]+this.props[13],gt*this.props[2]+Tt*this.props[6]+Ct*this.props[10]+this.props[14]],Ft}function $t(gt,Tt){if(this.isIdentity())return gt+","+Tt;var Ct=this.props;return Math.round((gt*Ct[0]+Tt*Ct[4]+Ct[12])*100)/100+","+Math.round((gt*Ct[1]+Tt*Ct[5]+Ct[13])*100)/100}function Qt(){for(var gt=0,Tt=this.props,Ct="matrix3d(",Ft=1e4;gt<16;)Ct+=$(Tt[gt]*Ft)/Ft,Ct+=gt===15?")":",",gt+=1;return Ct}function vt(gt){var Tt=1e4;return gt<1e-6&&gt>0||gt>-1e-6&&gt<0?$(gt*Tt)/Tt:gt}function It(){var gt=this.props,Tt=vt(gt[0]),Ct=vt(gt[1]),Ft=vt(gt[4]),sn=vt(gt[5]),cn=vt(gt[12]),en=vt(gt[13]);return"matrix("+Tt+","+Ct+","+Ft+","+sn+","+cn+","+en+")"}return function(){this.reset=ee,this.rotate=re,this.rotateX=ae,this.rotateY=xe,this.rotateZ=le,this.skew=ve,this.skewFromAxis=Se,this.shear=fe,this.scale=Ee,this.setTransform=Ce,this.translate=Ie,this.transform=De,this.multiply=Be,this.applyToPoint=Qe,this.applyToX=rt,this.applyToY=ot,this.applyToZ=ct,this.applyToPointArray=Gt,this.applyToTriplePoints=Vt,this.applyToPointStringified=$t,this.toCSS=Qt,this.to2dCSS=It,this.clone=Xe,this.cloneFromProps=Ye,this.equals=qe,this.inversePoints=Lt,this.inversePoint=_t,this.getInverseMatrix=mt,this._t=this.transform,this.isIdentity=Ne,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();function _typeof$3(H){"@babel/helpers - typeof";return _typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},_typeof$3(H)}var lottie={};function setLocation(H){setLocationHref(H)}function searchAnimations(){animationManager.searchAnimations()}function setSubframeRendering(H){setSubframeEnabled(H)}function setPrefix(H){setIdPrefix(H)}function loadAnimation(H){return animationManager.loadAnimation(H)}function setQuality(H){if(typeof H=="string")switch(H){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10);break}else!isNaN(H)&&H>1&&setDefaultCurveSegments(H)}function inBrowser(){return typeof navigator<"u"}function installPlugin(H,_){H==="expressions"&&setExpressionsPlugin(_)}function getFactory(H){switch(H){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.13.0";function checkReady(){document.readyState==="complete"&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(H){for(var _=queryString.split("&"),b=0;b<_.length;b+=1){var $=_[b].split("=");if(decodeURIComponent($[0])==H)return decodeURIComponent($[1])}return null}var queryString="";{var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{_typeof$3(exports)!=="object"&&(window.bodymovin=lottie)}catch(H){}var ShapeModifiers=function(){var H={},_={};H.registerModifier=b,H.getModifier=$;function b(ee,re){_[ee]||(_[ee]=re)}function $(ee,re,ae){return new _[ee](re,ae)}return H}();function ShapeModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(H){if(!this.closed){H.sh.container.addDynamicProperty(H.sh);var _={shape:H.sh,data:H,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(_),this.addShapeToModifier(_),this._isAnimated&&H.setAsAnimated()}},ShapeModifier.prototype.init=function(H,_){this.shapes=[],this.elem=H,this.initDynamicPropertyContainer(H),this.initModifierProperties(H,_),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier);function TrimModifier(){}extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(H,_){this.s=PropertyFactory.getProp(H,_.s,0,.01,this),this.e=PropertyFactory.getProp(H,_.e,0,.01,this),this.o=PropertyFactory.getProp(H,_.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=_.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(H){H.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(H,_,b,$,ee){var re=[];_<=1?re.push({s:H,e:_}):H>=1?re.push({s:H-1,e:_-1}):(re.push({s:H,e:1}),re.push({s:0,e:_-1}));var ae=[],xe,le=re.length,fe;for(xe=0;xe<le;xe+=1)if(fe=re[xe],!(fe.e*ee<$||fe.s*ee>$+b)){var ve,Se;fe.s*ee<=$?ve=0:ve=(fe.s*ee-$)/b,fe.e*ee>=$+b?Se=1:Se=(fe.e*ee-$)/b,ae.push([ve,Se])}return ae.length||ae.push([0,0]),ae},TrimModifier.prototype.releasePathsData=function(H){var _,b=H.length;for(_=0;_<b;_+=1)segmentsLengthPool.release(H[_]);return H.length=0,H},TrimModifier.prototype.processShapes=function(H){var _,b;if(this._mdf||H){var $=this.o.v%360/360;if($<0&&($+=1),this.s.v>1?_=1+$:this.s.v<0?_=0+$:_=this.s.v+$,this.e.v>1?b=1+$:this.e.v<0?b=0+$:b=this.e.v+$,_>b){var ee=_;_=b,b=ee}_=Math.round(_*1e4)*1e-4,b=Math.round(b*1e4)*1e-4,this.sValue=_,this.eValue=b}else _=this.sValue,b=this.eValue;var re,ae,xe=this.shapes.length,le,fe,ve,Se,Ee,Ce=0;if(b===_)for(ae=0;ae<xe;ae+=1)this.shapes[ae].localShapeCollection.releaseShapes(),this.shapes[ae].shape._mdf=!0,this.shapes[ae].shape.paths=this.shapes[ae].localShapeCollection,this._mdf&&(this.shapes[ae].pathsData.length=0);else if(b===1&&_===0||b===0&&_===1){if(this._mdf)for(ae=0;ae<xe;ae+=1)this.shapes[ae].pathsData.length=0,this.shapes[ae].shape._mdf=!0}else{var Ie=[],De,Be;for(ae=0;ae<xe;ae+=1)if(De=this.shapes[ae],!De.shape._mdf&&!this._mdf&&!H&&this.m!==2)De.shape.paths=De.localShapeCollection;else{if(re=De.shape.paths,fe=re._length,Ee=0,!De.shape._mdf&&De.pathsData.length)Ee=De.totalShapeLength;else{for(ve=this.releasePathsData(De.pathsData),le=0;le<fe;le+=1)Se=bez.getSegmentsLength(re.shapes[le]),ve.push(Se),Ee+=Se.totalLength;De.totalShapeLength=Ee,De.pathsData=ve}Ce+=Ee,De.shape._mdf=!0}var Ne=_,qe=b,Xe=0,Ye;for(ae=xe-1;ae>=0;ae-=1)if(De=this.shapes[ae],De.shape._mdf){for(Be=De.localShapeCollection,Be.releaseShapes(),this.m===2&&xe>1?(Ye=this.calculateShapeEdges(_,b,De.totalShapeLength,Xe,Ce),Xe+=De.totalShapeLength):Ye=[[Ne,qe]],fe=Ye.length,le=0;le<fe;le+=1){Ne=Ye[le][0],qe=Ye[le][1],Ie.length=0,qe<=1?Ie.push({s:De.totalShapeLength*Ne,e:De.totalShapeLength*qe}):Ne>=1?Ie.push({s:De.totalShapeLength*(Ne-1),e:De.totalShapeLength*(qe-1)}):(Ie.push({s:De.totalShapeLength*Ne,e:De.totalShapeLength}),Ie.push({s:0,e:De.totalShapeLength*(qe-1)}));var Qe=this.addShapes(De,Ie[0]);if(Ie[0].s!==Ie[0].e){if(Ie.length>1){var rt=De.shape.paths.shapes[De.shape.paths._length-1];if(rt.c){var ot=Qe.pop();this.addPaths(Qe,Be),Qe=this.addShapes(De,Ie[1],ot)}else this.addPaths(Qe,Be),Qe=this.addShapes(De,Ie[1])}this.addPaths(Qe,Be)}}De.shape.paths=Be}}},TrimModifier.prototype.addPaths=function(H,_){var b,$=H.length;for(b=0;b<$;b+=1)_.addShape(H[b])},TrimModifier.prototype.addSegment=function(H,_,b,$,ee,re,ae){ee.setXYAt(_[0],_[1],"o",re),ee.setXYAt(b[0],b[1],"i",re+1),ae&&ee.setXYAt(H[0],H[1],"v",re),ee.setXYAt($[0],$[1],"v",re+1)},TrimModifier.prototype.addSegmentFromArray=function(H,_,b,$){_.setXYAt(H[1],H[5],"o",b),_.setXYAt(H[2],H[6],"i",b+1),$&&_.setXYAt(H[0],H[4],"v",b),_.setXYAt(H[3],H[7],"v",b+1)},TrimModifier.prototype.addShapes=function(H,_,b){var $=H.pathsData,ee=H.shape.paths.shapes,re,ae=H.shape.paths._length,xe,le,fe=0,ve,Se,Ee,Ce,Ie=[],De,Be=!0;for(b?(Se=b._length,De=b._length):(b=shapePool.newElement(),Se=0,De=0),Ie.push(b),re=0;re<ae;re+=1){for(Ee=$[re].lengths,b.c=ee[re].c,le=ee[re].c?Ee.length:Ee.length+1,xe=1;xe<le;xe+=1)if(ve=Ee[xe-1],fe+ve.addedLength<_.s)fe+=ve.addedLength,b.c=!1;else if(fe>_.e){b.c=!1;break}else _.s<=fe&&_.e>=fe+ve.addedLength?(this.addSegment(ee[re].v[xe-1],ee[re].o[xe-1],ee[re].i[xe],ee[re].v[xe],b,Se,Be),Be=!1):(Ce=bez.getNewSegment(ee[re].v[xe-1],ee[re].v[xe],ee[re].o[xe-1],ee[re].i[xe],(_.s-fe)/ve.addedLength,(_.e-fe)/ve.addedLength,Ee[xe-1]),this.addSegmentFromArray(Ce,b,Se,Be),Be=!1,b.c=!1),fe+=ve.addedLength,Se+=1;if(ee[re].c&&Ee.length){if(ve=Ee[xe-1],fe<=_.e){var Ne=Ee[xe-1].addedLength;_.s<=fe&&_.e>=fe+Ne?(this.addSegment(ee[re].v[xe-1],ee[re].o[xe-1],ee[re].i[0],ee[re].v[0],b,Se,Be),Be=!1):(Ce=bez.getNewSegment(ee[re].v[xe-1],ee[re].v[0],ee[re].o[xe-1],ee[re].i[0],(_.s-fe)/Ne,(_.e-fe)/Ne,Ee[xe-1]),this.addSegmentFromArray(Ce,b,Se,Be),Be=!1,b.c=!1)}else b.c=!1;fe+=ve.addedLength,Se+=1}if(b._length&&(b.setXYAt(b.v[De][0],b.v[De][1],"i",De),b.setXYAt(b.v[b._length-1][0],b.v[b._length-1][1],"o",b._length-1)),fe>_.e)break;re<ae-1&&(b=shapePool.newElement(),Be=!0,Ie.push(b),Se=0)}return Ie};function PuckerAndBloatModifier(){}extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(H,_){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(H,_.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(H,_){var b=_/100,$=[0,0],ee=H._length,re=0;for(re=0;re<ee;re+=1)$[0]+=H.v[re][0],$[1]+=H.v[re][1];$[0]/=ee,$[1]/=ee;var ae=shapePool.newElement();ae.c=H.c;var xe,le,fe,ve,Se,Ee;for(re=0;re<ee;re+=1)xe=H.v[re][0]+($[0]-H.v[re][0])*b,le=H.v[re][1]+($[1]-H.v[re][1])*b,fe=H.o[re][0]+($[0]-H.o[re][0])*-b,ve=H.o[re][1]+($[1]-H.o[re][1])*-b,Se=H.i[re][0]+($[0]-H.i[re][0])*-b,Ee=H.i[re][1]+($[1]-H.i[re][1])*-b,ae.setTripleAt(xe,le,fe,ve,Se,Ee,re);return ae},PuckerAndBloatModifier.prototype.processShapes=function(H){var _,b,$=this.shapes.length,ee,re,ae=this.amount.v;if(ae!==0){var xe,le;for(b=0;b<$;b+=1){if(xe=this.shapes[b],le=xe.localShapeCollection,!(!xe.shape._mdf&&!this._mdf&&!H))for(le.releaseShapes(),xe.shape._mdf=!0,_=xe.shape.paths.shapes,re=xe.shape.paths._length,ee=0;ee<re;ee+=1)le.addShape(this.processPath(_[ee],ae));xe.shape.paths=xe.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=function(){var H=[0,0];function _(le){var fe=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||fe,this.a&&le.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&le.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&le.skewFromAxis(-this.sk.v,this.sa.v),this.r?le.rotate(-this.r.v):le.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?le.translate(this.px.v,this.py.v,-this.pz.v):le.translate(this.px.v,this.py.v,0):le.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}function b(le){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||le){var fe;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var ve,Se;if(fe=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(ve=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/fe,0),Se=this.p.getValueAtTime(this.p.keyframes[0].t/fe,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(ve=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/fe,0),Se=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/fe,0)):(ve=this.p.pv,Se=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/fe,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){ve=[],Se=[];var Ee=this.px,Ce=this.py;Ee._caching.lastFrame+Ee.offsetTime<=Ee.keyframes[0].t?(ve[0]=Ee.getValueAtTime((Ee.keyframes[0].t+.01)/fe,0),ve[1]=Ce.getValueAtTime((Ce.keyframes[0].t+.01)/fe,0),Se[0]=Ee.getValueAtTime(Ee.keyframes[0].t/fe,0),Se[1]=Ce.getValueAtTime(Ce.keyframes[0].t/fe,0)):Ee._caching.lastFrame+Ee.offsetTime>=Ee.keyframes[Ee.keyframes.length-1].t?(ve[0]=Ee.getValueAtTime(Ee.keyframes[Ee.keyframes.length-1].t/fe,0),ve[1]=Ce.getValueAtTime(Ce.keyframes[Ce.keyframes.length-1].t/fe,0),Se[0]=Ee.getValueAtTime((Ee.keyframes[Ee.keyframes.length-1].t-.01)/fe,0),Se[1]=Ce.getValueAtTime((Ce.keyframes[Ce.keyframes.length-1].t-.01)/fe,0)):(ve=[Ee.pv,Ce.pv],Se[0]=Ee.getValueAtTime((Ee._caching.lastFrame+Ee.offsetTime-.01)/fe,Ee.offsetTime),Se[1]=Ce.getValueAtTime((Ce._caching.lastFrame+Ce.offsetTime-.01)/fe,Ce.offsetTime))}else Se=H,ve=Se;this.v.rotate(-Math.atan2(ve[1]-Se[1],ve[0]-Se[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}}function $(){if(this.appliedTransformations=0,this.pre.reset(),!this.a.effectsSequence.length)this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1;else return;if(!this.s.effectsSequence.length)this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2;else return;if(this.sk)if(!this.sk.effectsSequence.length&&!this.sa.effectsSequence.length)this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3;else return;this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):!this.rz.effectsSequence.length&&!this.ry.effectsSequence.length&&!this.rx.effectsSequence.length&&!this.or.effectsSequence.length&&(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}function ee(){}function re(le){this._addDynamicProperty(le),this.elem.addDynamicProperty(le),this._isDirty=!0}function ae(le,fe,ve){if(this.elem=le,this.frameId=-1,this.propType="transform",this.data=fe,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(ve||le),fe.p&&fe.p.s?(this.px=PropertyFactory.getProp(le,fe.p.x,0,0,this),this.py=PropertyFactory.getProp(le,fe.p.y,0,0,this),fe.p.z&&(this.pz=PropertyFactory.getProp(le,fe.p.z,0,0,this))):this.p=PropertyFactory.getProp(le,fe.p||{k:[0,0,0]},1,0,this),fe.rx){if(this.rx=PropertyFactory.getProp(le,fe.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(le,fe.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(le,fe.rz,0,degToRads,this),fe.or.k[0].ti){var Se,Ee=fe.or.k.length;for(Se=0;Se<Ee;Se+=1)fe.or.k[Se].to=null,fe.or.k[Se].ti=null}this.or=PropertyFactory.getProp(le,fe.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(le,fe.r||{k:0},0,degToRads,this);fe.sk&&(this.sk=PropertyFactory.getProp(le,fe.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(le,fe.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(le,fe.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(le,fe.s||{k:[100,100,100]},1,.01,this),fe.o?this.o=PropertyFactory.getProp(le,fe.o,0,.01,le):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}ae.prototype={applyToMatrix:_,getValue:b,precalculateMatrix:$,autoOrient:ee},extendPrototype([DynamicPropertyContainer],ae),ae.prototype.addDynamicProperty=re,ae.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty;function xe(le,fe,ve){return new ae(le,fe,ve)}return{getTransformProperty:xe}}();function RepeaterModifier(){}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(H,_){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(H,_.c,0,null,this),this.o=PropertyFactory.getProp(H,_.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(H,_.tr,this),this.so=PropertyFactory.getProp(H,_.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(H,_.tr.eo,0,.01,this),this.data=_,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(H,_,b,$,ee,re){var ae=re?-1:1,xe=$.s.v[0]+(1-$.s.v[0])*(1-ee),le=$.s.v[1]+(1-$.s.v[1])*(1-ee);H.translate($.p.v[0]*ae*ee,$.p.v[1]*ae*ee,$.p.v[2]),_.translate(-$.a.v[0],-$.a.v[1],$.a.v[2]),_.rotate(-$.r.v*ae*ee),_.translate($.a.v[0],$.a.v[1],$.a.v[2]),b.translate(-$.a.v[0],-$.a.v[1],$.a.v[2]),b.scale(re?1/xe:xe,re?1/le:le),b.translate($.a.v[0],$.a.v[1],$.a.v[2])},RepeaterModifier.prototype.init=function(H,_,b,$){for(this.elem=H,this.arr=_,this.pos=b,this.elemsData=$,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(H),this.initModifierProperties(H,_[b]);b>0;)b-=1,this._elements.unshift(_[b]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(H){var _,b=H.length;for(_=0;_<b;_+=1)H[_]._processed=!1,H[_].ty==="gr"&&this.resetElements(H[_].it)},RepeaterModifier.prototype.cloneElements=function(H){var _=JSON.parse(JSON.stringify(H));return this.resetElements(_),_},RepeaterModifier.prototype.changeGroupRender=function(H,_){var b,$=H.length;for(b=0;b<$;b+=1)H[b]._render=_,H[b].ty==="gr"&&this.changeGroupRender(H[b].it,_)},RepeaterModifier.prototype.processShapes=function(H){var _,b,$,ee,re,ae=!1;if(this._mdf||H){var xe=Math.ceil(this.c.v);if(this._groups.length<xe){for(;this._groups.length<xe;){var le={it:this.cloneElements(this._elements),ty:"gr"};le.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,le),this._groups.splice(0,0,le),this._currentCopies+=1}this.elem.reloadShapes(),ae=!0}re=0;var fe;for($=0;$<=this._groups.length-1;$+=1){if(fe=re<xe,this._groups[$]._render=fe,this.changeGroupRender(this._groups[$].it,fe),!fe){var ve=this.elemsData[$].it,Se=ve[ve.length-1];Se.transform.op.v!==0?(Se.transform.op._mdf=!0,Se.transform.op.v=0):Se.transform.op._mdf=!1}re+=1}this._currentCopies=xe;var Ee=this.o.v,Ce=Ee%1,Ie=Ee>0?Math.floor(Ee):Math.ceil(Ee),De=this.pMatrix.props,Be=this.rMatrix.props,Ne=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var qe=0;if(Ee>0){for(;qe<Ie;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),qe+=1;Ce&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,Ce,!1),qe+=Ce)}else if(Ee<0){for(;qe>Ie;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),qe-=1;Ce&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-Ce,!0),qe-=Ce)}$=this.data.m===1?0:this._currentCopies-1,ee=this.data.m===1?1:-1,re=this._currentCopies;for(var Xe,Ye;re;){if(_=this.elemsData[$].it,b=_[_.length-1].transform.mProps.v.props,Ye=b.length,_[_.length-1].transform.mProps._mdf=!0,_[_.length-1].transform.op._mdf=!0,_[_.length-1].transform.op.v=this._currentCopies===1?this.so.v:this.so.v+(this.eo.v-this.so.v)*($/(this._currentCopies-1)),qe!==0){for(($!==0&&ee===1||$!==this._currentCopies-1&&ee===-1)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(Be[0],Be[1],Be[2],Be[3],Be[4],Be[5],Be[6],Be[7],Be[8],Be[9],Be[10],Be[11],Be[12],Be[13],Be[14],Be[15]),this.matrix.transform(Ne[0],Ne[1],Ne[2],Ne[3],Ne[4],Ne[5],Ne[6],Ne[7],Ne[8],Ne[9],Ne[10],Ne[11],Ne[12],Ne[13],Ne[14],Ne[15]),this.matrix.transform(De[0],De[1],De[2],De[3],De[4],De[5],De[6],De[7],De[8],De[9],De[10],De[11],De[12],De[13],De[14],De[15]),Xe=0;Xe<Ye;Xe+=1)b[Xe]=this.matrix.props[Xe];this.matrix.reset()}else for(this.matrix.reset(),Xe=0;Xe<Ye;Xe+=1)b[Xe]=this.matrix.props[Xe];qe+=1,re-=1,$+=ee}}else for(re=this._currentCopies,$=0,ee=1;re;)_=this.elemsData[$].it,b=_[_.length-1].transform.mProps.v.props,_[_.length-1].transform.mProps._mdf=!1,_[_.length-1].transform.op._mdf=!1,re-=1,$+=ee;return ae},RepeaterModifier.prototype.addShape=function(){};function RoundCornersModifier(){}extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(H,_){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(H,_.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(H,_){var b=shapePool.newElement();b.c=H.c;var $,ee=H._length,re,ae,xe,le,fe,ve,Se=0,Ee,Ce,Ie,De,Be,Ne;for($=0;$<ee;$+=1)re=H.v[$],xe=H.o[$],ae=H.i[$],re[0]===xe[0]&&re[1]===xe[1]&&re[0]===ae[0]&&re[1]===ae[1]?($===0||$===ee-1)&&!H.c?(b.setTripleAt(re[0],re[1],xe[0],xe[1],ae[0],ae[1],Se),Se+=1):($===0?le=H.v[ee-1]:le=H.v[$-1],fe=Math.sqrt(Math.pow(re[0]-le[0],2)+Math.pow(re[1]-le[1],2)),ve=fe?Math.min(fe/2,_)/fe:0,Be=re[0]+(le[0]-re[0])*ve,Ee=Be,Ne=re[1]-(re[1]-le[1])*ve,Ce=Ne,Ie=Ee-(Ee-re[0])*roundCorner,De=Ce-(Ce-re[1])*roundCorner,b.setTripleAt(Ee,Ce,Ie,De,Be,Ne,Se),Se+=1,$===ee-1?le=H.v[0]:le=H.v[$+1],fe=Math.sqrt(Math.pow(re[0]-le[0],2)+Math.pow(re[1]-le[1],2)),ve=fe?Math.min(fe/2,_)/fe:0,Ie=re[0]+(le[0]-re[0])*ve,Ee=Ie,De=re[1]+(le[1]-re[1])*ve,Ce=De,Be=Ee-(Ee-re[0])*roundCorner,Ne=Ce-(Ce-re[1])*roundCorner,b.setTripleAt(Ee,Ce,Ie,De,Be,Ne,Se),Se+=1):(b.setTripleAt(H.v[$][0],H.v[$][1],H.o[$][0],H.o[$][1],H.i[$][0],H.i[$][1],Se),Se+=1);return b},RoundCornersModifier.prototype.processShapes=function(H){var _,b,$=this.shapes.length,ee,re,ae=this.rd.v;if(ae!==0){var xe,le;for(b=0;b<$;b+=1){if(xe=this.shapes[b],le=xe.localShapeCollection,!(!xe.shape._mdf&&!this._mdf&&!H))for(le.releaseShapes(),xe.shape._mdf=!0,_=xe.shape.paths.shapes,re=xe.shape.paths._length,ee=0;ee<re;ee+=1)le.addShape(this.processPath(_[ee],ae));xe.shape.paths=xe.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function floatEqual(H,_){return Math.abs(H-_)*1e5<=Math.min(Math.abs(H),Math.abs(_))}function floatZero(H){return Math.abs(H)<=1e-5}function lerp(H,_,b){return H*(1-b)+_*b}function lerpPoint(H,_,b){return[lerp(H[0],_[0],b),lerp(H[1],_[1],b)]}function quadRoots(H,_,b){if(H===0)return[];var $=_*_-4*H*b;if($<0)return[];var ee=-_/(2*H);if($===0)return[ee];var re=Math.sqrt($)/(2*H);return[ee-re,ee+re]}function polynomialCoefficients(H,_,b,$){return[-H+3*_-3*b+$,3*H-6*_+3*b,-3*H+3*_,H]}function singlePoint(H){return new PolynomialBezier(H,H,H,H,!1)}function PolynomialBezier(H,_,b,$,ee){ee&&pointEqual(H,_)&&(_=lerpPoint(H,$,1/3)),ee&&pointEqual(b,$)&&(b=lerpPoint(H,$,2/3));var re=polynomialCoefficients(H[0],_[0],b[0],$[0]),ae=polynomialCoefficients(H[1],_[1],b[1],$[1]);this.a=[re[0],ae[0]],this.b=[re[1],ae[1]],this.c=[re[2],ae[2]],this.d=[re[3],ae[3]],this.points=[H,_,b,$]}PolynomialBezier.prototype.point=function(H){return[((this.a[0]*H+this.b[0])*H+this.c[0])*H+this.d[0],((this.a[1]*H+this.b[1])*H+this.c[1])*H+this.d[1]]},PolynomialBezier.prototype.derivative=function(H){return[(3*H*this.a[0]+2*this.b[0])*H+this.c[0],(3*H*this.a[1]+2*this.b[1])*H+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(H){var _=this.derivative(H);return Math.atan2(_[1],_[0])},PolynomialBezier.prototype.normalAngle=function(H){var _=this.derivative(H);return Math.atan2(_[0],_[1])},PolynomialBezier.prototype.inflectionPoints=function(){var H=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(H))return[];var _=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/H,b=_*_-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/H;if(b<0)return[];var $=Math.sqrt(b);return floatZero($)?$>0&&$<1?[_]:[]:[_-$,_+$].filter(function(ee){return ee>0&&ee<1})},PolynomialBezier.prototype.split=function(H){if(H<=0)return[singlePoint(this.points[0]),this];if(H>=1)return[this,singlePoint(this.points[this.points.length-1])];var _=lerpPoint(this.points[0],this.points[1],H),b=lerpPoint(this.points[1],this.points[2],H),$=lerpPoint(this.points[2],this.points[3],H),ee=lerpPoint(_,b,H),re=lerpPoint(b,$,H),ae=lerpPoint(ee,re,H);return[new PolynomialBezier(this.points[0],_,ee,ae,!0),new PolynomialBezier(ae,re,$,this.points[3],!0)]};function extrema(H,_){var b=H.points[0][_],$=H.points[H.points.length-1][_];if(b>$){var ee=$;$=b,b=ee}for(var re=quadRoots(3*H.a[_],2*H.b[_],H.c[_]),ae=0;ae<re.length;ae+=1)if(re[ae]>0&&re[ae]<1){var xe=H.point(re[ae])[_];xe<b?b=xe:xe>$&&($=xe)}return{min:b,max:$}}PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var H=this.bounds();return{left:H.x.min,right:H.x.max,top:H.y.min,bottom:H.y.max,width:H.x.max-H.x.min,height:H.y.max-H.y.min,cx:(H.x.max+H.x.min)/2,cy:(H.y.max+H.y.min)/2}};function intersectData(H,_,b){var $=H.boundingBox();return{cx:$.cx,cy:$.cy,width:$.width,height:$.height,bez:H,t:(_+b)/2,t1:_,t2:b}}function splitData(H){var _=H.bez.split(.5);return[intersectData(_[0],H.t1,H.t),intersectData(_[1],H.t,H.t2)]}function boxIntersect(H,_){return Math.abs(H.cx-_.cx)*2<H.width+_.width&&Math.abs(H.cy-_.cy)*2<H.height+_.height}function intersectsImpl(H,_,b,$,ee,re){if(boxIntersect(H,_)){if(b>=re||H.width<=$&&H.height<=$&&_.width<=$&&_.height<=$){ee.push([H.t,_.t]);return}var ae=splitData(H),xe=splitData(_);intersectsImpl(ae[0],xe[0],b+1,$,ee,re),intersectsImpl(ae[0],xe[1],b+1,$,ee,re),intersectsImpl(ae[1],xe[0],b+1,$,ee,re),intersectsImpl(ae[1],xe[1],b+1,$,ee,re)}}PolynomialBezier.prototype.intersections=function(H,_,b){_===void 0&&(_=2),b===void 0&&(b=7);var $=[];return intersectsImpl(intersectData(this,0,1),intersectData(H,0,1),0,_,$,b),$},PolynomialBezier.shapeSegment=function(H,_){var b=(_+1)%H.length();return new PolynomialBezier(H.v[_],H.o[_],H.i[b],H.v[b],!0)},PolynomialBezier.shapeSegmentInverted=function(H,_){var b=(_+1)%H.length();return new PolynomialBezier(H.v[b],H.i[b],H.o[_],H.v[_],!0)};function crossProduct(H,_){return[H[1]*_[2]-H[2]*_[1],H[2]*_[0]-H[0]*_[2],H[0]*_[1]-H[1]*_[0]]}function lineIntersection(H,_,b,$){var ee=[H[0],H[1],1],re=[_[0],_[1],1],ae=[b[0],b[1],1],xe=[$[0],$[1],1],le=crossProduct(crossProduct(ee,re),crossProduct(ae,xe));return floatZero(le[2])?null:[le[0]/le[2],le[1]/le[2]]}function polarOffset(H,_,b){return[H[0]+Math.cos(_)*b,H[1]-Math.sin(_)*b]}function pointDistance(H,_){return Math.hypot(H[0]-_[0],H[1]-_[1])}function pointEqual(H,_){return floatEqual(H[0],_[0])&&floatEqual(H[1],_[1])}function ZigZagModifier(){}extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(H,_){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(H,_.s,0,null,this),this.frequency=PropertyFactory.getProp(H,_.r,0,null,this),this.pointsType=PropertyFactory.getProp(H,_.pt,0,null,this),this._isAnimated=this.amplitude.effectsSequence.length!==0||this.frequency.effectsSequence.length!==0||this.pointsType.effectsSequence.length!==0};function setPoint(H,_,b,$,ee,re,ae){var xe=b-Math.PI/2,le=b+Math.PI/2,fe=_[0]+Math.cos(b)*$*ee,ve=_[1]-Math.sin(b)*$*ee;H.setTripleAt(fe,ve,fe+Math.cos(xe)*re,ve-Math.sin(xe)*re,fe+Math.cos(le)*ae,ve-Math.sin(le)*ae,H.length())}function getPerpendicularVector(H,_){var b=[_[0]-H[0],_[1]-H[1]],$=-Math.PI*.5,ee=[Math.cos($)*b[0]-Math.sin($)*b[1],Math.sin($)*b[0]+Math.cos($)*b[1]];return ee}function getProjectingAngle(H,_){var b=_===0?H.length()-1:_-1,$=(_+1)%H.length(),ee=H.v[b],re=H.v[$],ae=getPerpendicularVector(ee,re);return Math.atan2(0,1)-Math.atan2(ae[1],ae[0])}function zigZagCorner(H,_,b,$,ee,re,ae){var xe=getProjectingAngle(_,b),le=_.v[b%_._length],fe=_.v[b===0?_._length-1:b-1],ve=_.v[(b+1)%_._length],Se=re===2?Math.sqrt(Math.pow(le[0]-fe[0],2)+Math.pow(le[1]-fe[1],2)):0,Ee=re===2?Math.sqrt(Math.pow(le[0]-ve[0],2)+Math.pow(le[1]-ve[1],2)):0;setPoint(H,_.v[b%_._length],xe,ae,$,Ee/((ee+1)*2),Se/((ee+1)*2))}function zigZagSegment(H,_,b,$,ee,re){for(var ae=0;ae<$;ae+=1){var xe=(ae+1)/($+1),le=ee===2?Math.sqrt(Math.pow(_.points[3][0]-_.points[0][0],2)+Math.pow(_.points[3][1]-_.points[0][1],2)):0,fe=_.normalAngle(xe),ve=_.point(xe);setPoint(H,ve,fe,re,b,le/(($+1)*2),le/(($+1)*2)),re=-re}return re}ZigZagModifier.prototype.processPath=function(H,_,b,$){var ee=H._length,re=shapePool.newElement();if(re.c=H.c,H.c||(ee-=1),ee===0)return re;var ae=-1,xe=PolynomialBezier.shapeSegment(H,0);zigZagCorner(re,H,0,_,b,$,ae);for(var le=0;le<ee;le+=1)ae=zigZagSegment(re,xe,_,b,$,-ae),le===ee-1&&!H.c?xe=null:xe=PolynomialBezier.shapeSegment(H,(le+1)%ee),zigZagCorner(re,H,le+1,_,b,$,ae);return re},ZigZagModifier.prototype.processShapes=function(H){var _,b,$=this.shapes.length,ee,re,ae=this.amplitude.v,xe=Math.max(0,Math.round(this.frequency.v)),le=this.pointsType.v;if(ae!==0){var fe,ve;for(b=0;b<$;b+=1){if(fe=this.shapes[b],ve=fe.localShapeCollection,!(!fe.shape._mdf&&!this._mdf&&!H))for(ve.releaseShapes(),fe.shape._mdf=!0,_=fe.shape.paths.shapes,re=fe.shape.paths._length,ee=0;ee<re;ee+=1)ve.addShape(this.processPath(_[ee],ae,xe,le));fe.shape.paths=fe.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function linearOffset(H,_,b){var $=Math.atan2(_[0]-H[0],_[1]-H[1]);return[polarOffset(H,$,b),polarOffset(_,$,b)]}function offsetSegment(H,_){var b,$,ee,re,ae,xe,le;le=linearOffset(H.points[0],H.points[1],_),b=le[0],$=le[1],le=linearOffset(H.points[1],H.points[2],_),ee=le[0],re=le[1],le=linearOffset(H.points[2],H.points[3],_),ae=le[0],xe=le[1];var fe=lineIntersection(b,$,ee,re);fe===null&&(fe=$);var ve=lineIntersection(ae,xe,ee,re);return ve===null&&(ve=ae),new PolynomialBezier(b,fe,ve,xe)}function joinLines(H,_,b,$,ee){var re=_.points[3],ae=b.points[0];if($===3||pointEqual(re,ae))return re;if($===2){var xe=-_.tangentAngle(1),le=-b.tangentAngle(0)+Math.PI,fe=lineIntersection(re,polarOffset(re,xe+Math.PI/2,100),ae,polarOffset(ae,xe+Math.PI/2,100)),ve=fe?pointDistance(fe,re):pointDistance(re,ae)/2,Se=polarOffset(re,xe,2*ve*roundCorner);return H.setXYAt(Se[0],Se[1],"o",H.length()-1),Se=polarOffset(ae,le,2*ve*roundCorner),H.setTripleAt(ae[0],ae[1],ae[0],ae[1],Se[0],Se[1],H.length()),ae}var Ee=pointEqual(re,_.points[2])?_.points[0]:_.points[2],Ce=pointEqual(ae,b.points[1])?b.points[3]:b.points[1],Ie=lineIntersection(Ee,re,ae,Ce);return Ie&&pointDistance(Ie,re)<ee?(H.setTripleAt(Ie[0],Ie[1],Ie[0],Ie[1],Ie[0],Ie[1],H.length()),Ie):re}function getIntersection(H,_){var b=H.intersections(_);return b.length&&floatEqual(b[0][0],1)&&b.shift(),b.length?b[0]:null}function pruneSegmentIntersection(H,_){var b=H.slice(),$=_.slice(),ee=getIntersection(H[H.length-1],_[0]);return ee&&(b[H.length-1]=H[H.length-1].split(ee[0])[0],$[0]=_[0].split(ee[1])[1]),H.length>1&&_.length>1&&(ee=getIntersection(H[0],_[_.length-1]),ee)?[[H[0].split(ee[0])[0]],[_[_.length-1].split(ee[1])[1]]]:[b,$]}function pruneIntersections(H){for(var _,b=1;b<H.length;b+=1)_=pruneSegmentIntersection(H[b-1],H[b]),H[b-1]=_[0],H[b]=_[1];return H.length>1&&(_=pruneSegmentIntersection(H[H.length-1],H[0]),H[H.length-1]=_[0],H[0]=_[1]),H}function offsetSegmentSplit(H,_){var b=H.inflectionPoints(),$,ee,re,ae;if(b.length===0)return[offsetSegment(H,_)];if(b.length===1||floatEqual(b[1],1))return re=H.split(b[0]),$=re[0],ee=re[1],[offsetSegment($,_),offsetSegment(ee,_)];re=H.split(b[0]),$=re[0];var xe=(b[1]-b[0])/(1-b[0]);return re=re[1].split(xe),ae=re[0],ee=re[1],[offsetSegment($,_),offsetSegment(ae,_),offsetSegment(ee,_)]}function OffsetPathModifier(){}extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(H,_){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(H,_.a,0,null,this),this.miterLimit=PropertyFactory.getProp(H,_.ml,0,null,this),this.lineJoin=_.lj,this._isAnimated=this.amount.effectsSequence.length!==0},OffsetPathModifier.prototype.processPath=function(H,_,b,$){var ee=shapePool.newElement();ee.c=H.c;var re=H.length();H.c||(re-=1);var ae,xe,le,fe=[];for(ae=0;ae<re;ae+=1)le=PolynomialBezier.shapeSegment(H,ae),fe.push(offsetSegmentSplit(le,_));if(!H.c)for(ae=re-1;ae>=0;ae-=1)le=PolynomialBezier.shapeSegmentInverted(H,ae),fe.push(offsetSegmentSplit(le,_));fe=pruneIntersections(fe);var ve=null,Se=null;for(ae=0;ae<fe.length;ae+=1){var Ee=fe[ae];for(Se&&(ve=joinLines(ee,Se,Ee[0],b,$)),Se=Ee[Ee.length-1],xe=0;xe<Ee.length;xe+=1)le=Ee[xe],ve&&pointEqual(le.points[0],ve)?ee.setXYAt(le.points[1][0],le.points[1][1],"o",ee.length()-1):ee.setTripleAt(le.points[0][0],le.points[0][1],le.points[1][0],le.points[1][1],le.points[0][0],le.points[0][1],ee.length()),ee.setTripleAt(le.points[3][0],le.points[3][1],le.points[3][0],le.points[3][1],le.points[2][0],le.points[2][1],ee.length()),ve=le.points[3]}return fe.length&&joinLines(ee,Se,fe[0][0],b,$),ee},OffsetPathModifier.prototype.processShapes=function(H){var _,b,$=this.shapes.length,ee,re,ae=this.amount.v,xe=this.miterLimit.v,le=this.lineJoin;if(ae!==0){var fe,ve;for(b=0;b<$;b+=1){if(fe=this.shapes[b],ve=fe.localShapeCollection,!(!fe.shape._mdf&&!this._mdf&&!H))for(ve.releaseShapes(),fe.shape._mdf=!0,_=fe.shape.paths.shapes,re=fe.shape.paths._length,ee=0;ee<re;ee+=1)ve.addShape(this.processPath(_[ee],ae,le,xe));fe.shape.paths=fe.localShapeCollection}}this.dynamicProperties.length||(this._mdf=!1)};function getFontProperties(H){for(var _=H.fStyle?H.fStyle.split(" "):[],b="normal",$="normal",ee=_.length,re,ae=0;ae<ee;ae+=1)switch(re=_[ae].toLowerCase(),re){case"italic":$="italic";break;case"bold":b="700";break;case"black":b="900";break;case"medium":b="500";break;case"regular":case"normal":b="400";break;case"light":case"thin":b="200";break}return{style:$,weight:H.fWeight||b}}var FontManager=function(){var H=5e3,_={w:0,size:0,shapes:[],data:{shapes:[]}},b=[];b=b.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var $=127988,ee=917631,re=917601,ae=917626,xe=65039,le=8205,fe=127462,ve=127487,Se=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"];function Ee(vt){var It=vt.split(","),gt,Tt=It.length,Ct=[];for(gt=0;gt<Tt;gt+=1)It[gt]!=="sans-serif"&&It[gt]!=="monospace"&&Ct.push(It[gt]);return Ct.join(",")}function Ce(vt,It){var gt=createTag("span");gt.setAttribute("aria-hidden",!0),gt.style.fontFamily=It;var Tt=createTag("span");Tt.innerText="giItT1WQy@!-/#",gt.style.position="absolute",gt.style.left="-10000px",gt.style.top="-10000px",gt.style.fontSize="300px",gt.style.fontVariant="normal",gt.style.fontStyle="normal",gt.style.fontWeight="normal",gt.style.letterSpacing="0",gt.appendChild(Tt),document.body.appendChild(gt);var Ct=Tt.offsetWidth;return Tt.style.fontFamily=Ee(vt)+", "+It,{node:Tt,w:Ct,parent:gt}}function Ie(){var vt,It=this.fonts.length,gt,Tt,Ct=It;for(vt=0;vt<It;vt+=1)this.fonts[vt].loaded?Ct-=1:this.fonts[vt].fOrigin==="n"||this.fonts[vt].origin===0?this.fonts[vt].loaded=!0:(gt=this.fonts[vt].monoCase.node,Tt=this.fonts[vt].monoCase.w,gt.offsetWidth!==Tt?(Ct-=1,this.fonts[vt].loaded=!0):(gt=this.fonts[vt].sansCase.node,Tt=this.fonts[vt].sansCase.w,gt.offsetWidth!==Tt&&(Ct-=1,this.fonts[vt].loaded=!0)),this.fonts[vt].loaded&&(this.fonts[vt].sansCase.parent.parentNode.removeChild(this.fonts[vt].sansCase.parent),this.fonts[vt].monoCase.parent.parentNode.removeChild(this.fonts[vt].monoCase.parent)));Ct!==0&&Date.now()-this.initTime<H?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)}function De(vt,It){var gt=document.body&&It?"svg":"canvas",Tt,Ct=getFontProperties(vt);if(gt==="svg"){var Ft=createNS("text");Ft.style.fontSize="100px",Ft.setAttribute("font-family",vt.fFamily),Ft.setAttribute("font-style",Ct.style),Ft.setAttribute("font-weight",Ct.weight),Ft.textContent="1",vt.fClass?(Ft.style.fontFamily="inherit",Ft.setAttribute("class",vt.fClass)):Ft.style.fontFamily=vt.fFamily,It.appendChild(Ft),Tt=Ft}else{var sn=new OffscreenCanvas(500,500).getContext("2d");sn.font=Ct.style+" "+Ct.weight+" 100px "+vt.fFamily,Tt=sn}function cn(en){return gt==="svg"?(Tt.textContent=en,Tt.getComputedTextLength()):Tt.measureText(en).width}return{measureText:cn}}function Be(vt,It){if(!vt){this.isLoaded=!0;return}if(this.chars){this.isLoaded=!0,this.fonts=vt.list;return}if(!document.body){this.isLoaded=!0,vt.list.forEach(function(nr){nr.helper=De(nr),nr.cache={}}),this.fonts=vt.list;return}var gt=vt.list,Tt,Ct=gt.length,Ft=Ct;for(Tt=0;Tt<Ct;Tt+=1){var sn=!0,cn,en;if(gt[Tt].loaded=!1,gt[Tt].monoCase=Ce(gt[Tt].fFamily,"monospace"),gt[Tt].sansCase=Ce(gt[Tt].fFamily,"sans-serif"),!gt[Tt].fPath)gt[Tt].loaded=!0,Ft-=1;else if(gt[Tt].fOrigin==="p"||gt[Tt].origin===3){if(cn=document.querySelectorAll('style[f-forigin="p"][f-family="'+gt[Tt].fFamily+'"], style[f-origin="3"][f-family="'+gt[Tt].fFamily+'"]'),cn.length>0&&(sn=!1),sn){var yn=createTag("style");yn.setAttribute("f-forigin",gt[Tt].fOrigin),yn.setAttribute("f-origin",gt[Tt].origin),yn.setAttribute("f-family",gt[Tt].fFamily),yn.type="text/css",yn.innerText="@font-face {font-family: "+gt[Tt].fFamily+"; font-style: normal; src: url('"+gt[Tt].fPath+"');}",It.appendChild(yn)}}else if(gt[Tt].fOrigin==="g"||gt[Tt].origin===1){for(cn=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),en=0;en<cn.length;en+=1)cn[en].href.indexOf(gt[Tt].fPath)!==-1&&(sn=!1);if(sn){var Pn=createTag("link");Pn.setAttribute("f-forigin",gt[Tt].fOrigin),Pn.setAttribute("f-origin",gt[Tt].origin),Pn.type="text/css",Pn.rel="stylesheet",Pn.href=gt[Tt].fPath,document.body.appendChild(Pn)}}else if(gt[Tt].fOrigin==="t"||gt[Tt].origin===2){for(cn=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),en=0;en<cn.length;en+=1)gt[Tt].fPath===cn[en].src&&(sn=!1);if(sn){var tr=createTag("link");tr.setAttribute("f-forigin",gt[Tt].fOrigin),tr.setAttribute("f-origin",gt[Tt].origin),tr.setAttribute("rel","stylesheet"),tr.setAttribute("href",gt[Tt].fPath),It.appendChild(tr)}}gt[Tt].helper=De(gt[Tt],It),gt[Tt].cache={},this.fonts.push(gt[Tt])}Ft===0?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}function Ne(vt){if(vt){this.chars||(this.chars=[]);var It,gt=vt.length,Tt,Ct=this.chars.length,Ft;for(It=0;It<gt;It+=1){for(Tt=0,Ft=!1;Tt<Ct;)this.chars[Tt].style===vt[It].style&&this.chars[Tt].fFamily===vt[It].fFamily&&this.chars[Tt].ch===vt[It].ch&&(Ft=!0),Tt+=1;Ft||(this.chars.push(vt[It]),Ct+=1)}}}function qe(vt,It,gt){for(var Tt=0,Ct=this.chars.length;Tt<Ct;){if(this.chars[Tt].ch===vt&&this.chars[Tt].style===It&&this.chars[Tt].fFamily===gt)return this.chars[Tt];Tt+=1}return(typeof vt=="string"&&vt.charCodeAt(0)!==13||!vt)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",vt,It,gt)),_}function Xe(vt,It,gt){var Tt=this.getFontByName(It),Ct=vt;if(!Tt.cache[Ct]){var Ft=Tt.helper;if(vt===" "){var sn=Ft.measureText("|"+vt+"|"),cn=Ft.measureText("||");Tt.cache[Ct]=(sn-cn)/100}else Tt.cache[Ct]=Ft.measureText(vt)/100}return Tt.cache[Ct]*gt}function Ye(vt){for(var It=0,gt=this.fonts.length;It<gt;){if(this.fonts[It].fName===vt)return this.fonts[It];It+=1}return this.fonts[0]}function Qe(vt){var It=0,gt=vt.charCodeAt(0);if(gt>=55296&&gt<=56319){var Tt=vt.charCodeAt(1);Tt>=56320&&Tt<=57343&&(It=(gt-55296)*1024+Tt-56320+65536)}return It}function rt(vt,It){var gt=vt.toString(16)+It.toString(16);return Se.indexOf(gt)!==-1}function ot(vt){return vt===le}function ct(vt){return vt===xe}function mt(vt){var It=Qe(vt);return It>=fe&&It<=ve}function _t(vt){return mt(vt.substr(0,2))&&mt(vt.substr(2,2))}function Lt(vt){return b.indexOf(vt)!==-1}function Vt(vt,It){var gt=Qe(vt.substr(It,2));if(gt!==$)return!1;var Tt=0;for(It+=2;Tt<5;){if(gt=Qe(vt.substr(It,2)),gt<re||gt>ae)return!1;Tt+=1,It+=2}return Qe(vt.substr(It,2))===ee}function Gt(){this.isLoaded=!0}var $t=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};$t.isModifier=rt,$t.isZeroWidthJoiner=ot,$t.isFlagEmoji=_t,$t.isRegionalCode=mt,$t.isCombinedCharacter=Lt,$t.isRegionalFlag=Vt,$t.isVariationSelector=ct,$t.BLACK_FLAG_CODE_POINT=$;var Qt={addChars:Ne,addFonts:Be,getCharData:qe,getFontByName:Ye,measureText:Xe,checkLoadedFonts:Ie,setIsLoaded:Gt};return $t.prototype=Qt,$t}();function SlotManager(H){this.animationData=H}SlotManager.prototype.getProp=function(H){return this.animationData.slots&&this.animationData.slots[H.sid]?Object.assign(H,this.animationData.slots[H.sid].p):H};function slotFactory(H){return new SlotManager(H)}function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(_){this.renderableComponents.indexOf(_)===-1&&this.renderableComponents.push(_)},removeRenderableComponent:function(_){this.renderableComponents.indexOf(_)!==-1&&this.renderableComponents.splice(this.renderableComponents.indexOf(_),1)},prepareRenderableFrame:function(_){this.checkLayerLimits(_)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(_){this.data.ip-this.data.st<=_&&this.data.op-this.data.st>_?this.isInRange!==!0&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):this.isInRange!==!1&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var _,b=this.renderableComponents.length;for(_=0;_<b;_+=1)this.renderableComponents[_].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return this.data.ty===5?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=function(){var H={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(_){return H[_]||""}}();function SliderEffect(H,_,b){this.p=PropertyFactory.getProp(_,H.v,0,0,b)}function AngleEffect(H,_,b){this.p=PropertyFactory.getProp(_,H.v,0,0,b)}function ColorEffect(H,_,b){this.p=PropertyFactory.getProp(_,H.v,1,0,b)}function PointEffect(H,_,b){this.p=PropertyFactory.getProp(_,H.v,1,0,b)}function LayerIndexEffect(H,_,b){this.p=PropertyFactory.getProp(_,H.v,0,0,b)}function MaskIndexEffect(H,_,b){this.p=PropertyFactory.getProp(_,H.v,0,0,b)}function CheckboxEffect(H,_,b){this.p=PropertyFactory.getProp(_,H.v,0,0,b)}function NoValueEffect(){this.p={}}function EffectsManager(H,_){var b=H.ef||[];this.effectElements=[];var $,ee=b.length,re;for($=0;$<ee;$+=1)re=new GroupEffect(b[$],_),this.effectElements.push(re)}function GroupEffect(H,_){this.init(H,_)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(H,_){this.data=H,this.effectElements=[],this.initDynamicPropertyContainer(_);var b,$=this.data.ef.length,ee,re=this.data.ef;for(b=0;b<$;b+=1){switch(ee=null,re[b].ty){case 0:ee=new SliderEffect(re[b],_,this);break;case 1:ee=new AngleEffect(re[b],_,this);break;case 2:ee=new ColorEffect(re[b],_,this);break;case 3:ee=new PointEffect(re[b],_,this);break;case 4:case 7:ee=new CheckboxEffect(re[b],_,this);break;case 10:ee=new LayerIndexEffect(re[b],_,this);break;case 11:ee=new MaskIndexEffect(re[b],_,this);break;case 5:ee=new EffectsManager(re[b],_);break;default:ee=new NoValueEffect(re[b]);break}ee&&this.effectElements.push(ee)}};function BaseElement(){}BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var _=0,b=this.data.masksProperties.length;_<b;){if(this.data.masksProperties[_].mode!=="n"&&this.data.masksProperties[_].cl!==!1)return!0;_+=1}return!1},initExpressions:function(){var _=getExpressionInterfaces();if(_){var b=_("layer"),$=_("effects"),ee=_("shape"),re=_("text"),ae=_("comp");this.layerInterface=b(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var xe=$.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(xe),this.data.ty===0||this.data.xt?this.compInterface=ae(this):this.data.ty===4?(this.layerInterface.shapeInterface=ee(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):this.data.ty===5&&(this.layerInterface.textInterface=re(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var _=getBlendMode(this.data.bm),b=this.baseElement||this.layerElement;b.style["mix-blend-mode"]=_},initBaseData:function(_,b,$){this.globalData=b,this.comp=$,this.data=_,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}};function FrameElement(){}FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(_,b){var $,ee=this.dynamicProperties.length;for($=0;$<ee;$+=1)(b||this._isParent&&this.dynamicProperties[$].propType==="transform")&&(this.dynamicProperties[$].getValue(),this.dynamicProperties[$]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(_){this.dynamicProperties.indexOf(_)===-1&&this.dynamicProperties.push(_)}};function FootageElement(H,_,b){this.initFrame(),this.initRenderable(),this.assetData=_.getAssetData(H.refId),this.footageData=_.imageLoader.getAsset(this.assetData),this.initBaseData(H,_,b)}FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var H=getExpressionInterfaces();if(H){var _=H("footage");this.layerInterface=_(this)}},FootageElement.prototype.getFootageData=function(){return this.footageData};function AudioElement(H,_,b){this.initFrame(),this.initRenderable(),this.assetData=_.getAssetData(H.refId),this.initBaseData(H,_,b),this._isPlaying=!1,this._canPlay=!1;var $=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio($),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=H.tm?PropertyFactory.getProp(this,H.tm,0,_.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,H.au&&H.au.lv?H.au.lv:{k:[100]},1,.01,this)}AudioElement.prototype.prepareFrame=function(H){if(this.prepareRenderableFrame(H,!0),this.prepareProperties(H,!0),this.tm._placeholder)this._currentTime=H/this.data.sr;else{var _=this.tm.v;this._currentTime=_}this._volume=this.lv.v[0];var b=this._volume*this._volumeMultiplier;this._previousVolume!==b&&(this._previousVolume=b,this.audio.volume(b))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(H){this.audio.rate(H)},AudioElement.prototype.volume=function(H){this._volumeMultiplier=H,this._previousVolume=H*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){};function BaseRenderer(){}BaseRenderer.prototype.checkLayers=function(H){var _,b=this.layers.length,$;for(this.completeLayers=!0,_=b-1;_>=0;_-=1)this.elements[_]||($=this.layers[_],$.ip-$.st<=H-this.layers[_].st&&$.op-$.st>H-this.layers[_].st&&this.buildItem(_)),this.completeLayers=this.elements[_]?this.completeLayers:!1;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(H){switch(H.ty){case 2:return this.createImage(H);case 0:return this.createComp(H);case 1:return this.createSolid(H);case 3:return this.createNull(H);case 4:return this.createShape(H);case 5:return this.createText(H);case 6:return this.createAudio(H);case 13:return this.createCamera(H);case 15:return this.createFootage(H);default:return this.createNull(H)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(H){return new AudioElement(H,this.globalData,this)},BaseRenderer.prototype.createFootage=function(H){return new FootageElement(H,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var H,_=this.layers.length;for(H=0;H<_;H+=1)this.buildItem(H);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(H){this.completeLayers=!1;var _,b=H.length,$,ee=this.layers.length;for(_=0;_<b;_+=1)for($=0;$<ee;){if(this.layers[$].id===H[_].id){this.layers[$]=H[_];break}$+=1}},BaseRenderer.prototype.setProjectInterface=function(H){this.globalData.projectInterface=H},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(H,_,b){for(var $=this.elements,ee=this.layers,re=0,ae=ee.length;re<ae;)ee[re].ind==_&&(!$[re]||$[re]===!0?(this.buildItem(re),this.addPendingElement(H)):(b.push($[re]),$[re].setAsParent(),ee[re].parent!==void 0?this.buildElementParenting(H,ee[re].parent,b):H.setHierarchy(b))),re+=1},BaseRenderer.prototype.addPendingElement=function(H){this.pendingElements.push(H)},BaseRenderer.prototype.searchExtraCompositions=function(H){var _,b=H.length;for(_=0;_<b;_+=1)if(H[_].xt){var $=this.createComp(H[_]);$.initExpressions(),this.globalData.projectInterface.registerComposition($)}},BaseRenderer.prototype.getElementById=function(H){var _,b=this.elements.length;for(_=0;_<b;_+=1)if(this.elements[_].data.ind===H)return this.elements[_];return null},BaseRenderer.prototype.getElementByPath=function(H){var _=H.shift(),b;if(typeof _=="number")b=this.elements[_];else{var $,ee=this.elements.length;for($=0;$<ee;$+=1)if(this.elements[$].data.nm===_){b=this.elements[$];break}}return H.length===0?b:b.getElementByPath(H)},BaseRenderer.prototype.setupGlobalData=function(H,_){this.globalData.fontManager=new FontManager,this.globalData.slotManager=slotFactory(H),this.globalData.fontManager.addChars(H.chars),this.globalData.fontManager.addFonts(H.fonts,_),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=H.fr,this.globalData.nm=H.nm,this.globalData.compSize={w:H.w,h:H.h}};var effectTypes={TRANSFORM_EFFECT:"transformEFfect"};function TransformElement(){}TransformElement.prototype={initTransform:function(){var _=new Matrix;this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_localMatMdf:!1,_opMdf:!1,mat:_,localMat:_,localOpacity:1},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var _,b=this.finalTransform.mat,$=0,ee=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;$<ee;){if(this.hierarchy[$].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}$+=1}if(this.finalTransform._matMdf)for(_=this.finalTransform.mProp.v.props,b.cloneFromProps(_),$=0;$<ee;$+=1)b.multiply(this.hierarchy[$].finalTransform.mProp.v)}(!this.localTransforms||this.finalTransform._matMdf)&&(this.finalTransform._localMatMdf=this.finalTransform._matMdf),this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v)},renderLocalTransform:function(){if(this.localTransforms){var _=0,b=this.localTransforms.length;if(this.finalTransform._localMatMdf=this.finalTransform._matMdf,!this.finalTransform._localMatMdf||!this.finalTransform._opMdf)for(;_<b;)this.localTransforms[_]._mdf&&(this.finalTransform._localMatMdf=!0),this.localTransforms[_]._opMdf&&!this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v,this.finalTransform._opMdf=!0),_+=1;if(this.finalTransform._localMatMdf){var $=this.finalTransform.localMat;for(this.localTransforms[0].matrix.clone($),_=1;_<b;_+=1){var ee=this.localTransforms[_].matrix;$.multiply(ee)}$.multiply(this.finalTransform.mat)}if(this.finalTransform._opMdf){var re=this.finalTransform.localOpacity;for(_=0;_<b;_+=1)re*=this.localTransforms[_].opacity*.01;this.finalTransform.localOpacity=re}}},searchEffectTransforms:function(){if(this.renderableEffectsManager){var _=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT);if(_.length){this.localTransforms=[],this.finalTransform.localMat=new Matrix;var b=0,$=_.length;for(b=0;b<$;b+=1)this.localTransforms.push(_[b])}}},globalToLocal:function(_){var b=[];b.push(this.finalTransform);for(var $=!0,ee=this.comp;$;)ee.finalTransform?(ee.data.hasMask&&b.splice(0,0,ee.finalTransform),ee=ee.comp):$=!1;var re,ae=b.length,xe;for(re=0;re<ae;re+=1)xe=b[re].mat.applyToPointArray(0,0,0),_=[_[0]-xe[0],_[1]-xe[1],0];return _},mHelper:new Matrix};function MaskElement(H,_,b){this.data=H,this.element=_,this.globalData=b,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var $=this.globalData.defs,ee,re=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(re),this.solidPath="";var ae,xe=this.masksProperties,le=0,fe=[],ve,Se,Ee=createElementID(),Ce,Ie,De,Be,Ne="clipPath",qe="clip-path";for(ee=0;ee<re;ee+=1)if((xe[ee].mode!=="a"&&xe[ee].mode!=="n"||xe[ee].inv||xe[ee].o.k!==100||xe[ee].o.x)&&(Ne="mask",qe="mask"),(xe[ee].mode==="s"||xe[ee].mode==="i")&&le===0?(Ce=createNS("rect"),Ce.setAttribute("fill","#ffffff"),Ce.setAttribute("width",this.element.comp.data.w||0),Ce.setAttribute("height",this.element.comp.data.h||0),fe.push(Ce)):Ce=null,ae=createNS("path"),xe[ee].mode==="n")this.viewData[ee]={op:PropertyFactory.getProp(this.element,xe[ee].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,xe[ee],3),elem:ae,lastPath:""},$.appendChild(ae);else{le+=1,ae.setAttribute("fill",xe[ee].mode==="s"?"#000000":"#ffffff"),ae.setAttribute("clip-rule","nonzero");var Xe;if(xe[ee].x.k!==0?(Ne="mask",qe="mask",Be=PropertyFactory.getProp(this.element,xe[ee].x,0,null,this.element),Xe=createElementID(),Ie=createNS("filter"),Ie.setAttribute("id",Xe),De=createNS("feMorphology"),De.setAttribute("operator","erode"),De.setAttribute("in","SourceGraphic"),De.setAttribute("radius","0"),Ie.appendChild(De),$.appendChild(Ie),ae.setAttribute("stroke",xe[ee].mode==="s"?"#000000":"#ffffff")):(De=null,Be=null),this.storedData[ee]={elem:ae,x:Be,expan:De,lastPath:"",lastOperator:"",filterId:Xe,lastRadius:0},xe[ee].mode==="i"){Se=fe.length;var Ye=createNS("g");for(ve=0;ve<Se;ve+=1)Ye.appendChild(fe[ve]);var Qe=createNS("mask");Qe.setAttribute("mask-type","alpha"),Qe.setAttribute("id",Ee+"_"+le),Qe.appendChild(ae),$.appendChild(Qe),Ye.setAttribute("mask","url("+getLocationHref()+"#"+Ee+"_"+le+")"),fe.length=0,fe.push(Ye)}else fe.push(ae);xe[ee].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[ee]={elem:ae,lastPath:"",op:PropertyFactory.getProp(this.element,xe[ee].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,xe[ee],3),invRect:Ce},this.viewData[ee].prop.k||this.drawPath(xe[ee],this.viewData[ee].prop.v,this.viewData[ee])}for(this.maskElement=createNS(Ne),re=fe.length,ee=0;ee<re;ee+=1)this.maskElement.appendChild(fe[ee]);le>0&&(this.maskElement.setAttribute("id",Ee),this.element.maskedElement.setAttribute(qe,"url("+getLocationHref()+"#"+Ee+")"),$.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}MaskElement.prototype.getMaskProperty=function(H){return this.viewData[H].prop},MaskElement.prototype.renderFrame=function(H){var _=this.element.finalTransform.mat,b,$=this.masksProperties.length;for(b=0;b<$;b+=1)if((this.viewData[b].prop._mdf||H)&&this.drawPath(this.masksProperties[b],this.viewData[b].prop.v,this.viewData[b]),(this.viewData[b].op._mdf||H)&&this.viewData[b].elem.setAttribute("fill-opacity",this.viewData[b].op.v),this.masksProperties[b].mode!=="n"&&(this.viewData[b].invRect&&(this.element.finalTransform.mProp._mdf||H)&&this.viewData[b].invRect.setAttribute("transform",_.getInverseMatrix().to2dCSS()),this.storedData[b].x&&(this.storedData[b].x._mdf||H))){var ee=this.storedData[b].expan;this.storedData[b].x.v<0?(this.storedData[b].lastOperator!=="erode"&&(this.storedData[b].lastOperator="erode",this.storedData[b].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[b].filterId+")")),ee.setAttribute("radius",-this.storedData[b].x.v)):(this.storedData[b].lastOperator!=="dilate"&&(this.storedData[b].lastOperator="dilate",this.storedData[b].elem.setAttribute("filter",null)),this.storedData[b].elem.setAttribute("stroke-width",this.storedData[b].x.v*2))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var H="M0,0 ";return H+=" h"+this.globalData.compSize.w,H+=" v"+this.globalData.compSize.h,H+=" h-"+this.globalData.compSize.w,H+=" v-"+this.globalData.compSize.h+" ",H},MaskElement.prototype.drawPath=function(H,_,b){var $=" M"+_.v[0][0]+","+_.v[0][1],ee,re;for(re=_._length,ee=1;ee<re;ee+=1)$+=" C"+_.o[ee-1][0]+","+_.o[ee-1][1]+" "+_.i[ee][0]+","+_.i[ee][1]+" "+_.v[ee][0]+","+_.v[ee][1];if(_.c&&re>1&&($+=" C"+_.o[ee-1][0]+","+_.o[ee-1][1]+" "+_.i[0][0]+","+_.i[0][1]+" "+_.v[0][0]+","+_.v[0][1]),b.lastPath!==$){var ae="";b.elem&&(_.c&&(ae=H.inv?this.solidPath+$:$),b.elem.setAttribute("d",ae)),b.lastPath=$}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=function(){var H={};H.createFilter=_,H.createAlphaToLuminanceFilter=b;function _($,ee){var re=createNS("filter");return re.setAttribute("id",$),ee!==!0&&(re.setAttribute("filterUnits","objectBoundingBox"),re.setAttribute("x","0%"),re.setAttribute("y","0%"),re.setAttribute("width","100%"),re.setAttribute("height","100%")),re}function b(){var $=createNS("feColorMatrix");return $.setAttribute("type","matrix"),$.setAttribute("color-interpolation-filters","sRGB"),$.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),$}return H}(),featureSupport=function(){var H={maskType:!0,svgLumaHidden:!0,offscreenCanvas:typeof OffscreenCanvas<"u"};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(H.maskType=!1),/firefox/i.test(navigator.userAgent)&&(H.svgLumaHidden=!1),H}(),registeredEffects$1={},idPrefix="filter_result_";function SVGEffects(H){var _,b="SourceGraphic",$=H.data.ef?H.data.ef.length:0,ee=createElementID(),re=filtersFactory.createFilter(ee,!0),ae=0;this.filters=[];var xe;for(_=0;_<$;_+=1){xe=null;var le=H.data.ef[_].ty;if(registeredEffects$1[le]){var fe=registeredEffects$1[le].effect;xe=new fe(re,H.effectsManager.effectElements[_],H,idPrefix+ae,b),b=idPrefix+ae,registeredEffects$1[le].countsAsEffect&&(ae+=1)}xe&&this.filters.push(xe)}ae&&(H.globalData.defs.appendChild(re),H.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+ee+")")),this.filters.length&&H.addRenderableComponent(this)}SVGEffects.prototype.renderFrame=function(H){var _,b=this.filters.length;for(_=0;_<b;_+=1)this.filters[_].renderFrame(H)},SVGEffects.prototype.getEffects=function(H){var _,b=this.filters.length,$=[];for(_=0;_<b;_+=1)this.filters[_].type===H&&$.push(this.filters[_]);return $};function registerEffect$1(H,_,b){registeredEffects$1[H]={effect:_,countsAsEffect:b}}function SVGBaseElement(){}SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var _=null;if(this.data.td){this.matteMasks={};var b=createNS("g");b.setAttribute("id",this.layerId),b.appendChild(this.layerElement),_=b,this.globalData.defs.appendChild(b)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),_=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.ty===0&&!this.data.hd){var $=createNS("clipPath"),ee=createNS("path");ee.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var re=createElementID();if($.setAttribute("id",re),$.appendChild(ee),this.globalData.defs.appendChild($),this.checkMasks()){var ae=createNS("g");ae.setAttribute("clip-path","url("+getLocationHref()+"#"+re+")"),ae.appendChild(this.layerElement),this.transformedElement=ae,_?_.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+re+")")}this.data.bm!==0&&this.setBlendMode()},renderElement:function(){this.finalTransform._localMatMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.localMat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.localOpacity)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this),this.searchEffectTransforms()},getMatte:function(_){if(this.matteMasks||(this.matteMasks={}),!this.matteMasks[_]){var b=this.layerId+"_"+_,$,ee,re,ae;if(_===1||_===3){var xe=createNS("mask");xe.setAttribute("id",b),xe.setAttribute("mask-type",_===3?"luminance":"alpha"),re=createNS("use"),re.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),xe.appendChild(re),this.globalData.defs.appendChild(xe),!featureSupport.maskType&&_===1&&(xe.setAttribute("mask-type","luminance"),$=createElementID(),ee=filtersFactory.createFilter($),this.globalData.defs.appendChild(ee),ee.appendChild(filtersFactory.createAlphaToLuminanceFilter()),ae=createNS("g"),ae.appendChild(re),xe.appendChild(ae),ae.setAttribute("filter","url("+getLocationHref()+"#"+$+")"))}else if(_===2){var le=createNS("mask");le.setAttribute("id",b),le.setAttribute("mask-type","alpha");var fe=createNS("g");le.appendChild(fe),$=createElementID(),ee=filtersFactory.createFilter($);var ve=createNS("feComponentTransfer");ve.setAttribute("in","SourceGraphic"),ee.appendChild(ve);var Se=createNS("feFuncA");Se.setAttribute("type","table"),Se.setAttribute("tableValues","1.0 0.0"),ve.appendChild(Se),this.globalData.defs.appendChild(ee);var Ee=createNS("rect");Ee.setAttribute("width",this.comp.data.w),Ee.setAttribute("height",this.comp.data.h),Ee.setAttribute("x","0"),Ee.setAttribute("y","0"),Ee.setAttribute("fill","#ffffff"),Ee.setAttribute("opacity","0"),fe.setAttribute("filter","url("+getLocationHref()+"#"+$+")"),fe.appendChild(Ee),re=createNS("use"),re.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),fe.appendChild(re),featureSupport.maskType||(le.setAttribute("mask-type","luminance"),ee.appendChild(filtersFactory.createAlphaToLuminanceFilter()),ae=createNS("g"),fe.appendChild(Ee),ae.appendChild(this.layerElement),fe.appendChild(ae)),this.globalData.defs.appendChild(le)}this.matteMasks[_]=b}return this.matteMasks[_]},setMatte:function(_){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+_+")")}};function HierarchyElement(){}HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(_){this.hierarchy=_},setAsParent:function(){this._isParent=!0},checkParenting:function(){this.data.parent!==void 0&&this.comp.buildElementParenting(this,this.data.parent,[])}};function RenderableDOMElement(){}(function(){var H={initElement:function(b,$,ee){this.initFrame(),this.initBaseData(b,$,ee),this.initTransform(b,$,ee),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){if(!this.hidden&&(!this.isInRange||this.isTransparent)){var b=this.baseElement||this.layerElement;b.style.display="none",this.hidden=!0}},show:function(){if(this.isInRange&&!this.isTransparent){if(!this.data.hd){var b=this.baseElement||this.layerElement;b.style.display="block"}this.hidden=!1,this._isFirstFrame=!0}},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(b){this._mdf=!1,this.prepareRenderableFrame(b),this.prepareProperties(b,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}};extendPrototype([RenderableElement,createProxyFunction(H)],RenderableDOMElement)})();function IImageElement(H,_,b){this.assetData=_.getAssetData(H.refId),this.assetData&&this.assetData.sid&&(this.assetData=_.slotManager.getProp(this.assetData)),this.initElement(H,_,b),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var H=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",H),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect};function ProcessedElement(H,_){this.elem=H,this.pos=_}function IShapeElement(){}IShapeElement.prototype={addShapeToModifiers:function(_){var b,$=this.shapeModifiers.length;for(b=0;b<$;b+=1)this.shapeModifiers[b].addShape(_)},isShapeInAnimatedModifiers:function(_){for(var b=0,$=this.shapeModifiers.length;b<$;)if(this.shapeModifiers[b].isAnimatedWithShape(_))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var _,b=this.shapes.length;for(_=0;_<b;_+=1)this.shapes[_].sh.reset();b=this.shapeModifiers.length;var $;for(_=b-1;_>=0&&($=this.shapeModifiers[_].processShapes(this._isFirstFrame),!$);_-=1);}},searchProcessedElement:function(_){for(var b=this.processedElements,$=0,ee=b.length;$<ee;){if(b[$].elem===_)return b[$].pos;$+=1}return 0},addProcessedElement:function(_,b){for(var $=this.processedElements,ee=$.length;ee;)if(ee-=1,$[ee].elem===_){$[ee].pos=b;return}$.push(new ProcessedElement(_,b))},prepareFrame:function(_){this.prepareRenderableFrame(_),this.prepareProperties(_,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(H,_,b){this.caches=[],this.styles=[],this.transformers=H,this.lStr="",this.sh=b,this.lvl=_,this._isAnimated=!!b.k;for(var $=0,ee=H.length;$<ee;){if(H[$].mProps.dynamicProperties.length){this._isAnimated=!0;break}$+=1}}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0};function SVGStyleData(H,_){this.data=H,this.type=H.ty,this.d="",this.lvl=_,this._mdf=!1,this.closed=H.hd===!0,this.pElem=createNS("path"),this.msElem=null}SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1};function DashProperty(H,_,b,$){this.elem=H,this.frameId=-1,this.dataProps=createSizedArray(_.length),this.renderer=b,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",_.length?_.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer($);var ee,re=_.length||0,ae;for(ee=0;ee<re;ee+=1)ae=PropertyFactory.getProp(H,_[ee].v,0,0,this),this.k=ae.k||this.k,this.dataProps[ee]={n:_[ee].n,p:ae};this.k||this.getValue(!0),this._isAnimated=this.k}DashProperty.prototype.getValue=function(H){if(!(this.elem.globalData.frameId===this.frameId&&!H)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||H,this._mdf)){var _=0,b=this.dataProps.length;for(this.renderer==="svg"&&(this.dashStr=""),_=0;_<b;_+=1)this.dataProps[_].n!=="o"?this.renderer==="svg"?this.dashStr+=" "+this.dataProps[_].p.v:this.dashArray[_]=this.dataProps[_].p.v:this.dashoffset[0]=this.dataProps[_].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty);function SVGStrokeStyleData(H,_,b){this.initDynamicPropertyContainer(H),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(H,_.o,0,.01,this),this.w=PropertyFactory.getProp(H,_.w,0,null,this),this.d=new DashProperty(H,_.d||{},"svg",this),this.c=PropertyFactory.getProp(H,_.c,1,255,this),this.style=b,this._isAnimated=!!this._isAnimated}extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData);function SVGFillStyleData(H,_,b){this.initDynamicPropertyContainer(H),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(H,_.o,0,.01,this),this.c=PropertyFactory.getProp(H,_.c,1,255,this),this.style=b}extendPrototype([DynamicPropertyContainer],SVGFillStyleData);function SVGNoStyleData(H,_,b){this.initDynamicPropertyContainer(H),this.getValue=this.iterateDynamicProperties,this.style=b}extendPrototype([DynamicPropertyContainer],SVGNoStyleData);function GradientProperty(H,_,b){this.data=_,this.c=createTypedArray("uint8c",_.p*4);var $=_.k.k[0].s?_.k.k[0].s.length-_.p*4:_.k.k.length-_.p*4;this.o=createTypedArray("float32",$),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=$,this.initDynamicPropertyContainer(b),this.prop=PropertyFactory.getProp(H,_.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}GradientProperty.prototype.comparePoints=function(H,_){for(var b=0,$=this.o.length/2,ee;b<$;){if(ee=Math.abs(H[b*4]-H[_*4+b*2]),ee>.01)return!1;b+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!==this.c.length/4)return!1;if(this.data.k.k[0].s)for(var H=0,_=this.data.k.k.length;H<_;){if(!this.comparePoints(this.data.k.k[H].s,this.data.p))return!1;H+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(H){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||H){var _,b=this.data.p*4,$,ee;for(_=0;_<b;_+=1)$=_%4===0?100:255,ee=Math.round(this.prop.v[_]*$),this.c[_]!==ee&&(this.c[_]=ee,this._cmdf=!H);if(this.o.length)for(b=this.prop.v.length,_=this.data.p*4;_<b;_+=1)$=_%2===0?100:1,ee=_%2===0?Math.round(this.prop.v[_]*100):this.prop.v[_],this.o[_-this.data.p*4]!==ee&&(this.o[_-this.data.p*4]=ee,this._omdf=!H);this._mdf=!H}},extendPrototype([DynamicPropertyContainer],GradientProperty);function SVGGradientFillStyleData(H,_,b){this.initDynamicPropertyContainer(H),this.getValue=this.iterateDynamicProperties,this.initGradientData(H,_,b)}SVGGradientFillStyleData.prototype.initGradientData=function(H,_,b){this.o=PropertyFactory.getProp(H,_.o,0,.01,this),this.s=PropertyFactory.getProp(H,_.s,1,null,this),this.e=PropertyFactory.getProp(H,_.e,1,null,this),this.h=PropertyFactory.getProp(H,_.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(H,_.a||{k:0},0,degToRads,this),this.g=new GradientProperty(H,_.g,this),this.style=b,this.stops=[],this.setGradientData(b.pElem,_),this.setGradientOpacity(_,b),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(H,_){var b=createElementID(),$=createNS(_.t===1?"linearGradient":"radialGradient");$.setAttribute("id",b),$.setAttribute("spreadMethod","pad"),$.setAttribute("gradientUnits","userSpaceOnUse");var ee=[],re,ae,xe;for(xe=_.g.p*4,ae=0;ae<xe;ae+=4)re=createNS("stop"),$.appendChild(re),ee.push(re);H.setAttribute(_.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+b+")"),this.gf=$,this.cst=ee},SVGGradientFillStyleData.prototype.setGradientOpacity=function(H,_){if(this.g._hasOpacity&&!this.g._collapsable){var b,$,ee,re=createNS("mask"),ae=createNS("path");re.appendChild(ae);var xe=createElementID(),le=createElementID();re.setAttribute("id",le);var fe=createNS(H.t===1?"linearGradient":"radialGradient");fe.setAttribute("id",xe),fe.setAttribute("spreadMethod","pad"),fe.setAttribute("gradientUnits","userSpaceOnUse"),ee=H.g.k.k[0].s?H.g.k.k[0].s.length:H.g.k.k.length;var ve=this.stops;for($=H.g.p*4;$<ee;$+=2)b=createNS("stop"),b.setAttribute("stop-color","rgb(255,255,255)"),fe.appendChild(b),ve.push(b);ae.setAttribute(H.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+xe+")"),H.ty==="gs"&&(ae.setAttribute("stroke-linecap",lineCapEnum[H.lc||2]),ae.setAttribute("stroke-linejoin",lineJoinEnum[H.lj||2]),H.lj===1&&ae.setAttribute("stroke-miterlimit",H.ml)),this.of=fe,this.ms=re,this.ost=ve,this.maskId=le,_.msElem=ae}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData);function SVGGradientStrokeStyleData(H,_,b){this.initDynamicPropertyContainer(H),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(H,_.w,0,null,this),this.d=new DashProperty(H,_.d||{},"svg",this),this.initGradientData(H,_,b),this._isAnimated=!!this._isAnimated}extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(H,_,b){this.transform={mProps:H,op:_,container:b},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}var buildShapeString=function(_,b,$,ee){if(b===0)return"";var re=_.o,ae=_.i,xe=_.v,le,fe=" M"+ee.applyToPointStringified(xe[0][0],xe[0][1]);for(le=1;le<b;le+=1)fe+=" C"+ee.applyToPointStringified(re[le-1][0],re[le-1][1])+" "+ee.applyToPointStringified(ae[le][0],ae[le][1])+" "+ee.applyToPointStringified(xe[le][0],xe[le][1]);return $&&b&&(fe+=" C"+ee.applyToPointStringified(re[le-1][0],re[le-1][1])+" "+ee.applyToPointStringified(ae[0][0],ae[0][1])+" "+ee.applyToPointStringified(xe[0][0],xe[0][1]),fe+="z"),fe},SVGElementsRenderer=function(){var H=new Matrix,_=new Matrix,b={createRenderFunction:$};function $(Se){switch(Se.ty){case"fl":return xe;case"gf":return fe;case"gs":return le;case"st":return ve;case"sh":case"el":case"rc":case"sr":return ae;case"tr":return ee;case"no":return re;default:return null}}function ee(Se,Ee,Ce){(Ce||Ee.transform.op._mdf)&&Ee.transform.container.setAttribute("opacity",Ee.transform.op.v),(Ce||Ee.transform.mProps._mdf)&&Ee.transform.container.setAttribute("transform",Ee.transform.mProps.v.to2dCSS())}function re(){}function ae(Se,Ee,Ce){var Ie,De,Be,Ne,qe,Xe,Ye=Ee.styles.length,Qe=Ee.lvl,rt,ot,ct,mt;for(Xe=0;Xe<Ye;Xe+=1){if(Ne=Ee.sh._mdf||Ce,Ee.styles[Xe].lvl<Qe){for(ot=_.reset(),ct=Qe-Ee.styles[Xe].lvl,mt=Ee.transformers.length-1;!Ne&&ct>0;)Ne=Ee.transformers[mt].mProps._mdf||Ne,ct-=1,mt-=1;if(Ne)for(ct=Qe-Ee.styles[Xe].lvl,mt=Ee.transformers.length-1;ct>0;)ot.multiply(Ee.transformers[mt].mProps.v),ct-=1,mt-=1}else ot=H;if(rt=Ee.sh.paths,De=rt._length,Ne){for(Be="",Ie=0;Ie<De;Ie+=1)qe=rt.shapes[Ie],qe&&qe._length&&(Be+=buildShapeString(qe,qe._length,qe.c,ot));Ee.caches[Xe]=Be}else Be=Ee.caches[Xe];Ee.styles[Xe].d+=Se.hd===!0?"":Be,Ee.styles[Xe]._mdf=Ne||Ee.styles[Xe]._mdf}}function xe(Se,Ee,Ce){var Ie=Ee.style;(Ee.c._mdf||Ce)&&Ie.pElem.setAttribute("fill","rgb("+bmFloor(Ee.c.v[0])+","+bmFloor(Ee.c.v[1])+","+bmFloor(Ee.c.v[2])+")"),(Ee.o._mdf||Ce)&&Ie.pElem.setAttribute("fill-opacity",Ee.o.v)}function le(Se,Ee,Ce){fe(Se,Ee,Ce),ve(Se,Ee,Ce)}function fe(Se,Ee,Ce){var Ie=Ee.gf,De=Ee.g._hasOpacity,Be=Ee.s.v,Ne=Ee.e.v;if(Ee.o._mdf||Ce){var qe=Se.ty==="gf"?"fill-opacity":"stroke-opacity";Ee.style.pElem.setAttribute(qe,Ee.o.v)}if(Ee.s._mdf||Ce){var Xe=Se.t===1?"x1":"cx",Ye=Xe==="x1"?"y1":"cy";Ie.setAttribute(Xe,Be[0]),Ie.setAttribute(Ye,Be[1]),De&&!Ee.g._collapsable&&(Ee.of.setAttribute(Xe,Be[0]),Ee.of.setAttribute(Ye,Be[1]))}var Qe,rt,ot,ct;if(Ee.g._cmdf||Ce){Qe=Ee.cst;var mt=Ee.g.c;for(ot=Qe.length,rt=0;rt<ot;rt+=1)ct=Qe[rt],ct.setAttribute("offset",mt[rt*4]+"%"),ct.setAttribute("stop-color","rgb("+mt[rt*4+1]+","+mt[rt*4+2]+","+mt[rt*4+3]+")")}if(De&&(Ee.g._omdf||Ce)){var _t=Ee.g.o;for(Ee.g._collapsable?Qe=Ee.cst:Qe=Ee.ost,ot=Qe.length,rt=0;rt<ot;rt+=1)ct=Qe[rt],Ee.g._collapsable||ct.setAttribute("offset",_t[rt*2]+"%"),ct.setAttribute("stop-opacity",_t[rt*2+1])}if(Se.t===1)(Ee.e._mdf||Ce)&&(Ie.setAttribute("x2",Ne[0]),Ie.setAttribute("y2",Ne[1]),De&&!Ee.g._collapsable&&(Ee.of.setAttribute("x2",Ne[0]),Ee.of.setAttribute("y2",Ne[1])));else{var Lt;if((Ee.s._mdf||Ee.e._mdf||Ce)&&(Lt=Math.sqrt(Math.pow(Be[0]-Ne[0],2)+Math.pow(Be[1]-Ne[1],2)),Ie.setAttribute("r",Lt),De&&!Ee.g._collapsable&&Ee.of.setAttribute("r",Lt)),Ee.s._mdf||Ee.e._mdf||Ee.h._mdf||Ee.a._mdf||Ce){Lt||(Lt=Math.sqrt(Math.pow(Be[0]-Ne[0],2)+Math.pow(Be[1]-Ne[1],2)));var Vt=Math.atan2(Ne[1]-Be[1],Ne[0]-Be[0]),Gt=Ee.h.v;Gt>=1?Gt=.99:Gt<=-1&&(Gt=-.99);var $t=Lt*Gt,Qt=Math.cos(Vt+Ee.a.v)*$t+Be[0],vt=Math.sin(Vt+Ee.a.v)*$t+Be[1];Ie.setAttribute("fx",Qt),Ie.setAttribute("fy",vt),De&&!Ee.g._collapsable&&(Ee.of.setAttribute("fx",Qt),Ee.of.setAttribute("fy",vt))}}}function ve(Se,Ee,Ce){var Ie=Ee.style,De=Ee.d;De&&(De._mdf||Ce)&&De.dashStr&&(Ie.pElem.setAttribute("stroke-dasharray",De.dashStr),Ie.pElem.setAttribute("stroke-dashoffset",De.dashoffset[0])),Ee.c&&(Ee.c._mdf||Ce)&&Ie.pElem.setAttribute("stroke","rgb("+bmFloor(Ee.c.v[0])+","+bmFloor(Ee.c.v[1])+","+bmFloor(Ee.c.v[2])+")"),(Ee.o._mdf||Ce)&&Ie.pElem.setAttribute("stroke-opacity",Ee.o.v),(Ee.w._mdf||Ce)&&(Ie.pElem.setAttribute("stroke-width",Ee.w.v),Ie.msElem&&Ie.msElem.setAttribute("stroke-width",Ee.w.v))}return b}();function SVGShapeElement(H,_,b){this.shapes=[],this.shapesData=H.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(H,_,b),this.prevViewData=[]}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var H,_=this.shapes.length,b,$,ee=this.stylesList.length,re,ae=[],xe=!1;for($=0;$<ee;$+=1){for(re=this.stylesList[$],xe=!1,ae.length=0,H=0;H<_;H+=1)b=this.shapes[H],b.styles.indexOf(re)!==-1&&(ae.push(b),xe=b._isAnimated||xe);ae.length>1&&xe&&this.setShapesAsAnimated(ae)}},SVGShapeElement.prototype.setShapesAsAnimated=function(H){var _,b=H.length;for(_=0;_<b;_+=1)H[_].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(H,_){var b,$=new SVGStyleData(H,_),ee=$.pElem;if(H.ty==="st")b=new SVGStrokeStyleData(this,H,$);else if(H.ty==="fl")b=new SVGFillStyleData(this,H,$);else if(H.ty==="gf"||H.ty==="gs"){var re=H.ty==="gf"?SVGGradientFillStyleData:SVGGradientStrokeStyleData;b=new re(this,H,$),this.globalData.defs.appendChild(b.gf),b.maskId&&(this.globalData.defs.appendChild(b.ms),this.globalData.defs.appendChild(b.of),ee.setAttribute("mask","url("+getLocationHref()+"#"+b.maskId+")"))}else H.ty==="no"&&(b=new SVGNoStyleData(this,H,$));return(H.ty==="st"||H.ty==="gs")&&(ee.setAttribute("stroke-linecap",lineCapEnum[H.lc||2]),ee.setAttribute("stroke-linejoin",lineJoinEnum[H.lj||2]),ee.setAttribute("fill-opacity","0"),H.lj===1&&ee.setAttribute("stroke-miterlimit",H.ml)),H.r===2&&ee.setAttribute("fill-rule","evenodd"),H.ln&&ee.setAttribute("id",H.ln),H.cl&&ee.setAttribute("class",H.cl),H.bm&&(ee.style["mix-blend-mode"]=getBlendMode(H.bm)),this.stylesList.push($),this.addToAnimatedContents(H,b),b},SVGShapeElement.prototype.createGroupElement=function(H){var _=new ShapeGroupData;return H.ln&&_.gr.setAttribute("id",H.ln),H.cl&&_.gr.setAttribute("class",H.cl),H.bm&&(_.gr.style["mix-blend-mode"]=getBlendMode(H.bm)),_},SVGShapeElement.prototype.createTransformElement=function(H,_){var b=TransformPropertyFactory.getTransformProperty(this,H,this),$=new SVGTransformData(b,b.o,_);return this.addToAnimatedContents(H,$),$},SVGShapeElement.prototype.createShapeElement=function(H,_,b){var $=4;H.ty==="rc"?$=5:H.ty==="el"?$=6:H.ty==="sr"&&($=7);var ee=ShapePropertyFactory.getShapeProp(this,H,$,this),re=new SVGShapeData(_,b,ee);return this.shapes.push(re),this.addShapeToModifiers(re),this.addToAnimatedContents(H,re),re},SVGShapeElement.prototype.addToAnimatedContents=function(H,_){for(var b=0,$=this.animatedContents.length;b<$;){if(this.animatedContents[b].element===_)return;b+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(H),element:_,data:H})},SVGShapeElement.prototype.setElementStyles=function(H){var _=H.styles,b,$=this.stylesList.length;for(b=0;b<$;b+=1)_.indexOf(this.stylesList[b])===-1&&!this.stylesList[b].closed&&_.push(this.stylesList[b])},SVGShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var H,_=this.itemsData.length;for(H=0;H<_;H+=1)this.prevViewData[H]=this.itemsData[H];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),_=this.dynamicProperties.length,H=0;H<_;H+=1)this.dynamicProperties[H].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(H,_,b,$,ee,re,ae){var xe=[].concat(re),le,fe=H.length-1,ve,Se,Ee=[],Ce=[],Ie,De,Be;for(le=fe;le>=0;le-=1){if(Be=this.searchProcessedElement(H[le]),Be?_[le]=b[Be-1]:H[le]._render=ae,H[le].ty==="fl"||H[le].ty==="st"||H[le].ty==="gf"||H[le].ty==="gs"||H[le].ty==="no")Be?_[le].style.closed=H[le].hd:_[le]=this.createStyleElement(H[le],ee),H[le]._render&&_[le].style.pElem.parentNode!==$&&$.appendChild(_[le].style.pElem),Ee.push(_[le].style);else if(H[le].ty==="gr"){if(!Be)_[le]=this.createGroupElement(H[le]);else for(Se=_[le].it.length,ve=0;ve<Se;ve+=1)_[le].prevViewData[ve]=_[le].it[ve];this.searchShapes(H[le].it,_[le].it,_[le].prevViewData,_[le].gr,ee+1,xe,ae),H[le]._render&&_[le].gr.parentNode!==$&&$.appendChild(_[le].gr)}else H[le].ty==="tr"?(Be||(_[le]=this.createTransformElement(H[le],$)),Ie=_[le].transform,xe.push(Ie)):H[le].ty==="sh"||H[le].ty==="rc"||H[le].ty==="el"||H[le].ty==="sr"?(Be||(_[le]=this.createShapeElement(H[le],xe,ee)),this.setElementStyles(_[le])):H[le].ty==="tm"||H[le].ty==="rd"||H[le].ty==="ms"||H[le].ty==="pb"||H[le].ty==="zz"||H[le].ty==="op"?(Be?(De=_[le],De.closed=!1):(De=ShapeModifiers.getModifier(H[le].ty),De.init(this,H[le]),_[le]=De,this.shapeModifiers.push(De)),Ce.push(De)):H[le].ty==="rp"&&(Be?(De=_[le],De.closed=!0):(De=ShapeModifiers.getModifier(H[le].ty),_[le]=De,De.init(this,H,le,_),this.shapeModifiers.push(De),ae=!1),Ce.push(De));this.addProcessedElement(H[le],le+1)}for(fe=Ee.length,le=0;le<fe;le+=1)Ee[le].closed=!0;for(fe=Ce.length,le=0;le<fe;le+=1)Ce[le].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){this.renderModifiers();var H,_=this.stylesList.length;for(H=0;H<_;H+=1)this.stylesList[H].reset();for(this.renderShape(),H=0;H<_;H+=1)(this.stylesList[H]._mdf||this._isFirstFrame)&&(this.stylesList[H].msElem&&(this.stylesList[H].msElem.setAttribute("d",this.stylesList[H].d),this.stylesList[H].d="M0 0"+this.stylesList[H].d),this.stylesList[H].pElem.setAttribute("d",this.stylesList[H].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var H,_=this.animatedContents.length,b;for(H=0;H<_;H+=1)b=this.animatedContents[H],(this._isFirstFrame||b.element._isAnimated)&&b.data!==!0&&b.fn(b.data,b.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null};function LetterProps(H,_,b,$,ee,re){this.o=H,this.sw=_,this.sc=b,this.fc=$,this.m=ee,this.p=re,this._mdf={o:!0,sw:!!_,sc:!!b,fc:!!$,m:!0,p:!0}}LetterProps.prototype.update=function(H,_,b,$,ee,re){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var ae=!1;return this.o!==H&&(this.o=H,this._mdf.o=!0,ae=!0),this.sw!==_&&(this.sw=_,this._mdf.sw=!0,ae=!0),this.sc!==b&&(this.sc=b,this._mdf.sc=!0,ae=!0),this.fc!==$&&(this.fc=$,this._mdf.fc=!0,ae=!0),this.m!==ee&&(this.m=ee,this._mdf.m=!0,ae=!0),re.length&&(this.p[0]!==re[0]||this.p[1]!==re[1]||this.p[4]!==re[4]||this.p[5]!==re[5]||this.p[12]!==re[12]||this.p[13]!==re[13])&&(this.p=re,this._mdf.p=!0,ae=!0),ae};function TextProperty(H,_){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,_.d&&_.d.sid&&(_.d=H.globalData.slotManager.getProp(_.d)),this.data=_,this.elem=H,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(H,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(H[b]=_[b]);return H},TextProperty.prototype.setCurrentData=function(H){H.__complete||this.completeTextData(H),this.currentData=H,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(H){this.effectsSequence.push(H),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(H){if(!((this.elem.globalData.frameId===this.frameId||!this.effectsSequence.length)&&!H)){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var _=this.currentData,b=this.keysIndex;if(this.lock){this.setCurrentData(this.currentData);return}this.lock=!0,this._mdf=!1;var $,ee=this.effectsSequence.length,re=H||this.data.d.k[this.keysIndex].s;for($=0;$<ee;$+=1)b!==this.keysIndex?re=this.effectsSequence[$](re,re.t):re=this.effectsSequence[$](this.currentData,re.t);_!==re&&this.setCurrentData(re),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}},TextProperty.prototype.getKeyframeValue=function(){for(var H=this.data.d.k,_=this.elem.comp.renderedFrame,b=0,$=H.length;b<=$-1&&!(b===$-1||H[b+1].t>_);)b+=1;return this.keysIndex!==b&&(this.keysIndex=b),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(H){for(var _=[],b=0,$=H.length,ee,re,ae=!1,xe=!1,le="";b<$;)ae=xe,xe=!1,ee=H.charCodeAt(b),le=H.charAt(b),FontManager.isCombinedCharacter(ee)?ae=!0:ee>=55296&&ee<=56319?FontManager.isRegionalFlag(H,b)?le=H.substr(b,14):(re=H.charCodeAt(b+1),re>=56320&&re<=57343&&(FontManager.isModifier(ee,re)?(le=H.substr(b,2),ae=!0):FontManager.isFlagEmoji(H.substr(b,4))?le=H.substr(b,4):le=H.substr(b,2))):ee>56319?(re=H.charCodeAt(b+1),FontManager.isVariationSelector(ee)&&(ae=!0)):FontManager.isZeroWidthJoiner(ee)&&(ae=!0,xe=!0),ae?(_[_.length-1]+=le,ae=!1):_.push(le),b+=le.length;return _},TextProperty.prototype.completeTextData=function(H){H.__complete=!0;var _=this.elem.globalData.fontManager,b=this.data,$=[],ee,re,ae,xe=0,le,fe=b.m.g,ve=0,Se=0,Ee=0,Ce=[],Ie=0,De=0,Be,Ne,qe=_.getFontByName(H.f),Xe,Ye=0,Qe=getFontProperties(qe);H.fWeight=Qe.weight,H.fStyle=Qe.style,H.finalSize=H.s,H.finalText=this.buildFinalText(H.t),re=H.finalText.length,H.finalLineHeight=H.lh;var rt=H.tr/1e3*H.finalSize,ot;if(H.sz)for(var ct=!0,mt=H.sz[0],_t=H.sz[1],Lt,Vt;ct;){Vt=this.buildFinalText(H.t),Lt=0,Ie=0,re=Vt.length,rt=H.tr/1e3*H.finalSize;var Gt=-1;for(ee=0;ee<re;ee+=1)ot=Vt[ee].charCodeAt(0),ae=!1,Vt[ee]===" "?Gt=ee:(ot===13||ot===3)&&(Ie=0,ae=!0,Lt+=H.finalLineHeight||H.finalSize*1.2),_.chars?(Xe=_.getCharData(Vt[ee],qe.fStyle,qe.fFamily),Ye=ae?0:Xe.w*H.finalSize/100):Ye=_.measureText(Vt[ee],H.f,H.finalSize),Ie+Ye>mt&&Vt[ee]!==" "?(Gt===-1?re+=1:ee=Gt,Lt+=H.finalLineHeight||H.finalSize*1.2,Vt.splice(ee,Gt===ee?1:0,"\r"),Gt=-1,Ie=0):(Ie+=Ye,Ie+=rt);Lt+=qe.ascent*H.finalSize/100,this.canResize&&H.finalSize>this.minimumFontSize&&_t<Lt?(H.finalSize-=1,H.finalLineHeight=H.finalSize*H.lh/H.s):(H.finalText=Vt,re=H.finalText.length,ct=!1)}Ie=-rt,Ye=0;var $t=0,Qt;for(ee=0;ee<re;ee+=1)if(ae=!1,Qt=H.finalText[ee],ot=Qt.charCodeAt(0),ot===13||ot===3?($t=0,Ce.push(Ie),De=Ie>De?Ie:De,Ie=-2*rt,le="",ae=!0,Ee+=1):le=Qt,_.chars?(Xe=_.getCharData(Qt,qe.fStyle,_.getFontByName(H.f).fFamily),Ye=ae?0:Xe.w*H.finalSize/100):Ye=_.measureText(le,H.f,H.finalSize),Qt===" "?$t+=Ye+rt:(Ie+=Ye+rt+$t,$t=0),$.push({l:Ye,an:Ye,add:ve,n:ae,anIndexes:[],val:le,line:Ee,animatorJustifyOffset:0}),fe==2){if(ve+=Ye,le===""||le===" "||ee===re-1){for((le===""||le===" ")&&(ve-=Ye);Se<=ee;)$[Se].an=ve,$[Se].ind=xe,$[Se].extra=Ye,Se+=1;xe+=1,ve=0}}else if(fe==3){if(ve+=Ye,le===""||ee===re-1){for(le===""&&(ve-=Ye);Se<=ee;)$[Se].an=ve,$[Se].ind=xe,$[Se].extra=Ye,Se+=1;ve=0,xe+=1}}else $[xe].ind=xe,$[xe].extra=0,xe+=1;if(H.l=$,De=Ie>De?Ie:De,Ce.push(Ie),H.sz)H.boxWidth=H.sz[0],H.justifyOffset=0;else switch(H.boxWidth=De,H.j){case 1:H.justifyOffset=-H.boxWidth;break;case 2:H.justifyOffset=-H.boxWidth/2;break;default:H.justifyOffset=0}H.lineWidths=Ce;var vt=b.a,It,gt;Ne=vt.length;var Tt,Ct,Ft=[];for(Be=0;Be<Ne;Be+=1){for(It=vt[Be],It.a.sc&&(H.strokeColorAnim=!0),It.a.sw&&(H.strokeWidthAnim=!0),(It.a.fc||It.a.fh||It.a.fs||It.a.fb)&&(H.fillColorAnim=!0),Ct=0,Tt=It.s.b,ee=0;ee<re;ee+=1)gt=$[ee],gt.anIndexes[Be]=Ct,(Tt==1&&gt.val!==""||Tt==2&&gt.val!==""&&gt.val!==" "||Tt==3&&(gt.n||gt.val==" "||ee==re-1)||Tt==4&&(gt.n||ee==re-1))&&(It.s.rn===1&&Ft.push(Ct),Ct+=1);b.a[Be].s.totalChars=Ct;var sn=-1,cn;if(It.s.rn===1)for(ee=0;ee<re;ee+=1)gt=$[ee],sn!=gt.anIndexes[Be]&&(sn=gt.anIndexes[Be],cn=Ft.splice(Math.floor(Math.random()*Ft.length),1)[0]),gt.anIndexes[Be]=cn}H.yOffset=H.finalLineHeight||H.finalSize*1.2,H.ls=H.ls||0,H.ascent=qe.ascent*H.finalSize/100},TextProperty.prototype.updateDocumentData=function(H,_){_=_===void 0?this.keysIndex:_;var b=this.copyData({},this.data.d.k[_].s);b=this.copyData(b,H),this.data.d.k[_].s=b,this.recalculate(_),this.setCurrentData(b),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(H){var _=this.data.d.k[H].s;_.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(_)},TextProperty.prototype.canResizeFont=function(H){this.canResize=H,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(H){this.minimumFontSize=Math.floor(H)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var H=Math.max,_=Math.min,b=Math.floor;function $(re,ae){this._currentTextLength=-1,this.k=!1,this.data=ae,this.elem=re,this.comp=re.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(re),this.s=PropertyFactory.getProp(re,ae.s||{k:0},0,0,this),"e"in ae?this.e=PropertyFactory.getProp(re,ae.e,0,0,this):this.e={v:100},this.o=PropertyFactory.getProp(re,ae.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(re,ae.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(re,ae.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(re,ae.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(re,ae.a,0,.01,this),this.dynamicProperties.length||this.getValue()}$.prototype={getMult:function(ae){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var xe=0,le=0,fe=1,ve=1;this.ne.v>0?xe=this.ne.v/100:le=-this.ne.v/100,this.xe.v>0?fe=1-this.xe.v/100:ve=1+this.xe.v/100;var Se=BezierFactory.getBezierEasing(xe,le,fe,ve).get,Ee=0,Ce=this.finalS,Ie=this.finalE,De=this.data.sh;if(De===2)Ie===Ce?Ee=ae>=Ie?1:0:Ee=H(0,_(.5/(Ie-Ce)+(ae-Ce)/(Ie-Ce),1)),Ee=Se(Ee);else if(De===3)Ie===Ce?Ee=ae>=Ie?0:1:Ee=1-H(0,_(.5/(Ie-Ce)+(ae-Ce)/(Ie-Ce),1)),Ee=Se(Ee);else if(De===4)Ie===Ce?Ee=0:(Ee=H(0,_(.5/(Ie-Ce)+(ae-Ce)/(Ie-Ce),1)),Ee<.5?Ee*=2:Ee=1-2*(Ee-.5)),Ee=Se(Ee);else if(De===5){if(Ie===Ce)Ee=0;else{var Be=Ie-Ce;ae=_(H(0,ae+.5-Ce),Ie-Ce);var Ne=-Be/2+ae,qe=Be/2;Ee=Math.sqrt(1-Ne*Ne/(qe*qe))}Ee=Se(Ee)}else De===6?(Ie===Ce?Ee=0:(ae=_(H(0,ae+.5-Ce),Ie-Ce),Ee=(1+Math.cos(Math.PI+Math.PI*2*ae/(Ie-Ce)))/2),Ee=Se(Ee)):(ae>=b(Ce)&&(ae-Ce<0?Ee=H(0,_(_(Ie,1)-(Ce-ae),1)):Ee=H(0,_(Ie-ae,1))),Ee=Se(Ee));if(this.sm.v!==100){var Xe=this.sm.v*.01;Xe===0&&(Xe=1e-8);var Ye=.5-Xe*.5;Ee<Ye?Ee=0:(Ee=(Ee-Ye)/Xe,Ee>1&&(Ee=1))}return Ee*this.a.v},getValue:function(ae){this.iterateDynamicProperties(),this._mdf=ae||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,ae&&this.data.r===2&&(this.e.v=this._currentTextLength);var xe=this.data.r===2?1:100/this.data.totalChars,le=this.o.v/xe,fe=this.s.v/xe+le,ve=this.e.v/xe+le;if(fe>ve){var Se=fe;fe=ve,ve=Se}this.finalS=fe,this.finalE=ve}},extendPrototype([DynamicPropertyContainer],$);function ee(re,ae,xe){return new $(re,ae)}return{getTextSelectorProp:ee}}();function TextAnimatorDataProperty(H,_,b){var $={propType:!1},ee=PropertyFactory.getProp,re=_.a;this.a={r:re.r?ee(H,re.r,0,degToRads,b):$,rx:re.rx?ee(H,re.rx,0,degToRads,b):$,ry:re.ry?ee(H,re.ry,0,degToRads,b):$,sk:re.sk?ee(H,re.sk,0,degToRads,b):$,sa:re.sa?ee(H,re.sa,0,degToRads,b):$,s:re.s?ee(H,re.s,1,.01,b):$,a:re.a?ee(H,re.a,1,0,b):$,o:re.o?ee(H,re.o,0,.01,b):$,p:re.p?ee(H,re.p,1,0,b):$,sw:re.sw?ee(H,re.sw,0,0,b):$,sc:re.sc?ee(H,re.sc,1,0,b):$,fc:re.fc?ee(H,re.fc,1,0,b):$,fh:re.fh?ee(H,re.fh,0,0,b):$,fs:re.fs?ee(H,re.fs,0,.01,b):$,fb:re.fb?ee(H,re.fb,0,.01,b):$,t:re.t?ee(H,re.t,0,0,b):$},this.s=TextSelectorProp.getTextSelectorProp(H,_.s,b),this.s.t=_.s.t}function TextAnimatorProperty(H,_,b){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=H,this._renderType=_,this._elem=b,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(b)}TextAnimatorProperty.prototype.searchProperties=function(){var H,_=this._textData.a.length,b,$=PropertyFactory.getProp;for(H=0;H<_;H+=1)b=this._textData.a[H],this._animatorsData[H]=new TextAnimatorDataProperty(this._elem,b,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:$(this._elem,this._textData.p.a,0,0,this),f:$(this._elem,this._textData.p.f,0,0,this),l:$(this._elem,this._textData.p.l,0,0,this),r:$(this._elem,this._textData.p.r,0,0,this),p:$(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=$(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(H,_){if(this.lettersChangedFlag=_,!(!this._mdf&&!this._isFirstFrame&&!_&&(!this._hasMaskedPath||!this._pathData.m._mdf))){this._isFirstFrame=!1;var b=this._moreOptions.alignment.v,$=this._animatorsData,ee=this._textData,re=this.mHelper,ae=this._renderType,xe=this.renderedLetters.length,le,fe,ve,Se,Ee=H.l,Ce,Ie,De,Be,Ne,qe,Xe,Ye,Qe,rt,ot,ct,mt,_t,Lt;if(this._hasMaskedPath){if(Lt=this._pathData.m,!this._pathData.n||this._pathData._mdf){var Vt=Lt.v;this._pathData.r.v&&(Vt=Vt.reverse()),Ce={tLength:0,segments:[]},Se=Vt._length-1;var Gt;for(ct=0,ve=0;ve<Se;ve+=1)Gt=bez.buildBezierData(Vt.v[ve],Vt.v[ve+1],[Vt.o[ve][0]-Vt.v[ve][0],Vt.o[ve][1]-Vt.v[ve][1]],[Vt.i[ve+1][0]-Vt.v[ve+1][0],Vt.i[ve+1][1]-Vt.v[ve+1][1]]),Ce.tLength+=Gt.segmentLength,Ce.segments.push(Gt),ct+=Gt.segmentLength;ve=Se,Lt.v.c&&(Gt=bez.buildBezierData(Vt.v[ve],Vt.v[0],[Vt.o[ve][0]-Vt.v[ve][0],Vt.o[ve][1]-Vt.v[ve][1]],[Vt.i[0][0]-Vt.v[0][0],Vt.i[0][1]-Vt.v[0][1]]),Ce.tLength+=Gt.segmentLength,Ce.segments.push(Gt),ct+=Gt.segmentLength),this._pathData.pi=Ce}if(Ce=this._pathData.pi,Ie=this._pathData.f.v,Xe=0,qe=1,Be=0,Ne=!0,rt=Ce.segments,Ie<0&&Lt.v.c)for(Ce.tLength<Math.abs(Ie)&&(Ie=-Math.abs(Ie)%Ce.tLength),Xe=rt.length-1,Qe=rt[Xe].points,qe=Qe.length-1;Ie<0;)Ie+=Qe[qe].partialLength,qe-=1,qe<0&&(Xe-=1,Qe=rt[Xe].points,qe=Qe.length-1);Qe=rt[Xe].points,Ye=Qe[qe-1],De=Qe[qe],ot=De.partialLength}Se=Ee.length,le=0,fe=0;var $t=H.finalSize*1.2*.714,Qt=!0,vt,It,gt,Tt,Ct;Tt=$.length;var Ft,sn=-1,cn,en,yn,Pn=Ie,tr=Xe,nr=qe,Fr=-1,Ur,Kr,on,qr,rr,Qr,Ir,ai,Hr="",Vr=this.defaultPropsArray,xn;if(H.j===2||H.j===1){var Ht=0,In=0,er=H.j===2?-.5:-1,Hn=0,Zn=!0;for(ve=0;ve<Se;ve+=1)if(Ee[ve].n){for(Ht&&(Ht+=In);Hn<ve;)Ee[Hn].animatorJustifyOffset=Ht,Hn+=1;Ht=0,Zn=!0}else{for(gt=0;gt<Tt;gt+=1)vt=$[gt].a,vt.t.propType&&(Zn&&H.j===2&&(In+=vt.t.v*er),It=$[gt].s,Ft=It.getMult(Ee[ve].anIndexes[gt],ee.a[gt].s.totalChars),Ft.length?Ht+=vt.t.v*Ft[0]*er:Ht+=vt.t.v*Ft*er);Zn=!1}for(Ht&&(Ht+=In);Hn<ve;)Ee[Hn].animatorJustifyOffset=Ht,Hn+=1}for(ve=0;ve<Se;ve+=1){if(re.reset(),Ur=1,Ee[ve].n)le=0,fe+=H.yOffset,fe+=Qt?1:0,Ie=Pn,Qt=!1,this._hasMaskedPath&&(Xe=tr,qe=nr,Qe=rt[Xe].points,Ye=Qe[qe-1],De=Qe[qe],ot=De.partialLength,Be=0),Hr="",ai="",Qr="",xn="",Vr=this.defaultPropsArray;else{if(this._hasMaskedPath){if(Fr!==Ee[ve].line){switch(H.j){case 1:Ie+=ct-H.lineWidths[Ee[ve].line];break;case 2:Ie+=(ct-H.lineWidths[Ee[ve].line])/2;break}Fr=Ee[ve].line}sn!==Ee[ve].ind&&(Ee[sn]&&(Ie+=Ee[sn].extra),Ie+=Ee[ve].an/2,sn=Ee[ve].ind),Ie+=b[0]*Ee[ve].an*.005;var Dr=0;for(gt=0;gt<Tt;gt+=1)vt=$[gt].a,vt.p.propType&&(It=$[gt].s,Ft=It.getMult(Ee[ve].anIndexes[gt],ee.a[gt].s.totalChars),Ft.length?Dr+=vt.p.v[0]*Ft[0]:Dr+=vt.p.v[0]*Ft),vt.a.propType&&(It=$[gt].s,Ft=It.getMult(Ee[ve].anIndexes[gt],ee.a[gt].s.totalChars),Ft.length?Dr+=vt.a.v[0]*Ft[0]:Dr+=vt.a.v[0]*Ft);for(Ne=!0,this._pathData.a.v&&(Ie=Ee[0].an*.5+(ct-this._pathData.f.v-Ee[0].an*.5-Ee[Ee.length-1].an*.5)*sn/(Se-1),Ie+=this._pathData.f.v);Ne;)Be+ot>=Ie+Dr||!Qe?(mt=(Ie+Dr-Be)/De.partialLength,en=Ye.point[0]+(De.point[0]-Ye.point[0])*mt,yn=Ye.point[1]+(De.point[1]-Ye.point[1])*mt,re.translate(-b[0]*Ee[ve].an*.005,-(b[1]*$t)*.01),Ne=!1):Qe&&(Be+=De.partialLength,qe+=1,qe>=Qe.length&&(qe=0,Xe+=1,rt[Xe]?Qe=rt[Xe].points:Lt.v.c?(qe=0,Xe=0,Qe=rt[Xe].points):(Be-=De.partialLength,Qe=null)),Qe&&(Ye=De,De=Qe[qe],ot=De.partialLength));cn=Ee[ve].an/2-Ee[ve].add,re.translate(-cn,0,0)}else cn=Ee[ve].an/2-Ee[ve].add,re.translate(-cn,0,0),re.translate(-b[0]*Ee[ve].an*.005,-b[1]*$t*.01,0);for(gt=0;gt<Tt;gt+=1)vt=$[gt].a,vt.t.propType&&(It=$[gt].s,Ft=It.getMult(Ee[ve].anIndexes[gt],ee.a[gt].s.totalChars),(le!==0||H.j!==0)&&(this._hasMaskedPath?Ft.length?Ie+=vt.t.v*Ft[0]:Ie+=vt.t.v*Ft:Ft.length?le+=vt.t.v*Ft[0]:le+=vt.t.v*Ft));for(H.strokeWidthAnim&&(on=H.sw||0),H.strokeColorAnim&&(H.sc?Kr=[H.sc[0],H.sc[1],H.sc[2]]:Kr=[0,0,0]),H.fillColorAnim&&H.fc&&(qr=[H.fc[0],H.fc[1],H.fc[2]]),gt=0;gt<Tt;gt+=1)vt=$[gt].a,vt.a.propType&&(It=$[gt].s,Ft=It.getMult(Ee[ve].anIndexes[gt],ee.a[gt].s.totalChars),Ft.length?re.translate(-vt.a.v[0]*Ft[0],-vt.a.v[1]*Ft[1],vt.a.v[2]*Ft[2]):re.translate(-vt.a.v[0]*Ft,-vt.a.v[1]*Ft,vt.a.v[2]*Ft));for(gt=0;gt<Tt;gt+=1)vt=$[gt].a,vt.s.propType&&(It=$[gt].s,Ft=It.getMult(Ee[ve].anIndexes[gt],ee.a[gt].s.totalChars),Ft.length?re.scale(1+(vt.s.v[0]-1)*Ft[0],1+(vt.s.v[1]-1)*Ft[1],1):re.scale(1+(vt.s.v[0]-1)*Ft,1+(vt.s.v[1]-1)*Ft,1));for(gt=0;gt<Tt;gt+=1){if(vt=$[gt].a,It=$[gt].s,Ft=It.getMult(Ee[ve].anIndexes[gt],ee.a[gt].s.totalChars),vt.sk.propType&&(Ft.length?re.skewFromAxis(-vt.sk.v*Ft[0],vt.sa.v*Ft[1]):re.skewFromAxis(-vt.sk.v*Ft,vt.sa.v*Ft)),vt.r.propType&&(Ft.length?re.rotateZ(-vt.r.v*Ft[2]):re.rotateZ(-vt.r.v*Ft)),vt.ry.propType&&(Ft.length?re.rotateY(vt.ry.v*Ft[1]):re.rotateY(vt.ry.v*Ft)),vt.rx.propType&&(Ft.length?re.rotateX(vt.rx.v*Ft[0]):re.rotateX(vt.rx.v*Ft)),vt.o.propType&&(Ft.length?Ur+=(vt.o.v*Ft[0]-Ur)*Ft[0]:Ur+=(vt.o.v*Ft-Ur)*Ft),H.strokeWidthAnim&&vt.sw.propType&&(Ft.length?on+=vt.sw.v*Ft[0]:on+=vt.sw.v*Ft),H.strokeColorAnim&&vt.sc.propType)for(rr=0;rr<3;rr+=1)Ft.length?Kr[rr]+=(vt.sc.v[rr]-Kr[rr])*Ft[0]:Kr[rr]+=(vt.sc.v[rr]-Kr[rr])*Ft;if(H.fillColorAnim&&H.fc){if(vt.fc.propType)for(rr=0;rr<3;rr+=1)Ft.length?qr[rr]+=(vt.fc.v[rr]-qr[rr])*Ft[0]:qr[rr]+=(vt.fc.v[rr]-qr[rr])*Ft;vt.fh.propType&&(Ft.length?qr=addHueToRGB(qr,vt.fh.v*Ft[0]):qr=addHueToRGB(qr,vt.fh.v*Ft)),vt.fs.propType&&(Ft.length?qr=addSaturationToRGB(qr,vt.fs.v*Ft[0]):qr=addSaturationToRGB(qr,vt.fs.v*Ft)),vt.fb.propType&&(Ft.length?qr=addBrightnessToRGB(qr,vt.fb.v*Ft[0]):qr=addBrightnessToRGB(qr,vt.fb.v*Ft))}}for(gt=0;gt<Tt;gt+=1)vt=$[gt].a,vt.p.propType&&(It=$[gt].s,Ft=It.getMult(Ee[ve].anIndexes[gt],ee.a[gt].s.totalChars),this._hasMaskedPath?Ft.length?re.translate(0,vt.p.v[1]*Ft[0],-vt.p.v[2]*Ft[1]):re.translate(0,vt.p.v[1]*Ft,-vt.p.v[2]*Ft):Ft.length?re.translate(vt.p.v[0]*Ft[0],vt.p.v[1]*Ft[1],-vt.p.v[2]*Ft[2]):re.translate(vt.p.v[0]*Ft,vt.p.v[1]*Ft,-vt.p.v[2]*Ft));if(H.strokeWidthAnim&&(Qr=on<0?0:on),H.strokeColorAnim&&(Ir="rgb("+Math.round(Kr[0]*255)+","+Math.round(Kr[1]*255)+","+Math.round(Kr[2]*255)+")"),H.fillColorAnim&&H.fc&&(ai="rgb("+Math.round(qr[0]*255)+","+Math.round(qr[1]*255)+","+Math.round(qr[2]*255)+")"),this._hasMaskedPath){if(re.translate(0,-H.ls),re.translate(0,b[1]*$t*.01+fe,0),this._pathData.p.v){_t=(De.point[1]-Ye.point[1])/(De.point[0]-Ye.point[0]);var zn=Math.atan(_t)*180/Math.PI;De.point[0]<Ye.point[0]&&(zn+=180),re.rotate(-zn*Math.PI/180)}re.translate(en,yn,0),Ie-=b[0]*Ee[ve].an*.005,Ee[ve+1]&&sn!==Ee[ve+1].ind&&(Ie+=Ee[ve].an/2,Ie+=H.tr*.001*H.finalSize)}else{switch(re.translate(le,fe,0),H.ps&&re.translate(H.ps[0],H.ps[1]+H.ascent,0),H.j){case 1:re.translate(Ee[ve].animatorJustifyOffset+H.justifyOffset+(H.boxWidth-H.lineWidths[Ee[ve].line]),0,0);break;case 2:re.translate(Ee[ve].animatorJustifyOffset+H.justifyOffset+(H.boxWidth-H.lineWidths[Ee[ve].line])/2,0,0);break}re.translate(0,-H.ls),re.translate(cn,0,0),re.translate(b[0]*Ee[ve].an*.005,b[1]*$t*.01,0),le+=Ee[ve].l+H.tr*.001*H.finalSize}ae==="html"?Hr=re.toCSS():ae==="svg"?Hr=re.to2dCSS():Vr=[re.props[0],re.props[1],re.props[2],re.props[3],re.props[4],re.props[5],re.props[6],re.props[7],re.props[8],re.props[9],re.props[10],re.props[11],re.props[12],re.props[13],re.props[14],re.props[15]],xn=Ur}xe<=ve?(Ct=new LetterProps(xn,Qr,Ir,ai,Hr,Vr),this.renderedLetters.push(Ct),xe+=1,this.lettersChangedFlag=!0):(Ct=this.renderedLetters[ve],this.lettersChangedFlag=Ct.update(xn,Qr,Ir,ai,Hr,Vr)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty);function ITextElement(){}ITextElement.prototype.initElement=function(H,_,b){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(H,_,b),this.textProperty=new TextProperty(this,H.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(H.t,this.renderType,this),this.initTransform(H,_,b),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(H){this._mdf=!1,this.prepareRenderableFrame(H),this.prepareProperties(H,this.isInRange)},ITextElement.prototype.createPathShape=function(H,_){var b,$=_.length,ee,re="";for(b=0;b<$;b+=1)_[b].ty==="sh"&&(ee=_[b].ks.k,re+=buildShapeString(ee,ee.i.length,!0,H));return re},ITextElement.prototype.updateDocumentData=function(H,_){this.textProperty.updateDocumentData(H,_)},ITextElement.prototype.canResizeFont=function(H){this.textProperty.canResizeFont(H)},ITextElement.prototype.setMinimumFontSize=function(H){this.textProperty.setMinimumFontSize(H)},ITextElement.prototype.applyTextPropertiesToMatrix=function(H,_,b,$,ee){switch(H.ps&&_.translate(H.ps[0],H.ps[1]+H.ascent,0),_.translate(0,-H.ls,0),H.j){case 1:_.translate(H.justifyOffset+(H.boxWidth-H.lineWidths[b]),0,0);break;case 2:_.translate(H.justifyOffset+(H.boxWidth-H.lineWidths[b])/2,0,0);break}_.translate($,ee,0)},ITextElement.prototype.buildColor=function(H){return"rgb("+Math.round(H[0]*255)+","+Math.round(H[1]*255)+","+Math.round(H[2]*255)+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},ITextElement.prototype.validateText=function(){(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)};var emptyShapeData={shapes:[]};function SVGTextLottieElement(H,_,b){this.textSpans=[],this.renderType="svg",this.initElement(H,_,b)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(H){for(var _=0,b=H.length,$=[],ee="";_<b;)H[_]==="\r"||H[_]===""?($.push(ee),ee=""):ee+=H[_],_+=1;return $.push(ee),$},SVGTextLottieElement.prototype.buildShapeData=function(H,_){if(H.shapes&&H.shapes.length){var b=H.shapes[0];if(b.it){var $=b.it[b.it.length-1];$.s&&($.s.k[0]=_,$.s.k[1]=_)}}return H},SVGTextLottieElement.prototype.buildNewText=function(){this.addDynamicProperty(this);var H,_,b=this.textProperty.currentData;this.renderedLetters=createSizedArray(b?b.l.length:0),b.fc?this.layerElement.setAttribute("fill",this.buildColor(b.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),b.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(b.sc)),this.layerElement.setAttribute("stroke-width",b.sw)),this.layerElement.setAttribute("font-size",b.finalSize);var $=this.globalData.fontManager.getFontByName(b.f);if($.fClass)this.layerElement.setAttribute("class",$.fClass);else{this.layerElement.setAttribute("font-family",$.fFamily);var ee=b.fWeight,re=b.fStyle;this.layerElement.setAttribute("font-style",re),this.layerElement.setAttribute("font-weight",ee)}this.layerElement.setAttribute("aria-label",b.t);var ae=b.l||[],xe=!!this.globalData.fontManager.chars;_=ae.length;var le,fe=this.mHelper,ve="",Se=this.data.singleShape,Ee=0,Ce=0,Ie=!0,De=b.tr*.001*b.finalSize;if(Se&&!xe&&!b.sz){var Be=this.textContainer,Ne="start";switch(b.j){case 1:Ne="end";break;case 2:Ne="middle";break;default:Ne="start";break}Be.setAttribute("text-anchor",Ne),Be.setAttribute("letter-spacing",De);var qe=this.buildTextContents(b.finalText);for(_=qe.length,Ce=b.ps?b.ps[1]+b.ascent:0,H=0;H<_;H+=1)le=this.textSpans[H].span||createNS("tspan"),le.textContent=qe[H],le.setAttribute("x",0),le.setAttribute("y",Ce),le.style.display="inherit",Be.appendChild(le),this.textSpans[H]||(this.textSpans[H]={span:null,glyph:null}),this.textSpans[H].span=le,Ce+=b.finalLineHeight;this.layerElement.appendChild(Be)}else{var Xe=this.textSpans.length,Ye;for(H=0;H<_;H+=1){if(this.textSpans[H]||(this.textSpans[H]={span:null,childSpan:null,glyph:null}),!xe||!Se||H===0){if(le=Xe>H?this.textSpans[H].span:createNS(xe?"g":"text"),Xe<=H){if(le.setAttribute("stroke-linecap","butt"),le.setAttribute("stroke-linejoin","round"),le.setAttribute("stroke-miterlimit","4"),this.textSpans[H].span=le,xe){var Qe=createNS("g");le.appendChild(Qe),this.textSpans[H].childSpan=Qe}this.textSpans[H].span=le,this.layerElement.appendChild(le)}le.style.display="inherit"}if(fe.reset(),Se&&(ae[H].n&&(Ee=-De,Ce+=b.yOffset,Ce+=Ie?1:0,Ie=!1),this.applyTextPropertiesToMatrix(b,fe,ae[H].line,Ee,Ce),Ee+=ae[H].l||0,Ee+=De),xe){Ye=this.globalData.fontManager.getCharData(b.finalText[H],$.fStyle,this.globalData.fontManager.getFontByName(b.f).fFamily);var rt;if(Ye.t===1)rt=new SVGCompElement(Ye.data,this.globalData,this);else{var ot=emptyShapeData;Ye.data&&Ye.data.shapes&&(ot=this.buildShapeData(Ye.data,b.finalSize)),rt=new SVGShapeElement(ot,this.globalData,this)}if(this.textSpans[H].glyph){var ct=this.textSpans[H].glyph;this.textSpans[H].childSpan.removeChild(ct.layerElement),ct.destroy()}this.textSpans[H].glyph=rt,rt._debug=!0,rt.prepareFrame(0),rt.renderFrame(),this.textSpans[H].childSpan.appendChild(rt.layerElement),Ye.t===1&&this.textSpans[H].childSpan.setAttribute("transform","scale("+b.finalSize/100+","+b.finalSize/100+")")}else Se&&le.setAttribute("transform","translate("+fe.props[12]+","+fe.props[13]+")"),le.textContent=ae[H].val,le.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}Se&&le&&le.setAttribute("d",ve)}for(;H<this.textSpans.length;)this.textSpans[H].span.style.display="none",H+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var H=this.layerElement.getBBox();this.bbox={top:H.y,left:H.x,width:H.width,height:H.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var H,_=this.textSpans.length,b;for(this.renderedFrame=this.comp.renderedFrame,H=0;H<_;H+=1)b=this.textSpans[H].glyph,b&&(b.prepareFrame(this.comp.renderedFrame-this.data.st),b._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if(this.validateText(),(!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){this._sizeChanged=!0;var H,_,b=this.textAnimator.renderedLetters,$=this.textProperty.currentData.l;_=$.length;var ee,re,ae;for(H=0;H<_;H+=1)$[H].n||(ee=b[H],re=this.textSpans[H].span,ae=this.textSpans[H].glyph,ae&&ae.renderFrame(),ee._mdf.m&&re.setAttribute("transform",ee.m),ee._mdf.o&&re.setAttribute("opacity",ee.o),ee._mdf.sw&&re.setAttribute("stroke-width",ee.sw),ee._mdf.sc&&re.setAttribute("stroke",ee.sc),ee._mdf.fc&&re.setAttribute("fill",ee.fc))}};function ISolidElement(H,_,b){this.initElement(H,_,b)}extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var H=createNS("rect");H.setAttribute("width",this.data.sw),H.setAttribute("height",this.data.sh),H.setAttribute("fill",this.data.sc),this.layerElement.appendChild(H)};function NullElement(H,_,b){this.initFrame(),this.initBaseData(H,_,b),this.initFrame(),this.initTransform(H,_,b),this.initHierarchy()}NullElement.prototype.prepareFrame=function(H){this.prepareProperties(H,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement);function SVGRendererBase(){}extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(H){return new NullElement(H,this.globalData,this)},SVGRendererBase.prototype.createShape=function(H){return new SVGShapeElement(H,this.globalData,this)},SVGRendererBase.prototype.createText=function(H){return new SVGTextLottieElement(H,this.globalData,this)},SVGRendererBase.prototype.createImage=function(H){return new IImageElement(H,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(H){return new ISolidElement(H,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(H){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+H.w+" "+H.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",H.w),this.svgElement.setAttribute("height",H.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),this.renderConfig.focusable!==void 0&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var _=this.globalData.defs;this.setupGlobalData(H,_),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=H;var b=createNS("clipPath"),$=createNS("rect");$.setAttribute("width",H.w),$.setAttribute("height",H.h),$.setAttribute("x",0),$.setAttribute("y",0);var ee=createElementID();b.setAttribute("id",ee),b.appendChild($),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+ee+")"),_.appendChild(b),this.layers=H.layers,this.elements=createSizedArray(H.layers.length)},SVGRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var H,_=this.layers?this.layers.length:0;for(H=0;H<_;H+=1)this.elements[H]&&this.elements[H].destroy&&this.elements[H].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(H){var _=0,b=this.layers.length;for(_=0;_<b;_+=1)if(this.layers[_].ind===H)return _;return-1},SVGRendererBase.prototype.buildItem=function(H){var _=this.elements;if(!(_[H]||this.layers[H].ty===99)){_[H]=!0;var b=this.createItem(this.layers[H]);if(_[H]=b,getExpressionsPlugin()&&(this.layers[H].ty===0&&this.globalData.projectInterface.registerComposition(b),b.initExpressions()),this.appendElementInPos(b,H),this.layers[H].tt){var $="tp"in this.layers[H]?this.findIndexByInd(this.layers[H].tp):H-1;if($===-1)return;if(!this.elements[$]||this.elements[$]===!0)this.buildItem($),this.addPendingElement(b);else{var ee=_[$],re=ee.getMatte(this.layers[H].tt);b.setMatte(re)}}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var H=this.pendingElements.pop();if(H.checkParenting(),H.data.tt)for(var _=0,b=this.elements.length;_<b;){if(this.elements[_]===H){var $="tp"in H.data?this.findIndexByInd(H.data.tp):_-1,ee=this.elements[$],re=ee.getMatte(this.layers[_].tt);H.setMatte(re);break}_+=1}}},SVGRendererBase.prototype.renderFrame=function(H){if(!(this.renderedFrame===H||this.destroyed)){H===null?H=this.renderedFrame:this.renderedFrame=H,this.globalData.frameNum=H,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=H,this.globalData._mdf=!1;var _,b=this.layers.length;for(this.completeLayers||this.checkLayers(H),_=b-1;_>=0;_-=1)(this.completeLayers||this.elements[_])&&this.elements[_].prepareFrame(H-this.layers[_].st);if(this.globalData._mdf)for(_=0;_<b;_+=1)(this.completeLayers||this.elements[_])&&this.elements[_].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(H,_){var b=H.getBaseElement();if(b){for(var $=0,ee;$<_;)this.elements[$]&&this.elements[$]!==!0&&this.elements[$].getBaseElement()&&(ee=this.elements[$].getBaseElement()),$+=1;ee?this.layerElement.insertBefore(b,ee):this.layerElement.appendChild(b)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"};function ICompElement(){}extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(H,_,b){this.initFrame(),this.initBaseData(H,_,b),this.initTransform(H,_,b),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),(this.data.xt||!_.progressiveLoad)&&this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(H){if(this._mdf=!1,this.prepareRenderableFrame(H),this.prepareProperties(H,this.isInRange),!(!this.isInRange&&!this.data.xt)){if(this.tm._placeholder)this.renderedFrame=H/this.data.sr;else{var _=this.tm.v;_===this.data.op&&(_=this.data.op-1),this.renderedFrame=_}var b,$=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),b=$-1;b>=0;b-=1)(this.completeLayers||this.elements[b])&&(this.elements[b].prepareFrame(this.renderedFrame-this.layers[b].st),this.elements[b]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var H,_=this.layers.length;for(H=0;H<_;H+=1)(this.completeLayers||this.elements[H])&&this.elements[H].renderFrame()},ICompElement.prototype.setElements=function(H){this.elements=H},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var H,_=this.layers.length;for(H=0;H<_;H+=1)this.elements[H]&&this.elements[H].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()};function SVGCompElement(H,_,b){this.layers=H.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(H,_,b),this.tm=H.tm?PropertyFactory.getProp(this,H.tm,0,_.frameRate,this):{_placeholder:!0}}extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(H){return new SVGCompElement(H,this.globalData,this)};function SVGRenderer(H,_){this.animationItem=H,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var b="";if(_&&_.title){var $=createNS("title"),ee=createElementID();$.setAttribute("id",ee),$.textContent=_.title,this.svgElement.appendChild($),b+=ee}if(_&&_.description){var re=createNS("desc"),ae=createElementID();re.setAttribute("id",ae),re.textContent=_.description,this.svgElement.appendChild(re),b+=" "+ae}b&&this.svgElement.setAttribute("aria-labelledby",b);var xe=createNS("defs");this.svgElement.appendChild(xe);var le=createNS("g");this.svgElement.appendChild(le),this.layerElement=le,this.renderConfig={preserveAspectRatio:_&&_.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:_&&_.contentVisibility||"visible",progressiveLoad:_&&_.progressiveLoad||!1,hideOnTransparent:!(_&&_.hideOnTransparent===!1),viewBoxOnly:_&&_.viewBoxOnly||!1,viewBoxSize:_&&_.viewBoxSize||!1,className:_&&_.className||"",id:_&&_.id||"",focusable:_&&_.focusable,filterSize:{width:_&&_.filterSize&&_.filterSize.width||"100%",height:_&&_.filterSize&&_.filterSize.height||"100%",x:_&&_.filterSize&&_.filterSize.x||"0%",y:_&&_.filterSize&&_.filterSize.y||"0%"},width:_&&_.width,height:_&&_.height,runExpressions:!_||_.runExpressions===void 0||_.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:xe,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(H){return new SVGCompElement(H,this.globalData,this)};function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}ShapeTransformManager.prototype={addTransformSequence:function(_){var b,$=_.length,ee="_";for(b=0;b<$;b+=1)ee+=_[b].transform.key+"_";var re=this.sequences[ee];return re||(re={transforms:[].concat(_),finalTransform:new Matrix,_mdf:!1},this.sequences[ee]=re,this.sequenceList.push(re)),re},processSequence:function(_,b){for(var $=0,ee=_.transforms.length,re=b;$<ee&&!b;){if(_.transforms[$].transform.mProps._mdf){re=!0;break}$+=1}if(re)for(_.finalTransform.reset(),$=ee-1;$>=0;$-=1)_.finalTransform.multiply(_.transforms[$].transform.mProps.v);_._mdf=re},processSequences:function(_){var b,$=this.sequenceList.length;for(b=0;b<$;b+=1)this.processSequence(this.sequenceList[b],_)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}};var lumaLoader=function(){var _="__lottie_element_luma_buffer",b=null,$=null,ee=null;function re(){var le=createNS("svg"),fe=createNS("filter"),ve=createNS("feColorMatrix");return fe.setAttribute("id",_),ve.setAttribute("type","matrix"),ve.setAttribute("color-interpolation-filters","sRGB"),ve.setAttribute("values","0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0"),fe.appendChild(ve),le.appendChild(fe),le.setAttribute("id",_+"_svg"),featureSupport.svgLumaHidden&&(le.style.display="none"),le}function ae(){b||(ee=re(),document.body.appendChild(ee),b=createTag("canvas"),$=b.getContext("2d"),$.filter="url(#"+_+")",$.fillStyle="rgba(0,0,0,0)",$.fillRect(0,0,1,1))}function xe(le){return b||ae(),b.width=le.width,b.height=le.height,$.filter="url(#"+_+")",b}return{load:ae,get:xe}};function createCanvas(H,_){if(featureSupport.offscreenCanvas)return new OffscreenCanvas(H,_);var b=createTag("canvas");return b.width=H,b.height=_,b}var assetLoader=function(){return{loadLumaCanvas:lumaLoader.load,getLumaCanvas:lumaLoader.get,createCanvas}}(),registeredEffects={};function CVEffects(H){var _,b=H.data.ef?H.data.ef.length:0;this.filters=[];var $;for(_=0;_<b;_+=1){$=null;var ee=H.data.ef[_].ty;if(registeredEffects[ee]){var re=registeredEffects[ee].effect;$=new re(H.effectsManager.effectElements[_],H)}$&&this.filters.push($)}this.filters.length&&H.addRenderableComponent(this)}CVEffects.prototype.renderFrame=function(H){var _,b=this.filters.length;for(_=0;_<b;_+=1)this.filters[_].renderFrame(H)},CVEffects.prototype.getEffects=function(H){var _,b=this.filters.length,$=[];for(_=0;_<b;_+=1)this.filters[_].type===H&&$.push(this.filters[_]);return $};function registerEffect(H,_){registeredEffects[H]={effect:_}}function CVMaskElement(H,_){this.data=H,this.element=_,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var b,$=this.masksProperties.length,ee=!1;for(b=0;b<$;b+=1)this.masksProperties[b].mode!=="n"&&(ee=!0),this.viewData[b]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[b],3);this.hasMasks=ee,ee&&this.element.addRenderableComponent(this)}CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var H=this.element.finalTransform.mat,_=this.element.canvasContext,b,$=this.masksProperties.length,ee,re,ae;for(_.beginPath(),b=0;b<$;b+=1)if(this.masksProperties[b].mode!=="n"){this.masksProperties[b].inv&&(_.moveTo(0,0),_.lineTo(this.element.globalData.compSize.w,0),_.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),_.lineTo(0,this.element.globalData.compSize.h),_.lineTo(0,0)),ae=this.viewData[b].v,ee=H.applyToPointArray(ae.v[0][0],ae.v[0][1],0),_.moveTo(ee[0],ee[1]);var xe,le=ae._length;for(xe=1;xe<le;xe+=1)re=H.applyToTriplePoints(ae.o[xe-1],ae.i[xe],ae.v[xe]),_.bezierCurveTo(re[0],re[1],re[2],re[3],re[4],re[5]);re=H.applyToTriplePoints(ae.o[xe-1],ae.i[0],ae.v[0]),_.bezierCurveTo(re[0],re[1],re[2],re[3],re[4],re[5])}this.element.globalData.renderer.save(!0),_.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null};function CVBaseElement(){}var operationsMap={1:"source-in",2:"source-out",3:"source-in",4:"source-out"};CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){if(this.data.tt>=1){this.buffers=[];var _=this.globalData.canvasContext,b=assetLoader.createCanvas(_.canvas.width,_.canvas.height);this.buffers.push(b);var $=assetLoader.createCanvas(_.canvas.width,_.canvas.height);this.buffers.push($),this.data.tt>=3&&!document._isProxy&&assetLoader.loadLumaCanvas()}this.canvasContext=this.globalData.canvasContext,this.transformCanvas=this.globalData.transformCanvas,this.renderableEffectsManager=new CVEffects(this),this.searchEffectTransforms()},createContent:function(){},setBlendMode:function(){var _=this.globalData;if(_.blendMode!==this.data.bm){_.blendMode=this.data.bm;var b=getBlendMode(this.data.bm);_.canvasContext.globalCompositeOperation=b}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this),this.transformEffects=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT)},hideElement:function(){!this.hidden&&(!this.isInRange||this.isTransparent)&&(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},clearCanvas:function(_){_.clearRect(this.transformCanvas.tx,this.transformCanvas.ty,this.transformCanvas.w*this.transformCanvas.sx,this.transformCanvas.h*this.transformCanvas.sy)},prepareLayer:function(){if(this.data.tt>=1){var _=this.buffers[0],b=_.getContext("2d");this.clearCanvas(b),b.drawImage(this.canvasContext.canvas,0,0),this.currentTransform=this.canvasContext.getTransform(),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform)}},exitLayer:function(){if(this.data.tt>=1){var _=this.buffers[1],b=_.getContext("2d");this.clearCanvas(b),b.drawImage(this.canvasContext.canvas,0,0),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform);var $=this.comp.getElementById("tp"in this.data?this.data.tp:this.data.ind-1);if($.renderFrame(!0),this.canvasContext.setTransform(1,0,0,1,0,0),this.data.tt>=3&&!document._isProxy){var ee=assetLoader.getLumaCanvas(this.canvasContext.canvas),re=ee.getContext("2d");re.drawImage(this.canvasContext.canvas,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.drawImage(ee,0,0)}this.canvasContext.globalCompositeOperation=operationsMap[this.data.tt],this.canvasContext.drawImage(_,0,0),this.canvasContext.globalCompositeOperation="destination-over",this.canvasContext.drawImage(this.buffers[0],0,0),this.canvasContext.setTransform(this.currentTransform),this.canvasContext.globalCompositeOperation="source-over"}},renderFrame:function(_){if(!(this.hidden||this.data.hd)&&!(this.data.td===1&&!_)){this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.setBlendMode();var b=this.data.ty===0;this.prepareLayer(),this.globalData.renderer.save(b),this.globalData.renderer.ctxTransform(this.finalTransform.localMat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.localOpacity),this.renderInnerContent(),this.globalData.renderer.restore(b),this.exitLayer(),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement;function CVShapeData(H,_,b,$){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var ee=4;_.ty==="rc"?ee=5:_.ty==="el"?ee=6:_.ty==="sr"&&(ee=7),this.sh=ShapePropertyFactory.getShapeProp(H,_,ee,H);var re,ae=b.length,xe;for(re=0;re<ae;re+=1)b[re].closed||(xe={transforms:$.addTransformSequence(b[re].transforms),trNodes:[]},this.styledShapes.push(xe),b[re].elements.push(xe))}CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated;function CVShapeElement(H,_,b){this.shapes=[],this.shapesData=H.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(H,_,b)}extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(H,_){var b={data:H,type:H.ty,preTransforms:this.transformsManager.addTransformSequence(_),transforms:[],elements:[],closed:H.hd===!0},$={};if(H.ty==="fl"||H.ty==="st"?($.c=PropertyFactory.getProp(this,H.c,1,255,this),$.c.k||(b.co="rgb("+bmFloor($.c.v[0])+","+bmFloor($.c.v[1])+","+bmFloor($.c.v[2])+")")):(H.ty==="gf"||H.ty==="gs")&&($.s=PropertyFactory.getProp(this,H.s,1,null,this),$.e=PropertyFactory.getProp(this,H.e,1,null,this),$.h=PropertyFactory.getProp(this,H.h||{k:0},0,.01,this),$.a=PropertyFactory.getProp(this,H.a||{k:0},0,degToRads,this),$.g=new GradientProperty(this,H.g,this)),$.o=PropertyFactory.getProp(this,H.o,0,.01,this),H.ty==="st"||H.ty==="gs"){if(b.lc=lineCapEnum[H.lc||2],b.lj=lineJoinEnum[H.lj||2],H.lj==1&&(b.ml=H.ml),$.w=PropertyFactory.getProp(this,H.w,0,null,this),$.w.k||(b.wi=$.w.v),H.d){var ee=new DashProperty(this,H.d,"canvas",this);$.d=ee,$.d.k||(b.da=$.d.dashArray,b.do=$.d.dashoffset[0])}}else b.r=H.r===2?"evenodd":"nonzero";return this.stylesList.push(b),$.style=b,$},CVShapeElement.prototype.createGroupElement=function(){var H={it:[],prevViewData:[]};return H},CVShapeElement.prototype.createTransformElement=function(H){var _={transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,H.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,H,this)}};return _},CVShapeElement.prototype.createShapeElement=function(H){var _=new CVShapeData(this,H,this.stylesList,this.transformsManager);return this.shapes.push(_),this.addShapeToModifiers(_),_},CVShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;var H,_=this.itemsData.length;for(H=0;H<_;H+=1)this.prevViewData[H]=this.itemsData[H];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),_=this.dynamicProperties.length,H=0;H<_;H+=1)this.dynamicProperties[H].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(H){var _,b=this.stylesList.length;for(_=0;_<b;_+=1)this.stylesList[_].closed||this.stylesList[_].transforms.push(H)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var H,_=this.stylesList.length;for(H=0;H<_;H+=1)this.stylesList[H].closed||this.stylesList[H].transforms.pop()},CVShapeElement.prototype.closeStyles=function(H){var _,b=H.length;for(_=0;_<b;_+=1)H[_].closed=!0},CVShapeElement.prototype.searchShapes=function(H,_,b,$,ee){var re,ae=H.length-1,xe,le,fe=[],ve=[],Se,Ee,Ce,Ie=[].concat(ee);for(re=ae;re>=0;re-=1){if(Se=this.searchProcessedElement(H[re]),Se?_[re]=b[Se-1]:H[re]._shouldRender=$,H[re].ty==="fl"||H[re].ty==="st"||H[re].ty==="gf"||H[re].ty==="gs")Se?_[re].style.closed=!1:_[re]=this.createStyleElement(H[re],Ie),fe.push(_[re].style);else if(H[re].ty==="gr"){if(!Se)_[re]=this.createGroupElement(H[re]);else for(le=_[re].it.length,xe=0;xe<le;xe+=1)_[re].prevViewData[xe]=_[re].it[xe];this.searchShapes(H[re].it,_[re].it,_[re].prevViewData,$,Ie)}else H[re].ty==="tr"?(Se||(Ce=this.createTransformElement(H[re]),_[re]=Ce),Ie.push(_[re]),this.addTransformToStyleList(_[re])):H[re].ty==="sh"||H[re].ty==="rc"||H[re].ty==="el"||H[re].ty==="sr"?Se||(_[re]=this.createShapeElement(H[re])):H[re].ty==="tm"||H[re].ty==="rd"||H[re].ty==="pb"||H[re].ty==="zz"||H[re].ty==="op"?(Se?(Ee=_[re],Ee.closed=!1):(Ee=ShapeModifiers.getModifier(H[re].ty),Ee.init(this,H[re]),_[re]=Ee,this.shapeModifiers.push(Ee)),ve.push(Ee)):H[re].ty==="rp"&&(Se?(Ee=_[re],Ee.closed=!0):(Ee=ShapeModifiers.getModifier(H[re].ty),_[re]=Ee,Ee.init(this,H,re,_),this.shapeModifiers.push(Ee),$=!1),ve.push(Ee));this.addProcessedElement(H[re],re+1)}for(this.removeTransformFromStyleList(),this.closeStyles(fe),ae=ve.length,re=0;re<ae;re+=1)ve[re].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(H,_){(H._opMdf||_.op._mdf||this._isFirstFrame)&&(_.opacity=H.opacity,_.opacity*=_.op.v,_._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var H,_=this.stylesList.length,b,$,ee,re,ae,xe,le=this.globalData.renderer,fe=this.globalData.canvasContext,ve,Se;for(H=0;H<_;H+=1)if(Se=this.stylesList[H],ve=Se.type,!((ve==="st"||ve==="gs")&&Se.wi===0||!Se.data._shouldRender||Se.coOp===0||this.globalData.currentGlobalAlpha===0)){for(le.save(),ae=Se.elements,ve==="st"||ve==="gs"?(le.ctxStrokeStyle(ve==="st"?Se.co:Se.grd),le.ctxLineWidth(Se.wi),le.ctxLineCap(Se.lc),le.ctxLineJoin(Se.lj),le.ctxMiterLimit(Se.ml||0)):le.ctxFillStyle(ve==="fl"?Se.co:Se.grd),le.ctxOpacity(Se.coOp),ve!=="st"&&ve!=="gs"&&fe.beginPath(),le.ctxTransform(Se.preTransforms.finalTransform.props),$=ae.length,b=0;b<$;b+=1){for((ve==="st"||ve==="gs")&&(fe.beginPath(),Se.da&&(fe.setLineDash(Se.da),fe.lineDashOffset=Se.do)),xe=ae[b].trNodes,re=xe.length,ee=0;ee<re;ee+=1)xe[ee].t==="m"?fe.moveTo(xe[ee].p[0],xe[ee].p[1]):xe[ee].t==="c"?fe.bezierCurveTo(xe[ee].pts[0],xe[ee].pts[1],xe[ee].pts[2],xe[ee].pts[3],xe[ee].pts[4],xe[ee].pts[5]):fe.closePath();(ve==="st"||ve==="gs")&&(le.ctxStroke(),Se.da&&fe.setLineDash(this.dashResetter))}ve!=="st"&&ve!=="gs"&&this.globalData.renderer.ctxFill(Se.r),le.restore()}},CVShapeElement.prototype.renderShape=function(H,_,b,$){var ee,re=_.length-1,ae;for(ae=H,ee=re;ee>=0;ee-=1)_[ee].ty==="tr"?(ae=b[ee].transform,this.renderShapeTransform(H,ae)):_[ee].ty==="sh"||_[ee].ty==="el"||_[ee].ty==="rc"||_[ee].ty==="sr"?this.renderPath(_[ee],b[ee]):_[ee].ty==="fl"?this.renderFill(_[ee],b[ee],ae):_[ee].ty==="st"?this.renderStroke(_[ee],b[ee],ae):_[ee].ty==="gf"||_[ee].ty==="gs"?this.renderGradientFill(_[ee],b[ee],ae):_[ee].ty==="gr"?this.renderShape(ae,_[ee].it,b[ee].it):_[ee].ty;$&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(H,_){if(this._isFirstFrame||_._mdf||H.transforms._mdf){var b=H.trNodes,$=_.paths,ee,re,ae,xe=$._length;b.length=0;var le=H.transforms.finalTransform;for(ae=0;ae<xe;ae+=1){var fe=$.shapes[ae];if(fe&&fe.v){for(re=fe._length,ee=1;ee<re;ee+=1)ee===1&&b.push({t:"m",p:le.applyToPointArray(fe.v[0][0],fe.v[0][1],0)}),b.push({t:"c",pts:le.applyToTriplePoints(fe.o[ee-1],fe.i[ee],fe.v[ee])});re===1&&b.push({t:"m",p:le.applyToPointArray(fe.v[0][0],fe.v[0][1],0)}),fe.c&&re&&(b.push({t:"c",pts:le.applyToTriplePoints(fe.o[ee-1],fe.i[0],fe.v[0])}),b.push({t:"z"}))}}H.trNodes=b}},CVShapeElement.prototype.renderPath=function(H,_){if(H.hd!==!0&&H._shouldRender){var b,$=_.styledShapes.length;for(b=0;b<$;b+=1)this.renderStyledShape(_.styledShapes[b],_.sh)}},CVShapeElement.prototype.renderFill=function(H,_,b){var $=_.style;(_.c._mdf||this._isFirstFrame)&&($.co="rgb("+bmFloor(_.c.v[0])+","+bmFloor(_.c.v[1])+","+bmFloor(_.c.v[2])+")"),(_.o._mdf||b._opMdf||this._isFirstFrame)&&($.coOp=_.o.v*b.opacity)},CVShapeElement.prototype.renderGradientFill=function(H,_,b){var $=_.style,ee;if(!$.grd||_.g._mdf||_.s._mdf||_.e._mdf||H.t!==1&&(_.h._mdf||_.a._mdf)){var re=this.globalData.canvasContext,ae=_.s.v,xe=_.e.v;if(H.t===1)ee=re.createLinearGradient(ae[0],ae[1],xe[0],xe[1]);else{var le=Math.sqrt(Math.pow(ae[0]-xe[0],2)+Math.pow(ae[1]-xe[1],2)),fe=Math.atan2(xe[1]-ae[1],xe[0]-ae[0]),ve=_.h.v;ve>=1?ve=.99:ve<=-1&&(ve=-.99);var Se=le*ve,Ee=Math.cos(fe+_.a.v)*Se+ae[0],Ce=Math.sin(fe+_.a.v)*Se+ae[1];ee=re.createRadialGradient(Ee,Ce,0,ae[0],ae[1],le)}var Ie,De=H.g.p,Be=_.g.c,Ne=1;for(Ie=0;Ie<De;Ie+=1)_.g._hasOpacity&&_.g._collapsable&&(Ne=_.g.o[Ie*2+1]),ee.addColorStop(Be[Ie*4]/100,"rgba("+Be[Ie*4+1]+","+Be[Ie*4+2]+","+Be[Ie*4+3]+","+Ne+")");$.grd=ee}$.coOp=_.o.v*b.opacity},CVShapeElement.prototype.renderStroke=function(H,_,b){var $=_.style,ee=_.d;ee&&(ee._mdf||this._isFirstFrame)&&($.da=ee.dashArray,$.do=ee.dashoffset[0]),(_.c._mdf||this._isFirstFrame)&&($.co="rgb("+bmFloor(_.c.v[0])+","+bmFloor(_.c.v[1])+","+bmFloor(_.c.v[2])+")"),(_.o._mdf||b._opMdf||this._isFirstFrame)&&($.coOp=_.o.v*b.opacity),(_.w._mdf||this._isFirstFrame)&&($.wi=_.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0};function CVTextElement(H,_,b){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(H,_,b)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var H=this.textProperty.currentData;this.renderedLetters=createSizedArray(H.l?H.l.length:0);var _=!1;H.fc?(_=!0,this.values.fill=this.buildColor(H.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=_;var b=!1;H.sc&&(b=!0,this.values.stroke=this.buildColor(H.sc),this.values.sWidth=H.sw);var $=this.globalData.fontManager.getFontByName(H.f),ee,re,ae=H.l,xe=this.mHelper;this.stroke=b,this.values.fValue=H.finalSize+"px "+this.globalData.fontManager.getFontByName(H.f).fFamily,re=H.finalText.length;var le,fe,ve,Se,Ee,Ce,Ie,De,Be,Ne,qe=this.data.singleShape,Xe=H.tr*.001*H.finalSize,Ye=0,Qe=0,rt=!0,ot=0;for(ee=0;ee<re;ee+=1){le=this.globalData.fontManager.getCharData(H.finalText[ee],$.fStyle,this.globalData.fontManager.getFontByName(H.f).fFamily),fe=le&&le.data||{},xe.reset(),qe&&ae[ee].n&&(Ye=-Xe,Qe+=H.yOffset,Qe+=rt?1:0,rt=!1),Ee=fe.shapes?fe.shapes[0].it:[],Ie=Ee.length,xe.scale(H.finalSize/100,H.finalSize/100),qe&&this.applyTextPropertiesToMatrix(H,xe,ae[ee].line,Ye,Qe),Be=createSizedArray(Ie-1);var ct=0;for(Ce=0;Ce<Ie;Ce+=1)if(Ee[Ce].ty==="sh"){for(Se=Ee[Ce].ks.k.i.length,De=Ee[Ce].ks.k,Ne=[],ve=1;ve<Se;ve+=1)ve===1&&Ne.push(xe.applyToX(De.v[0][0],De.v[0][1],0),xe.applyToY(De.v[0][0],De.v[0][1],0)),Ne.push(xe.applyToX(De.o[ve-1][0],De.o[ve-1][1],0),xe.applyToY(De.o[ve-1][0],De.o[ve-1][1],0),xe.applyToX(De.i[ve][0],De.i[ve][1],0),xe.applyToY(De.i[ve][0],De.i[ve][1],0),xe.applyToX(De.v[ve][0],De.v[ve][1],0),xe.applyToY(De.v[ve][0],De.v[ve][1],0));Ne.push(xe.applyToX(De.o[ve-1][0],De.o[ve-1][1],0),xe.applyToY(De.o[ve-1][0],De.o[ve-1][1],0),xe.applyToX(De.i[0][0],De.i[0][1],0),xe.applyToY(De.i[0][0],De.i[0][1],0),xe.applyToX(De.v[0][0],De.v[0][1],0),xe.applyToY(De.v[0][0],De.v[0][1],0)),Be[ct]=Ne,ct+=1}qe&&(Ye+=ae[ee].l,Ye+=Xe),this.textSpans[ot]?this.textSpans[ot].elem=Be:this.textSpans[ot]={elem:Be},ot+=1}},CVTextElement.prototype.renderInnerContent=function(){this.validateText();var H=this.canvasContext;H.font=this.values.fValue,this.globalData.renderer.ctxLineCap("butt"),this.globalData.renderer.ctxLineJoin("miter"),this.globalData.renderer.ctxMiterLimit(4),this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var _,b,$,ee,re,ae,xe=this.textAnimator.renderedLetters,le=this.textProperty.currentData.l;b=le.length;var fe,ve=null,Se=null,Ee=null,Ce,Ie,De=this.globalData.renderer;for(_=0;_<b;_+=1)if(!le[_].n){if(fe=xe[_],fe&&(De.save(),De.ctxTransform(fe.p),De.ctxOpacity(fe.o)),this.fill){for(fe&&fe.fc?ve!==fe.fc&&(De.ctxFillStyle(fe.fc),ve=fe.fc):ve!==this.values.fill&&(ve=this.values.fill,De.ctxFillStyle(this.values.fill)),Ce=this.textSpans[_].elem,ee=Ce.length,this.globalData.canvasContext.beginPath(),$=0;$<ee;$+=1)for(Ie=Ce[$],ae=Ie.length,this.globalData.canvasContext.moveTo(Ie[0],Ie[1]),re=2;re<ae;re+=6)this.globalData.canvasContext.bezierCurveTo(Ie[re],Ie[re+1],Ie[re+2],Ie[re+3],Ie[re+4],Ie[re+5]);this.globalData.canvasContext.closePath(),De.ctxFill()}if(this.stroke){for(fe&&fe.sw?Ee!==fe.sw&&(Ee=fe.sw,De.ctxLineWidth(fe.sw)):Ee!==this.values.sWidth&&(Ee=this.values.sWidth,De.ctxLineWidth(this.values.sWidth)),fe&&fe.sc?Se!==fe.sc&&(Se=fe.sc,De.ctxStrokeStyle(fe.sc)):Se!==this.values.stroke&&(Se=this.values.stroke,De.ctxStrokeStyle(this.values.stroke)),Ce=this.textSpans[_].elem,ee=Ce.length,this.globalData.canvasContext.beginPath(),$=0;$<ee;$+=1)for(Ie=Ce[$],ae=Ie.length,this.globalData.canvasContext.moveTo(Ie[0],Ie[1]),re=2;re<ae;re+=6)this.globalData.canvasContext.bezierCurveTo(Ie[re],Ie[re+1],Ie[re+2],Ie[re+3],Ie[re+4],Ie[re+5]);this.globalData.canvasContext.closePath(),De.ctxStroke()}fe&&this.globalData.renderer.restore()}};function CVImageElement(H,_,b){this.assetData=_.getAssetData(H.refId),this.img=_.imageLoader.getAsset(this.assetData),this.initElement(H,_,b)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var H=createTag("canvas");H.width=this.assetData.w,H.height=this.assetData.h;var _=H.getContext("2d"),b=this.img.width,$=this.img.height,ee=b/$,re=this.assetData.w/this.assetData.h,ae,xe,le=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;ee>re&&le==="xMidYMid slice"||ee<re&&le!=="xMidYMid slice"?(xe=$,ae=xe*re):(ae=b,xe=ae/re),_.drawImage(this.img,(b-ae)/2,($-xe)/2,ae,xe,0,0,this.assetData.w,this.assetData.h),this.img=H}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null};function CVSolidElement(H,_,b){this.initElement(H,_,b)}extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){this.globalData.renderer.ctxFillStyle(this.data.sc),this.globalData.renderer.ctxFillRect(0,0,this.data.sw,this.data.sh)};function CanvasRendererBase(){}extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(H){return new CVShapeElement(H,this.globalData,this)},CanvasRendererBase.prototype.createText=function(H){return new CVTextElement(H,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(H){return new CVImageElement(H,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(H){return new CVSolidElement(H,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(H){H[0]===1&&H[1]===0&&H[4]===0&&H[5]===1&&H[12]===0&&H[13]===0||this.canvasContext.transform(H[0],H[1],H[4],H[5],H[12],H[13])},CanvasRendererBase.prototype.ctxOpacity=function(H){this.canvasContext.globalAlpha*=H<0?0:H},CanvasRendererBase.prototype.ctxFillStyle=function(H){this.canvasContext.fillStyle=H},CanvasRendererBase.prototype.ctxStrokeStyle=function(H){this.canvasContext.strokeStyle=H},CanvasRendererBase.prototype.ctxLineWidth=function(H){this.canvasContext.lineWidth=H},CanvasRendererBase.prototype.ctxLineCap=function(H){this.canvasContext.lineCap=H},CanvasRendererBase.prototype.ctxLineJoin=function(H){this.canvasContext.lineJoin=H},CanvasRendererBase.prototype.ctxMiterLimit=function(H){this.canvasContext.miterLimit=H},CanvasRendererBase.prototype.ctxFill=function(H){this.canvasContext.fill(H)},CanvasRendererBase.prototype.ctxFillRect=function(H,_,b,$){this.canvasContext.fillRect(H,_,b,$)},CanvasRendererBase.prototype.ctxStroke=function(){this.canvasContext.stroke()},CanvasRendererBase.prototype.reset=function(){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}this.contextData.reset()},CanvasRendererBase.prototype.save=function(){this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(H){if(!this.renderConfig.clearCanvas){this.canvasContext.restore();return}H&&(this.globalData.blendMode="source-over"),this.contextData.restore(H)},CanvasRendererBase.prototype.configAnimation=function(H){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var _=this.animationItem.container.style;_.width="100%",_.height="100%";var b="0px 0px 0px";_.transformOrigin=b,_.mozTransformOrigin=b,_.webkitTransformOrigin=b,_["-webkit-transform"]=b,_.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.contextData.setContext(this.canvasContext),this.data=H,this.layers=H.layers,this.transformCanvas={w:H.w,h:H.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(H,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(H.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(H,_){this.reset();var b,$;H?(b=H,$=_,this.canvasContext.canvas.width=b,this.canvasContext.canvas.height=$):(this.animationItem.wrapper&&this.animationItem.container?(b=this.animationItem.wrapper.offsetWidth,$=this.animationItem.wrapper.offsetHeight):(b=this.canvasContext.canvas.width,$=this.canvasContext.canvas.height),this.canvasContext.canvas.width=b*this.renderConfig.dpr,this.canvasContext.canvas.height=$*this.renderConfig.dpr);var ee,re;if(this.renderConfig.preserveAspectRatio.indexOf("meet")!==-1||this.renderConfig.preserveAspectRatio.indexOf("slice")!==-1){var ae=this.renderConfig.preserveAspectRatio.split(" "),xe=ae[1]||"meet",le=ae[0]||"xMidYMid",fe=le.substr(0,4),ve=le.substr(4);ee=b/$,re=this.transformCanvas.w/this.transformCanvas.h,re>ee&&xe==="meet"||re<ee&&xe==="slice"?(this.transformCanvas.sx=b/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=b/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=$/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=$/(this.transformCanvas.h/this.renderConfig.dpr)),fe==="xMid"&&(re<ee&&xe==="meet"||re>ee&&xe==="slice")?this.transformCanvas.tx=(b-this.transformCanvas.w*($/this.transformCanvas.h))/2*this.renderConfig.dpr:fe==="xMax"&&(re<ee&&xe==="meet"||re>ee&&xe==="slice")?this.transformCanvas.tx=(b-this.transformCanvas.w*($/this.transformCanvas.h))*this.renderConfig.dpr:this.transformCanvas.tx=0,ve==="YMid"&&(re>ee&&xe==="meet"||re<ee&&xe==="slice")?this.transformCanvas.ty=($-this.transformCanvas.h*(b/this.transformCanvas.w))/2*this.renderConfig.dpr:ve==="YMax"&&(re>ee&&xe==="meet"||re<ee&&xe==="slice")?this.transformCanvas.ty=($-this.transformCanvas.h*(b/this.transformCanvas.w))*this.renderConfig.dpr:this.transformCanvas.ty=0}else this.renderConfig.preserveAspectRatio==="none"?(this.transformCanvas.sx=b/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=$/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText="");var H,_=this.layers?this.layers.length:0;for(H=_-1;H>=0;H-=1)this.elements[H]&&this.elements[H].destroy&&this.elements[H].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(H,_){if(!(this.renderedFrame===H&&this.renderConfig.clearCanvas===!0&&!_||this.destroyed||H===-1)){this.renderedFrame=H,this.globalData.frameNum=H-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||_,this.globalData.projectInterface.currentFrame=H;var b,$=this.layers.length;for(this.completeLayers||this.checkLayers(H),b=$-1;b>=0;b-=1)(this.completeLayers||this.elements[b])&&this.elements[b].prepareFrame(H-this.layers[b].st);if(this.globalData._mdf){for(this.renderConfig.clearCanvas===!0?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),b=$-1;b>=0;b-=1)(this.completeLayers||this.elements[b])&&this.elements[b].renderFrame();this.renderConfig.clearCanvas!==!0&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(H){var _=this.elements;if(!(_[H]||this.layers[H].ty===99)){var b=this.createItem(this.layers[H],this,this.globalData);_[H]=b,b.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var H=this.pendingElements.pop();H.checkParenting()}},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"};function CanvasContext(){this.opacity=-1,this.transform=createTypedArray("float32",16),this.fillStyle="",this.strokeStyle="",this.lineWidth="",this.lineCap="",this.lineJoin="",this.miterLimit="",this.id=Math.random()}function CVContextData(){this.stack=[],this.cArrPos=0,this.cTr=new Matrix;var H,_=15;for(H=0;H<_;H+=1){var b=new CanvasContext;this.stack[H]=b}this._length=_,this.nativeContext=null,this.transformMat=new Matrix,this.currentOpacity=1,this.currentFillStyle="",this.appliedFillStyle="",this.currentStrokeStyle="",this.appliedStrokeStyle="",this.currentLineWidth="",this.appliedLineWidth="",this.currentLineCap="",this.appliedLineCap="",this.currentLineJoin="",this.appliedLineJoin="",this.appliedMiterLimit="",this.currentMiterLimit=""}CVContextData.prototype.duplicate=function(){var H=this._length*2,_=0;for(_=this._length;_<H;_+=1)this.stack[_]=new CanvasContext;this._length=H},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.stack[this.cArrPos].opacity=1},CVContextData.prototype.restore=function(H){this.cArrPos-=1;var _=this.stack[this.cArrPos],b=_.transform,$,ee=this.cTr.props;for($=0;$<16;$+=1)ee[$]=b[$];if(H){this.nativeContext.restore();var re=this.stack[this.cArrPos+1];this.appliedFillStyle=re.fillStyle,this.appliedStrokeStyle=re.strokeStyle,this.appliedLineWidth=re.lineWidth,this.appliedLineCap=re.lineCap,this.appliedLineJoin=re.lineJoin,this.appliedMiterLimit=re.miterLimit}this.nativeContext.setTransform(b[0],b[1],b[4],b[5],b[12],b[13]),(H||_.opacity!==-1&&this.currentOpacity!==_.opacity)&&(this.nativeContext.globalAlpha=_.opacity,this.currentOpacity=_.opacity),this.currentFillStyle=_.fillStyle,this.currentStrokeStyle=_.strokeStyle,this.currentLineWidth=_.lineWidth,this.currentLineCap=_.lineCap,this.currentLineJoin=_.lineJoin,this.currentMiterLimit=_.miterLimit},CVContextData.prototype.save=function(H){H&&this.nativeContext.save();var _=this.cTr.props;this._length<=this.cArrPos&&this.duplicate();var b=this.stack[this.cArrPos],$;for($=0;$<16;$+=1)b.transform[$]=_[$];this.cArrPos+=1;var ee=this.stack[this.cArrPos];ee.opacity=b.opacity,ee.fillStyle=b.fillStyle,ee.strokeStyle=b.strokeStyle,ee.lineWidth=b.lineWidth,ee.lineCap=b.lineCap,ee.lineJoin=b.lineJoin,ee.miterLimit=b.miterLimit},CVContextData.prototype.setOpacity=function(H){this.stack[this.cArrPos].opacity=H},CVContextData.prototype.setContext=function(H){this.nativeContext=H},CVContextData.prototype.fillStyle=function(H){this.stack[this.cArrPos].fillStyle!==H&&(this.currentFillStyle=H,this.stack[this.cArrPos].fillStyle=H)},CVContextData.prototype.strokeStyle=function(H){this.stack[this.cArrPos].strokeStyle!==H&&(this.currentStrokeStyle=H,this.stack[this.cArrPos].strokeStyle=H)},CVContextData.prototype.lineWidth=function(H){this.stack[this.cArrPos].lineWidth!==H&&(this.currentLineWidth=H,this.stack[this.cArrPos].lineWidth=H)},CVContextData.prototype.lineCap=function(H){this.stack[this.cArrPos].lineCap!==H&&(this.currentLineCap=H,this.stack[this.cArrPos].lineCap=H)},CVContextData.prototype.lineJoin=function(H){this.stack[this.cArrPos].lineJoin!==H&&(this.currentLineJoin=H,this.stack[this.cArrPos].lineJoin=H)},CVContextData.prototype.miterLimit=function(H){this.stack[this.cArrPos].miterLimit!==H&&(this.currentMiterLimit=H,this.stack[this.cArrPos].miterLimit=H)},CVContextData.prototype.transform=function(H){this.transformMat.cloneFromProps(H);var _=this.cTr;this.transformMat.multiply(_),_.cloneFromProps(this.transformMat.props);var b=_.props;this.nativeContext.setTransform(b[0],b[1],b[4],b[5],b[12],b[13])},CVContextData.prototype.opacity=function(H){var _=this.stack[this.cArrPos].opacity;_*=H<0?0:H,this.stack[this.cArrPos].opacity!==_&&(this.currentOpacity!==H&&(this.nativeContext.globalAlpha=H,this.currentOpacity=H),this.stack[this.cArrPos].opacity=_)},CVContextData.prototype.fill=function(H){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fill(H)},CVContextData.prototype.fillRect=function(H,_,b,$){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fillRect(H,_,b,$)},CVContextData.prototype.stroke=function(){this.appliedStrokeStyle!==this.currentStrokeStyle&&(this.appliedStrokeStyle=this.currentStrokeStyle,this.nativeContext.strokeStyle=this.appliedStrokeStyle),this.appliedLineWidth!==this.currentLineWidth&&(this.appliedLineWidth=this.currentLineWidth,this.nativeContext.lineWidth=this.appliedLineWidth),this.appliedLineCap!==this.currentLineCap&&(this.appliedLineCap=this.currentLineCap,this.nativeContext.lineCap=this.appliedLineCap),this.appliedLineJoin!==this.currentLineJoin&&(this.appliedLineJoin=this.currentLineJoin,this.nativeContext.lineJoin=this.appliedLineJoin),this.appliedMiterLimit!==this.currentMiterLimit&&(this.appliedMiterLimit=this.currentMiterLimit,this.nativeContext.miterLimit=this.appliedMiterLimit),this.nativeContext.stroke()};function CVCompElement(H,_,b){this.completeLayers=!1,this.layers=H.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(H,_,b),this.tm=H.tm?PropertyFactory.getProp(this,H.tm,0,_.frameRate,this):{_placeholder:!0}}extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var H=this.canvasContext;H.beginPath(),H.moveTo(0,0),H.lineTo(this.data.w,0),H.lineTo(this.data.w,this.data.h),H.lineTo(0,this.data.h),H.lineTo(0,0),H.clip();var _,b=this.layers.length;for(_=b-1;_>=0;_-=1)(this.completeLayers||this.elements[_])&&this.elements[_].renderFrame()},CVCompElement.prototype.destroy=function(){var H,_=this.layers.length;for(H=_-1;H>=0;H-=1)this.elements[H]&&this.elements[H].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(H){return new CVCompElement(H,this.globalData,this)};function CanvasRenderer(H,_){this.animationItem=H,this.renderConfig={clearCanvas:_&&_.clearCanvas!==void 0?_.clearCanvas:!0,context:_&&_.context||null,progressiveLoad:_&&_.progressiveLoad||!1,preserveAspectRatio:_&&_.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:_&&_.contentVisibility||"visible",className:_&&_.className||"",id:_&&_.id||"",runExpressions:!_||_.runExpressions===void 0||_.runExpressions},this.renderConfig.dpr=_&&_.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=_&&_.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas",this.renderConfig.clearCanvas&&(this.ctxTransform=this.contextData.transform.bind(this.contextData),this.ctxOpacity=this.contextData.opacity.bind(this.contextData),this.ctxFillStyle=this.contextData.fillStyle.bind(this.contextData),this.ctxStrokeStyle=this.contextData.strokeStyle.bind(this.contextData),this.ctxLineWidth=this.contextData.lineWidth.bind(this.contextData),this.ctxLineCap=this.contextData.lineCap.bind(this.contextData),this.ctxLineJoin=this.contextData.lineJoin.bind(this.contextData),this.ctxMiterLimit=this.contextData.miterLimit.bind(this.contextData),this.ctxFill=this.contextData.fill.bind(this.contextData),this.ctxFillRect=this.contextData.fillRect.bind(this.contextData),this.ctxStroke=this.contextData.stroke.bind(this.contextData),this.save=this.contextData.save.bind(this.contextData))}extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(H){return new CVCompElement(H,this.globalData,this)};function HBaseElement(){}HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.bm!==0&&this.setBlendMode()},renderElement:function(){var _=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var b=this.finalTransform.mat.toCSS();_.transform=b,_.webkitTransform=b}this.finalTransform._opMdf&&(_.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting;function HSolidElement(H,_,b){this.initElement(H,_,b)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var H;this.data.hasMask?(H=createNS("rect"),H.setAttribute("width",this.data.sw),H.setAttribute("height",this.data.sh),H.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):(H=createTag("div"),H.style.width=this.data.sw+"px",H.style.height=this.data.sh+"px",H.style.backgroundColor=this.data.sc),this.layerElement.appendChild(H)};function HShapeElement(H,_,b){this.shapes=[],this.shapesData=H.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(H,_,b),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var H;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),H=this.svgElement;else{H=createNS("svg");var _=this.comp.data?this.comp.data:this.globalData.compSize;H.setAttribute("width",_.w),H.setAttribute("height",_.h),H.appendChild(this.shapesContainer),this.layerElement.appendChild(H)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=H},HShapeElement.prototype.getTransformedPoint=function(H,_){var b,$=H.length;for(b=0;b<$;b+=1)_=H[b].mProps.v.applyToPointArray(_[0],_[1],0);return _},HShapeElement.prototype.calculateShapeBoundingBox=function(H,_){var b=H.sh.v,$=H.transformers,ee,re=b._length,ae,xe,le,fe;if(!(re<=1)){for(ee=0;ee<re-1;ee+=1)ae=this.getTransformedPoint($,b.v[ee]),xe=this.getTransformedPoint($,b.o[ee]),le=this.getTransformedPoint($,b.i[ee+1]),fe=this.getTransformedPoint($,b.v[ee+1]),this.checkBounds(ae,xe,le,fe,_);b.c&&(ae=this.getTransformedPoint($,b.v[ee]),xe=this.getTransformedPoint($,b.o[ee]),le=this.getTransformedPoint($,b.i[0]),fe=this.getTransformedPoint($,b.v[0]),this.checkBounds(ae,xe,le,fe,_))}},HShapeElement.prototype.checkBounds=function(H,_,b,$,ee){this.getBoundsOfCurve(H,_,b,$);var re=this.shapeBoundingBox;ee.x=bmMin(re.left,ee.x),ee.xMax=bmMax(re.right,ee.xMax),ee.y=bmMin(re.top,ee.y),ee.yMax=bmMax(re.bottom,ee.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(H,_,b,$){for(var ee=[[H[0],$[0]],[H[1],$[1]]],re,ae,xe,le,fe,ve,Se,Ee=0;Ee<2;++Ee)ae=6*H[Ee]-12*_[Ee]+6*b[Ee],re=-3*H[Ee]+9*_[Ee]-9*b[Ee]+3*$[Ee],xe=3*_[Ee]-3*H[Ee],ae|=0,re|=0,xe|=0,re===0&&ae===0||(re===0?(le=-xe/ae,le>0&&le<1&&ee[Ee].push(this.calculateF(le,H,_,b,$,Ee))):(fe=ae*ae-4*xe*re,fe>=0&&(ve=(-ae+bmSqrt(fe))/(2*re),ve>0&&ve<1&&ee[Ee].push(this.calculateF(ve,H,_,b,$,Ee)),Se=(-ae-bmSqrt(fe))/(2*re),Se>0&&Se<1&&ee[Ee].push(this.calculateF(Se,H,_,b,$,Ee)))));this.shapeBoundingBox.left=bmMin.apply(null,ee[0]),this.shapeBoundingBox.top=bmMin.apply(null,ee[1]),this.shapeBoundingBox.right=bmMax.apply(null,ee[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,ee[1])},HShapeElement.prototype.calculateF=function(H,_,b,$,ee,re){return bmPow(1-H,3)*_[re]+3*bmPow(1-H,2)*H*b[re]+3*(1-H)*bmPow(H,2)*$[re]+bmPow(H,3)*ee[re]},HShapeElement.prototype.calculateBoundingBox=function(H,_){var b,$=H.length;for(b=0;b<$;b+=1)H[b]&&H[b].sh?this.calculateShapeBoundingBox(H[b],_):H[b]&&H[b].it?this.calculateBoundingBox(H[b].it,_):H[b]&&H[b].style&&H[b].w&&this.expandStrokeBoundingBox(H[b].w,_)},HShapeElement.prototype.expandStrokeBoundingBox=function(H,_){var b=0;if(H.keyframes){for(var $=0;$<H.keyframes.length;$+=1){var ee=H.keyframes[$].s;ee>b&&(b=ee)}b*=H.mult}else b=H.v*H.mult;_.x-=b,_.xMax+=b,_.y-=b,_.yMax+=b},HShapeElement.prototype.currentBoxContains=function(H){return this.currentBBox.x<=H.x&&this.currentBBox.y<=H.y&&this.currentBBox.width+this.currentBBox.x>=H.x+H.width&&this.currentBBox.height+this.currentBBox.y>=H.y+H.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var H=this.tempBoundingBox,_=999999;if(H.x=_,H.xMax=-_,H.y=_,H.yMax=-_,this.calculateBoundingBox(this.itemsData,H),H.width=H.xMax<H.x?0:H.xMax-H.x,H.height=H.yMax<H.y?0:H.yMax-H.y,this.currentBoxContains(H))return;var b=!1;if(this.currentBBox.w!==H.width&&(this.currentBBox.w=H.width,this.shapeCont.setAttribute("width",H.width),b=!0),this.currentBBox.h!==H.height&&(this.currentBBox.h=H.height,this.shapeCont.setAttribute("height",H.height),b=!0),b||this.currentBBox.x!==H.x||this.currentBBox.y!==H.y){this.currentBBox.w=H.width,this.currentBBox.h=H.height,this.currentBBox.x=H.x,this.currentBBox.y=H.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var $=this.shapeCont.style,ee="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";$.transform=ee,$.webkitTransform=ee}}};function HTextElement(H,_,b){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(H,_,b)}extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var H=createNS("g");this.maskedElement.appendChild(H),this.innerElem=H}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var H=this.textProperty.currentData;this.renderedLetters=createSizedArray(H.l?H.l.length:0);var _=this.innerElem.style,b=H.fc?this.buildColor(H.fc):"rgba(0,0,0,0)";_.fill=b,_.color=b,H.sc&&(_.stroke=this.buildColor(H.sc),_.strokeWidth=H.sw+"px");var $=this.globalData.fontManager.getFontByName(H.f);if(!this.globalData.fontManager.chars)if(_.fontSize=H.finalSize+"px",_.lineHeight=H.finalSize+"px",$.fClass)this.innerElem.className=$.fClass;else{_.fontFamily=$.fFamily;var ee=H.fWeight,re=H.fStyle;_.fontStyle=re,_.fontWeight=ee}var ae,xe,le=H.l;xe=le.length;var fe,ve,Se,Ee=this.mHelper,Ce,Ie="",De=0;for(ae=0;ae<xe;ae+=1){if(this.globalData.fontManager.chars?(this.textPaths[De]?fe=this.textPaths[De]:(fe=createNS("path"),fe.setAttribute("stroke-linecap",lineCapEnum[1]),fe.setAttribute("stroke-linejoin",lineJoinEnum[2]),fe.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[De]?(ve=this.textSpans[De],Se=ve.children[0]):(ve=createTag("div"),ve.style.lineHeight=0,Se=createNS("svg"),Se.appendChild(fe),styleDiv(ve)))):this.isMasked?fe=this.textPaths[De]?this.textPaths[De]:createNS("text"):this.textSpans[De]?(ve=this.textSpans[De],fe=this.textPaths[De]):(ve=createTag("span"),styleDiv(ve),fe=createTag("span"),styleDiv(fe),ve.appendChild(fe)),this.globalData.fontManager.chars){var Be=this.globalData.fontManager.getCharData(H.finalText[ae],$.fStyle,this.globalData.fontManager.getFontByName(H.f).fFamily),Ne;if(Be?Ne=Be.data:Ne=null,Ee.reset(),Ne&&Ne.shapes&&Ne.shapes.length&&(Ce=Ne.shapes[0].it,Ee.scale(H.finalSize/100,H.finalSize/100),Ie=this.createPathShape(Ee,Ce),fe.setAttribute("d",Ie)),this.isMasked)this.innerElem.appendChild(fe);else{if(this.innerElem.appendChild(ve),Ne&&Ne.shapes){document.body.appendChild(Se);var qe=Se.getBBox();Se.setAttribute("width",qe.width+2),Se.setAttribute("height",qe.height+2),Se.setAttribute("viewBox",qe.x-1+" "+(qe.y-1)+" "+(qe.width+2)+" "+(qe.height+2));var Xe=Se.style,Ye="translate("+(qe.x-1)+"px,"+(qe.y-1)+"px)";Xe.transform=Ye,Xe.webkitTransform=Ye,le[ae].yOffset=qe.y-1}else Se.setAttribute("width",1),Se.setAttribute("height",1);ve.appendChild(Se)}}else if(fe.textContent=le[ae].val,fe.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(fe);else{this.innerElem.appendChild(ve);var Qe=fe.style,rt="translate3d(0,"+-H.finalSize/1.2+"px,0)";Qe.transform=rt,Qe.webkitTransform=rt}this.isMasked?this.textSpans[De]=fe:this.textSpans[De]=ve,this.textSpans[De].style.display="block",this.textPaths[De]=fe,De+=1}for(;De<this.textSpans.length;)this.textSpans[De].style.display="none",De+=1},HTextElement.prototype.renderInnerContent=function(){this.validateText();var H;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),H=this.svgElement.style;var _="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";H.transform=_,H.webkitTransform=_}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),!(!this.lettersChangedFlag&&!this.textAnimator.lettersChangedFlag)){var b,$,ee=0,re=this.textAnimator.renderedLetters,ae=this.textProperty.currentData.l;$=ae.length;var xe,le,fe;for(b=0;b<$;b+=1)ae[b].n?ee+=1:(le=this.textSpans[b],fe=this.textPaths[b],xe=re[ee],ee+=1,xe._mdf.m&&(this.isMasked?le.setAttribute("transform",xe.m):(le.style.webkitTransform=xe.m,le.style.transform=xe.m)),le.style.opacity=xe.o,xe.sw&&xe._mdf.sw&&fe.setAttribute("stroke-width",xe.sw),xe.sc&&xe._mdf.sc&&fe.setAttribute("stroke",xe.sc),xe.fc&&xe._mdf.fc&&(fe.setAttribute("fill",xe.fc),fe.style.color=xe.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var ve=this.innerElem.getBBox();this.currentBBox.w!==ve.width&&(this.currentBBox.w=ve.width,this.svgElement.setAttribute("width",ve.width)),this.currentBBox.h!==ve.height&&(this.currentBBox.h=ve.height,this.svgElement.setAttribute("height",ve.height));var Se=1;if(this.currentBBox.w!==ve.width+Se*2||this.currentBBox.h!==ve.height+Se*2||this.currentBBox.x!==ve.x-Se||this.currentBBox.y!==ve.y-Se){this.currentBBox.w=ve.width+Se*2,this.currentBBox.h=ve.height+Se*2,this.currentBBox.x=ve.x-Se,this.currentBBox.y=ve.y-Se,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),H=this.svgElement.style;var Ee="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";H.transform=Ee,H.webkitTransform=Ee}}}};function HCameraElement(H,_,b){this.initFrame(),this.initBaseData(H,_,b),this.initHierarchy();var $=PropertyFactory.getProp;if(this.pe=$(this,H.pe,0,0,this),H.ks.p.s?(this.px=$(this,H.ks.p.x,1,0,this),this.py=$(this,H.ks.p.y,1,0,this),this.pz=$(this,H.ks.p.z,1,0,this)):this.p=$(this,H.ks.p,1,0,this),H.ks.a&&(this.a=$(this,H.ks.a,1,0,this)),H.ks.or.k.length&&H.ks.or.k[0].to){var ee,re=H.ks.or.k.length;for(ee=0;ee<re;ee+=1)H.ks.or.k[ee].to=null,H.ks.or.k[ee].ti=null}this.or=$(this,H.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=$(this,H.ks.rx,0,degToRads,this),this.ry=$(this,H.ks.ry,0,degToRads,this),this.rz=$(this,H.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var H,_=this.comp.threeDElements.length,b,$,ee;for(H=0;H<_;H+=1)if(b=this.comp.threeDElements[H],b.type==="3d"){$=b.perspectiveElem.style,ee=b.container.style;var re=this.pe.v+"px",ae="0px 0px 0px",xe="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";$.perspective=re,$.webkitPerspective=re,ee.transformOrigin=ae,ee.mozTransformOrigin=ae,ee.webkitTransformOrigin=ae,$.transform=xe,$.webkitTransform=xe}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var H=this._isFirstFrame,_,b;if(this.hierarchy)for(b=this.hierarchy.length,_=0;_<b;_+=1)H=this.hierarchy[_].finalTransform.mProp._mdf||H;if(H||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(b=this.hierarchy.length-1,_=b;_>=0;_-=1){var $=this.hierarchy[_].finalTransform.mProp;this.mat.translate(-$.p.v[0],-$.p.v[1],$.p.v[2]),this.mat.rotateX(-$.or.v[0]).rotateY(-$.or.v[1]).rotateZ($.or.v[2]),this.mat.rotateX(-$.rx.v).rotateY(-$.ry.v).rotateZ($.rz.v),this.mat.scale(1/$.s.v[0],1/$.s.v[1],1/$.s.v[2]),this.mat.translate($.a.v[0],$.a.v[1],$.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var ee;this.p?ee=[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:ee=[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var re=Math.sqrt(Math.pow(ee[0],2)+Math.pow(ee[1],2)+Math.pow(ee[2],2)),ae=[ee[0]/re,ee[1]/re,ee[2]/re],xe=Math.sqrt(ae[2]*ae[2]+ae[0]*ae[0]),le=Math.atan2(ae[1],xe),fe=Math.atan2(ae[0],-ae[2]);this.mat.rotateY(fe).rotateX(-le)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var ve=!this._prevMat.equals(this.mat);if((ve||this.pe._mdf)&&this.comp.threeDElements){b=this.comp.threeDElements.length;var Se,Ee,Ce;for(_=0;_<b;_+=1)if(Se=this.comp.threeDElements[_],Se.type==="3d"){if(ve){var Ie=this.mat.toCSS();Ce=Se.container.style,Ce.transform=Ie,Ce.webkitTransform=Ie}this.pe._mdf&&(Ee=Se.perspectiveElem.style,Ee.perspective=this.pe.v+"px",Ee.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(H){this.prepareProperties(H,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null};function HImageElement(H,_,b){this.assetData=_.getAssetData(H.refId),this.initElement(H,_,b)}extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var H=this.globalData.getAssetsPath(this.assetData),_=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",H),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(_),_.crossOrigin="anonymous",_.src=H,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)};function HybridRendererBase(H,_){this.animationItem=H,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:_&&_.className||"",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(_&&_.hideOnTransparent===!1),filterSize:{width:_&&_.filterSize&&_.filterSize.width||"400%",height:_&&_.filterSize&&_.filterSize.height||"400%",x:_&&_.filterSize&&_.filterSize.x||"-100%",y:_&&_.filterSize&&_.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var H=this.pendingElements.pop();H.checkParenting()}},HybridRendererBase.prototype.appendElementInPos=function(H,_){var b=H.getBaseElement();if(b){var $=this.layers[_];if(!$.ddd||!this.supports3d)if(this.threeDElements)this.addTo3dContainer(b,_);else{for(var ee=0,re,ae,xe;ee<_;)this.elements[ee]&&this.elements[ee]!==!0&&this.elements[ee].getBaseElement&&(ae=this.elements[ee],xe=this.layers[ee].ddd?this.getThreeDContainerByPos(ee):ae.getBaseElement(),re=xe||re),ee+=1;re?(!$.ddd||!this.supports3d)&&this.layerElement.insertBefore(b,re):(!$.ddd||!this.supports3d)&&this.layerElement.appendChild(b)}else this.addTo3dContainer(b,_)}},HybridRendererBase.prototype.createShape=function(H){return this.supports3d?new HShapeElement(H,this.globalData,this):new SVGShapeElement(H,this.globalData,this)},HybridRendererBase.prototype.createText=function(H){return this.supports3d?new HTextElement(H,this.globalData,this):new SVGTextLottieElement(H,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(H){return this.camera=new HCameraElement(H,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(H){return this.supports3d?new HImageElement(H,this.globalData,this):new IImageElement(H,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(H){return this.supports3d?new HSolidElement(H,this.globalData,this):new ISolidElement(H,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(H){for(var _=0,b=this.threeDElements.length;_<b;){if(this.threeDElements[_].startPos<=H&&this.threeDElements[_].endPos>=H)return this.threeDElements[_].perspectiveElem;_+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(H,_){var b=createTag("div"),$,ee;styleDiv(b);var re=createTag("div");if(styleDiv(re),_==="3d"){$=b.style,$.width=this.globalData.compSize.w+"px",$.height=this.globalData.compSize.h+"px";var ae="50% 50%";$.webkitTransformOrigin=ae,$.mozTransformOrigin=ae,$.transformOrigin=ae,ee=re.style;var xe="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";ee.transform=xe,ee.webkitTransform=xe}b.appendChild(re);var le={container:re,perspectiveElem:b,startPos:H,endPos:H,type:_};return this.threeDElements.push(le),le},HybridRendererBase.prototype.build3dContainers=function(){var H,_=this.layers.length,b,$="";for(H=0;H<_;H+=1)this.layers[H].ddd&&this.layers[H].ty!==3?($!=="3d"&&($="3d",b=this.createThreeDContainer(H,"3d")),b.endPos=Math.max(b.endPos,H)):($!=="2d"&&($="2d",b=this.createThreeDContainer(H,"2d")),b.endPos=Math.max(b.endPos,H));for(_=this.threeDElements.length,H=_-1;H>=0;H-=1)this.resizerElem.appendChild(this.threeDElements[H].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(H,_){for(var b=0,$=this.threeDElements.length;b<$;){if(_<=this.threeDElements[b].endPos){for(var ee=this.threeDElements[b].startPos,re;ee<_;)this.elements[ee]&&this.elements[ee].getBaseElement&&(re=this.elements[ee].getBaseElement()),ee+=1;re?this.threeDElements[b].container.insertBefore(H,re):this.threeDElements[b].container.appendChild(H);break}b+=1}},HybridRendererBase.prototype.configAnimation=function(H){var _=createTag("div"),b=this.animationItem.wrapper,$=_.style;$.width=H.w+"px",$.height=H.h+"px",this.resizerElem=_,styleDiv(_),$.transformStyle="flat",$.mozTransformStyle="flat",$.webkitTransformStyle="flat",this.renderConfig.className&&_.setAttribute("class",this.renderConfig.className),b.appendChild(_),$.overflow="hidden";var ee=createNS("svg");ee.setAttribute("width","1"),ee.setAttribute("height","1"),styleDiv(ee),this.resizerElem.appendChild(ee);var re=createNS("defs");ee.appendChild(re),this.data=H,this.setupGlobalData(H,ee),this.globalData.defs=re,this.layers=H.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var H,_=this.layers?this.layers.length:0;for(H=0;H<_;H+=1)this.elements[H]&&this.elements[H].destroy&&this.elements[H].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var H=this.animationItem.wrapper.offsetWidth,_=this.animationItem.wrapper.offsetHeight,b=H/_,$=this.globalData.compSize.w/this.globalData.compSize.h,ee,re,ae,xe;$>b?(ee=H/this.globalData.compSize.w,re=H/this.globalData.compSize.w,ae=0,xe=(_-this.globalData.compSize.h*(H/this.globalData.compSize.w))/2):(ee=_/this.globalData.compSize.h,re=_/this.globalData.compSize.h,ae=(H-this.globalData.compSize.w*(_/this.globalData.compSize.h))/2,xe=0);var le=this.resizerElem.style;le.webkitTransform="matrix3d("+ee+",0,0,0,0,"+re+",0,0,0,0,1,0,"+ae+","+xe+",0,1)",le.transform=le.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var H=this.globalData.compSize.w,_=this.globalData.compSize.h,b,$=this.threeDElements.length;for(b=0;b<$;b+=1){var ee=this.threeDElements[b].perspectiveElem.style;ee.webkitPerspective=Math.sqrt(Math.pow(H,2)+Math.pow(_,2))+"px",ee.perspective=ee.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(H){var _,b=H.length,$=createTag("div");for(_=0;_<b;_+=1)if(H[_].xt){var ee=this.createComp(H[_],$,this.globalData.comp,null);ee.initExpressions(),this.globalData.projectInterface.registerComposition(ee)}};function HCompElement(H,_,b){this.layers=H.layers,this.supports3d=!H.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(H,_,b),this.tm=H.tm?PropertyFactory.getProp(this,H.tm,0,_.frameRate,this):{_placeholder:!0}}extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(H,_){for(var b=0,$;b<_;)this.elements[b]&&this.elements[b].getBaseElement&&($=this.elements[b].getBaseElement()),b+=1;$?this.layerElement.insertBefore(H,$):this.layerElement.appendChild(H)},HCompElement.prototype.createComp=function(H){return this.supports3d?new HCompElement(H,this.globalData,this):new SVGCompElement(H,this.globalData,this)};function HybridRenderer(H,_){this.animationItem=H,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:_&&_.className||"",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(_&&_.hideOnTransparent===!1),filterSize:{width:_&&_.filterSize&&_.filterSize.width||"400%",height:_&&_.filterSize&&_.filterSize.height||"400%",x:_&&_.filterSize&&_.filterSize.x||"-100%",y:_&&_.filterSize&&_.filterSize.y||"-100%"},runExpressions:!_||_.runExpressions===void 0||_.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(H){return this.supports3d?new HCompElement(H,this.globalData,this):new SVGCompElement(H,this.globalData,this)};var CompExpressionInterface=function(){return function(H){function _(b){for(var $=0,ee=H.layers.length;$<ee;){if(H.layers[$].nm===b||H.layers[$].ind===b)return H.elements[$].layerInterface;$+=1}return null}return Object.defineProperty(_,"_name",{value:H.data.nm}),_.layer=_,_.pixelAspect=1,_.height=H.data.h||H.globalData.compSize.h,_.width=H.data.w||H.globalData.compSize.w,_.pixelAspect=1,_.frameDuration=1/H.globalData.frameRate,_.displayStartTime=0,_.numLayers=H.layers.length,_}}();function _typeof$2(H){"@babel/helpers - typeof";return _typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},_typeof$2(H)}function seedRandom(H,_){var b=this,$=256,ee=6,re=52,ae="random",xe=_.pow($,ee),le=_.pow(2,re),fe=le*2,ve=$-1,Se;function Ee(Xe,Ye,Qe){var rt=[];Ye=Ye===!0?{entropy:!0}:Ye||{};var ot=Be(De(Ye.entropy?[Xe,qe(H)]:Xe===null?Ne():Xe,3),rt),ct=new Ce(rt),mt=function(){for(var Lt=ct.g(ee),Vt=xe,Gt=0;Lt<le;)Lt=(Lt+Gt)*$,Vt*=$,Gt=ct.g(1);for(;Lt>=fe;)Lt/=2,Vt/=2,Gt>>>=1;return(Lt+Gt)/Vt};return mt.int32=function(){return ct.g(4)|0},mt.quick=function(){return ct.g(4)/4294967296},mt.double=mt,Be(qe(ct.S),H),(Ye.pass||Qe||function(_t,Lt,Vt,Gt){return Gt&&(Gt.S&&Ie(Gt,ct),_t.state=function(){return Ie(ct,{})}),Vt?(_[ae]=_t,Lt):_t})(mt,ot,"global"in Ye?Ye.global:this==_,Ye.state)}_["seed"+ae]=Ee;function Ce(Xe){var Ye,Qe=Xe.length,rt=this,ot=0,ct=rt.i=rt.j=0,mt=rt.S=[];for(Qe||(Xe=[Qe++]);ot<$;)mt[ot]=ot++;for(ot=0;ot<$;ot++)mt[ot]=mt[ct=ve&ct+Xe[ot%Qe]+(Ye=mt[ot])],mt[ct]=Ye;rt.g=function(_t){for(var Lt,Vt=0,Gt=rt.i,$t=rt.j,Qt=rt.S;_t--;)Lt=Qt[Gt=ve&Gt+1],Vt=Vt*$+Qt[ve&(Qt[Gt]=Qt[$t=ve&$t+Lt])+(Qt[$t]=Lt)];return rt.i=Gt,rt.j=$t,Vt}}function Ie(Xe,Ye){return Ye.i=Xe.i,Ye.j=Xe.j,Ye.S=Xe.S.slice(),Ye}function De(Xe,Ye){var Qe=[],rt=_typeof$2(Xe),ot;if(Ye&&rt=="object")for(ot in Xe)try{Qe.push(De(Xe[ot],Ye-1))}catch{}return Qe.length?Qe:rt=="string"?Xe:Xe+"\0"}function Be(Xe,Ye){for(var Qe=Xe+"",rt,ot=0;ot<Qe.length;)Ye[ve&ot]=ve&(rt^=Ye[ve&ot]*19)+Qe.charCodeAt(ot++);return qe(Ye)}function Ne(){try{var Xe=new Uint8Array($);return(b.crypto||b.msCrypto).getRandomValues(Xe),qe(Xe)}catch{var Ye=b.navigator,Qe=Ye&&Ye.plugins;return[+new Date,b,Qe,b.screen,qe(H)]}}function qe(Xe){return String.fromCharCode.apply(0,Xe)}Be(_.random(),H)}function initialize$2(H){seedRandom([],H)}var propTypes={SHAPE:"shape"};function _typeof$1(H){"@babel/helpers - typeof";return _typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},_typeof$1(H)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null,_lottieGlobal={};initialize$2(BMMath);function resetFrame(){_lottieGlobal={}}function $bm_isInstanceOfArray(H){return H.constructor===Array||H.constructor===Float32Array}function isNumerable(H,_){return H==="number"||_ instanceof Number||H==="boolean"||H==="string"}function $bm_neg(H){var _=_typeof$1(H);if(_==="number"||H instanceof Number||_==="boolean")return-H;if($bm_isInstanceOfArray(H)){var b,$=H.length,ee=[];for(b=0;b<$;b+=1)ee[b]=-H[b];return ee}return H.propType?H.v:-H}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(H,_){var b=_typeof$1(H),$=_typeof$1(_);if(isNumerable(b,H)&&isNumerable($,_)||b==="string"||$==="string")return H+_;if($bm_isInstanceOfArray(H)&&isNumerable($,_))return H=H.slice(0),H[0]+=_,H;if(isNumerable(b,H)&&$bm_isInstanceOfArray(_))return _=_.slice(0),_[0]=H+_[0],_;if($bm_isInstanceOfArray(H)&&$bm_isInstanceOfArray(_)){for(var ee=0,re=H.length,ae=_.length,xe=[];ee<re||ee<ae;)(typeof H[ee]=="number"||H[ee]instanceof Number)&&(typeof _[ee]=="number"||_[ee]instanceof Number)?xe[ee]=H[ee]+_[ee]:xe[ee]=_[ee]===void 0?H[ee]:H[ee]||_[ee],ee+=1;return xe}return 0}var add=sum;function sub(H,_){var b=_typeof$1(H),$=_typeof$1(_);if(isNumerable(b,H)&&isNumerable($,_))return b==="string"&&(H=parseInt(H,10)),$==="string"&&(_=parseInt(_,10)),H-_;if($bm_isInstanceOfArray(H)&&isNumerable($,_))return H=H.slice(0),H[0]-=_,H;if(isNumerable(b,H)&&$bm_isInstanceOfArray(_))return _=_.slice(0),_[0]=H-_[0],_;if($bm_isInstanceOfArray(H)&&$bm_isInstanceOfArray(_)){for(var ee=0,re=H.length,ae=_.length,xe=[];ee<re||ee<ae;)(typeof H[ee]=="number"||H[ee]instanceof Number)&&(typeof _[ee]=="number"||_[ee]instanceof Number)?xe[ee]=H[ee]-_[ee]:xe[ee]=_[ee]===void 0?H[ee]:H[ee]||_[ee],ee+=1;return xe}return 0}function mul(H,_){var b=_typeof$1(H),$=_typeof$1(_),ee;if(isNumerable(b,H)&&isNumerable($,_))return H*_;var re,ae;if($bm_isInstanceOfArray(H)&&isNumerable($,_)){for(ae=H.length,ee=createTypedArray("float32",ae),re=0;re<ae;re+=1)ee[re]=H[re]*_;return ee}if(isNumerable(b,H)&&$bm_isInstanceOfArray(_)){for(ae=_.length,ee=createTypedArray("float32",ae),re=0;re<ae;re+=1)ee[re]=H*_[re];return ee}return 0}function div(H,_){var b=_typeof$1(H),$=_typeof$1(_),ee;if(isNumerable(b,H)&&isNumerable($,_))return H/_;var re,ae;if($bm_isInstanceOfArray(H)&&isNumerable($,_)){for(ae=H.length,ee=createTypedArray("float32",ae),re=0;re<ae;re+=1)ee[re]=H[re]/_;return ee}if(isNumerable(b,H)&&$bm_isInstanceOfArray(_)){for(ae=_.length,ee=createTypedArray("float32",ae),re=0;re<ae;re+=1)ee[re]=H/_[re];return ee}return 0}function mod(H,_){return typeof H=="string"&&(H=parseInt(H,10)),typeof _=="string"&&(_=parseInt(_,10)),H%_}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(H,_,b){if(_>b){var $=b;b=_,_=$}return Math.min(Math.max(H,_),b)}function radiansToDegrees(H){return H/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(H){return H*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(H,_){if(typeof H=="number"||H instanceof Number)return _=_||0,Math.abs(H-_);_||(_=helperLengthArray);var b,$=Math.min(H.length,_.length),ee=0;for(b=0;b<$;b+=1)ee+=Math.pow(_[b]-H[b],2);return Math.sqrt(ee)}function normalize(H){return div(H,length(H))}function rgbToHsl(H){var _=H[0],b=H[1],$=H[2],ee=Math.max(_,b,$),re=Math.min(_,b,$),ae,xe,le=(ee+re)/2;if(ee===re)ae=0,xe=0;else{var fe=ee-re;switch(xe=le>.5?fe/(2-ee-re):fe/(ee+re),ee){case _:ae=(b-$)/fe+(b<$?6:0);break;case b:ae=($-_)/fe+2;break;case $:ae=(_-b)/fe+4;break}ae/=6}return[ae,xe,le,H[3]]}function hue2rgb(H,_,b){return b<0&&(b+=1),b>1&&(b-=1),b<1/6?H+(_-H)*6*b:b<1/2?_:b<2/3?H+(_-H)*(2/3-b)*6:H}function hslToRgb(H){var _=H[0],b=H[1],$=H[2],ee,re,ae;if(b===0)ee=$,ae=$,re=$;else{var xe=$<.5?$*(1+b):$+b-$*b,le=2*$-xe;ee=hue2rgb(le,xe,_+1/3),re=hue2rgb(le,xe,_),ae=hue2rgb(le,xe,_-1/3)}return[ee,re,ae,H[3]]}function linear(H,_,b,$,ee){if(($===void 0||ee===void 0)&&($=_,ee=b,_=0,b=1),b<_){var re=b;b=_,_=re}if(H<=_)return $;if(H>=b)return ee;var ae=b===_?0:(H-_)/(b-_);if(!$.length)return $+(ee-$)*ae;var xe,le=$.length,fe=createTypedArray("float32",le);for(xe=0;xe<le;xe+=1)fe[xe]=$[xe]+(ee[xe]-$[xe])*ae;return fe}function random(H,_){if(_===void 0&&(H===void 0?(H=0,_=1):(_=H,H=void 0)),_.length){var b,$=_.length;H||(H=createTypedArray("float32",$));var ee=createTypedArray("float32",$),re=BMMath.random();for(b=0;b<$;b+=1)ee[b]=H[b]+re*(_[b]-H[b]);return ee}H===void 0&&(H=0);var ae=BMMath.random();return H+ae*(_-H)}function createPath(H,_,b,$){var ee,re=H.length,ae=shapePool.newElement();ae.setPathData(!!$,re);var xe=[0,0],le,fe;for(ee=0;ee<re;ee+=1)le=_&&_[ee]?_[ee]:xe,fe=b&&b[ee]?b[ee]:xe,ae.setTripleAt(H[ee][0],H[ee][1],fe[0]+H[ee][0],fe[1]+H[ee][1],le[0]+H[ee][0],le[1]+H[ee][1],ee,!0);return ae}function initiateExpression(elem,data,property){function noOp(H){return H}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=val.indexOf("random")!==-1,elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty._name=elem.data.nm,thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||this.data.hd!==!0,wiggle=(function H(_,b){var $,ee,re=this.pv.length?this.pv.length:1,ae=createTypedArray("float32",re);_=5;var xe=Math.floor(time*_);for($=0,ee=0;$<xe;){for(ee=0;ee<re;ee+=1)ae[ee]+=-b+b*2*BMMath.random();$+=1}var le=time*_,fe=le-Math.floor(le),ve=createTypedArray("float32",re);if(re>1){for(ee=0;ee<re;ee+=1)ve[ee]=this.pv[ee]+ae[ee]+(-b+b*2*BMMath.random())*fe;return ve}return this.pv+ae[0]+(-b+b*2*BMMath.random())*fe}).bind(this);thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty));function loopInDuration(H,_){return loopIn(H,_,!0)}function loopOutDuration(H,_){return loopOut(H,_,!0)}this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface);function lookAt(H,_){var b=[_[0]-H[0],_[1]-H[1],_[2]-H[2]],$=Math.atan2(b[0],Math.sqrt(b[1]*b[1]+b[2]*b[2]))/degToRads,ee=-Math.atan2(b[1],b[2])/degToRads;return[ee,$,0]}function easeOut(H,_,b,$,ee){return applyEase(easeOutBez,H,_,b,$,ee)}function easeIn(H,_,b,$,ee){return applyEase(easeInBez,H,_,b,$,ee)}function ease(H,_,b,$,ee){return applyEase(easeInOutBez,H,_,b,$,ee)}function applyEase(H,_,b,$,ee,re){ee===void 0?(ee=b,re=$):_=(_-b)/($-b),_>1?_=1:_<0&&(_=0);var ae=H(_);if($bm_isInstanceOfArray(ee)){var xe,le=ee.length,fe=createTypedArray("float32",le);for(xe=0;xe<le;xe+=1)fe[xe]=(re[xe]-ee[xe])*ae+ee[xe];return fe}return(re-ee)*ae+ee}function nearestKey(H){var _,b=data.k.length,$,ee;if(!data.k.length||typeof data.k[0]=="number")$=0,ee=0;else if($=-1,H*=elem.comp.globalData.frameRate,H<data.k[0].t)$=1,ee=data.k[0].t;else{for(_=0;_<b-1;_+=1)if(H===data.k[_].t){$=_+1,ee=data.k[_].t;break}else if(H>data.k[_].t&&H<data.k[_+1].t){H-data.k[_].t>data.k[_+1].t-H?($=_+2,ee=data.k[_+1].t):($=_+1,ee=data.k[_].t);break}$===-1&&($=_+1,ee=data.k[_].t)}var re={};return re.index=$,re.time=ee/elem.comp.globalData.frameRate,re}function key(H){var _,b,$;if(!data.k.length||typeof data.k[0]=="number")throw new Error("The property has no keyframe at index "+H);H-=1,_={time:data.k[H].t/elem.comp.globalData.frameRate,value:[]};var ee=Object.prototype.hasOwnProperty.call(data.k[H],"s")?data.k[H].s:data.k[H-1].e;for($=ee.length,b=0;b<$;b+=1)_[b]=ee[b],_.value[b]=ee[b];return _}function framesToTime(H,_){return _||(_=elem.comp.globalData.frameRate),H/_}function timeToFrames(H,_){return!H&&H!==0&&(H=time),_||(_=elem.comp.globalData.frameRate),H*_}function seedRandom(H){BMMath.seedrandom(randSeed+H)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(H,_){return typeof value=="string"?_===void 0?value.substring(H):value.substring(H,_):""}function substr(H,_){return typeof value=="string"?_===void 0?value.substr(H):value.substr(H,_):""}function posterizeTime(H){time=H===0?0:Math.floor(time*H)/H,value=valueAtTime(time)}var time,velocity,value,text,textIndex,textTotal,selectorValue,index=elem.data.ind,hasParent=!!(elem.hierarchy&&elem.hierarchy.length),parent,randSeed=Math.floor(Math.random()*1e6),globalData=elem.globalData;function executeExpression(H){return value=H,this.frameExpressionId===elem.globalData.frameId&&this.propType!=="textSelector"?value:(this.propType==="textSelector"&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),elemType===4&&!content&&(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),hasParent=!!(elem.hierarchy&&elem.hierarchy.length),hasParent&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt,scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath,_lottieGlobal],ob.resetFrame=resetFrame,ob}(),Expressions=function(){var H={};H.initExpressions=_,H.resetFrame=ExpressionManager.resetFrame;function _(b){var $=0,ee=[];function re(){$+=1}function ae(){$-=1,$===0&&le()}function xe(fe){ee.indexOf(fe)===-1&&ee.push(fe)}function le(){var fe,ve=ee.length;for(fe=0;fe<ve;fe+=1)ee[fe].release();ee.length=0}b.renderer.compInterface=CompExpressionInterface(b.renderer),b.renderer.globalData.projectInterface.registerComposition(b.renderer),b.renderer.globalData.pushExpression=re,b.renderer.globalData.popExpression=ae,b.renderer.globalData.registerExpressionProperty=xe}return H}(),MaskManagerInterface=function(){function H(b,$){this._mask=b,this._data=$}Object.defineProperty(H.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(H.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),this._mask.op.v*100}});var _=function($){var ee=createSizedArray($.viewData.length),re,ae=$.viewData.length;for(re=0;re<ae;re+=1)ee[re]=new H($.viewData[re],$.masksProperties[re]);var xe=function(fe){for(re=0;re<ae;){if($.masksProperties[re].nm===fe)return ee[re];re+=1}return null};return xe};return _}(),ExpressionPropertyInterface=function(){var H={pv:0,v:0,mult:1},_={pv:[0,0,0],v:[0,0,0],mult:1};function b(ae,xe,le){Object.defineProperty(ae,"velocity",{get:function(){return xe.getVelocityAtTime(xe.comp.currentFrame)}}),ae.numKeys=xe.keyframes?xe.keyframes.length:0,ae.key=function(fe){if(!ae.numKeys)return 0;var ve="";"s"in xe.keyframes[fe-1]?ve=xe.keyframes[fe-1].s:"e"in xe.keyframes[fe-2]?ve=xe.keyframes[fe-2].e:ve=xe.keyframes[fe-2].s;var Se=le==="unidimensional"?new Number(ve):Object.assign({},ve);return Se.time=xe.keyframes[fe-1].t/xe.elem.comp.globalData.frameRate,Se.value=le==="unidimensional"?ve[0]:ve,Se},ae.valueAtTime=xe.getValueAtTime,ae.speedAtTime=xe.getSpeedAtTime,ae.velocityAtTime=xe.getVelocityAtTime,ae.propertyGroup=xe.propertyGroup}function $(ae){(!ae||!("pv"in ae))&&(ae=H);var xe=1/ae.mult,le=ae.pv*xe,fe=new Number(le);return fe.value=le,b(fe,ae,"unidimensional"),function(){return ae.k&&ae.getValue(),le=ae.v*xe,fe.value!==le&&(fe=new Number(le),fe.value=le,fe[0]=le,b(fe,ae,"unidimensional")),fe}}function ee(ae){(!ae||!("pv"in ae))&&(ae=_);var xe=1/ae.mult,le=ae.data&&ae.data.l||ae.pv.length,fe=createTypedArray("float32",le),ve=createTypedArray("float32",le);return fe.value=ve,b(fe,ae,"multidimensional"),function(){ae.k&&ae.getValue();for(var Se=0;Se<le;Se+=1)ve[Se]=ae.v[Se]*xe,fe[Se]=ve[Se];return fe}}function re(){return H}return function(ae){return ae?ae.propType==="unidimensional"?$(ae):ee(ae):re}}(),TransformExpressionInterface=function(){return function(H){function _(ae){switch(ae){case"scale":case"Scale":case"ADBE Scale":case 6:return _.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return _.rotation;case"ADBE Rotate X":return _.xRotation;case"ADBE Rotate Y":return _.yRotation;case"position":case"Position":case"ADBE Position":case 2:return _.position;case"ADBE Position_0":return _.xPosition;case"ADBE Position_1":return _.yPosition;case"ADBE Position_2":return _.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return _.anchorPoint;case"opacity":case"Opacity":case 11:return _.opacity;default:return null}}Object.defineProperty(_,"rotation",{get:ExpressionPropertyInterface(H.r||H.rz)}),Object.defineProperty(_,"zRotation",{get:ExpressionPropertyInterface(H.rz||H.r)}),Object.defineProperty(_,"xRotation",{get:ExpressionPropertyInterface(H.rx)}),Object.defineProperty(_,"yRotation",{get:ExpressionPropertyInterface(H.ry)}),Object.defineProperty(_,"scale",{get:ExpressionPropertyInterface(H.s)});var b,$,ee,re;return H.p?re=ExpressionPropertyInterface(H.p):(b=ExpressionPropertyInterface(H.px),$=ExpressionPropertyInterface(H.py),H.pz&&(ee=ExpressionPropertyInterface(H.pz))),Object.defineProperty(_,"position",{get:function(){return H.p?re():[b(),$(),ee?ee():0]}}),Object.defineProperty(_,"xPosition",{get:ExpressionPropertyInterface(H.px)}),Object.defineProperty(_,"yPosition",{get:ExpressionPropertyInterface(H.py)}),Object.defineProperty(_,"zPosition",{get:ExpressionPropertyInterface(H.pz)}),Object.defineProperty(_,"anchorPoint",{get:ExpressionPropertyInterface(H.a)}),Object.defineProperty(_,"opacity",{get:ExpressionPropertyInterface(H.o)}),Object.defineProperty(_,"skew",{get:ExpressionPropertyInterface(H.sk)}),Object.defineProperty(_,"skewAxis",{get:ExpressionPropertyInterface(H.sa)}),Object.defineProperty(_,"orientation",{get:ExpressionPropertyInterface(H.or)}),_}}(),LayerExpressionInterface=function(){function H(fe){var ve=new Matrix;if(fe!==void 0){var Se=this._elem.finalTransform.mProp.getValueAtTime(fe);Se.clone(ve)}else{var Ee=this._elem.finalTransform.mProp;Ee.applyToMatrix(ve)}return ve}function _(fe,ve){var Se=this.getMatrix(ve);return Se.props[12]=0,Se.props[13]=0,Se.props[14]=0,this.applyPoint(Se,fe)}function b(fe,ve){var Se=this.getMatrix(ve);return this.applyPoint(Se,fe)}function $(fe,ve){var Se=this.getMatrix(ve);return Se.props[12]=0,Se.props[13]=0,Se.props[14]=0,this.invertPoint(Se,fe)}function ee(fe,ve){var Se=this.getMatrix(ve);return this.invertPoint(Se,fe)}function re(fe,ve){if(this._elem.hierarchy&&this._elem.hierarchy.length){var Se,Ee=this._elem.hierarchy.length;for(Se=0;Se<Ee;Se+=1)this._elem.hierarchy[Se].finalTransform.mProp.applyToMatrix(fe)}return fe.applyToPointArray(ve[0],ve[1],ve[2]||0)}function ae(fe,ve){if(this._elem.hierarchy&&this._elem.hierarchy.length){var Se,Ee=this._elem.hierarchy.length;for(Se=0;Se<Ee;Se+=1)this._elem.hierarchy[Se].finalTransform.mProp.applyToMatrix(fe)}return fe.inversePoint(ve)}function xe(fe){var ve=new Matrix;if(ve.reset(),this._elem.finalTransform.mProp.applyToMatrix(ve),this._elem.hierarchy&&this._elem.hierarchy.length){var Se,Ee=this._elem.hierarchy.length;for(Se=0;Se<Ee;Se+=1)this._elem.hierarchy[Se].finalTransform.mProp.applyToMatrix(ve);return ve.inversePoint(fe)}return ve.inversePoint(fe)}function le(){return[1,1,1,1]}return function(fe){var ve;function Se(De){Ce.mask=new MaskManagerInterface(De,fe)}function Ee(De){Ce.effect=De}function Ce(De){switch(De){case"ADBE Root Vectors Group":case"Contents":case 2:return Ce.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return ve;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return Ce.effect;case"ADBE Text Properties":return Ce.textInterface;default:return null}}Ce.getMatrix=H,Ce.invertPoint=ae,Ce.applyPoint=re,Ce.toWorld=b,Ce.toWorldVec=_,Ce.fromWorld=ee,Ce.fromWorldVec=$,Ce.toComp=b,Ce.fromComp=xe,Ce.sampleImage=le,Ce.sourceRectAtTime=fe.sourceRectAtTime.bind(fe),Ce._elem=fe,ve=TransformExpressionInterface(fe.finalTransform.mProp);var Ie=getDescriptor(ve,"anchorPoint");return Object.defineProperties(Ce,{hasParent:{get:function(){return fe.hierarchy.length}},parent:{get:function(){return fe.hierarchy[0].layerInterface}},rotation:getDescriptor(ve,"rotation"),scale:getDescriptor(ve,"scale"),position:getDescriptor(ve,"position"),opacity:getDescriptor(ve,"opacity"),anchorPoint:Ie,anchor_point:Ie,transform:{get:function(){return ve}},active:{get:function(){return fe.isInRange}}}),Ce.startTime=fe.data.st,Ce.index=fe.data.ind,Ce.source=fe.data.refId,Ce.height=fe.data.ty===0?fe.data.h:100,Ce.width=fe.data.ty===0?fe.data.w:100,Ce.inPoint=fe.data.ip/fe.comp.globalData.frameRate,Ce.outPoint=fe.data.op/fe.comp.globalData.frameRate,Ce._name=fe.data.nm,Ce.registerMaskInterface=Se,Ce.registerEffectsInterface=Ee,Ce}}(),propertyGroupFactory=function(){return function(H,_){return function(b){return b=b===void 0?1:b,b<=0?H:_(b-1)}}}(),PropertyInterface=function(){return function(H,_){var b={_name:H};function $(ee){return ee=ee===void 0?1:ee,ee<=0?b:_(ee-1)}return $}}(),EffectsExpressionInterface=function(){var H={createEffectsInterface:_};function _(ee,re){if(ee.effectsManager){var ae=[],xe=ee.data.ef,le,fe=ee.effectsManager.effectElements.length;for(le=0;le<fe;le+=1)ae.push(b(xe[le],ee.effectsManager.effectElements[le],re,ee));var ve=ee.data.ef||[],Se=function(Ce){for(le=0,fe=ve.length;le<fe;){if(Ce===ve[le].nm||Ce===ve[le].mn||Ce===ve[le].ix)return ae[le];le+=1}return null};return Object.defineProperty(Se,"numProperties",{get:function(){return ve.length}}),Se}return null}function b(ee,re,ae,xe){function le(Ce){for(var Ie=ee.ef,De=0,Be=Ie.length;De<Be;){if(Ce===Ie[De].nm||Ce===Ie[De].mn||Ce===Ie[De].ix)return Ie[De].ty===5?ve[De]:ve[De]();De+=1}throw new Error}var fe=propertyGroupFactory(le,ae),ve=[],Se,Ee=ee.ef.length;for(Se=0;Se<Ee;Se+=1)ee.ef[Se].ty===5?ve.push(b(ee.ef[Se],re.effectElements[Se],re.effectElements[Se].propertyGroup,xe)):ve.push($(re.effectElements[Se],ee.ef[Se].ty,xe,fe));return ee.mn==="ADBE Color Control"&&Object.defineProperty(le,"color",{get:function(){return ve[0]()}}),Object.defineProperties(le,{numProperties:{get:function(){return ee.np}},_name:{value:ee.nm},propertyGroup:{value:fe}}),le.enabled=ee.en!==0,le.active=le.enabled,le}function $(ee,re,ae,xe){var le=ExpressionPropertyInterface(ee.p);function fe(){return re===10?ae.comp.compInterface(ee.p.v):le()}return ee.p.setGroupProperty&&ee.p.setGroupProperty(PropertyInterface("",xe)),fe}return H}(),ShapePathInterface=function(){return function(_,b,$){var ee=b.sh;function re(xe){return xe==="Shape"||xe==="shape"||xe==="Path"||xe==="path"||xe==="ADBE Vector Shape"||xe===2?re.path:null}var ae=propertyGroupFactory(re,$);return ee.setGroupProperty(PropertyInterface("Path",ae)),Object.defineProperties(re,{path:{get:function(){return ee.k&&ee.getValue(),ee}},shape:{get:function(){return ee.k&&ee.getValue(),ee}},_name:{value:_.nm},ix:{value:_.ix},propertyIndex:{value:_.ix},mn:{value:_.mn},propertyGroup:{value:$}}),re}}(),ShapeExpressionInterface=function(){function H(Ie,De,Be){var Ne=[],qe,Xe=Ie?Ie.length:0;for(qe=0;qe<Xe;qe+=1)Ie[qe].ty==="gr"?Ne.push(b(Ie[qe],De[qe],Be)):Ie[qe].ty==="fl"?Ne.push($(Ie[qe],De[qe],Be)):Ie[qe].ty==="st"?Ne.push(ae(Ie[qe],De[qe],Be)):Ie[qe].ty==="tm"?Ne.push(xe(Ie[qe],De[qe],Be)):Ie[qe].ty==="tr"||(Ie[qe].ty==="el"?Ne.push(fe(Ie[qe],De[qe],Be)):Ie[qe].ty==="sr"?Ne.push(ve(Ie[qe],De[qe],Be)):Ie[qe].ty==="sh"?Ne.push(ShapePathInterface(Ie[qe],De[qe],Be)):Ie[qe].ty==="rc"?Ne.push(Se(Ie[qe],De[qe],Be)):Ie[qe].ty==="rd"?Ne.push(Ee(Ie[qe],De[qe],Be)):Ie[qe].ty==="rp"?Ne.push(Ce(Ie[qe],De[qe],Be)):Ie[qe].ty==="gf"?Ne.push(ee(Ie[qe],De[qe],Be)):Ne.push(re(Ie[qe],De[qe])));return Ne}function _(Ie,De,Be){var Ne,qe=function(Qe){for(var rt=0,ot=Ne.length;rt<ot;){if(Ne[rt]._name===Qe||Ne[rt].mn===Qe||Ne[rt].propertyIndex===Qe||Ne[rt].ix===Qe||Ne[rt].ind===Qe)return Ne[rt];rt+=1}return typeof Qe=="number"?Ne[Qe-1]:null};qe.propertyGroup=propertyGroupFactory(qe,Be),Ne=H(Ie.it,De.it,qe.propertyGroup),qe.numProperties=Ne.length;var Xe=le(Ie.it[Ie.it.length-1],De.it[De.it.length-1],qe.propertyGroup);return qe.transform=Xe,qe.propertyIndex=Ie.cix,qe._name=Ie.nm,qe}function b(Ie,De,Be){var Ne=function(Qe){switch(Qe){case"ADBE Vectors Group":case"Contents":case 2:return Ne.content;default:return Ne.transform}};Ne.propertyGroup=propertyGroupFactory(Ne,Be);var qe=_(Ie,De,Ne.propertyGroup),Xe=le(Ie.it[Ie.it.length-1],De.it[De.it.length-1],Ne.propertyGroup);return Ne.content=qe,Ne.transform=Xe,Object.defineProperty(Ne,"_name",{get:function(){return Ie.nm}}),Ne.numProperties=Ie.np,Ne.propertyIndex=Ie.ix,Ne.nm=Ie.nm,Ne.mn=Ie.mn,Ne}function $(Ie,De,Be){function Ne(qe){return qe==="Color"||qe==="color"?Ne.color:qe==="Opacity"||qe==="opacity"?Ne.opacity:null}return Object.defineProperties(Ne,{color:{get:ExpressionPropertyInterface(De.c)},opacity:{get:ExpressionPropertyInterface(De.o)},_name:{value:Ie.nm},mn:{value:Ie.mn}}),De.c.setGroupProperty(PropertyInterface("Color",Be)),De.o.setGroupProperty(PropertyInterface("Opacity",Be)),Ne}function ee(Ie,De,Be){function Ne(qe){return qe==="Start Point"||qe==="start point"?Ne.startPoint:qe==="End Point"||qe==="end point"?Ne.endPoint:qe==="Opacity"||qe==="opacity"?Ne.opacity:null}return Object.defineProperties(Ne,{startPoint:{get:ExpressionPropertyInterface(De.s)},endPoint:{get:ExpressionPropertyInterface(De.e)},opacity:{get:ExpressionPropertyInterface(De.o)},type:{get:function(){return"a"}},_name:{value:Ie.nm},mn:{value:Ie.mn}}),De.s.setGroupProperty(PropertyInterface("Start Point",Be)),De.e.setGroupProperty(PropertyInterface("End Point",Be)),De.o.setGroupProperty(PropertyInterface("Opacity",Be)),Ne}function re(){function Ie(){return null}return Ie}function ae(Ie,De,Be){var Ne=propertyGroupFactory(ot,Be),qe=propertyGroupFactory(rt,Ne);function Xe(ct){Object.defineProperty(rt,Ie.d[ct].nm,{get:ExpressionPropertyInterface(De.d.dataProps[ct].p)})}var Ye,Qe=Ie.d?Ie.d.length:0,rt={};for(Ye=0;Ye<Qe;Ye+=1)Xe(Ye),De.d.dataProps[Ye].p.setGroupProperty(qe);function ot(ct){return ct==="Color"||ct==="color"?ot.color:ct==="Opacity"||ct==="opacity"?ot.opacity:ct==="Stroke Width"||ct==="stroke width"?ot.strokeWidth:null}return Object.defineProperties(ot,{color:{get:ExpressionPropertyInterface(De.c)},opacity:{get:ExpressionPropertyInterface(De.o)},strokeWidth:{get:ExpressionPropertyInterface(De.w)},dash:{get:function(){return rt}},_name:{value:Ie.nm},mn:{value:Ie.mn}}),De.c.setGroupProperty(PropertyInterface("Color",Ne)),De.o.setGroupProperty(PropertyInterface("Opacity",Ne)),De.w.setGroupProperty(PropertyInterface("Stroke Width",Ne)),ot}function xe(Ie,De,Be){function Ne(Xe){return Xe===Ie.e.ix||Xe==="End"||Xe==="end"?Ne.end:Xe===Ie.s.ix?Ne.start:Xe===Ie.o.ix?Ne.offset:null}var qe=propertyGroupFactory(Ne,Be);return Ne.propertyIndex=Ie.ix,De.s.setGroupProperty(PropertyInterface("Start",qe)),De.e.setGroupProperty(PropertyInterface("End",qe)),De.o.setGroupProperty(PropertyInterface("Offset",qe)),Ne.propertyIndex=Ie.ix,Ne.propertyGroup=Be,Object.defineProperties(Ne,{start:{get:ExpressionPropertyInterface(De.s)},end:{get:ExpressionPropertyInterface(De.e)},offset:{get:ExpressionPropertyInterface(De.o)},_name:{value:Ie.nm}}),Ne.mn=Ie.mn,Ne}function le(Ie,De,Be){function Ne(Xe){return Ie.a.ix===Xe||Xe==="Anchor Point"?Ne.anchorPoint:Ie.o.ix===Xe||Xe==="Opacity"?Ne.opacity:Ie.p.ix===Xe||Xe==="Position"?Ne.position:Ie.r.ix===Xe||Xe==="Rotation"||Xe==="ADBE Vector Rotation"?Ne.rotation:Ie.s.ix===Xe||Xe==="Scale"?Ne.scale:Ie.sk&&Ie.sk.ix===Xe||Xe==="Skew"?Ne.skew:Ie.sa&&Ie.sa.ix===Xe||Xe==="Skew Axis"?Ne.skewAxis:null}var qe=propertyGroupFactory(Ne,Be);return De.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",qe)),De.transform.mProps.p.setGroupProperty(PropertyInterface("Position",qe)),De.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",qe)),De.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",qe)),De.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",qe)),De.transform.mProps.sk&&(De.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",qe)),De.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",qe))),De.transform.op.setGroupProperty(PropertyInterface("Opacity",qe)),Object.defineProperties(Ne,{opacity:{get:ExpressionPropertyInterface(De.transform.mProps.o)},position:{get:ExpressionPropertyInterface(De.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(De.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(De.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(De.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(De.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(De.transform.mProps.sa)},_name:{value:Ie.nm}}),Ne.ty="tr",Ne.mn=Ie.mn,Ne.propertyGroup=Be,Ne}function fe(Ie,De,Be){function Ne(Ye){return Ie.p.ix===Ye?Ne.position:Ie.s.ix===Ye?Ne.size:null}var qe=propertyGroupFactory(Ne,Be);Ne.propertyIndex=Ie.ix;var Xe=De.sh.ty==="tm"?De.sh.prop:De.sh;return Xe.s.setGroupProperty(PropertyInterface("Size",qe)),Xe.p.setGroupProperty(PropertyInterface("Position",qe)),Object.defineProperties(Ne,{size:{get:ExpressionPropertyInterface(Xe.s)},position:{get:ExpressionPropertyInterface(Xe.p)},_name:{value:Ie.nm}}),Ne.mn=Ie.mn,Ne}function ve(Ie,De,Be){function Ne(Ye){return Ie.p.ix===Ye?Ne.position:Ie.r.ix===Ye?Ne.rotation:Ie.pt.ix===Ye?Ne.points:Ie.or.ix===Ye||Ye==="ADBE Vector Star Outer Radius"?Ne.outerRadius:Ie.os.ix===Ye?Ne.outerRoundness:Ie.ir&&(Ie.ir.ix===Ye||Ye==="ADBE Vector Star Inner Radius")?Ne.innerRadius:Ie.is&&Ie.is.ix===Ye?Ne.innerRoundness:null}var qe=propertyGroupFactory(Ne,Be),Xe=De.sh.ty==="tm"?De.sh.prop:De.sh;return Ne.propertyIndex=Ie.ix,Xe.or.setGroupProperty(PropertyInterface("Outer Radius",qe)),Xe.os.setGroupProperty(PropertyInterface("Outer Roundness",qe)),Xe.pt.setGroupProperty(PropertyInterface("Points",qe)),Xe.p.setGroupProperty(PropertyInterface("Position",qe)),Xe.r.setGroupProperty(PropertyInterface("Rotation",qe)),Ie.ir&&(Xe.ir.setGroupProperty(PropertyInterface("Inner Radius",qe)),Xe.is.setGroupProperty(PropertyInterface("Inner Roundness",qe))),Object.defineProperties(Ne,{position:{get:ExpressionPropertyInterface(Xe.p)},rotation:{get:ExpressionPropertyInterface(Xe.r)},points:{get:ExpressionPropertyInterface(Xe.pt)},outerRadius:{get:ExpressionPropertyInterface(Xe.or)},outerRoundness:{get:ExpressionPropertyInterface(Xe.os)},innerRadius:{get:ExpressionPropertyInterface(Xe.ir)},innerRoundness:{get:ExpressionPropertyInterface(Xe.is)},_name:{value:Ie.nm}}),Ne.mn=Ie.mn,Ne}function Se(Ie,De,Be){function Ne(Ye){return Ie.p.ix===Ye?Ne.position:Ie.r.ix===Ye?Ne.roundness:Ie.s.ix===Ye||Ye==="Size"||Ye==="ADBE Vector Rect Size"?Ne.size:null}var qe=propertyGroupFactory(Ne,Be),Xe=De.sh.ty==="tm"?De.sh.prop:De.sh;return Ne.propertyIndex=Ie.ix,Xe.p.setGroupProperty(PropertyInterface("Position",qe)),Xe.s.setGroupProperty(PropertyInterface("Size",qe)),Xe.r.setGroupProperty(PropertyInterface("Rotation",qe)),Object.defineProperties(Ne,{position:{get:ExpressionPropertyInterface(Xe.p)},roundness:{get:ExpressionPropertyInterface(Xe.r)},size:{get:ExpressionPropertyInterface(Xe.s)},_name:{value:Ie.nm}}),Ne.mn=Ie.mn,Ne}function Ee(Ie,De,Be){function Ne(Ye){return Ie.r.ix===Ye||Ye==="Round Corners 1"?Ne.radius:null}var qe=propertyGroupFactory(Ne,Be),Xe=De;return Ne.propertyIndex=Ie.ix,Xe.rd.setGroupProperty(PropertyInterface("Radius",qe)),Object.defineProperties(Ne,{radius:{get:ExpressionPropertyInterface(Xe.rd)},_name:{value:Ie.nm}}),Ne.mn=Ie.mn,Ne}function Ce(Ie,De,Be){function Ne(Ye){return Ie.c.ix===Ye||Ye==="Copies"?Ne.copies:Ie.o.ix===Ye||Ye==="Offset"?Ne.offset:null}var qe=propertyGroupFactory(Ne,Be),Xe=De;return Ne.propertyIndex=Ie.ix,Xe.c.setGroupProperty(PropertyInterface("Copies",qe)),Xe.o.setGroupProperty(PropertyInterface("Offset",qe)),Object.defineProperties(Ne,{copies:{get:ExpressionPropertyInterface(Xe.c)},offset:{get:ExpressionPropertyInterface(Xe.o)},_name:{value:Ie.nm}}),Ne.mn=Ie.mn,Ne}return function(Ie,De,Be){var Ne;function qe(Ye){if(typeof Ye=="number")return Ye=Ye===void 0?1:Ye,Ye===0?Be:Ne[Ye-1];for(var Qe=0,rt=Ne.length;Qe<rt;){if(Ne[Qe]._name===Ye)return Ne[Qe];Qe+=1}return null}function Xe(){return Be}return qe.propertyGroup=propertyGroupFactory(qe,Xe),Ne=H(Ie,De,qe.propertyGroup),qe.numProperties=Ne.length,qe._name="Contents",qe}}(),TextExpressionInterface=function(){return function(H){var _;function b($){switch($){case"ADBE Text Document":return b.sourceText;default:return null}}return Object.defineProperty(b,"sourceText",{get:function(){H.textProperty.getValue();var ee=H.textProperty.currentData.t;return(!_||ee!==_.value)&&(_=new String(ee),_.value=ee||new String(ee),Object.defineProperty(_,"style",{get:function(){return{fillColor:H.textProperty.currentData.fc}}})),_}}),b}}();function _typeof(H){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},_typeof(H)}var FootageInterface=function(){var H=function($){var ee="",re=$.getFootageData();function ae(){return ee="",re=$.getFootageData(),xe}function xe(le){if(re[le])return ee=le,re=re[le],_typeof(re)==="object"?xe:re;var fe=le.indexOf(ee);if(fe!==-1){var ve=parseInt(le.substr(fe+ee.length),10);return re=re[ve],_typeof(re)==="object"?xe:re}return""}return ae},_=function($){function ee(re){return re==="Outline"?ee.outlineInterface():null}return ee._name="Outline",ee.outlineInterface=H($),ee};return function(b){function $(ee){return ee==="Data"?$.dataInterface:null}return $._name="Data",$.dataInterface=_(b),$}}(),interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(H){return interfaces[H]||null}var expressionHelpers=function(){function H(ae,xe,le){xe.x&&(le.k=!0,le.x=!0,le.initiateExpression=ExpressionManager.initiateExpression,le.effectsSequence.push(le.initiateExpression(ae,xe,le).bind(le)))}function _(ae){return ae*=this.elem.globalData.frameRate,ae-=this.offsetTime,ae!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<ae?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(ae,this._cachingAtTime),this._cachingAtTime.lastFrame=ae),this._cachingAtTime.value}function b(ae){var xe=-.01,le=this.getValueAtTime(ae),fe=this.getValueAtTime(ae+xe),ve=0;if(le.length){var Se;for(Se=0;Se<le.length;Se+=1)ve+=Math.pow(fe[Se]-le[Se],2);ve=Math.sqrt(ve)*100}else ve=0;return ve}function $(ae){if(this.vel!==void 0)return this.vel;var xe=-.001,le=this.getValueAtTime(ae),fe=this.getValueAtTime(ae+xe),ve;if(le.length){ve=createTypedArray("float32",le.length);var Se;for(Se=0;Se<le.length;Se+=1)ve[Se]=(fe[Se]-le[Se])/xe}else ve=(fe-le)/xe;return ve}function ee(){return this.pv}function re(ae){this.propertyGroup=ae}return{searchExpressions:H,getSpeedAtTime:b,getVelocityAtTime:$,getValueAtTime:_,getStaticValueAtTime:ee,setGroupProperty:re}}();function addPropertyDecorator(){function H(Ee,Ce,Ie){if(!this.k||!this.keyframes)return this.pv;Ee=Ee?Ee.toLowerCase():"";var De=this.comp.renderedFrame,Be=this.keyframes,Ne=Be[Be.length-1].t;if(De<=Ne)return this.pv;var qe,Xe;Ie?(Ce?qe=Math.abs(Ne-this.elem.comp.globalData.frameRate*Ce):qe=Math.max(0,Ne-this.elem.data.ip),Xe=Ne-qe):((!Ce||Ce>Be.length-1)&&(Ce=Be.length-1),Xe=Be[Be.length-1-Ce].t,qe=Ne-Xe);var Ye,Qe,rt;if(Ee==="pingpong"){var ot=Math.floor((De-Xe)/qe);if(ot%2!==0)return this.getValueAtTime((qe-(De-Xe)%qe+Xe)/this.comp.globalData.frameRate,0)}else if(Ee==="offset"){var ct=this.getValueAtTime(Xe/this.comp.globalData.frameRate,0),mt=this.getValueAtTime(Ne/this.comp.globalData.frameRate,0),_t=this.getValueAtTime(((De-Xe)%qe+Xe)/this.comp.globalData.frameRate,0),Lt=Math.floor((De-Xe)/qe);if(this.pv.length){for(rt=new Array(ct.length),Qe=rt.length,Ye=0;Ye<Qe;Ye+=1)rt[Ye]=(mt[Ye]-ct[Ye])*Lt+_t[Ye];return rt}return(mt-ct)*Lt+_t}else if(Ee==="continue"){var Vt=this.getValueAtTime(Ne/this.comp.globalData.frameRate,0),Gt=this.getValueAtTime((Ne-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(rt=new Array(Vt.length),Qe=rt.length,Ye=0;Ye<Qe;Ye+=1)rt[Ye]=Vt[Ye]+(Vt[Ye]-Gt[Ye])*((De-Ne)/this.comp.globalData.frameRate)/5e-4;return rt}return Vt+(Vt-Gt)*((De-Ne)/.001)}return this.getValueAtTime(((De-Xe)%qe+Xe)/this.comp.globalData.frameRate,0)}function _(Ee,Ce,Ie){if(!this.k)return this.pv;Ee=Ee?Ee.toLowerCase():"";var De=this.comp.renderedFrame,Be=this.keyframes,Ne=Be[0].t;if(De>=Ne)return this.pv;var qe,Xe;Ie?(Ce?qe=Math.abs(this.elem.comp.globalData.frameRate*Ce):qe=Math.max(0,this.elem.data.op-Ne),Xe=Ne+qe):((!Ce||Ce>Be.length-1)&&(Ce=Be.length-1),Xe=Be[Ce].t,qe=Xe-Ne);var Ye,Qe,rt;if(Ee==="pingpong"){var ot=Math.floor((Ne-De)/qe);if(ot%2===0)return this.getValueAtTime(((Ne-De)%qe+Ne)/this.comp.globalData.frameRate,0)}else if(Ee==="offset"){var ct=this.getValueAtTime(Ne/this.comp.globalData.frameRate,0),mt=this.getValueAtTime(Xe/this.comp.globalData.frameRate,0),_t=this.getValueAtTime((qe-(Ne-De)%qe+Ne)/this.comp.globalData.frameRate,0),Lt=Math.floor((Ne-De)/qe)+1;if(this.pv.length){for(rt=new Array(ct.length),Qe=rt.length,Ye=0;Ye<Qe;Ye+=1)rt[Ye]=_t[Ye]-(mt[Ye]-ct[Ye])*Lt;return rt}return _t-(mt-ct)*Lt}else if(Ee==="continue"){var Vt=this.getValueAtTime(Ne/this.comp.globalData.frameRate,0),Gt=this.getValueAtTime((Ne+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(rt=new Array(Vt.length),Qe=rt.length,Ye=0;Ye<Qe;Ye+=1)rt[Ye]=Vt[Ye]+(Vt[Ye]-Gt[Ye])*(Ne-De)/.001;return rt}return Vt+(Vt-Gt)*(Ne-De)/.001}return this.getValueAtTime((qe-((Ne-De)%qe+Ne))/this.comp.globalData.frameRate,0)}function b(Ee,Ce){if(!this.k)return this.pv;if(Ee=(Ee||.4)*.5,Ce=Math.floor(Ce||5),Ce<=1)return this.pv;var Ie=this.comp.renderedFrame/this.comp.globalData.frameRate,De=Ie-Ee,Be=Ie+Ee,Ne=Ce>1?(Be-De)/(Ce-1):1,qe=0,Xe=0,Ye;this.pv.length?Ye=createTypedArray("float32",this.pv.length):Ye=0;for(var Qe;qe<Ce;){if(Qe=this.getValueAtTime(De+qe*Ne),this.pv.length)for(Xe=0;Xe<this.pv.length;Xe+=1)Ye[Xe]+=Qe[Xe];else Ye+=Qe;qe+=1}if(this.pv.length)for(Xe=0;Xe<this.pv.length;Xe+=1)Ye[Xe]/=Ce;else Ye/=Ce;return Ye}function $(Ee){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var Ce=this._transformCachingAtTime.v;if(Ce.cloneFromProps(this.pre.props),this.appliedTransformations<1){var Ie=this.a.getValueAtTime(Ee);Ce.translate(-Ie[0]*this.a.mult,-Ie[1]*this.a.mult,Ie[2]*this.a.mult)}if(this.appliedTransformations<2){var De=this.s.getValueAtTime(Ee);Ce.scale(De[0]*this.s.mult,De[1]*this.s.mult,De[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var Be=this.sk.getValueAtTime(Ee),Ne=this.sa.getValueAtTime(Ee);Ce.skewFromAxis(-Be*this.sk.mult,Ne*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var qe=this.r.getValueAtTime(Ee);Ce.rotate(-qe*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var Xe=this.rz.getValueAtTime(Ee),Ye=this.ry.getValueAtTime(Ee),Qe=this.rx.getValueAtTime(Ee),rt=this.or.getValueAtTime(Ee);Ce.rotateZ(-Xe*this.rz.mult).rotateY(Ye*this.ry.mult).rotateX(Qe*this.rx.mult).rotateZ(-rt[2]*this.or.mult).rotateY(rt[1]*this.or.mult).rotateX(rt[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var ot=this.px.getValueAtTime(Ee),ct=this.py.getValueAtTime(Ee);if(this.data.p.z){var mt=this.pz.getValueAtTime(Ee);Ce.translate(ot*this.px.mult,ct*this.py.mult,-mt*this.pz.mult)}else Ce.translate(ot*this.px.mult,ct*this.py.mult,0)}else{var _t=this.p.getValueAtTime(Ee);Ce.translate(_t[0]*this.p.mult,_t[1]*this.p.mult,-_t[2]*this.p.mult)}return Ce}function ee(){return this.v.clone(new Matrix)}var re=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(Ee,Ce,Ie){var De=re(Ee,Ce,Ie);return De.dynamicProperties.length?De.getValueAtTime=$.bind(De):De.getValueAtTime=ee.bind(De),De.setGroupProperty=expressionHelpers.setGroupProperty,De};var ae=PropertyFactory.getProp;PropertyFactory.getProp=function(Ee,Ce,Ie,De,Be){var Ne=ae(Ee,Ce,Ie,De,Be);Ne.kf?Ne.getValueAtTime=expressionHelpers.getValueAtTime.bind(Ne):Ne.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(Ne),Ne.setGroupProperty=expressionHelpers.setGroupProperty,Ne.loopOut=H,Ne.loopIn=_,Ne.smooth=b,Ne.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(Ne),Ne.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(Ne),Ne.numKeys=Ce.a===1?Ce.k.length:0,Ne.propertyIndex=Ce.ix;var qe=0;return Ie!==0&&(qe=createTypedArray("float32",Ce.a===1?Ce.k[0].s.length:Ce.k.length)),Ne._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:qe},expressionHelpers.searchExpressions(Ee,Ce,Ne),Ne.k&&Be.addDynamicProperty(Ne),Ne};function xe(Ee){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),Ee*=this.elem.globalData.frameRate,Ee-=this.offsetTime,Ee!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<Ee?this._caching.lastIndex:0,this._cachingAtTime.lastTime=Ee,this.interpolateShape(Ee,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue}var le=ShapePropertyFactory.getConstructorFunction(),fe=ShapePropertyFactory.getKeyframedConstructorFunction();function ve(){}ve.prototype={vertices:function(Ce,Ie){this.k&&this.getValue();var De=this.v;Ie!==void 0&&(De=this.getValueAtTime(Ie,0));var Be,Ne=De._length,qe=De[Ce],Xe=De.v,Ye=createSizedArray(Ne);for(Be=0;Be<Ne;Be+=1)Ce==="i"||Ce==="o"?Ye[Be]=[qe[Be][0]-Xe[Be][0],qe[Be][1]-Xe[Be][1]]:Ye[Be]=[qe[Be][0],qe[Be][1]];return Ye},points:function(Ce){return this.vertices("v",Ce)},inTangents:function(Ce){return this.vertices("i",Ce)},outTangents:function(Ce){return this.vertices("o",Ce)},isClosed:function(){return this.v.c},pointOnPath:function(Ce,Ie){var De=this.v;Ie!==void 0&&(De=this.getValueAtTime(Ie,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(De));for(var Be=this._segmentsLength,Ne=Be.lengths,qe=Be.totalLength*Ce,Xe=0,Ye=Ne.length,Qe=0,rt;Xe<Ye;){if(Qe+Ne[Xe].addedLength>qe){var ot=Xe,ct=De.c&&Xe===Ye-1?0:Xe+1,mt=(qe-Qe)/Ne[Xe].addedLength;rt=bez.getPointInSegment(De.v[ot],De.v[ct],De.o[ot],De.i[ct],mt,Ne[Xe]);break}else Qe+=Ne[Xe].addedLength;Xe+=1}return rt||(rt=De.c?[De.v[0][0],De.v[0][1]]:[De.v[De._length-1][0],De.v[De._length-1][1]]),rt},vectorOnPath:function(Ce,Ie,De){Ce==1?Ce=this.v.c:Ce==0&&(Ce=.999);var Be=this.pointOnPath(Ce,Ie),Ne=this.pointOnPath(Ce+.001,Ie),qe=Ne[0]-Be[0],Xe=Ne[1]-Be[1],Ye=Math.sqrt(Math.pow(qe,2)+Math.pow(Xe,2));if(Ye===0)return[0,0];var Qe=De==="tangent"?[qe/Ye,Xe/Ye]:[-Xe/Ye,qe/Ye];return Qe},tangentOnPath:function(Ce,Ie){return this.vectorOnPath(Ce,Ie,"tangent")},normalOnPath:function(Ce,Ie){return this.vectorOnPath(Ce,Ie,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([ve],le),extendPrototype([ve],fe),fe.prototype.getValueAtTime=xe,fe.prototype.initiateExpression=ExpressionManager.initiateExpression;var Se=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(Ee,Ce,Ie,De,Be){var Ne=Se(Ee,Ce,Ie,De,Be);return Ne.propertyIndex=Ce.ix,Ne.lock=!1,Ie===3?expressionHelpers.searchExpressions(Ee,Ce.pt,Ne):Ie===4&&expressionHelpers.searchExpressions(Ee,Ce.ks,Ne),Ne.k&&Ee.addDynamicProperty(Ne),Ne}}function initialize$1(){addPropertyDecorator()}function addDecorator(){function H(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}TextProperty.prototype.getExpressionValue=function(_,b){var $=this.calculateExpression(b);if(_.t!==$){var ee={};return this.copyData(ee,_),ee.t=$.toString(),ee.__complete=!1,ee}return _},TextProperty.prototype.searchProperty=function(){var _=this.searchKeyframes(),b=this.searchExpressions();return this.kf=_||b,this.kf},TextProperty.prototype.searchExpressions=H}function initialize(){addDecorator()}function SVGComposableEffect(){}SVGComposableEffect.prototype={createMergeNode:function H(_,b){var $=createNS("feMerge");$.setAttribute("result",_);var ee,re;for(re=0;re<b.length;re+=1)ee=createNS("feMergeNode"),ee.setAttribute("in",b[re]),$.appendChild(ee),$.appendChild(ee);return $}};var linearFilterValue="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0";function SVGTintFilter(H,_,b,$,ee){this.filterManager=_;var re=createNS("feColorMatrix");re.setAttribute("type","matrix"),re.setAttribute("color-interpolation-filters","linearRGB"),re.setAttribute("values",linearFilterValue+" 1 0"),this.linearFilter=re,re.setAttribute("result",$+"_tint_1"),H.appendChild(re),re=createNS("feColorMatrix"),re.setAttribute("type","matrix"),re.setAttribute("color-interpolation-filters","sRGB"),re.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),re.setAttribute("result",$+"_tint_2"),H.appendChild(re),this.matrixFilter=re;var ae=this.createMergeNode($,[ee,$+"_tint_1",$+"_tint_2"]);H.appendChild(ae)}extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(H){if(H||this.filterManager._mdf){var _=this.filterManager.effectElements[0].p.v,b=this.filterManager.effectElements[1].p.v,$=this.filterManager.effectElements[2].p.v/100;this.linearFilter.setAttribute("values",linearFilterValue+" "+$+" 0"),this.matrixFilter.setAttribute("values",b[0]-_[0]+" 0 0 0 "+_[0]+" "+(b[1]-_[1])+" 0 0 0 "+_[1]+" "+(b[2]-_[2])+" 0 0 0 "+_[2]+" 0 0 0 1 0")}};function SVGFillFilter(H,_,b,$){this.filterManager=_;var ee=createNS("feColorMatrix");ee.setAttribute("type","matrix"),ee.setAttribute("color-interpolation-filters","sRGB"),ee.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),ee.setAttribute("result",$),H.appendChild(ee),this.matrixFilter=ee}SVGFillFilter.prototype.renderFrame=function(H){if(H||this.filterManager._mdf){var _=this.filterManager.effectElements[2].p.v,b=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+_[0]+" 0 0 0 0 "+_[1]+" 0 0 0 0 "+_[2]+" 0 0 0 "+b+" 0")}};function SVGStrokeEffect(H,_,b){this.initialized=!1,this.filterManager=_,this.elem=b,this.paths=[]}SVGStrokeEffect.prototype.initialize=function(){var H=this.elem.layerElement.children||this.elem.layerElement.childNodes,_,b,$,ee;for(this.filterManager.effectElements[1].p.v===1?(ee=this.elem.maskManager.masksProperties.length,$=0):($=this.filterManager.effectElements[0].p.v-1,ee=$+1),b=createNS("g"),b.setAttribute("fill","none"),b.setAttribute("stroke-linecap","round"),b.setAttribute("stroke-dashoffset",1),$;$<ee;$+=1)_=createNS("path"),b.appendChild(_),this.paths.push({p:_,m:$});if(this.filterManager.effectElements[10].p.v===3){var re=createNS("mask"),ae=createElementID();re.setAttribute("id",ae),re.setAttribute("mask-type","alpha"),re.appendChild(b),this.elem.globalData.defs.appendChild(re);var xe=createNS("g");for(xe.setAttribute("mask","url("+getLocationHref()+"#"+ae+")");H[0];)xe.appendChild(H[0]);this.elem.layerElement.appendChild(xe),this.masker=re,b.setAttribute("stroke","#fff")}else if(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2){if(this.filterManager.effectElements[10].p.v===2)for(H=this.elem.layerElement.children||this.elem.layerElement.childNodes;H.length;)this.elem.layerElement.removeChild(H[0]);this.elem.layerElement.appendChild(b),this.elem.layerElement.removeAttribute("mask"),b.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=b},SVGStrokeEffect.prototype.renderFrame=function(H){this.initialized||this.initialize();var _,b=this.paths.length,$,ee;for(_=0;_<b;_+=1)if(this.paths[_].m!==-1&&($=this.elem.maskManager.viewData[this.paths[_].m],ee=this.paths[_].p,(H||this.filterManager._mdf||$.prop._mdf)&&ee.setAttribute("d",$.lastPath),H||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||$.prop._mdf)){var re;if(this.filterManager.effectElements[7].p.v!==0||this.filterManager.effectElements[8].p.v!==100){var ae=Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,xe=Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)*.01,le=ee.getTotalLength();re="0 0 0 "+le*ae+" ";var fe=le*(xe-ae),ve=1+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01,Se=Math.floor(fe/ve),Ee;for(Ee=0;Ee<Se;Ee+=1)re+="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01+" ";re+="0 "+le*10+" 0 0"}else re="1 "+this.filterManager.effectElements[4].p.v*2*this.filterManager.effectElements[9].p.v*.01;ee.setAttribute("stroke-dasharray",re)}if((H||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",this.filterManager.effectElements[4].p.v*2),(H||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2)&&(H||this.filterManager.effectElements[3].p._mdf)){var Ce=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(Ce[0]*255)+","+bmFloor(Ce[1]*255)+","+bmFloor(Ce[2]*255)+")")}};function SVGTritoneFilter(H,_,b,$){this.filterManager=_;var ee=createNS("feColorMatrix");ee.setAttribute("type","matrix"),ee.setAttribute("color-interpolation-filters","linearRGB"),ee.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),H.appendChild(ee);var re=createNS("feComponentTransfer");re.setAttribute("color-interpolation-filters","sRGB"),re.setAttribute("result",$),this.matrixFilter=re;var ae=createNS("feFuncR");ae.setAttribute("type","table"),re.appendChild(ae),this.feFuncR=ae;var xe=createNS("feFuncG");xe.setAttribute("type","table"),re.appendChild(xe),this.feFuncG=xe;var le=createNS("feFuncB");le.setAttribute("type","table"),re.appendChild(le),this.feFuncB=le,H.appendChild(re)}SVGTritoneFilter.prototype.renderFrame=function(H){if(H||this.filterManager._mdf){var _=this.filterManager.effectElements[0].p.v,b=this.filterManager.effectElements[1].p.v,$=this.filterManager.effectElements[2].p.v,ee=$[0]+" "+b[0]+" "+_[0],re=$[1]+" "+b[1]+" "+_[1],ae=$[2]+" "+b[2]+" "+_[2];this.feFuncR.setAttribute("tableValues",ee),this.feFuncG.setAttribute("tableValues",re),this.feFuncB.setAttribute("tableValues",ae)}};function SVGProLevelsFilter(H,_,b,$){this.filterManager=_;var ee=this.filterManager.effectElements,re=createNS("feComponentTransfer");(ee[10].p.k||ee[10].p.v!==0||ee[11].p.k||ee[11].p.v!==1||ee[12].p.k||ee[12].p.v!==1||ee[13].p.k||ee[13].p.v!==0||ee[14].p.k||ee[14].p.v!==1)&&(this.feFuncR=this.createFeFunc("feFuncR",re)),(ee[17].p.k||ee[17].p.v!==0||ee[18].p.k||ee[18].p.v!==1||ee[19].p.k||ee[19].p.v!==1||ee[20].p.k||ee[20].p.v!==0||ee[21].p.k||ee[21].p.v!==1)&&(this.feFuncG=this.createFeFunc("feFuncG",re)),(ee[24].p.k||ee[24].p.v!==0||ee[25].p.k||ee[25].p.v!==1||ee[26].p.k||ee[26].p.v!==1||ee[27].p.k||ee[27].p.v!==0||ee[28].p.k||ee[28].p.v!==1)&&(this.feFuncB=this.createFeFunc("feFuncB",re)),(ee[31].p.k||ee[31].p.v!==0||ee[32].p.k||ee[32].p.v!==1||ee[33].p.k||ee[33].p.v!==1||ee[34].p.k||ee[34].p.v!==0||ee[35].p.k||ee[35].p.v!==1)&&(this.feFuncA=this.createFeFunc("feFuncA",re)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(re.setAttribute("color-interpolation-filters","sRGB"),H.appendChild(re)),(ee[3].p.k||ee[3].p.v!==0||ee[4].p.k||ee[4].p.v!==1||ee[5].p.k||ee[5].p.v!==1||ee[6].p.k||ee[6].p.v!==0||ee[7].p.k||ee[7].p.v!==1)&&(re=createNS("feComponentTransfer"),re.setAttribute("color-interpolation-filters","sRGB"),re.setAttribute("result",$),H.appendChild(re),this.feFuncRComposed=this.createFeFunc("feFuncR",re),this.feFuncGComposed=this.createFeFunc("feFuncG",re),this.feFuncBComposed=this.createFeFunc("feFuncB",re))}SVGProLevelsFilter.prototype.createFeFunc=function(H,_){var b=createNS(H);return b.setAttribute("type","table"),_.appendChild(b),b},SVGProLevelsFilter.prototype.getTableValue=function(H,_,b,$,ee){for(var re=0,ae=256,xe,le=Math.min(H,_),fe=Math.max(H,_),ve=Array.call(null,{length:ae}),Se,Ee=0,Ce=ee-$,Ie=_-H;re<=256;)xe=re/256,xe<=le?Se=Ie<0?ee:$:xe>=fe?Se=Ie<0?$:ee:Se=$+Ce*Math.pow((xe-H)/Ie,1/b),ve[Ee]=Se,Ee+=1,re+=256/(ae-1);return ve.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(H){if(H||this.filterManager._mdf){var _,b=this.filterManager.effectElements;this.feFuncRComposed&&(H||b[3].p._mdf||b[4].p._mdf||b[5].p._mdf||b[6].p._mdf||b[7].p._mdf)&&(_=this.getTableValue(b[3].p.v,b[4].p.v,b[5].p.v,b[6].p.v,b[7].p.v),this.feFuncRComposed.setAttribute("tableValues",_),this.feFuncGComposed.setAttribute("tableValues",_),this.feFuncBComposed.setAttribute("tableValues",_)),this.feFuncR&&(H||b[10].p._mdf||b[11].p._mdf||b[12].p._mdf||b[13].p._mdf||b[14].p._mdf)&&(_=this.getTableValue(b[10].p.v,b[11].p.v,b[12].p.v,b[13].p.v,b[14].p.v),this.feFuncR.setAttribute("tableValues",_)),this.feFuncG&&(H||b[17].p._mdf||b[18].p._mdf||b[19].p._mdf||b[20].p._mdf||b[21].p._mdf)&&(_=this.getTableValue(b[17].p.v,b[18].p.v,b[19].p.v,b[20].p.v,b[21].p.v),this.feFuncG.setAttribute("tableValues",_)),this.feFuncB&&(H||b[24].p._mdf||b[25].p._mdf||b[26].p._mdf||b[27].p._mdf||b[28].p._mdf)&&(_=this.getTableValue(b[24].p.v,b[25].p.v,b[26].p.v,b[27].p.v,b[28].p.v),this.feFuncB.setAttribute("tableValues",_)),this.feFuncA&&(H||b[31].p._mdf||b[32].p._mdf||b[33].p._mdf||b[34].p._mdf||b[35].p._mdf)&&(_=this.getTableValue(b[31].p.v,b[32].p.v,b[33].p.v,b[34].p.v,b[35].p.v),this.feFuncA.setAttribute("tableValues",_))}};function SVGDropShadowEffect(H,_,b,$,ee){var re=_.container.globalData.renderConfig.filterSize,ae=_.data.fs||re;H.setAttribute("x",ae.x||re.x),H.setAttribute("y",ae.y||re.y),H.setAttribute("width",ae.width||re.width),H.setAttribute("height",ae.height||re.height),this.filterManager=_;var xe=createNS("feGaussianBlur");xe.setAttribute("in","SourceAlpha"),xe.setAttribute("result",$+"_drop_shadow_1"),xe.setAttribute("stdDeviation","0"),this.feGaussianBlur=xe,H.appendChild(xe);var le=createNS("feOffset");le.setAttribute("dx","25"),le.setAttribute("dy","0"),le.setAttribute("in",$+"_drop_shadow_1"),le.setAttribute("result",$+"_drop_shadow_2"),this.feOffset=le,H.appendChild(le);var fe=createNS("feFlood");fe.setAttribute("flood-color","#00ff00"),fe.setAttribute("flood-opacity","1"),fe.setAttribute("result",$+"_drop_shadow_3"),this.feFlood=fe,H.appendChild(fe);var ve=createNS("feComposite");ve.setAttribute("in",$+"_drop_shadow_3"),ve.setAttribute("in2",$+"_drop_shadow_2"),ve.setAttribute("operator","in"),ve.setAttribute("result",$+"_drop_shadow_4"),H.appendChild(ve);var Se=this.createMergeNode($,[$+"_drop_shadow_4",ee]);H.appendChild(Se)}extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(H){if(H||this.filterManager._mdf){if((H||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),H||this.filterManager.effectElements[0].p._mdf){var _=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(_[0]*255),Math.round(_[1]*255),Math.round(_[2]*255)))}if((H||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),H||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var b=this.filterManager.effectElements[3].p.v,$=(this.filterManager.effectElements[2].p.v-90)*degToRads,ee=b*Math.cos($),re=b*Math.sin($);this.feOffset.setAttribute("dx",ee),this.feOffset.setAttribute("dy",re)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(H,_,b){this.initialized=!1,this.filterManager=_,this.filterElem=H,this.elem=b,b.matteElement=createNS("g"),b.matteElement.appendChild(b.layerElement),b.matteElement.appendChild(b.transformedElement),b.baseElement=b.matteElement}SVGMatte3Effect.prototype.findSymbol=function(H){for(var _=0,b=_svgMatteSymbols.length;_<b;){if(_svgMatteSymbols[_]===H)return _svgMatteSymbols[_];_+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(H,_){var b=H.layerElement.parentNode;if(b){for(var $=b.children,ee=0,re=$.length;ee<re&&$[ee]!==H.layerElement;)ee+=1;var ae;ee<=re-2&&(ae=$[ee+1]);var xe=createNS("use");xe.setAttribute("href","#"+_),ae?b.insertBefore(xe,ae):b.appendChild(xe)}},SVGMatte3Effect.prototype.setElementAsMask=function(H,_){if(!this.findSymbol(_)){var b=createElementID(),$=createNS("mask");$.setAttribute("id",_.layerId),$.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(_);var ee=H.globalData.defs;ee.appendChild($);var re=createNS("symbol");re.setAttribute("id",b),this.replaceInParent(_,b),re.appendChild(_.layerElement),ee.appendChild(re);var ae=createNS("use");ae.setAttribute("href","#"+b),$.appendChild(ae),_.data.hd=!1,_.show()}H.setMatte(_.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var H=this.filterManager.effectElements[0].p.v,_=this.elem.comp.elements,b=0,$=_.length;b<$;)_[b]&&_[b].data.ind===H&&this.setElementAsMask(this.elem,_[b]),b+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()};function SVGGaussianBlurEffect(H,_,b,$){H.setAttribute("x","-100%"),H.setAttribute("y","-100%"),H.setAttribute("width","300%"),H.setAttribute("height","300%"),this.filterManager=_;var ee=createNS("feGaussianBlur");ee.setAttribute("result",$),H.appendChild(ee),this.feGaussianBlur=ee}SVGGaussianBlurEffect.prototype.renderFrame=function(H){if(H||this.filterManager._mdf){var _=.3,b=this.filterManager.effectElements[0].p.v*_,$=this.filterManager.effectElements[1].p.v,ee=$==3?0:b,re=$==2?0:b;this.feGaussianBlur.setAttribute("stdDeviation",ee+" "+re);var ae=this.filterManager.effectElements[2].p.v==1?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",ae)}};function TransformEffect(){}TransformEffect.prototype.init=function(H){this.effectsManager=H,this.type=effectTypes.TRANSFORM_EFFECT,this.matrix=new Matrix,this.opacity=-1,this._mdf=!1,this._opMdf=!1},TransformEffect.prototype.renderFrame=function(H){if(this._opMdf=!1,this._mdf=!1,H||this.effectsManager._mdf){var _=this.effectsManager.effectElements,b=_[0].p.v,$=_[1].p.v,ee=_[2].p.v===1,re=_[3].p.v,ae=ee?re:_[4].p.v,xe=_[5].p.v,le=_[6].p.v,fe=_[7].p.v;this.matrix.reset(),this.matrix.translate(-b[0],-b[1],b[2]),this.matrix.scale(ae*.01,re*.01,1),this.matrix.rotate(-fe*degToRads),this.matrix.skewFromAxis(-xe*degToRads,(le+90)*degToRads),this.matrix.translate($[0],$[1],0),this._mdf=!0,this.opacity!==_[8].p.v&&(this.opacity=_[8].p.v,this._opMdf=!0)}};function SVGTransformEffect(H,_){this.init(_)}extendPrototype([TransformEffect],SVGTransformEffect);function CVTransformEffect(H){this.init(H)}return extendPrototype([TransformEffect],CVTransformEffect),registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect$1(20,SVGTintFilter,!0),registerEffect$1(21,SVGFillFilter,!0),registerEffect$1(22,SVGStrokeEffect,!1),registerEffect$1(23,SVGTritoneFilter,!0),registerEffect$1(24,SVGProLevelsFilter,!0),registerEffect$1(25,SVGDropShadowEffect,!0),registerEffect$1(28,SVGMatte3Effect,!1),registerEffect$1(29,SVGGaussianBlurEffect,!0),registerEffect$1(35,SVGTransformEffect,!1),registerEffect(35,CVTransformEffect),lottie})}(lottie$2,lottie$2.exports)),lottie$2.exports}var lottieExports=requireLottie();const lottie=getDefaultExportFromCjs(lottieExports);function _arrayLikeToArray(H,_){(_==null||_>H.length)&&(_=H.length);for(var b=0,$=Array(_);b<_;b++)$[b]=H[b];return $}function _arrayWithHoles(H){if(Array.isArray(H))return H}function _defineProperty(H,_,b){return(_=_toPropertyKey(_))in H?Object.defineProperty(H,_,{value:b,enumerable:!0,configurable:!0,writable:!0}):H[_]=b,H}function _iterableToArrayLimit(H,_){var b=H==null?null:typeof Symbol<"u"&&H[Symbol.iterator]||H["@@iterator"];if(b!=null){var $,ee,re,ae,xe=[],le=!0,fe=!1;try{if(re=(b=b.call(H)).next,_!==0)for(;!(le=($=re.call(b)).done)&&(xe.push($.value),xe.length!==_);le=!0);}catch(ve){fe=!0,ee=ve}finally{try{if(!le&&b.return!=null&&(ae=b.return(),Object(ae)!==ae))return}finally{if(fe)throw ee}}return xe}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ownKeys(H,_){var b=Object.keys(H);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(H);_&&($=$.filter(function(ee){return Object.getOwnPropertyDescriptor(H,ee).enumerable})),b.push.apply(b,$)}return b}function _objectSpread2(H){for(var _=1;_<arguments.length;_++){var b=arguments[_]!=null?arguments[_]:{};_%2?ownKeys(Object(b),!0).forEach(function($){_defineProperty(H,$,b[$])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function($){Object.defineProperty(H,$,Object.getOwnPropertyDescriptor(b,$))})}return H}function _objectWithoutProperties(H,_){if(H==null)return{};var b,$,ee=_objectWithoutPropertiesLoose(H,_);if(Object.getOwnPropertySymbols){var re=Object.getOwnPropertySymbols(H);for($=0;$<re.length;$++)b=re[$],_.includes(b)||{}.propertyIsEnumerable.call(H,b)&&(ee[b]=H[b])}return ee}function _objectWithoutPropertiesLoose(H,_){if(H==null)return{};var b={};for(var $ in H)if({}.hasOwnProperty.call(H,$)){if(_.includes($))continue;b[$]=H[$]}return b}function _slicedToArray(H,_){return _arrayWithHoles(H)||_iterableToArrayLimit(H,_)||_unsupportedIterableToArray(H,_)||_nonIterableRest()}function _toPrimitive(H,_){if(typeof H!="object"||!H)return H;var b=H[Symbol.toPrimitive];if(b!==void 0){var $=b.call(H,_);if(typeof $!="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(H)}function _toPropertyKey(H){var _=_toPrimitive(H,"string");return typeof _=="symbol"?_:_+""}function _unsupportedIterableToArray(H,_){if(H){if(typeof H=="string")return _arrayLikeToArray(H,_);var b={}.toString.call(H).slice(8,-1);return b==="Object"&&H.constructor&&(b=H.constructor.name),b==="Map"||b==="Set"?Array.from(H):b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?_arrayLikeToArray(H,_):void 0}}var _excluded$1=["animationData","loop","autoplay","initialSegment","onComplete","onLoopComplete","onEnterFrame","onSegmentStart","onConfigReady","onDataReady","onDataFailed","onLoadedImages","onDOMLoaded","onDestroy","lottieRef","renderer","name","assetsPath","rendererSettings"],useLottie=function H(_,b){var $=_.animationData,ee=_.loop,re=_.autoplay,ae=_.initialSegment,xe=_.onComplete,le=_.onLoopComplete,fe=_.onEnterFrame,ve=_.onSegmentStart,Se=_.onConfigReady,Ee=_.onDataReady,Ce=_.onDataFailed,Ie=_.onLoadedImages,De=_.onDOMLoaded,Be=_.onDestroy;_.lottieRef,_.renderer,_.name,_.assetsPath,_.rendererSettings;var Ne=_objectWithoutProperties(_,_excluded$1),qe=reactExports.useState(!1),Xe=_slicedToArray(qe,2),Ye=Xe[0],Qe=Xe[1],rt=reactExports.useRef(),ot=reactExports.useRef(null),ct=function(){var sn;(sn=rt.current)===null||sn===void 0||sn.play()},mt=function(){var sn;(sn=rt.current)===null||sn===void 0||sn.stop()},_t=function(){var sn;(sn=rt.current)===null||sn===void 0||sn.pause()},Lt=function(sn){var cn;(cn=rt.current)===null||cn===void 0||cn.setSpeed(sn)},Vt=function(sn,cn){var en;(en=rt.current)===null||en===void 0||en.goToAndPlay(sn,cn)},Gt=function(sn,cn){var en;(en=rt.current)===null||en===void 0||en.goToAndStop(sn,cn)},$t=function(sn){var cn;(cn=rt.current)===null||cn===void 0||cn.setDirection(sn)},Qt=function(sn,cn){var en;(en=rt.current)===null||en===void 0||en.playSegments(sn,cn)},vt=function(sn){var cn;(cn=rt.current)===null||cn===void 0||cn.setSubframe(sn)},It=function(sn){var cn;return(cn=rt.current)===null||cn===void 0?void 0:cn.getDuration(sn)},gt=function(){var sn;(sn=rt.current)===null||sn===void 0||sn.destroy(),rt.current=void 0},Tt=function(){var sn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},cn;if(ot.current){(cn=rt.current)===null||cn===void 0||cn.destroy();var en=_objectSpread2(_objectSpread2(_objectSpread2({},_),sn),{},{container:ot.current});return rt.current=lottie.loadAnimation(en),Qe(!!rt.current),function(){var yn;(yn=rt.current)===null||yn===void 0||yn.destroy(),rt.current=void 0}}};reactExports.useEffect(function(){var Ft=Tt();return function(){return Ft==null?void 0:Ft()}},[$,ee]),reactExports.useEffect(function(){rt.current&&(rt.current.autoplay=!!re)},[re]),reactExports.useEffect(function(){if(rt.current){if(!ae){rt.current.resetSegments(!0);return}!Array.isArray(ae)||!ae.length||((rt.current.currentRawFrame<ae[0]||rt.current.currentRawFrame>ae[1])&&(rt.current.currentRawFrame=ae[0]),rt.current.setSegment(ae[0],ae[1]))}},[ae]),reactExports.useEffect(function(){var Ft=[{name:"complete",handler:xe},{name:"loopComplete",handler:le},{name:"enterFrame",handler:fe},{name:"segmentStart",handler:ve},{name:"config_ready",handler:Se},{name:"data_ready",handler:Ee},{name:"data_failed",handler:Ce},{name:"loaded_images",handler:Ie},{name:"DOMLoaded",handler:De},{name:"destroy",handler:Be}],sn=Ft.filter(function(en){return en.handler!=null});if(sn.length){var cn=sn.map(function(en){var yn;return(yn=rt.current)===null||yn===void 0||yn.addEventListener(en.name,en.handler),function(){var Pn;(Pn=rt.current)===null||Pn===void 0||Pn.removeEventListener(en.name,en.handler)}});return function(){cn.forEach(function(en){return en()})}}},[xe,le,fe,ve,Se,Ee,Ce,Ie,De,Be]);var Ct=React.createElement("div",_objectSpread2({style:b,ref:ot},Ne));return{View:Ct,play:ct,stop:mt,pause:_t,setSpeed:Lt,goToAndStop:Gt,goToAndPlay:Vt,setDirection:$t,playSegments:Qt,setSubframe:vt,getDuration:It,destroy:gt,animationContainerRef:ot,animationLoaded:Ye,animationItem:rt.current}};function getContainerVisibility(H){var _=H.getBoundingClientRect(),b=_.top,$=_.height,ee=window.innerHeight-b,re=window.innerHeight+$;return ee/re}function getContainerCursorPosition(H,_,b){var $=H.getBoundingClientRect(),ee=$.top,re=$.left,ae=$.width,xe=$.height,le=(_-re)/ae,fe=(b-ee)/xe;return{x:le,y:fe}}var useInitInteractivity=function H(_){var b=_.wrapperRef,$=_.animationItem,ee=_.mode,re=_.actions;reactExports.useEffect(function(){var ae=b.current;if(!(!ae||!$||!re.length)){$.stop();var xe=function(){var ve=null,Se=function(){var Ce=getContainerVisibility(ae),Ie=re.find(function(Be){var Ne=Be.visibility;return Ne&&Ce>=Ne[0]&&Ce<=Ne[1]});if(Ie){if(Ie.type==="seek"&&Ie.visibility&&Ie.frames.length===2){var De=Ie.frames[0]+Math.ceil((Ce-Ie.visibility[0])/(Ie.visibility[1]-Ie.visibility[0])*Ie.frames[1]);//! goToAndStop must be relative to the start of the current segment
$.goToAndStop(De-$.firstFrame-1,!0)}Ie.type==="loop"&&(ve===null||ve!==Ie.frames||$.isPaused)&&($.playSegments(Ie.frames,!0),ve=Ie.frames),Ie.type==="play"&&$.isPaused&&($.resetSegments(!0),$.play()),Ie.type==="stop"&&$.goToAndStop(Ie.frames[0]-$.firstFrame-1,!0)}};return document.addEventListener("scroll",Se),function(){document.removeEventListener("scroll",Se)}},le=function(){var ve=function(Ie,De){var Be=Ie,Ne=De;if(Be!==-1&&Ne!==-1){var qe=getContainerCursorPosition(ae,Be,Ne);Be=qe.x,Ne=qe.y}var Xe=re.find(function(rt){var ot=rt.position;return ot&&Array.isArray(ot.x)&&Array.isArray(ot.y)?Be>=ot.x[0]&&Be<=ot.x[1]&&Ne>=ot.y[0]&&Ne<=ot.y[1]:ot&&!Number.isNaN(ot.x)&&!Number.isNaN(ot.y)?Be===ot.x&&Ne===ot.y:!1});if(Xe){if(Xe.type==="seek"&&Xe.position&&Array.isArray(Xe.position.x)&&Array.isArray(Xe.position.y)&&Xe.frames.length===2){var Ye=(Be-Xe.position.x[0])/(Xe.position.x[1]-Xe.position.x[0]),Qe=(Ne-Xe.position.y[0])/(Xe.position.y[1]-Xe.position.y[0]);$.playSegments(Xe.frames,!0),$.goToAndStop(Math.ceil((Ye+Qe)/2*(Xe.frames[1]-Xe.frames[0])),!0)}Xe.type==="loop"&&$.playSegments(Xe.frames,!0),Xe.type==="play"&&($.isPaused&&$.resetSegments(!1),$.playSegments(Xe.frames)),Xe.type==="stop"&&$.goToAndStop(Xe.frames[0],!0)}},Se=function(Ie){ve(Ie.clientX,Ie.clientY)},Ee=function(){ve(-1,-1)};return ae.addEventListener("mousemove",Se),ae.addEventListener("mouseout",Ee),function(){ae.removeEventListener("mousemove",Se),ae.removeEventListener("mouseout",Ee)}};switch(ee){case"scroll":return xe();case"cursor":return le()}}},[ee,$])},useLottieInteractivity=function H(_){var b=_.actions,$=_.mode,ee=_.lottieObj,re=ee.animationItem,ae=ee.View,xe=ee.animationContainerRef;return useInitInteractivity({actions:b,animationItem:re,mode:$,wrapperRef:xe}),ae},_excluded=["style","interactivity"],Lottie=function H(_){var b,$,ee,re=_.style,ae=_.interactivity,xe=_objectWithoutProperties(_,_excluded),le=useLottie(xe,re),fe=le.View,ve=le.play,Se=le.stop,Ee=le.pause,Ce=le.setSpeed,Ie=le.goToAndStop,De=le.goToAndPlay,Be=le.setDirection,Ne=le.playSegments,qe=le.setSubframe,Xe=le.getDuration,Ye=le.destroy,Qe=le.animationContainerRef,rt=le.animationLoaded,ot=le.animationItem;return reactExports.useEffect(function(){_.lottieRef&&(_.lottieRef.current={play:ve,stop:Se,pause:Ee,setSpeed:Ce,goToAndPlay:De,goToAndStop:Ie,setDirection:Be,playSegments:Ne,setSubframe:qe,getDuration:Xe,destroy:Ye,animationContainerRef:Qe,animationLoaded:rt,animationItem:ot})},[(b=_.lottieRef)===null||b===void 0?void 0:b.current]),useLottieInteractivity({lottieObj:{View:fe,play:ve,stop:Se,pause:Ee,setSpeed:Ce,goToAndStop:Ie,goToAndPlay:De,setDirection:Be,playSegments:Ne,setSubframe:qe,getDuration:Xe,destroy:Ye,animationContainerRef:Qe,animationLoaded:rt,animationItem:ot},actions:($=ae==null?void 0:ae.actions)!==null&&$!==void 0?$:[],mode:(ee=ae==null?void 0:ae.mode)!==null&&ee!==void 0?ee:"scroll"})};const getDefaultsFromPostinstall=()=>{};var define_process_env_default={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1=function(H){const _=[];let b=0;for(let $=0;$<H.length;$++){let ee=H.charCodeAt($);ee<128?_[b++]=ee:ee<2048?(_[b++]=ee>>6|192,_[b++]=ee&63|128):(ee&64512)===55296&&$+1<H.length&&(H.charCodeAt($+1)&64512)===56320?(ee=65536+((ee&1023)<<10)+(H.charCodeAt(++$)&1023),_[b++]=ee>>18|240,_[b++]=ee>>12&63|128,_[b++]=ee>>6&63|128,_[b++]=ee&63|128):(_[b++]=ee>>12|224,_[b++]=ee>>6&63|128,_[b++]=ee&63|128)}return _},byteArrayToString=function(H){const _=[];let b=0,$=0;for(;b<H.length;){const ee=H[b++];if(ee<128)_[$++]=String.fromCharCode(ee);else if(ee>191&&ee<224){const re=H[b++];_[$++]=String.fromCharCode((ee&31)<<6|re&63)}else if(ee>239&&ee<365){const re=H[b++],ae=H[b++],xe=H[b++],le=((ee&7)<<18|(re&63)<<12|(ae&63)<<6|xe&63)-65536;_[$++]=String.fromCharCode(55296+(le>>10)),_[$++]=String.fromCharCode(56320+(le&1023))}else{const re=H[b++],ae=H[b++];_[$++]=String.fromCharCode((ee&15)<<12|(re&63)<<6|ae&63)}}return _.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(H,_){if(!Array.isArray(H))throw Error("encodeByteArray takes an array as a parameter");this.init_();const b=_?this.byteToCharMapWebSafe_:this.byteToCharMap_,$=[];for(let ee=0;ee<H.length;ee+=3){const re=H[ee],ae=ee+1<H.length,xe=ae?H[ee+1]:0,le=ee+2<H.length,fe=le?H[ee+2]:0,ve=re>>2,Se=(re&3)<<4|xe>>4;let Ee=(xe&15)<<2|fe>>6,Ce=fe&63;le||(Ce=64,ae||(Ee=64)),$.push(b[ve],b[Se],b[Ee],b[Ce])}return $.join("")},encodeString(H,_){return this.HAS_NATIVE_SUPPORT&&!_?btoa(H):this.encodeByteArray(stringToByteArray$1(H),_)},decodeString(H,_){return this.HAS_NATIVE_SUPPORT&&!_?atob(H):byteArrayToString(this.decodeStringToByteArray(H,_))},decodeStringToByteArray(H,_){this.init_();const b=_?this.charToByteMapWebSafe_:this.charToByteMap_,$=[];for(let ee=0;ee<H.length;){const re=b[H.charAt(ee++)],xe=ee<H.length?b[H.charAt(ee)]:0;++ee;const fe=ee<H.length?b[H.charAt(ee)]:64;++ee;const Se=ee<H.length?b[H.charAt(ee)]:64;if(++ee,re==null||xe==null||fe==null||Se==null)throw new DecodeBase64StringError;const Ee=re<<2|xe>>4;if($.push(Ee),fe!==64){const Ce=xe<<4&240|fe>>2;if($.push(Ce),Se!==64){const Ie=fe<<6&192|Se;$.push(Ie)}}}return $},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let H=0;H<this.ENCODED_VALS.length;H++)this.byteToCharMap_[H]=this.ENCODED_VALS.charAt(H),this.charToByteMap_[this.byteToCharMap_[H]]=H,this.byteToCharMapWebSafe_[H]=this.ENCODED_VALS_WEBSAFE.charAt(H),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[H]]=H,H>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(H)]=H,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(H)]=H)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(H){const _=stringToByteArray$1(H);return base64.encodeByteArray(_,!0)},base64urlEncodeWithoutPadding=function(H){return base64Encode(H).replace(/\./g,"")},base64Decode=function(H){try{return base64.decodeString(H,!0)}catch(_){console.error("base64Decode failed: ",_)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(typeof process>"u"||typeof define_process_env_default>"u")return;const H=define_process_env_default.__FIREBASE_DEFAULTS__;if(H)return JSON.parse(H)},getDefaultsFromCookie=()=>{if(typeof document>"u")return;let H;try{H=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const _=H&&base64Decode(H[1]);return _&&JSON.parse(_)},getDefaults=()=>{try{return getDefaultsFromPostinstall()||getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(H){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${H}`);return}},getDefaultEmulatorHost=H=>{var _,b;return(b=(_=getDefaults())===null||_===void 0?void 0:_.emulatorHosts)===null||b===void 0?void 0:b[H]},getDefaultEmulatorHostnameAndPort=H=>{const _=getDefaultEmulatorHost(H);if(!_)return;const b=_.lastIndexOf(":");if(b<=0||b+1===_.length)throw new Error(`Invalid host ${_} with no separate hostname and port!`);const $=parseInt(_.substring(b+1),10);return _[0]==="["?[_.substring(1,b-1),$]:[_.substring(0,b),$]},getDefaultAppConfig=()=>{var H;return(H=getDefaults())===null||H===void 0?void 0:H.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((_,b)=>{this.resolve=_,this.reject=b})}wrapCallback(_){return(b,$)=>{b?this.reject(b):this.resolve($),typeof _=="function"&&(this.promise.catch(()=>{}),_.length===1?_(b):_(b,$))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isCloudWorkstation(H){return H.endsWith(".cloudworkstations.dev")}async function pingServer(H){return(await fetch(H,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(H,_){if(H.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const b={alg:"none",type:"JWT"},$=_||"demo-project",ee=H.iat||0,re=H.sub||H.user_id;if(!re)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const ae=Object.assign({iss:`https://securetoken.google.com/${$}`,aud:$,iat:ee,exp:ee+3600,auth_time:ee,sub:re,user_id:re,firebase:{sign_in_provider:"custom",identities:{}}},H);return[base64urlEncodeWithoutPadding(JSON.stringify(b)),base64urlEncodeWithoutPadding(JSON.stringify(ae)),""].join(".")}const emulatorStatus={};function getEmulatorSummary(){const H={prod:[],emulator:[]};for(const _ of Object.keys(emulatorStatus))emulatorStatus[_]?H.emulator.push(_):H.prod.push(_);return H}function getOrCreateEl(H){let _=document.getElementById(H),b=!1;return _||(_=document.createElement("div"),_.setAttribute("id",H),b=!0),{created:b,element:_}}let previouslyDismissed=!1;function updateEmulatorBanner(H,_){if(typeof window>"u"||typeof document>"u"||!isCloudWorkstation(window.location.host)||emulatorStatus[H]===_||emulatorStatus[H]||previouslyDismissed)return;emulatorStatus[H]=_;function b(Ee){return`__firebase__banner__${Ee}`}const $="__firebase__banner",re=getEmulatorSummary().prod.length>0;function ae(){const Ee=document.getElementById($);Ee&&Ee.remove()}function xe(Ee){Ee.style.display="flex",Ee.style.background="#7faaf0",Ee.style.position="fixed",Ee.style.bottom="5px",Ee.style.left="5px",Ee.style.padding=".5em",Ee.style.borderRadius="5px",Ee.style.alignItems="center"}function le(Ee,Ce){Ee.setAttribute("width","24"),Ee.setAttribute("id",Ce),Ee.setAttribute("height","24"),Ee.setAttribute("viewBox","0 0 24 24"),Ee.setAttribute("fill","none"),Ee.style.marginLeft="-6px"}function fe(){const Ee=document.createElement("span");return Ee.style.cursor="pointer",Ee.style.marginLeft="16px",Ee.style.fontSize="24px",Ee.innerHTML=" &times;",Ee.onclick=()=>{previouslyDismissed=!0,ae()},Ee}function ve(Ee,Ce){Ee.setAttribute("id",Ce),Ee.innerText="Learn more",Ee.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",Ee.setAttribute("target","__blank"),Ee.style.paddingLeft="5px",Ee.style.textDecoration="underline"}function Se(){const Ee=getOrCreateEl($),Ce=b("text"),Ie=document.getElementById(Ce)||document.createElement("span"),De=b("learnmore"),Be=document.getElementById(De)||document.createElement("a"),Ne=b("preprendIcon"),qe=document.getElementById(Ne)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(Ee.created){const Xe=Ee.element;xe(Xe),ve(Be,De);const Ye=fe();le(qe,Ne),Xe.append(qe,Ie,Be,Ye),document.body.appendChild(Xe)}re?(Ie.innerText="Preview backend disconnected.",qe.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(qe.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,Ie.innerText="Preview backend running in this workspace."),Ie.setAttribute("id",Ce)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",Se):Se()}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch{return!1}}function validateIndexedDBOpenable(){return new Promise((H,_)=>{try{let b=!0;const $="validate-browser-context-for-indexeddb-analytics-module",ee=self.indexedDB.open($);ee.onsuccess=()=>{ee.result.close(),b||self.indexedDB.deleteDatabase($),H(!0)},ee.onupgradeneeded=()=>{b=!1},ee.onerror=()=>{var re;_(((re=ee.error)===null||re===void 0?void 0:re.message)||"")}}catch(b){_(b)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(_,b,$){super(b),this.code=_,this.customData=$,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(_,b,$){this.service=_,this.serviceName=b,this.errors=$}create(_,...b){const $=b[0]||{},ee=`${this.service}/${_}`,re=this.errors[_],ae=re?replaceTemplate(re,$):"Error",xe=`${this.serviceName}: ${ae} (${ee}).`;return new FirebaseError(ee,xe,$)}}function replaceTemplate(H,_){return H.replace(PATTERN,(b,$)=>{const ee=_[$];return ee!=null?String(ee):`<${$}?>`})}const PATTERN=/\{\$([^}]+)}/g;function deepEqual(H,_){if(H===_)return!0;const b=Object.keys(H),$=Object.keys(_);for(const ee of b){if(!$.includes(ee))return!1;const re=H[ee],ae=_[ee];if(isObject(re)&&isObject(ae)){if(!deepEqual(re,ae))return!1}else if(re!==ae)return!1}for(const ee of $)if(!b.includes(ee))return!1;return!0}function isObject(H){return H!==null&&typeof H=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(H){return H&&H._delegate?H._delegate:H}class Component{constructor(_,b,$){this.name=_,this.instanceFactory=b,this.type=$,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(_){return this.instantiationMode=_,this}setMultipleInstances(_){return this.multipleInstances=_,this}setServiceProps(_){return this.serviceProps=_,this}setInstanceCreatedCallback(_){return this.onInstanceCreated=_,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME$1="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Provider{constructor(_,b){this.name=_,this.container=b,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(_){const b=this.normalizeInstanceIdentifier(_);if(!this.instancesDeferred.has(b)){const $=new Deferred;if(this.instancesDeferred.set(b,$),this.isInitialized(b)||this.shouldAutoInitialize())try{const ee=this.getOrInitializeService({instanceIdentifier:b});ee&&$.resolve(ee)}catch{}}return this.instancesDeferred.get(b).promise}getImmediate(_){var b;const $=this.normalizeInstanceIdentifier(_==null?void 0:_.identifier),ee=(b=_==null?void 0:_.optional)!==null&&b!==void 0?b:!1;if(this.isInitialized($)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:$})}catch(re){if(ee)return null;throw re}else{if(ee)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(_){if(_.name!==this.name)throw Error(`Mismatching Component ${_.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=_,!!this.shouldAutoInitialize()){if(isComponentEager(_))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch{}for(const[b,$]of this.instancesDeferred.entries()){const ee=this.normalizeInstanceIdentifier(b);try{const re=this.getOrInitializeService({instanceIdentifier:ee});$.resolve(re)}catch{}}}}clearInstance(_=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete(_),this.instancesOptions.delete(_),this.instances.delete(_)}async delete(){const _=Array.from(this.instances.values());await Promise.all([..._.filter(b=>"INTERNAL"in b).map(b=>b.INTERNAL.delete()),..._.filter(b=>"_delete"in b).map(b=>b._delete())])}isComponentSet(){return this.component!=null}isInitialized(_=DEFAULT_ENTRY_NAME$1){return this.instances.has(_)}getOptions(_=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get(_)||{}}initialize(_={}){const{options:b={}}=_,$=this.normalizeInstanceIdentifier(_.instanceIdentifier);if(this.isInitialized($))throw Error(`${this.name}(${$}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const ee=this.getOrInitializeService({instanceIdentifier:$,options:b});for(const[re,ae]of this.instancesDeferred.entries()){const xe=this.normalizeInstanceIdentifier(re);$===xe&&ae.resolve(ee)}return ee}onInit(_,b){var $;const ee=this.normalizeInstanceIdentifier(b),re=($=this.onInitCallbacks.get(ee))!==null&&$!==void 0?$:new Set;re.add(_),this.onInitCallbacks.set(ee,re);const ae=this.instances.get(ee);return ae&&_(ae,ee),()=>{re.delete(_)}}invokeOnInitCallbacks(_,b){const $=this.onInitCallbacks.get(b);if($)for(const ee of $)try{ee(_,b)}catch{}}getOrInitializeService({instanceIdentifier:_,options:b={}}){let $=this.instances.get(_);if(!$&&this.component&&($=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(_),options:b}),this.instances.set(_,$),this.instancesOptions.set(_,b),this.invokeOnInitCallbacks($,_),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,_,$)}catch{}return $||null}normalizeInstanceIdentifier(_=DEFAULT_ENTRY_NAME$1){return this.component?this.component.multipleInstances?_:DEFAULT_ENTRY_NAME$1:_}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function normalizeIdentifierForFactory(H){return H===DEFAULT_ENTRY_NAME$1?void 0:H}function isComponentEager(H){return H.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ComponentContainer{constructor(_){this.name=_,this.providers=new Map}addComponent(_){const b=this.getProvider(_.name);if(b.isComponentSet())throw new Error(`Component ${_.name} has already been registered with ${this.name}`);b.setComponent(_)}addOrOverwriteComponent(_){this.getProvider(_.name).isComponentSet()&&this.providers.delete(_.name),this.addComponent(_)}getProvider(_){if(this.providers.has(_))return this.providers.get(_);const b=new Provider(_,this);return this.providers.set(_,b),b}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LogLevel;(function(H){H[H.DEBUG=0]="DEBUG",H[H.VERBOSE=1]="VERBOSE",H[H.INFO=2]="INFO",H[H.WARN=3]="WARN",H[H.ERROR=4]="ERROR",H[H.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(H,_,...b)=>{if(_<H.logLevel)return;const $=new Date().toISOString(),ee=ConsoleMethod[_];if(ee)console[ee](`[${$}]  ${H.name}:`,...b);else throw new Error(`Attempted to log a message with an invalid logType (value: ${_})`)};class Logger{constructor(_){this.name=_,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(_){if(!(_ in LogLevel))throw new TypeError(`Invalid value "${_}" assigned to \`logLevel\``);this._logLevel=_}setLogLevel(_){this._logLevel=typeof _=="string"?levelStringToEnum[_]:_}get logHandler(){return this._logHandler}set logHandler(_){if(typeof _!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=_}get userLogHandler(){return this._userLogHandler}set userLogHandler(_){this._userLogHandler=_}debug(..._){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,..._),this._logHandler(this,LogLevel.DEBUG,..._)}log(..._){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,..._),this._logHandler(this,LogLevel.VERBOSE,..._)}info(..._){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,..._),this._logHandler(this,LogLevel.INFO,..._)}warn(..._){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,..._),this._logHandler(this,LogLevel.WARN,..._)}error(..._){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,..._),this._logHandler(this,LogLevel.ERROR,..._)}}const instanceOfAny=(H,_)=>_.some(b=>H instanceof b);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(H){const _=new Promise((b,$)=>{const ee=()=>{H.removeEventListener("success",re),H.removeEventListener("error",ae)},re=()=>{b(wrap(H.result)),ee()},ae=()=>{$(H.error),ee()};H.addEventListener("success",re),H.addEventListener("error",ae)});return _.then(b=>{b instanceof IDBCursor&&cursorRequestMap.set(b,H)}).catch(()=>{}),reverseTransformCache.set(_,H),_}function cacheDonePromiseForTransaction(H){if(transactionDoneMap.has(H))return;const _=new Promise((b,$)=>{const ee=()=>{H.removeEventListener("complete",re),H.removeEventListener("error",ae),H.removeEventListener("abort",ae)},re=()=>{b(),ee()},ae=()=>{$(H.error||new DOMException("AbortError","AbortError")),ee()};H.addEventListener("complete",re),H.addEventListener("error",ae),H.addEventListener("abort",ae)});transactionDoneMap.set(H,_)}let idbProxyTraps={get(H,_,b){if(H instanceof IDBTransaction){if(_==="done")return transactionDoneMap.get(H);if(_==="objectStoreNames")return H.objectStoreNames||transactionStoreNamesMap.get(H);if(_==="store")return b.objectStoreNames[1]?void 0:b.objectStore(b.objectStoreNames[0])}return wrap(H[_])},set(H,_,b){return H[_]=b,!0},has(H,_){return H instanceof IDBTransaction&&(_==="done"||_==="store")?!0:_ in H}};function replaceTraps(H){idbProxyTraps=H(idbProxyTraps)}function wrapFunction(H){return H===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(_,...b){const $=H.call(unwrap(this),_,...b);return transactionStoreNamesMap.set($,_.sort?_.sort():[_]),wrap($)}:getCursorAdvanceMethods().includes(H)?function(..._){return H.apply(unwrap(this),_),wrap(cursorRequestMap.get(this))}:function(..._){return wrap(H.apply(unwrap(this),_))}}function transformCachableValue(H){return typeof H=="function"?wrapFunction(H):(H instanceof IDBTransaction&&cacheDonePromiseForTransaction(H),instanceOfAny(H,getIdbProxyableTypes())?new Proxy(H,idbProxyTraps):H)}function wrap(H){if(H instanceof IDBRequest)return promisifyRequest(H);if(transformCache.has(H))return transformCache.get(H);const _=transformCachableValue(H);return _!==H&&(transformCache.set(H,_),reverseTransformCache.set(_,H)),_}const unwrap=H=>reverseTransformCache.get(H);function openDB(H,_,{blocked:b,upgrade:$,blocking:ee,terminated:re}={}){const ae=indexedDB.open(H,_),xe=wrap(ae);return $&&ae.addEventListener("upgradeneeded",le=>{$(wrap(ae.result),le.oldVersion,le.newVersion,wrap(ae.transaction),le)}),b&&ae.addEventListener("blocked",le=>b(le.oldVersion,le.newVersion,le)),xe.then(le=>{re&&le.addEventListener("close",()=>re()),ee&&le.addEventListener("versionchange",fe=>ee(fe.oldVersion,fe.newVersion,fe))}).catch(()=>{}),xe}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(H,_){if(!(H instanceof IDBDatabase&&!(_ in H)&&typeof _=="string"))return;if(cachedMethods.get(_))return cachedMethods.get(_);const b=_.replace(/FromIndex$/,""),$=_!==b,ee=writeMethods.includes(b);if(!(b in($?IDBIndex:IDBObjectStore).prototype)||!(ee||readMethods.includes(b)))return;const re=async function(ae,...xe){const le=this.transaction(ae,ee?"readwrite":"readonly");let fe=le.store;return $&&(fe=fe.index(xe.shift())),(await Promise.all([fe[b](...xe),ee&&le.done]))[0]};return cachedMethods.set(_,re),re}replaceTraps(H=>({...H,get:(_,b,$)=>getMethod(_,b)||H.get(_,b,$),has:(_,b)=>!!getMethod(_,b)||H.has(_,b)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(_){this.container=_}getPlatformInfoString(){return this.container.getProviders().map(b=>{if(isVersionServiceProvider(b)){const $=b.getImmediate();return`${$.library}/${$.version}`}else return null}).filter(b=>b).join(" ")}}function isVersionServiceProvider(H){const _=H.getComponent();return(_==null?void 0:_.type)==="VERSION"}const name$q="@firebase/app",version$1$1="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger=new Logger("@firebase/app"),name$p="@firebase/app-compat",name$o="@firebase/analytics-compat",name$n="@firebase/analytics",name$m="@firebase/app-check-compat",name$l="@firebase/app-check",name$k="@firebase/auth",name$j="@firebase/auth-compat",name$i="@firebase/database",name$h="@firebase/data-connect",name$g="@firebase/database-compat",name$f="@firebase/functions",name$e="@firebase/functions-compat",name$d="@firebase/installations",name$c="@firebase/installations-compat",name$b="@firebase/messaging",name$a="@firebase/messaging-compat",name$9="@firebase/performance",name$8="@firebase/performance-compat",name$7="@firebase/remote-config",name$6="@firebase/remote-config-compat",name$5="@firebase/storage",name$4="@firebase/storage-compat",name$3="@firebase/firestore",name$2="@firebase/ai",name$1$1="@firebase/firestore-compat",name$r="firebase",version$2="11.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$q]:"fire-core",[name$p]:"fire-core-compat",[name$n]:"fire-analytics",[name$o]:"fire-analytics-compat",[name$l]:"fire-app-check",[name$m]:"fire-app-check-compat",[name$k]:"fire-auth",[name$j]:"fire-auth-compat",[name$i]:"fire-rtdb",[name$h]:"fire-data-connect",[name$g]:"fire-rtdb-compat",[name$f]:"fire-fn",[name$e]:"fire-fn-compat",[name$d]:"fire-iid",[name$c]:"fire-iid-compat",[name$b]:"fire-fcm",[name$a]:"fire-fcm-compat",[name$9]:"fire-perf",[name$8]:"fire-perf-compat",[name$7]:"fire-rc",[name$6]:"fire-rc-compat",[name$5]:"fire-gcs",[name$4]:"fire-gcs-compat",[name$3]:"fire-fst",[name$1$1]:"fire-fst-compat",[name$2]:"fire-vertex","fire-js":"fire-js",[name$r]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_serverApps=new Map,_components=new Map;function _addComponent(H,_){try{H.container.addComponent(_)}catch(b){logger.debug(`Component ${_.name} failed to register with FirebaseApp ${H.name}`,b)}}function _registerComponent(H){const _=H.name;if(_components.has(_))return logger.debug(`There were multiple attempts to register component ${_}.`),!1;_components.set(_,H);for(const b of _apps.values())_addComponent(b,H);for(const b of _serverApps.values())_addComponent(b,H);return!0}function _getProvider(H,_){const b=H.container.getProvider("heartbeat").getImmediate({optional:!0});return b&&b.triggerHeartbeat(),H.container.getProvider(_)}function _isFirebaseServerApp(H){return H==null?!1:H.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ERROR_FACTORY=new ErrorFactory("app","Firebase",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAppImpl{constructor(_,b,$){this._isDeleted=!1,this._options=Object.assign({},_),this._config=Object.assign({},b),this._name=b.name,this._automaticDataCollectionEnabled=b.automaticDataCollectionEnabled,this._container=$,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(_){this.checkDestroyed(),this._automaticDataCollectionEnabled=_}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(_){this._isDeleted=_}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION=version$2;function initializeApp(H,_={}){let b=H;typeof _!="object"&&(_={name:_});const $=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!0},_),ee=$.name;if(typeof ee!="string"||!ee)throw ERROR_FACTORY.create("bad-app-name",{appName:String(ee)});if(b||(b=getDefaultAppConfig()),!b)throw ERROR_FACTORY.create("no-options");const re=_apps.get(ee);if(re){if(deepEqual(b,re.options)&&deepEqual($,re.config))return re;throw ERROR_FACTORY.create("duplicate-app",{appName:ee})}const ae=new ComponentContainer(ee);for(const le of _components.values())ae.addComponent(le);const xe=new FirebaseAppImpl(b,$,ae);return _apps.set(ee,xe),xe}function getApp(H=DEFAULT_ENTRY_NAME){const _=_apps.get(H);if(!_&&H===DEFAULT_ENTRY_NAME&&getDefaultAppConfig())return initializeApp();if(!_)throw ERROR_FACTORY.create("no-app",{appName:H});return _}function registerVersion(H,_,b){var $;let ee=($=PLATFORM_LOG_STRING[H])!==null&&$!==void 0?$:H;b&&(ee+=`-${b}`);const re=ee.match(/\s|\//),ae=_.match(/\s|\//);if(re||ae){const xe=[`Unable to register library "${ee}" with version "${_}":`];re&&xe.push(`library name "${ee}" contains illegal characters (whitespace or "/")`),re&&ae&&xe.push("and"),ae&&xe.push(`version name "${_}" contains illegal characters (whitespace or "/")`),logger.warn(xe.join(" "));return}_registerComponent(new Component(`${ee}-version`,()=>({library:ee,version:_}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebase-heartbeat-database",DB_VERSION=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DB_NAME,DB_VERSION,{upgrade:(H,_)=>{switch(_){case 0:try{H.createObjectStore(STORE_NAME)}catch(b){console.warn(b)}}}}).catch(H=>{throw ERROR_FACTORY.create("idb-open",{originalErrorMessage:H.message})})),dbPromise}async function readHeartbeatsFromIndexedDB(H){try{const b=(await getDbPromise()).transaction(STORE_NAME),$=await b.objectStore(STORE_NAME).get(computeKey(H));return await b.done,$}catch(_){if(_ instanceof FirebaseError)logger.warn(_.message);else{const b=ERROR_FACTORY.create("idb-get",{originalErrorMessage:_==null?void 0:_.message});logger.warn(b.message)}}}async function writeHeartbeatsToIndexedDB(H,_){try{const $=(await getDbPromise()).transaction(STORE_NAME,"readwrite");await $.objectStore(STORE_NAME).put(_,computeKey(H)),await $.done}catch(b){if(b instanceof FirebaseError)logger.warn(b.message);else{const $=ERROR_FACTORY.create("idb-set",{originalErrorMessage:b==null?void 0:b.message});logger.warn($.message)}}}function computeKey(H){return`${H.name}!${H.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,MAX_NUM_STORED_HEARTBEATS=30;class HeartbeatServiceImpl{constructor(_){this.container=_,this._heartbeatsCache=null;const b=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(b),this._heartbeatsCachePromise=this._storage.read().then($=>(this._heartbeatsCache=$,$))}async triggerHeartbeat(){var _,b;try{const ee=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),re=getUTCDateString();if(((_=this._heartbeatsCache)===null||_===void 0?void 0:_.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((b=this._heartbeatsCache)===null||b===void 0?void 0:b.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===re||this._heartbeatsCache.heartbeats.some(ae=>ae.date===re))return;if(this._heartbeatsCache.heartbeats.push({date:re,agent:ee}),this._heartbeatsCache.heartbeats.length>MAX_NUM_STORED_HEARTBEATS){const ae=getEarliestHeartbeatIdx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(ae,1)}return this._storage.overwrite(this._heartbeatsCache)}catch($){logger.warn($)}}async getHeartbeatsHeader(){var _;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((_=this._heartbeatsCache)===null||_===void 0?void 0:_.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const b=getUTCDateString(),{heartbeatsToSend:$,unsentEntries:ee}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),re=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:$}));return this._heartbeatsCache.lastSentHeartbeatDate=b,ee.length>0?(this._heartbeatsCache.heartbeats=ee,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),re}catch(b){return logger.warn(b),""}}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(H,_=MAX_HEADER_BYTES){const b=[];let $=H.slice();for(const ee of H){const re=b.find(ae=>ae.agent===ee.agent);if(re){if(re.dates.push(ee.date),countBytes(b)>_){re.dates.pop();break}}else if(b.push({agent:ee.agent,dates:[ee.date]}),countBytes(b)>_){b.pop();break}$=$.slice(1)}return{heartbeatsToSend:b,unsentEntries:$}}class HeartbeatStorageImpl{constructor(_){this.app=_,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const b=await readHeartbeatsFromIndexedDB(this.app);return b!=null&&b.heartbeats?b:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(_){var b;if(await this._canUseIndexedDBPromise){const ee=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(b=_.lastSentHeartbeatDate)!==null&&b!==void 0?b:ee.lastSentHeartbeatDate,heartbeats:_.heartbeats})}else return}async add(_){var b;if(await this._canUseIndexedDBPromise){const ee=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(b=_.lastSentHeartbeatDate)!==null&&b!==void 0?b:ee.lastSentHeartbeatDate,heartbeats:[...ee.heartbeats,..._.heartbeats]})}else return}}function countBytes(H){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:H})).length}function getEarliestHeartbeatIdx(H){if(H.length===0)return-1;let _=0,b=H[0].date;for(let $=1;$<H.length;$++)H[$].date<b&&(b=H[$].date,_=$);return _}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(H){_registerComponent(new Component("platform-logger",_=>new PlatformLoggerServiceImpl(_),"PRIVATE")),_registerComponent(new Component("heartbeat",_=>new HeartbeatServiceImpl(_),"PRIVATE")),registerVersion(name$q,version$1$1,H),registerVersion(name$q,version$1$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");var name$1="firebase",version$1="11.8.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */registerVersion(name$1,version$1,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_HOST="firebasestorage.googleapis.com",CONFIG_STORAGE_BUCKET_KEY="storageBucket",DEFAULT_MAX_OPERATION_RETRY_TIME=2*60*1e3,DEFAULT_MAX_UPLOAD_RETRY_TIME=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StorageError extends FirebaseError{constructor(_,b,$=0){super(prependCode(_),`Firebase Storage: ${b} (${prependCode(_)})`),this.status_=$,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,StorageError.prototype)}get status(){return this.status_}set status(_){this.status_=_}_codeEquals(_){return prependCode(_)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(_){this.customData.serverResponse=_,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var StorageErrorCode;(function(H){H.UNKNOWN="unknown",H.OBJECT_NOT_FOUND="object-not-found",H.BUCKET_NOT_FOUND="bucket-not-found",H.PROJECT_NOT_FOUND="project-not-found",H.QUOTA_EXCEEDED="quota-exceeded",H.UNAUTHENTICATED="unauthenticated",H.UNAUTHORIZED="unauthorized",H.UNAUTHORIZED_APP="unauthorized-app",H.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",H.INVALID_CHECKSUM="invalid-checksum",H.CANCELED="canceled",H.INVALID_EVENT_NAME="invalid-event-name",H.INVALID_URL="invalid-url",H.INVALID_DEFAULT_BUCKET="invalid-default-bucket",H.NO_DEFAULT_BUCKET="no-default-bucket",H.CANNOT_SLICE_BLOB="cannot-slice-blob",H.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",H.NO_DOWNLOAD_URL="no-download-url",H.INVALID_ARGUMENT="invalid-argument",H.INVALID_ARGUMENT_COUNT="invalid-argument-count",H.APP_DELETED="app-deleted",H.INVALID_ROOT_OPERATION="invalid-root-operation",H.INVALID_FORMAT="invalid-format",H.INTERNAL_ERROR="internal-error",H.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(StorageErrorCode||(StorageErrorCode={}));function prependCode(H){return"storage/"+H}function unknown(){const H="An unknown error occurred, please check the error payload for server response.";return new StorageError(StorageErrorCode.UNKNOWN,H)}function objectNotFound(H){return new StorageError(StorageErrorCode.OBJECT_NOT_FOUND,"Object '"+H+"' does not exist.")}function quotaExceeded(H){return new StorageError(StorageErrorCode.QUOTA_EXCEEDED,"Quota for bucket '"+H+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function unauthenticated(){const H="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new StorageError(StorageErrorCode.UNAUTHENTICATED,H)}function unauthorizedApp(){return new StorageError(StorageErrorCode.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function unauthorized(H){return new StorageError(StorageErrorCode.UNAUTHORIZED,"User does not have permission to access '"+H+"'.")}function retryLimitExceeded(){return new StorageError(StorageErrorCode.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function canceled(){return new StorageError(StorageErrorCode.CANCELED,"User canceled the upload/download.")}function invalidUrl(H){return new StorageError(StorageErrorCode.INVALID_URL,"Invalid URL '"+H+"'.")}function invalidDefaultBucket(H){return new StorageError(StorageErrorCode.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+H+"'.")}function noDefaultBucket(){return new StorageError(StorageErrorCode.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+CONFIG_STORAGE_BUCKET_KEY+"' property when initializing the app?")}function cannotSliceBlob(){return new StorageError(StorageErrorCode.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function noDownloadURL(){return new StorageError(StorageErrorCode.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function missingPolyFill(H){return new StorageError(StorageErrorCode.UNSUPPORTED_ENVIRONMENT,`${H} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function invalidArgument(H){return new StorageError(StorageErrorCode.INVALID_ARGUMENT,H)}function appDeleted(){return new StorageError(StorageErrorCode.APP_DELETED,"The Firebase app was deleted.")}function invalidRootOperation(H){return new StorageError(StorageErrorCode.INVALID_ROOT_OPERATION,"The operation '"+H+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function invalidFormat(H,_){return new StorageError(StorageErrorCode.INVALID_FORMAT,"String does not match format '"+H+"': "+_)}function internalError(H){throw new StorageError(StorageErrorCode.INTERNAL_ERROR,"Internal error: "+H)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Location{constructor(_,b){this.bucket=_,this.path_=b}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const _=encodeURIComponent;return"/b/"+_(this.bucket)+"/o/"+_(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(_,b){let $;try{$=Location.makeFromUrl(_,b)}catch{return new Location(_,"")}if($.path==="")return $;throw invalidDefaultBucket(_)}static makeFromUrl(_,b){let $=null;const ee="([A-Za-z0-9.\\-_]+)";function re(Ye){Ye.path.charAt(Ye.path.length-1)==="/"&&(Ye.path_=Ye.path_.slice(0,-1))}const ae="(/(.*))?$",xe=new RegExp("^gs://"+ee+ae,"i"),le={bucket:1,path:3};function fe(Ye){Ye.path_=decodeURIComponent(Ye.path)}const ve="v[A-Za-z0-9_]+",Se=b.replace(/[.]/g,"\\."),Ee="(/([^?#]*).*)?$",Ce=new RegExp(`^https?://${Se}/${ve}/b/${ee}/o${Ee}`,"i"),Ie={bucket:1,path:3},De=b===DEFAULT_HOST?"(?:storage.googleapis.com|storage.cloud.google.com)":b,Be="([^?#]*)",Ne=new RegExp(`^https?://${De}/${ee}/${Be}`,"i"),Xe=[{regex:xe,indices:le,postModify:re},{regex:Ce,indices:Ie,postModify:fe},{regex:Ne,indices:{bucket:1,path:2},postModify:fe}];for(let Ye=0;Ye<Xe.length;Ye++){const Qe=Xe[Ye],rt=Qe.regex.exec(_);if(rt){const ot=rt[Qe.indices.bucket];let ct=rt[Qe.indices.path];ct||(ct=""),$=new Location(ot,ct),Qe.postModify($);break}}if($==null)throw invalidUrl(_);return $}}class FailRequest{constructor(_){this.promise_=Promise.reject(_)}getPromise(){return this.promise_}cancel(_=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function start(H,_,b){let $=1,ee=null,re=null,ae=!1,xe=0;function le(){return xe===2}let fe=!1;function ve(...Be){fe||(fe=!0,_.apply(null,Be))}function Se(Be){ee=setTimeout(()=>{ee=null,H(Ce,le())},Be)}function Ee(){re&&clearTimeout(re)}function Ce(Be,...Ne){if(fe){Ee();return}if(Be){Ee(),ve.call(null,Be,...Ne);return}if(le()||ae){Ee(),ve.call(null,Be,...Ne);return}$<64&&($*=2);let Xe;xe===1?(xe=2,Xe=0):Xe=($+Math.random())*1e3,Se(Xe)}let Ie=!1;function De(Be){Ie||(Ie=!0,Ee(),!fe&&(ee!==null?(Be||(xe=2),clearTimeout(ee),Se(0)):Be||(xe=1)))}return Se(0),re=setTimeout(()=>{ae=!0,De(!0)},b),De}function stop(H){H(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isJustDef(H){return H!==void 0}function isNonArrayObject(H){return typeof H=="object"&&!Array.isArray(H)}function isString(H){return typeof H=="string"||H instanceof String}function isNativeBlob(H){return isNativeBlobDefined()&&H instanceof Blob}function isNativeBlobDefined(){return typeof Blob<"u"}function validateNumber(H,_,b,$){if($<_)throw invalidArgument(`Invalid value for '${H}'. Expected ${_} or greater.`);if($>b)throw invalidArgument(`Invalid value for '${H}'. Expected ${b} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function makeUrl(H,_,b){let $=_;return b==null&&($=`https://${_}`),`${b}://${$}/v0${H}`}function makeQueryString(H){const _=encodeURIComponent;let b="?";for(const $ in H)if(H.hasOwnProperty($)){const ee=_($)+"="+_(H[$]);b=b+ee+"&"}return b=b.slice(0,-1),b}var ErrorCode;(function(H){H[H.NO_ERROR=0]="NO_ERROR",H[H.NETWORK_ERROR=1]="NETWORK_ERROR",H[H.ABORT=2]="ABORT"})(ErrorCode||(ErrorCode={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isRetryStatusCode(H,_){const b=H>=500&&H<600,ee=[408,429].indexOf(H)!==-1,re=_.indexOf(H)!==-1;return b||ee||re}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NetworkRequest{constructor(_,b,$,ee,re,ae,xe,le,fe,ve,Se,Ee=!0,Ce=!1){this.url_=_,this.method_=b,this.headers_=$,this.body_=ee,this.successCodes_=re,this.additionalRetryCodes_=ae,this.callback_=xe,this.errorCallback_=le,this.timeout_=fe,this.progressCallback_=ve,this.connectionFactory_=Se,this.retry=Ee,this.isUsingEmulator=Ce,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((Ie,De)=>{this.resolve_=Ie,this.reject_=De,this.start_()})}start_(){const _=($,ee)=>{if(ee){$(!1,new RequestEndStatus(!1,null,!0));return}const re=this.connectionFactory_();this.pendingConnection_=re;const ae=xe=>{const le=xe.loaded,fe=xe.lengthComputable?xe.total:-1;this.progressCallback_!==null&&this.progressCallback_(le,fe)};this.progressCallback_!==null&&re.addUploadProgressListener(ae),re.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&re.removeUploadProgressListener(ae),this.pendingConnection_=null;const xe=re.getErrorCode()===ErrorCode.NO_ERROR,le=re.getStatus();if(!xe||isRetryStatusCode(le,this.additionalRetryCodes_)&&this.retry){const ve=re.getErrorCode()===ErrorCode.ABORT;$(!1,new RequestEndStatus(!1,null,ve));return}const fe=this.successCodes_.indexOf(le)!==-1;$(!0,new RequestEndStatus(fe,re))})},b=($,ee)=>{const re=this.resolve_,ae=this.reject_,xe=ee.connection;if(ee.wasSuccessCode)try{const le=this.callback_(xe,xe.getResponse());isJustDef(le)?re(le):re()}catch(le){ae(le)}else if(xe!==null){const le=unknown();le.serverResponse=xe.getErrorText(),this.errorCallback_?ae(this.errorCallback_(xe,le)):ae(le)}else if(ee.canceled){const le=this.appDelete_?appDeleted():canceled();ae(le)}else{const le=retryLimitExceeded();ae(le)}};this.canceled_?b(!1,new RequestEndStatus(!1,null,!0)):this.backoffId_=start(_,b,this.timeout_)}getPromise(){return this.promise_}cancel(_){this.canceled_=!0,this.appDelete_=_||!1,this.backoffId_!==null&&stop(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class RequestEndStatus{constructor(_,b,$){this.wasSuccessCode=_,this.connection=b,this.canceled=!!$}}function addAuthHeader_(H,_){_!==null&&_.length>0&&(H.Authorization="Firebase "+_)}function addVersionHeader_(H,_){H["X-Firebase-Storage-Version"]="webjs/"+(_??"AppManager")}function addGmpidHeader_(H,_){_&&(H["X-Firebase-GMPID"]=_)}function addAppCheckHeader_(H,_){_!==null&&(H["X-Firebase-AppCheck"]=_)}function makeRequest(H,_,b,$,ee,re,ae=!0,xe=!1){const le=makeQueryString(H.urlParams),fe=H.url+le,ve=Object.assign({},H.headers);return addGmpidHeader_(ve,_),addAuthHeader_(ve,b),addVersionHeader_(ve,re),addAppCheckHeader_(ve,$),new NetworkRequest(fe,H.method,ve,H.body,H.successCodes,H.additionalRetryCodes,H.handler,H.errorHandler,H.timeout,H.progressCallback,ee,ae,xe)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getBlobBuilder(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function getBlob$1(...H){const _=getBlobBuilder();if(_!==void 0){const b=new _;for(let $=0;$<H.length;$++)b.append(H[$]);return b.getBlob()}else{if(isNativeBlobDefined())return new Blob(H);throw new StorageError(StorageErrorCode.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function sliceBlob(H,_,b){return H.webkitSlice?H.webkitSlice(_,b):H.mozSlice?H.mozSlice(_,b):H.slice?H.slice(_,b):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function decodeBase64(H){if(typeof atob>"u")throw missingPolyFill("base-64");return atob(H)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const StringFormat={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class StringData{constructor(_,b){this.data=_,this.contentType=b||null}}function dataFromString(H,_){switch(H){case StringFormat.RAW:return new StringData(utf8Bytes_(_));case StringFormat.BASE64:case StringFormat.BASE64URL:return new StringData(base64Bytes_(H,_));case StringFormat.DATA_URL:return new StringData(dataURLBytes_(_),dataURLContentType_(_))}throw unknown()}function utf8Bytes_(H){const _=[];for(let b=0;b<H.length;b++){let $=H.charCodeAt(b);if($<=127)_.push($);else if($<=2047)_.push(192|$>>6,128|$&63);else if(($&64512)===55296)if(!(b<H.length-1&&(H.charCodeAt(b+1)&64512)===56320))_.push(239,191,189);else{const re=$,ae=H.charCodeAt(++b);$=65536|(re&1023)<<10|ae&1023,_.push(240|$>>18,128|$>>12&63,128|$>>6&63,128|$&63)}else($&64512)===56320?_.push(239,191,189):_.push(224|$>>12,128|$>>6&63,128|$&63)}return new Uint8Array(_)}function percentEncodedBytes_(H){let _;try{_=decodeURIComponent(H)}catch{throw invalidFormat(StringFormat.DATA_URL,"Malformed data URL.")}return utf8Bytes_(_)}function base64Bytes_(H,_){switch(H){case StringFormat.BASE64:{const ee=_.indexOf("-")!==-1,re=_.indexOf("_")!==-1;if(ee||re)throw invalidFormat(H,"Invalid character '"+(ee?"-":"_")+"' found: is it base64url encoded?");break}case StringFormat.BASE64URL:{const ee=_.indexOf("+")!==-1,re=_.indexOf("/")!==-1;if(ee||re)throw invalidFormat(H,"Invalid character '"+(ee?"+":"/")+"' found: is it base64 encoded?");_=_.replace(/-/g,"+").replace(/_/g,"/");break}}let b;try{b=decodeBase64(_)}catch(ee){throw ee.message.includes("polyfill")?ee:invalidFormat(H,"Invalid character found")}const $=new Uint8Array(b.length);for(let ee=0;ee<b.length;ee++)$[ee]=b.charCodeAt(ee);return $}class DataURLParts{constructor(_){this.base64=!1,this.contentType=null;const b=_.match(/^data:([^,]+)?,/);if(b===null)throw invalidFormat(StringFormat.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const $=b[1]||null;$!=null&&(this.base64=endsWith($,";base64"),this.contentType=this.base64?$.substring(0,$.length-7):$),this.rest=_.substring(_.indexOf(",")+1)}}function dataURLBytes_(H){const _=new DataURLParts(H);return _.base64?base64Bytes_(StringFormat.BASE64,_.rest):percentEncodedBytes_(_.rest)}function dataURLContentType_(H){return new DataURLParts(H).contentType}function endsWith(H,_){return H.length>=_.length?H.substring(H.length-_.length)===_:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FbsBlob{constructor(_,b){let $=0,ee="";isNativeBlob(_)?(this.data_=_,$=_.size,ee=_.type):_ instanceof ArrayBuffer?(b?this.data_=new Uint8Array(_):(this.data_=new Uint8Array(_.byteLength),this.data_.set(new Uint8Array(_))),$=this.data_.length):_ instanceof Uint8Array&&(b?this.data_=_:(this.data_=new Uint8Array(_.length),this.data_.set(_)),$=_.length),this.size_=$,this.type_=ee}size(){return this.size_}type(){return this.type_}slice(_,b){if(isNativeBlob(this.data_)){const $=this.data_,ee=sliceBlob($,_,b);return ee===null?null:new FbsBlob(ee)}else{const $=new Uint8Array(this.data_.buffer,_,b-_);return new FbsBlob($,!0)}}static getBlob(..._){if(isNativeBlobDefined()){const b=_.map($=>$ instanceof FbsBlob?$.data_:$);return new FbsBlob(getBlob$1.apply(null,b))}else{const b=_.map(ae=>isString(ae)?dataFromString(StringFormat.RAW,ae).data:ae.data_);let $=0;b.forEach(ae=>{$+=ae.byteLength});const ee=new Uint8Array($);let re=0;return b.forEach(ae=>{for(let xe=0;xe<ae.length;xe++)ee[re++]=ae[xe]}),new FbsBlob(ee,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jsonObjectOrNull(H){let _;try{_=JSON.parse(H)}catch{return null}return isNonArrayObject(_)?_:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function parent(H){if(H.length===0)return null;const _=H.lastIndexOf("/");return _===-1?"":H.slice(0,_)}function child(H,_){const b=_.split("/").filter($=>$.length>0).join("/");return H.length===0?b:H+"/"+b}function lastComponent(H){const _=H.lastIndexOf("/",H.length-2);return _===-1?H:H.slice(_+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function noXform_(H,_){return _}class Mapping{constructor(_,b,$,ee){this.server=_,this.local=b||_,this.writable=!!$,this.xform=ee||noXform_}}let mappings_=null;function xformPath(H){return!isString(H)||H.length<2?H:lastComponent(H)}function getMappings(){if(mappings_)return mappings_;const H=[];H.push(new Mapping("bucket")),H.push(new Mapping("generation")),H.push(new Mapping("metageneration")),H.push(new Mapping("name","fullPath",!0));function _(re,ae){return xformPath(ae)}const b=new Mapping("name");b.xform=_,H.push(b);function $(re,ae){return ae!==void 0?Number(ae):ae}const ee=new Mapping("size");return ee.xform=$,H.push(ee),H.push(new Mapping("timeCreated")),H.push(new Mapping("updated")),H.push(new Mapping("md5Hash",null,!0)),H.push(new Mapping("cacheControl",null,!0)),H.push(new Mapping("contentDisposition",null,!0)),H.push(new Mapping("contentEncoding",null,!0)),H.push(new Mapping("contentLanguage",null,!0)),H.push(new Mapping("contentType",null,!0)),H.push(new Mapping("metadata","customMetadata",!0)),mappings_=H,mappings_}function addRef(H,_){function b(){const $=H.bucket,ee=H.fullPath,re=new Location($,ee);return _._makeStorageReference(re)}Object.defineProperty(H,"ref",{get:b})}function fromResource(H,_,b){const $={};$.type="file";const ee=b.length;for(let re=0;re<ee;re++){const ae=b[re];$[ae.local]=ae.xform($,_[ae.server])}return addRef($,H),$}function fromResourceString(H,_,b){const $=jsonObjectOrNull(_);return $===null?null:fromResource(H,$,b)}function downloadUrlFromResourceString(H,_,b,$){const ee=jsonObjectOrNull(_);if(ee===null||!isString(ee.downloadTokens))return null;const re=ee.downloadTokens;if(re.length===0)return null;const ae=encodeURIComponent;return re.split(",").map(fe=>{const ve=H.bucket,Se=H.fullPath,Ee="/b/"+ae(ve)+"/o/"+ae(Se),Ce=makeUrl(Ee,b,$),Ie=makeQueryString({alt:"media",token:fe});return Ce+Ie})[0]}function toResourceString(H,_){const b={},$=_.length;for(let ee=0;ee<$;ee++){const re=_[ee];re.writable&&(b[re.server]=H[re.local])}return JSON.stringify(b)}class RequestInfo{constructor(_,b,$,ee){this.url=_,this.method=b,this.handler=$,this.timeout=ee,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function handlerCheck(H){if(!H)throw unknown()}function metadataHandler(H,_){function b($,ee){const re=fromResourceString(H,ee,_);return handlerCheck(re!==null),re}return b}function downloadUrlHandler(H,_){function b($,ee){const re=fromResourceString(H,ee,_);return handlerCheck(re!==null),downloadUrlFromResourceString(re,ee,H.host,H._protocol)}return b}function sharedErrorHandler(H){function _(b,$){let ee;return b.getStatus()===401?b.getErrorText().includes("Firebase App Check token is invalid")?ee=unauthorizedApp():ee=unauthenticated():b.getStatus()===402?ee=quotaExceeded(H.bucket):b.getStatus()===403?ee=unauthorized(H.path):ee=$,ee.status=b.getStatus(),ee.serverResponse=$.serverResponse,ee}return _}function objectErrorHandler(H){const _=sharedErrorHandler(H);function b($,ee){let re=_($,ee);return $.getStatus()===404&&(re=objectNotFound(H.path)),re.serverResponse=ee.serverResponse,re}return b}function getDownloadUrl(H,_,b){const $=_.fullServerUrl(),ee=makeUrl($,H.host,H._protocol),re="GET",ae=H.maxOperationRetryTime,xe=new RequestInfo(ee,re,downloadUrlHandler(H,b),ae);return xe.errorHandler=objectErrorHandler(_),xe}function determineContentType_(H,_){return H&&H.contentType||_&&_.type()||"application/octet-stream"}function metadataForUpload_(H,_,b){const $=Object.assign({},b);return $.fullPath=H.path,$.size=_.size(),$.contentType||($.contentType=determineContentType_(null,_)),$}function multipartUpload(H,_,b,$,ee){const re=_.bucketOnlyServerUrl(),ae={"X-Goog-Upload-Protocol":"multipart"};function xe(){let Xe="";for(let Ye=0;Ye<2;Ye++)Xe=Xe+Math.random().toString().slice(2);return Xe}const le=xe();ae["Content-Type"]="multipart/related; boundary="+le;const fe=metadataForUpload_(_,$,ee),ve=toResourceString(fe,b),Se="--"+le+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+ve+`\r
--`+le+`\r
Content-Type: `+fe.contentType+`\r
\r
`,Ee=`\r
--`+le+"--",Ce=FbsBlob.getBlob(Se,$,Ee);if(Ce===null)throw cannotSliceBlob();const Ie={name:fe.fullPath},De=makeUrl(re,H.host,H._protocol),Be="POST",Ne=H.maxUploadRetryTime,qe=new RequestInfo(De,Be,metadataHandler(H,b),Ne);return qe.urlParams=Ie,qe.headers=ae,qe.body=Ce.uploadData(),qe.errorHandler=sharedErrorHandler(_),qe}class XhrConnection{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ErrorCode.NO_ERROR,this.sendPromise_=new Promise(_=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ErrorCode.ABORT,_()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ErrorCode.NETWORK_ERROR,_()}),this.xhr_.addEventListener("load",()=>{_()})})}send(_,b,$,ee,re){if(this.sent_)throw internalError("cannot .send() more than once");if(isCloudWorkstation(_)&&$&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(b,_,!0),re!==void 0)for(const ae in re)re.hasOwnProperty(ae)&&this.xhr_.setRequestHeader(ae,re[ae].toString());return ee!==void 0?this.xhr_.send(ee):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw internalError("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw internalError("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw internalError("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw internalError("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(_){return this.xhr_.getResponseHeader(_)}addUploadProgressListener(_){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",_)}removeUploadProgressListener(_){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",_)}}class XhrTextConnection extends XhrConnection{initXhr(){this.xhr_.responseType="text"}}function newTextConnection(){return new XhrTextConnection}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Reference{constructor(_,b){this._service=_,b instanceof Location?this._location=b:this._location=Location.makeFromUrl(b,_.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(_,b){return new Reference(_,b)}get root(){const _=new Location(this._location.bucket,"");return this._newRef(this._service,_)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return lastComponent(this._location.path)}get storage(){return this._service}get parent(){const _=parent(this._location.path);if(_===null)return null;const b=new Location(this._location.bucket,_);return new Reference(this._service,b)}_throwIfRoot(_){if(this._location.path==="")throw invalidRootOperation(_)}}function uploadBytes$1(H,_,b){H._throwIfRoot("uploadBytes");const $=multipartUpload(H.storage,H._location,getMappings(),new FbsBlob(_,!0),b);return H.storage.makeRequestWithTokens($,newTextConnection).then(ee=>({metadata:ee,ref:H}))}function uploadString$1(H,_,b=StringFormat.RAW,$){H._throwIfRoot("uploadString");const ee=dataFromString(b,_),re=Object.assign({},$);return re.contentType==null&&ee.contentType!=null&&(re.contentType=ee.contentType),uploadBytes$1(H,ee.data,re)}function getDownloadURL$1(H){H._throwIfRoot("getDownloadURL");const _=getDownloadUrl(H.storage,H._location,getMappings());return H.storage.makeRequestWithTokens(_,newTextConnection).then(b=>{if(b===null)throw noDownloadURL();return b})}function _getChild$1(H,_){const b=child(H._location.path,_),$=new Location(H._location.bucket,b);return new Reference(H.storage,$)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isUrl(H){return/^[A-Za-z]+:\/\//.test(H)}function refFromURL(H,_){return new Reference(H,_)}function refFromPath(H,_){if(H instanceof FirebaseStorageImpl){const b=H;if(b._bucket==null)throw noDefaultBucket();const $=new Reference(b,b._bucket);return _!=null?refFromPath($,_):$}else return _!==void 0?_getChild$1(H,_):H}function ref$1(H,_){if(_&&isUrl(_)){if(H instanceof FirebaseStorageImpl)return refFromURL(H,_);throw invalidArgument("To use ref(service, url), the first argument must be a Storage instance.")}else return refFromPath(H,_)}function extractBucket(H,_){const b=_==null?void 0:_[CONFIG_STORAGE_BUCKET_KEY];return b==null?null:Location.makeFromBucketSpec(b,H)}function connectStorageEmulator$1(H,_,b,$={}){H.host=`${_}:${b}`;const ee=isCloudWorkstation(_);ee&&(pingServer(`https://${H.host}`),updateEmulatorBanner("Storage",!0)),H._isUsingEmulator=!0,H._protocol=ee?"https":"http";const{mockUserToken:re}=$;re&&(H._overrideAuthToken=typeof re=="string"?re:createMockUserToken(re,H.app.options.projectId))}class FirebaseStorageImpl{constructor(_,b,$,ee,re,ae=!1){this.app=_,this._authProvider=b,this._appCheckProvider=$,this._url=ee,this._firebaseVersion=re,this._isUsingEmulator=ae,this._bucket=null,this._host=DEFAULT_HOST,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=DEFAULT_MAX_OPERATION_RETRY_TIME,this._maxUploadRetryTime=DEFAULT_MAX_UPLOAD_RETRY_TIME,this._requests=new Set,ee!=null?this._bucket=Location.makeFromBucketSpec(ee,this._host):this._bucket=extractBucket(this._host,this.app.options)}get host(){return this._host}set host(_){this._host=_,this._url!=null?this._bucket=Location.makeFromBucketSpec(this._url,_):this._bucket=extractBucket(_,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(_){validateNumber("time",0,Number.POSITIVE_INFINITY,_),this._maxUploadRetryTime=_}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(_){validateNumber("time",0,Number.POSITIVE_INFINITY,_),this._maxOperationRetryTime=_}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const _=this._authProvider.getImmediate({optional:!0});if(_){const b=await _.getToken();if(b!==null)return b.accessToken}return null}async _getAppCheckToken(){if(_isFirebaseServerApp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const _=this._appCheckProvider.getImmediate({optional:!0});return _?(await _.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(_=>_.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(_){return new Reference(this,_)}_makeRequest(_,b,$,ee,re=!0){if(this._deleted)return new FailRequest(appDeleted());{const ae=makeRequest(_,this._appId,$,ee,b,this._firebaseVersion,re,this._isUsingEmulator);return this._requests.add(ae),ae.getPromise().then(()=>this._requests.delete(ae),()=>this._requests.delete(ae)),ae}}async makeRequestWithTokens(_,b){const[$,ee]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(_,b,$,ee).getPromise()}}const name="@firebase/storage",version="0.13.11";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const STORAGE_TYPE="storage";function uploadString(H,_,b,$){return H=getModularInstance(H),uploadString$1(H,_,b,$)}function getDownloadURL(H){return H=getModularInstance(H),getDownloadURL$1(H)}function ref(H,_){return H=getModularInstance(H),ref$1(H,_)}function getStorage(H=getApp(),_){H=getModularInstance(H),updateEmulatorBanner("Storage",!1);const $=_getProvider(H,STORAGE_TYPE).getImmediate({identifier:_}),ee=getDefaultEmulatorHostnameAndPort("storage");return ee&&connectStorageEmulator($,...ee),$}function connectStorageEmulator(H,_,b,$={}){connectStorageEmulator$1(H,_,b,$)}function factory(H,{instanceIdentifier:_}){const b=H.getProvider("app").getImmediate(),$=H.getProvider("auth-internal"),ee=H.getProvider("app-check-internal");return new FirebaseStorageImpl(b,$,ee,_,SDK_VERSION)}function registerStorage(){_registerComponent(new Component(STORAGE_TYPE,factory,"PUBLIC").setMultipleInstances(!0)),registerVersion(name,version,""),registerVersion(name,version,"esm2017")}registerStorage();var lib={},propTypes={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var H="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=H,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var H=requireReactPropTypesSecret();function _(){}function b(){}return b.resetWarningCache=_,factoryWithThrowingShims=function(){function $(ae,xe,le,fe,ve,Se){if(Se!==H){var Ee=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw Ee.name="Invariant Violation",Ee}}$.isRequired=$;function ee(){return $}var re={array:$,bigint:$,bool:$,func:$,number:$,object:$,string:$,symbol:$,any:$,arrayOf:ee,element:$,elementType:$,instanceOf:ee,node:$,objectOf:ee,oneOf:ee,oneOfType:ee,shape:ee,exact:ee,checkPropTypes:b,resetWarningCache:_};return re.PropTypes=re,re},factoryWithThrowingShims}var hasRequiredPropTypes;function requirePropTypes(){return hasRequiredPropTypes||(hasRequiredPropTypes=1,propTypes.exports=requireFactoryWithThrowingShims()()),propTypes.exports}var ErrorCorrectLevel,hasRequiredErrorCorrectLevel;function requireErrorCorrectLevel(){return hasRequiredErrorCorrectLevel||(hasRequiredErrorCorrectLevel=1,ErrorCorrectLevel={L:1,M:0,Q:3,H:2}),ErrorCorrectLevel}var mode,hasRequiredMode;function requireMode(){return hasRequiredMode||(hasRequiredMode=1,mode={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}),mode}var _8BitByte,hasRequired_8BitByte;function require_8BitByte(){if(hasRequired_8BitByte)return _8BitByte;hasRequired_8BitByte=1;var H=requireMode();function _(b){this.mode=H.MODE_8BIT_BYTE,this.data=b}return _.prototype={getLength:function(b){return this.data.length},write:function(b){for(var $=0;$<this.data.length;$++)b.put(this.data.charCodeAt($),8)}},_8BitByte=_,_8BitByte}var RSBlock,hasRequiredRSBlock;function requireRSBlock(){if(hasRequiredRSBlock)return RSBlock;hasRequiredRSBlock=1;var H=requireErrorCorrectLevel();function _(b,$){this.totalCount=b,this.dataCount=$}return _.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],_.getRSBlocks=function(b,$){var ee=_.getRsBlockTable(b,$);if(ee==null)throw new Error("bad rs block @ typeNumber:"+b+"/errorCorrectLevel:"+$);for(var re=ee.length/3,ae=new Array,xe=0;xe<re;xe++)for(var le=ee[xe*3+0],fe=ee[xe*3+1],ve=ee[xe*3+2],Se=0;Se<le;Se++)ae.push(new _(fe,ve));return ae},_.getRsBlockTable=function(b,$){switch($){case H.L:return _.RS_BLOCK_TABLE[(b-1)*4+0];case H.M:return _.RS_BLOCK_TABLE[(b-1)*4+1];case H.Q:return _.RS_BLOCK_TABLE[(b-1)*4+2];case H.H:return _.RS_BLOCK_TABLE[(b-1)*4+3];default:return}},RSBlock=_,RSBlock}var BitBuffer,hasRequiredBitBuffer;function requireBitBuffer(){if(hasRequiredBitBuffer)return BitBuffer;hasRequiredBitBuffer=1;function H(){this.buffer=new Array,this.length=0}return H.prototype={get:function(_){var b=Math.floor(_/8);return(this.buffer[b]>>>7-_%8&1)==1},put:function(_,b){for(var $=0;$<b;$++)this.putBit((_>>>b-$-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(_){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0),_&&(this.buffer[b]|=128>>>this.length%8),this.length++}},BitBuffer=H,BitBuffer}var math,hasRequiredMath;function requireMath(){if(hasRequiredMath)return math;hasRequiredMath=1;for(var H={glog:function(b){if(b<1)throw new Error("glog("+b+")");return H.LOG_TABLE[b]},gexp:function(b){for(;b<0;)b+=255;for(;b>=256;)b-=255;return H.EXP_TABLE[b]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},_=0;_<8;_++)H.EXP_TABLE[_]=1<<_;for(var _=8;_<256;_++)H.EXP_TABLE[_]=H.EXP_TABLE[_-4]^H.EXP_TABLE[_-5]^H.EXP_TABLE[_-6]^H.EXP_TABLE[_-8];for(var _=0;_<255;_++)H.LOG_TABLE[H.EXP_TABLE[_]]=_;return math=H,math}var Polynomial,hasRequiredPolynomial;function requirePolynomial(){if(hasRequiredPolynomial)return Polynomial;hasRequiredPolynomial=1;var H=requireMath();function _(b,$){if(b.length==null)throw new Error(b.length+"/"+$);for(var ee=0;ee<b.length&&b[ee]==0;)ee++;this.num=new Array(b.length-ee+$);for(var re=0;re<b.length-ee;re++)this.num[re]=b[re+ee]}return _.prototype={get:function(b){return this.num[b]},getLength:function(){return this.num.length},multiply:function(b){for(var $=new Array(this.getLength()+b.getLength()-1),ee=0;ee<this.getLength();ee++)for(var re=0;re<b.getLength();re++)$[ee+re]^=H.gexp(H.glog(this.get(ee))+H.glog(b.get(re)));return new _($,0)},mod:function(b){if(this.getLength()-b.getLength()<0)return this;for(var $=H.glog(this.get(0))-H.glog(b.get(0)),ee=new Array(this.getLength()),re=0;re<this.getLength();re++)ee[re]=this.get(re);for(var re=0;re<b.getLength();re++)ee[re]^=H.gexp(H.glog(b.get(re))+$);return new _(ee,0).mod(b)}},Polynomial=_,Polynomial}var util,hasRequiredUtil;function requireUtil(){if(hasRequiredUtil)return util;hasRequiredUtil=1;var H=requireMode(),_=requirePolynomial(),b=requireMath(),$={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},ee={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(re){for(var ae=re<<10;ee.getBCHDigit(ae)-ee.getBCHDigit(ee.G15)>=0;)ae^=ee.G15<<ee.getBCHDigit(ae)-ee.getBCHDigit(ee.G15);return(re<<10|ae)^ee.G15_MASK},getBCHTypeNumber:function(re){for(var ae=re<<12;ee.getBCHDigit(ae)-ee.getBCHDigit(ee.G18)>=0;)ae^=ee.G18<<ee.getBCHDigit(ae)-ee.getBCHDigit(ee.G18);return re<<12|ae},getBCHDigit:function(re){for(var ae=0;re!=0;)ae++,re>>>=1;return ae},getPatternPosition:function(re){return ee.PATTERN_POSITION_TABLE[re-1]},getMask:function(re,ae,xe){switch(re){case $.PATTERN000:return(ae+xe)%2==0;case $.PATTERN001:return ae%2==0;case $.PATTERN010:return xe%3==0;case $.PATTERN011:return(ae+xe)%3==0;case $.PATTERN100:return(Math.floor(ae/2)+Math.floor(xe/3))%2==0;case $.PATTERN101:return ae*xe%2+ae*xe%3==0;case $.PATTERN110:return(ae*xe%2+ae*xe%3)%2==0;case $.PATTERN111:return(ae*xe%3+(ae+xe)%2)%2==0;default:throw new Error("bad maskPattern:"+re)}},getErrorCorrectPolynomial:function(re){for(var ae=new _([1],0),xe=0;xe<re;xe++)ae=ae.multiply(new _([1,b.gexp(xe)],0));return ae},getLengthInBits:function(re,ae){if(1<=ae&&ae<10)switch(re){case H.MODE_NUMBER:return 10;case H.MODE_ALPHA_NUM:return 9;case H.MODE_8BIT_BYTE:return 8;case H.MODE_KANJI:return 8;default:throw new Error("mode:"+re)}else if(ae<27)switch(re){case H.MODE_NUMBER:return 12;case H.MODE_ALPHA_NUM:return 11;case H.MODE_8BIT_BYTE:return 16;case H.MODE_KANJI:return 10;default:throw new Error("mode:"+re)}else if(ae<41)switch(re){case H.MODE_NUMBER:return 14;case H.MODE_ALPHA_NUM:return 13;case H.MODE_8BIT_BYTE:return 16;case H.MODE_KANJI:return 12;default:throw new Error("mode:"+re)}else throw new Error("type:"+ae)},getLostPoint:function(re){for(var ae=re.getModuleCount(),xe=0,le=0;le<ae;le++)for(var fe=0;fe<ae;fe++){for(var ve=0,Se=re.isDark(le,fe),Ee=-1;Ee<=1;Ee++)if(!(le+Ee<0||ae<=le+Ee))for(var Ce=-1;Ce<=1;Ce++)fe+Ce<0||ae<=fe+Ce||Ee==0&&Ce==0||Se==re.isDark(le+Ee,fe+Ce)&&ve++;ve>5&&(xe+=3+ve-5)}for(var le=0;le<ae-1;le++)for(var fe=0;fe<ae-1;fe++){var Ie=0;re.isDark(le,fe)&&Ie++,re.isDark(le+1,fe)&&Ie++,re.isDark(le,fe+1)&&Ie++,re.isDark(le+1,fe+1)&&Ie++,(Ie==0||Ie==4)&&(xe+=3)}for(var le=0;le<ae;le++)for(var fe=0;fe<ae-6;fe++)re.isDark(le,fe)&&!re.isDark(le,fe+1)&&re.isDark(le,fe+2)&&re.isDark(le,fe+3)&&re.isDark(le,fe+4)&&!re.isDark(le,fe+5)&&re.isDark(le,fe+6)&&(xe+=40);for(var fe=0;fe<ae;fe++)for(var le=0;le<ae-6;le++)re.isDark(le,fe)&&!re.isDark(le+1,fe)&&re.isDark(le+2,fe)&&re.isDark(le+3,fe)&&re.isDark(le+4,fe)&&!re.isDark(le+5,fe)&&re.isDark(le+6,fe)&&(xe+=40);for(var De=0,fe=0;fe<ae;fe++)for(var le=0;le<ae;le++)re.isDark(le,fe)&&De++;var Be=Math.abs(100*De/ae/ae-50)/5;return xe+=Be*10,xe}};return util=ee,util}var QRCode_1,hasRequiredQRCode;function requireQRCode(){if(hasRequiredQRCode)return QRCode_1;hasRequiredQRCode=1;var H=require_8BitByte(),_=requireRSBlock(),b=requireBitBuffer(),$=requireUtil(),ee=requirePolynomial();function re(xe,le){this.typeNumber=xe,this.errorCorrectLevel=le,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var ae=re.prototype;return ae.addData=function(xe){var le=new H(xe);this.dataList.push(le),this.dataCache=null},ae.isDark=function(xe,le){if(xe<0||this.moduleCount<=xe||le<0||this.moduleCount<=le)throw new Error(xe+","+le);return this.modules[xe][le]},ae.getModuleCount=function(){return this.moduleCount},ae.make=function(){if(this.typeNumber<1){var xe=1;for(xe=1;xe<40;xe++){for(var le=_.getRSBlocks(xe,this.errorCorrectLevel),fe=new b,ve=0,Se=0;Se<le.length;Se++)ve+=le[Se].dataCount;for(var Se=0;Se<this.dataList.length;Se++){var Ee=this.dataList[Se];fe.put(Ee.mode,4),fe.put(Ee.getLength(),$.getLengthInBits(Ee.mode,xe)),Ee.write(fe)}if(fe.getLengthInBits()<=ve*8)break}this.typeNumber=xe}this.makeImpl(!1,this.getBestMaskPattern())},ae.makeImpl=function(xe,le){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var fe=0;fe<this.moduleCount;fe++){this.modules[fe]=new Array(this.moduleCount);for(var ve=0;ve<this.moduleCount;ve++)this.modules[fe][ve]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(xe,le),this.typeNumber>=7&&this.setupTypeNumber(xe),this.dataCache==null&&(this.dataCache=re.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,le)},ae.setupPositionProbePattern=function(xe,le){for(var fe=-1;fe<=7;fe++)if(!(xe+fe<=-1||this.moduleCount<=xe+fe))for(var ve=-1;ve<=7;ve++)le+ve<=-1||this.moduleCount<=le+ve||(0<=fe&&fe<=6&&(ve==0||ve==6)||0<=ve&&ve<=6&&(fe==0||fe==6)||2<=fe&&fe<=4&&2<=ve&&ve<=4?this.modules[xe+fe][le+ve]=!0:this.modules[xe+fe][le+ve]=!1)},ae.getBestMaskPattern=function(){for(var xe=0,le=0,fe=0;fe<8;fe++){this.makeImpl(!0,fe);var ve=$.getLostPoint(this);(fe==0||xe>ve)&&(xe=ve,le=fe)}return le},ae.createMovieClip=function(xe,le,fe){var ve=xe.createEmptyMovieClip(le,fe),Se=1;this.make();for(var Ee=0;Ee<this.modules.length;Ee++)for(var Ce=Ee*Se,Ie=0;Ie<this.modules[Ee].length;Ie++){var De=Ie*Se,Be=this.modules[Ee][Ie];Be&&(ve.beginFill(0,100),ve.moveTo(De,Ce),ve.lineTo(De+Se,Ce),ve.lineTo(De+Se,Ce+Se),ve.lineTo(De,Ce+Se),ve.endFill())}return ve},ae.setupTimingPattern=function(){for(var xe=8;xe<this.moduleCount-8;xe++)this.modules[xe][6]==null&&(this.modules[xe][6]=xe%2==0);for(var le=8;le<this.moduleCount-8;le++)this.modules[6][le]==null&&(this.modules[6][le]=le%2==0)},ae.setupPositionAdjustPattern=function(){for(var xe=$.getPatternPosition(this.typeNumber),le=0;le<xe.length;le++)for(var fe=0;fe<xe.length;fe++){var ve=xe[le],Se=xe[fe];if(this.modules[ve][Se]==null)for(var Ee=-2;Ee<=2;Ee++)for(var Ce=-2;Ce<=2;Ce++)Ee==-2||Ee==2||Ce==-2||Ce==2||Ee==0&&Ce==0?this.modules[ve+Ee][Se+Ce]=!0:this.modules[ve+Ee][Se+Ce]=!1}},ae.setupTypeNumber=function(xe){for(var le=$.getBCHTypeNumber(this.typeNumber),fe=0;fe<18;fe++){var ve=!xe&&(le>>fe&1)==1;this.modules[Math.floor(fe/3)][fe%3+this.moduleCount-8-3]=ve}for(var fe=0;fe<18;fe++){var ve=!xe&&(le>>fe&1)==1;this.modules[fe%3+this.moduleCount-8-3][Math.floor(fe/3)]=ve}},ae.setupTypeInfo=function(xe,le){for(var fe=this.errorCorrectLevel<<3|le,ve=$.getBCHTypeInfo(fe),Se=0;Se<15;Se++){var Ee=!xe&&(ve>>Se&1)==1;Se<6?this.modules[Se][8]=Ee:Se<8?this.modules[Se+1][8]=Ee:this.modules[this.moduleCount-15+Se][8]=Ee}for(var Se=0;Se<15;Se++){var Ee=!xe&&(ve>>Se&1)==1;Se<8?this.modules[8][this.moduleCount-Se-1]=Ee:Se<9?this.modules[8][15-Se-1+1]=Ee:this.modules[8][15-Se-1]=Ee}this.modules[this.moduleCount-8][8]=!xe},ae.mapData=function(xe,le){for(var fe=-1,ve=this.moduleCount-1,Se=7,Ee=0,Ce=this.moduleCount-1;Ce>0;Ce-=2)for(Ce==6&&Ce--;;){for(var Ie=0;Ie<2;Ie++)if(this.modules[ve][Ce-Ie]==null){var De=!1;Ee<xe.length&&(De=(xe[Ee]>>>Se&1)==1);var Be=$.getMask(le,ve,Ce-Ie);Be&&(De=!De),this.modules[ve][Ce-Ie]=De,Se--,Se==-1&&(Ee++,Se=7)}if(ve+=fe,ve<0||this.moduleCount<=ve){ve-=fe,fe=-fe;break}}},re.PAD0=236,re.PAD1=17,re.createData=function(xe,le,fe){for(var ve=_.getRSBlocks(xe,le),Se=new b,Ee=0;Ee<fe.length;Ee++){var Ce=fe[Ee];Se.put(Ce.mode,4),Se.put(Ce.getLength(),$.getLengthInBits(Ce.mode,xe)),Ce.write(Se)}for(var Ie=0,Ee=0;Ee<ve.length;Ee++)Ie+=ve[Ee].dataCount;if(Se.getLengthInBits()>Ie*8)throw new Error("code length overflow. ("+Se.getLengthInBits()+">"+Ie*8+")");for(Se.getLengthInBits()+4<=Ie*8&&Se.put(0,4);Se.getLengthInBits()%8!=0;)Se.putBit(!1);for(;!(Se.getLengthInBits()>=Ie*8||(Se.put(re.PAD0,8),Se.getLengthInBits()>=Ie*8));)Se.put(re.PAD1,8);return re.createBytes(Se,ve)},re.createBytes=function(xe,le){for(var fe=0,ve=0,Se=0,Ee=new Array(le.length),Ce=new Array(le.length),Ie=0;Ie<le.length;Ie++){var De=le[Ie].dataCount,Be=le[Ie].totalCount-De;ve=Math.max(ve,De),Se=Math.max(Se,Be),Ee[Ie]=new Array(De);for(var Ne=0;Ne<Ee[Ie].length;Ne++)Ee[Ie][Ne]=255&xe.buffer[Ne+fe];fe+=De;var qe=$.getErrorCorrectPolynomial(Be),Xe=new ee(Ee[Ie],qe.getLength()-1),Ye=Xe.mod(qe);Ce[Ie]=new Array(qe.getLength()-1);for(var Ne=0;Ne<Ce[Ie].length;Ne++){var Qe=Ne+Ye.getLength()-Ce[Ie].length;Ce[Ie][Ne]=Qe>=0?Ye.get(Qe):0}}for(var rt=0,Ne=0;Ne<le.length;Ne++)rt+=le[Ne].totalCount;for(var ot=new Array(rt),ct=0,Ne=0;Ne<ve;Ne++)for(var Ie=0;Ie<le.length;Ie++)Ne<Ee[Ie].length&&(ot[ct++]=Ee[Ie][Ne]);for(var Ne=0;Ne<Se;Ne++)for(var Ie=0;Ie<le.length;Ie++)Ne<Ce[Ie].length&&(ot[ct++]=Ce[Ie][Ne]);return ot},QRCode_1=re,QRCode_1}var QRCodeSvg={},hasRequiredQRCodeSvg;function requireQRCodeSvg(){if(hasRequiredQRCodeSvg)return QRCodeSvg;hasRequiredQRCodeSvg=1,Object.defineProperty(QRCodeSvg,"__esModule",{value:!0});var H=Object.assign||function(fe){for(var ve=1;ve<arguments.length;ve++){var Se=arguments[ve];for(var Ee in Se)Object.prototype.hasOwnProperty.call(Se,Ee)&&(fe[Ee]=Se[Ee])}return fe},_=requirePropTypes(),b=re(_),$=requireReact(),ee=re($);function re(fe){return fe&&fe.__esModule?fe:{default:fe}}function ae(fe,ve){var Se={};for(var Ee in fe)ve.indexOf(Ee)>=0||Object.prototype.hasOwnProperty.call(fe,Ee)&&(Se[Ee]=fe[Ee]);return Se}var xe={bgColor:b.default.oneOfType([b.default.object,b.default.string]).isRequired,bgD:b.default.string.isRequired,fgColor:b.default.oneOfType([b.default.object,b.default.string]).isRequired,fgD:b.default.string.isRequired,size:b.default.number.isRequired,title:b.default.string,viewBoxSize:b.default.number.isRequired,xmlns:b.default.string},le=(0,$.forwardRef)(function(fe,ve){var Se=fe.bgColor,Ee=fe.bgD,Ce=fe.fgD,Ie=fe.fgColor,De=fe.size,Be=fe.title,Ne=fe.viewBoxSize,qe=fe.xmlns,Xe=qe===void 0?"http://www.w3.org/2000/svg":qe,Ye=ae(fe,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return ee.default.createElement("svg",H({},Ye,{height:De,ref:ve,viewBox:"0 0 "+Ne+" "+Ne,width:De,xmlns:Xe}),Be?ee.default.createElement("title",null,Be):null,ee.default.createElement("path",{d:Ee,fill:Se}),ee.default.createElement("path",{d:Ce,fill:Ie}))});return le.displayName="QRCodeSvg",le.propTypes=xe,QRCodeSvg.default=le,QRCodeSvg}var hasRequiredLib;function requireLib(){if(hasRequiredLib)return lib;hasRequiredLib=1,Object.defineProperty(lib,"__esModule",{value:!0}),lib.QRCode=void 0;var H=Object.assign||function(De){for(var Be=1;Be<arguments.length;Be++){var Ne=arguments[Be];for(var qe in Ne)Object.prototype.hasOwnProperty.call(Ne,qe)&&(De[qe]=Ne[qe])}return De},_=requirePropTypes(),b=Se(_),$=requireErrorCorrectLevel(),ee=Se($),re=requireQRCode(),ae=Se(re),xe=requireReact(),le=Se(xe),fe=requireQRCodeSvg(),ve=Se(fe);function Se(De){return De&&De.__esModule?De:{default:De}}function Ee(De,Be){var Ne={};for(var qe in De)Be.indexOf(qe)>=0||Object.prototype.hasOwnProperty.call(De,qe)&&(Ne[qe]=De[qe]);return Ne}var Ce={bgColor:b.default.oneOfType([b.default.object,b.default.string]),fgColor:b.default.oneOfType([b.default.object,b.default.string]),level:b.default.string,size:b.default.number,value:b.default.string.isRequired},Ie=(0,xe.forwardRef)(function(De,Be){var Ne=De.bgColor,qe=Ne===void 0?"#FFFFFF":Ne,Xe=De.fgColor,Ye=Xe===void 0?"#000000":Xe,Qe=De.level,rt=Qe===void 0?"L":Qe,ot=De.size,ct=ot===void 0?256:ot,mt=De.value,_t=Ee(De,["bgColor","fgColor","level","size","value"]),Lt=new ae.default(-1,ee.default[rt]);Lt.addData(mt),Lt.make();var Vt=Lt.modules;return le.default.createElement(ve.default,H({},_t,{bgColor:qe,bgD:Vt.map(function(Gt,$t){return Gt.map(function(Qt,vt){return Qt?"":"M "+vt+" "+$t+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:Ye,fgD:Vt.map(function(Gt,$t){return Gt.map(function(Qt,vt){return Qt?"M "+vt+" "+$t+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:Be,size:ct,viewBoxSize:Vt.length}))});return lib.QRCode=Ie,Ie.displayName="QRCode",Ie.propTypes=Ce,lib.default=Ie,lib}var libExports=requireLib();const QRCode=getDefaultExportFromCjs(libExports),firebaseConfig={apiKey:"AIzaSyDLaCvTi5mlL0dEnVzOqylm9nK8e5HrmiM",authDomain:"outfit-ar-3d0a3.firebaseapp.com",projectId:"outfit-ar-3d0a3",storageBucket:"outfit-ar-3d0a3.firebasestorage.app",messagingSenderId:"849201286252",appId:"1:849201286252:web:0643b4005bd1cfc982dc49"};function ResultPreview({camImg:H,setCamImg:_,setRetake:b,setCurrentState:$}){const[ee,re]=reactExports.useState(!1),[ae,xe]=reactExports.useState(null),le=async()=>{re(!0);const fe=initializeApp(firebaseConfig),ve=getStorage(fe),Se=ref(ve,`images/${Date.now()}.png`);try{await uploadString(Se,H,"data_url");const Ee=await getDownloadURL(Se);console.log("Uploaded image URL:",Ee),xe(Ee),re(!1)}catch(Ee){console.error("Upload failed:",Ee)}};return React.createElement("div",{className:styles$2.resultWrapper,style:{width:window.innerWidth,height:window.innerHeight}},React.createElement("div",{className:styles$2.topLeft,style:{width:pixelsToVW(290)}},React.createElement("img",{src:yts,alt:"ytShopping",style:{height:"100%",width:"100%",objectFit:"contain"}})),React.createElement("div",{className:styles$2.prevText,style:{fontSize:pixelsToVH(65),color:"#FD0100",fontWeight:"bold",margin:pixelsToVH(50),marginBottom:pixelsToVH(100)}},ee?React.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}},React.createElement("div",null,"Your photo is being",React.createElement("br",null),"processed.."),React.createElement("div",{className:styles$2.gif,style:{width:pixelsToVW(238)},onClick:()=>le()},React.createElement(Lottie,{animationData:play,loop:!0}))):ae?React.createElement("span",null,"Slaying it!",React.createElement("br",null),"This look was made for you."):React.createElement("span",null,"Heres a glimpse of your new vibe!")),ee?null:React.createElement("div",{className:styles$2.resultImg},React.createElement("img",{src:H,id:"photo-preview",alt:"camImg",style:{visibility:H?"visible":"hidden",width:H?"auto":0,objectFit:"cover",border:`${pixelsToVW(8)} solid #FD0100`,borderRadius:20,maxHeight:pixelsToVH(1080),height:pixelsToVH(825),aspectRatio:1080/1920}}),React.createElement("div",{className:styles$2.leftAbs,style:{width:pixelsToVW(136),height:"auto",bottom:pixelsToVH(-40),left:pixelsToVW(-60)}},React.createElement("img",{src:happy,alt:"happy",style:{height:"100%",width:"100%",objectFit:"contain"}})),React.createElement("div",{className:styles$2.rightAbs,style:{width:pixelsToVW(134),height:"auto",top:pixelsToVH(-70),right:pixelsToVW(-60)}},React.createElement("img",{src:bagRight,alt:"bag",style:{height:"100%",width:"100%",objectFit:"contain"}})),React.createElement("div",{className:styles$2.retake},React.createElement("button",{style:{fontSize:pixelsToVH(24),width:pixelsToVW(212),minHeight:pixelsToVH(62),borderRadius:pixelsToVH(30),fontWeight:"bold",position:"relative",zIndex:50},onClick:()=>{b(!0),_(""),document.getElementById("webarFace").style.display="none",$(1)}},"Retake",React.createElement("img",{src:"https://img.icons8.com/ios/50/camera--v4.png",alt:"cam",style:{width:pixelsToVW(29),marginLeft:pixelsToVW(10),filter:"invert(1)",height:"100%",objectFit:"contain"}})))),ee?null:React.createElement("div",{className:styles$2.actions,style:{gap:pixelsToVH(50),marginTop:pixelsToVH(20)}},ae?React.createElement("div",{className:styles$2.qrBox,style:{marginTop:pixelsToVH(40)}},React.createElement(QRCode,{value:ae,size:pixelsToVH(178),viewBox:"transparent"}),React.createElement("img",{src:scanme,alt:"scan me",style:{width:pixelsToVW(354),height:"auto",objectFit:"contain",marginLeft:pixelsToVW(10)}})):null,React.createElement("div",{className:styles$2.confirm,style:{width:pixelsToVW(331),height:"auto",margin:"0 auto",position:"relative",zIndex:50}},React.createElement("img",{src:ae?home:confirm,alt:"confirm",style:{height:"100%",width:"100%",objectFit:"contain"},onClick:()=>{ae?(localStorage.removeItem("genderSelect"),$(0)):le()}}))))}function q$1(H,_){return _.forEach(function(b){b&&typeof b!="string"&&!Array.isArray(b)&&Object.keys(b).forEach(function($){if($!=="default"&&!($ in H)){var ee=Object.getOwnPropertyDescriptor(b,$);Object.defineProperty(H,$,ee.get?ee:{enumerable:!0,get:function(){return b[$]}})}})}),Object.freeze(H)}const n$1=1e-7,p$1=1e-4;class g{constructor(_,b){this.backend=_,this.dataMover=b,this.data=new WeakMap,this.dataIdsCount=0}get(_){return this.data.has(_)||this.dataMover.moveData(this.backend,_),this.data.get(_)}set(_,b){this.dataIdsCount++,this.data.set(_,b)}has(_){return this.data.has(_)}delete(_){return this.dataIdsCount--,this.data.delete(_)}numDataIds(){return this.dataIdsCount}}let x$1=class{refCount(_){return s$2("refCount")}incRef(_){return s$2("incRef")}timerAvailable(){return!0}time(_){return s$2("time")}read(_){return s$2("read")}readSync(_){return s$2("readSync")}readToGPU(_,b){return s$2("readToGPU")}numDataIds(){return s$2("numDataIds")}disposeData(_,b){return s$2("disposeData")}write(_,b,$){return s$2("write")}move(_,b,$,ee,re){return s$2("move")}createTensorFromGPUData(_,b,$){return s$2("createTensorFromGPUData")}memory(){return s$2("memory")}floatPrecision(){return s$2("floatPrecision")}epsilon(){return this.floatPrecision()===32?n$1:p$1}dispose(){return s$2("dispose")}};function s$2(H){throw new Error("'"+H+"' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen")}function E$1(H,_,b){return Math.max(H,Math.min(_,b))}function f$1(H){return H%2===0?H:H+1}function S$1(H,_,b){const $=H[_];H[_]=H[b],H[b]=$}function F$1(H){let _=0;for(let b=0;b<H.length;b++)_+=H[b];return _}function k(H,_){if(!H)throw new Error(typeof _=="string"?_:_())}function O(H,_,b=""){k(D(H,_),()=>b+(" Shapes "+H+" and "+_+" must match"))}function W(H){k(H!=null,()=>"The input to the tensor constructor must be a non-null value.")}function i$1(H){if(H.length===0)return 1;let _=H[0];for(let b=1;b<H.length;b++)_*=H[b];return _}function D(H,_){if(H===_)return!0;if(H==null||_==null||H.length!==_.length)return!1;for(let b=0;b<H.length;b++)if(H[b]!==_[b])return!1;return!0}function m$1(H){return H%1===0}function a$1(H){const _=Math.ceil(Math.sqrt(H));return[_,Math.ceil(H/_)]}function Z$1(H,_){return _<=H.length?H:H+" ".repeat(_-H.length)}function w(H,_=ee=>0,b,$){return new Promise((ee,re)=>{let ae=0;const xe=()=>{if(H()){ee();return}ae++;const le=_(ae);if(b!=null&&ae>=b){re();return}$!=null?$(xe,le):setTimeout(xe,le)};xe()})}function e$1(H,_){let b=1,$=-1;for(let re=0;re<H.length;++re)if(H[re]>=0)b*=H[re];else if(H[re]===-1){if($!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+$+" and dim "+re);$=re}else if(H[re]<0)throw Error("Shapes can not be < 0. Found "+H[re]+" at dim "+re);if($===-1){if(_>0&&_!==b)throw Error("Size("+_+") must match the product of shape "+H);return H}if(b===0)throw Error("Cannot infer the missing size in ["+H+"] when there are 0 elements");if(_%b!==0)throw Error("The implicit shape can't be a fractional number. Got "+_+" / "+b);const ee=H.slice();return ee[$]=_/b,ee}function z$1(H,_){const b=_.length;return H=H==null?_.map(($,ee)=>ee):[].concat(H),k(H.every($=>$>=-b&&$<b),()=>"All values in axis param must be in range [-"+b+", "+b+") but got axis "+H),k(H.every($=>m$1($)),()=>"All values in axis param must be integers but got axis "+H),H.map($=>$<0?b+$:$)}function c$1(H,_){const b=[],$=[],ee=_!=null&&Array.isArray(_)&&_.length===0,re=_==null||ee?null:z$1(_,H).sort();let ae=0;for(let xe=0;xe<H.length;++xe){if(re!=null){if(re[ae]===xe&&H[xe]!==1)throw new Error("Can't squeeze axis "+xe+" since its dim '"+H[xe]+"' is not 1");(re[ae]==null||re[ae]>xe)&&H[xe]===1&&(b.push(H[xe]),$.push(xe)),re[ae]<=xe&&ae++}H[xe]!==1&&(b.push(H[xe]),$.push(xe))}return{newShape:b,keptDims:$}}function X(H,_){return G(H,_)}function G(H,_){let b=null;if(H==null||H==="float32")b=new Float32Array(_);else if(H==="int32")b=new Int32Array(_);else if(H==="bool")b=new Uint8Array(_);else if(H==="string")b=new Array(_);else throw new Error("Unknown data type "+H);return b}function N$1(H,_){for(let b=0;b<H.length;b++){const $=H[b];if(isNaN($)||!isFinite($))throw Error("A tensor of type "+_+" being uploaded contains "+$+".")}}function u$1(H){return H==="bool"||H==="complex64"||H==="float32"||H==="int32"||H==="string"}function j(H,_){return!(_==="complex64"||_==="float32"&&H!=="complex64"||_==="int32"&&H!=="float32"&&H!=="complex64"||_==="bool"&&H==="bool")}function L(H){if(H==="float32"||H==="int32")return 4;if(H==="complex64")return 8;if(H==="bool")return 1;throw new Error("Unknown dtype "+H)}function I$1(H){if(H==null)return 0;let _=0;return H.forEach(b=>_+=b.length),_}function R$1(H){return typeof H=="string"||H instanceof String}function o$2(H){return typeof H=="boolean"}function r$2(H){return typeof H=="number"}function Q(H){return Array.isArray(H)?Q(H[0]):H instanceof Float32Array?"float32":H instanceof Int32Array||H instanceof Uint8Array||H instanceof Uint8ClampedArray?"int32":r$2(H)?"float32":R$1(H)?"string":o$2(H)?"bool":"float32"}function d$1(H){return!!(H&&H.constructor&&H.call&&H.apply)}function v(H,_){for(let b=_;b<H;++b)if(H%b===0)return b;return H}function y(H){const _=H.length;if(_<2)return[];const b=new Array(_-1);b[_-2]=H[_-1];for(let $=_-3;$>=0;--$)b[$]=b[$+1]*H[$+1];return b}function C(H,_,b,$=!1){const ee=new Array;if(_.length===1){const re=_[0]*($?2:1);for(let ae=0;ae<re;ae++)ee[ae]=b[H+ae]}else{const re=_[0],ae=_.slice(1),xe=ae.reduce((le,fe)=>le*fe)*($?2:1);for(let le=0;le<re;le++)ee[le]=C(H+le*xe,ae,b,$)}return ee}function l$1(H,_,b=!1){if(H.length===0)return _[0];const $=H.reduce((ee,re)=>ee*re)*(b?2:1);if($===0)return[];if($!==_.length)throw new Error("["+H+"] does not match the input size "+_.length+(b?" for a complex tensor":"")+".");return C(0,H,_,b)}function A$1(H,_){if(Array.isArray(H))return H;if(_==="float32")return H instanceof Float32Array?H:new Float32Array(H);if(_==="int32")return H instanceof Int32Array?H:new Int32Array(H);if(_==="bool"||_==="string")return Uint8Array.from(new Int32Array(H));throw new Error("Unknown dtype "+_)}function h$1(H,_){const b=T(H,_);for(let $=0;$<b.length;$++)b[$]=1;return b}function T(H,_){if(_==null||_==="float32"||_==="complex64")return new Float32Array(H);if(_==="int32")return new Int32Array(H);if(_==="bool")return new Uint8Array(H);throw new Error("Unknown data type "+_)}function K(H){H.forEach(_=>{k(Number.isInteger(_)&&_>=0,()=>"Tensor must have a shape comprised of positive integers but got shape ["+H+"].")})}function B(H,_,b){if(_===0)return 0;if(_===1)return H[0];let $=H[H.length-1];for(let ee=0;ee<H.length-1;++ee)$+=b[ee]*H[ee];return $}function V(H,_,b){if(_===0)return[];if(_===1)return[H];const $=new Array(_);for(let ee=0;ee<$.length-1;++ee)$[ee]=Math.floor(H/b[ee]),H-=$[ee]*b[ee];return $[$.length-1]=H,$}function J(H){return H&&H.then&&typeof H.then=="function"}const Y="tfjsflags";class P{constructor(_){this.global=_,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=U$1,this.populateURLFlags()}setPlatform(_,b){this.platform!=null&&(qM().getBool("IS_TEST")||qM().getBool("PROD")||console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+_+".")),this.platformName=_,this.platform=b}registerFlag(_,b,$){if(this.flagRegistry[_]={evaluationFn:b,setHook:$},this.urlFlags[_]!=null){const ee=this.urlFlags[_];qM().getBool("IS_TEST")||qM().getBool("PROD")||console.warn("Setting feature override from URL "+_+": "+ee+"."),this.set(_,ee)}}async getAsync(_){return _ in this.flags?this.flags[_]:(this.flags[_]=await this.evaluateFlag(_),this.flags[_])}get(_){if(_ in this.flags)return this.flags[_];const b=this.evaluateFlag(_);if(J(b))throw new Error("Flag "+_+" cannot be synchronously evaluated. Please use getAsync() instead.");return this.flags[_]=b,this.flags[_]}getNumber(_){return this.get(_)}getBool(_){return this.get(_)}getString(_){return this.get(_)}getFlags(){return this.flags}get features(){return this.flags}set(_,b){if(this.flagRegistry[_]==null)throw new Error("Cannot set flag "+_+" as it has not been registered.");this.flags[_]=b,this.flagRegistry[_].setHook!=null&&this.flagRegistry[_].setHook(b)}evaluateFlag(_){if(this.flagRegistry[_]==null)throw new Error("Cannot evaluate flag '"+_+"': no evaluation function found.");return this.flagRegistry[_].evaluationFn()}setFlags(_){this.flags=Object.assign({},_)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const _=this.getQueryParams(this.global.location.search);Y in _&&_[Y].split(",").forEach(b=>{const[$,ee]=b.split(":");this.urlFlags[$]=qq($,ee)})}}function U$1(H){const _={};return H.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(b,...$)=>(q6(_,$[0],$[1]),$.join("="))),_}function q6(H,_,b){H[decodeURIComponent(_)]=decodeURIComponent(b||"")}function qq(H,_){const b=_.toLowerCase();return b==="true"||b==="false"?b==="true":""+ +b===b?+b:_}function qM(){return qF}let qF=null;function qW(H){qF=H}let qD;function qa(){if(qD==null){let H;if(typeof window<"u")H=window;else if(typeof global<"u")H=global;else if(typeof process<"u")H=process;else if(typeof self<"u")H=self;else throw new Error("Could not find a global object");qD=H}return qD}function qZ(){const H=qa();return H._tfGlobals==null&&(H._tfGlobals=new Map),H._tfGlobals}function qz(H,_){const b=qZ();if(b.has(H))return b.get(H);{const $=_();return b.set(H,$),b.get(H)}}const qX="Abs",qG="Add",qj="AddN",qL="Atan2",qR="AvgPool",qo="BatchMatMul",qQ="Bincount",qH="Cast",qK="ClipByValue",qB="Complex",qV="ComplexAbs",qJ="Concat",qY="Conv2D",qP="Conv2DBackpropFilter",qU="Conv2DBackpropInput",nq="Cos",nn="CropAndResize",ns="DepthToSpace",nM="DepthwiseConv2dNative",nF="DepthwiseConv2dNativeBackpropFilter",nt="DepthwiseConv2dNativeBackpropInput",nW="RealDiv",ni="Einsum",nD="Elu",nZ="ExpandDims",ne="Fill",nz="FlipLeftRight",nX="Floor",nG="FloorDiv",nu="GatherV2",nj="Greater",nL="GreaterEqual",no="Identity",nQ="Imag",nH="LeakyRelu",nK="Less",nB="LessEqual",nV="LogicalAnd",nJ="LogicalOr",nY="Max",nP="Maximum",nU="MaxPool",p1="Mean",pq="Min",pM="Minimum",pF="Multiply",pt="Neg",pW="NonMaxSuppressionV3",pD="NonMaxSuppressionV4",pa="NonMaxSuppressionV5",pZ="Pack",pe="PadV2",pz="Pow",pX="Prelu",pG="Range",pu="Real",pj="Relu",pL="Reshape",po="ResizeNearestNeighbor",pr="ResizeBilinear",pQ="Relu6",pH="Round",pK="TensorScatterUpdate",pB="Select",pV="Slice",pJ="Sin",pY="Sigmoid",pP="Sqrt",pU="Sum",gq="SplitV",gn="Square",gs="StridedSlice",gM="Sub",gF="Tile",gW="Transform",gD="Transpose",ga="Unpack",gZ="ZerosLike",ge="Step",gz="FromPixels",gX="RotateWithOffset",gG="_FusedMatMul",gu="FusedConv2D",gj="FusedDepthwiseConv2D";function gL(...H){qM().getBool("IS_TEST")||qM().getBool("PROD")||console.warn(...H)}function gQ(...H){qM().getBool("IS_TEST")||qM().getBool("PROD")||console.log(...H)}const gH=qz("kernelRegistry",()=>new Map),gK=qz("gradRegistry",()=>new Map);function gB(H,_){const b=gP(H,_);return gH.get(b)}function gV(H){return gK.get(H)}function gJ(H){const _=gH.entries(),b=[];for(;;){const{done:$,value:ee}=_.next();if($)break;const[re,ae]=ee,[xe]=re.split("_");xe===H&&b.push(ae)}return b}function gY(H){const{kernelName:_,backendName:b}=H,$=gP(_,b);gH.has($)&&gL("The kernel '"+_+"' for backend '"+b+"' is already registered"),gH.set($,H)}function gP(H,_){return _+"_"+H}function gU(H){return H instanceof Float32Array||H instanceof Int32Array||H instanceof Uint8Array||H instanceof Uint8ClampedArray}var xq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xs(H){return H&&H.__esModule&&Object.prototype.hasOwnProperty.call(H,"default")?H.default:H}var xM=xt,xF=null;try{xF=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(H){}function xt(H,_,b){this.low=H|0,this.high=_|0,this.unsigned=!!b}xt.prototype.__isLong__,Object.defineProperty(xt.prototype,"__isLong__",{value:!0});function xW(H){return(H&&H.__isLong__)===!0}xt.isLong=xW;var xD={},xZ={};function xz(H,_){var b,$,ee;return _?(H>>>=0,(ee=0<=H&&H<256)&&($=xZ[H],$)?$:(b=xG(H,(H|0)<0?-1:0,!0),ee&&(xZ[H]=b),b)):(H|=0,(ee=-128<=H&&H<128)&&($=xD[H],$)?$:(b=xG(H,H<0?-1:0,!1),ee&&(xD[H]=b),b))}xt.fromInt=xz;function xX(H,_){if(isNaN(H))return _?xP:xY;if(_){if(H<0)return xP;if(H>=xB)return st}else{if(H<=-9223372036854776e3)return sW;if(H+1>=xV)return sF}return H<0?xX(-H,_).neg():xG(H%xK|0,H/xK|0,_)}xt.fromNumber=xX;function xG(H,_,b){return new xt(H,_,b)}xt.fromBits=xG;var xu=Math.pow;function xj(H,_,b){if(H.length===0)throw Error("empty string");if(H==="NaN"||H==="Infinity"||H==="+Infinity"||H==="-Infinity")return xY;if(typeof _=="number"?(b=_,_=!1):_=!!_,b=b||10,b<2||36<b)throw RangeError("radix");var $;if(($=H.indexOf("-"))>0)throw Error("interior hyphen");if($===0)return xj(H.substring(1),_,b).neg();for(var ee=xX(xu(b,8)),re=xY,ae=0;ae<H.length;ae+=8){var xe=Math.min(8,H.length-ae),le=parseInt(H.substring(ae,ae+xe),b);if(xe<8){var fe=xX(xu(b,xe));re=re.mul(fe).add(xX(le))}else re=re.mul(ee),re=re.add(xX(le))}return re.unsigned=_,re}xt.fromString=xj;function xL(H,_){return typeof H=="number"?xX(H,_):typeof H=="string"?xj(H,_):xG(H.low,H.high,typeof _=="boolean"?_:H.unsigned)}xt.fromValue=xL;var xQ=65536,xH=1<<24,xK=xQ*xQ,xB=xK*xK,xV=xB/2,xJ=xz(xH),xY=xz(0);xt.ZERO=xY;var xP=xz(0,!0);xt.UZERO=xP;var xU=xz(1);xt.ONE=xU;var sq=xz(1,!0);xt.UONE=sq;var sM=xz(-1);xt.NEG_ONE=sM;var sF=xG(-1,2147483647,!1);xt.MAX_VALUE=sF;var st=xG(-1,-1,!0);xt.MAX_UNSIGNED_VALUE=st;var sW=xG(0,-2147483648,!1);xt.MIN_VALUE=sW;var sD=xt.prototype;sD.toInt=function(){return this.unsigned?this.low>>>0:this.low},sD.toNumber=function(){return this.unsigned?(this.high>>>0)*xK+(this.low>>>0):this.high*xK+(this.low>>>0)},sD.toString=function(H){if(H=H||10,H<2||36<H)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(sW)){var _=xX(H),b=this.div(_),$=b.mul(_).sub(this);return b.toString(H)+$.toInt().toString(H)}else return"-"+this.neg().toString(H);for(var ee=xX(xu(H,6),this.unsigned),re=this,ae="";;){var xe=re.div(ee),le=re.sub(xe.mul(ee)).toInt()>>>0,fe=le.toString(H);if(re=xe,re.isZero())return fe+ae;for(;fe.length<6;)fe="0"+fe;ae=""+fe+ae}},sD.getHighBits=function(){return this.high},sD.getHighBitsUnsigned=function(){return this.high>>>0},sD.getLowBits=function(){return this.low},sD.getLowBitsUnsigned=function(){return this.low>>>0},sD.getNumBitsAbs=function(){if(this.isNegative())return this.eq(sW)?64:this.neg().getNumBitsAbs();for(var H=this.high!=0?this.high:this.low,_=31;_>0&&(H&1<<_)==0;_--);return this.high!=0?_+33:_+1},sD.isZero=function(){return this.high===0&&this.low===0},sD.eqz=sD.isZero,sD.isNegative=function(){return!this.unsigned&&this.high<0},sD.isPositive=function(){return this.unsigned||this.high>=0},sD.isOdd=function(){return(this.low&1)===1},sD.isEven=function(){return(this.low&1)===0},sD.equals=function(H){return xW(H)||(H=xL(H)),this.unsigned!==H.unsigned&&this.high>>>31===1&&H.high>>>31===1?!1:this.high===H.high&&this.low===H.low},sD.eq=sD.equals,sD.notEquals=function(H){return!this.eq(H)},sD.neq=sD.notEquals,sD.ne=sD.notEquals,sD.lessThan=function(H){return this.comp(H)<0},sD.lt=sD.lessThan,sD.lessThanOrEqual=function(H){return this.comp(H)<=0},sD.lte=sD.lessThanOrEqual,sD.le=sD.lessThanOrEqual,sD.greaterThan=function(H){return this.comp(H)>0},sD.gt=sD.greaterThan,sD.greaterThanOrEqual=function(H){return this.comp(H)>=0},sD.gte=sD.greaterThanOrEqual,sD.ge=sD.greaterThanOrEqual,sD.compare=function(H){if(xW(H)||(H=xL(H)),this.eq(H))return 0;var _=this.isNegative(),b=H.isNegative();return _&&!b?-1:!_&&b?1:this.unsigned?H.high>>>0>this.high>>>0||H.high===this.high&&H.low>>>0>this.low>>>0?-1:1:this.sub(H).isNegative()?-1:1},sD.comp=sD.compare,sD.negate=function(){return!this.unsigned&&this.eq(sW)?sW:this.not().add(xU)},sD.neg=sD.negate,sD.add=function(H){xW(H)||(H=xL(H));var _=this.high>>>16,b=this.high&65535,$=this.low>>>16,ee=this.low&65535,re=H.high>>>16,ae=H.high&65535,xe=H.low>>>16,le=H.low&65535,fe=0,ve=0,Se=0,Ee=0;return Ee+=ee+le,Se+=Ee>>>16,Ee&=65535,Se+=$+xe,ve+=Se>>>16,Se&=65535,ve+=b+ae,fe+=ve>>>16,ve&=65535,fe+=_+re,fe&=65535,xG(Se<<16|Ee,fe<<16|ve,this.unsigned)},sD.subtract=function(H){return xW(H)||(H=xL(H)),this.add(H.neg())},sD.sub=sD.subtract,sD.multiply=function(H){if(this.isZero())return xY;if(xW(H)||(H=xL(H)),xF){var _=xF.mul(this.low,this.high,H.low,H.high);return xG(_,xF.get_high(),this.unsigned)}if(H.isZero())return xY;if(this.eq(sW))return H.isOdd()?sW:xY;if(H.eq(sW))return this.isOdd()?sW:xY;if(this.isNegative())return H.isNegative()?this.neg().mul(H.neg()):this.neg().mul(H).neg();if(H.isNegative())return this.mul(H.neg()).neg();if(this.lt(xJ)&&H.lt(xJ))return xX(this.toNumber()*H.toNumber(),this.unsigned);var b=this.high>>>16,$=this.high&65535,ee=this.low>>>16,re=this.low&65535,ae=H.high>>>16,xe=H.high&65535,le=H.low>>>16,fe=H.low&65535,ve=0,Se=0,Ee=0,Ce=0;return Ce+=re*fe,Ee+=Ce>>>16,Ce&=65535,Ee+=ee*fe,Se+=Ee>>>16,Ee&=65535,Ee+=re*le,Se+=Ee>>>16,Ee&=65535,Se+=$*fe,ve+=Se>>>16,Se&=65535,Se+=ee*le,ve+=Se>>>16,Se&=65535,Se+=re*xe,ve+=Se>>>16,Se&=65535,ve+=b*fe+$*le+ee*xe+re*ae,ve&=65535,xG(Ee<<16|Ce,ve<<16|Se,this.unsigned)},sD.mul=sD.multiply,sD.divide=function(H){if(xW(H)||(H=xL(H)),H.isZero())throw Error("division by zero");if(xF){if(!this.unsigned&&this.high===-2147483648&&H.low===-1&&H.high===-1)return this;var _=(this.unsigned?xF.div_u:xF.div_s)(this.low,this.high,H.low,H.high);return xG(_,xF.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?xP:xY;var b,$,ee;if(this.unsigned){if(H.unsigned||(H=H.toUnsigned()),H.gt(this))return xP;if(H.gt(this.shru(1)))return sq;ee=xP}else{if(this.eq(sW)){if(H.eq(xU)||H.eq(sM))return sW;if(H.eq(sW))return xU;var re=this.shr(1);return b=re.div(H).shl(1),b.eq(xY)?H.isNegative()?xU:sM:($=this.sub(H.mul(b)),ee=b.add($.div(H)),ee)}else if(H.eq(sW))return this.unsigned?xP:xY;if(this.isNegative())return H.isNegative()?this.neg().div(H.neg()):this.neg().div(H).neg();if(H.isNegative())return this.div(H.neg()).neg();ee=xY}for($=this;$.gte(H);){b=Math.max(1,Math.floor($.toNumber()/H.toNumber()));for(var ae=Math.ceil(Math.log(b)/Math.LN2),xe=ae<=48?1:xu(2,ae-48),le=xX(b),fe=le.mul(H);fe.isNegative()||fe.gt($);)b-=xe,le=xX(b,this.unsigned),fe=le.mul(H);le.isZero()&&(le=xU),ee=ee.add(le),$=$.sub(fe)}return ee},sD.div=sD.divide,sD.modulo=function(H){if(xW(H)||(H=xL(H)),xF){var _=(this.unsigned?xF.rem_u:xF.rem_s)(this.low,this.high,H.low,H.high);return xG(_,xF.get_high(),this.unsigned)}return this.sub(this.div(H).mul(H))},sD.mod=sD.modulo,sD.rem=sD.modulo,sD.not=function(){return xG(~this.low,~this.high,this.unsigned)},sD.and=function(H){return xW(H)||(H=xL(H)),xG(this.low&H.low,this.high&H.high,this.unsigned)},sD.or=function(H){return xW(H)||(H=xL(H)),xG(this.low|H.low,this.high|H.high,this.unsigned)},sD.xor=function(H){return xW(H)||(H=xL(H)),xG(this.low^H.low,this.high^H.high,this.unsigned)},sD.shiftLeft=function(H){return xW(H)&&(H=H.toInt()),(H&=63)===0?this:H<32?xG(this.low<<H,this.high<<H|this.low>>>32-H,this.unsigned):xG(0,this.low<<H-32,this.unsigned)},sD.shl=sD.shiftLeft,sD.shiftRight=function(H){return xW(H)&&(H=H.toInt()),(H&=63)===0?this:H<32?xG(this.low>>>H|this.high<<32-H,this.high>>H,this.unsigned):xG(this.high>>H-32,this.high>=0?0:-1,this.unsigned)},sD.shr=sD.shiftRight,sD.shiftRightUnsigned=function(H){if(xW(H)&&(H=H.toInt()),H&=63,H===0)return this;var _=this.high;if(H<32){var b=this.low;return xG(b>>>H|_<<32-H,_>>>H,this.unsigned)}else return H===32?xG(_,0,this.unsigned):xG(_>>>H-32,0,this.unsigned)},sD.shru=sD.shiftRightUnsigned,sD.shr_u=sD.shiftRightUnsigned,sD.toSigned=function(){return this.unsigned?xG(this.low,this.high,!1):this},sD.toUnsigned=function(){return this.unsigned?this:xG(this.low,this.high,!0)},sD.toBytes=function(H){return H?this.toBytesLE():this.toBytesBE()},sD.toBytesLE=function(){var H=this.high,_=this.low;return[_&255,_>>>8&255,_>>>16&255,_>>>24,H&255,H>>>8&255,H>>>16&255,H>>>24]},sD.toBytesBE=function(){var H=this.high,_=this.low;return[H>>>24,H>>>16&255,H>>>8&255,H&255,_>>>24,_>>>16&255,_>>>8&255,_&255]},xt.fromBytes=function(H,_,b){return b?xt.fromBytesLE(H,_):xt.fromBytesBE(H,_)},xt.fromBytesLE=function(H,_){return new xt(H[0]|H[1]<<8|H[2]<<16|H[3]<<24,H[4]|H[5]<<8|H[6]<<16|H[7]<<24,_)},xt.fromBytesBE=function(H,_){return new xt(H[4]<<24|H[5]<<16|H[6]<<8|H[7],H[0]<<24|H[1]<<16|H[2]<<8|H[3],_)};var sZ=xs(xM),se=q$1({__proto__:null,default:sZ},[xM]);const sz=sZ||se;function sX(H){return sz.fromString(H,!0,16)}const sG=sX("c3a5c85c97cb3127"),su=sX("b492b66fbe98f273"),sj=sX("9ae16a3b2f90404f");function sL(H){return H.xor(H.shru(47))}function so(H,_,b){const $=H.slice(_,_+b);return sz.fromBytes(Array.from($),!0,!0)}function sr(H,_){return so(H,_,8)}function sQ(H,_){return so(H,_,4)}function sH(H,_){return _===0?H:H.shru(_).or(H.shl(64-_))}function sK(H,_,b=sX("9ddfea08eb382d69")){let $=H.xor(_).mul(b);$=$.xor($.shru(47));let ee=_.xor($).mul(b);return ee=ee.xor(ee.shru(47)),ee=ee.mul(b),ee}function sB(H,_,b,$,ee,re){ee=ee.add(H),re=sH(re.add(ee).add($),21);const ae=ee;return ee=ee.add(_),ee=ee.add(b),re=re.add(sH(ee,44)),[ee.add($),re.add(ae)]}function sV(H,_,b,$){return sB(sr(H,_),sr(H,_+8),sr(H,_+16),sr(H,_+24),b,$)}function sJ(H,_=H.length){if(_>=8){const b=sj.add(_*2),$=sr(H,0).add(sj),ee=sr(H,_-8),re=sH(ee,37).mul(b).add($),ae=sH($,25).add(ee).mul(b);return sK(re,ae,b)}if(_>=4){const b=sj.add(_*2),$=sQ(H,0);return sK($.shl(3).add(_),sQ(H,_-4),b)}if(_>0){const b=H[0],$=H[_>>1],ee=H[_-1],re=b+($<<8),ae=_+(ee<<2);return sL(sj.mul(re).xor(sG.mul(ae))).mul(sj)}return sj}function sY(H,_=H.length){const b=sj.add(_*2),$=sr(H,0).mul(su),ee=sr(H,8),re=sr(H,_-8).mul(b),ae=sr(H,_-16).mul(sj);return sK(sH($.add(ee),43).add(sH(re,30)).add(ae),$.add(sH(ee.add(sj),18)).add(re),b)}function sP(H,_=H.length){const b=sj.add(_*2),$=sr(H,0).mul(sj),ee=sr(H,8),re=sr(H,_-8).mul(b),ae=sr(H,_-16).mul(sj),xe=sH($.add(ee),43).add(sH(re,30)).add(ae),le=sK(xe,$.add(sH(ee.add(sj),18)).add(re),b),fe=sr(H,16).mul(b),ve=sr(H,24),Se=xe.add(sr(H,_-32)).mul(b),Ee=le.add(sr(H,_-24)).mul(b);return sK(sH(fe.add(ve),43).add(sH(Se,30)).add(Ee),fe.add(sH(ve.add($),18)).add(Se),b)}function sU(H,_=H.length){const b=sz.fromNumber(81,!0);if(_<=32)return _<=16?sJ(H,_):sY(H,_);if(_<=64)return sP(H,_);let $=b,ee=b.mul(su).add(113),re=sL(ee.mul(sj).add(113)).mul(sj),ae=[sz.UZERO,sz.UZERO],xe=[sz.UZERO,sz.UZERO];$=$.mul(sj).add(sr(H,0));let le=0;const fe=(_-1>>6)*64,ve=fe+(_-1&63)-63;do $=sH($.add(ee).add(ae[0]).add(sr(H,le+8)),37).mul(su),ee=sH(ee.add(ae[1]).add(sr(H,le+48)),42).mul(su),$=$.xor(xe[1]),ee=ee.add(ae[0]).add(sr(H,le+40)),re=sH(re.add(xe[0]),33).mul(su),ae=sV(H,le,ae[1].mul(su),$.add(xe[0])),xe=sV(H,le+32,re.add(xe[1]),ee.add(sr(H,le+16))),[re,$]=[$,re],le+=64;while(le!==fe);const Se=su.add(re.and(255).shl(1));return le=ve,xe[0]=xe[0].add(_-1&63),ae[0]=ae[0].add(xe[0]),xe[0]=xe[0].add(ae[0]),$=sH($.add(ee).add(ae[0]).add(sr(H,le+8)),37).mul(Se),ee=sH(ee.add(ae[1]).add(sr(H,le+48)),42).mul(Se),$=$.xor(xe[1].mul(9)),ee=ee.add(ae[0].mul(9).add(sr(H,le+40))),re=sH(re.add(xe[0]),33).mul(Se),ae=sV(H,le,ae[1].mul(Se),$.add(xe[0])),xe=sV(H,le+32,re.add(xe[1]),ee.add(sr(H,le+16))),[re,$]=[$,re],sK(sK(ae[0],xe[0],Se).add(sL(ee).mul(sG)).add(re),sK(ae[1],xe[1],Se).add($),Se)}function Eq(H,_){return _==="string"?Et(H):EM([H],_)}function En(H,_){return H instanceof Float32Array&&_==="float32"||H instanceof Int32Array&&_==="int32"||H instanceof Uint8Array&&_==="bool"}function EM(H,_){if(_==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(H)&&(H=EZ(H)),qM().getBool("DEBUG")&&N$1(H,_),En(H,_))return H;if(_==null||_==="float32"||_==="complex64")return new Float32Array(H);if(_==="int32")return new Int32Array(H);if(_==="bool"){const b=new Uint8Array(H.length);for(let $=0;$<b.length;++$)Math.round(H[$])!==0&&(b[$]=1);return b}else throw new Error("Unknown data type "+_)}function EF(){return qM().platform.now()}function Et(H,_="utf-8"){return _=_||"utf-8",qM().platform.encode(H,_)}function EW(H,_="utf-8"){return _=_||"utf-8",qM().platform.decode(H,_)}function ED(H){return qM().platform.isTypedArray!=null?qM().platform.isTypedArray(H):gU(H)}function EZ(H,_=[],b=!1){if(_==null&&(_=[]),typeof H=="boolean"||typeof H=="number"||typeof H=="string"||J(H)||H==null||ED(H)&&b)_.push(H);else if(Array.isArray(H)||ED(H))for(let $=0;$<H.length;++$)EZ(H[$],_,b);else{let $=-1;for(const ee of Object.keys(H))/^([1-9]+[0-9]*|0)$/.test(ee)&&($=Math.max($,Number(ee)));for(let ee=0;ee<=$;ee++)EZ(H[ee],_,b)}return _}class Ez{constructor(_,b){this.backendTimer=_,this.logger=b,b==null&&(this.logger=new EG)}profileKernel(_,b,$){let ee;const re=()=>{ee=$()};let ae;const xe=EF();if(this.backendTimer.timerAvailable())ae=this.backendTimer.time(re);else{re();for(const le of ee)le.dataSync();ae=Promise.resolve({kernelMs:EF()-xe})}if(qM().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let le=0;le<ee.length;le++){const fe=ee[le];fe.data().then(ve=>{EX(ve,fe.dtype,_)})}return{kernelName:_,outputs:ee,inputs:b,timeMs:ae.then(le=>le.kernelMs),extraInfo:ae.then(le=>le.getExtraProfileInfo!=null?le.getExtraProfileInfo():"")}}logKernelProfile(_){const{kernelName:b,outputs:$,timeMs:ee,inputs:re,extraInfo:ae}=_;$.forEach(xe=>{Promise.all([xe.data(),ee,ae]).then(le=>{this.logger.logKernelProfile(b,xe,le[0],le[1],re,le[2])})})}}function EX(H,_,b){if(_!=="float32")return!1;for(let $=0;$<H.length;$++){const ee=H[$];if(isNaN(ee)||!isFinite(ee))return console.warn("Found "+ee+" in the result of '"+b+"'"),!0}return!1}class EG{logKernelProfile(_,b,$,ee,re,ae){const xe=typeof ee=="number"?Z$1(ee+"ms",9):ee.error,le=Z$1(_,25),fe=b.rank,ve=b.size,Se=Z$1(b.shape.toString(),14);let Ee="";for(const Ce in re){const Ie=re[Ce];if(Ie!=null){const De=Ie.shape||b.shape,Be=De.length;Ee+=Ce+": "+Be+"D "+(Be>0?De:"")+" "}}console.log("%c"+le+"	%c"+xe+"	%c"+fe+"D "+Se+"	%c"+ve+"	%c"+Ee+"	%c"+ae,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function Eu(H,_,b){const $={},ee={};for(let le=0;le<_.length;le++)$[_[le].id]=!0;for(let le=0;le<H.length;le++){const fe=H[le],ve=fe.inputs;for(const Se in ve){const Ee=ve[Se];let Ce=!1;for(let Ie=0;Ie<_.length;Ie++)if($[Ee.id]){fe.outputs.forEach(De=>$[De.id]=!0),Ce=!0,ee[fe.id]=!0;break}if(Ce)break}}const re={};re[b.id]=!0;const ae={};for(let le=H.length-1;le>=0;le--){const fe=H[le],ve=fe.inputs;for(let Se=0;Se<fe.outputs.length;Se++)if(re[fe.outputs[Se].id]){for(const Ee in ve)re[ve[Ee].id]=!0,ae[fe.id]=!0;break}}const xe=[];for(let le=0;le<H.length;le++){const fe=H[le];if(ee[fe.id]&&ae[fe.id]){const ve={};for(const Ee in fe.inputs){const Ce=fe.inputs[Ee];$[Ce.id]&&(ve[Ee]=Ce)}const Se=Object.assign({},fe);Se.inputs=ve,Se.outputs=fe.outputs,xe.push(Se)}}return xe}function Ej(H,_,b,$){for(let ee=_.length-1;ee>=0;ee--){const re=_[ee],ae=[];if(re.outputs.forEach(le=>{const fe=H[le.id];fe!=null?ae.push(fe):ae.push(null)}),re.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+re.kernelName+".");const xe=re.gradient(ae);for(const le in re.inputs){if(!(le in xe))throw new Error("Cannot backprop through input "+le+". Available gradients found: "+Object.keys(xe)+".");const fe=b(()=>xe[le]());if(fe.dtype!=="float32")throw new Error("Error in gradient for op "+re.kernelName+". The gradient of input "+le+" must have 'float32' dtype, but has '"+fe.dtype+"'");const ve=re.inputs[le];if(!D(fe.shape,ve.shape))throw new Error("Error in gradient for op "+re.kernelName+". The gradient of input '"+le+"' has shape '"+fe.shape+"', which does not match the shape of the input '"+ve.shape+"'");if(H[ve.id]==null)H[ve.id]=fe;else{const Se=H[ve.id];H[ve.id]=$(Se,fe),Se.dispose()}}}}const EL=20,EQ=3,EH=7;function EK(H,_,b,$){const ee=y(_),re=EB(H,_,b,ee),ae=_.length,xe=EY(H,_,b,ee,re),le=["Tensor"];return $&&(le.push("  dtype: "+b),le.push("  rank: "+ae),le.push("  shape: ["+_+"]"),le.push("  values:")),le.push(xe.map(fe=>"    "+fe).join(`
`)),le.join(`
`)}function EB(H,_,b,$){const ee=i$1(_),re=$[$.length-1],ae=new Array(re).fill(0),xe=_.length,le=b==="complex64"?EP(H):H;if(xe>1)for(let fe=0;fe<ee/re;fe++){const ve=fe*re;for(let Se=0;Se<re;Se++)ae[Se]=Math.max(ae[Se],EV(le[ve+Se],0,b).length)}return ae}function EV(H,_,b){let $;return Array.isArray(H)?$=parseFloat(H[0].toFixed(EH))+" + "+parseFloat(H[1].toFixed(EH))+"j":R$1(H)?$="'"+H+"'":b==="bool"?$=EJ(H):$=parseFloat(H.toFixed(EH)).toString(),Z$1($,_)}function EJ(H){return H===0?"false":"true"}function EY(H,_,b,$,ee,re=!0){const ae=b==="complex64"?2:1,xe=_[0],le=_.length;if(le===0){if(b==="complex64"){const De=EP(H);return[EV(De[0],0,b)]}return b==="bool"?[EJ(H[0])]:[H[0].toString()]}if(le===1){if(xe>EL){const De=EQ*ae;let Be=Array.from(H.slice(0,De)),Ne=Array.from(H.slice((xe-EQ)*ae,xe*ae));return b==="complex64"&&(Be=EP(Be),Ne=EP(Ne)),["["+Be.map((qe,Xe)=>EV(qe,ee[Xe],b)).join(", ")+", ..., "+Ne.map((qe,Xe)=>EV(qe,ee[xe-EQ+Xe],b)).join(", ")+"]"]}return["["+(b==="complex64"?EP(H):Array.from(H)).map((De,Be)=>EV(De,ee[Be],b)).join(", ")+"]"]}const fe=_.slice(1),ve=$.slice(1),Se=$[0]*ae,Ee=[];if(xe>EL){for(let De=0;De<EQ;De++){const Be=De*Se,Ne=Be+Se;Ee.push(...EY(H.slice(Be,Ne),fe,b,ve,ee,!1))}Ee.push("...");for(let De=xe-EQ;De<xe;De++){const Be=De*Se,Ne=Be+Se;Ee.push(...EY(H.slice(Be,Ne),fe,b,ve,ee,De===xe-1))}}else for(let De=0;De<xe;De++){const Be=De*Se,Ne=Be+Se;Ee.push(...EY(H.slice(Be,Ne),fe,b,ve,ee,De===xe-1))}const Ce=le===2?",":"";Ee[0]="["+(xe>0?Ee[0]+Ce:"");for(let De=1;De<Ee.length-1;De++)Ee[De]=" "+Ee[De]+Ce;let Ie=`,
`;for(let De=2;De<le;De++)Ie+=`
`;return Ee[Ee.length-1]=" "+Ee[Ee.length-1]+"]"+(re?"":Ie),Ee}function EP(H){const _=[];for(let b=0;b<H.length;b+=2)_.push([H[b],H[b+1]]);return _}class EU{constructor(_,b,$){if(this.dtype=b,this.shape=_.slice(),this.size=i$1(_),$!=null){const ee=$.length;k(ee===this.size,()=>"Length of values '"+ee+"' does not match the size inferred by the shape '"+this.size+"'.")}if(b==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=$||G(b,this.size),this.strides=y(_)}set(_,...b){b.length===0&&(b=[0]),k(b.length===this.rank,()=>"The number of provided coordinates ("+b.length+") must match the rank ("+this.rank+")");const $=this.locToIndex(b);this.values[$]=_}get(..._){_.length===0&&(_=[0]);let b=0;for(const ee of _){if(ee<0||ee>=this.shape[b]){const re="Requested out of range element at "+_+".   Buffer shape="+this.shape;throw new Error(re)}b++}let $=_[_.length-1];for(let ee=0;ee<_.length-1;++ee)$+=this.strides[ee]*_[ee];return this.values[$]}locToIndex(_){if(this.rank===0)return 0;if(this.rank===1)return _[0];let b=_[_.length-1];for(let $=0;$<_.length-1;++$)b+=this.strides[$]*_[$];return b}indexToLoc(_){if(this.rank===0)return[];if(this.rank===1)return[_];const b=new Array(this.shape.length);for(let $=0;$<b.length-1;++$)b[$]=Math.floor(_/this.strides[$]),_-=b[$]*this.strides[$];return b[b.length-1]=_,b}get rank(){return this.shape.length}toTensor(){return Mq().makeTensor(this.values,this.shape,this.dtype)}}let Mq=null,Mn=null;function Ms(H){Mq=H}function MM(H){Mn=H}class MF{constructor(_,b,$,ee){this.kept=!1,this.isDisposedInternal=!1,this.shape=_.slice(),this.dtype=b||"float32",this.size=i$1(_),this.strides=y(_),this.dataId=$,this.id=ee,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const _=await this.data();return Mn.buffer(this.shape,this.dtype,_)}bufferSync(){return Mn.buffer(this.shape,this.dtype,this.dataSync())}async array(){const _=await this.data();return l$1(this.shape,_,this.dtype==="complex64")}arraySync(){return l$1(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const _=Mq().read(this.dataId);if(this.dtype==="string"){const b=await _;try{return b.map($=>EW($))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return _}dataToGPU(_){return this.throwIfDisposed(),Mq().readToGPU(this.dataId,_)}dataSync(){this.throwIfDisposed();const _=Mq().readSync(this.dataId);if(this.dtype==="string")try{return _.map(b=>EW(b))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return _}async bytes(){this.throwIfDisposed();const _=await Mq().read(this.dataId);return this.dtype==="string"?_:new Uint8Array(_.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Mq().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(_=!1){return Mn.print(this,_)}clone(){return this.throwIfDisposed(),Mn.clone(this)}toString(_=!1){const b=this.dataSync();return EK(b,this.shape,this.dtype,_)}cast(_){return this.throwIfDisposed(),Mn.cast(this,_)}variable(_=!0,b,$){return this.throwIfDisposed(),Mq().makeVariable(this,_,b,$)}}Object.defineProperty(MF,Symbol.hasInstance,{value:H=>!!H&&H.data!=null&&H.dataSync!=null&&H.throwIfDisposed!=null});function MW(){return qz("Tensor",()=>MF)}MW();class MD extends MF{constructor(_,b,$,ee){super(_.shape,_.dtype,_.dataId,ee),this.trainable=b,this.name=$}assign(_){if(_.dtype!==this.dtype)throw new Error("dtype of the new value ("+_.dtype+") and previous value ("+this.dtype+") must match");if(!D(_.shape,this.shape))throw new Error("shape of the new value ("+_.shape+") and previous value ("+this.shape+") must match");Mq().disposeTensor(this),this.dataId=_.dataId,Mq().incRef(this,null)}dispose(){Mq().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(MD,Symbol.hasInstance,{value:H=>H instanceof MF&&H.assign!=null&&H.assign instanceof Function});var MZ;(function(H){H.R0="R0",H.R1="R1",H.R2="R2",H.R3="R3",H.R4="R4",H.R5="R5",H.R6="R6"})(MZ||(MZ={}));var Me;(function(H){H.float32="float32",H.int32="int32",H.bool="int32",H.complex64="complex64"})(Me||(Me={}));var Mz;(function(H){H.float32="float32",H.int32="int32",H.bool="bool",H.complex64="complex64"})(Mz||(Mz={}));var MX;(function(H){H.float32="float32",H.int32="float32",H.bool="float32",H.complex64="complex64"})(MX||(MX={}));var MG;(function(H){H.float32="complex64",H.int32="complex64",H.bool="complex64",H.complex64="complex64"})(MG||(MG={}));const Mj={float32:MX,int32:Me,bool:Mz,complex64:MG};function ML(H,_){if(H==="string"||_==="string"){if(H==="string"&&_==="string")return"string";throw new Error("Can not upcast "+H+" with "+_)}return Mj[H][_]}function MR(H){return ML(H,"int32")}function MQ(H){return H!=null&&typeof H=="object"&&"texture"in H&&H.texture instanceof WebGLTexture}function MH(H){return typeof GPUBuffer<"u"&&H!=null&&typeof H=="object"&&"buffer"in H&&H.buffer instanceof GPUBuffer}function MK(H,_){if(H.dtype===_.dtype)return[H,_];const b=ML(H.dtype,_.dtype);return[H.cast(b),_.cast(b)]}function MB(H){const _=[];return MV(H,_,new Set),_}function MV(H,_,b){if(H==null)return;if(H instanceof MF){_.push(H);return}if(!MJ(H))return;const $=H;for(const ee in $){const re=$[ee];b.has(re)||(b.add(re),MV(re,_,b))}}function MJ(H){return Array.isArray(H)||typeof H=="object"}function MY(H){return H.kernelName!=null}class MP{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(_=>_.name)))}}}dispose(){for(const _ in this.registeredVariables)this.registeredVariables[_].dispose()}}class MU{constructor(_){this.ENV=_,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new MP}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const _=this.getSortedBackends();for(let b=0;b<_.length;b++){const $=_[b];if(await this.initializeBackend($).success){await this.setBackend($);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){const{name:_,asyncInit:b}=this.initializeBackendsAndReturnBest();if(b)throw new Error("The highest priority backend '"+_+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(_)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(_){if(!(_ in this.registry))if(_ in this.registryFactory){const{asyncInit:b}=this.initializeBackend(_);if(b)return null}else return null;return this.registry[_]}findBackendFactory(_){return _ in this.registryFactory?this.registryFactory[_].factory:null}registerBackend(_,b,$=1){return _ in this.registryFactory?(gL(_+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[_]={factory:b,priority:$},!0)}async setBackend(_){if(this.registryFactory[_]==null)throw new Error("Backend name '"+_+"' not found in registry");if(this.backendName=_,this.registry[_]==null){this.backendInstance=null;const{success:b,asyncInit:$}=this.initializeBackend(_);if(!($?await b:b))return!1}return this.backendInstance=this.registry[_],this.setupRegisteredKernels(),this.profiler=new Ez(this.backendInstance),!0}setupRegisteredKernels(){gJ(this.backendName).forEach(_=>{_.setupFunc!=null&&_.setupFunc(this.backendInstance)})}disposeRegisteredKernels(_){gJ(_).forEach(b=>{b.disposeFunc!=null&&b.disposeFunc(this.registry[_])})}initializeBackend(_){const b=this.registryFactory[_];if(b==null)throw new Error("Cannot initialize backend "+_+", no registration found.");try{const $=b.factory();if($&&!($ instanceof x$1)&&typeof $.then=="function"){const ee=++this.pendingBackendInitId,re=$.then(ae=>ee<this.pendingBackendInitId?!1:(this.registry[_]=ae,this.pendingBackendInit=null,!0)).catch(ae=>(ee<this.pendingBackendInitId||(this.pendingBackendInit=null,gL("Initialization of backend "+_+" failed"),gL(ae.stack||ae.message)),!1));return this.pendingBackendInit=re,{success:re,asyncInit:!0}}else return this.registry[_]=$,{success:!0,asyncInit:!1}}catch($){return gL("Initialization of backend "+_+" failed"),gL($.stack||$.message),{success:!1,asyncInit:!1}}}removeBackend(_){if(!(_ in this.registryFactory))throw new Error(_+" backend not found in registry");this.backendName===_&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,_ in this.registry&&(this.disposeRegisteredKernels(_),this.registry[_].dispose(),delete this.registry[_]),delete this.registryFactory[_],this.backendName===_&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((_,b)=>this.registryFactory[b].priority-this.registryFactory[_].priority)}initializeBackendsAndReturnBest(){const _=this.getSortedBackends();for(let b=0;b<_.length;b++){const $=_[b],{success:ee,asyncInit:re}=this.initializeBackend($);if(re||ee)return{name:$,asyncInit:re}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(_,b){const $=this.state.tensorInfo.get(b),ee=$.backend,re=this.readSync(b),ae=ee.refCount(b);ee.disposeData(b,!0),$.backend=_,_.move(b,re,$.shape,$.dtype,ae),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(_,b){let $=null;if(b==null){if(typeof _!="function")throw new Error("Please provide a function to tidy()");b=_}else{if(typeof _!="string"&&!(_ instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof b!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");$=_}let ee;return this.scopedRun(()=>this.startScope($),()=>this.endScope(ee),()=>(ee=b(),ee instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),ee))}scopedRun(_,b,$){_();try{const ee=$();return b(),ee}catch(ee){throw b(),ee}}nextTensorId(){return MU.nextTensorId++}nextVariableId(){return MU.nextVariableId++}clone(_){const b=fM.runKernel(no,{x:_}),$={x:_},ee=ae=>({x:()=>{const xe="float32",le={x:ae},fe={dtype:xe};return fM.runKernel(qH,le,fe)}}),re=[];return this.addTapeNode(this.state.activeScope.name,$,[b],ee,re,{}),b}runKernel(_,b,$){if(this.backendName==null&&this.backend,gB(_,this.backendName)==null)throw new Error("Kernel '"+_+"' not registered for backend '"+this.backendName+"'");return this.runKernelFunc({kernelName:_,inputs:b,attrs:$})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(_,b,$){const ee=this.backend.numDataIds();let re=0;$.forEach(le=>{re+=le.dtype==="complex64"?3:1});const ae=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],xe=ee-b-re-ae;if(xe>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+xe+" data ids) after running '"+_+"'")}runKernelFunc(_){let b,$=[];const ee=this.isTapeOn(),re=this.state.numBytes,ae=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let xe;this.backendName==null&&this.backend;let le;const fe=MY(_)?_.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(MY(_)){const{kernelName:Ie,inputs:De,attrs:Be}=_;this.backendName==null&&this.backend;const Ne=gB(Ie,this.backendName);k(Ne!=null,()=>"Cannot find registered kernel '"+Ie+"' for backend '"+this.backendName+"'"),xe=()=>{const qe=this.backend.numDataIds();le=Ne.kernelFunc({inputs:De,attrs:Be,backend:this.backend});const Xe=Array.isArray(le)?le:[le];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(Ie,qe,Xe);const Ye=Xe.map(Qe=>Qe.rank!=null?Qe:this.makeTensorFromTensorInfo(Qe));if(ee){const Qe=this.getTensorsForGradient(Ie,De,Ye);$=this.saveTensorsForBackwardMode(Qe)}return Ye}}else{const{forwardFunc:Ie}=_,De=Be=>{ee&&($=Be.map(Ne=>this.keep(this.clone(Ne))))};xe=()=>{const Be=this.backend.numDataIds();le=this.tidy(()=>Ie(this.backend,De));const Ne=Array.isArray(le)?le:[le];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(fe,Be,Ne),Ne}}const{inputs:ve,attrs:Se}=_,Ee=MY(_)?null:_.backwardsFunc;let Ce;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?b=xe():(Ce=this.profiler.profileKernel(fe,ve,()=>xe()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(Ce),b=Ce.outputs)}),ee&&this.addTapeNode(fe,ve,b,Ee,$,Se),this.state.profiling&&this.state.activeProfile.kernels.push({name:fe,bytesAdded:this.state.numBytes-re,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-ae,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(ve).map(Ie=>ve[Ie]!=null?ve[Ie].shape:null),outputShapes:b.map(Ie=>Ie.shape),kernelTimeMs:Ce.timeMs,extraInfo:Ce.extraInfo}),Array.isArray(le)?b:b[0]}saveTensorsForBackwardMode(_){return _.map(b=>this.keep(this.clone(b)))}getTensorsForGradient(_,b,$){const ee=gV(_);if(ee!=null){const re=ee.inputsToSave||[],ae=ee.outputsToSave||[];let xe;ee.saveAllInputs?(k(Array.isArray(b),()=>"saveAllInputs is true, expected inputs to be an array."),xe=Object.keys(b).map(fe=>b[fe])):xe=re.map(fe=>b[fe]);const le=$.filter((fe,ve)=>ae[ve]);return xe.concat(le)}return[]}makeTensor(_,b,$,ee){if(_==null)throw new Error("Values passed to engine.makeTensor() are null");$=$||"float32",ee=ee||this.backend;let re=_;$==="string"&&R$1(_[0])&&(re=_.map(le=>Et(le)));const ae=ee.write(re,b,$),xe=new MF(b,$,ae,this.nextTensorId());if(this.trackTensor(xe,ee),$==="string"){const le=this.state.tensorInfo.get(ae),fe=I$1(re);this.state.numBytes+=fe-le.bytes,le.bytes=fe}return xe}makeTensorFromDataId(_,b,$,ee){$=$||"float32";const re={dataId:_,shape:b,dtype:$};return this.makeTensorFromTensorInfo(re,ee)}makeTensorFromTensorInfo(_,b){const{dataId:$,shape:ee,dtype:re}=_,ae=new MF(ee,re,$,this.nextTensorId());return this.trackTensor(ae,b),ae}makeVariable(_,b=!0,$,ee){$=$||this.nextVariableId().toString(),ee!=null&&ee!==_.dtype&&(_=_.cast(ee));const re=new MD(_,b,$,this.nextTensorId());if(this.state.registeredVariables[re.name]!=null)throw new Error("Variable with name "+re.name+" was already registered");return this.state.registeredVariables[re.name]=re,this.incRef(re,this.backend),re}trackTensor(_,b){this.state.numTensors++,_.dtype==="string"&&this.state.numStringTensors++;let $=0;_.dtype!=="complex64"&&_.dtype!=="string"&&($=_.size*L(_.dtype)),this.state.numBytes+=$,this.state.tensorInfo.has(_.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(_.dataId,{backend:b||this.backend,dtype:_.dtype,shape:_.shape,bytes:$})),_ instanceof MD||this.track(_)}incRef(_,b){this.trackTensor(_,b),this.backend.incRef(_.dataId)}removeDataId(_,b){this.state.tensorInfo.has(_)&&this.state.tensorInfo.get(_).backend===b&&(this.state.tensorInfo.delete(_),this.state.numDataBuffers--)}disposeTensor(_){if(!this.state.tensorInfo.has(_.dataId))return;const b=this.state.tensorInfo.get(_.dataId);if(this.state.numTensors--,_.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=b.bytes),_.dtype!=="complex64"&&_.dtype!=="string"){const $=_.size*L(_.dtype);this.state.numBytes-=$}b.backend.disposeData(_.dataId)&&this.removeDataId(_.dataId,b.backend)}disposeVariables(){for(const _ in this.state.registeredVariables){const b=this.state.registeredVariables[_];this.disposeVariable(b)}}disposeVariable(_){this.disposeTensor(_),this.state.registeredVariables[_.name]!=null&&delete this.state.registeredVariables[_.name]}memory(){const _=this.backend.memory();return _.numTensors=this.state.numTensors,_.numDataBuffers=this.state.numDataBuffers,_.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(_.unreliable=!0,_.reasons==null&&(_.reasons=[]),_.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),_}async profile(_){this.state.profiling=!0;const b=this.state.numBytes,$=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await _(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(ee=>ee.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-b,this.state.activeProfile.newTensors=this.state.numTensors-$;for(const ee of this.state.activeProfile.kernels)ee.kernelTimeMs=await ee.kernelTimeMs,ee.extraInfo=await ee.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(_,b,$,ee,re,ae){const xe={id:this.state.nextTapeNodeId++,kernelName:_,inputs:b,outputs:$,saved:re},le=gV(_);le!=null&&(ee=le.gradFunc),ee!=null&&(xe.gradient=fe=>(fe=fe.map((ve,Se)=>{if(ve==null){const Ee=$[Se],Ce=T(Ee.size,Ee.dtype);return this.makeTensor(Ce,Ee.shape,Ee.dtype)}return ve}),ee(fe.length>1?fe:fe[0],re,ae))),this.state.activeTape.push(xe)}keep(_){return _.kept=!0,_}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(_){const b={track:[],name:"unnamed scope",id:this.state.nextScopeId++};_&&(b.name=_),this.state.scopeStack.push(b),this.state.activeScope=b}endScope(_){const b=MB(_),$=new Set(b.map(re=>re.id));for(let re=0;re<this.state.activeScope.track.length;re++){const ae=this.state.activeScope.track[re];!ae.kept&&!$.has(ae.id)&&ae.dispose()}const ee=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],b.forEach(re=>{!re.kept&&re.scopeId===ee.id&&this.track(re)})}gradients(_,b,$,ee=!1){if(k(b.length>0,()=>"gradients() received an empty list of xs."),$!=null&&$.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+$.dtype+"'");const re=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",_));k(re instanceof MF,()=>"The result y returned by f() must be a tensor.");const ae=Eu(this.state.activeTape,b,re);if(!ee&&ae.length===0&&b.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const xe={};xe[re.id]=$??fq(re.shape),Ej(xe,ae,fe=>this.tidy(fe),fF);const le=b.map(fe=>xe[fe.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(fe=>{for(const ve of fe.saved)ve.dispose()}),this.state.activeTape=null),{value:re,grads:le}})}customGrad(_){return k(d$1(_),()=>"The f passed in customGrad(f) must be a function."),(...b)=>{k(b.every(xe=>xe instanceof MF),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let $;const ee={};b.forEach((xe,le)=>{ee[le]=xe});const re=(xe,le)=>($=_(...b,le),k($.value instanceof MF,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),k(d$1($.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),$.value),ae=(xe,le)=>{const fe=$.gradFunc(xe,le),ve=Array.isArray(fe)?fe:[fe];k(ve.length===b.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),k(ve.every(Ee=>Ee instanceof MF),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const Se={};return ve.forEach((Ee,Ce)=>{Se[Ce]=()=>Ee}),Se};return this.runKernelFunc({forwardFunc:re,backwardsFunc:ae,inputs:ee})}}readSync(_){return this.state.tensorInfo.get(_).backend.readSync(_)}read(_){return this.state.tensorInfo.get(_).backend.read(_)}readToGPU(_,b){return this.state.tensorInfo.get(_).backend.readToGPU(_,b)}async time(_){const b=EF(),$=await this.backend.time(_);return $.wallMs=EF()-b,$}track(_){return this.state.activeScope!=null&&(_.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(_)),_}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new MP;for(const _ in this.registry)this.disposeRegisteredKernels(_),this.registry[_].dispose(),delete this.registry[_];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}MU.nextTensorId=0,MU.nextVariableId=0;function fq(H){const _=h$1(i$1(H),"float32");return fM.makeTensor(_,H,"float32")}function fn(){const H=qa();if(H._tfengine==null){const _=new P(H);H._tfengine=new MU(_)}return qW(H._tfengine.ENV),Ms(()=>H._tfengine),H._tfengine}const fM=fn();function fF(H,_){const b={a:H,b:_};return fM.runKernel(qG,b)}function ft(){return typeof navigator<"u"&&navigator!=null}function fW(H){if(H||ft()){if(H||(H=navigator),H.product==="ReactNative")return!0;const _=H.userAgent||H.vendor||(typeof window<"u"?window.opera:"");if(!_){const b=H;return b.userAgentData&&b.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(_)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(_.substr(0,4))}return!1}function fD(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const fa=qM();fa.registerFlag("DEBUG",()=>!1,H=>{H&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),fa.registerFlag("IS_BROWSER",()=>fD()),fa.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"),fa.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),fa.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),fa.registerFlag("PROD",()=>!1),fa.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>fa.getBool("DEBUG")),fa.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),fa.registerFlag("IS_TEST",()=>!1),fa.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>fa.getBool("DEBUG")),fa.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),fa.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),fa.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);function fZ(H,_){let b=H;if(ED(H))return _==="string"?[]:[H.length];if(MQ(H)){const ee=H.channels||"RGBA";return[H.height,H.width*ee.length]}else if(MH(H))return[H.buffer.size/(_==null?4:L(_))];if(!Array.isArray(H))return[];const $=[];for(;Array.isArray(b)||ED(b)&&_!=="string";)$.push(b.length),b=b[0];return Array.isArray(H)&&qM().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&fz(H,$,[]),$}function fz(H,_,b){if(b=b||[],!Array.isArray(H)&&!ED(H)){k(_.length===0,()=>"Element arr["+b.join("][")+"] is a primitive, but should be an array/TypedArray of "+_[0]+" elements");return}k(_.length>0,()=>"Element arr["+b.join("][")+"] should be a primitive, but is an array of "+H.length+" elements"),k(H.length===_[0],()=>"Element arr["+b.join("][")+"] should have "+_[0]+" elements, but has "+H.length+" elements");const $=_.slice(1);for(let ee=0;ee<H.length;++ee)fz(H[ee],$,b.concat(ee))}function fX(H,_,b,$){if(H!=="string_or_numeric"){if(H==null)throw new Error("Expected dtype cannot be null.");if(H!=="numeric"&&H!==_||H==="numeric"&&_==="string")throw new Error("Argument '"+b+"' passed to '"+$+"' must be "+H+" tensor, but got "+_+" tensor")}}function fG(H,_,b,$="numeric"){if(H instanceof MW())return fX($,H.dtype,_,b),H;let ee=Q(H);if(ee!=="string"&&["bool","int32","float32"].indexOf($)>=0&&(ee=$),fX($,ee,_,b),H==null||!ED(H)&&!Array.isArray(H)&&typeof H!="number"&&typeof H!="boolean"&&typeof H!="string"){const xe=H==null?"null":H.constructor.name;throw new Error("Argument '"+_+"' passed to '"+b+"' must be a Tensor or TensorLike, but got '"+xe+"'")}const re=fZ(H,ee);!ED(H)&&!Array.isArray(H)&&(H=[H]);const ae=ee!=="string"?EM(H,ee):EZ(H,[],!0);return fM.makeTensor(ae,re,ee)}function fu(H,_,b,$="numeric"){if(!Array.isArray(H))throw new Error("Argument "+_+" passed to "+b+" must be a `Tensor[]` or `TensorLike[]`");return H.map((ee,re)=>fG(ee,_+"["+re+"]",b,$))}const fj="__op";function fL(H){const _=Object.keys(H);if(_.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+_.length+" keys.");let b=_[0];const $=H[b];b.endsWith("_")&&(b=b.substring(0,b.length-1)),b=b+fj;const ee=(...re)=>{fM.startScope(b);try{const ae=$(...re);return J(ae)&&console.error("Cannot return a Promise inside of tidy."),fM.endScope(ae),ae}catch(ae){throw fM.endScope(null),ae}};return Object.defineProperty(ee,"name",{value:b,configurable:!0}),ee}function fQ(H,_){const b=fG(H,"real","complex"),$=fG(_,"imag","complex");O(b.shape,$.shape,"real and imag shapes, "+b.shape+" and "+$.shape+", must match in call to tf.complex().");const ee={real:b,imag:$};return fM.runKernel(qB,ee)}const fH=fL({complex_:fQ});function fK(H,_,b,$){if($==null)$=Q(H);else if($==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(MH(H)||MQ(H)){if($!=="float32"&&$!=="int32")throw new Error("Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is "+$+".");return fM.backend.createTensorFromGPUData(H,_||b,$)}if(!ED(H)&&!Array.isArray(H)&&typeof H!="number"&&typeof H!="boolean"&&typeof H!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(_!=null){K(_);const ee=i$1(_),re=i$1(b);k(ee===re,()=>"Based on the provided shape, ["+_+"], the tensor should have "+ee+" values but has "+re);for(let ae=0;ae<b.length;++ae){const xe=b[ae],le=ae===b.length-1?xe!==i$1(_.slice(ae)):!0;k(b[ae]===_[ae]||!le,()=>"Error creating a new Tensor. Inferred shape ("+b+") does not match the provided shape ("+_+"). ")}}return!ED(H)&&!Array.isArray(H)&&(H=[H]),_=_||b,H=$!=="string"?EM(H,$):EZ(H,[],!0),fM.makeTensor(H,_,$)}function fB(H,_,b){const $=fZ(H,b);return fK(H,_,$,b)}const fV={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class fJ{static join(_){return new fJ(_).slice()}constructor(_){if(this.shards=[],this.previousShardIndex=0,_==null||(_ instanceof Array||(_=[_]),_=_.map($=>ED($)?$.buffer:$),_.length===0))return;this.bufferUniformSize=_[0].byteLength;let b=0;for(let $=0;$<_.length;$++){const ee=_[$];$!==_.length-1&&ee.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const re=b+ee.byteLength;this.shards.push({buffer:ee,start:b,end:re}),b=re}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(_=0,b=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(_=isNaN(Number(_))?0:_,b=isNaN(Number(b))?0:b,_=Math.max(0,_),b=Math.min(this.byteLength,b),b<=_)return new ArrayBuffer(0);const $=this.findShardForByte(_);if($===-1)throw new Error("Could not find start shard for byte "+_);const ee=b-_,re=new ArrayBuffer(ee),ae=new Uint8Array(re);let xe=0;for(let le=$;le<this.shards.length;le++){const fe=this.shards[le],ve=_+xe-fe.start,Se=xe,Ee=Math.min(b,fe.end)-fe.start,Ce=new Uint8Array(fe.buffer,ve,Ee-ve);if(ae.set(Ce,Se),xe+=Ce.length,b<fe.end)break}return re}findShardForByte(_){if(this.shards.length===0||_<0||_>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(_/this.bufferUniformSize),this.previousShardIndex;function b(ee){return _<ee.start?-1:_>=ee.end?1:0}if(b(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const $=fY(this.shards,b);return $===-1?-1:(this.previousShardIndex=$,this.previousShardIndex)}}function fY(H,_){let b=0,$=H.length;for(;b<=$;){const ee=Math.floor(($-b)/2)+b,re=_(H[ee]);if(re===0)return ee;re<0?$=ee:b=ee+1}return-1}function fP(){qM().set("PROD",!0)}function fU(){return fM}function Sq(H,_){return fM.tidy(H,_)}function Sn(H){MB(H).forEach(_=>_.dispose())}function SM(H){return fM.keep(H)}function SF(H){return fM.setBackend(H)}function St(){return fM.backendName}function SW(H,_,b=1){return fM.registerBackend(H,_,b)}function SD(){return fM.backend}const SZ=4;async function Sz(H,_){const b=[],$=[],ee=Array.isArray(H)?H.map(ae=>ae.name):Object.keys(H);for(let ae=0;ae<ee.length;++ae){const xe=ee[ae],le=Array.isArray(H)?H[ae].tensor:H[xe];if(le.dtype!=="float32"&&le.dtype!=="int32"&&le.dtype!=="bool"&&le.dtype!=="string"&&le.dtype!=="complex64")throw new Error("Unsupported dtype in weight '"+xe+"': "+le.dtype);const fe={name:xe,shape:le.shape,dtype:le.dtype};if(le.dtype==="string"){const ve=new Promise(async Se=>{const Ee=await le.bytes(),Ce=Ee.reduce((Be,Ne)=>Be+Ne.length,0)+SZ*Ee.length,Ie=new Uint8Array(Ce);let De=0;for(let Be=0;Be<Ee.length;Be++){const Ne=Ee[Be],qe=new Uint8Array(new Uint32Array([Ne.length]).buffer);Ie.set(qe,De),De+=SZ,Ie.set(Ne,De),De+=Ne.length}Se(Ie)});$.push(ve)}else $.push(le.data());_!=null&&(fe.group=_),b.push(fe)}const re=await Promise.all($);return{data:SH(re),specs:b}}function SX(H,_){const b=new fJ(H),$={};let ee=0;for(const re of _){const ae=SG(re,(xe,le)=>b.slice(ee+xe,ee+le));$[re.name]=Sj(re,b.slice(ee,ee+ae)),ee+=ae}return $}function SG(H,_){const b=i$1(H.shape);let $;if("quantization"in H){const ee=H.quantization;$=fV[ee.dtype]}else if(H.dtype==="string"){let ee=0;for(let re=0;re<b;re++)ee+=SZ+new Uint32Array(_(ee,ee+SZ))[0];return ee}else $=fV[H.dtype];return b*$}async function Su(H,_){const b=i$1(H.shape);let $;if("quantization"in H){const ee=H.quantization;$=fV[ee.dtype]}else if(H.dtype==="string"){let ee=0;for(let re=0;re<b;re++)ee+=SZ+new Uint32Array(await _(ee,ee+SZ))[0];return ee}else $=fV[H.dtype];return b*$}function Sj(H,_){const b=H.name,$=H.dtype,ee=H.shape,re=i$1(ee);let ae,xe=0;if("quantization"in H){const le=H.quantization;if(le.dtype==="uint8"||le.dtype==="uint16"){if(!("min"in le&&"scale"in le))throw new Error("Weight "+H.name+" with quantization "+le.dtype+" doesn't have corresponding metadata min and scale.")}else if(le.dtype==="float16"){if($!=="float32")throw new Error("Weight "+H.name+" is quantized with "+le.dtype+" which only supports weights of type float32 not "+$+".")}else throw new Error("Weight "+H.name+" has unknown quantization dtype "+le.dtype+". Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");const fe=fV[le.dtype],ve=le.dtype==="uint8"?new Uint8Array(_):new Uint16Array(_);if($==="float32")if(le.dtype==="uint8"||le.dtype==="uint16"){ae=new Float32Array(ve.length);for(let Se=0;Se<ve.length;Se++){const Ee=ve[Se];ae[Se]=Ee*le.scale+le.min}}else if(le.dtype==="float16")ae=Fe()(ve);else throw new Error("Unsupported quantization type "+le.dtype+" for weight type float32.");else if($==="int32"){if(le.dtype!=="uint8"&&le.dtype!=="uint16")throw new Error("Unsupported quantization type "+le.dtype+" for weight type int32.");ae=new Int32Array(ve.length);for(let Se=0;Se<ve.length;Se++){const Ee=ve[Se];ae[Se]=Math.round(Ee*le.scale+le.min)}}else throw new Error("Unsupported dtype in weight '"+b+"': "+$);xe+=re*fe}else if($==="string"){const le=i$1(H.shape);ae=[];for(let fe=0;fe<le;fe++){const ve=new Uint32Array(_.slice(xe,xe+SZ))[0];xe+=SZ;const Se=new Uint8Array(_.slice(xe,xe+ve));ae.push(Se),xe+=ve}}else{const le=fV[$];if($==="float32")ae=new Float32Array(_);else if($==="int32")ae=new Int32Array(_);else if($==="bool")ae=new Uint8Array(_);else if($==="complex64"){ae=new Float32Array(_);const fe=new Float32Array(ae.length/2),ve=new Float32Array(ae.length/2);for(let Ie=0;Ie<fe.length;Ie++)fe[Ie]=ae[Ie*2],ve[Ie]=ae[Ie*2+1];const Se=fB(fe,ee,"float32"),Ee=fB(ve,ee,"float32"),Ce=fH(Se,Ee);return Se.dispose(),Ee.dispose(),Ce}else throw new Error("Unsupported dtype in weight '"+b+"': "+$);xe+=re*le}return fB(ae,ee,$)}async function SL(H,_,b){let $=new Uint8Array(_);for(;$.byteLength<b;){const{done:ee,value:re}=await H.read();if(ee&&re==null){const xe=b-$.byteLength;throw new Error("Reader is done but "+xe+" bytes are still expected")}const ae=new Uint8Array($.length+re.byteLength);ae.set($,0),ae.set(new Uint8Array(re),$.length),$=ae}return $.buffer}async function SQ(H,_){const b={},$=H.getReader();let ee=new ArrayBuffer(0);for(const re of _){const ae=await Su(re,async(fe,ve)=>(ee=await SL($,ee,ve),ee.slice(fe,ve)));ee=await SL($,ee,ae);const xe=ee.slice(0,ae);ee=ee.slice(ae);const le=Sj(re,xe);if(b[re.name]=le,St()==="webgpu"){const fe=SD();"uploadToGPU"in fe&&i$1(le.shape)>=qM().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&fe.uploadToGPU(le.dataId)}}return b}function SH(H){if(H===null)throw new Error("Invalid input value: "+JSON.stringify(H));let _=0;const b=[];H.forEach(re=>{if(_+=re.byteLength,b.push(re.byteLength===re.buffer.byteLength?re:new re.constructor(re)),!(re instanceof Float32Array||re instanceof Int32Array||re instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+re.constructor.name)});const $=new Uint8Array(_);let ee=0;return b.forEach(re=>{$.set(new Uint8Array(re.buffer),ee),ee+=re.byteLength}),$.buffer}const SK=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function SB(H){return SK?Buffer.byteLength(H,"utf8"):new Blob([H]).size}function SV(H){if(SK)return Buffer.from(H).toString("base64");const _=new Uint8Array(H);let b="";for(let $=0,ee=_.length;$<ee;$++)b+=String.fromCharCode(_[$]);return btoa(b)}function SJ(H){if(SK){const $=Buffer.from(H,"base64");return $.buffer.slice($.byteOffset,$.byteOffset+$.byteLength)}const _=atob(H),b=new Uint8Array(_.length);for(let $=0;$<_.length;++$)b.set([_.charCodeAt($)],$);return b.buffer}function SY(H){return fJ.join(H)}function SP(H){const _="/";for(H=H.trim();H.endsWith(_);)H=H.slice(0,H.length-1);const b=H.split(_);return b[b.length-1]}function SU(H,_){const b={modelTopology:H.modelTopology,format:H.format,generatedBy:H.generatedBy,convertedBy:H.convertedBy,weightsManifest:_};return H.signature!=null&&(b.signature=H.signature),H.userDefinedMetadata!=null&&(b.userDefinedMetadata=H.userDefinedMetadata),H.modelInitializer!=null&&(b.modelInitializer=H.modelInitializer),H.initializerSignature!=null&&(b.initializerSignature=H.initializerSignature),H.trainingConfig!=null&&(b.trainingConfig=H.trainingConfig),b}function Fq(H,_,b){const $={modelTopology:H.modelTopology,format:H.format,generatedBy:H.generatedBy,convertedBy:H.convertedBy};if(H.trainingConfig!=null&&($.trainingConfig=H.trainingConfig),H.weightsManifest!=null){if(!_)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!b)throw new Error("modelJSON has weightsManifest but weightData is null");$.weightSpecs=_,$.weightData=b}return H.signature!=null&&($.signature=H.signature),H.userDefinedMetadata!=null&&($.userDefinedMetadata=H.userDefinedMetadata),H.modelInitializer!=null&&($.modelInitializer=H.modelInitializer),H.initializerSignature!=null&&($.initializerSignature=H.initializerSignature),$}async function Fs(H,_){let b,$;return H.weightsManifest!=null&&([b,$]=await _(H.weightsManifest)),Fq(H,b,$)}function FM(H){if(H.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:H.modelTopology==null?0:SB(JSON.stringify(H.modelTopology)),weightSpecsBytes:H.weightSpecs==null?0:SB(JSON.stringify(H.weightSpecs)),weightDataBytes:H.weightData==null?0:new fJ(H.weightData).byteLength}}function FF(H){const _=[];for(const b of H)_.push(...b.weights);return _}function FW(){const H=b=>{let $=b<<13,ee=0;for(;($&8388608)===0;)ee-=8388608,$<<=1;return $&=-8388609,ee+=947912704,$|ee},_=new Uint32Array(2048);_[0]=0;for(let b=1;b<1024;b++)_[b]=H(b);for(let b=1024;b<2048;b++)_[b]=939524096+(b-1024<<13);return _}function FD(){const H=new Uint32Array(64);H[0]=0,H[31]=1199570944,H[32]=2147483648,H[63]=3347054592;for(let _=1;_<31;_++)H[_]=_<<23;for(let _=33;_<63;_++)H[_]=2147483648+(_-32<<23);return H}function FZ(){const H=new Uint32Array(64);for(let _=0;_<64;_++)H[_]=1024;return H[0]=H[32]=0,H}function Fe(){const H=FW(),_=FD(),b=FZ();return $=>{const ee=new ArrayBuffer(4*$.length),re=new Uint32Array(ee);for(let ae=0;ae<$.length;ae++){const xe=$[ae],le=H[b[xe>>10]+(xe&1023)]+_[xe>>10];re[ae]=le}return new Float32Array(ee)}}class Fz{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Fz.instance==null&&(Fz.instance=new Fz),Fz.instance}static registerSaveRouter(_){Fz.getInstance().saveRouters.push(_)}static registerLoadRouter(_){Fz.getInstance().loadRouters.push(_)}static getSaveHandlers(_){return Fz.getHandlers(_,"save")}static getLoadHandlers(_,b){return Fz.getHandlers(_,"load",b)}static getHandlers(_,b,$){const ee=[];return(b==="load"?Fz.getInstance().loadRouters:Fz.getInstance().saveRouters).forEach(re=>{const ae=re(_,$);ae!==null&&ee.push(ae)}),ee}}const FX=H=>Fz.registerSaveRouter(H),FG=H=>Fz.registerLoadRouter(H),Fu=H=>Fz.getSaveHandlers(H),Fj=(H,_)=>Fz.getLoadHandlers(H,_),FL="tensorflowjs",FR=1,FQ="models_store",FH="model_info_store";function FK(){if(!qM().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const H=typeof window>"u"?self:window,_=H.indexedDB||H.mozIndexedDB||H.webkitIndexedDB||H.msIndexedDB||H.shimIndexedDB;if(_==null)throw new Error("The current browser does not appear to support IndexedDB.");return _}function FB(H){const _=H.result;_.createObjectStore(FQ,{keyPath:"modelPath"}),_.createObjectStore(FH,{keyPath:"modelPath"})}class FV{constructor(_){if(this.indexedDB=FK(),_==null||!_)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=_}async save(_){if(_.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,_)}async load(){return this.databaseAction(this.modelPath)}databaseAction(_,b){return new Promise(($,ee)=>{const re=this.indexedDB.open(FL,FR);re.onupgradeneeded=()=>FB(re),re.onsuccess=()=>{const ae=re.result;if(b==null){const xe=ae.transaction(FQ,"readonly"),le=xe.objectStore(FQ).get(this.modelPath);le.onsuccess=()=>{if(le.result==null)return ae.close(),ee(new Error("Cannot find model with path '"+this.modelPath+"' in IndexedDB."));$(le.result.modelArtifacts)},le.onerror=fe=>(ae.close(),ee(le.error)),xe.oncomplete=()=>ae.close()}else{b.weightData=fJ.join(b.weightData);const xe=FM(b),le=ae.transaction(FH,"readwrite");let fe=le.objectStore(FH),ve;try{ve=fe.put({modelPath:this.modelPath,modelArtifactsInfo:xe})}catch(Ee){return ee(Ee)}let Se;ve.onsuccess=()=>{Se=ae.transaction(FQ,"readwrite");const Ee=Se.objectStore(FQ);let Ce;try{Ce=Ee.put({modelPath:this.modelPath,modelArtifacts:b,modelArtifactsInfo:xe})}catch(Ie){return ee(Ie)}Ce.onsuccess=()=>$({modelArtifactsInfo:xe}),Ce.onerror=Ie=>{fe=le.objectStore(FH);const De=fe.delete(this.modelPath);De.onsuccess=()=>(ae.close(),ee(Ce.error)),De.onerror=Be=>(ae.close(),ee(Ce.error))}},ve.onerror=Ee=>(ae.close(),ee(ve.error)),le.oncomplete=()=>{Se==null?ae.close():Se.oncomplete=()=>ae.close()}}},re.onerror=ae=>ee(re.error)})}}FV.URL_SCHEME="indexeddb://";const FJ=H=>qM().getBool("IS_BROWSER")&&!Array.isArray(H)&&H.startsWith(FV.URL_SCHEME)?FY(H.slice(FV.URL_SCHEME.length)):null;Fz.registerSaveRouter(FJ),Fz.registerLoadRouter(FJ);function FY(H){return new FV(H)}function FP(H){return H.startsWith(FV.URL_SCHEME)?H.slice(FV.URL_SCHEME.length):H}class FU{constructor(){this.indexedDB=FK()}async listModels(){return new Promise((_,b)=>{const $=this.indexedDB.open(FL,FR);$.onupgradeneeded=()=>FB($),$.onsuccess=()=>{const ee=$.result,re=ee.transaction(FH,"readonly"),ae=re.objectStore(FH).getAll();ae.onsuccess=()=>{const xe={};for(const le of ae.result)xe[le.modelPath]=le.modelArtifactsInfo;_(xe)},ae.onerror=xe=>(ee.close(),b(ae.error)),re.oncomplete=()=>ee.close()},$.onerror=ee=>b($.error)})}async removeModel(_){return _=FP(_),new Promise((b,$)=>{const ee=this.indexedDB.open(FL,FR);ee.onupgradeneeded=()=>FB(ee),ee.onsuccess=()=>{const re=ee.result,ae=re.transaction(FH,"readwrite"),xe=ae.objectStore(FH),le=xe.get(_);let fe;le.onsuccess=()=>{if(le.result==null)return re.close(),$(new Error("Cannot find model with path '"+_+"' in IndexedDB."));{const ve=xe.delete(_),Se=()=>{fe=re.transaction(FQ,"readwrite");const Ee=fe.objectStore(FQ).delete(_);Ee.onsuccess=()=>b(le.result.modelArtifactsInfo),Ee.onerror=Ce=>$(le.error)};ve.onsuccess=Se,ve.onerror=Ee=>(Se(),re.close(),$(le.error))}},le.onerror=ve=>(re.close(),$(le.error)),ae.oncomplete=()=>{fe==null?re.close():fe.oncomplete=()=>re.close()}},ee.onerror=re=>$(ee.error)})}}const tq="/",tn="tensorflowjs_models",ts="info",tM="model_topology",tF="weight_specs",tW="weight_data",ti="model_metadata";function tD(H){return{info:[tn,H,ts].join(tq),topology:[tn,H,tM].join(tq),weightSpecs:[tn,H,tF].join(tq),weightData:[tn,H,tW].join(tq),modelMetadata:[tn,H,ti].join(tq)}}function tZ(H){for(const _ of Object.values(H))window.localStorage.removeItem(_)}function te(H){const _=H.split(tq);if(_.length<3)throw new Error("Invalid key format: "+H);return _.slice(1,_.length-1).join(tq)}function tz(H){return H.startsWith(tX.URL_SCHEME)?H.slice(tX.URL_SCHEME.length):H}class tX{constructor(_){if(!qM().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,_==null||!_)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=_,this.keys=tD(this.modelPath)}async save(_){if(_.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const b=JSON.stringify(_.modelTopology),$=JSON.stringify(_.weightSpecs),ee=FM(_),re=fJ.join(_.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(ee)),this.LS.setItem(this.keys.topology,b),this.LS.setItem(this.keys.weightSpecs,$),this.LS.setItem(this.keys.weightData,SV(re));const ae={format:_.format,generatedBy:_.generatedBy,convertedBy:_.convertedBy,signature:_.signature!=null?_.signature:void 0,userDefinedMetadata:_.userDefinedMetadata!=null?_.userDefinedMetadata:void 0,modelInitializer:_.modelInitializer!=null?_.modelInitializer:void 0,initializerSignature:_.initializerSignature!=null?_.initializerSignature:void 0,trainingConfig:_.trainingConfig!=null?_.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(ae)),{modelArtifactsInfo:ee}}catch{throw tZ(this.keys),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+ee.modelTopologyBytes+", weightSpecsBytes="+ee.weightSpecsBytes+", weightDataBytes="+ee.weightDataBytes+".")}}}async load(){const _=JSON.parse(this.LS.getItem(this.keys.info));if(_==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(_.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const b={},$=JSON.parse(this.LS.getItem(this.keys.topology));if($==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");b.modelTopology=$;const ee=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(ee==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");b.weightSpecs=ee;const re=this.LS.getItem(this.keys.modelMetadata);if(re!=null){const xe=JSON.parse(re);b.format=xe.format,b.generatedBy=xe.generatedBy,b.convertedBy=xe.convertedBy,xe.signature!=null&&(b.signature=xe.signature),xe.userDefinedMetadata!=null&&(b.userDefinedMetadata=xe.userDefinedMetadata),xe.modelInitializer!=null&&(b.modelInitializer=xe.modelInitializer),xe.initializerSignature!=null&&(b.initializerSignature=xe.initializerSignature),xe.trainingConfig!=null&&(b.trainingConfig=xe.trainingConfig)}const ae=this.LS.getItem(this.keys.weightData);if(ae==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return b.weightData=SJ(ae),b}}tX.URL_SCHEME="localstorage://";const tG=H=>qM().getBool("IS_BROWSER")&&!Array.isArray(H)&&H.startsWith(tX.URL_SCHEME)?tj(H.slice(tX.URL_SCHEME.length)):null;Fz.registerSaveRouter(tG),Fz.registerLoadRouter(tG);function tj(H){return new tX(H)}class tL{constructor(){k(qM().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),k(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const _={},b=tn+tq,$=tq+ts;for(let ee=0;ee<this.LS.length;++ee){const re=this.LS.key(ee);if(re.startsWith(b)&&re.endsWith($)){const ae=te(re);_[ae]=JSON.parse(this.LS.getItem(re))}}return _}async removeModel(_){_=tz(_);const b=tD(_);if(this.LS.getItem(b.info)==null)throw new Error("Cannot find model at path '"+_+"'");const $=JSON.parse(this.LS.getItem(b.info));return tZ(b),$}}const to="model",tQ=".json",tH=".weights.bin";function tK(H){return new Promise(_=>setTimeout(_)).then(H)}class tB{constructor(_){if(!qM().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");_.startsWith(tB.URL_SCHEME)&&(_=_.slice(tB.URL_SCHEME.length)),(_==null||_.length===0)&&(_=to),this.modelJsonFileName=_+tQ,this.weightDataFileName=_+tH}async save(_){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const b=fJ.join(_.weightData),$=window.URL.createObjectURL(new Blob([b],{type:"application/octet-stream"}));if(_.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const ee=[{paths:["./"+this.weightDataFileName],weights:_.weightSpecs}],re=SU(_,ee),ae=window.URL.createObjectURL(new Blob([JSON.stringify(re)],{type:"application/json"})),xe=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(xe.download=this.modelJsonFileName,xe.href=ae,await tK(()=>xe.dispatchEvent(new MouseEvent("click"))),_.weightData!=null){const le=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;le.download=this.weightDataFileName,le.href=$,await tK(()=>le.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:FM(_)}}}}tB.URL_SCHEME="downloads://";class tV{constructor(_){if(_==null||_.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+_);this.jsonFile=_[0],this.weightsFiles=_.slice(1)}async load(){return new Promise((_,b)=>{const $=new FileReader;$.onload=ee=>{const re=JSON.parse(ee.target.result),ae=re.modelTopology;if(ae==null){b(new Error("modelTopology field is missing from file "+this.jsonFile.name));return}if(re.weightsManifest==null){b(new Error("weightManifest field is missing from file "+this.jsonFile.name));return}if(this.weightsFiles.length===0){_({modelTopology:ae});return}const xe=Fs(re,le=>this.loadWeights(le));_(xe)},$.onerror=ee=>b("Failed to read model topology and weights manifest JSON from file '"+this.jsonFile.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only."),$.readAsText(this.jsonFile)})}loadWeights(_){const b=[],$=[];for(const ae of _)b.push(...ae.weights),$.push(...ae.paths);const ee=this.checkManifestAndWeightFiles(_),re=$.map(ae=>this.loadWeightsFile(ae,ee[ae]));return Promise.all(re).then(ae=>[b,ae])}loadWeightsFile(_,b){return new Promise(($,ee)=>{const re=new FileReader;re.onload=ae=>{const xe=ae.target.result;$(xe)},re.onerror=ae=>ee("Failed to weights data from file of path '"+_+"'."),re.readAsArrayBuffer(b)})}checkManifestAndWeightFiles(_){const b=[],$=this.weightsFiles.map(re=>SP(re.name)),ee={};for(const re of _)re.paths.forEach(ae=>{const xe=SP(ae);if(b.indexOf(xe)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+xe+"'");if(b.push(xe),$.indexOf(xe)===-1)throw new Error("Weight file with basename '"+xe+"' is not provided.");ee[ae]=this.weightsFiles[$.indexOf(xe)]});if(b.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest ("+b.length+") and the number of weight files provided ("+this.weightsFiles.length+").");return ee}}const tJ=H=>qM().getBool("IS_BROWSER")&&!Array.isArray(H)&&H.startsWith(tB.URL_SCHEME)?tY(H.slice(tB.URL_SCHEME.length)):null;Fz.registerSaveRouter(tJ);function tY(H="model"){return new tB(H)}function tP(H){return new tV(H)}function tU(H,_,b,$){ae(H),b=b??0,$=$??1,xe(b,$);let ee=0;const re=le=>(le.then(fe=>{const ve=b+ ++ee/H.length*($-b);return _(ve),fe}),le);function ae(le){k(le!=null&&Array.isArray(le)&&le.length>0,()=>"promises must be a none empty array")}function xe(le,fe){k(le>=0&&le<=1,()=>"Progress fraction must be in range [0, 1], but got startFraction "+le),k(fe>=0&&fe<=1,()=>"Progress fraction must be in range [0, 1], but got endFraction "+fe),k(fe>=le,()=>"startFraction must be no more than endFraction, but got startFraction "+le+" and endFraction "+fe)}return Promise.all(H.map(re))}async function kq(H,_){_==null&&(_={});const b=_.fetchFunc==null?qM().platform.fetch:_.fetchFunc,$=H.map(re=>b(re,_.requestInit,{isBinary:!0})),ee=(_.onProgress==null?await Promise.all($):await tU($,_.onProgress,0,.5)).map(re=>re.arrayBuffer());return _.onProgress==null?await Promise.all(ee):await tU(ee,_.onProgress,.5,1)}function ks(H,_){var b;const $=_.fetchFunc==null?qM().platform.fetch:_.fetchFunc;let ee=0,re;return(b=_.onProgress)===null||b===void 0||b.call(_,0),new ReadableStream({pull:async ae=>{for(var xe;ee<H.length;){re||(re=(await $(H[ee],_.requestInit,{isBinary:!0})).body.getReader());const{done:le,value:fe}=await re.read();if(le){ee++,re=void 0,(xe=_.onProgress)===null||xe===void 0||xe.call(_,ee/H.length);continue}ae.enqueue(fe);return}ae.close()}})}async function kM(H,_="",b,$){return kF(ee=>kq(ee,{requestInit:$}))(H,_,b)}function kF(H){return async(_,b="",$)=>{const ee=_.map(()=>!1),re={},ae=$!=null?$.map(()=>!1):[],xe=[];if(_.forEach((Ce,Ie)=>{let De=0;Ce.weights.forEach(Be=>{const Ne="quantization"in Be?Be.quantization.dtype:Be.dtype,qe=fV[Ne]*i$1(Be.shape),Xe=()=>{ee[Ie]=!0,re[Ie]==null&&(re[Ie]=[]),re[Ie].push({manifestEntry:Be,groupOffset:De,sizeBytes:qe})};$!=null?$.forEach((Ye,Qe)=>{Ye===Be.name&&(Xe(),ae[Qe]=!0)}):Xe(),xe.push(Be.name),De+=qe})}),!ae.every(Ce=>Ce)){const Ce=$.filter((Ie,De)=>!ae[De]);throw new Error("Could not find weights in manifest with names: "+Ce.join(", ")+`. 
Manifest JSON has weights with names: `+xe.join(", ")+".")}const le=ee.reduce((Ce,Ie,De)=>(Ie&&Ce.push(De),Ce),[]),fe=[];le.forEach(Ce=>{_[Ce].paths.forEach(Ie=>{const De=b+(b.endsWith("/")?"":"/")+Ie;fe.push(De)})});const ve=await H(fe),Se={};let Ee=0;return le.forEach(Ce=>{const Ie=_[Ce].paths.length,De=new fJ(ve.slice(Ee,Ee+Ie));re[Ce].forEach(Be=>{const Ne=De.slice(Be.groupOffset,Be.groupOffset+Be.sizeBytes),qe=SX(Ne,[Be.manifestEntry]);for(const Xe in qe)Se[Xe]=qe[Xe]}),Ee+=Ie}),Se}}const kt="application/octet-stream",kW="application/json";class kD{constructor(_,b){if(this.DEFAULT_METHOD="POST",b==null&&(b={}),this.weightPathPrefix=b.weightPathPrefix,this.weightUrlConverter=b.weightUrlConverter,b.fetchFunc!=null?(k(typeof b.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=b.fetchFunc):this.fetch=qM().platform.fetch,k(_!=null&&_.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(_)&&k(_.length===2,()=>"URL paths for http must have a length of 2, (actual length is "+_.length+")."),this.path=_,b.requestInit!=null&&b.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=b.requestInit||{},this.loadOptions=b}async save(_){if(_.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const b=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);b.body=new FormData;const $=[{paths:["./model.weights.bin"],weights:_.weightSpecs}],ee=SU(_,$);if(b.body.append("model.json",new Blob([JSON.stringify(ee)],{type:kW}),"model.json"),_.weightData!=null){const ae=fJ.join(_.weightData);b.body.append("model.weights.bin",new Blob([ae],{type:kt}),"model.weights.bin")}const re=await this.fetch(this.path,b);if(re.ok)return{modelArtifactsInfo:FM(_),responses:[re]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+re.status+".")}async loadModelJSON(){const _=await this.fetch(this.path,this.requestInit);if(!_.ok)throw new Error("Request to "+this.path+" failed with status code "+_.status+". Please verify this URL points to the model JSON of the model to load.");let b;try{b=await _.json()}catch{let ae="Failed to parse model JSON of response from "+this.path+".";throw this.path.endsWith(".pb")?ae+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":ae+=" Please make sure the server is serving valid JSON for this request.",new Error(ae)}const $=b.modelTopology,ee=b.weightsManifest;if($==null&&ee==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return b}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const _=await this.loadModelJSON();return Fs(_,b=>this.loadWeights(b))}async loadStream(){const _=await this.loadModelJSON(),b=await this.getWeightUrls(_.weightsManifest),$=FF(_.weightsManifest),ee=()=>ks(b,this.loadOptions);return Object.assign(Object.assign({},_),{weightSpecs:$,getWeightStream:ee})}async getWeightUrls(_){const b=Array.isArray(this.path)?this.path[1]:this.path,[$,ee]=kZ(b),re=this.weightPathPrefix||$,ae=[],xe=[];for(const le of _)for(const fe of le.paths)this.weightUrlConverter!=null?xe.push(this.weightUrlConverter(fe)):ae.push(re+fe+ee);return this.weightUrlConverter&&ae.push(...await Promise.all(xe)),ae}async loadWeights(_){const b=await this.getWeightUrls(_),$=FF(_),ee=await kq(b,this.loadOptions);return[$,ee]}}kD.URL_SCHEME_REGEX=/^https?:\/\//;function kZ(H){const _=H.lastIndexOf("/"),b=H.lastIndexOf("?"),$=H.substring(0,_),ee=b>_?H.substring(b):"";return[$+"/",ee]}function ke(H){return H.match(kD.URL_SCHEME_REGEX)!=null}const kz=(H,_)=>{if(typeof fetch>"u"&&(_==null||_.fetchFunc==null))return null;{let b=!0;if(Array.isArray(H)?b=H.every($=>ke($)):b=ke(H),b)return kc(H,_)}return null};Fz.registerSaveRouter(kz),Fz.registerLoadRouter(kz);function kc(H,_){return new kD(H,_)}function kX(H,_){return kc(H,_)}class kG{constructor(_){this.modelArtifacts=_}load(){return this.modelArtifacts}}class ku{constructor(_){this.saveHandler=_}save(_){return this.saveHandler(_)}}class kj{constructor(_){_.load&&(this.load=()=>Promise.resolve(_.load())),_.save&&(this.save=b=>Promise.resolve(_.save(b)))}}function kL(H,_,b,$){const ee=arguments;return new kj(kR(...ee))}function kR(H,_,b,$){return arguments.length===1?H.modelTopology!=null||H.weightSpecs!=null?new kG(H):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new kG({modelTopology:H})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new kG({modelTopology:H,weightSpecs:_,weightData:b,trainingConfig:$}))}function kr(H){return new ku(H)}function kQ(H){return new ku(H)}const kH="://";class kK{constructor(){this.managers={}}static getInstance(){return kK.instance==null&&(kK.instance=new kK),kK.instance}static registerManager(_,b){k(_!=null,()=>"scheme must not be undefined or null."),_.endsWith(kH)&&(_=_.slice(0,_.indexOf(kH))),k(_.length>0,()=>"scheme must not be an empty string.");const $=kK.getInstance();k($.managers[_]==null,()=>"A model store manager is already registered for scheme '"+_+"'."),$.managers[_]=b}static getManager(_){const b=kK.getInstance().managers[_];if(b==null)throw new Error("Cannot find model manager for scheme '"+_+"'");return b}static getSchemes(){return Object.keys(kK.getInstance().managers)}}function kB(H){if(H.indexOf(kH)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+kK.getSchemes().join(","));return{scheme:H.split(kH)[0],path:H.split(kH)[1]}}async function kV(H,_,b=!1){k(H!==_,()=>"Old path and new path are the same: '"+H+"'");const $=Fz.getLoadHandlers(H);k($.length>0,()=>"Copying failed because no load handler is found for source URL "+H+"."),k($.length<2,()=>"Copying failed because more than one ("+$.length+") load handlers for source URL "+H+".");const ee=$[0],re=Fz.getSaveHandlers(_);k(re.length>0,()=>"Copying failed because no save handler is found for destination URL "+_+"."),k(re.length<2,()=>"Copying failed because more than one ("+$.length+") save handlers for destination URL "+_+".");const ae=re[0],xe=kB(H).scheme,le=kB(H).path,fe=xe===kB(H).scheme,ve=await ee.load();b&&fe&&await kK.getManager(xe).removeModel(le);const Se=await ae.save(ve);return b&&!fe&&await kK.getManager(xe).removeModel(le),Se.modelArtifactsInfo}async function kJ(){const H=kK.getSchemes(),_={};for(const b of H){const $=await kK.getManager(b).listModels();for(const ee in $){const re=b+kH+ee;_[re]=$[ee]}}return _}async function kY(H){const _=kB(H);return kK.getManager(_.scheme).removeModel(_.path)}async function kP(H,_){return kV(H,_,!1)}async function kU(H,_){return kV(H,_,!0)}var Oq=Object.freeze({__proto__:null,CompositeArrayBuffer:fJ,browserFiles:tP,browserHTTPRequest:kX,concatenateArrayBuffers:SY,copyModel:kP,decodeWeights:SX,decodeWeightsStream:SQ,encodeWeights:Sz,fromMemory:kL,fromMemorySync:kR,getLoadHandlers:Fj,getModelArtifactsForJSON:Fs,getModelArtifactsForJSONSync:Fq,getModelArtifactsInfoForJSON:FM,getSaveHandlers:Fu,getWeightSpecs:FF,http:kc,isHTTPScheme:ke,listModels:kJ,loadWeights:kM,moveModel:kU,registerLoadRouter:FG,registerSaveRouter:FX,removeModel:kY,weightsLoaderFactory:kF,withSaveHandler:kr,withSaveHandlerSync:kQ});function Os(H,_){const b=fG(H,"x","cast");if(!u$1(_))throw new Error("Failed to cast to unknown dtype "+_);if(_==="string"&&b.dtype!=="string"||_!=="string"&&b.dtype==="string")throw new Error("Only strings can be casted to strings");const $={x:b},ee={dtype:_};return fM.runKernel(qH,$,ee)}const OM=fL({cast_:Os});function OF(H,_,b=!1,$=!1){let ee=fG(H,"a","matMul"),re=fG(_,"b","matMul");[ee,re]=MK(ee,re);const ae={a:ee,b:re},xe={transposeA:b,transposeB:$};return fM.runKernel(qo,ae,xe)}const OW=fL({matMul_:OF});function OD(H){const _={input:fG(H,"input","imag")};return fM.runKernel(nQ,_)}const OZ=fL({imag_:OD});function Oe(H){const _={x:fG(H,"x","neg")};return fM.runKernel(pt,_)}const Oz=fL({neg_:Oe});function Oc(H){const _={input:fG(H,"input","real")};return fM.runKernel(pu,_)}const OX=fL({real_:Oc});function OG(H,_,b){const $=fG(H,"x","transpose");if(_==null&&(_=$.shape.map((ae,xe)=>xe).reverse()),k($.rank===_.length,()=>"Error in transpose: rank of input "+$.rank+" must match length of perm "+_+"."),_.forEach(ae=>{k(ae>=0&&ae<$.rank,()=>"All entries in 'perm' must be between 0 and "+($.rank-1)+" but got "+_)}),$.rank<=1)return $.clone();const ee={x:$},re={perm:_};return $.dtype==="complex64"?Sq(()=>{let ae=OX($),xe=OZ($);return ae=fM.runKernel(gD,{x:ae},re),xe=fM.runKernel(gD,{x:xe},re),b&&(xe=Oz(xe)),fH(ae,xe)}):fM.runKernel(gD,ee,re)}const Ou=fL({transpose_:OG});function Oj(H,_){const b=H.length,$=[];for(let ee=0;ee<b;ee++){const re=b-1-ee,ae=H[re]||1;(_[_.length-1-ee]||1)>1&&ae===1&&$.unshift(re)}return $}function OL(H,_){const b=[];for(let $=0;$<_.length;$++){const ee=H[H.length-$-1],re=_.length-$-1,ae=_[re];(ee==null||ee===1&&ae>1)&&b.unshift(re)}return b}function OR(H,_){const b=Math.max(H.length,_.length),$=new Array(b);for(let ee=0;ee<b;ee++){let re=H[H.length-ee-1];re==null&&(re=1);let ae=_[_.length-ee-1];if(ae==null&&(ae=1),re===1)$[b-ee-1]=ae;else if(ae===1)$[b-ee-1]=re;else if(re!==ae){const xe="Operands could not be broadcast together with shapes "+H+" and "+_+".";throw Error(xe)}else $[b-ee-1]=re}return $}function Or(H,_,b){if(W(H),_!=null&&_.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const $=fZ(H,b);if($.length!==3&&$.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if($.length===1&&_==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return fK(H,_,$,b)}let OQ;function OH(H,_=3){if(_>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(H==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let b=!1,$=!1,ee=!1,re=!1,ae=!1,xe=!1;if(H.data instanceof Uint8Array)b=!0;else if(typeof ImageData<"u"&&H instanceof ImageData)$=!0;else if(typeof HTMLVideoElement<"u"&&H instanceof HTMLVideoElement)ee=!0;else if(typeof HTMLImageElement<"u"&&H instanceof HTMLImageElement)re=!0;else if(H.getContext!=null)ae=!0;else if(typeof ImageBitmap<"u"&&H instanceof ImageBitmap)xe=!0;else throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+H.constructor.name);if(gB(gz,fM.backendName)!=null){const Ee={pixels:H},Ce={numChannels:_};return fM.runKernel(gz,Ee,Ce)}const[le,fe]=ee?[H.videoWidth,H.videoHeight]:[H.width,H.height];let ve;if(ae)ve=H.getContext("2d").getImageData(0,0,le,fe).data;else if($||b)ve=H.data;else if(re||ee||xe){if(OQ==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")OQ=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else OQ=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});OQ.canvas.width=le,OQ.canvas.height=fe,OQ.drawImage(H,0,0,le,fe),ve=OQ.getImageData(0,0,le,fe).data}let Se;if(_===4)Se=new Int32Array(ve);else{const Ee=le*fe;Se=new Int32Array(Ee*_);for(let Ce=0;Ce<Ee;Ce++)for(let Ie=0;Ie<_;++Ie)Se[Ce*_+Ie]=ve[Ce*4+Ie]}return Or(Se,[fe,le,_],"int32")}const OK=fL({fromPixels_:OH});function OB(H,_){const b=H.shape.length,$=_.shape.length;if(b<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+b+".");if($<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+$+".");if(_.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+_.dtype+".");if(_.shape[$-1]>b)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+_.shape[$-1]+" vs. "+b);if(i$1(H.shape)===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+H.shape+".");const ee=_.shape,re=ee[ee.length-1];let ae=1;for(let Se=0;Se<ee.length-1;++Se)ae*=ee[Se];const xe=H.shape,le=ee.slice();le.pop();let fe=1;for(let Se=re;Se<b;++Se)fe*=xe[Se],le.push(xe[Se]);const ve=[...y(H.shape).map(Se=>Se/fe),1].slice(0,re);return[le,ae,fe,ve]}function OV(H,_,b){const $=_.rank>1?_.shape[_.rank-1]:1,ee=_.rank>1?_.rank-1:1,re="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+b.shape+", indices.shape: "+_.shape+", shape: "+H+", sliceDim: "+$+", and batchDim: "+ee+".";if(b.rank<ee)throw new Error(re+(" update.rank < "+ee+". "));if(H.length<$+(b.rank-ee))throw new Error(re+(" Output shape length < "+($+(b.rank-ee))));if(b.rank!==ee+H.length-$)throw new Error(re+(" update.rank != "+(ee+H.length-$)));for(let ae=0;ae<ee;++ae)if(b.shape[ae]!==_.shape[ae])throw new Error(re+(" updates.shape["+ae+"] ("+b.shape[ae]+") != indices.shape["+ae+"] ("+_.shape[ae]+")."));for(let ae=0;ae<b.rank-ee;++ae)if(b.shape[ae+ee]!==H[ae+$])throw new Error(re+(" updates.shape["+(ae+ee)+"] ("+b.shape[ae+ee]+") != shape["+(ae+ee)+"] ("+H[ae+ee]+")"))}function OJ(H,_,b){if(_.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+_.rank+".");if(H.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+H.rank+".");if(_.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+_.dtype);if(b.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+b);if(b.length===0){if(_.size===0)throw new Error("Indices specified for empty output. indices shape: "+_.shape);if(H.size===0)throw new Error("Updates specified for empty output. updates shape: "+H.shape)}OV(b,_,H)}function OY(H,_,b){const $=_.shape.length,ee=$>1?_.shape[$-1]:1,re=b.length;let ae=1;for(let Se=ee;Se<re;++Se)ae*=b[Se];const xe=ee<1?1:ee,le=i$1(_.shape)/xe,fe=[...y(b.slice(0,ee)),1],ve=i$1(b);return{sliceRank:ee,numUpdates:le,sliceSize:ae,strides:fe,outputSize:ve}}const OP=-2,OU=-1;function Wq(H,_,b){const $=H.shape.length;k($===_.length,()=>"Error in slice"+$+"D: Length of begin "+_+" must match the rank of the array ("+$+")."),k($===b.length,()=>"Error in slice"+$+"D: Length of size "+b+" must match the rank of the array ("+$+").");for(let ee=0;ee<$;++ee)k(_[ee]+b[ee]<=H.shape[ee],()=>"Error in slice"+$+"D: begin["+ee+"] + size["+ee+"] ("+(_[ee]+b[ee])+") would overflow input.shape["+ee+"] ("+H.shape[ee]+")")}function WM(H){const _=[];let b=0;for(;H>0;)H&1&&_.push(b),H/=2,b++;return _}function WF(H,_,b){const $=[];for(let ee=0;ee<H.length;ee++)$[ee]=Math.ceil((_[ee]-H[ee])/b[ee]);return $}function Wt(H,_,b,$){const ee=[...H];for(let re=ee.length;re<$.length;re++)ee.push(1);for(let re=0;re<b;re++)re===0?ee[_]=1:(ee.splice(_,0,1),ee.pop());return ee}function WW(H,_,b){return b<=H?b:b-(_-1)}function WD(H,_){const b=[];for(let $=0;$<H;$++)b.push(_+$);return b}function WZ(H,_,b,$,ee,re,ae,xe,le){const fe=H.length;let ve=new Array(fe),Se=new Array(fe),Ee=new Array(fe);if(_.length&&b>0){const Ce=_[0],Ie=b+1;ve=We(ae,Ce,Ie,$,H),Se=Wz(xe,Ce,Ie,ee,H),Ee=Wt(re,Ce,Ie,H)}else for(let Ce=0;Ce<fe;Ce++)ve[Ce]=WG(ae,$,re,H,Ce,le),Se[Ce]=Wj(xe,ee,re,H,Ce,le),Ee[Ce]=WX(re,Ce,le);return{begin:ve,end:Se,strides:Ee}}function We(H,_,b,$,ee){const re=[...ee],ae=WD(b,_);for(let xe=0;xe<re.length;xe++)if(ae.indexOf(xe)>-1)re[xe]=0;else{const le=WW(_,b,xe);let fe=$[le];H&1<<le&&(fe=0),re[xe]=fe}return re}function Wz(H,_,b,$,ee){const re=[...ee],ae=WD(b,_);for(let xe=0;xe<re.length;xe++)if(ae.indexOf(xe)>-1)re[xe]=Number.MAX_SAFE_INTEGER;else{const le=WW(_,b,xe);let fe=$[le];H&1<<le&&(fe=Number.MAX_SAFE_INTEGER),re[xe]=fe}for(let xe=0;xe<re.length;xe++){const le=ee[xe];re[xe]<0&&(re[xe]+=le),re[xe]=E$1(0,re[xe],ee[xe])}return re}function WX(H,_,b){let $=H[_];return(b&1<<_||$==null)&&($=1),$}function WG(H,_,b,$,ee,re){let ae=_[ee];const xe=b[ee]||1;(H&1<<ee||re&1<<ee||ae==null)&&(xe>0?ae=Number.MIN_SAFE_INTEGER:ae=Number.MAX_SAFE_INTEGER);const le=$[ee];return ae<0&&(ae+=le),ae=E$1(0,ae,le-1),ae}function Wj(H,_,b,$,ee,re){let ae=_[ee];const xe=b[ee]||1;(H&1<<ee||re&1<<ee||ae==null)&&(xe>0?ae=Number.MAX_SAFE_INTEGER:ae=Number.MIN_SAFE_INTEGER);const le=$[ee];return ae<0&&(ae+=le),xe>0?ae=E$1(0,ae,le):ae=E$1(-1,ae,le-1),ae}function WL(H,_,b){let $=b.length;for(let ee=0;ee<b.length;ee++)if(b[ee]>1){$=ee;break}for(let ee=$+1;ee<b.length;ee++)if(_[ee]>0||b[ee]!==H[ee])return!1;return!0}function WR(H,_){let b=H.length>0?H[H.length-1]:1;for(let $=0;$<H.length-1;$++)b+=H[$]*_[$];return b}function WQ(H,_,b){let $;const ee=H.shape.length;typeof _=="number"?$=[_,...new Array(ee-1).fill(0)]:_.length<ee?$=_.concat(new Array(ee-_.length).fill(0)):$=_.slice(),$.forEach(ae=>{k(ae!==-1,()=>"slice() does not support negative begin indexing.")});let re;return b==null?re=new Array(ee).fill(-1):typeof b=="number"?re=[b,...new Array(ee-1).fill(-1)]:b.length<ee?re=b.concat(new Array(ee-b.length).fill(-1)):re=b,re=re.map((ae,xe)=>ae>=0?ae:(k(ae===-1,()=>"Negative size values should be exactly -1 but got "+ae+" for the slice() size at index "+xe+"."),H.shape[xe]-$[xe])),[$,re]}function WH(H,_,b,$,ee,re,ae,xe,le){let fe;if($==null?(fe=new Array(_.length),fe.fill(1)):fe=$,ae!=null&&(ae&ae-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let ve=!1;const Se={dims:fe.length,numAddAxisAfterEllipsis:0,begin:_.slice(),end:b.slice(),strides:fe.slice(),beginMask:ee,endMask:re,ellipsisMask:ae,newAxisMask:xe,shrinkAxisMask:le};for(let qe=0;qe<Se.dims;qe++)ve&&(1<<qe&xe)!==0&&Se.numAddAxisAfterEllipsis++,1<<qe&ae&&(ve=!0);ve||(Se.ellipsisMask|=1<<Se.dims,Se.dims++);const Ee={dims:H.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};WK(Se,Ee);let Ce=!0,Ie=!0,De=!0;const Be=[],Ne=[];for(let qe=0;qe<H.length;++qe){if(Ee.strides[qe]===0)throw Error("strides["+qe+"] must be non-zero");const Xe=!!(Ee.shrinkAxisMask&1<<qe),Ye=H[qe];if(Ye===-1){Be.push(Xe?1:-1);continue}const Qe=[Ee.beginMask&1<<qe,Ee.endMask&1<<qe],rt=[Ee.strides[qe]>0?0:-1,Ee.strides[qe]>0?Ye:Ye-1];if(Xe&&Ee.strides[qe]<=0)throw Error("only stride 1 allowed on non-range indexing.");De=De&&Ee.strides[qe]===1;const ot=!!(Ee.beginMask&1<<qe&&Ee.endMask&1<<qe);if(Ee.beginValid&&Ee.endValid){if(Xe){const Lt=Ee.begin[qe]<0?Ye+Ee.begin[qe]:Ee.begin[qe];if(Ee.begin[qe]=Lt,Ee.end[qe]=Ee.begin[qe]+1,Lt<0||Lt>=Ye)throw Error("slice index "+Ee.begin[qe]+" of dimension "+qe+" out of bounds.")}else Ee.begin[qe]=WB(Ee.begin[qe],0,Ee.strides[qe],Ye,Qe,rt),Ee.end[qe]=WB(Ee.end[qe],1,Ee.strides[qe],Ye,Qe,rt);const _t=Ee.strides[qe]===1&&Ee.begin[qe]===0&&Ee.end[qe]===Ye;Ce=Ce&&_t,Ie=Ie&&(qe===0&&Ee.strides[qe]===1||_t)}else Ce=Ce&&Ee.strides[qe]===1&&ot,Ie=Ie&&(qe===0&&Ee.strides[qe]===1||ot);let ct,mt=!1;if(Ee.beginValid&&Ee.endValid?(ct=Ee.end[qe]-Ee.begin[qe],mt=!0):Xe?(ct=1,mt=!0):ot&&Ye>=0&&(Ee.strides[qe]<0?ct=-Ye:ct=Ye,mt=!0),mt){let _t;ct===0||ct<0!=Ee.strides[qe]<0?_t=0:_t=Math.trunc(ct/Ee.strides[qe])+(ct%Ee.strides[qe]!==0?1:0),Be.push(_t)}else Be.push(-1)}for(let qe=0;qe<Ee.finalShapeGatherIndices.length;++qe){const Xe=Ee.finalShapeGatherIndices[qe];Xe>=0?Ne.push(Be[Xe]):Xe===OP&&Ne.push(1)}return{finalShapeSparse:Ne.filter((qe,Xe)=>Ee.finalShapeGatherIndices[Xe]!==OP),finalShape:Ne,isIdentity:Ce,sliceDim0:Ie,isSimpleSlice:De,begin:Ee.begin,end:Ee.end,strides:Ee.strides}}function WK(H,_){_.beginMask=0,_.endMask=0,_.shrinkAxisMask=0;let b=0;_.beginValid=H.begin!=null,_.endValid=H.end!=null,_.begin=new Array(_.dims),_.end=new Array(_.dims),_.strides=new Array(_.dims),_.finalShapeGatherIndices=[],_.finalShapeGatherIndicesSparse=[],_.inputShapeGatherIndicesSparse=new Array(_.dims);for(let $=0;$<H.dims;$++)if(1<<$&H.ellipsisMask){const ee=Math.min(_.dims-(H.dims-$)+1+H.numAddAxisAfterEllipsis,_.dims);for(;b<ee;b++)_.begin[b]=0,_.end[b]=0,_.strides[b]=1,_.beginMask|=1<<b,_.endMask|=1<<b,_.finalShapeGatherIndices.push(b),_.finalShapeGatherIndicesSparse.push(-1),_.inputShapeGatherIndicesSparse[b]=$}else if(1<<$&H.newAxisMask)_.finalShapeGatherIndices.push(OP),_.finalShapeGatherIndicesSparse.push(-1);else{if(b===_.begin.length)throw Error("Index out of range using input dim "+b+"; input has only "+_.dims+" dims, "+_.begin.length+".");H.begin!=null&&(_.begin[b]=H.begin[$]),H.end!=null&&(_.end[b]=H.end[$]),_.strides[b]=H.strides[$],H.beginMask&1<<$&&(_.beginMask|=1<<b),H.endMask&1<<$&&(_.endMask|=1<<b),H.shrinkAxisMask&1<<$?(_.finalShapeGatherIndices.push(OU),_.finalShapeGatherIndicesSparse.push(-1),_.shrinkAxisMask|=1<<b):(_.finalShapeGatherIndices.push(b),_.finalShapeGatherIndicesSparse.push($)),_.inputShapeGatherIndicesSparse[b]=$,b++}}function WB(H,_,b,$,ee,re){if(ee[_])return b>0?re[_]:re[_+1&1];{const ae=H<0?$+H:H;return ae<re[0]?re[0]:ae>re[1]?re[1]:ae}}var WV=Object.freeze({__proto__:null,assertParamsValid:Wq,computeFlatOffset:WR,computeOutShape:WF,getNormalizedAxes:WZ,isSliceContinous:WL,maskToAxes:WM,parseSliceParams:WQ,sliceInfo:WH,startForAxis:WG,startIndicesWithElidedDims:We,stopForAxis:Wj,stopIndicesWithElidedDims:Wz,stridesForAxis:WX,stridesWithElidedDims:Wt});function WJ(H,_){let b=fG(H,"a","add"),$=fG(_,"b","add");[b,$]=MK(b,$);const ee={a:b,b:$};return fM.runKernel(qG,ee)}const WY=fL({add_:WJ});function WP(H,_){let b=fG(H,"a","floorDiv"),$=fG(_,"b","floorDiv");[b,$]=MK(b,$);const ee={a:b,b:$};return fM.runKernel(nG,ee)}const WU=fL({floorDiv_:WP});function iq(H,_){let b=fG(H,"a","div"),$=fG(_,"b","div");if([b,$]=MK(b,$),b.dtype==="int32"&&$.dtype==="int32")return WU(b,$);const ee={a:b,b:$},re={};return fM.runKernel(nW,ee,re)}const iM=fL({div_:iq});function iF(H,_){let b=fG(H,"a","mul"),$=fG(_,"b","mul");[b,$]=MK(b,$);const ee={a:b,b:$};return fM.runKernel(pF,ee)}const it=fL({mul_:iF});function iW(H){const _=fG(H,"x","abs");if(_.dtype==="complex64"){const b={x:_};return fM.runKernel(qV,b)}else{const b={x:_};return fM.runKernel(qX,b)}}const iD=fL({abs_:iW});function ia(H){k(Array.isArray(H),()=>"The argument passed to tf.addN() must be a list of tensors"),k(H.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+H.length);const _=H.map((ee,re)=>fG(ee,"tensors"+re,"addN")),b=_[0];_.forEach(ee=>{if(ee.dtype!==b.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),_.forEach(ee=>{if(!D(ee.shape,b.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const $=_;return fM.runKernel(qj,$)}const iZ=fL({addN_:ia});function ie(H,_){let b=fG(H,"a","atan2"),$=fG(_,"b","atan2");[b,$]=MK(b,$);const ee={a:b,b:$};return fM.runKernel(qL,ee)}const iz=fL({atan2_:ie});function iX(H,_,b,$,ee="NHWC",re){const ae=H[3],xe=[..._,ae],le=Ds(ee);return ij(H,xe,b,re,$,null,null,le)}function iG(H,_,b,$,ee,re,ae="channelsLast"){const[xe,le]=iH(_);let fe;if(ae==="channelsLast")fe=[xe,le,H[3],H[3]];else if(ae==="channelsFirst")fe=[xe,le,H[1],H[1]];else throw new Error("Unknown dataFormat "+ae);return ij(H,fe,b,$,ee,re,!1,ae)}function iu(H,_,b,$,ee,re,ae="NDHWC"){const[xe,le,fe]=iK(_);let ve,Se;if(ae==="NDHWC")Se="channelsLast",ve=[xe,le,fe,H[4],H[4]];else if(ae==="NCDHW")Se="channelsFirst",ve=[xe,le,fe,H[1],H[1]];else throw new Error("Unknown dataFormat "+ae);return iL(H,ve,b,$,ee,!1,Se,re)}function ij(H,_,b,$,ee,re,ae=!1,xe="channelsLast"){let[le,fe,ve,Se]=[-1,-1,-1,-1];if(xe==="channelsLast")[le,fe,ve,Se]=H;else if(xe==="channelsFirst")[le,Se,fe,ve]=H;else throw new Error("Unknown dataFormat "+xe);const[Ee,Ce,,Ie]=_,[De,Be]=iH(b),[Ne,qe]=iH($),Xe=iB(Ee,Ne),Ye=iB(Ce,qe),{padInfo:Qe,outHeight:rt,outWidth:ot}=iV(ee,fe,ve,De,Be,Xe,Ye,re,xe),ct=ae?Ie*Se:Ie;let mt;return xe==="channelsFirst"?mt=[le,ct,rt,ot]:xe==="channelsLast"&&(mt=[le,rt,ot,ct]),{batchSize:le,dataFormat:xe,inHeight:fe,inWidth:ve,inChannels:Se,outHeight:rt,outWidth:ot,outChannels:ct,padInfo:Qe,strideHeight:De,strideWidth:Be,filterHeight:Ee,filterWidth:Ce,effectiveFilterHeight:Xe,effectiveFilterWidth:Ye,dilationHeight:Ne,dilationWidth:qe,inShape:H,outShape:mt,filterShape:_}}function iL(H,_,b,$,ee,re=!1,ae="channelsLast",xe){let[le,fe,ve,Se,Ee]=[-1,-1,-1,-1,-1];if(ae==="channelsLast")[le,fe,ve,Se,Ee]=H;else if(ae==="channelsFirst")[le,Ee,fe,ve,Se]=H;else throw new Error("Unknown dataFormat "+ae);const[Ce,Ie,De,,Be]=_,[Ne,qe,Xe]=iK(b),[Ye,Qe,rt]=iK($),ot=iB(Ce,Ye),ct=iB(Ie,Qe),mt=iB(De,rt),{padInfo:_t,outDepth:Lt,outHeight:Vt,outWidth:Gt}=iJ(ee,fe,ve,Se,Ne,qe,Xe,ot,ct,mt,xe),$t=re?Be*Ee:Be;let Qt;return ae==="channelsFirst"?Qt=[le,$t,Lt,Vt,Gt]:ae==="channelsLast"&&(Qt=[le,Lt,Vt,Gt,$t]),{batchSize:le,dataFormat:ae,inDepth:fe,inHeight:ve,inWidth:Se,inChannels:Ee,outDepth:Lt,outHeight:Vt,outWidth:Gt,outChannels:$t,padInfo:_t,strideDepth:Ne,strideHeight:qe,strideWidth:Xe,filterDepth:Ce,filterHeight:Ie,filterWidth:De,effectiveFilterDepth:ot,effectiveFilterHeight:ct,effectiveFilterWidth:mt,dilationDepth:Ye,dilationHeight:Qe,dilationWidth:rt,inShape:H,outShape:Qt,filterShape:_}}function io(H,_,b,$,ee){$==null&&($=iQ(H,_,b));const re=H[0],ae=H[1],xe=iY((re-_+2*$)/b+1,ee),le=iY((ae-_+2*$)/b+1,ee);return[xe,le]}function ir(H,_,b,$,ee,re){ee==null&&(ee=iQ(H,_[0],$[0]));const ae=[0,0,0,b];for(let xe=0;xe<3;xe++)H[xe]+2*ee>=_[xe]&&(ae[xe]=iY((H[xe]-_[xe]+2*ee)/$[xe]+1,re));return ae}function iQ(H,_,b,$=1){const ee=iB(_,$);return Math.floor((H[0]*(b-1)-b+ee)/2)}function iH(H){return typeof H=="number"?[H,H,H]:H.length===2?[H[0],H[1],1]:H}function iK(H){return typeof H=="number"?[H,H,H]:H}function iB(H,_){return _<=1?H:H+(H-1)*(_-1)}function iV(H,_,b,$,ee,re,ae,xe,le){let fe,ve,Se;if(typeof H=="number"){fe={top:H,bottom:H,left:H,right:H,type:H===0?"VALID":"NUMBER"};const Ee=io([_,b],re,$,H,xe);ve=Ee[0],Se=Ee[1]}else if(H==="same"){ve=Math.ceil(_/$),Se=Math.ceil(b/ee);const Ee=Math.max(0,(ve-1)*$+re-_),Ce=Math.max(0,(Se-1)*ee+ae-b),Ie=Math.floor(Ee/2),De=Ee-Ie,Be=Math.floor(Ce/2),Ne=Ce-Be;fe={top:Ie,bottom:De,left:Be,right:Ne,type:"SAME"}}else if(H==="valid")fe={top:0,bottom:0,left:0,right:0,type:"VALID"},ve=Math.ceil((_-re+1)/$),Se=Math.ceil((b-ae+1)/ee);else if(typeof H=="object"){const Ee=le==="channelsLast"?H[1][0]:H[2][0],Ce=le==="channelsLast"?H[1][1]:H[2][1],Ie=le==="channelsLast"?H[2][0]:H[3][0],De=le==="channelsLast"?H[2][1]:H[3][1];fe={top:Ee,bottom:Ce,left:Ie,right:De,type:Ee===0&&Ce===0&&Ie===0&&De===0?"VALID":"EXPLICIT"},ve=iY((_-re+Ee+Ce)/$+1,xe),Se=iY((b-ae+Ie+De)/ee+1,xe)}else throw Error("Unknown padding parameter: "+H);return{padInfo:fe,outHeight:ve,outWidth:Se}}function iJ(H,_,b,$,ee,re,ae,xe,le,fe,ve){let Se,Ee,Ce,Ie;if(H==="valid"&&(H=0),typeof H=="number"){Se={top:H,bottom:H,left:H,right:H,front:H,back:H,type:H===0?"VALID":"NUMBER"};const De=ir([_,b,$,1],[xe,le,fe],1,[ee,re,ae],H,ve);Ee=De[0],Ce=De[1],Ie=De[2]}else if(H==="same"){Ee=Math.ceil(_/ee),Ce=Math.ceil(b/re),Ie=Math.ceil($/ae);const De=(Ee-1)*ee+xe-_,Be=(Ce-1)*re+le-b,Ne=(Ie-1)*ae+fe-$,qe=Math.floor(De/2),Xe=De-qe,Ye=Math.floor(Be/2),Qe=Be-Ye,rt=Math.floor(Ne/2),ot=Ne-rt;Se={top:Ye,bottom:Qe,left:rt,right:ot,front:qe,back:Xe,type:"SAME"}}else throw Error("Unknown padding parameter: "+H);return{padInfo:Se,outDepth:Ee,outHeight:Ce,outWidth:Ie}}function iY(H,_){if(!_)return Math.trunc(H);switch(_){case"round":return Math.round(H);case"ceil":return Math.ceil(H);case"floor":return Math.floor(H);default:throw new Error("Unknown roundingMode "+_)}}function iP(H){const[_,b,$]=iH(H);return _===1&&b===1&&$===1}function iU(H,_){return iP(H)||iP(_)}function Dq(H){return iH(H).every(_=>_>0)}function Ds(H){if(H==="NHWC")return"channelsLast";if(H==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+H)}function DM(H,_,b){if(b!=null){if(typeof _=="string")throw Error("Error in "+H+": pad must be an integer when using dimRoundingMode "+b+" but got pad "+_+".");if(typeof _=="number")k(m$1(_),()=>"Error in "+H+": pad must be an integer when using dimRoundingMode "+b+" but got pad "+_+".");else if(typeof _=="object")_.forEach($=>{$.forEach(ee=>{k(m$1(ee),()=>"Error in "+H+": pad must be an integer when using dimRoundingMode "+b+" but got pad "+ee+".")})});else throw Error("Error in "+H+": Unknown padding parameter: "+_)}}function DF(H,_){const b={x:fG(H,"x","reshape","string_or_numeric")},$={shape:_};return fM.runKernel(pL,b,$)}const DW=fL({reshape_:DF});function DD(H,_,b,$,ee){const re=fG(H,"x","avgPool","float32"),ae=1;k(iU(b,ae),()=>"Error in avgPool: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+ae+"'");let xe=re,le=!1;re.rank===3&&(le=!0,xe=DW(re,[1,re.shape[0],re.shape[1],re.shape[2]])),k(xe.rank===4,()=>"Error in avgPool: x must be rank 4 but got rank "+xe.rank+"."),DM("avgPool",$,ee);const fe={x:xe},ve={filterSize:_,strides:b,pad:$,dimRoundingMode:ee};let Se=fM.runKernel(qR,fe,ve);return Se=OM(Se,re.dtype),le?DW(Se,[Se.shape[1],Se.shape[2],Se.shape[3]]):Se}const DZ=fL({avgPool_:DD});function Dz(H){const _={x:fG(H,"x","clone","string_or_numeric")};return fM.runKernel(no,_)}const DX=fL({clone_:Dz});function DG(H,_=0){k(H.length>=1,()=>"Pass at least one tensor to concat");const b=fu(H,"tensors","concat","string_or_numeric");if(b[0].dtype==="complex64"&&b.forEach(re=>{if(re.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+re.dtype+". ")}),b.length===1)return DX(b[0]);const $=b,ee={axis:_};return fM.runKernel(qJ,$,ee)}const Dj=fL({concat_:DG});function DL(H){const _={x:fG(H,"x","sigmoid","float32")};return fM.runKernel(pY,_)}const DR=fL({sigmoid_:DL});function DQ(H,_,b){const $=fG(H,"x","slice","string_or_numeric");if($.rank===0)throw new Error("Slicing scalar is not possible");const ee={x:$},re={begin:_,size:b};return fM.runKernel(pV,ee,re)}const DH=fL({slice_:DQ});function DK(H,_,b){const $=fG(H,"x","bincount"),ee=fG(_,"weights","bincount");k($.dtype==="int32",()=>"Error in bincount: input dtype must be int32, but got "+$.dtype),k(b>=0,()=>"size must be non-negative, but got "+b+"."),k(ee.size===$.size||ee.size===0,()=>"Error in bincount: weights must have the same size as input or0-length, but got input shape: "+$.shape+", weights shape: "+ee.shape+".");const re={x:$,weights:ee},ae={size:b};return fM.runKernel(qQ,re,ae)}const DB=fL({bincount_:DK});function DV(H,_){let b=fG(H,"broadcastTo","x");const $=b.shape;if(K(_),_.length<b.rank)throw new Error("broadcastTo(): shape.length="+_.length+" < input.rank="+b.rank+".");if(_.length>b.rank){const le=b.shape.slice();for(;le.length<_.length;)le.unshift(1);b=DW(b,le)}const ee=b.shape,re=Array.from(_);for(let le=_.length-1;le>=0;le--)if(ee[le]===_[le])re[le]=1;else if(b.shape[le]!==1)throw new Error("broadcastTo(): ["+$+"] cannot be broadcast to ["+_+"].");if(re.map((le,fe)=>le>1?fe:-1).filter(le=>le>=0).length===0)return DX(b);const ae={x:b},xe={reps:re};return fM.runKernel(gF,ae,xe)}const DJ=fL({broadcastTo_:DV});function DY(H,_="float32",b){return _=_||"float32",K(H),new EU(H,_,b)}function DP(H,_,b){K(H),b=b||Q(_);const $={shape:H,value:_,dtype:b};return fM.runKernel(ne,{},$)}function DU(H,_,b){const $=fG(H,"x","clipByValue");if(k(_<=b,()=>"Error in clip: min ("+_+") must be less than or equal to max ("+b+")."),_===b)return DP($.shape,_,$.dtype);const ee={x:$},re={clipValueMin:_,clipValueMax:b};return fM.runKernel(qK,ee,re)}const mq=fL({clipByValue_:DU});function mn(H,_){return Dj(H,_)}const ms=fL({concat2d_:mn});function mM(H,_,b,$,ee="NHWC",re=[1,1],ae){const xe=fG(H,"x","conv2d","float32"),le=fG(_,"filter","conv2d","float32");let fe=xe,ve=!1;xe.rank===3&&(ve=!0,fe=DW(xe,[1,xe.shape[0],xe.shape[1],xe.shape[2]])),k(fe.rank===4,()=>"Error in conv2d: input must be rank 4, but got rank "+fe.rank+"."),k(le.rank===4,()=>"Error in conv2d: filter must be rank 4, but got rank "+le.rank+"."),DM("conv2d",$,ae);const Se=ee==="NHWC"?fe.shape[3]:fe.shape[1];k(Se===le.shape[2],()=>"Error in conv2d: depth of input ("+Se+") must match input depth for filter "+le.shape[2]+"."),k(iU(b,re),()=>"Error in conv2D: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+re+"'"),k(Dq(re),()=>"Error in conv2D: Dilated rates should be larger than 0."),k(Dq(b),()=>"Error in conv2D: Strides should be larger than 0.");const Ee={x:fe,filter:le},Ce={strides:b,pad:$,dataFormat:ee,dilations:re,dimRoundingMode:ae},Ie=fM.runKernel(qY,Ee,Ce);return ve?DW(Ie,[Ie.shape[1],Ie.shape[2],Ie.shape[3]]):Ie}const mF=fL({conv2d_:mM});function mW(H,_,b,$,ee,re="NHWC",ae){k(H.length===_.rank,()=>"Length of inShape ("+H.length+") and rank of dy ("+_.rank+") must match");let xe=H,le=_,fe=!1;_.rank===3&&(fe=!0,le=DW(_,[1,_.shape[0],_.shape[1],_.shape[2]]),xe=[1,H[0],H[1],H[2]]),k(xe.length===4,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+xe.length+"."),k(le.rank===4,()=>"Error in conv2dDerInput: dy must be rank 4, but got rank "+le.rank),k(b.rank===4,()=>"Error in conv2dDerInput: filter must be rank 4, but got rank "+b.rank);const ve=re==="NHWC"?xe[3]:xe[1],Se=re==="NHWC"?le.shape[3]:le.shape[1];k(ve===b.shape[2],()=>"Error in conv2dDerInput: depth of input ("+ve+") must match input depth for filter "+b.shape[2]+"."),k(Se===b.shape[3],()=>"Error in conv2dDerInput: depth of output ("+Se+") must match output depth for filter "+b.shape[3]+"."),DM("conv2dDerInput",ee,ae);const Ee={dy:le,filter:b},Ce={strides:$,pad:ee,dataFormat:re,dimRoundingMode:ae,inputShape:xe},Ie=fM.runKernel(qU,Ee,Ce);return fe?DW(Ie,[Ie.shape[1],Ie.shape[2],Ie.shape[3]]):Ie}const mD=fL({conv2DBackpropInput_:mW});function ma(H,_,b,$,ee,re){const ae=fG(H,"x","conv2dTranspose"),xe=fG(_,"filter","conv2dTranspose");return mD(b,ae,xe,$,ee,"NHWC",re)}const mZ=fL({conv2dTranspose_:ma});function me(H){const _={x:fG(H,"x","cos","float32")};return fM.runKernel(nq,_)}const mz=fL({cos_:me});function mX(H,_,b="NHWC"){const $=fG(H,"x","depthToSpace","float32"),ee=b==="NHWC"?$.shape[1]:$.shape[2],re=b==="NHWC"?$.shape[2]:$.shape[3],ae=b==="NHWC"?$.shape[3]:$.shape[1];k(_>1,()=>"blockSize should be > 1 for depthToSpace, but was: "+_),k(ee*_>=0,()=>`Negative dimension size caused by overflow when multiplying
    `+ee+" and "+_+`  for depthToSpace with input shape
    `+$.shape),k(re*_>=0,()=>`Negative dimension size caused by overflow when multiplying
    `+re+" and "+_+` for depthToSpace with input shape
        `+$.shape),k(ae%(_*_)===0,()=>"Dimension size must be evenly divisible by "+_*_+" but is "+ae+" for depthToSpace with input shape "+$.shape);const xe={x:$},le={blockSize:_,dataFormat:b};return fM.runKernel(ns,xe,le)}const mG=fL({depthToSpace_:mX});function mu(H,_,b,$,ee="NHWC",re=[1,1],ae){const xe=fG(H,"x","depthwiseConv2d","float32"),le=fG(_,"filter","depthwiseConv2d","float32");let fe=xe,ve=!1;xe.rank===3&&(ve=!0,fe=DW(xe,[1,xe.shape[0],xe.shape[1],xe.shape[2]])),k(fe.rank===4,()=>"Error in depthwiseConv2d: input must be rank 4, but got rank "+fe.rank+"."),k(le.rank===4,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+le.rank+".");const Se=ee==="NHWC"?fe.shape[3]:fe.shape[1];k(Se===le.shape[2],()=>"Error in depthwiseConv2d: number of input channels ("+Se+") must match the inChannels dimension in filter "+le.shape[2]+"."),DM("depthwiseConv2d",$,ae);const Ee={x:fe,filter:le},Ce={strides:b,pad:$,dataFormat:ee,dilations:re,dimRoundingMode:ae},Ie=fM.runKernel(nM,Ee,Ce);return ve?DW(Ie,[Ie.shape[1],Ie.shape[2],Ie.shape[3]]):Ie}const mj=fL({depthwiseConv2d_:mu});function mL(H,_,b){const $=fG(_,"a","where"),ee=fG(b,"b","where"),re=fG(H,"condition","where","bool"),ae=OR(OR(re.shape,$.shape),ee.shape),xe=DJ(re,ae),le=DJ($,ae),fe=DJ(ee,ae),ve={condition:xe,t:le,e:fe};return fM.runKernel(pB,ve)}const mQ=fL({where_:mL});function mH(H){const _={x:fG(H,"x","zerosLike")};return fM.runKernel(gZ,_)}const mK=fL({zerosLike_:mH});function mB(H,..._){const b=_.map((ee,re)=>fG(ee,"tensors"+re,"einsum")),$={equation:H};return fM.runKernel(ni,b,$)}const mV=fL({einsum_:mB});function mJ(H){const _={x:fG(H,"x","elu","float32")};return fM.runKernel(nD,_)}const mY=fL({elu_:mJ});function mP(H,_){for(let b=0;b<H.length;++b)if(H[H.length-b-1]!==_-1-b)return!1;return!0}function mU(H,_,b){const $=H.length+_.length,ee=[];let re=0,ae=0;for(let xe=0;xe<$;xe++)b.indexOf(xe)===-1?ee.push(H[re++]):ee.push(_[ae++]);return ee}function aq(H,_){const b=[],$=H.length;for(let re=0;re<$;re++)_.indexOf(re)===-1&&b.push(H[re]);const ee=_.map(re=>H[re]);return[b,ee]}function aM(H,_){const b=_.map($=>1);return mU(H,b,_)}function aF(H,_,b){k(mP(_,b),()=>H+" supports only inner-most axes for now. Got axes "+_+" and rank-"+b+" input.")}function at(H,_){if(mP(H,_))return null;const b=[];for(let $=0;$<_;++$)H.indexOf($)===-1&&b.push($);return H.forEach($=>b.push($)),b}function aW(H){return H.map((_,b)=>[b,_]).sort((_,b)=>_[1]-b[1]).map(_=>_[0])}function aD(H,_){const b=[];for(let $=_-H;$<_;++$)b.push($);return b}function aZ(H,_=null,b=!1){const $={x:fG(H,"x","max")},ee={reductionIndices:_,keepDims:b};return fM.runKernel(nY,$,ee)}const az=fL({max_:aZ});function aX(H,_=null,b=!1){const $={x:fG(H,"x","min")},ee={axis:_,keepDims:b};return fM.runKernel(pq,$,ee)}const aG=fL({min_:aX});function au(H,_){let b=fG(H,"base","pow"),$=fG(_,"exp","pow");[b,$]=MK(b,$);const ee={a:b,b:$};return fM.runKernel(pz,ee)}const aj=fL({pow_:au});function aL(H,_){if((ED(H)&&_!=="string"||Array.isArray(H))&&_!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(_==="string"&&ED(H)&&!(H instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return fK(H,[],[],_)}function ao(H){const _={x:fG(H,"x","sqrt","float32")};return fM.runKernel(pP,_)}const ar=fL({sqrt_:ao});function aQ(H){const _=fG(H,"x","square"),b={};return fM.runKernel("Square",{x:_},b)}const aH=fL({square_:aQ});function aK(H,_=null,b=!1){let $=fG(H,"x","sum");$.dtype==="bool"&&($=OM($,"int32"));const ee={x:$},re={axis:_,keepDims:b};return fM.runKernel(pU,ee,re)}const aB=fL({sum_:aK});function aV(H,_="euclidean",b=null,$=!1){H=fG(H,"x","norm");const ee=aJ(H,_,b);let re=ee.shape;if($){const ae=z$1(b,H.shape);re=aM(ee.shape,ae)}return DW(ee,re)}function aJ(H,_,b=null){if(H.rank===0)return iD(H);if(H.rank!==1&&b===null)return aJ(DW(H,[-1]),_,b);if(H.rank===1||typeof b=="number"||Array.isArray(b)&&b.length===1){if(_===1)return aB(iD(H),b);if(_===1/0)return az(iD(H),b);if(_===-1/0)return aG(iD(H),b);if(_==="euclidean"||_===2)return ar(aB(aj(iD(H),aL(2,"int32")),b));throw new Error("Error in norm: invalid ord value: "+_)}if(Array.isArray(b)&&b.length===2){if(_===1)return az(aB(iD(H),b[0]),b[1]-1);if(_===1/0)return az(aB(iD(H),b[1]),b[0]);if(_===-1/0)return aG(aB(iD(H),b[1]),b[0]);if(_==="fro"||_==="euclidean")return ar(aB(aH(H),b));throw new Error("Error in norm: invalid ord value: "+_)}throw new Error("Error in norm: invalid axis: "+b)}const aY=fL({norm_:aV});function aP(H,_=null,b=!1){return aY(H,"euclidean",_,b)}fL({euclideanNorm_:aP});function Zq(H,_=0){const b=fG(H,"x","expandDims","string_or_numeric");k(_<=b.rank,()=>"Axis must be <= rank of the tensor");const $={input:b},ee={dim:_};return fM.runKernel(nZ,$,ee)}const ZM=fL({expandDims_:Zq});function ZF(H,_){const b=fG(H,"x","tile","string_or_numeric");k(b.rank===_.length,()=>"Error in transpose: rank of input "+b.rank+" must match length of reps "+_+".");const $={x:b},ee={reps:_};return fM.runKernel(gF,$,ee)}const ZW=fL({tile_:ZF});function ZD(H){const _={x:fG(H,"x","floor","float32")};return fM.runKernel(nX,_)}const Za=fL({floor_:ZD});function ZZ(H,_,b=0,$=0){const ee=fG(H,"x","gather"),re=fG(_,"indices","gather","int32"),ae={x:ee,indices:re},xe={axis:b,batchDims:$};return fM.runKernel(nu,ae,xe)}const Ze=fL({gather_:ZZ});function Zz(H,_){let b=fG(H,"a","greater","string_or_numeric"),$=fG(_,"b","greater","string_or_numeric");[b,$]=MK(b,$),OR(b.shape,$.shape);const ee={a:b,b:$};return fM.runKernel(nj,ee)}const ZX=fL({greater_:Zz});function ZG(H,_){let b=fG(H,"a","greaterEqual","string_or_numeric"),$=fG(_,"b","greaterEqual","string_or_numeric");[b,$]=MK(b,$),OR(b.shape,$.shape);const ee={a:b,b:$};return fM.runKernel(nL,ee)}const Zj=fL({greaterEqual_:ZG});function ZL(H,_=.2){const b={x:fG(H,"x","leakyRelu")},$={alpha:_};return fM.runKernel(nH,b,$)}const ZR=fL({leakyRelu_:ZL});function Zo(H,_){let b=fG(H,"a","lessEqual","string_or_numeric"),$=fG(_,"b","lessEqual","string_or_numeric");[b,$]=MK(b,$),OR(b.shape,$.shape);const ee={a:b,b:$};return fM.runKernel(nB,ee)}const Zr=fL({lessEqual_:Zo});function ZQ(H){return fM.customGrad(H)}function ZH(H,_){let b=fG(H,"a","sub"),$=fG(_,"b","sub");[b,$]=MK(b,$);const ee={a:b,b:$};return fM.runKernel(gM,ee)}const ZK=fL({sub_:ZH});function ZB(H,_){const b=fG(H,"a","logicalAnd","bool"),$=fG(_,"b","logicalAnd","bool");OR(b.shape,$.shape);const ee={a:b,b:$};return fM.runKernel(nV,ee)}const ZV=fL({logicalAnd_:ZB});function ZJ(H,_,b,$,ee){const re=fG(H,"x","maxPool"),ae=1;let xe=re,le=!1;re.rank===3&&(le=!0,xe=DW(re,[1,re.shape[0],re.shape[1],re.shape[2]])),k(xe.rank===4,()=>"Error in maxPool: input must be rank 4 but got rank "+xe.rank+"."),k(iU(b,ae),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+ae+"'"),DM("maxPool",$,ee);const fe={x:xe},ve={filterSize:_,strides:b,pad:$,dimRoundingMode:ee},Se=fM.runKernel(nU,fe,ve);return le?DW(Se,[Se.shape[1],Se.shape[2],Se.shape[3]]):Se}const ZY=fL({maxPool_:ZJ});function ZP(H,_){let b=fG(H,"a","maximum"),$=fG(_,"b","maximum");[b,$]=MK(b,$),b.dtype==="bool"&&(b=OM(b,"int32"),$=OM($,"int32")),OR(b.shape,$.shape);const ee={a:b,b:$};return fM.runKernel(nP,ee)}const ZU=fL({maximum_:ZP});function wq(H,_=null,b=!1){const $={x:fG(H,"x","mean")},ee={axis:_,keepDims:b};return fM.runKernel(p1,$,ee)}const wM=fL({mean_:wq});function wF(H,_="float32"){if(K(H),_==="complex64"){const $=wF(H,"float32"),ee=wF(H,"float32");return fH($,ee)}const b=T(i$1(H),_);return fM.makeTensor(b,H,_)}function wW(H,_="float32"){if(K(H),_==="complex64"){const $=wW(H,"float32"),ee=wF(H,"float32");return fH($,ee)}const b=h$1(i$1(H),_);return fM.makeTensor(b,H,_)}function wD(H,_){let b=fG(H,"a","minimum"),$=fG(_,"b","minimum");[b,$]=MK(b,$),b.dtype==="bool"&&(b=OM(b,"int32"),$=OM($,"int32")),OR(b.shape,$.shape);const ee={a:b,b:$};return fM.runKernel(pM,ee)}const wZ=fL({minimum_:wD});function we(H,_,b=0){const $=fG(H,"x","pad");if($.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const ee={paddings:_,constantValue:b},re={x:$};return fM.runKernel(pe,re,ee)}const wz=fL({pad_:we});function wX(H,_){const b=fG(H,"x","prelu"),$=fG(_,"alpha","prelu"),ee={x:b,alpha:$};return fM.runKernel(pX,ee)}const wG=fL({prelu_:wX});function wu(H,_=!1){console.log(H.toString(_))}var wj={exports:{}};(function(H){(function(_,b,$){function ee(le){var fe=this,ve=xe();fe.next=function(){var Se=2091639*fe.s0+fe.c*23283064365386963e-26;return fe.s0=fe.s1,fe.s1=fe.s2,fe.s2=Se-(fe.c=Se|0)},fe.c=1,fe.s0=ve(" "),fe.s1=ve(" "),fe.s2=ve(" "),fe.s0-=ve(le),fe.s0<0&&(fe.s0+=1),fe.s1-=ve(le),fe.s1<0&&(fe.s1+=1),fe.s2-=ve(le),fe.s2<0&&(fe.s2+=1),ve=null}function re(le,fe){return fe.c=le.c,fe.s0=le.s0,fe.s1=le.s1,fe.s2=le.s2,fe}function ae(le,fe){var ve=new ee(le),Se=fe&&fe.state,Ee=ve.next;return Ee.int32=function(){return ve.next()*4294967296|0},Ee.double=function(){return Ee()+(Ee()*2097152|0)*11102230246251565e-32},Ee.quick=Ee,Se&&(typeof Se=="object"&&re(Se,ve),Ee.state=function(){return re(ve,{})}),Ee}function xe(){var le=4022871197,fe=function(ve){ve=String(ve);for(var Se=0;Se<ve.length;Se++){le+=ve.charCodeAt(Se);var Ee=.02519603282416938*le;le=Ee>>>0,Ee-=le,Ee*=le,le=Ee>>>0,Ee-=le,le+=Ee*4294967296}return(le>>>0)*23283064365386963e-26};return fe}b&&b.exports?b.exports=ae:this.alea=ae})(xq,H)})(wj);var wL=wj.exports,wQ={exports:{}};(function(H){(function(_,b,$){function ee(xe){var le=this,fe="";le.x=0,le.y=0,le.z=0,le.w=0,le.next=function(){var Se=le.x^le.x<<11;return le.x=le.y,le.y=le.z,le.z=le.w,le.w^=le.w>>>19^Se^Se>>>8},xe===(xe|0)?le.x=xe:fe+=xe;for(var ve=0;ve<fe.length+64;ve++)le.x^=fe.charCodeAt(ve)|0,le.next()}function re(xe,le){return le.x=xe.x,le.y=xe.y,le.z=xe.z,le.w=xe.w,le}function ae(xe,le){var fe=new ee(xe),ve=le&&le.state,Se=function(){return(fe.next()>>>0)/4294967296};return Se.double=function(){do var Ee=fe.next()>>>11,Ce=(fe.next()>>>0)/4294967296,Ie=(Ee+Ce)/(1<<21);while(Ie===0);return Ie},Se.int32=fe.next,Se.quick=Se,ve&&(typeof ve=="object"&&re(ve,fe),Se.state=function(){return re(fe,{})}),Se}b&&b.exports?b.exports=ae:this.xor128=ae})(xq,H)})(wQ);var wH=wQ.exports,wK={exports:{}};(function(H){(function(_,b,$){function ee(xe){var le=this,fe="";le.next=function(){var Se=le.x^le.x>>>2;return le.x=le.y,le.y=le.z,le.z=le.w,le.w=le.v,(le.d=le.d+362437|0)+(le.v=le.v^le.v<<4^(Se^Se<<1))|0},le.x=0,le.y=0,le.z=0,le.w=0,le.v=0,xe===(xe|0)?le.x=xe:fe+=xe;for(var ve=0;ve<fe.length+64;ve++)le.x^=fe.charCodeAt(ve)|0,ve==fe.length&&(le.d=le.x<<10^le.x>>>4),le.next()}function re(xe,le){return le.x=xe.x,le.y=xe.y,le.z=xe.z,le.w=xe.w,le.v=xe.v,le.d=xe.d,le}function ae(xe,le){var fe=new ee(xe),ve=le&&le.state,Se=function(){return(fe.next()>>>0)/4294967296};return Se.double=function(){do var Ee=fe.next()>>>11,Ce=(fe.next()>>>0)/4294967296,Ie=(Ee+Ce)/(1<<21);while(Ie===0);return Ie},Se.int32=fe.next,Se.quick=Se,ve&&(typeof ve=="object"&&re(ve,fe),Se.state=function(){return re(fe,{})}),Se}b&&b.exports?b.exports=ae:this.xorwow=ae})(xq,H)})(wK);var wB=wK.exports,wV={exports:{}};(function(H){(function(_,b,$){function ee(xe){var le=this;le.next=function(){var ve=le.x,Se=le.i,Ee,Ce;return Ee=ve[Se],Ee^=Ee>>>7,Ce=Ee^Ee<<24,Ee=ve[Se+1&7],Ce^=Ee^Ee>>>10,Ee=ve[Se+3&7],Ce^=Ee^Ee>>>3,Ee=ve[Se+4&7],Ce^=Ee^Ee<<7,Ee=ve[Se+7&7],Ee=Ee^Ee<<13,Ce^=Ee^Ee<<9,ve[Se]=Ce,le.i=Se+1&7,Ce};function fe(ve,Se){var Ee,Ce=[];if(Se===(Se|0))Ce[0]=Se;else for(Se=""+Se,Ee=0;Ee<Se.length;++Ee)Ce[Ee&7]=Ce[Ee&7]<<15^Se.charCodeAt(Ee)+Ce[Ee+1&7]<<13;for(;Ce.length<8;)Ce.push(0);for(Ee=0;Ee<8&&Ce[Ee]===0;++Ee);for(Ee==8?Ce[7]=-1:Ce[Ee],ve.x=Ce,ve.i=0,Ee=256;Ee>0;--Ee)ve.next()}fe(le,xe)}function re(xe,le){return le.x=xe.x.slice(),le.i=xe.i,le}function ae(xe,le){xe==null&&(xe=+new Date);var fe=new ee(xe),ve=le&&le.state,Se=function(){return(fe.next()>>>0)/4294967296};return Se.double=function(){do var Ee=fe.next()>>>11,Ce=(fe.next()>>>0)/4294967296,Ie=(Ee+Ce)/(1<<21);while(Ie===0);return Ie},Se.int32=fe.next,Se.quick=Se,ve&&(ve.x&&re(ve,fe),Se.state=function(){return re(fe,{})}),Se}b&&b.exports?b.exports=ae:this.xorshift7=ae})(xq,H)})(wV);var wJ=wV.exports,wY={exports:{}};(function(H){(function(_,b,$){function ee(xe){var le=this;le.next=function(){var ve=le.w,Se=le.X,Ee=le.i,Ce,Ie;return le.w=ve=ve+1640531527|0,Ie=Se[Ee+34&127],Ce=Se[Ee=Ee+1&127],Ie^=Ie<<13,Ce^=Ce<<17,Ie^=Ie>>>15,Ce^=Ce>>>12,Ie=Se[Ee]=Ie^Ce,le.i=Ee,Ie+(ve^ve>>>16)|0};function fe(ve,Se){var Ee,Ce,Ie,De,Be,Ne=[],qe=128;for(Se===(Se|0)?(Ce=Se,Se=null):(Se=Se+"\0",Ce=0,qe=Math.max(qe,Se.length)),Ie=0,De=-32;De<qe;++De)Se&&(Ce^=Se.charCodeAt((De+32)%Se.length)),De===0&&(Be=Ce),Ce^=Ce<<10,Ce^=Ce>>>15,Ce^=Ce<<4,Ce^=Ce>>>13,De>=0&&(Be=Be+1640531527|0,Ee=Ne[De&127]^=Ce+Be,Ie=Ee==0?Ie+1:0);for(Ie>=128&&(Ne[(Se&&Se.length||0)&127]=-1),Ie=127,De=4*128;De>0;--De)Ce=Ne[Ie+34&127],Ee=Ne[Ie=Ie+1&127],Ce^=Ce<<13,Ee^=Ee<<17,Ce^=Ce>>>15,Ee^=Ee>>>12,Ne[Ie]=Ce^Ee;ve.w=Be,ve.X=Ne,ve.i=Ie}fe(le,xe)}function re(xe,le){return le.i=xe.i,le.w=xe.w,le.X=xe.X.slice(),le}function ae(xe,le){xe==null&&(xe=+new Date);var fe=new ee(xe),ve=le&&le.state,Se=function(){return(fe.next()>>>0)/4294967296};return Se.double=function(){do var Ee=fe.next()>>>11,Ce=(fe.next()>>>0)/4294967296,Ie=(Ee+Ce)/(1<<21);while(Ie===0);return Ie},Se.int32=fe.next,Se.quick=Se,ve&&(ve.X&&re(ve,fe),Se.state=function(){return re(fe,{})}),Se}b&&b.exports?b.exports=ae:this.xor4096=ae})(xq,H)})(wY);var wP=wY.exports,wU={exports:{}};(function(H){(function(_,b,$){function ee(xe){var le=this,fe="";le.next=function(){var Se=le.b,Ee=le.c,Ce=le.d,Ie=le.a;return Se=Se<<25^Se>>>7^Ee,Ee=Ee-Ce|0,Ce=Ce<<24^Ce>>>8^Ie,Ie=Ie-Se|0,le.b=Se=Se<<20^Se>>>12^Ee,le.c=Ee=Ee-Ce|0,le.d=Ce<<16^Ee>>>16^Ie,le.a=Ie-Se|0},le.a=0,le.b=0,le.c=-1640531527,le.d=1367130551,xe===Math.floor(xe)?(le.a=xe/4294967296|0,le.b=xe|0):fe+=xe;for(var ve=0;ve<fe.length+20;ve++)le.b^=fe.charCodeAt(ve)|0,le.next()}function re(xe,le){return le.a=xe.a,le.b=xe.b,le.c=xe.c,le.d=xe.d,le}function ae(xe,le){var fe=new ee(xe),ve=le&&le.state,Se=function(){return(fe.next()>>>0)/4294967296};return Se.double=function(){do var Ee=fe.next()>>>11,Ce=(fe.next()>>>0)/4294967296,Ie=(Ee+Ce)/(1<<21);while(Ie===0);return Ie},Se.int32=fe.next,Se.quick=Se,ve&&(typeof ve=="object"&&re(ve,fe),Se.state=function(){return re(fe,{})}),Se}b&&b.exports?b.exports=ae:this.tychei=ae})(xq,H)})(wU);var eq=wU.exports,es={exports:{}};(function(H){(function(_,b,$){var ee=256,re=6,ae=52,xe="random",le=$.pow(ee,re),fe=$.pow(2,ae),ve=fe*2,Se=ee-1,Ee;function Ce(Ye,Qe,rt){var ot=[];Qe=Qe==!0?{entropy:!0}:Qe||{};var ct=Ne(Be(Qe.entropy?[Ye,Xe(b)]:Ye??qe(),3),ot),mt=new Ie(ot),_t=function(){for(var Lt=mt.g(re),Vt=le,Gt=0;Lt<fe;)Lt=(Lt+Gt)*ee,Vt*=ee,Gt=mt.g(1);for(;Lt>=ve;)Lt/=2,Vt/=2,Gt>>>=1;return(Lt+Gt)/Vt};return _t.int32=function(){return mt.g(4)|0},_t.quick=function(){return mt.g(4)/4294967296},_t.double=_t,Ne(Xe(mt.S),b),(Qe.pass||rt||function(Lt,Vt,Gt,$t){return $t&&($t.S&&De($t,mt),Lt.state=function(){return De(mt,{})}),Gt?($[xe]=Lt,Vt):Lt})(_t,ct,"global"in Qe?Qe.global:this==$,Qe.state)}function Ie(Ye){var Qe,rt=Ye.length,ot=this,ct=0,mt=ot.i=ot.j=0,_t=ot.S=[];for(rt||(Ye=[rt++]);ct<ee;)_t[ct]=ct++;for(ct=0;ct<ee;ct++)_t[ct]=_t[mt=Se&mt+Ye[ct%rt]+(Qe=_t[ct])],_t[mt]=Qe;(ot.g=function(Lt){for(var Vt,Gt=0,$t=ot.i,Qt=ot.j,vt=ot.S;Lt--;)Vt=vt[$t=Se&$t+1],Gt=Gt*ee+vt[Se&(vt[$t]=vt[Qt=Se&Qt+Vt])+(vt[Qt]=Vt)];return ot.i=$t,ot.j=Qt,Gt})(ee)}function De(Ye,Qe){return Qe.i=Ye.i,Qe.j=Ye.j,Qe.S=Ye.S.slice(),Qe}function Be(Ye,Qe){var rt=[],ot=typeof Ye,ct;if(Qe&&ot=="object")for(ct in Ye)try{rt.push(Be(Ye[ct],Qe-1))}catch{}return rt.length?rt:ot=="string"?Ye:Ye+"\0"}function Ne(Ye,Qe){for(var rt=Ye+"",ot,ct=0;ct<rt.length;)Qe[Se&ct]=Se&(ot^=Qe[Se&ct]*19)+rt.charCodeAt(ct++);return Xe(Qe)}function qe(){try{var Ye;return Ee&&(Ye=Ee.randomBytes)?Ye=Ye(ee):(Ye=new Uint8Array(ee),(_.crypto||_.msCrypto).getRandomValues(Ye)),Xe(Ye)}catch{var Qe=_.navigator,rt=Qe&&Qe.plugins;return[+new Date,_,rt,_.screen,Xe(b)]}}function Xe(Ye){return String.fromCharCode.apply(0,Ye)}if(Ne($.random(),b),H.exports){H.exports=Ce;try{Ee=require("crypto")}catch{}}else $["seed"+xe]=Ce})(typeof self<"u"?self:xq,[],Math)})(es);var eM=es.exports,eF=wL,et=wH,eW=wB,ei=wJ,eD=wP,eZ$1=eq,ez=eM;ez.alea=eF,ez.xor128=et,ez.xorwow=eW,ez.xorshift7=ei,ez.xor4096=eD,ez.tychei=eZ$1;function eX(H,_,b=1,$="float32"){if(b===0)throw new Error("Cannot have a step of zero");const ee={start:H,stop:_,step:b,dtype:$};return fM.runKernel(pG,{},ee)}function eG(H){const _={x:fG(H,"x","relu")};return fM.runKernel(pj,_)}const ej=fL({relu_:eG});function eL(H){const _={x:fG(H,"x","relu6")};return fM.runKernel(pQ,_)}const eo=fL({relu6_:eL});function eQ(H){const _={x:fG(H,"x","round")};return fM.runKernel(pH,_)}const eH=fL({round_:eQ});function eK(H){const _={x:fG(H,"x","sin","float32")};return fM.runKernel(pJ,_)}const eB=fL({sin_:eK});function eV(H,_,b){const $=fG(H,"x","slice3d");return k($.rank===3,()=>"slice3d expects a rank-3 tensor, but got a rank-"+$.rank+" tensor"),DH($,_,b)}fL({slice3d_:eV});function eY(H,_,b=0){const $={x:fG(H,"x","split")},ee={numOrSizeSplits:_,axis:b};return fM.runKernel(gq,$,ee)}const eP=fL({split_:eY});function eU$1(H,_){const b=fG(H,"x","squeeze","string_or_numeric");return DW(b,c$1(b.shape,_).newShape)}const zq=fL({squeeze_:eU$1});function zM(H,_=0){const b=fu(H,"tensors","stack","string_or_numeric");k(b.length>=1,()=>"Pass at least one tensor to tf.stack"),b.length>0&&k(_<=b[0].rank,()=>"Axis must be <= rank of the tensor");const $=b,ee={axis:_};return fM.runKernel(pZ,$,ee)}const zF=fL({stack_:zM});function zW(H,_=0){const b={x:fG(H,"x","step")},$={alpha:_};return fM.runKernel(ge,b,$)}const zD=fL({step_:zW});function zZ(H,_,b,$,ee=0,re=0,ae=0,xe=0,le=0){const fe={x:fG(H,"x","stridedSlice","string_or_numeric")},ve={begin:_,end:b,strides:$,beginMask:ee,endMask:re,ellipsisMask:ae,newAxisMask:xe,shrinkAxisMask:le};return fM.runKernel(gs,fe,ve)}const ze=fL({stridedSlice_:zZ});function zz(H,_){W(H);const b=fZ(H,_);if(b.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return fK(H,null,b,_)}function zX(H,_,b){W(H);const $=fZ(H,b);if($.length!==2&&$.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if($.length===1&&_==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return fK(H,_,$,b)}function zG(H,_,b){const $=fG(H,"tensor","tensorScatterupdate"),ee=fG(_,"indices","tensorScatterupdate","int32"),re=fG(b,"updates","tensorScatterupdate");if(OJ(re,ee,$.shape),$.dtype!==re.dtype)throw new Error("tensor and updates must have the same dtype, instead they are "+$.dtype+" and "+re.dtype+".");const ae={tensor:$,indices:ee,updates:re},xe={};return fM.runKernel(pK,ae,xe)}fL({tensorScatterUpdate_:zG});function zj(H,_=0){const b=fG(H,"x","unstack","string_or_numeric");k(_>=-b.shape.length&&_<b.shape.length,()=>"Axis = "+_+" is not in [-"+b.shape.length+", "+b.shape.length+")");const $={value:b},ee={axis:_};return fM.runKernel(ga,$,ee)}const zL=fL({unstack_:zj});function zR(H,_){const b=[];for(let re=0;re<_.length;re++)_[re]&&b.push(re);const $=DY(H,"int32"),ee=DY([b.length,H.length],"int32");for(let re=0;re<b.length;re++){const ae=$.indexToLoc(b[re]),xe=re*H.length;ee.values.set(ae,xe)}return ee.toTensor()}function zQ(H,_,b,$,ee,re="NHWC",ae){let xe=H;H.rank===3&&(xe=DW(H,[1,H.shape[0],H.shape[1],H.shape[2]]));let le=_;le.rank===3&&(le=DW(_,[1,_.shape[0],_.shape[1],_.shape[2]])),k(xe.rank===4,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+xe.shape+"."),k(le.rank===4,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+le.shape+"."),k(b.length===4,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+b+".");const fe=re==="NHWC"?xe.shape[3]:xe.shape[1],ve=re==="NHWC"?le.shape[3]:le.shape[1];k(fe===b[2],()=>"Error in conv2dDerFilter: depth of input "+fe+") must match input depth in filter ("+b[2]+"."),k(ve===b[3],()=>"Error in conv2dDerFilter: depth of dy ("+ve+") must match output depth for filter ("+b[3]+")."),DM("conv2dDerFilter",ee,ae);const Se={x:xe,dy:le},Ee={strides:$,pad:ee,dataFormat:re,dimRoundingMode:ae,filterShape:b};return fM.runKernel(qP,Se,Ee)}const zH=fL({conv2DBackpropFilter_:zQ});function zK(H,_,b){if(b==null||b==="linear")return H;if(b==="relu")return it(H,zD(_));throw new Error("Cannot compute gradient for fused activation "+b+".")}function zB(H,_){let b=_;const $=OL(H.shape,_.shape);return $.length>0&&(b=aB(b,$)),DW(b,H.shape)}function zV(H,_,b,$){if(_==="linear")return H;if(_==="relu")return ej(H);if(_==="elu")return mY(H);if(_==="relu6")return eo(H);if(_==="prelu")return wG(H,b);if(_==="leakyrelu")return ZR(H,$);if(_==="sigmoid")return DR(H);throw new Error("Unknown fused activation "+_+".")}const zJ=(H,_)=>!(H>0)||_==="linear";function zY({x:H,filter:_,strides:b,pad:$,dataFormat:ee="NHWC",dilations:re=[1,1],dimRoundingMode:ae,bias:xe,activation:le="linear",preluActivationWeights:fe,leakyreluAlpha:ve}){if(le=le||"linear",zJ(fM.state.gradientDepth,le)===!1){k(ee==="NHWC",()=>"Error in fused conv2d: got dataFormat of "+ee+" but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.");let rt=mF(H,_,b,$,ee,re,ae);return xe!=null&&(rt=WY(rt,xe)),zV(rt,le,fe,ve)}const Se=fG(H,"x","conv2d","float32"),Ee=fG(_,"filter","conv2d","float32");let Ce=Se,Ie=!1;Se.rank===3&&(Ie=!0,Ce=DW(Se,[1,Se.shape[0],Se.shape[1],Se.shape[2]])),k(Ce.rank===4,()=>"Error in fused conv2d: input must be rank 4, but got rank "+Ce.rank+"."),k(Ee.rank===4,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+Ee.rank+"."),DM("fused conv2d",$,ae);const De=ee==="NHWC"?Ce.shape[3]:Ce.shape[1];k(Ee.shape[2]===De,()=>"Error in conv2d: depth of input ("+De+") must match input depth for filter "+Ee.shape[2]+"."),k(iU(b,re),()=>"Error in conv2D: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+re+"'");const Be=ij(Ce.shape,Ee.shape,b,re,$,ae);let Ne;xe!=null&&(Ne=fG(xe,"bias","fused conv2d"),[Ne]=MK(Ne,Se),ee==="NHWC"?OR(Be.outShape,Ne.shape):(k(Ne.shape.length<=1,()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-"+Ne.shape.length+"."),k(Ne.shape.length===0||Ne.shape[0]===Be.outChannels||Ne.shape[0]===1,()=>"Error in fused conv2d: bias shape ("+Ne.shape+") is not compatible with the number of output channels ("+Be.outChannels+")")));let qe;if(fe!=null){const rt=fe.shape;if(k(rt.length<=1||rt.length===3,()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-"+rt.length+"."),rt.length===1)k(rt[0]===1||rt[0]===Be.outChannels,()=>"Error in fused conv2d: PReLU activation weights ("+rt+") is not compatible with the number of output channels ("+Be.outChannels+").");else if(rt.length===3)try{OR(rt,Be.outShape)}catch{const ct="Error in fused conv2d: PReLU activation weights ("+rt+") is not compatible with the output shape of the conv2d ("+Be.outShape+").";throw Error(ct)}qe=fG(fe,"prelu weights","fused conv2d")}const Xe=(rt,ot)=>{k(ee==="NHWC",()=>"Error in gradient of fused conv2D: got dataFormat of "+ee+" but only NHWC is currently supported.");const[ct,mt,_t,Lt]=ot,Vt=zK(rt,_t,le);k(iP(re),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+re+"'");const Gt=mD(mt.shape,Vt,ct,b,$),$t=zH(mt,Vt,ct.shape,b,$),Qt=[Gt,$t];if(Lt!=null){const vt=zB(Lt,Vt);Qt.push(vt)}return Qt},Ye={x:Ce,filter:Ee,bias:Ne,preluActivationWeights:qe},Qe={strides:b,pad:$,dataFormat:ee,dilations:re,dimRoundingMode:ae,activation:le,leakyreluAlpha:ve};return xe==null?ZQ((rt,ot,ct)=>{let mt=fM.runKernel(gu,Ye,Qe);return ct([ot,rt,mt]),Ie&&(mt=DW(mt,[mt.shape[1],mt.shape[2],mt.shape[3]])),{value:mt,gradFunc:Xe}})(Ce,Ee):ZQ((rt,ot,ct,mt)=>{let _t=fM.runKernel(gu,Ye,Qe);return mt([ot,rt,_t,ct]),Ie&&(_t=DW(_t,[_t.shape[1],_t.shape[2],_t.shape[3]])),{value:_t,gradFunc:Xe}})(Ce,Ee,Ne)}const zP=fL({fusedConv2d_:zY});function zU(H,_,b,$,ee,re=[1,1],ae){let xe=H;H.rank===3&&(xe=DW(H,[1,H.shape[0],H.shape[1],H.shape[2]]));let le=_;le.rank===3&&(le=DW(_,[1,_.shape[0],_.shape[1],_.shape[2]]));const fe={x:xe,dy:le},ve={strides:$,pad:ee,dimRoundingMode:ae,dilations:re,filterShape:b};return fM.runKernel(nF,fe,ve)}const cq=fL({depthwiseConv2dNativeBackpropFilter_:zU});function cM(H,_,b,$,ee,re=[1,1],ae){let xe=_,le=!1;_.rank===3&&(le=!0,xe=DW(_,[1,_.shape[0],_.shape[1],_.shape[2]]));const fe={dy:xe,filter:b},ve={strides:$,pad:ee,dimRoundingMode:ae,dilations:re,inputShape:H},Se=fM.runKernel(nt,fe,ve);return le?DW(Se,[Se.shape[1],Se.shape[2],Se.shape[3]]):Se}const cF=fL({depthwiseConv2dNativeBackpropInput_:cM});function cW({x:H,filter:_,strides:b,pad:$,dataFormat:ee="NHWC",dilations:re=[1,1],dimRoundingMode:ae,bias:xe,activation:le="linear",preluActivationWeights:fe,leakyreluAlpha:ve}){if(zJ(fM.state.gradientDepth,le)===!1){let Qe=mj(H,_,b,$,ee,re,ae);return xe!=null&&(Qe=WY(Qe,xe)),zV(Qe,le,fe,ve)}const Se=fG(H,"x","depthwiseConv2d","float32"),Ee=fG(_,"filter","depthwiseConv2d","float32");let Ce=Se,Ie=!1;Se.rank===3&&(Ie=!0,Ce=DW(Se,[1,Se.shape[0],Se.shape[1],Se.shape[2]])),k(Ce.rank===4,()=>"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+Ce.rank+"."),k(Ee.rank===4,()=>"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+Ee.rank+"."),k(Ce.shape[3]===Ee.shape[2],()=>"Error in fused depthwiseConv2d: number of input channels ("+Ce.shape[3]+") must match the inChannels dimension in filter "+Ee.shape[2]+"."),re==null&&(re=[1,1]),k(iU(b,re),()=>"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+b+" and dilations '"+re+"'"),DM("fused depthwiseConv2d",$,ae);const De=ij(Ce.shape,Ee.shape,b,re,$,ae,!0);let Be;xe!=null&&(Be=fG(xe,"bias","fused conv2d"),[Be]=MK(Be,Se),OR(De.outShape,Be.shape));let Ne;fe!=null&&(Ne=fG(fe,"prelu weights","fused depthwiseConv2d"));const qe=(Qe,rt)=>{k(iP(re),()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+re+"'");const[ot,ct,mt,_t]=rt,Lt=zK(Qe,mt,le),Vt=cF(ct.shape,Lt,ot,b,$,re,ae),Gt=cq(ct,Lt,ot.shape,b,$,re,ae);if(_t!=null){const $t=zB(Be,Lt);return[Vt,Gt,$t]}return[Vt,Gt]},Xe={x:Ce,filter:Ee,bias:Be,preluActivationWeights:Ne},Ye={strides:b,pad:$,dataFormat:ee,dilations:re,dimRoundingMode:ae,activation:le,leakyreluAlpha:ve};return xe==null?ZQ((Qe,rt,ot)=>{let ct=fM.runKernel(gj,Xe,Ye);return ot([rt,Qe,ct]),Ie&&(ct=DW(ct,[ct.shape[1],ct.shape[2],ct.shape[3]])),{value:ct,gradFunc:qe}})(Ce,Ee):ZQ((Qe,rt,ot,ct)=>{let mt=fM.runKernel(gj,Xe,Ye);return ct([rt,Qe,mt,ot]),Ie&&(mt=DW(mt,[mt.shape[1],mt.shape[2],mt.shape[3]])),{value:mt,gradFunc:qe}})(Ce,Ee,Be)}const cD=fL({fusedDepthwiseConv2d_:cW});function ca({a:H,b:_,transposeA:b=!1,transposeB:$=!1,bias:ee,activation:re="linear",preluActivationWeights:ae,leakyreluAlpha:xe=.2}){if(zJ(fM.state.gradientDepth,re)===!1){let _t=OW(H,_,b,$);return ee!=null&&(_t=WY(_t,ee)),zV(_t,re,ae,xe)}let le=fG(H,"a","fused matMul"),fe=fG(_,"b","fused matMul");[le,fe]=MK(le,fe);const ve=b?le.shape[le.rank-2]:le.shape[le.rank-1],Se=$?fe.shape[fe.rank-1]:fe.shape[fe.rank-2],Ee=b?le.shape[le.rank-1]:le.shape[le.rank-2],Ce=$?fe.shape[fe.rank-2]:fe.shape[fe.rank-1],Ie=le.shape.slice(0,-2),De=fe.shape.slice(0,-2),Be=i$1(Ie),Ne=i$1(De);k(ve===Se,()=>"Error in fused matMul: inner shapes ("+ve+") and ("+Se+") of Tensors with shapes "+le.shape+" and "+fe.shape+" and transposeA="+b+" and transposeB="+$+" must match.");const qe=OR(le.shape.slice(0,-2),fe.shape.slice(0,-2)).concat([Ee,Ce]),Xe=b?DW(le,[Be,ve,Ee]):DW(le,[Be,Ee,ve]),Ye=$?DW(fe,[Ne,Ce,Se]):DW(fe,[Ne,Se,Ce]);let Qe;ee!=null&&(Qe=fG(ee,"bias","fused matMul"),[Qe]=MK(Qe,le),OR(qe,Qe.shape));let rt;ae!=null&&(rt=fG(ae,"prelu weights","fused matMul"));const ot=(_t,Lt)=>{const[Vt,Gt,$t,Qt]=Lt,vt=zK(DW(_t,$t.shape),$t,re);let It,gt;if(!b&&!$?(It=OW(vt,Gt,!1,!0),gt=OW(Vt,vt,!0,!1)):!b&&$?(It=OW(vt,Gt,!1,!1),gt=OW(vt,Vt,!0,!1)):b&&!$?(It=OW(Gt,vt,!1,!0),gt=OW(Vt,vt,!1,!1)):(It=OW(Gt,vt,!0,!0),gt=OW(vt,Vt,!0,!0)),ee!=null){const Tt=zB(Qt,vt);return[It,gt,Tt]}else return[It,gt]},ct={a:Xe,b:Ye,bias:Qe,preluActivationWeights:rt},mt={transposeA:b,transposeB:$,activation:re,leakyreluAlpha:xe};return ee==null?ZQ((_t,Lt,Vt)=>{const Gt=fM.runKernel(gG,ct,mt);return Vt([_t,Lt,Gt]),{value:DW(Gt,qe),gradFunc:ot}})(Xe,Ye):ZQ((_t,Lt,Vt,Gt)=>{const $t=fM.runKernel(gG,ct,mt);return Gt([_t,Lt,$t,Vt]),{value:DW($t,qe),gradFunc:ot}})(Xe,Ye,Qe)}const cZ=fL({fusedMatMul_:ca});function ce(H,_,b,$,ee="bilinear",re=0){const ae=fG(H,"image","cropAndResize"),xe=fG(_,"boxes","cropAndResize","float32"),le=fG(b,"boxInd","cropAndResize","int32"),fe=xe.shape[0];k(ae.rank===4,()=>"Error in cropAndResize: image must be rank 4,but got rank "+ae.rank+"."),k(xe.rank===2&&xe.shape[1]===4,()=>"Error in cropAndResize: boxes must be have size ["+fe+",4] but had shape "+xe.shape+"."),k(le.rank===1&&le.shape[0]===fe,()=>"Error in cropAndResize: boxInd must be have size ["+fe+"] but had shape "+xe.shape+"."),k($.length===2,()=>"Error in cropAndResize: cropSize must be of length 2, but got length "+$.length+"."),k($[0]>=1&&$[1]>=1,()=>"cropSize must be atleast [1,1], but was "+$),k(ee==="bilinear"||ee==="nearest",()=>"method must be bilinear or nearest, but was "+ee);const ve={image:ae,boxes:xe,boxInd:le},Se={method:ee,extrapolationValue:re,cropSize:$};return fM.runKernel(nn,ve,Se)}const cz=fL({cropAndResize_:ce});function cX(H){const _=fG(H,"image","flipLeftRight","float32");k(_.rank===4,()=>"Error in flipLeftRight: image must be rank 4,but got rank "+_.rank+".");const b={image:_};return fM.runKernel(nz,b,{})}const cG=fL({flipLeftRight_:cX});function cu(H){const _=fG(H,"image","grayscaleToRGB"),b=_.rank-1,$=_.shape[b];k(_.rank>=2,()=>"Error in grayscaleToRGB: images must be at least rank 2, but got rank "+_.rank+"."),k($===1,()=>"Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size "+$+".");const ee=new Array(_.rank);return ee.fill(1,0,b),ee[b]=3,ZW(_,ee)}const cj=fL({grayscaleToRGB_:cu});function cL(H){const _=fG(H,"image","RGBToGrayscale"),b=_.rank-1,$=_.shape[b];k(_.rank>=2,()=>"Error in RGBToGrayscale: images must be at least rank 2, but got rank "+_.rank+"."),k($===3,()=>"Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size "+$+".");const ee=_.dtype,re=OM(_,"float32"),ae=zz([.2989,.587,.114]);let xe;switch(_.rank){case 2:xe=mV("ij,j->i",re,ae);break;case 3:xe=mV("ijk,k->ij",re,ae);break;case 4:xe=mV("ijkl,l->ijk",re,ae);break;case 5:xe=mV("ijklm,m->ijkl",re,ae);break;case 6:xe=mV("ijklmn,n->ijklm",re,ae);break;default:throw new Error("Not a valid tensor rank.")}return xe=ZM(xe,-1),OM(xe,ee)}const co=fL({rgbToGrayscale_:cL});function cr(H,_,b=0,$=.5){const ee=fG(H,"image","rotateWithOffset","float32");k(ee.rank===4,()=>"Error in rotateWithOffset: image must be rank 4,but got rank "+ee.rank+".");const re={image:ee},ae={radians:_,fillValue:b,center:$};return fM.runKernel(gX,re,ae)}const cQ=fL({rotateWithOffset_:cr});function cH(H,_,b,$,ee,re){$==null&&($=.5),ee==null&&(ee=Number.NEGATIVE_INFINITY),re==null&&(re=0);const ae=H.shape[0];return b=Math.min(b,ae),k(0<=$&&$<=1,()=>"iouThreshold must be in [0, 1], but was '"+$+"'"),k(H.rank===2,()=>"boxes must be a 2D tensor, but was of rank '"+H.rank+"'"),k(H.shape[1]===4,()=>"boxes must have 4 columns, but 2nd dimension was "+H.shape[1]),k(_.rank===1,()=>"scores must be a 1D tensor"),k(_.shape[0]===ae,()=>"scores has incompatible shape with boxes. Expected "+ae+", but was "+_.shape[0]),k(0<=re&&re<=1,()=>"softNmsSigma must be in [0, 1], but was '"+re+"'"),{maxOutputSize:b,iouThreshold:$,scoreThreshold:ee,softNmsSigma:re}}function cK(H,_,b,$=.5,ee=Number.NEGATIVE_INFINITY){const re=fG(H,"boxes","nonMaxSuppression","float32"),ae=fG(_,"scores","nonMaxSuppression","float32"),xe=cH(re,ae,b,$,ee);b=xe.maxOutputSize,$=xe.iouThreshold,ee=xe.scoreThreshold;const le={maxOutputSize:b,iouThreshold:$,scoreThreshold:ee};return fM.runKernel(pW,{boxes:re,scores:ae},le)}const cB=fL({nonMaxSuppression_:cK});function cV(H,_,b){const $=cJ(H,_,b),ee=$<0?-($+1):$;H.splice(ee,0,_)}function cJ(H,_,b){return cP(H,_,b||cY)}function cY(H,_){return H>_?1:H<_?-1:0}function cP(H,_,b){let $=0,ee=H.length,re=0,ae=!1;for(;$<ee;){re=$+(ee-$>>>1);const xe=b(_,H[re]);xe>0?$=re+1:(ee=re,ae=!xe)}return ae?$:-$-1}function cU(H,_,b,$,ee){return Xn(H,_,b,$,ee,0)}function X6(H,_,b,$,ee,re){return Xn(H,_,b,$,ee,0,!1,re,!0)}function Xq(H,_,b,$,ee,re){return Xn(H,_,b,$,ee,re,!0)}function Xn(H,_,b,$,ee,re,ae=!1,xe=!1,le=!1){const fe=[];for(let Be=0;Be<_.length;Be++)_[Be]>ee&&fe.push({score:_[Be],boxIndex:Be,suppressBeginIndex:0});fe.sort(Xt);const ve=re>0?-.5/re:0,Se=[],Ee=[];for(;Se.length<b&&fe.length>0;){const Be=fe.pop(),{score:Ne,boxIndex:qe,suppressBeginIndex:Xe}=Be;if(Ne<ee)break;let Ye=!1;for(let Qe=Se.length-1;Qe>=Xe;--Qe){const rt=XM(H,qe,Se[Qe]);if(rt>=$){Ye=!0;break}if(Be.score=Be.score*XF($,ve,rt),Be.score<=ee)break}Be.suppressBeginIndex=Se.length,Ye||(Be.score===Ne?(Se.push(qe),Ee.push(Be.score)):Be.score>ee&&cV(fe,Be,Xt))}const Ce=Se.length,Ie=b-Ce;xe&&Ie>0&&(Se.push(...new Array(Ie).fill(0)),Ee.push(...new Array(Ie).fill(0)));const De={selectedIndices:Se};return ae&&(De.selectedScores=Ee),le&&(De.validOutputs=Ce),De}function XM(H,_,b){const $=H.subarray(_*4,_*4+4),ee=H.subarray(b*4,b*4+4),re=Math.min($[0],$[2]),ae=Math.min($[1],$[3]),xe=Math.max($[0],$[2]),le=Math.max($[1],$[3]),fe=Math.min(ee[0],ee[2]),ve=Math.min(ee[1],ee[3]),Se=Math.max(ee[0],ee[2]),Ee=Math.max(ee[1],ee[3]),Ce=(xe-re)*(le-ae),Ie=(Se-fe)*(Ee-ve);if(Ce<=0||Ie<=0)return 0;const De=Math.max(re,fe),Be=Math.max(ae,ve),Ne=Math.min(xe,Se),qe=Math.min(le,Ee),Xe=Math.max(Ne-De,0)*Math.max(qe-Be,0);return Xe/(Ce+Ie-Xe)}function XF(H,_,b){const $=Math.exp(_*b*b);return b<=H?$:0}function Xt(H,_){return H.score-_.score||H.score===_.score&&_.boxIndex-H.boxIndex}async function XW(H,_,b,$=.5,ee=Number.NEGATIVE_INFINITY){const re=fG(H,"boxes","nonMaxSuppressionAsync"),ae=fG(_,"scores","nonMaxSuppressionAsync"),xe=cH(re,ae,b,$,ee);b=xe.maxOutputSize,$=xe.iouThreshold,ee=xe.scoreThreshold;const le=await Promise.all([re.data(),ae.data()]),fe=le[0],ve=le[1],{selectedIndices:Se}=cU(fe,ve,b,$,ee);return re!==H&&re.dispose(),ae!==_&&ae.dispose(),zz(Se,"int32")}const XD=XW;function Xa(H,_,b,$=.5,ee=Number.NEGATIVE_INFINITY,re=0){const ae=fG(H,"boxes","nonMaxSuppression"),xe=fG(_,"scores","nonMaxSuppression"),le=cH(ae,xe,b,$,ee,re);b=le.maxOutputSize,$=le.iouThreshold,ee=le.scoreThreshold,re=le.softNmsSigma;const fe={boxes:ae,scores:xe},ve={maxOutputSize:b,iouThreshold:$,scoreThreshold:ee,softNmsSigma:re},Se=fM.runKernel(pa,fe,ve);return{selectedIndices:Se[0],selectedScores:Se[1]}}const XZ=fL({nonMaxSuppressionWithScore_:Xa});async function Xz(H,_,b,$=.5,ee=Number.NEGATIVE_INFINITY,re=0){const ae=fG(H,"boxes","nonMaxSuppressionAsync"),xe=fG(_,"scores","nonMaxSuppressionAsync"),le=cH(ae,xe,b,$,ee,re);b=le.maxOutputSize,$=le.iouThreshold,ee=le.scoreThreshold,re=le.softNmsSigma;const fe=await Promise.all([ae.data(),xe.data()]),ve=fe[0],Se=fe[1],{selectedIndices:Ee,selectedScores:Ce}=Xq(ve,Se,b,$,ee,re);return ae!==H&&ae.dispose(),xe!==_&&xe.dispose(),{selectedIndices:zz(Ee,"int32"),selectedScores:zz(Ce)}}const XX=Xz;function XG(H,_,b,$=.5,ee=Number.NEGATIVE_INFINITY,re=!1){const ae=fG(H,"boxes","nonMaxSuppression"),xe=fG(_,"scores","nonMaxSuppression"),le=cH(ae,xe,b,$,ee,null),fe=le.maxOutputSize,ve=le.iouThreshold,Se=le.scoreThreshold,Ee={boxes:ae,scores:xe},Ce={maxOutputSize:fe,iouThreshold:ve,scoreThreshold:Se,padToMaxOutputSize:re},Ie=fM.runKernel(pD,Ee,Ce);return{selectedIndices:Ie[0],validOutputs:Ie[1]}}const Xj=fL({nonMaxSuppressionPadded_:XG});async function XL(H,_,b,$=.5,ee=Number.NEGATIVE_INFINITY,re=!1){const ae=fG(H,"boxes","nonMaxSuppressionAsync"),xe=fG(_,"scores","nonMaxSuppressionAsync"),le=cH(ae,xe,b,$,ee,null),fe=le.maxOutputSize,ve=le.iouThreshold,Se=le.scoreThreshold,[Ee,Ce]=await Promise.all([ae.data(),xe.data()]),{selectedIndices:Ie,validOutputs:De}=X6(Ee,Ce,fe,ve,Se,re);return ae!==H&&ae.dispose(),xe!==_&&xe.dispose(),{selectedIndices:zz(Ie,"int32"),validOutputs:aL(De,"int32")}}const XR=XL;function Xo(H,_,b=!1,$=!1){const ee=fG(H,"images","resizeBilinear");k(ee.rank===3||ee.rank===4,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+ee.rank+"."),k(_.length===2,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+_+"."),k($===!1||b===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let re=ee,ae=!1;ee.rank===3&&(ae=!0,re=DW(ee,[1,ee.shape[0],ee.shape[1],ee.shape[2]]));const xe={images:re},le={alignCorners:b,halfPixelCenters:$,size:_},fe=fM.runKernel(pr,xe,le);return ae?DW(fe,[fe.shape[1],fe.shape[2],fe.shape[3]]):fe}const XQ=fL({resizeBilinear_:Xo});function XH(H,_,b=!1,$=!1){const ee=fG(H,"images","resizeNearestNeighbor");k(ee.rank===3||ee.rank===4,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+ee.rank+"."),k(_.length===2,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+_+"."),k(ee.dtype==="float32"||ee.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),k($===!1||b===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let re=ee,ae=!1;ee.rank===3&&(ae=!0,re=DW(ee,[1,ee.shape[0],ee.shape[1],ee.shape[2]]));const xe={images:re},le={alignCorners:b,halfPixelCenters:$,size:_},fe=fM.runKernel(po,xe,le);return ae?DW(fe,[fe.shape[1],fe.shape[2],fe.shape[3]]):fe}const XK=fL({resizeNearestNeighbor_:XH});function XB(H,_="binary",b=!1,$=.5){const ee=fG(H,"image","threshold"),re=.2989,ae=.587,xe=.114,le=ee.shape[0]*ee.shape[1];let fe=it(zz([$]),255),ve,Se,Ee,Ce;if(k(ee.rank===3,()=>"Error in threshold: image must be rank 3,but got rank "+ee.rank+"."),k(ee.shape[2]===3||ee.shape[2]===1,()=>"Error in threshold: image color channel must be equal to 3 or 1but got "+ee.shape[2]+"."),k(ee.dtype==="int32"||ee.dtype==="float32",()=>"Error in dtype: image dtype must be int32 or float32,but got dtype "+ee.dtype+"."),k(_==="otsu"||_==="binary",()=>"Method must be binary or otsu, but was "+_),ee.shape[2]===3){[ve,Se,Ee]=eP(ee,[1,1,1],-1);const De=it(ve,re),Be=it(Se,ae),Ne=it(Ee,xe);Ce=WY(WY(De,Be),Ne)}else Ce=H;if(_==="otsu"){const De=DB(OM(eH(Ce),"int32"),fB([]),256);fe=XV(De,le)}const Ie=b?Zr(Ce,fe):ZX(Ce,fe);return OM(it(Ie,255),"int32")}function XV(H,_){let b=zz([-1]),$=zz([0]),ee=zz([0]),re,ae,xe,le,fe,ve;for(let Se=0;Se<H.size-1;Se++){re=DH(H,0,Se+1),ae=DH(H,Se+1),fe=iM(aB(re),_),ve=iM(aB(ae),_);const Ee=aB(it(re,eX(0,re.size)));xe=iM(Ee,aB(re));const Ce=DP(ae.shape,re.size),Ie=WY(eX(0,ae.size),Ce),De=it(ae,Ie);le=iM(aB(De),aB(ae));const Be=ZK(xe,le),Ne=ZK(xe,le),qe=it(fe,ve);ee=it(it(qe,Be),Ne);const Xe=ZX(ee,$);$=mQ(Xe,ee,$),b=mQ(Xe,zz([Se]),b)}return b}const XJ=fL({threshold_:XB});function XY(H,_,b="nearest",$="constant",ee=0,re){const ae=fG(H,"image","transform","float32"),xe=fG(_,"transforms","transform","float32");k(ae.rank===4,()=>"Error in transform: image must be rank 4,but got rank "+ae.rank+"."),k(xe.rank===2&&(xe.shape[0]===ae.shape[0]||xe.shape[0]===1)&&xe.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),k(re==null||re.length===2,()=>"Error in transform: outputShape must be [height, width] or null, but got "+re+".");const le={image:ae,transforms:xe},fe={interpolation:b,fillMode:$,fillValue:ee,outputShape:re};return fM.runKernel(gW,le,fe)}const XP=fL({transform_:XY});var XU;(function(H){H[H.NONE=0]="NONE",H[H.MEAN=1]="MEAN",H[H.SUM=2]="SUM",H[H.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(XU||(XU={}));const Gq={flipLeftRight:cG,grayscaleToRGB:cj,resizeNearestNeighbor:XK,resizeBilinear:XQ,rgbToGrayscale:co,rotateWithOffset:cQ,cropAndResize:cz,nonMaxSuppression:cB,nonMaxSuppressionAsync:XD,nonMaxSuppressionWithScore:XZ,nonMaxSuppressionWithScoreAsync:XX,nonMaxSuppressionPadded:Xj,nonMaxSuppressionPaddedAsync:XR,threshold:XJ,transform:XP},GM=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:H=>H();function GF(){return new Promise(H=>GM(()=>H()))}function GW(H,_){const b=H[0].length;H.forEach((ee,re)=>{k(ee.length===b,()=>"Error in concat"+b+"D: rank of tensors["+re+"] must be the same as the rank of the rest ("+b+")")}),k(_>=0&&_<b,()=>"Error in concat"+b+"D: axis must be between 0 and "+(b-1)+".");const $=H[0];H.forEach((ee,re)=>{for(let ae=0;ae<b;ae++)k(ae===_||ee[ae]===$[ae],()=>"Error in concat"+b+"D: Shape of tensors["+re+"] ("+ee+") does not match the shape of the rest ("+$+") along the non-concatenated axis "+re+".")})}function GD(H,_){const b=H[0].slice();for(let $=1;$<H.length;$++)b[_]+=H[$][_];return b}var GZ;(function(H){H[H.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",H[H.VALUE_ROWIDS=1]="VALUE_ROWIDS",H[H.ROW_LENGTHS=2]="ROW_LENGTHS",H[H.ROW_SPLITS=3]="ROW_SPLITS",H[H.ROW_LIMITS=4]="ROW_LIMITS",H[H.ROW_STARTS=5]="ROW_STARTS"})(GZ||(GZ={}));function Ge(H,_,b){let $=new Array;if(b==null&&_==null)return $;if(_==null)for(;$.length<H+b.length;)$.push(-1);else $=_.slice();if(b==null)return $;if(H+b.length!==$.length)throw new Error("rt input.shape and shape="+_+" are incompatible: rt input.rank = "+(H+b.length)+", but shape.rank = "+$.length);for(let ee=1;ee<b.length;++ee){const re=b[ee],ae=$[$.length-b.length+ee],xe=$[ae];if(re>=0)if(xe>=0){if(xe!==re)throw new Error("rt input.shape and shape="+_+" are incompatible: rt input.shape["+(ee+H)+"] = "+re+" but shape["+(ee+H)+"] = "+xe)}else $[ae]=re}return $}function Gz(H){const _={FIRST_DIM_SIZE:GZ.FIRST_DIM_SIZE,VALUE_ROWIDS:GZ.VALUE_ROWIDS,ROW_LENGTHS:GZ.ROW_LENGTHS,ROW_SPLITS:GZ.ROW_SPLITS,ROW_LIMITS:GZ.ROW_LIMITS,ROW_STARTS:GZ.ROW_STARTS},b=[];for(const $ of H)if($ in _)b.push(_[$]);else break;return b}function GX(H){return H.length===0?0:H[0]===GZ.FIRST_DIM_SIZE?H.length-1:H.length}function GG(H,_){if(H==null||_==null)return;const b=H.length,$=_.length;if(b>=$)throw new Error("defaultValue.shape="+H+" and ragged tensor flatValues.shape="+_+", are incompatible: defaultValue.rank = "+b+" must be less than ragged tensor input flatValues.rank = "+$+")");for(let ee=0;ee<Math.min(b,$-1);++ee){const re=H[ee],ae=_[ee+1];if(re>=0&&ae>=0&&re!==1&&re!==ae)throw new Error("defaultValue.shape="+H+", and ragged tensor input flatValues.shape="+_+" are incompatible: defaultValue.shape["+(ee-H.length)+"] = "+re+" but ragged tensor input.flatValues.shape["+(ee-H.length)+"] = "+ae)}}const Gj=30;function GL(H){return H<=Gj?H:v(H,Math.floor(Math.sqrt(H)))}function GR(H,_,b){const $=b*(typeof H=="number"?H:H[0]),ee=_*(typeof H=="number"?H:H[1]);return[$,ee]}function GQ(H,_,b,$=!0){let ee=[];if($)ee=ee.concat(_.slice(0)),ee.push(H[0]/b),ee=ee.concat(H.slice(1));else{ee=ee.concat(H[0]);const re=_.length;for(let ae=0;ae<re;++ae)ee=ee.concat([H[ae+1]/_[ae],_[ae]]);ee=ee.concat(H.slice(re+1))}return ee}function GH(H,_,b=!0){const $=[];if(b){$.push(_);for(let ee=_+1;ee<H;++ee)ee<=2*_?($.push(ee),$.push(ee-(_+1))):$.push(ee)}else{const ee=[],re=[];for(let ae=1;ae<H;++ae)ae>=_*2+1||ae%2===1?re.push(ae):ee.push(ae);$.push(...ee),$.push(0),$.push(...re)}return $}function GK(H,_,b,$=!0){const ee=[];$?ee.push(H[0]/b):ee.push(H[0]*b);for(let re=1;re<H.length;++re)re<=_.length?$?ee.push(_[re-1]*H[re]):ee.push(H[re]/_[re-1]):ee.push(H[re]);return ee}function GB(H,_){const b=[0];for(let $=0;$<_;++$)b.push(H[$][0]);return b}function GV(H,_,b){const $=H.slice(0,1);for(let ee=0;ee<b;++ee)$.push(H[ee+1]-_[ee][0]-_[ee][1]);return $}const GJ=1.7580993408473768,GY=1.0507009873554805,GP=.3275911,GU=.254829592,Nq=-.284496736,Nn=1.421413741,NM=-1.453152027,NF=1.061405429;function Nt(H,_){if(H.length!==_.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+H.length+", imag: "+_.length+".");const b=new Float32Array(H.length*2);for(let $=0;$<b.length;$+=2)b[$]=H[$/2],b[$+1]=_[$/2];return b}function NW(H){const _=new Float32Array(H.length/2),b=new Float32Array(H.length/2);for(let $=0;$<H.length;$+=2)_[$/2]=H[$],b[$/2]=H[$+1];return{real:_,imag:b}}function ND(H){const _=Math.ceil(H.length/4),b=new Float32Array(_),$=new Float32Array(_);for(let ee=0;ee<H.length;ee+=4)b[Math.floor(ee/4)]=H[ee],$[Math.floor(ee/4)]=H[ee+1];return{real:b,imag:$}}function NZ(H){const _=Math.floor(H.length/4),b=new Float32Array(_),$=new Float32Array(_);for(let ee=2;ee<H.length;ee+=4)b[Math.floor(ee/4)]=H[ee],$[Math.floor(ee/4)]=H[ee+1];return{real:b,imag:$}}function Nz(H,_){const b=H[_*2],$=H[_*2+1];return{real:b,imag:$}}function NX(H,_,b,$){H[$*2]=_,H[$*2+1]=b}function NG(H,_){const b=new Float32Array(H/2),$=new Float32Array(H/2);for(let ee=0;ee<Math.ceil(H/2);ee++){const re=(_?2:-2)*Math.PI*(ee/H);b[ee]=Math.cos(re),$[ee]=Math.sin(re)}return{real:b,imag:$}}function Nu(H,_,b){const $=(b?2:-2)*Math.PI*(H/_),ee=Math.cos($),re=Math.sin($);return{real:ee,imag:re}}const Nj="->",NL=/->/g,NR=",",NQ="...";function NH(H,_){H=H.replace(/\s/g,"");const b=(H.length-H.replace(NL,"").length)/Nj.length;if(b<1)throw new Error("Equations without an arrow are not supported.");if(b>1)throw new Error('Equation must contain exactly one arrow ("'+Nj+'").');const[$,ee]=H.split(Nj);k($.indexOf(NQ)===-1,()=>'The ellipsis notation ("'+NQ+'") is not supported yet.');const re=$.split(NR),ae=re.length;if(_!==ae)throw new Error("Expected "+ae+" input tensors, received "+_);if(ae>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const xe=[];for(let Ee=0;Ee<ee.length;++Ee){const Ce=ee[Ee];if(!re.some(Ie=>Ie.indexOf(Ce)!==-1))throw new Error("Output subscripts contain the label "+Ce+" not present in the input subscripts.");xe.indexOf(Ce)===-1&&xe.push(Ce)}for(let Ee=0;Ee<$.length;++Ee){const Ce=$[Ee];xe.indexOf(Ce)===-1&&Ce!==NR&&xe.push(Ce)}const le=new Array(re.length);for(let Ee=0;Ee<ae;++Ee){if(new Set(re[Ee].split("")).size!==re[Ee].length)throw new Error("Found duplicate axes in input component "+re[Ee]+". Support for duplicate axes in input is not implemented yet.");le[Ee]=[];for(let Ce=0;Ce<re[Ee].length;++Ce)le[Ee].push(xe.indexOf(re[Ee][Ce]))}const fe=xe.length,ve=ee.length,Se=[];for(let Ee=ve;Ee<fe;++Ee)Se.push(Ee);return{allDims:xe,summedDims:Se,idDims:le}}function NK(H,_){let b=new Array(H);b.fill(-1);for(let ee=0;ee<_.length;++ee)b[_[ee]]=ee;const $=[];for(let ee=0;ee<H;++ee)b[ee]===-1&&$.push(ee);return b=b.filter(ee=>ee!==-1),{permutationIndices:b,expandDims:$}}function NB(H,_,b){const $=new Array(H);for(let ee=0;ee<b.length;++ee){const re=b[ee].shape;for(let ae=0;ae<_[ee].length;++ae)$[_[ee][ae]]===void 0?$[_[ee][ae]]=re[ae]:k($[_[ee][ae]]===re[ae],()=>"Expected dimension "+$[_[ee][ae]]+" at axis "+ae+" of input shaped "+JSON.stringify(re)+", but got dimension "+re[ae])}}function NV(H,_){const b=H,$=[];let ee=0;H.length===0&&b.push(-1),ee=H.length+1;for(let ae=0;ae<ee;++ae)$.push([]);const re=[];for(let ae=0;ae<b.length;++ae){const xe=b[ae],le=NY(_,xe);for(const fe of le)re.indexOf(fe)===-1&&($[ae].push(fe),re.push(fe))}return{path:b,steps:$}}function NJ(H){return H.every((_,b)=>_===b)}function NY(H,_){const b=[];for(let $=0;$<H.length;++$)(H[$].length===0||H[$].indexOf(_)!==-1||_===-1)&&b.push($);return b}function NP(H,_,b=0){let $=[];if(typeof _=="number")k(H.shape[b]%_===0,()=>"Number of splits must evenly divide the axis."),$=new Array(_).fill(H.shape[b]/_);else{const ee=_.reduce((ae,xe)=>(xe===-1&&(ae+=1),ae),0);k(ee<=1,()=>"There should be only one negative value in split array.");const re=_.indexOf(-1);if(re!==-1){const ae=_.reduce((xe,le)=>le>0?xe+le:xe);_[re]=H.shape[b]-ae}k(H.shape[b]===_.reduce((ae,xe)=>ae+xe),()=>"The sum of sizes must match the size of the axis dimension."),$=_}return $}function NU(H){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = `+H}function uq(H,_){return"indices("+H+", 0) is invalid: "+_+" < 0"}function uM(H,_,b){return"indices("+H+", 0) is invalid: "+_+" >= "+b}function uF(H,_){return"only one output dimension may be -1, not both "+H+" and "+_}function ut(H,_){return"size "+H+" must be non-negative, not "+_}function uW(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function uD(H,_){const b=i$1(H),$=i$1(_);return"Input to reshape is a SparseTensor with "+b+`
  dense values, but the requested shape requires a multiple of `+$+". inputShape="+H+" outputShape= "+_}function ua(H,_){const b=i$1(H),$=i$1(_);return"Input to reshape is a tensor with "+b+" dense values, but the requested shape has "+$+". inputShape="+H+" outputShape="+_}function uZ(){return"segment ids must be >= 0"}function ue(){return"segment ids are not increasing"}function uz(H,_){return"Segment id "+H+" out of range [0, "+_+"), possibly because segmentIds input is not sorted."}function uX(H,_,b){return"Bad: indices["+H+"] == "+_+" out of range [0, "+b+")"}function uG(H,_){let b=!1,$;for(H<=Gj?($=H,b=!0):$=v(H,Math.floor(Math.sqrt(H)));!b;)$>_||$===H?b=!0:$=v(H,$+1);return $}function uu(H,_,b){const $=[],ee=H.length;for(let re=0;re<ee;re++)re!==_?$.push(H[re]):$.push(b);return $}function uj(H,_,b,$){const ee=_.shape.length,re=H.shape.length;if($!==0&&($<-ee||$>ee))throw new Error("Expect batchDims in the range of [-"+ee+", "+ee+"], but got "+$);if($<0&&($+=ee),$>re)throw new Error("batchDims ("+$+`) must be less than rank(x) (
    `+re+").");if(b<$)throw new Error("batchDims ("+$+") must be less than or equal to axis ("+b+").");for(let Se=0;Se<$;++Se)if(H.shape[Se]!==_.shape[Se])throw new Error("x.shape["+Se+"]: "+H.shape[Se]+" should be equal to indices.shape["+Se+"]: "+_.shape[Se]+".");const ae=H.shape[b],xe=[];let le=1,fe=1,ve=1;for(let Se=0;Se<$;++Se)xe.push(H.shape[Se]),le*=H.shape[Se];for(let Se=$;Se<b;Se++)xe.push(H.shape[Se]),fe*=H.shape[Se];for(let Se=$;Se<ee;Se++)xe.push(_.shape[Se]);for(let Se=b+1;Se<re;Se++)xe.push(H.shape[Se]),ve*=H.shape[Se];return{batchSize:le,sliceSize:ve,outerSize:fe,dimSize:ae,outputShape:xe}}var uL=Object.freeze({__proto__:null,collectGatherOpShapeInfo:uj,computeOutShape:uu,segOpComputeOptimalWindowSize:uG});function uo(H){try{return H.map(_=>EW(_))}catch(_){throw new Error("Failed to decode encoded string bytes into utf-8, error: "+_)}}function ur(H){return H.map(_=>Et(_))}var uQ=Object.freeze({__proto__:null,ERF_A1:GU,ERF_A2:Nq,ERF_A3:Nn,ERF_A4:NM,ERF_A5:NF,ERF_P:GP,PARALLELIZE_THRESHOLD:Gj,get RowPartitionType(){return GZ},SELU_SCALE:GY,SELU_SCALEALPHA:GJ,applyActivation:zV,assertAndGetBroadcastShape:OR,assertAxesAreInnerMostDims:aF,assertParamsConsistent:GW,assignToTypedArray:NX,axesAreInnerMostDims:mP,calculateShapes:OY,checkEinsumDimSizes:NB,checkPadOnDimRoundingMode:DM,combineLocations:mU,combineRaggedTensorToTensorShapes:Ge,complexWithEvenIndex:ND,complexWithOddIndex:NZ,computeConv2DInfo:ij,computeConv3DInfo:iL,computeDefaultPad:iQ,computeDilation2DInfo:iX,computeOptimalWindowSize:GL,computeOutAndReduceShapes:aq,computeOutShape:GD,computePool2DInfo:iG,computePool3DInfo:iu,convertConv2DDataFormat:Ds,decodeEinsumEquation:NH,eitherStridesOrDilationsAreOne:iU,expandShapeToKeepDim:aM,exponent:Nu,exponents:NG,fromStringArrayToUint8:ur,fromUint8ToStringArray:uo,getAxesPermutation:at,getBroadcastDims:Oj,getComplexWithIndex:Nz,getEinsumComputePath:NV,getEinsumPermutation:NK,getFusedBiasGradient:zB,getFusedDyActivation:zK,getImageCenter:GR,getInnerMostAxes:aD,getPermuted:GH,getRaggedRank:GX,getReductionAxes:OL,getReshaped:GQ,getReshapedPermuted:GK,getRowPartitionTypesHelper:Gz,getSliceBeginCoords:GB,getSliceSize:GV,getSparseFillEmptyRowsIndicesDenseShapeMismatch:NU,getSparseFillEmptyRowsNegativeIndexErrorMessage:uq,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:uM,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:uW,getSparseReshapeInputOutputMismatchErrorMessage:ua,getSparseReshapeInputOutputMultipleErrorMessage:uD,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:uF,getSparseReshapeNegativeOutputDimErrorMessage:ut,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:uX,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:uZ,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:ue,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:uz,getUndoAxesPermutation:aW,isIdentityPermutation:NJ,log:gQ,mergeRealAndImagArrays:Nt,prepareAndValidate:OB,prepareSplitSize:NP,segment_util:uL,shouldFuse:zJ,slice_util:WV,splitRealAndImagArrays:NW,stridesOrDilationsArePositive:Dq,tupleValuesAreOne:iP,upcastType:ML,validateDefaultValueShape:GG,validateInput:OJ,validateUpdateShape:OV,warn:gL});class uH{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(_,b){return fetch(_,b)}now(){return performance.now()}encode(_,b){if(b!=="utf-8"&&b!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+b);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(_)}decode(_,b){return new TextDecoder(b).decode(_)}setTimeoutCustom(_,b){if(typeof window>"u"||!qM().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(_,b);return}this.functionRefs.push(_),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},b),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",$=>{if($.source===window&&$.data.name===this.messageName){$.stopPropagation();const ee=this.functionRefs[$.data.index];ee(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(_){return gU(_)}}if(qM().get("IS_BROWSER")){qM().setPlatform("browser",new uH);try{kK.registerManager(tX.URL_SCHEME,new tL)}catch{}try{kK.registerManager(FV.URL_SCHEME,new FU)}catch{}}const uK={importFetch:()=>require("node-fetch")};let uB;class uV{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(_,b){return qM().global.fetch!=null?qM().global.fetch(_,b):(uB==null&&(uB=uK.importFetch()),uB(_,b))}now(){const _=process.hrtime();return _[0]*1e3+_[1]/1e6}encode(_,b){if(b!=="utf-8"&&b!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+b);return this.textEncoder.encode(_)}decode(_,b){return _.length===0?"":new this.util.TextDecoder(b).decode(_)}isTypedArray(_){return this.util.types.isFloat32Array(_)||this.util.types.isInt32Array(_)||this.util.types.isUint8Array(_)||this.util.types.isUint8ClampedArray(_)}}qM().get("IS_NODE")&&!qM().get("IS_BROWSER")&&qM().setPlatform("node",new uV),fn();const uJ={buffer:DY,cast:OM,clone:DX,print:wu};MM(uJ);var uY=Object.defineProperty,uP=Object.getOwnPropertySymbols,uU=Object.prototype.hasOwnProperty,j6=Object.prototype.propertyIsEnumerable,jq=(H,_,b)=>_ in H?uY(H,_,{enumerable:!0,configurable:!0,writable:!0,value:b}):H[_]=b,jM=(H,_)=>{for(var b in _||(_={}))uU.call(_,b)&&jq(H,b,_[b]);if(uP)for(var b of uP(_))j6.call(_,b)&&jq(H,b,_[b]);return H};class jF{constructor(_){this.model=_,this.posesMax=1,this.iouThresh=.3,this.scoreThresh=.5,this.model=_,this.modelSize=_.inputs[0].shape?{width:_.inputs[0].shape[2],height:_.inputs[0].shape[1]}:{width:224,height:224},this.modelRatio=this.modelSize.width/this.modelSize.height,this.anchorsData=this.buildAnchors(this.modelSize),this.anchorsX=zz(this.anchorsData.map(b=>b.x)),this.anchorsY=zz(this.anchorsData.map(b=>b.y))}async process(_){let b={x:0,y:0};const[$,ee]=Sq(()=>{const fe={width:_.shape[2],height:_.shape[1]},ve=fe.width/fe.height;let Se=jM({},fe),Ee={x:0,y:0};ve>this.modelRatio?(Se.height=_.shape[2]/this.modelRatio,Ee.y=Math.floor((Se.height-_.shape[1])*.5),b.y=Ee.y/Se.height):ve<this.modelRatio&&(Se.width=_.shape[1]*this.modelRatio,Ee.x=Math.floor((Se.width-_.shape[2])*.5),b.x=Ee.x/Se.width);const Ce=wz(_,[[0,0],[Ee.y,Ee.y],[Ee.x,Ee.x],[0,0]],0),Ie=Gq.resizeBilinear(Ce,[this.modelSize.height,this.modelSize.width]),De=this.model.execute(Ie,"person"),Be=zq(DH(De,[0,0,1],[1,-1,-1])),Ne=zq(DH(De,[0,0,0],[1,-1,1])),qe=DR(mq(Ne,-100,100));return[this.decodeBoxes(Be,[this.anchorsX,this.anchorsY],this.modelSize),qe]}),re=await $.data(),ae=await ee.data();let xe=[];for(let fe=0;fe<ae.length;fe++){if(ae[fe]<this.scoreThresh)continue;const ve=re[fe*12+2]-re[fe*12+0],Se=re[fe*12+3]-re[fe*12+1];ve<0||Se<0||xe.push({box:[[re[fe*12+0],re[fe*12+1]],[re[fe*12+2],re[fe*12+3]]],points:[[re[fe*12+4],re[fe*12+5]],[re[fe*12+6],re[fe*12+7]],[re[fe*12+8],re[fe*12+9]],[re[fe*12+10],re[fe*12+11]]],score:ae[fe]})}if($.dispose(),ee.dispose(),xe.length<1)return[];if(xe.length>1){const fe=zX(xe.map(Ie=>[Ie.box[0][1],Ie.box[0][0],Ie.box[1][1],Ie.box[1][0]])),ve=zz(xe.map(Ie=>Ie.score)),Se=await Gq.nonMaxSuppressionAsync(fe,ve,this.posesMax,this.iouThresh,this.scoreThresh),Ee=await Se.data();Se.dispose();const Ce=[];for(let Ie=0;Ie<Ee.length;Ie++)Ce.push(xe[Ee[Ie]]);xe=Ce}if(xe.length<1)return[];const le={width:1-2*b.x,height:1-2*b.y};return xe.map(fe=>({box:fe.box.map(ve=>[(ve[0]-b.x)/le.width,(ve[1]-b.y)/le.height]),points:fe.points.map(ve=>[(ve[0]-b.x)/le.width,(ve[1]-b.y)/le.height]),score:fe.score}))}decodeBoxes(_,b,$){let ee=zq(DH(_,[0,0],[-1,1])),re=zq(DH(_,[0,1],[-1,1])),ae=zq(DH(_,[0,2],[-1,1])),xe=zq(DH(_,[0,3],[-1,1]));ee=WY(iM(ee,$.width),b[0]),re=WY(iM(re,$.height),b[1]),ae=iM(ae,$.width*2),xe=iM(xe,$.height*2);const le=DW(ZK(ee,ae),[2254,1]),fe=DW(ZK(re,xe),[2254,1]),ve=DW(WY(ee,ae),[2254,1]),Se=DW(WY(re,xe),[2254,1]);let Ee=ms([le,fe,ve,Se],1);for(let Ce=0;Ce<4;Ce++){let Ie=zq(DH(_,[0,4+Ce*2],[-1,1])),De=zq(DH(_,[0,4+Ce*2+1],[-1,1]));Ie=DW(WY(iM(Ie,$.width),b[0]),[2254,1]),De=DW(WY(iM(De,$.height),b[1]),[2254,1]),Ee=ms([Ee,Ie,De],1)}return Ee}buildAnchors(_){const b=[8,16,32,32,32],$=[];let ee=0;for(;ee<5;){let re=0,ae=ee;for(;ae<b.length&&b[ae]===b[ee];)re+=2,ae++;const xe=b[ee],le=Math.ceil(_.height/xe),fe=Math.ceil(_.width/xe);for(let ve=0;ve<le;++ve)for(let Se=0;Se<fe;++Se)for(let Ee=0;Ee<re;++Ee)$.push({x:(Se+.5)/fe,y:(ve+.5)/le});ee=ae}return $}async prepare(){const{width:_,height:b}=this.modelSize,$=wF([1,b,_,3]),ee=this.model.execute($,"person");await ee.data(),$.dispose(),ee.dispose()}dispose(){this.model.dispose(),this.anchorsX.dispose(),this.anchorsY.dispose()}}class jW{constructor(_){if(this.size=_,St()!=="webgl")return;const{width:b,height:$}=_;this.backend=SD(),this.prog={variableNames:["maskT","prevT"],outputShape:[$,b],userCode:`
                void main() {
                    ivec2 c = getOutputCoords();
                    float mask = getMaskT(c[0], c[1]);
                    float prev = getPrevT(c[0], c[1]);
                    float t = mask - 0.5;
                    float x = t * t;
                    float alpha = 1.0 - min(
                        x * (5.74062006 + x * (-2.90180189 + x * (-30.34594285 +
                        x * (153.83657925 + x * (-387.53530186))))), 1.0);
                    float smoothed = mask + (prev - mask) * (alpha * 0.9);
                    setOutput(smoothed);
                }
        `}}process(_){var b;if(!this.backend||!this.prog)return;const $=this.backend.compileAndRun(this.prog,[_,this.prev||_]),ee=fU().makeTensorFromTensorInfo($);return(b=this.prev)==null||b.dispose(),this.prev=ee,ee}resize(_){const{width:b,height:$}=_;this.size={width:b,height:$},this.prog&&(this.prog.outputShape=[$,b])}reset(){var _;(_=this.prev)==null||_.dispose(),delete this.prev}async prepare(){if(!this.backend||!this.prog)return;const{width:_,height:b}=this.size,$=wF([b,_]),ee=wW([b,_]),re=this.backend.compileAndRun(this.prog,[$,ee]),ae=fU().makeTensorFromTensorInfo(re);await ae.data(),$.dispose(),ee.dispose(),ae.dispose()}dispose(){this.reset(),delete this.prog,delete this.backend}}class jD{constructor(_,b=!1){this.model=_,this.mask=b,this.sizeFactor=1.2,this.model=_,this.modelSize=_.inputs[0].shape?{width:_.inputs[0].shape[2],height:_.inputs[0].shape[1]}:{width:256,height:256},typeof b=="object"&&b.smooth&&(this.maskFilter=new jW(this.modelSize))}process(_,b){const[$,ee]=[_.shape[1],_.shape[2]],{modelSize:re}=this;return b.map(ae=>{var xe;const le=[ae.center[0]*ee,ae.center[1]*$],fe=[ae.top[0]*ee,ae.top[1]*$],ve=[fe[0]-le[0],fe[1]-le[1]],Se=Math.sqrt(ve[0]*ve[0]+ve[1]*ve[1])*this.sizeFactor,Ee=Math.atan2(ve[0],-ve[1]),Ce=[le[1]-Se,le[0]-Se,le[1]+Se,le[0]+Se],Ie=Sq(()=>{const _t=this.rotatedRect(_,Ce,Ee,re);return WY(it(_t,.5),.5)}),De=["ld_3d","world_3d","output_poseflag","activation_heatmap"];this.mask&&De.push("activation_segmentation");const[Be,Ne,qe,Xe,Ye]=this.model.execute(Ie,De),Qe=Be.dataSync(),rt=Ne.dataSync(),ot=qe.dataSync()[0];let ct=[];for(let _t=0;_t<39;_t++)ct.push([Qe[_t*5+0]/re.width,Qe[_t*5+1]/re.height,Qe[_t*5+2]/re.width]);let mt;if(Ye){const _t=Gq.rotateWithOffset(Ye,-Ee),Lt=zq(_t),Vt=((xe=this.maskFilter)==null?void 0:xe.process(Lt))||Lt,Gt=it(Vt,255);mt=new Uint8Array(Gt.dataSync()),Ye.dispose(),_t.dispose(),Lt.dispose(),Gt.dispose()}return Ie.dispose(),Be.dispose(),Ne.dispose(),qe.dispose(),ct=this.refinePoints(ct,Xe),Xe.dispose(),{points:ct,pointsData:Qe,metricData:rt,maskData:mt,score:ot,center:le,top:fe,radius:Se,angle:Ee}}).map(ae=>{const{points:xe,pointsData:le,metricData:fe,maskData:ve,score:Se,center:Ee,top:Ce,radius:Ie,angle:De}=ae;let Be=xe.map((ot,ct)=>({pixel:ot,metric:[fe[ct*3+0],fe[ct*3+1],fe[ct*3+2]],norm:[fe[ct*3+0],fe[ct*3+1],fe[ct*3+2]],score:1/(1+Math.exp(-le[ct*5+3])),visibility:1/(1+Math.exp(-le[ct*5+4]))}));Be.forEach(ot=>{ot.pixel[0]=(ot.pixel[0]-.5)*2*Ie,ot.pixel[1]=(ot.pixel[1]-.5)*2*Ie,ot.pixel[2]*=2*Ie});const Ne=Math.sin(De),qe=Math.cos(De);Be.forEach(ot=>{const ct=ot.pixel[0],mt=ot.pixel[1];ot.pixel[0]=(ct*qe-mt*Ne+Ee[0])/ee,ot.pixel[1]=(ct*Ne+mt*qe+Ee[1])/$,ot.pixel[2]/=ee;const _t=ot.metric[0],Lt=ot.metric[1];ot.metric[0]=_t*qe-Lt*Ne,ot.metric[1]=_t*Ne+Lt*qe});const Xe=Be.map(ot=>ot.pixel[0]),Ye=Be.map(ot=>ot.pixel[1]),Qe=[[Math.min(...Xe),Math.min(...Ye)],[Math.max(...Xe),Math.max(...Ye)]],rt=ve&&{buffer:ve,size:{width:256,height:256},box:[[(Ee[0]-Ie)/ee,(Ee[1]-Ie)/$],[(Ee[0]+Ie)/ee,(Ee[1]+Ie)/$]]};return{keypoints:Be,score:Se,mask:rt,center:[Be[33].pixel[0],Be[33].pixel[1]],top:[Be[34].pixel[0],Be[34].pixel[1]],debug:{center:Ee,top:Ce,box:Qe,radius:Ie,angle:De}}})}refinePoints(_,b){const $=zq(b,[0]),ee=$.bufferSync(),[re,ae,xe]=$.shape;return _.map((le,fe)=>{const ve=le,Se=Math.trunc(ve[0]*ae),Ee=Math.trunc(ve[1]*re);if(Se<0||Se>=ae||Ee<0||Ee>=re)return le;const Ce=Math.trunc(6/2),Ie=Math.max(Se-Ce,0),De=Math.min(Se+Ce+1,ae),Be=Math.max(Ee-Ce,0),Ne=Math.min(Ee+Ce+1,re);let qe=0,Xe=0,Ye=0,Qe=0;for(let rt=Be;rt<Ne;rt++)for(let ot=Ie;ot<De;ot++){const ct=ee.get(rt,ot,fe);qe+=ct,Xe=Math.max(ct,Xe),Ye+=ot*ct,Qe+=rt*ct}return $.dispose(),Xe>=.5&&qe>0?[Ye/qe/ae,Qe/qe/re,ve[2]]:le})}rotatedRect(_,b,$,ee){const[re,ae]=[b[2]-b[0],b[3]-b[1]],[xe,le]=[(b[2]+b[0])*.5,(b[3]+b[1])*.5],[fe,ve]=[re/ee.height,ae/ee.width],[Se,Ee]=[Math.cos($),Math.sin($)],Ce=[Se*ve,-Ee*fe,(-Se*ae+Ee*re)*.5+le,Ee*ve,Se*fe,(-Ee*ae-Se*re)*.5+xe,0,0];return Gq.transform(_,[Ce],"bilinear","constant",0,[ee.height,ee.width])}reset(){var _;(_=this.maskFilter)==null||_.reset()}async prepare(){var _;const{width:b,height:$}=this.modelSize,ee=wF([1,$,b,3]),re=this.model.execute(ee);await Promise.all(re.map(async ae=>{await ae.data(),ae.dispose()})),await((_=this.maskFilter)==null?void 0:_.prepare()),ee.dispose()}async dispose(){var _,b;(_=this.model)==null||_.dispose(),(b=this.maskFilter)==null||b.dispose(),delete this.maskFilter}}var jZ=Object.defineProperty,je=Object.getOwnPropertySymbols,jz=Object.prototype.hasOwnProperty,jX=Object.prototype.propertyIsEnumerable,jG=(H,_,b)=>_ in H?jZ(H,_,{enumerable:!0,configurable:!0,writable:!0,value:b}):H[_]=b,jj=(H,_)=>{for(var b in _||(_={}))jz.call(_,b)&&jG(H,b,_[b]);if(je)for(var b of je(_))jX.call(_,b)&&jG(H,b,_[b]);return H};class jL{constructor(){this.freq=30,this.pixelParams={minCutOff:1,minCutOffD:1,beta:40},this.metricParams={minCutOff:1,minCutOffD:1,beta:5},this.boxParams={minCutOff:1,minCutOffD:1,beta:5},this.scoreCutOff=1,this.visibilityCutOff=1,this.time=0}filter(_,b,$=1){return this.time>=b?_:(this.time!==0&&(this.freq=1/(b-this.time)),this.time=b,!this.raw||!this.smooth||!this.der?(this.raw=this.clonePose(_),this.smooth=this.clonePose(_),this.der={keypoints:_.keypoints.map(()=>({pixel:[0,0,0],metric:[0,0,0],norm:[0,0,0],score:0,visibility:0})),score:0,center:[0,0],top:[0,0],debug:{box:[[0,0],[0,0]],center:[0,0],top:[0,0],radius:0,angle:0}},this.clonePose(this.smooth)):(this.filterKeypoints(_.keypoints,this.raw.keypoints,this.der.keypoints,this.smooth.keypoints,$),this.filterCoord2D(_.center,this.raw.center,this.der.center,this.smooth.center,$,this.boxParams),this.filterCoord2D(_.top,this.raw.top,this.der.top,this.smooth.top,$,this.boxParams),this.smooth.score=_.score,this.smooth.mask=_.mask&&{buffer:_.mask.buffer,size:jj({},_.mask.size),box:[[..._.mask.box[0]],[..._.mask.box[1]]]},this.smooth.debug=_.debug&&{center:[..._.debug.center],top:[..._.debug.top],box:[[..._.debug.box[0]],[..._.debug.box[1]]],radius:_.debug.radius,angle:_.debug.angle},this.clonePose(this.smooth)))}filterKeypoints(_,b,$,ee,re){const ae=this.alpha(this.visibilityCutOff),xe=this.alpha(this.scoreCutOff);for(let le=0;le<_.length;le++)this.filterCoord3D(_[le].pixel,b[le].pixel,$[le].pixel,ee[le].pixel,re,this.pixelParams),this.filterCoord3D(_[le].metric,b[le].metric,$[le].metric,ee[le].metric,re,this.metricParams),this.filterCoord3D(_[le].norm,b[le].norm,$[le].norm,ee[le].norm,re,this.metricParams),ee[le].score=ee[le].score+xe*(_[le].score-ee[le].score),ee[le].visibility=ee[le].visibility+ae*(_[le].visibility-ee[le].visibility)}filterCoord3D(_,b,$,ee,re,ae){const xe=[(_[0]-ee[0])*re*this.freq,(_[1]-ee[1])*re*this.freq,(_[2]-ee[2])*re*this.freq],le=this.alpha(ae.minCutOffD);$[0]=$[0]+le*(xe[0]-$[0]),$[1]=$[1]+le*(xe[1]-$[1]),$[2]=$[2]+le*(xe[2]-$[2]);const fe=[this.alpha(ae.minCutOff+ae.beta*Math.abs($[0])),this.alpha(ae.minCutOff+ae.beta*Math.abs($[1])),this.alpha(ae.minCutOff+ae.beta*Math.abs($[2]))];ee[0]=ee[0]+fe[0]*(_[0]-ee[0]),ee[1]=ee[1]+fe[1]*(_[1]-ee[1]),ee[2]=ee[2]+fe[2]*(_[2]-ee[2]),b[0]=_[0],b[1]=_[1],b[2]=_[2]}filterCoord2D(_,b,$,ee,re,ae){const xe=[(_[0]-ee[0])*re*this.freq,(_[1]-ee[1])*re*this.freq],le=this.alpha(ae.minCutOffD);$[0]=$[0]+le*(xe[0]-$[0]),$[1]=$[1]+le*(xe[1]-$[1]);const fe=[this.alpha(ae.minCutOff+ae.beta*Math.abs($[0])),this.alpha(ae.minCutOff+ae.beta*Math.abs($[1]))];ee[0]=ee[0]+fe[0]*(_[0]-ee[0]),ee[1]=ee[1]+fe[1]*(_[1]-ee[1]),b[0]=_[0],b[1]=_[1]}reset(){delete this.raw,delete this.smooth,delete this.der}alpha(_){return 1/(1+this.freq/(2*Math.PI*_))}clonePose(_){return{keypoints:_.keypoints.map(b=>({pixel:[...b.pixel],metric:[...b.metric],norm:[...b.norm],score:b.score,visibility:b.visibility})),score:_.score,center:[..._.center],top:[..._.top],mask:_.mask&&{buffer:_.mask.buffer,size:jj({},_.mask.size),box:[[..._.mask.box[0]],[..._.mask.box[1]]]},debug:_.debug&&{box:[[..._.debug.box[0]],[..._.debug.box[1]]],center:[..._.debug.center],top:[..._.debug.top],radius:_.debug.radius,angle:_.debug.angle}}}}function jo(H,_){const b=[[Math.max(H[0][0],_[0][0]),Math.max(H[0][1],_[0][1])],[Math.min(H[1][0],_[1][0]),Math.min(H[1][1],_[1][1])]],$=(b[1][0]-b[0][0])*(b[1][1]-b[0][1]);return $/((H[1][0]-H[0][0])*(H[1][1]-H[0][1])+(_[1][0]-_[0][0])*(_[1][1]-_[0][1])-$)}var jK=(()=>{var H=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(_={}){var b=_,$,ee;b.ready=new Promise((Pt,wt)=>{$=Pt,ee=wt});var re=Object.assign({},b),ae="./this.program",xe=(Pt,wt)=>{throw wt},le=!0,fe="";function ve(Pt){return b.locateFile?b.locateFile(Pt,fe):fe+Pt}typeof document<"u"&&document.currentScript&&(fe=document.currentScript.src),H&&(fe=H),fe.startsWith("blob:")?fe="":fe=fe.substr(0,fe.replace(/[?#].*/,"").lastIndexOf("/")+1),b.print||console.log.bind(console);var Se=b.printErr||console.error.bind(console);Object.assign(b,re),re=null,b.arguments&&b.arguments,b.thisProgram&&(ae=b.thisProgram),b.quit&&(xe=b.quit);var Ee;b.wasmBinary&&(Ee=b.wasmBinary);var Ce,Ie=!1,De,Be,Ne,qe,Xe,Ye,Qe,rt,ot;function ct(){var Pt=Ce.buffer;b.HEAP8=Be=new Int8Array(Pt),b.HEAP16=qe=new Int16Array(Pt),b.HEAPU8=Ne=new Uint8Array(Pt),b.HEAPU16=Xe=new Uint16Array(Pt),b.HEAP32=Ye=new Int32Array(Pt),b.HEAPU32=Qe=new Uint32Array(Pt),b.HEAPF32=rt=new Float32Array(Pt),b.HEAPF64=ot=new Float64Array(Pt)}var mt=[],_t=[],Lt=[];function Vt(){if(b.preRun)for(typeof b.preRun=="function"&&(b.preRun=[b.preRun]);b.preRun.length;)Qt(b.preRun.shift());on(mt)}function Gt(){on(_t)}function $t(){if(b.postRun)for(typeof b.postRun=="function"&&(b.postRun=[b.postRun]);b.postRun.length;)It(b.postRun.shift());on(Lt)}function Qt(Pt){mt.unshift(Pt)}function vt(Pt){_t.unshift(Pt)}function It(Pt){Lt.unshift(Pt)}var gt=0,Tt=null;function Ct(Pt){var wt;gt++,(wt=b.monitorRunDependencies)==null||wt.call(b,gt)}function Ft(Pt){var wt;if(gt--,(wt=b.monitorRunDependencies)==null||wt.call(b,gt),gt==0&&Tt){var jt=Tt;Tt=null,jt()}}function sn(Pt){var wt;(wt=b.onAbort)==null||wt.call(b,Pt),Pt="Aborted("+Pt+")",Se(Pt),Ie=!0,De=1,Pt+=". Build with -sASSERTIONS for more info.";var jt=new WebAssembly.RuntimeError(Pt);throw ee(jt),jt}var cn="data:application/octet-stream;base64,",en=Pt=>Pt.startsWith(cn),yn;yn="bodyutils.wasm",en(yn)||(yn=ve(yn));function Pn(Pt){if(Pt==yn&&Ee)return new Uint8Array(Ee);throw"both async and sync fetching of the wasm failed"}function tr(Pt){return!Ee&&le&&typeof fetch=="function"?fetch(Pt,{credentials:"same-origin"}).then(wt=>{if(!wt.ok)throw"failed to load wasm binary file at '"+Pt+"'";return wt.arrayBuffer()}).catch(()=>Pn(Pt)):Promise.resolve().then(()=>Pn(Pt))}function nr(Pt,wt,jt){return tr(Pt).then(pn=>WebAssembly.instantiate(pn,wt)).then(jt,pn=>{Se("failed to asynchronously prepare wasm: "+pn),sn(pn)})}function Fr(Pt,wt,jt,pn){return!Pt&&typeof WebAssembly.instantiateStreaming=="function"&&!en(wt)&&typeof fetch=="function"?fetch(wt,{credentials:"same-origin"}).then(qn=>{var Jn=WebAssembly.instantiateStreaming(qn,jt);return Jn.then(pn,function(dr){return Se("wasm streaming compile failed: "+dr),Se("falling back to ArrayBuffer instantiation"),nr(wt,jt,pn)})}):nr(wt,jt,pn)}function Ur(){var Pt={a:Qx};function wt(pn,qn){return zs=pn.exports,Ce=zs.E,ct(),ui=zs.H,vt(zs.F),Ft(),zs}Ct();function jt(pn){wt(pn.instance)}if(b.instantiateWasm)try{return b.instantiateWasm(Pt,wt)}catch(pn){Se("Module.instantiateWasm callback failed with error: "+pn),ee(pn)}return Fr(Ee,yn,Pt,jt).catch(ee),{}}function Kr(Pt){this.name="ExitStatus",this.message="Program terminated with exit("+Pt+")",this.status=Pt}var on=Pt=>{for(;Pt.length>0;)Pt.shift()(b)};b.noExitRuntime;class qr{constructor(wt){this.excPtr=wt,this.ptr=wt-24}set_type(wt){Qe[this.ptr+4>>2]=wt}get_type(){return Qe[this.ptr+4>>2]}set_destructor(wt){Qe[this.ptr+8>>2]=wt}get_destructor(){return Qe[this.ptr+8>>2]}set_caught(wt){wt=wt?1:0,Be[this.ptr+12]=wt}get_caught(){return Be[this.ptr+12]!=0}set_rethrown(wt){wt=wt?1:0,Be[this.ptr+13]=wt}get_rethrown(){return Be[this.ptr+13]!=0}init(wt,jt){this.set_adjusted_ptr(0),this.set_type(wt),this.set_destructor(jt)}set_adjusted_ptr(wt){Qe[this.ptr+16>>2]=wt}get_adjusted_ptr(){return Qe[this.ptr+16>>2]}get_exception_ptr(){var wt=Kl(this.get_type());if(wt)return Qe[this.excPtr>>2];var jt=this.get_adjusted_ptr();return jt!==0?jt:this.excPtr}}var rr=0,Qr=(Pt,wt,jt)=>{var pn=new qr(Pt);throw pn.init(wt,jt),rr=Pt,rr},Ir=(Pt,wt,jt,pn,qn)=>{},ai=()=>{for(var Pt=new Array(256),wt=0;wt<256;++wt)Pt[wt]=String.fromCharCode(wt);Hr=Pt},Hr,Vr=Pt=>{for(var wt="",jt=Pt;Ne[jt];)wt+=Hr[Ne[jt++]];return wt},xn={},Ht={},In={},er,Hn=Pt=>{throw new er(Pt)},Zn,Dr=Pt=>{throw new Zn(Pt)},zn=(Pt,wt,jt)=>{Pt.forEach(function(jn){In[jn]=wt});function pn(jn){var Lr=jt(jn);Lr.length!==Pt.length&&Dr("Mismatched type converter count");for(var Wr=0;Wr<Pt.length;++Wr)vr(Pt[Wr],Lr[Wr])}var qn=new Array(wt.length),Jn=[],dr=0;wt.forEach((jn,Lr)=>{Ht.hasOwnProperty(jn)?qn[Lr]=Ht[jn]:(Jn.push(jn),xn.hasOwnProperty(jn)||(xn[jn]=[]),xn[jn].push(()=>{qn[Lr]=Ht[jn],++dr,dr===Jn.length&&pn(qn)}))}),Jn.length===0&&pn(qn)};function Nr(Pt,wt,jt={}){var pn=wt.name;if(Pt||Hn('type "'+pn+'" must have a positive integer typeid pointer'),Ht.hasOwnProperty(Pt)){if(jt.ignoreDuplicateRegistrations)return;Hn("Cannot register type '"+pn+"' twice")}if(Ht[Pt]=wt,delete In[Pt],xn.hasOwnProperty(Pt)){var qn=xn[Pt];delete xn[Pt],qn.forEach(Jn=>Jn())}}function vr(Pt,wt,jt={}){if(!("argPackAdvance"in wt))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Nr(Pt,wt,jt)}var Sr=8,zr=(Pt,wt,jt,pn)=>{wt=Vr(wt),vr(Pt,{name:wt,fromWireType:function(qn){return!!qn},toWireType:function(qn,Jn){return Jn?jt:pn},argPackAdvance:Sr,readValueFromPointer:function(qn){return this.fromWireType(Ne[qn])},destructorFunction:null})},gi=Pt=>({count:Pt.count,deleteScheduled:Pt.deleteScheduled,preservePointerOnDelete:Pt.preservePointerOnDelete,ptr:Pt.ptr,ptrType:Pt.ptrType,smartPtr:Pt.smartPtr,smartPtrType:Pt.smartPtrType}),oi=Pt=>{function wt(jt){return jt.$$.ptrType.registeredClass.name}Hn(wt(Pt)+" instance already deleted")},Gr=!1,ri=Pt=>{},yi=Pt=>{Pt.smartPtr?Pt.smartPtrType.rawDestructor(Pt.smartPtr):Pt.ptrType.registeredClass.rawDestructor(Pt.ptr)},Ci=Pt=>{Pt.count.value-=1;var wt=Pt.count.value===0;wt&&yi(Pt)},wn=(Pt,wt,jt)=>{if(wt===jt)return Pt;if(jt.baseClass===void 0)return null;var pn=wn(Pt,wt,jt.baseClass);return pn===null?null:jt.downcast(pn)},Pr={},xr=()=>Object.keys(bi).length,gr=()=>{var Pt=[];for(var wt in bi)bi.hasOwnProperty(wt)&&Pt.push(bi[wt]);return Pt},Mr=[],ci=()=>{for(;Mr.length;){var Pt=Mr.pop();Pt.$$.deleteScheduled=!1,Pt.delete()}},fi,Ui=Pt=>{fi=Pt,Mr.length&&fi&&fi(ci)},Vi=()=>{b.getInheritedInstanceCount=xr,b.getLiveInheritedInstances=gr,b.flushPendingDeletes=ci,b.setDelayFunction=Ui},bi={},Ga=(Pt,wt)=>{for(wt===void 0&&Hn("ptr should not be undefined");Pt.baseClass;)wt=Pt.upcast(wt),Pt=Pt.baseClass;return wt},Ra=(Pt,wt)=>(wt=Ga(Pt,wt),bi[wt]),sa=(Pt,wt)=>{(!wt.ptrType||!wt.ptr)&&Dr("makeClassHandle requires ptr and ptrType");var jt=!!wt.smartPtrType,pn=!!wt.smartPtr;return jt!==pn&&Dr("Both smartPtrType and smartPtr must be specified"),wt.count={value:1},Fi(Object.create(Pt,{$$:{value:wt,writable:!0}}))};function $i(Pt){var wt=this.getPointee(Pt);if(!wt)return this.destructor(Pt),null;var jt=Ra(this.registeredClass,wt);if(jt!==void 0){if(jt.$$.count.value===0)return jt.$$.ptr=wt,jt.$$.smartPtr=Pt,jt.clone();var pn=jt.clone();return this.destructor(Pt),pn}function qn(){return this.isSmartPointer?sa(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:wt,smartPtrType:this,smartPtr:Pt}):sa(this.registeredClass.instancePrototype,{ptrType:this,ptr:Pt})}var Jn=this.registeredClass.getActualType(wt),dr=Pr[Jn];if(!dr)return qn.call(this);var jn;this.isConst?jn=dr.constPointerType:jn=dr.pointerType;var Lr=wn(wt,this.registeredClass,jn.registeredClass);return Lr===null?qn.call(this):this.isSmartPointer?sa(jn.registeredClass.instancePrototype,{ptrType:jn,ptr:Lr,smartPtrType:this,smartPtr:Pt}):sa(jn.registeredClass.instancePrototype,{ptrType:jn,ptr:Lr})}var Fi=Pt=>typeof FinalizationRegistry>"u"?(Fi=wt=>wt,Pt):(Gr=new FinalizationRegistry(wt=>{Ci(wt.$$)}),Fi=wt=>{var jt=wt.$$,pn=!!jt.smartPtr;if(pn){var qn={$$:jt};Gr.register(wt,qn,wt)}return wt},ri=wt=>Gr.unregister(wt),Fi(Pt)),Ss=()=>{Object.assign(ta.prototype,{isAliasOf(Pt){if(!(this instanceof ta)||!(Pt instanceof ta))return!1;var wt=this.$$.ptrType.registeredClass,jt=this.$$.ptr;Pt.$$=Pt.$$;for(var pn=Pt.$$.ptrType.registeredClass,qn=Pt.$$.ptr;wt.baseClass;)jt=wt.upcast(jt),wt=wt.baseClass;for(;pn.baseClass;)qn=pn.upcast(qn),pn=pn.baseClass;return wt===pn&&jt===qn},clone(){if(this.$$.ptr||oi(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var Pt=Fi(Object.create(Object.getPrototypeOf(this),{$$:{value:gi(this.$$)}}));return Pt.$$.count.value+=1,Pt.$$.deleteScheduled=!1,Pt},delete(){this.$$.ptr||oi(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Hn("Object already scheduled for deletion"),ri(this),Ci(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||oi(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Hn("Object already scheduled for deletion"),Mr.push(this),Mr.length===1&&fi&&fi(ci),this.$$.deleteScheduled=!0,this}})};function ta(){}var Na=(Pt,wt)=>Object.defineProperty(wt,"name",{value:Pt}),is=(Pt,wt,jt)=>{if(Pt[wt].overloadTable===void 0){var pn=Pt[wt];Pt[wt]=function(...qn){return Pt[wt].overloadTable.hasOwnProperty(qn.length)||Hn("Function '"+jt+"' called with an invalid number of arguments ("+qn.length+") - expects one of ("+Pt[wt].overloadTable+")!"),Pt[wt].overloadTable[qn.length].apply(this,qn)},Pt[wt].overloadTable=[],Pt[wt].overloadTable[pn.argCount]=pn}},Hs=(Pt,wt,jt)=>{b.hasOwnProperty(Pt)?(Hn("Cannot register public name '"+Pt+"' twice"),is(b,Pt,Pt),b.hasOwnProperty(jt)&&Hn("Cannot register multiple overloads of a function with the same number of arguments ("+jt+")!"),b[Pt].overloadTable[jt]=wt):b[Pt]=wt},$s=48,v0=57,Qs=Pt=>{if(Pt===void 0)return"_unknown";Pt=Pt.replace(/[^a-zA-Z0-9_]/g,"$");var wt=Pt.charCodeAt(0);return wt>=$s&&wt<=v0?"_"+Pt:Pt};function Zs(Pt,wt,jt,pn,qn,Jn,dr,jn){this.name=Pt,this.constructor=wt,this.instancePrototype=jt,this.rawDestructor=pn,this.baseClass=qn,this.getActualType=Jn,this.upcast=dr,this.downcast=jn,this.pureVirtualFunctions=[]}var as=(Pt,wt,jt)=>{for(;wt!==jt;)wt.upcast||Hn("Expected null or instance of "+jt.name+", got an instance of "+wt.name),Pt=wt.upcast(Pt),wt=wt.baseClass;return Pt};function Jt(Pt,wt){if(wt===null)return this.isReference&&Hn("null is not a valid "+this.name),0;wt.$$||Hn('Cannot pass "'+_0(wt)+'" as a '+this.name),wt.$$.ptr||Hn("Cannot pass deleted object as a pointer of type "+this.name);var jt=wt.$$.ptrType.registeredClass,pn=as(wt.$$.ptr,jt,this.registeredClass);return pn}function vn(Pt,wt){var jt;if(wt===null)return this.isReference&&Hn("null is not a valid "+this.name),this.isSmartPointer?(jt=this.rawConstructor(),Pt!==null&&Pt.push(this.rawDestructor,jt),jt):0;(!wt||!wt.$$)&&Hn('Cannot pass "'+_0(wt)+'" as a '+this.name),wt.$$.ptr||Hn("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&wt.$$.ptrType.isConst&&Hn("Cannot convert argument of type "+(wt.$$.smartPtrType?wt.$$.smartPtrType.name:wt.$$.ptrType.name)+" to parameter type "+this.name);var pn=wt.$$.ptrType.registeredClass;if(jt=as(wt.$$.ptr,pn,this.registeredClass),this.isSmartPointer)switch(wt.$$.smartPtr===void 0&&Hn("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:wt.$$.smartPtrType===this?jt=wt.$$.smartPtr:Hn("Cannot convert argument of type "+(wt.$$.smartPtrType?wt.$$.smartPtrType.name:wt.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:jt=wt.$$.smartPtr;break;case 2:if(wt.$$.smartPtrType===this)jt=wt.$$.smartPtr;else{var qn=wt.clone();jt=this.rawShare(jt,ka.toHandle(()=>qn.delete())),Pt!==null&&Pt.push(this.rawDestructor,jt)}break;default:Hn("Unsupporting sharing policy")}return jt}function $n(Pt,wt){if(wt===null)return this.isReference&&Hn("null is not a valid "+this.name),0;wt.$$||Hn('Cannot pass "'+_0(wt)+'" as a '+this.name),wt.$$.ptr||Hn("Cannot pass deleted object as a pointer of type "+this.name),wt.$$.ptrType.isConst&&Hn("Cannot convert argument of type "+wt.$$.ptrType.name+" to parameter type "+this.name);var jt=wt.$$.ptrType.registeredClass,pn=as(wt.$$.ptr,jt,this.registeredClass);return pn}function Wn(Pt){return this.fromWireType(Qe[Pt>>2])}var An=()=>{Object.assign(Cr.prototype,{getPointee(Pt){return this.rawGetPointee&&(Pt=this.rawGetPointee(Pt)),Pt},destructor(Pt){var wt;(wt=this.rawDestructor)==null||wt.call(this,Pt)},argPackAdvance:Sr,readValueFromPointer:Wn,fromWireType:$i})};function Cr(Pt,wt,jt,pn,qn,Jn,dr,jn,Lr,Wr,Br){this.name=Pt,this.registeredClass=wt,this.isReference=jt,this.isConst=pn,this.isSmartPointer=qn,this.pointeeType=Jn,this.sharingPolicy=dr,this.rawGetPointee=jn,this.rawConstructor=Lr,this.rawShare=Wr,this.rawDestructor=Br,!qn&&wt.baseClass===void 0?pn?(this.toWireType=Jt,this.destructorFunction=null):(this.toWireType=$n,this.destructorFunction=null):this.toWireType=vn}var $r=(Pt,wt,jt)=>{b.hasOwnProperty(Pt)||Dr("Replacing nonexistent public symbol"),b[Pt].overloadTable!==void 0&&jt!==void 0?b[Pt].overloadTable[jt]=wt:(b[Pt]=wt,b[Pt].argCount=jt)},Xr=(Pt,wt,jt)=>{var pn=b["dynCall_"+Pt];return pn(wt,...jt)},Yr=[],ui,ii=Pt=>{var wt=Yr[Pt];return wt||(Pt>=Yr.length&&(Yr.length=Pt+1),Yr[Pt]=wt=ui.get(Pt)),wt},jr=(Pt,wt,jt=[])=>{if(Pt.includes("j"))return Xr(Pt,wt,jt);var pn=ii(wt)(...jt);return pn},di=(Pt,wt)=>(...jt)=>jr(Pt,wt,jt),Pi=(Pt,wt)=>{Pt=Vr(Pt);function jt(){return Pt.includes("j")?di(Pt,wt):ii(wt)}var pn=jt();return typeof pn!="function"&&Hn("unknown function pointer with signature "+Pt+": "+wt),pn},Ai=(Pt,wt)=>{var jt=Na(wt,function(pn){this.name=wt,this.message=pn;var qn=new Error(pn).stack;qn!==void 0&&(this.stack=this.toString()+`
`+qn.replace(/^Error(:[^\n]*)?\n/,""))});return jt.prototype=Object.create(Pt.prototype),jt.prototype.constructor=jt,jt.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},jt},xa,Mi=Pt=>{var wt=nx(Pt),jt=Vr(wt);return c0(wt),jt},Jr=(Pt,wt)=>{var jt=[],pn={};function qn(Jn){if(!pn[Jn]&&!Ht[Jn]){if(In[Jn]){In[Jn].forEach(qn);return}jt.push(Jn),pn[Jn]=!0}}throw wt.forEach(qn),new xa(Pt+": "+jt.map(Mi).join([", "]))},Zi=(Pt,wt,jt,pn,qn,Jn,dr,jn,Lr,Wr,Br,_i,mi)=>{Br=Vr(Br),Jn=Pi(qn,Jn),jn&&(jn=Pi(dr,jn)),Wr&&(Wr=Pi(Lr,Wr)),mi=Pi(_i,mi);var ki=Qs(Br);Hs(ki,function(){Jr("Cannot construct "+Br+" due to unbound types",[pn])}),zn([Pt,wt,jt],pn?[pn]:[],va=>{var wa;va=va[0];var Aa,Ma;pn?(Aa=va.registeredClass,Ma=Aa.instancePrototype):Ma=ta.prototype;var Tr=Na(Br,function(...h0){if(Object.getPrototypeOf(this)!==xi)throw new er("Use 'new' to construct "+Br);if(qi.constructor_body===void 0)throw new er(Br+" has no accessible constructor");var rx=qi.constructor_body[h0.length];if(rx===void 0)throw new er("Tried to invoke ctor of "+Br+" with invalid number of parameters ("+h0.length+") - expected ("+Object.keys(qi.constructor_body).toString()+") parameters instead!");return rx.apply(this,h0)}),xi=Object.create(Ma,{constructor:{value:Tr}});Tr.prototype=xi;var qi=new Zs(Br,Tr,xi,mi,Aa,Jn,jn,Wr);qi.baseClass&&((wa=qi.baseClass).__derivedClasses!=null||(wa.__derivedClasses=[]),qi.baseClass.__derivedClasses.push(qi));var ji=new Cr(Br,qi,!0,!1,!1),hi=new Cr(Br+"*",qi,!1,!1,!1),w0=new Cr(Br+" const*",qi,!1,!0,!1);return Pr[Pt]={pointerType:hi,constPointerType:w0},$r(ki,Tr),[ji,hi,w0]})},Ri=(Pt,wt)=>{for(var jt=[],pn=0;pn<Pt;pn++)jt.push(Qe[wt+pn*4>>2]);return jt},zi=Pt=>{for(;Pt.length;){var wt=Pt.pop(),jt=Pt.pop();jt(wt)}};function Ws(Pt){for(var wt=1;wt<Pt.length;++wt)if(Pt[wt]!==null&&Pt[wt].destructorFunction===void 0)return!0;return!1}function Da(Pt,wt,jt,pn,qn,Jn){var dr=wt.length;dr<2&&Hn("argTypes array size mismatch! Must at least get return value and 'this' types!");var jn=wt[1]!==null&&jt!==null,Lr=Ws(wt),Wr=wt[0].name!=="void",Br=dr-2,_i=new Array(Br),mi=[],ki=[],va=function(...wa){wa.length!==Br&&Hn("function "+Pt+" called with "+wa.length+" arguments, expected "+Br),ki.length=0;var Aa;mi.length=jn?2:1,mi[0]=qn,jn&&(Aa=wt[1].toWireType(ki,this),mi[1]=Aa);for(var Ma=0;Ma<Br;++Ma)_i[Ma]=wt[Ma+2].toWireType(ki,wa[Ma]),mi.push(_i[Ma]);var Tr=pn(...mi);function xi(qi){if(Lr)zi(ki);else for(var ji=jn?1:2;ji<wt.length;ji++){var hi=ji===1?Aa:_i[ji-2];wt[ji].destructorFunction!==null&&wt[ji].destructorFunction(hi)}if(Wr)return wt[0].fromWireType(qi)}return xi(Tr)};return Na(Pt,va)}var Js=(Pt,wt,jt,pn,qn,Jn)=>{var dr=Ri(wt,jt);qn=Pi(pn,qn),zn([],[Pt],jn=>{jn=jn[0];var Lr="constructor "+jn.name;if(jn.registeredClass.constructor_body===void 0&&(jn.registeredClass.constructor_body=[]),jn.registeredClass.constructor_body[wt-1]!==void 0)throw new er("Cannot register multiple constructors with identical number of parameters ("+(wt-1)+") for class '"+jn.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return jn.registeredClass.constructor_body[wt-1]=()=>{Jr("Cannot construct "+jn.name+" due to unbound types",dr)},zn([],dr,Wr=>(Wr.splice(1,0,null),jn.registeredClass.constructor_body[wt-1]=Da(Lr,Wr,null,qn,Jn),[])),[]})},Ji=Pt=>{Pt=Pt.trim();const wt=Pt.indexOf("(");return wt!==-1?Pt.substr(0,wt):Pt},ss=(Pt,wt,jt,pn,qn,Jn,dr,jn,Lr)=>{var Wr=Ri(jt,pn);wt=Vr(wt),wt=Ji(wt),Jn=Pi(qn,Jn),zn([],[Pt],Br=>{Br=Br[0];var _i=Br.name+"."+wt;wt.startsWith("@@")&&(wt=Symbol[wt.substring(2)]),jn&&Br.registeredClass.pureVirtualFunctions.push(wt);function mi(){Jr("Cannot call "+_i+" due to unbound types",Wr)}var ki=Br.registeredClass.instancePrototype,va=ki[wt];return va===void 0||va.overloadTable===void 0&&va.className!==Br.name&&va.argCount===jt-2?(mi.argCount=jt-2,mi.className=Br.name,ki[wt]=mi):(is(ki,wt,_i),ki[wt].overloadTable[jt-2]=mi),zn([],Wr,wa=>{var Aa=Da(_i,wa,Br,Jn,dr);return ki[wt].overloadTable===void 0?(Aa.argCount=jt-2,ki[wt]=Aa):ki[wt].overloadTable[jt-2]=Aa,[]}),[]})},qs=(Pt,wt,jt)=>(Pt instanceof Object||Hn(jt+' with invalid "this": '+Pt),Pt instanceof wt.registeredClass.constructor||Hn(jt+' incompatible with "this" of type '+Pt.constructor.name),Pt.$$.ptr||Hn("cannot call emscripten binding method "+jt+" on deleted object"),as(Pt.$$.ptr,Pt.$$.ptrType.registeredClass,wt.registeredClass)),Di=(Pt,wt,jt,pn,qn,Jn,dr,jn,Lr,Wr)=>{wt=Vr(wt),qn=Pi(pn,qn),zn([],[Pt],Br=>{Br=Br[0];var _i=Br.name+"."+wt,mi={get(){Jr("Cannot access "+_i+" due to unbound types",[jt,dr])},enumerable:!0,configurable:!0};return Lr?mi.set=()=>Jr("Cannot access "+_i+" due to unbound types",[jt,dr]):mi.set=ki=>Hn(_i+" is a read-only property"),Object.defineProperty(Br.registeredClass.instancePrototype,wt,mi),zn([],Lr?[jt,dr]:[jt],ki=>{var va=ki[0],wa={get(){var Ma=qs(this,Br,_i+" getter");return va.fromWireType(qn(Jn,Ma))},enumerable:!0};if(Lr){Lr=Pi(jn,Lr);var Aa=ki[1];wa.set=function(Ma){var Tr=qs(this,Br,_i+" setter"),xi=[];Lr(Wr,Tr,Aa.toWireType(xi,Ma)),zi(xi)}}return Object.defineProperty(Br.registeredClass.instancePrototype,wt,wa),[]}),[]})},Ts=[],Pa=[],js=Pt=>{Pt>9&&--Pa[Pt+1]===0&&(Pa[Pt]=void 0,Ts.push(Pt))},Ys=()=>Pa.length/2-5-Ts.length,yx=()=>{Pa.push(0,1,void 0,1,null,1,!0,1,!1,1),b.count_emval_handles=Ys},ka={toValue:Pt=>(Pt||Hn("Cannot use deleted val. handle = "+Pt),Pa[Pt]),toHandle:Pt=>{switch(Pt){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const wt=Ts.pop()||Pa.length;return Pa[wt]=Pt,Pa[wt+1]=1,wt}}}},e0={name:"emscripten::val",fromWireType:Pt=>{var wt=ka.toValue(Pt);return js(Pt),wt},toWireType:(Pt,wt)=>ka.toHandle(wt),argPackAdvance:Sr,readValueFromPointer:Wn,destructorFunction:null},Yx=Pt=>vr(Pt,e0),_0=Pt=>{if(Pt===null)return"null";var wt=typeof Pt;return wt==="object"||wt==="array"||wt==="function"?Pt.toString():""+Pt},gx=(Pt,wt)=>{switch(wt){case 4:return function(jt){return this.fromWireType(rt[jt>>2])};case 8:return function(jt){return this.fromWireType(ot[jt>>3])};default:throw new TypeError("invalid float width ("+wt+"): "+Pt)}},K0=(Pt,wt,jt)=>{wt=Vr(wt),vr(Pt,{name:wt,fromWireType:pn=>pn,toWireType:(pn,qn)=>qn,argPackAdvance:Sr,readValueFromPointer:gx(wt,jt),destructorFunction:null})},Xx=(Pt,wt,jt)=>{switch(wt){case 1:return jt?pn=>Be[pn]:pn=>Ne[pn];case 2:return jt?pn=>qe[pn>>1]:pn=>Xe[pn>>1];case 4:return jt?pn=>Ye[pn>>2]:pn=>Qe[pn>>2];default:throw new TypeError("invalid integer width ("+wt+"): "+Pt)}},Kx=(Pt,wt,jt,pn,qn)=>{wt=Vr(wt);var Jn=Br=>Br;if(pn===0){var dr=32-8*jt;Jn=Br=>Br<<dr>>>dr}var jn=wt.includes("unsigned"),Lr=(Br,_i)=>{},Wr;jn?Wr=function(Br,_i){return Lr(_i,this.name),_i>>>0}:Wr=function(Br,_i){return Lr(_i,this.name),_i},vr(Pt,{name:wt,fromWireType:Jn,toWireType:Wr,argPackAdvance:Sr,readValueFromPointer:Xx(wt,jt,pn!==0),destructorFunction:null})},O0=(Pt,wt,jt)=>{var pn=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],qn=pn[wt];function Jn(dr){var jn=Qe[dr>>2],Lr=Qe[dr+4>>2];return new qn(Be.buffer,Lr,jn)}jt=Vr(jt),vr(Pt,{name:jt,fromWireType:Jn,argPackAdvance:Sr,readValueFromPointer:Jn},{ignoreDuplicateRegistrations:!0})},B0=(Pt,wt,jt,pn)=>{if(!(pn>0))return 0;for(var qn=jt,Jn=jt+pn-1,dr=0;dr<Pt.length;++dr){var jn=Pt.charCodeAt(dr);if(jn>=55296&&jn<=57343){var Lr=Pt.charCodeAt(++dr);jn=65536+((jn&1023)<<10)|Lr&1023}if(jn<=127){if(jt>=Jn)break;wt[jt++]=jn}else if(jn<=2047){if(jt+1>=Jn)break;wt[jt++]=192|jn>>6,wt[jt++]=128|jn&63}else if(jn<=65535){if(jt+2>=Jn)break;wt[jt++]=224|jn>>12,wt[jt++]=128|jn>>6&63,wt[jt++]=128|jn&63}else{if(jt+3>=Jn)break;wt[jt++]=240|jn>>18,wt[jt++]=128|jn>>12&63,wt[jt++]=128|jn>>6&63,wt[jt++]=128|jn&63}}return wt[jt]=0,jt-qn},os=(Pt,wt,jt)=>B0(Pt,Ne,wt,jt),x0=Pt=>{for(var wt=0,jt=0;jt<Pt.length;++jt){var pn=Pt.charCodeAt(jt);pn<=127?wt++:pn<=2047?wt+=2:pn>=55296&&pn<=57343?(wt+=4,++jt):wt+=3}return wt},t0=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,vx=(Pt,wt,jt)=>{for(var pn=wt+jt,qn=wt;Pt[qn]&&!(qn>=pn);)++qn;if(qn-wt>16&&Pt.buffer&&t0)return t0.decode(Pt.subarray(wt,qn));for(var Jn="";wt<qn;){var dr=Pt[wt++];if(!(dr&128)){Jn+=String.fromCharCode(dr);continue}var jn=Pt[wt++]&63;if((dr&224)==192){Jn+=String.fromCharCode((dr&31)<<6|jn);continue}var Lr=Pt[wt++]&63;if((dr&240)==224?dr=(dr&15)<<12|jn<<6|Lr:dr=(dr&7)<<18|jn<<12|Lr<<6|Pt[wt++]&63,dr<65536)Jn+=String.fromCharCode(dr);else{var Wr=dr-65536;Jn+=String.fromCharCode(55296|Wr>>10,56320|Wr&1023)}}return Jn},La=(Pt,wt)=>Pt?vx(Ne,Pt,wt):"",bx=(Pt,wt)=>{wt=Vr(wt);var jt=wt==="std::string";vr(Pt,{name:wt,fromWireType(pn){var qn=Qe[pn>>2],Jn=pn+4,dr;if(jt)for(var jn=Jn,Lr=0;Lr<=qn;++Lr){var Wr=Jn+Lr;if(Lr==qn||Ne[Wr]==0){var Br=Wr-jn,_i=La(jn,Br);dr===void 0?dr=_i:(dr+="\0",dr+=_i),jn=Wr+1}}else{for(var mi=new Array(qn),Lr=0;Lr<qn;++Lr)mi[Lr]=String.fromCharCode(Ne[Jn+Lr]);dr=mi.join("")}return c0(pn),dr},toWireType(pn,qn){qn instanceof ArrayBuffer&&(qn=new Uint8Array(qn));var Jn,dr=typeof qn=="string";dr||qn instanceof Uint8Array||qn instanceof Uint8ClampedArray||qn instanceof Int8Array||Hn("Cannot pass non-string to std::string"),jt&&dr?Jn=x0(qn):Jn=qn.length;var jn=tx(4+Jn+1),Lr=jn+4;if(Qe[jn>>2]=Jn,jt&&dr)os(qn,Lr,Jn+1);else if(dr)for(var Wr=0;Wr<Jn;++Wr){var Br=qn.charCodeAt(Wr);Br>255&&(c0(Lr),Hn("String has UTF-16 code units that do not fit in 8 bits")),Ne[Lr+Wr]=Br}else for(var Wr=0;Wr<Jn;++Wr)Ne[Lr+Wr]=qn[Wr];return pn!==null&&pn.push(c0,jn),jn},argPackAdvance:Sr,readValueFromPointer:Wn,destructorFunction(pn){c0(pn)}})},o0=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Xs=(Pt,wt)=>{for(var jt=Pt,pn=jt>>1,qn=pn+wt/2;!(pn>=qn)&&Xe[pn];)++pn;if(jt=pn<<1,jt-Pt>32&&o0)return o0.decode(Ne.subarray(Pt,jt));for(var Jn="",dr=0;!(dr>=wt/2);++dr){var jn=qe[Pt+dr*2>>1];if(jn==0)break;Jn+=String.fromCharCode(jn)}return Jn},Q0=(Pt,wt,jt)=>{if(jt!=null||(jt=2147483647),jt<2)return 0;jt-=2;for(var pn=wt,qn=jt<Pt.length*2?jt/2:Pt.length,Jn=0;Jn<qn;++Jn){var dr=Pt.charCodeAt(Jn);qe[wt>>1]=dr,wt+=2}return qe[wt>>1]=0,wt-pn},D0=Pt=>Pt.length*2,n0=(Pt,wt)=>{for(var jt=0,pn="";!(jt>=wt/4);){var qn=Ye[Pt+jt*4>>2];if(qn==0)break;if(++jt,qn>=65536){var Jn=qn-65536;pn+=String.fromCharCode(55296|Jn>>10,56320|Jn&1023)}else pn+=String.fromCharCode(qn)}return pn},Z0=(Pt,wt,jt)=>{if(jt!=null||(jt=2147483647),jt<4)return 0;for(var pn=wt,qn=pn+jt-4,Jn=0;Jn<Pt.length;++Jn){var dr=Pt.charCodeAt(Jn);if(dr>=55296&&dr<=57343){var jn=Pt.charCodeAt(++Jn);dr=65536+((dr&1023)<<10)|jn&1023}if(Ye[wt>>2]=dr,wt+=4,wt+4>qn)break}return Ye[wt>>2]=0,wt-pn},U0=Pt=>{for(var wt=0,jt=0;jt<Pt.length;++jt){var pn=Pt.charCodeAt(jt);pn>=55296&&pn<=57343&&++jt,wt+=4}return wt},Sx=(Pt,wt,jt)=>{jt=Vr(jt);var pn,qn,Jn,dr;wt===2?(pn=Xs,qn=Q0,dr=D0,Jn=jn=>Xe[jn>>1]):wt===4&&(pn=n0,qn=Z0,dr=U0,Jn=jn=>Qe[jn>>2]),vr(Pt,{name:jt,fromWireType:jn=>{for(var Lr=Qe[jn>>2],Wr,Br=jn+4,_i=0;_i<=Lr;++_i){var mi=jn+4+_i*wt;if(_i==Lr||Jn(mi)==0){var ki=mi-Br,va=pn(Br,ki);Wr===void 0?Wr=va:(Wr+="\0",Wr+=va),Br=mi+wt}}return c0(jn),Wr},toWireType:(jn,Lr)=>{typeof Lr!="string"&&Hn("Cannot pass non-string to C++ string type "+jt);var Wr=dr(Lr),Br=tx(4+Wr+wt);return Qe[Br>>2]=Wr/wt,qn(Lr,Br+4,Wr+wt),jn!==null&&jn.push(c0,Br),Br},argPackAdvance:Sr,readValueFromPointer:Wn,destructorFunction(jn){c0(jn)}})},V0=(Pt,wt)=>{wt=Vr(wt),vr(Pt,{isVoid:!0,name:wt,argPackAdvance:0,fromWireType:()=>{},toWireType:(jt,pn)=>{}})};function z0(Pt){if(Mt.xhrs.has(Pt)){var wt=Mt.xhrs.get(Pt);Mt.xhrs.free(Pt),wt.readyState>0&&wt.readyState<4&&wt.abort()}}var J0=(Pt,wt)=>{var jt=Ht[Pt];return jt===void 0&&Hn(wt+" has unknown type "+Mi(Pt)),jt},Ha=(Pt,wt,jt)=>{var pn=[],qn=Pt.toWireType(pn,jt);return pn.length&&(Qe[wt>>2]=ka.toHandle(pn)),qn},l0=(Pt,wt,jt)=>(Pt=ka.toValue(Pt),wt=J0(wt,"emval::as"),Ha(wt,jt,Pt)),G0={},S0=Pt=>{var wt=G0[Pt];return wt===void 0?Vr(Pt):wt},Tx=()=>{if(typeof globalThis=="object")return globalThis;function Pt(wt){wt.$$$embind_global$$$=wt;var jt=typeof $$$embind_global$$$=="object"&&wt.$$$embind_global$$$==wt;return jt||delete wt.$$$embind_global$$$,jt}if(typeof $$$embind_global$$$=="object"||(typeof global=="object"&&Pt(global)?$$$embind_global$$$=global:typeof self=="object"&&Pt(self)&&($$$embind_global$$$=self),typeof $$$embind_global$$$=="object"))return $$$embind_global$$$;throw Error("unable to get global object.")},j0=Pt=>Pt===0?ka.toHandle(Tx()):(Pt=S0(Pt),ka.toHandle(Tx()[Pt])),Es=(Pt,wt)=>(Pt=ka.toValue(Pt),wt=ka.toValue(wt),ka.toHandle(Pt[wt])),ls=Pt=>ka.toHandle(S0(Pt)),T0=Pt=>{var wt=ka.toValue(Pt);zi(wt),js(Pt)},ex=(Pt,wt)=>{Pt=J0(Pt,"_emval_take_value");var jt=Pt.readValueFromPointer(wt);return ka.toHandle(jt)},Ns=()=>{sn("")},ds=()=>!0,H0=(Pt,wt,jt)=>Ne.copyWithin(Pt,wt,wt+jt),zt=()=>2147483648,Ot=Pt=>{var wt=Ce.buffer,jt=(Pt-wt.byteLength+65535)/65536;try{return Ce.grow(jt),ct(),1}catch{}},un=Pt=>{var wt=Ne.length;Pt>>>=0;var jt=zt();if(Pt>jt)return!1;for(var pn=(Lr,Wr)=>Lr+(Wr-Lr%Wr)%Wr,qn=1;qn<=4;qn*=2){var Jn=wt*(1+.2/qn);Jn=Math.min(Jn,Pt+100663296);var dr=Math.min(jt,pn(Math.max(Pt,Jn),65536)),jn=Ot(dr);if(jn)return!0}return!1};class kn{constructor(){this.allocated=[void 0],this.freelist=[]}get(wt){return this.allocated[wt]}has(wt){return this.allocated[wt]!==void 0}allocate(wt){var jt=this.freelist.pop()||this.allocated.length;return this.allocated[jt]=wt,jt}free(wt){this.allocated[wt]=void 0,this.freelist.push(wt)}}var Mt={openDatabase(Pt,wt,jt,pn){try{var qn=indexedDB.open(Pt,wt)}catch(Jn){return pn(Jn)}qn.onupgradeneeded=Jn=>{var dr=Jn.target.result;dr.objectStoreNames.contains("FILES")&&dr.deleteObjectStore("FILES"),dr.createObjectStore("FILES")},qn.onsuccess=Jn=>jt(Jn.target.result),qn.onerror=pn},init(){Mt.xhrs=new kn;var Pt=jt=>{Mt.dbInstance=jt,Ft()},wt=()=>{Mt.dbInstance=!1,Ft()};Ct(),Mt.openDatabase("emscripten_filesystem",1,Pt,wt)}};function Rt(Pt,wt,jt,pn,qn){var Jn=Qe[Pt+8>>2];if(!Jn){jt(Pt,0,"no url specified!");return}var dr=La(Jn),jn=Pt+112,Lr=La(jn+0);Lr||(Lr="GET");var Wr=Qe[jn+56>>2],Br=Qe[jn+68>>2],_i=Qe[jn+72>>2],mi=Qe[jn+76>>2],ki=Qe[jn+80>>2],va=Qe[jn+84>>2],wa=Qe[jn+88>>2],Aa=Qe[jn+52>>2],Ma=!!(Aa&1),Tr=!!(Aa&2),xi=!!(Aa&64),qi=Br?La(Br):void 0,ji=_i?La(_i):void 0,hi=new XMLHttpRequest;if(hi.withCredentials=!!Ne[jn+60],hi.open(Lr,dr,!xi,qi,ji),xi||(hi.timeout=Wr),hi.url_=dr,hi.responseType="arraybuffer",ki){var w0=La(ki);hi.overrideMimeType(w0)}if(mi)for(;;){var h0=Qe[mi>>2];if(!h0)break;var rx=Qe[mi+4>>2];if(!rx)break;mi+=8;var na=La(h0),u0=La(rx);hi.setRequestHeader(na,u0)}var hs=Mt.xhrs.allocate(hi);Qe[Pt>>2]=hs;var Zx=va&&wa?Ne.slice(va,va+wa):null;function Jx(){var Yi=0,ps=0;hi.response&&Ma&&Qe[Pt+12>>2]===0&&(ps=hi.response.byteLength),ps>0&&(Yi=tx(ps),Ne.set(new Uint8Array(hi.response),Yi)),Qe[Pt+12>>2]=Yi,Cn(Pt+16,ps),Cn(Pt+24,0);var r0=hi.response?hi.response.byteLength:0;r0&&Cn(Pt+32,r0),qe[Pt+40>>1]=hi.readyState,qe[Pt+42>>1]=hi.status,hi.statusText&&os(hi.statusText,Pt+44,64)}hi.onload=Yi=>{Mt.xhrs.has(hs)&&(Jx(),hi.status>=200&&hi.status<300?wt==null||wt(Pt,hi,Yi):jt==null||jt(Pt,hi,Yi))},hi.onerror=Yi=>{Mt.xhrs.has(hs)&&(Jx(),jt==null||jt(Pt,hi,Yi))},hi.ontimeout=Yi=>{Mt.xhrs.has(hs)&&(jt==null||jt(Pt,hi,Yi))},hi.onprogress=Yi=>{if(Mt.xhrs.has(hs)){var ps=Ma&&Tr&&hi.response?hi.response.byteLength:0,r0=0;ps>0&&Ma&&Tr&&(r0=tx(ps),Ne.set(new Uint8Array(hi.response),r0)),Qe[Pt+12>>2]=r0,Cn(Pt+16,ps),Cn(Pt+24,Yi.loaded-ps),Cn(Pt+32,Yi.total),qe[Pt+40>>1]=hi.readyState,hi.readyState>=3&&hi.status===0&&Yi.loaded>0&&(hi.status=200),qe[Pt+42>>1]=hi.status,hi.statusText&&os(hi.statusText,Pt+44,64),pn==null||pn(Pt,hi,Yi),r0&&c0(r0)}},hi.onreadystatechange=Yi=>{Mt.xhrs.has(hs)&&(qe[Pt+40>>1]=hi.readyState,hi.readyState>=2&&(qe[Pt+42>>1]=hi.status),qn==null||qn(Pt,hi,Yi))};try{hi.send(Zx)}catch(Yi){jt==null||jt(Pt,hi,Yi)}}var Zt=Pt=>{if(Pt instanceof Kr||Pt=="unwind")return De;xe(1,Pt)},an=()=>{},_n=Pt=>{if(!Ie)try{Pt(),an()}catch(wt){Zt(wt)}},Cn=(Pt,wt)=>{Qe[Pt>>2]=wt;var jt=Qe[Pt>>2];Qe[Pt+4>>2]=(wt-jt)/4294967296};function Dn(Pt,wt,jt,pn,qn){if(!Pt){qn(wt,0,"IndexedDB not available!");return}var Jn=wt+112,dr=Qe[Jn+64>>2];dr||(dr=Qe[wt+8>>2]);var jn=La(dr);try{var Lr=Pt.transaction(["FILES"],"readwrite"),Wr=Lr.objectStore("FILES"),Br=Wr.put(jt,jn);Br.onsuccess=_i=>{qe[wt+40>>1]=4,qe[wt+42>>1]=200,os("OK",wt+44,64),pn(wt,0,jn)},Br.onerror=_i=>{qe[wt+40>>1]=4,qe[wt+42>>1]=413,os("Payload Too Large",wt+44,64),qn(wt,0,_i)}}catch(_i){qn(wt,0,_i)}}function Fn(Pt,wt,jt,pn){if(!Pt){pn(wt,0,"IndexedDB not available!");return}var qn=wt+112,Jn=Qe[qn+64>>2];Jn||(Jn=Qe[wt+8>>2]);var dr=La(Jn);try{var jn=Pt.transaction(["FILES"],"readonly"),Lr=jn.objectStore("FILES"),Wr=Lr.get(dr);Wr.onsuccess=Br=>{if(Br.target.result){var _i=Br.target.result,mi=_i.byteLength||_i.length,ki=tx(mi);Ne.set(new Uint8Array(_i),ki),Qe[wt+12>>2]=ki,Cn(wt+16,mi),Cn(wt+24,0),Cn(wt+32,mi),qe[wt+40>>1]=4,qe[wt+42>>1]=200,os("OK",wt+44,64),jt(wt,0,_i)}else qe[wt+40>>1]=4,qe[wt+42>>1]=404,os("Not Found",wt+44,64),pn(wt,0,"no data")},Wr.onerror=Br=>{qe[wt+40>>1]=4,qe[wt+42>>1]=404,os("Not Found",wt+44,64),pn(wt,0,Br)}}catch(Br){pn(wt,0,Br)}}function yr(Pt,wt,jt,pn){if(!Pt){pn(wt,0,"IndexedDB not available!");return}var qn=wt+112,Jn=Qe[qn+64>>2];Jn||(Jn=Qe[wt+8>>2]);var dr=La(Jn);try{var jn=Pt.transaction(["FILES"],"readwrite"),Lr=jn.objectStore("FILES"),Wr=Lr.delete(dr);Wr.onsuccess=Br=>{var _i=Br.target.result;Qe[wt+12>>2]=0,Cn(wt+16,0),Cn(wt+24,0),Cn(wt+32,0),qe[wt+40>>1]=4,qe[wt+42>>1]=200,os("OK",wt+44,64),jt(wt,0,_i)},Wr.onerror=Br=>{qe[wt+40>>1]=4,qe[wt+42>>1]=404,os("Not Found",wt+44,64),pn(wt,0,Br)}}catch(Br){pn(wt,0,Br)}}function wr(Pt,wt,jt,pn,qn){var Jn=Pt+112,dr=Qe[Jn+36>>2],jn=Qe[Jn+40>>2],Lr=Qe[Jn+44>>2],Wr=Qe[Jn+48>>2],Br=Qe[Jn+52>>2],_i=!!(Br&64);function mi(na){_i?na():_n(na)}var ki=(na,u0,hs)=>{mi(()=>{dr?ii(dr)(na):wt==null||wt(na)})},va=(na,u0,hs)=>{mi(()=>{Lr?ii(Lr)(na):pn==null||pn(na)})},wa=(na,u0,hs)=>{mi(()=>{jn?ii(jn)(na):jt==null||jt(na)})},Aa=(na,u0,hs)=>{mi(()=>{Wr?ii(Wr)(na):qn==null||qn(na)})},Ma=(na,u0,hs)=>{Rt(na,ki,wa,va,Aa)},Tr=(na,u0,hs)=>{var Zx=(Yi,ps,r0)=>{mi(()=>{dr?ii(dr)(Yi):wt==null||wt(Yi)})},Jx=(Yi,ps,r0)=>{mi(()=>{dr?ii(dr)(Yi):wt==null||wt(Yi)})};Dn(Mt.dbInstance,na,u0.response,Zx,Jx)},xi=(na,u0,hs)=>{Rt(na,Tr,wa,va,Aa)},qi=La(Jn+0),ji=!!(Br&16),hi=!!(Br&4),w0=!!(Br&32);if(qi==="EM_IDB_STORE"){var h0=Qe[Jn+84>>2],rx=Qe[Jn+88>>2];Dn(Mt.dbInstance,Pt,Ne.slice(h0,h0+rx),ki,wa)}else if(qi==="EM_IDB_DELETE")yr(Mt.dbInstance,Pt,ki,wa);else if(!ji)Fn(Mt.dbInstance,Pt,ki,w0?wa:hi?xi:Ma);else if(!w0)Rt(Pt,hi?Tr:ki,wa,va,Aa);else return 0;return Pt}var Ar={},li=()=>ae||"./this.program",vi=()=>{if(!vi.strings){var Pt=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",wt={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:Pt,_:li()};for(var jt in Ar)Ar[jt]===void 0?delete wt[jt]:wt[jt]=Ar[jt];var pn=[];for(var jt in wt)pn.push(jt+"="+wt[jt]);vi.strings=pn}return vi.strings},Ei=(Pt,wt)=>{for(var jt=0;jt<Pt.length;++jt)Be[wt++]=Pt.charCodeAt(jt);Be[wt]=0},Gi=(Pt,wt)=>{var jt=0;return vi().forEach((pn,qn)=>{var Jn=wt+jt;Qe[Pt+qn*4>>2]=Jn,Ei(pn,Jn),jt+=pn.length+1}),0},Ki=(Pt,wt)=>{var jt=vi();Qe[Pt>>2]=jt.length;var pn=0;return jt.forEach(qn=>pn+=qn.length+1),Qe[wt>>2]=pn,0},Ii=Pt=>Pt%4===0&&(Pt%100!==0||Pt%400===0),Wi=(Pt,wt)=>{for(var jt=0,pn=0;pn<=wt;jt+=Pt[pn++]);return jt},Fa=[31,29,31,30,31,30,31,31,30,31,30,31],cs=[31,28,31,30,31,30,31,31,30,31,30,31],$a=(Pt,wt)=>{for(var jt=new Date(Pt.getTime());wt>0;){var pn=Ii(jt.getFullYear()),qn=jt.getMonth(),Jn=(pn?Fa:cs)[qn];if(wt>Jn-jt.getDate())wt-=Jn-jt.getDate()+1,jt.setDate(1),qn<11?jt.setMonth(qn+1):(jt.setMonth(0),jt.setFullYear(jt.getFullYear()+1));else return jt.setDate(jt.getDate()+wt),jt}return jt};function ws(Pt,wt,jt){var pn=x0(Pt)+1,qn=new Array(pn);return B0(Pt,qn,0,qn.length),qn}var E0=(Pt,wt)=>{Be.set(Pt,wt)},Co=(Pt,wt,jt,pn)=>{var qn=Qe[pn+40>>2],Jn={tm_sec:Ye[pn>>2],tm_min:Ye[pn+4>>2],tm_hour:Ye[pn+8>>2],tm_mday:Ye[pn+12>>2],tm_mon:Ye[pn+16>>2],tm_year:Ye[pn+20>>2],tm_wday:Ye[pn+24>>2],tm_yday:Ye[pn+28>>2],tm_isdst:Ye[pn+32>>2],tm_gmtoff:Ye[pn+36>>2],tm_zone:qn?La(qn):""},dr=La(jt),jn={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var Lr in jn)dr=dr.replace(new RegExp(Lr,"g"),jn[Lr]);var Wr=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Br=["January","February","March","April","May","June","July","August","September","October","November","December"];function _i(Tr,xi,qi){for(var ji=typeof Tr=="number"?Tr.toString():Tr||"";ji.length<xi;)ji=qi[0]+ji;return ji}function mi(Tr,xi){return _i(Tr,xi,"0")}function ki(Tr,xi){function qi(hi){return hi<0?-1:hi>0?1:0}var ji;return(ji=qi(Tr.getFullYear()-xi.getFullYear()))===0&&(ji=qi(Tr.getMonth()-xi.getMonth()))===0&&(ji=qi(Tr.getDate()-xi.getDate())),ji}function va(Tr){switch(Tr.getDay()){case 0:return new Date(Tr.getFullYear()-1,11,29);case 1:return Tr;case 2:return new Date(Tr.getFullYear(),0,3);case 3:return new Date(Tr.getFullYear(),0,2);case 4:return new Date(Tr.getFullYear(),0,1);case 5:return new Date(Tr.getFullYear()-1,11,31);case 6:return new Date(Tr.getFullYear()-1,11,30)}}function wa(Tr){var xi=$a(new Date(Tr.tm_year+1900,0,1),Tr.tm_yday),qi=new Date(xi.getFullYear(),0,4),ji=new Date(xi.getFullYear()+1,0,4),hi=va(qi),w0=va(ji);return ki(hi,xi)<=0?ki(w0,xi)<=0?xi.getFullYear()+1:xi.getFullYear():xi.getFullYear()-1}var Aa={"%a":Tr=>Wr[Tr.tm_wday].substring(0,3),"%A":Tr=>Wr[Tr.tm_wday],"%b":Tr=>Br[Tr.tm_mon].substring(0,3),"%B":Tr=>Br[Tr.tm_mon],"%C":Tr=>{var xi=Tr.tm_year+1900;return mi(xi/100|0,2)},"%d":Tr=>mi(Tr.tm_mday,2),"%e":Tr=>_i(Tr.tm_mday,2," "),"%g":Tr=>wa(Tr).toString().substring(2),"%G":wa,"%H":Tr=>mi(Tr.tm_hour,2),"%I":Tr=>{var xi=Tr.tm_hour;return xi==0?xi=12:xi>12&&(xi-=12),mi(xi,2)},"%j":Tr=>mi(Tr.tm_mday+Wi(Ii(Tr.tm_year+1900)?Fa:cs,Tr.tm_mon-1),3),"%m":Tr=>mi(Tr.tm_mon+1,2),"%M":Tr=>mi(Tr.tm_min,2),"%n":()=>`
`,"%p":Tr=>Tr.tm_hour>=0&&Tr.tm_hour<12?"AM":"PM","%S":Tr=>mi(Tr.tm_sec,2),"%t":()=>"	","%u":Tr=>Tr.tm_wday||7,"%U":Tr=>{var xi=Tr.tm_yday+7-Tr.tm_wday;return mi(Math.floor(xi/7),2)},"%V":Tr=>{var xi=Math.floor((Tr.tm_yday+7-(Tr.tm_wday+6)%7)/7);if((Tr.tm_wday+371-Tr.tm_yday-2)%7<=2&&xi++,xi){if(xi==53){var qi=(Tr.tm_wday+371-Tr.tm_yday)%7;qi!=4&&(qi!=3||!Ii(Tr.tm_year))&&(xi=1)}}else{xi=52;var ji=(Tr.tm_wday+7-Tr.tm_yday-1)%7;(ji==4||ji==5&&Ii(Tr.tm_year%400-1))&&xi++}return mi(xi,2)},"%w":Tr=>Tr.tm_wday,"%W":Tr=>{var xi=Tr.tm_yday+7-(Tr.tm_wday+6)%7;return mi(Math.floor(xi/7),2)},"%y":Tr=>(Tr.tm_year+1900).toString().substring(2),"%Y":Tr=>Tr.tm_year+1900,"%z":Tr=>{var xi=Tr.tm_gmtoff,qi=xi>=0;return xi=Math.abs(xi)/60,xi=xi/60*100+xi%60,(qi?"+":"-")+("0000"+xi).slice(-4)},"%Z":Tr=>Tr.tm_zone,"%%":()=>"%"};dr=dr.replace(/%%/g,"\0\0");for(var Lr in Aa)dr.includes(Lr)&&(dr=dr.replace(new RegExp(Lr,"g"),Aa[Lr](Jn)));dr=dr.replace(/\0\0/g,"%");var Ma=ws(dr);return Ma.length>wt?0:(E0(Ma,Pt),Ma.length-1)},Ex=(Pt,wt,jt,pn,qn)=>Co(Pt,wt,jt,pn);ai(),er=b.BindingError=class extends Error{constructor(Pt){super(Pt),this.name="BindingError"}},Zn=b.InternalError=class extends Error{constructor(Pt){super(Pt),this.name="InternalError"}},Ss(),Vi(),An(),xa=b.UnboundTypeError=Ai(Error,"UnboundTypeError"),yx(),Mt.init();var Qx={a:Qr,s:Ir,z:zr,l:Zi,f:Js,d:ss,o:Di,y:Yx,r:K0,e:Kx,b:O0,q:bx,m:Sx,A:V0,B:z0,g:l0,c:js,n:j0,h:Es,j:ls,i:T0,k:ex,p:Ns,D:ds,x:H0,w:un,C:wr,u:Gi,v:Ki,t:Ex},zs=Ur(),tx=Pt=>(tx=zs.G)(Pt),c0=Pt=>(c0=zs.I)(Pt),nx=Pt=>(nx=zs.J)(Pt),Kl=Pt=>(Kl=zs.K)(Pt);b.dynCall_viijii=(Pt,wt,jt,pn,qn,Jn,dr)=>(b.dynCall_viijii=zs.L)(Pt,wt,jt,pn,qn,Jn,dr),b.dynCall_iiiiij=(Pt,wt,jt,pn,qn,Jn,dr)=>(b.dynCall_iiiiij=zs.M)(Pt,wt,jt,pn,qn,Jn,dr),b.dynCall_iiiiijj=(Pt,wt,jt,pn,qn,Jn,dr,jn,Lr)=>(b.dynCall_iiiiijj=zs.N)(Pt,wt,jt,pn,qn,Jn,dr,jn,Lr),b.dynCall_iiiiiijj=(Pt,wt,jt,pn,qn,Jn,dr,jn,Lr,Wr)=>(b.dynCall_iiiiiijj=zs.O)(Pt,wt,jt,pn,qn,Jn,dr,jn,Lr,Wr);var Ro;Tt=function Pt(){Ro||Ql(),Ro||(Tt=Pt)};function Ql(){if(gt>0||(Vt(),gt>0))return;function Pt(){Ro||(Ro=!0,b.calledRun=!0,!Ie&&(Gt(),$(b),b.onRuntimeInitialized&&b.onRuntimeInitialized(),$t()))}b.setStatus?(b.setStatus("Running..."),setTimeout(function(){setTimeout(function(){b.setStatus("")},1),Pt()},1)):Pt()}if(b.preInit)for(typeof b.preInit=="function"&&(b.preInit=[b.preInit]);b.preInit.length>0;)b.preInit.pop()();return Ql(),_.ready}})();async function jB(H,_="./",b=!1){const $=await jK({locateFile:ee=>_+ee});return $.Loader.prototype.promisify=function(ee,...re){return ee.call(this,...re),new Promise(ae=>{const xe=setInterval(()=>{if(this.ready)return clearInterval(xe),ae(this.status)},5)})},$.Loader.prototype.load=function(ee){return this.promisify(this.loadAsync,ee,b)},$.Loader.prototype.remove=function(ee){return this.promisify(this.removeAsync,ee)},$.DictLoader.prototype.loadDict=function(ee){return this.promisify(this.loadDictAsync,H,ee)},$}var jV=(()=>{var H=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(_={}){var b=_,$,ee;b.ready=new Promise((zt,Ot)=>{$=zt,ee=Ot});var re=Object.assign({},b),ae=!0,xe="";function le(zt){return b.locateFile?b.locateFile(zt,xe):xe+zt}typeof document<"u"&&document.currentScript&&(xe=document.currentScript.src),H&&(xe=H),xe.startsWith("blob:")?xe="":xe=xe.substr(0,xe.replace(/[?#].*/,"").lastIndexOf("/")+1),b.print||console.log.bind(console);var fe=b.printErr||console.error.bind(console);Object.assign(b,re),re=null,b.arguments&&b.arguments,b.thisProgram&&b.thisProgram,b.quit&&b.quit;var ve;b.wasmBinary&&(ve=b.wasmBinary);var Se,Ee=!1,Ce,Ie,De,Be,Ne,qe,Xe,Ye;function Qe(){var zt=Se.buffer;b.HEAP8=Ce=new Int8Array(zt),b.HEAP16=De=new Int16Array(zt),b.HEAPU8=Ie=new Uint8Array(zt),b.HEAPU16=Be=new Uint16Array(zt),b.HEAP32=Ne=new Int32Array(zt),b.HEAPU32=qe=new Uint32Array(zt),b.HEAPF32=Xe=new Float32Array(zt),b.HEAPF64=Ye=new Float64Array(zt)}var rt=[],ot=[],ct=[];function mt(){if(b.preRun)for(typeof b.preRun=="function"&&(b.preRun=[b.preRun]);b.preRun.length;)Vt(b.preRun.shift());nr(rt)}function _t(){nr(ot)}function Lt(){if(b.postRun)for(typeof b.postRun=="function"&&(b.postRun=[b.postRun]);b.postRun.length;)$t(b.postRun.shift());nr(ct)}function Vt(zt){rt.unshift(zt)}function Gt(zt){ot.unshift(zt)}function $t(zt){ct.unshift(zt)}var Qt=0,vt=null;function It(zt){var Ot;Qt++,(Ot=b.monitorRunDependencies)==null||Ot.call(b,Qt)}function gt(zt){var Ot;if(Qt--,(Ot=b.monitorRunDependencies)==null||Ot.call(b,Qt),Qt==0&&vt){var un=vt;vt=null,un()}}function Tt(zt){var Ot;(Ot=b.onAbort)==null||Ot.call(b,zt),zt="Aborted("+zt+")",fe(zt),Ee=!0,zt+=". Build with -sASSERTIONS for more info.";var un=new WebAssembly.RuntimeError(zt);throw ee(un),un}var Ct="data:application/octet-stream;base64,",Ft=zt=>zt.startsWith(Ct),sn;sn="poseutils.wasm",Ft(sn)||(sn=le(sn));function cn(zt){if(zt==sn&&ve)return new Uint8Array(ve);throw"both async and sync fetching of the wasm failed"}function en(zt){return!ve&&ae&&typeof fetch=="function"?fetch(zt,{credentials:"same-origin"}).then(Ot=>{if(!Ot.ok)throw"failed to load wasm binary file at '"+zt+"'";return Ot.arrayBuffer()}).catch(()=>cn(zt)):Promise.resolve().then(()=>cn(zt))}function yn(zt,Ot,un){return en(zt).then(kn=>WebAssembly.instantiate(kn,Ot)).then(un,kn=>{fe("failed to asynchronously prepare wasm: "+kn),Tt(kn)})}function Pn(zt,Ot,un,kn){return!zt&&typeof WebAssembly.instantiateStreaming=="function"&&!Ft(Ot)&&typeof fetch=="function"?fetch(Ot,{credentials:"same-origin"}).then(Mt=>{var Rt=WebAssembly.instantiateStreaming(Mt,un);return Rt.then(kn,function(Zt){return fe("wasm streaming compile failed: "+Zt),fe("falling back to ArrayBuffer instantiation"),yn(Ot,un,kn)})}):yn(Ot,un,kn)}function tr(){var zt={a:j0};function Ot(kn,Mt){return Es=kn.exports,Se=Es.v,Qe(),Yr=Es.z,Gt(Es.w),gt(),Es}It();function un(kn){Ot(kn.instance)}if(b.instantiateWasm)try{return b.instantiateWasm(zt,Ot)}catch(kn){fe("Module.instantiateWasm callback failed with error: "+kn),ee(kn)}return Pn(ve,sn,zt,un).catch(ee),{}}var nr=zt=>{for(;zt.length>0;)zt.shift()(b)};b.noExitRuntime;class Fr{constructor(Ot){this.excPtr=Ot,this.ptr=Ot-24}set_type(Ot){qe[this.ptr+4>>2]=Ot}get_type(){return qe[this.ptr+4>>2]}set_destructor(Ot){qe[this.ptr+8>>2]=Ot}get_destructor(){return qe[this.ptr+8>>2]}set_caught(Ot){Ot=Ot?1:0,Ce[this.ptr+12]=Ot}get_caught(){return Ce[this.ptr+12]!=0}set_rethrown(Ot){Ot=Ot?1:0,Ce[this.ptr+13]=Ot}get_rethrown(){return Ce[this.ptr+13]!=0}init(Ot,un){this.set_adjusted_ptr(0),this.set_type(Ot),this.set_destructor(un)}set_adjusted_ptr(Ot){qe[this.ptr+16>>2]=Ot}get_adjusted_ptr(){return qe[this.ptr+16>>2]}get_exception_ptr(){var Ot=Ns(this.get_type());if(Ot)return qe[this.excPtr>>2];var un=this.get_adjusted_ptr();return un!==0?un:this.excPtr}}var Ur=0,Kr=(zt,Ot,un)=>{var kn=new Fr(zt);throw kn.init(Ot,un),Ur=zt,Ur},on={},qr=zt=>{for(;zt.length;){var Ot=zt.pop(),un=zt.pop();un(Ot)}};function rr(zt){return this.fromWireType(qe[zt>>2])}var Qr={},Ir={},ai={},Hr,Vr=zt=>{throw new Hr(zt)},xn=(zt,Ot,un)=>{zt.forEach(function(an){ai[an]=Ot});function kn(an){var _n=un(an);_n.length!==zt.length&&Vr("Mismatched type converter count");for(var Cn=0;Cn<zt.length;++Cn)vr(zt[Cn],_n[Cn])}var Mt=new Array(Ot.length),Rt=[],Zt=0;Ot.forEach((an,_n)=>{Ir.hasOwnProperty(an)?Mt[_n]=Ir[an]:(Rt.push(an),Qr.hasOwnProperty(an)||(Qr[an]=[]),Qr[an].push(()=>{Mt[_n]=Ir[an],++Zt,Zt===Rt.length&&kn(Mt)}))}),Rt.length===0&&kn(Mt)},Ht=zt=>{var Ot=on[zt];delete on[zt];var un=Ot.rawConstructor,kn=Ot.rawDestructor,Mt=Ot.fields,Rt=Mt.map(Zt=>Zt.getterReturnType).concat(Mt.map(Zt=>Zt.setterArgumentType));xn([zt],Rt,Zt=>{var an={};return Mt.forEach((_n,Cn)=>{var Dn=_n.fieldName,Fn=Zt[Cn],yr=_n.getter,wr=_n.getterContext,Ar=Zt[Cn+Mt.length],li=_n.setter,vi=_n.setterContext;an[Dn]={read:Ei=>Fn.fromWireType(yr(wr,Ei)),write:(Ei,Gi)=>{var Ki=[];li(vi,Ei,Ar.toWireType(Ki,Gi)),qr(Ki)}}}),[{name:Ot.name,fromWireType:_n=>{var Cn={};for(var Dn in an)Cn[Dn]=an[Dn].read(_n);return kn(_n),Cn},toWireType:(_n,Cn)=>{for(var Dn in an)if(!(Dn in Cn))throw new TypeError('Missing field: "'+Dn+'"');var Fn=un();for(Dn in an)an[Dn].write(Fn,Cn[Dn]);return _n!==null&&_n.push(kn,Fn),Fn},argPackAdvance:Sr,readValueFromPointer:rr,destructorFunction:kn}]})},In=(zt,Ot,un,kn,Mt)=>{},er=()=>{for(var zt=new Array(256),Ot=0;Ot<256;++Ot)zt[Ot]=String.fromCharCode(Ot);Hn=zt},Hn,Zn=zt=>{for(var Ot="",un=zt;Ie[un];)Ot+=Hn[Ie[un++]];return Ot},Dr,zn=zt=>{throw new Dr(zt)};function Nr(zt,Ot,un={}){var kn=Ot.name;if(zt||zn('type "'+kn+'" must have a positive integer typeid pointer'),Ir.hasOwnProperty(zt)){if(un.ignoreDuplicateRegistrations)return;zn("Cannot register type '"+kn+"' twice")}if(Ir[zt]=Ot,delete ai[zt],Qr.hasOwnProperty(zt)){var Mt=Qr[zt];delete Qr[zt],Mt.forEach(Rt=>Rt())}}function vr(zt,Ot,un={}){if(!("argPackAdvance"in Ot))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Nr(zt,Ot,un)}var Sr=8,zr=(zt,Ot,un,kn)=>{Ot=Zn(Ot),vr(zt,{name:Ot,fromWireType:function(Mt){return!!Mt},toWireType:function(Mt,Rt){return Rt?un:kn},argPackAdvance:Sr,readValueFromPointer:function(Mt){return this.fromWireType(Ie[Mt])},destructorFunction:null})},gi=zt=>({count:zt.count,deleteScheduled:zt.deleteScheduled,preservePointerOnDelete:zt.preservePointerOnDelete,ptr:zt.ptr,ptrType:zt.ptrType,smartPtr:zt.smartPtr,smartPtrType:zt.smartPtrType}),oi=zt=>{function Ot(un){return un.$$.ptrType.registeredClass.name}zn(Ot(zt)+" instance already deleted")},Gr=!1,ri=zt=>{},yi=zt=>{zt.smartPtr?zt.smartPtrType.rawDestructor(zt.smartPtr):zt.ptrType.registeredClass.rawDestructor(zt.ptr)},Ci=zt=>{zt.count.value-=1;var Ot=zt.count.value===0;Ot&&yi(zt)},wn=(zt,Ot,un)=>{if(Ot===un)return zt;if(un.baseClass===void 0)return null;var kn=wn(zt,Ot,un.baseClass);return kn===null?null:un.downcast(kn)},Pr={},xr=()=>Object.keys(bi).length,gr=()=>{var zt=[];for(var Ot in bi)bi.hasOwnProperty(Ot)&&zt.push(bi[Ot]);return zt},Mr=[],ci=()=>{for(;Mr.length;){var zt=Mr.pop();zt.$$.deleteScheduled=!1,zt.delete()}},fi,Ui=zt=>{fi=zt,Mr.length&&fi&&fi(ci)},Vi=()=>{b.getInheritedInstanceCount=xr,b.getLiveInheritedInstances=gr,b.flushPendingDeletes=ci,b.setDelayFunction=Ui},bi={},Ga=(zt,Ot)=>{for(Ot===void 0&&zn("ptr should not be undefined");zt.baseClass;)Ot=zt.upcast(Ot),zt=zt.baseClass;return Ot},Ra=(zt,Ot)=>(Ot=Ga(zt,Ot),bi[Ot]),sa=(zt,Ot)=>{(!Ot.ptrType||!Ot.ptr)&&Vr("makeClassHandle requires ptr and ptrType");var un=!!Ot.smartPtrType,kn=!!Ot.smartPtr;return un!==kn&&Vr("Both smartPtrType and smartPtr must be specified"),Ot.count={value:1},Fi(Object.create(zt,{$$:{value:Ot,writable:!0}}))};function $i(zt){var Ot=this.getPointee(zt);if(!Ot)return this.destructor(zt),null;var un=Ra(this.registeredClass,Ot);if(un!==void 0){if(un.$$.count.value===0)return un.$$.ptr=Ot,un.$$.smartPtr=zt,un.clone();var kn=un.clone();return this.destructor(zt),kn}function Mt(){return this.isSmartPointer?sa(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:Ot,smartPtrType:this,smartPtr:zt}):sa(this.registeredClass.instancePrototype,{ptrType:this,ptr:zt})}var Rt=this.registeredClass.getActualType(Ot),Zt=Pr[Rt];if(!Zt)return Mt.call(this);var an;this.isConst?an=Zt.constPointerType:an=Zt.pointerType;var _n=wn(Ot,this.registeredClass,an.registeredClass);return _n===null?Mt.call(this):this.isSmartPointer?sa(an.registeredClass.instancePrototype,{ptrType:an,ptr:_n,smartPtrType:this,smartPtr:zt}):sa(an.registeredClass.instancePrototype,{ptrType:an,ptr:_n})}var Fi=zt=>typeof FinalizationRegistry>"u"?(Fi=Ot=>Ot,zt):(Gr=new FinalizationRegistry(Ot=>{Ci(Ot.$$)}),Fi=Ot=>{var un=Ot.$$,kn=!!un.smartPtr;if(kn){var Mt={$$:un};Gr.register(Ot,Mt,Ot)}return Ot},ri=Ot=>Gr.unregister(Ot),Fi(zt)),Ss=()=>{Object.assign(ta.prototype,{isAliasOf(zt){if(!(this instanceof ta)||!(zt instanceof ta))return!1;var Ot=this.$$.ptrType.registeredClass,un=this.$$.ptr;zt.$$=zt.$$;for(var kn=zt.$$.ptrType.registeredClass,Mt=zt.$$.ptr;Ot.baseClass;)un=Ot.upcast(un),Ot=Ot.baseClass;for(;kn.baseClass;)Mt=kn.upcast(Mt),kn=kn.baseClass;return Ot===kn&&un===Mt},clone(){if(this.$$.ptr||oi(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var zt=Fi(Object.create(Object.getPrototypeOf(this),{$$:{value:gi(this.$$)}}));return zt.$$.count.value+=1,zt.$$.deleteScheduled=!1,zt},delete(){this.$$.ptr||oi(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&zn("Object already scheduled for deletion"),ri(this),Ci(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||oi(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&zn("Object already scheduled for deletion"),Mr.push(this),Mr.length===1&&fi&&fi(ci),this.$$.deleteScheduled=!0,this}})};function ta(){}var Na=(zt,Ot)=>Object.defineProperty(Ot,"name",{value:zt}),is=(zt,Ot,un)=>{if(zt[Ot].overloadTable===void 0){var kn=zt[Ot];zt[Ot]=function(...Mt){return zt[Ot].overloadTable.hasOwnProperty(Mt.length)||zn("Function '"+un+"' called with an invalid number of arguments ("+Mt.length+") - expects one of ("+zt[Ot].overloadTable+")!"),zt[Ot].overloadTable[Mt.length].apply(this,Mt)},zt[Ot].overloadTable=[],zt[Ot].overloadTable[kn.argCount]=kn}},Hs=(zt,Ot,un)=>{b.hasOwnProperty(zt)?(zn("Cannot register public name '"+zt+"' twice"),is(b,zt,zt),b.hasOwnProperty(un)&&zn("Cannot register multiple overloads of a function with the same number of arguments ("+un+")!"),b[zt].overloadTable[un]=Ot):b[zt]=Ot},$s=48,v0=57,Qs=zt=>{if(zt===void 0)return"_unknown";zt=zt.replace(/[^a-zA-Z0-9_]/g,"$");var Ot=zt.charCodeAt(0);return Ot>=$s&&Ot<=v0?"_"+zt:zt};function Zs(zt,Ot,un,kn,Mt,Rt,Zt,an){this.name=zt,this.constructor=Ot,this.instancePrototype=un,this.rawDestructor=kn,this.baseClass=Mt,this.getActualType=Rt,this.upcast=Zt,this.downcast=an,this.pureVirtualFunctions=[]}var as=(zt,Ot,un)=>{for(;Ot!==un;)Ot.upcast||zn("Expected null or instance of "+un.name+", got an instance of "+Ot.name),zt=Ot.upcast(zt),Ot=Ot.baseClass;return zt};function Jt(zt,Ot){if(Ot===null)return this.isReference&&zn("null is not a valid "+this.name),0;Ot.$$||zn('Cannot pass "'+e0(Ot)+'" as a '+this.name),Ot.$$.ptr||zn("Cannot pass deleted object as a pointer of type "+this.name);var un=Ot.$$.ptrType.registeredClass,kn=as(Ot.$$.ptr,un,this.registeredClass);return kn}function vn(zt,Ot){var un;if(Ot===null)return this.isReference&&zn("null is not a valid "+this.name),this.isSmartPointer?(un=this.rawConstructor(),zt!==null&&zt.push(this.rawDestructor,un),un):0;(!Ot||!Ot.$$)&&zn('Cannot pass "'+e0(Ot)+'" as a '+this.name),Ot.$$.ptr||zn("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&Ot.$$.ptrType.isConst&&zn("Cannot convert argument of type "+(Ot.$$.smartPtrType?Ot.$$.smartPtrType.name:Ot.$$.ptrType.name)+" to parameter type "+this.name);var kn=Ot.$$.ptrType.registeredClass;if(un=as(Ot.$$.ptr,kn,this.registeredClass),this.isSmartPointer)switch(Ot.$$.smartPtr===void 0&&zn("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:Ot.$$.smartPtrType===this?un=Ot.$$.smartPtr:zn("Cannot convert argument of type "+(Ot.$$.smartPtrType?Ot.$$.smartPtrType.name:Ot.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:un=Ot.$$.smartPtr;break;case 2:if(Ot.$$.smartPtrType===this)un=Ot.$$.smartPtr;else{var Mt=Ot.clone();un=this.rawShare(un,Ys.toHandle(()=>Mt.delete())),zt!==null&&zt.push(this.rawDestructor,un)}break;default:zn("Unsupporting sharing policy")}return un}function $n(zt,Ot){if(Ot===null)return this.isReference&&zn("null is not a valid "+this.name),0;Ot.$$||zn('Cannot pass "'+e0(Ot)+'" as a '+this.name),Ot.$$.ptr||zn("Cannot pass deleted object as a pointer of type "+this.name),Ot.$$.ptrType.isConst&&zn("Cannot convert argument of type "+Ot.$$.ptrType.name+" to parameter type "+this.name);var un=Ot.$$.ptrType.registeredClass,kn=as(Ot.$$.ptr,un,this.registeredClass);return kn}var Wn=()=>{Object.assign(An.prototype,{getPointee(zt){return this.rawGetPointee&&(zt=this.rawGetPointee(zt)),zt},destructor(zt){var Ot;(Ot=this.rawDestructor)==null||Ot.call(this,zt)},argPackAdvance:Sr,readValueFromPointer:rr,fromWireType:$i})};function An(zt,Ot,un,kn,Mt,Rt,Zt,an,_n,Cn,Dn){this.name=zt,this.registeredClass=Ot,this.isReference=un,this.isConst=kn,this.isSmartPointer=Mt,this.pointeeType=Rt,this.sharingPolicy=Zt,this.rawGetPointee=an,this.rawConstructor=_n,this.rawShare=Cn,this.rawDestructor=Dn,!Mt&&Ot.baseClass===void 0?kn?(this.toWireType=Jt,this.destructorFunction=null):(this.toWireType=$n,this.destructorFunction=null):this.toWireType=vn}var Cr=(zt,Ot,un)=>{b.hasOwnProperty(zt)||Vr("Replacing nonexistent public symbol"),b[zt].overloadTable!==void 0&&un!==void 0?b[zt].overloadTable[un]=Ot:(b[zt]=Ot,b[zt].argCount=un)},$r=(zt,Ot,un)=>{var kn=b["dynCall_"+zt];return kn(Ot,...un)},Xr=[],Yr,ui=zt=>{var Ot=Xr[zt];return Ot||(zt>=Xr.length&&(Xr.length=zt+1),Xr[zt]=Ot=Yr.get(zt)),Ot},ii=(zt,Ot,un=[])=>{if(zt.includes("j"))return $r(zt,Ot,un);var kn=ui(Ot)(...un);return kn},jr=(zt,Ot)=>(...un)=>ii(zt,Ot,un),di=(zt,Ot)=>{zt=Zn(zt);function un(){return zt.includes("j")?jr(zt,Ot):ui(Ot)}var kn=un();return typeof kn!="function"&&zn("unknown function pointer with signature "+zt+": "+Ot),kn},Pi=(zt,Ot)=>{var un=Na(Ot,function(kn){this.name=Ot,this.message=kn;var Mt=new Error(kn).stack;Mt!==void 0&&(this.stack=this.toString()+`
`+Mt.replace(/^Error(:[^\n]*)?\n/,""))});return un.prototype=Object.create(zt.prototype),un.prototype.constructor=un,un.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},un},Ai,xa=zt=>{var Ot=ex(zt),un=Zn(Ot);return ls(Ot),un},Mi=(zt,Ot)=>{var un=[],kn={};function Mt(Rt){if(!kn[Rt]&&!Ir[Rt]){if(ai[Rt]){ai[Rt].forEach(Mt);return}un.push(Rt),kn[Rt]=!0}}throw Ot.forEach(Mt),new Ai(zt+": "+un.map(xa).join([", "]))},Jr=(zt,Ot,un,kn,Mt,Rt,Zt,an,_n,Cn,Dn,Fn,yr)=>{Dn=Zn(Dn),Rt=di(Mt,Rt),an&&(an=di(Zt,an)),Cn&&(Cn=di(_n,Cn)),yr=di(Fn,yr);var wr=Qs(Dn);Hs(wr,function(){Mi("Cannot construct "+Dn+" due to unbound types",[kn])}),xn([zt,Ot,un],kn?[kn]:[],Ar=>{var li;Ar=Ar[0];var vi,Ei;kn?(vi=Ar.registeredClass,Ei=vi.instancePrototype):Ei=ta.prototype;var Gi=Na(Dn,function(...$a){if(Object.getPrototypeOf(this)!==Ki)throw new Dr("Use 'new' to construct "+Dn);if(Ii.constructor_body===void 0)throw new Dr(Dn+" has no accessible constructor");var ws=Ii.constructor_body[$a.length];if(ws===void 0)throw new Dr("Tried to invoke ctor of "+Dn+" with invalid number of parameters ("+$a.length+") - expected ("+Object.keys(Ii.constructor_body).toString()+") parameters instead!");return ws.apply(this,$a)}),Ki=Object.create(Ei,{constructor:{value:Gi}});Gi.prototype=Ki;var Ii=new Zs(Dn,Gi,Ki,yr,vi,Rt,an,Cn);Ii.baseClass&&((li=Ii.baseClass).__derivedClasses!=null||(li.__derivedClasses=[]),Ii.baseClass.__derivedClasses.push(Ii));var Wi=new An(Dn,Ii,!0,!1,!1),Fa=new An(Dn+"*",Ii,!1,!1,!1),cs=new An(Dn+" const*",Ii,!1,!0,!1);return Pr[zt]={pointerType:Fa,constPointerType:cs},Cr(wr,Gi),[Wi,Fa,cs]})},Zi=(zt,Ot)=>{for(var un=[],kn=0;kn<zt;kn++)un.push(qe[Ot+kn*4>>2]);return un};function Ri(zt){for(var Ot=1;Ot<zt.length;++Ot)if(zt[Ot]!==null&&zt[Ot].destructorFunction===void 0)return!0;return!1}function zi(zt,Ot,un,kn,Mt,Rt){var Zt=Ot.length;Zt<2&&zn("argTypes array size mismatch! Must at least get return value and 'this' types!");var an=Ot[1]!==null&&un!==null,_n=Ri(Ot),Cn=Ot[0].name!=="void",Dn=Zt-2,Fn=new Array(Dn),yr=[],wr=[],Ar=function(...li){li.length!==Dn&&zn("function "+zt+" called with "+li.length+" arguments, expected "+Dn),wr.length=0;var vi;yr.length=an?2:1,yr[0]=Mt,an&&(vi=Ot[1].toWireType(wr,this),yr[1]=vi);for(var Ei=0;Ei<Dn;++Ei)Fn[Ei]=Ot[Ei+2].toWireType(wr,li[Ei]),yr.push(Fn[Ei]);var Gi=kn(...yr);function Ki(Ii){if(_n)qr(wr);else for(var Wi=an?1:2;Wi<Ot.length;Wi++){var Fa=Wi===1?vi:Fn[Wi-2];Ot[Wi].destructorFunction!==null&&Ot[Wi].destructorFunction(Fa)}if(Cn)return Ot[0].fromWireType(Ii)}return Ki(Gi)};return Na(zt,Ar)}var Ws=(zt,Ot,un,kn,Mt,Rt)=>{var Zt=Zi(Ot,un);Mt=di(kn,Mt),xn([],[zt],an=>{an=an[0];var _n="constructor "+an.name;if(an.registeredClass.constructor_body===void 0&&(an.registeredClass.constructor_body=[]),an.registeredClass.constructor_body[Ot-1]!==void 0)throw new Dr("Cannot register multiple constructors with identical number of parameters ("+(Ot-1)+") for class '"+an.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return an.registeredClass.constructor_body[Ot-1]=()=>{Mi("Cannot construct "+an.name+" due to unbound types",Zt)},xn([],Zt,Cn=>(Cn.splice(1,0,null),an.registeredClass.constructor_body[Ot-1]=zi(_n,Cn,null,Mt,Rt),[])),[]})},Da=zt=>{zt=zt.trim();const Ot=zt.indexOf("(");return Ot!==-1?zt.substr(0,Ot):zt},Js=(zt,Ot,un,kn,Mt,Rt,Zt,an,_n)=>{var Cn=Zi(un,kn);Ot=Zn(Ot),Ot=Da(Ot),Rt=di(Mt,Rt),xn([],[zt],Dn=>{Dn=Dn[0];var Fn=Dn.name+"."+Ot;Ot.startsWith("@@")&&(Ot=Symbol[Ot.substring(2)]),an&&Dn.registeredClass.pureVirtualFunctions.push(Ot);function yr(){Mi("Cannot call "+Fn+" due to unbound types",Cn)}var wr=Dn.registeredClass.instancePrototype,Ar=wr[Ot];return Ar===void 0||Ar.overloadTable===void 0&&Ar.className!==Dn.name&&Ar.argCount===un-2?(yr.argCount=un-2,yr.className=Dn.name,wr[Ot]=yr):(is(wr,Ot,Fn),wr[Ot].overloadTable[un-2]=yr),xn([],Cn,li=>{var vi=zi(Fn,li,Dn,Rt,Zt);return wr[Ot].overloadTable===void 0?(vi.argCount=un-2,wr[Ot]=vi):wr[Ot].overloadTable[un-2]=vi,[]}),[]})},Ji=(zt,Ot,un)=>(zt instanceof Object||zn(un+' with invalid "this": '+zt),zt instanceof Ot.registeredClass.constructor||zn(un+' incompatible with "this" of type '+zt.constructor.name),zt.$$.ptr||zn("cannot call emscripten binding method "+un+" on deleted object"),as(zt.$$.ptr,zt.$$.ptrType.registeredClass,Ot.registeredClass)),ss=(zt,Ot,un,kn,Mt,Rt,Zt,an,_n,Cn)=>{Ot=Zn(Ot),Mt=di(kn,Mt),xn([],[zt],Dn=>{Dn=Dn[0];var Fn=Dn.name+"."+Ot,yr={get(){Mi("Cannot access "+Fn+" due to unbound types",[un,Zt])},enumerable:!0,configurable:!0};return _n?yr.set=()=>Mi("Cannot access "+Fn+" due to unbound types",[un,Zt]):yr.set=wr=>zn(Fn+" is a read-only property"),Object.defineProperty(Dn.registeredClass.instancePrototype,Ot,yr),xn([],_n?[un,Zt]:[un],wr=>{var Ar=wr[0],li={get(){var Ei=Ji(this,Dn,Fn+" getter");return Ar.fromWireType(Mt(Rt,Ei))},enumerable:!0};if(_n){_n=di(an,_n);var vi=wr[1];li.set=function(Ei){var Gi=Ji(this,Dn,Fn+" setter"),Ki=[];_n(Cn,Gi,vi.toWireType(Ki,Ei)),qr(Ki)}}return Object.defineProperty(Dn.registeredClass.instancePrototype,Ot,li),[]}),[]})},qs=[],Di=[],Ts=zt=>{zt>9&&--Di[zt+1]===0&&(Di[zt]=void 0,qs.push(zt))},Pa=()=>Di.length/2-5-qs.length,js=()=>{Di.push(0,1,void 0,1,null,1,!0,1,!1,1),b.count_emval_handles=Pa},Ys={toValue:zt=>(zt||zn("Cannot use deleted val. handle = "+zt),Di[zt]),toHandle:zt=>{switch(zt){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const Ot=qs.pop()||Di.length;return Di[Ot]=zt,Di[Ot+1]=1,Ot}}}},yx={name:"emscripten::val",fromWireType:zt=>{var Ot=Ys.toValue(zt);return Ts(zt),Ot},toWireType:(zt,Ot)=>Ys.toHandle(Ot),argPackAdvance:Sr,readValueFromPointer:rr,destructorFunction:null},ka=zt=>vr(zt,yx),e0=zt=>{if(zt===null)return"null";var Ot=typeof zt;return Ot==="object"||Ot==="array"||Ot==="function"?zt.toString():""+zt},Yx=(zt,Ot)=>{switch(Ot){case 4:return function(un){return this.fromWireType(Xe[un>>2])};case 8:return function(un){return this.fromWireType(Ye[un>>3])};default:throw new TypeError("invalid float width ("+Ot+"): "+zt)}},_0=(zt,Ot,un)=>{Ot=Zn(Ot),vr(zt,{name:Ot,fromWireType:kn=>kn,toWireType:(kn,Mt)=>Mt,argPackAdvance:Sr,readValueFromPointer:Yx(Ot,un),destructorFunction:null})},gx=(zt,Ot,un)=>{switch(Ot){case 1:return un?kn=>Ce[kn]:kn=>Ie[kn];case 2:return un?kn=>De[kn>>1]:kn=>Be[kn>>1];case 4:return un?kn=>Ne[kn>>2]:kn=>qe[kn>>2];default:throw new TypeError("invalid integer width ("+Ot+"): "+zt)}},K0=(zt,Ot,un,kn,Mt)=>{Ot=Zn(Ot);var Rt=Dn=>Dn;if(kn===0){var Zt=32-8*un;Rt=Dn=>Dn<<Zt>>>Zt}var an=Ot.includes("unsigned"),_n=(Dn,Fn)=>{},Cn;an?Cn=function(Dn,Fn){return _n(Fn,this.name),Fn>>>0}:Cn=function(Dn,Fn){return _n(Fn,this.name),Fn},vr(zt,{name:Ot,fromWireType:Rt,toWireType:Cn,argPackAdvance:Sr,readValueFromPointer:gx(Ot,un,kn!==0),destructorFunction:null})},Xx=(zt,Ot,un)=>{var kn=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],Mt=kn[Ot];function Rt(Zt){var an=qe[Zt>>2],_n=qe[Zt+4>>2];return new Mt(Ce.buffer,_n,an)}un=Zn(un),vr(zt,{name:un,fromWireType:Rt,argPackAdvance:Sr,readValueFromPointer:Rt},{ignoreDuplicateRegistrations:!0})},Kx=(zt,Ot,un,kn)=>{if(!(kn>0))return 0;for(var Mt=un,Rt=un+kn-1,Zt=0;Zt<zt.length;++Zt){var an=zt.charCodeAt(Zt);if(an>=55296&&an<=57343){var _n=zt.charCodeAt(++Zt);an=65536+((an&1023)<<10)|_n&1023}if(an<=127){if(un>=Rt)break;Ot[un++]=an}else if(an<=2047){if(un+1>=Rt)break;Ot[un++]=192|an>>6,Ot[un++]=128|an&63}else if(an<=65535){if(un+2>=Rt)break;Ot[un++]=224|an>>12,Ot[un++]=128|an>>6&63,Ot[un++]=128|an&63}else{if(un+3>=Rt)break;Ot[un++]=240|an>>18,Ot[un++]=128|an>>12&63,Ot[un++]=128|an>>6&63,Ot[un++]=128|an&63}}return Ot[un]=0,un-Mt},O0=(zt,Ot,un)=>Kx(zt,Ie,Ot,un),B0=zt=>{for(var Ot=0,un=0;un<zt.length;++un){var kn=zt.charCodeAt(un);kn<=127?Ot++:kn<=2047?Ot+=2:kn>=55296&&kn<=57343?(Ot+=4,++un):Ot+=3}return Ot},os=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,x0=(zt,Ot,un)=>{for(var kn=Ot+un,Mt=Ot;zt[Mt]&&!(Mt>=kn);)++Mt;if(Mt-Ot>16&&zt.buffer&&os)return os.decode(zt.subarray(Ot,Mt));for(var Rt="";Ot<Mt;){var Zt=zt[Ot++];if(!(Zt&128)){Rt+=String.fromCharCode(Zt);continue}var an=zt[Ot++]&63;if((Zt&224)==192){Rt+=String.fromCharCode((Zt&31)<<6|an);continue}var _n=zt[Ot++]&63;if((Zt&240)==224?Zt=(Zt&15)<<12|an<<6|_n:Zt=(Zt&7)<<18|an<<12|_n<<6|zt[Ot++]&63,Zt<65536)Rt+=String.fromCharCode(Zt);else{var Cn=Zt-65536;Rt+=String.fromCharCode(55296|Cn>>10,56320|Cn&1023)}}return Rt},t0=(zt,Ot)=>zt?x0(Ie,zt,Ot):"",vx=(zt,Ot)=>{Ot=Zn(Ot);var un=Ot==="std::string";vr(zt,{name:Ot,fromWireType(kn){var Mt=qe[kn>>2],Rt=kn+4,Zt;if(un)for(var an=Rt,_n=0;_n<=Mt;++_n){var Cn=Rt+_n;if(_n==Mt||Ie[Cn]==0){var Dn=Cn-an,Fn=t0(an,Dn);Zt===void 0?Zt=Fn:(Zt+="\0",Zt+=Fn),an=Cn+1}}else{for(var yr=new Array(Mt),_n=0;_n<Mt;++_n)yr[_n]=String.fromCharCode(Ie[Rt+_n]);Zt=yr.join("")}return ls(kn),Zt},toWireType(kn,Mt){Mt instanceof ArrayBuffer&&(Mt=new Uint8Array(Mt));var Rt,Zt=typeof Mt=="string";Zt||Mt instanceof Uint8Array||Mt instanceof Uint8ClampedArray||Mt instanceof Int8Array||zn("Cannot pass non-string to std::string"),un&&Zt?Rt=B0(Mt):Rt=Mt.length;var an=T0(4+Rt+1),_n=an+4;if(qe[an>>2]=Rt,un&&Zt)O0(Mt,_n,Rt+1);else if(Zt)for(var Cn=0;Cn<Rt;++Cn){var Dn=Mt.charCodeAt(Cn);Dn>255&&(ls(_n),zn("String has UTF-16 code units that do not fit in 8 bits")),Ie[_n+Cn]=Dn}else for(var Cn=0;Cn<Rt;++Cn)Ie[_n+Cn]=Mt[Cn];return kn!==null&&kn.push(ls,an),an},argPackAdvance:Sr,readValueFromPointer:rr,destructorFunction(kn){ls(kn)}})},La=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,bx=(zt,Ot)=>{for(var un=zt,kn=un>>1,Mt=kn+Ot/2;!(kn>=Mt)&&Be[kn];)++kn;if(un=kn<<1,un-zt>32&&La)return La.decode(Ie.subarray(zt,un));for(var Rt="",Zt=0;!(Zt>=Ot/2);++Zt){var an=De[zt+Zt*2>>1];if(an==0)break;Rt+=String.fromCharCode(an)}return Rt},o0=(zt,Ot,un)=>{if(un!=null||(un=2147483647),un<2)return 0;un-=2;for(var kn=Ot,Mt=un<zt.length*2?un/2:zt.length,Rt=0;Rt<Mt;++Rt){var Zt=zt.charCodeAt(Rt);De[Ot>>1]=Zt,Ot+=2}return De[Ot>>1]=0,Ot-kn},Xs=zt=>zt.length*2,Q0=(zt,Ot)=>{for(var un=0,kn="";!(un>=Ot/4);){var Mt=Ne[zt+un*4>>2];if(Mt==0)break;if(++un,Mt>=65536){var Rt=Mt-65536;kn+=String.fromCharCode(55296|Rt>>10,56320|Rt&1023)}else kn+=String.fromCharCode(Mt)}return kn},D0=(zt,Ot,un)=>{if(un!=null||(un=2147483647),un<4)return 0;for(var kn=Ot,Mt=kn+un-4,Rt=0;Rt<zt.length;++Rt){var Zt=zt.charCodeAt(Rt);if(Zt>=55296&&Zt<=57343){var an=zt.charCodeAt(++Rt);Zt=65536+((Zt&1023)<<10)|an&1023}if(Ne[Ot>>2]=Zt,Ot+=4,Ot+4>Mt)break}return Ne[Ot>>2]=0,Ot-kn},n0=zt=>{for(var Ot=0,un=0;un<zt.length;++un){var kn=zt.charCodeAt(un);kn>=55296&&kn<=57343&&++un,Ot+=4}return Ot},Z0=(zt,Ot,un)=>{un=Zn(un);var kn,Mt,Rt,Zt;Ot===2?(kn=bx,Mt=o0,Zt=Xs,Rt=an=>Be[an>>1]):Ot===4&&(kn=Q0,Mt=D0,Zt=n0,Rt=an=>qe[an>>2]),vr(zt,{name:un,fromWireType:an=>{for(var _n=qe[an>>2],Cn,Dn=an+4,Fn=0;Fn<=_n;++Fn){var yr=an+4+Fn*Ot;if(Fn==_n||Rt(yr)==0){var wr=yr-Dn,Ar=kn(Dn,wr);Cn===void 0?Cn=Ar:(Cn+="\0",Cn+=Ar),Dn=yr+Ot}}return ls(an),Cn},toWireType:(an,_n)=>{typeof _n!="string"&&zn("Cannot pass non-string to C++ string type "+un);var Cn=Zt(_n),Dn=T0(4+Cn+Ot);return qe[Dn>>2]=Cn/Ot,Mt(_n,Dn+4,Cn+Ot),an!==null&&an.push(ls,Dn),Dn},argPackAdvance:Sr,readValueFromPointer:rr,destructorFunction(an){ls(an)}})},U0=(zt,Ot,un,kn,Mt,Rt)=>{on[zt]={name:Zn(Ot),rawConstructor:di(un,kn),rawDestructor:di(Mt,Rt),fields:[]}},Sx=(zt,Ot,un,kn,Mt,Rt,Zt,an,_n,Cn)=>{on[zt].fields.push({fieldName:Zn(Ot),getterReturnType:un,getter:di(kn,Mt),getterContext:Rt,setterArgumentType:Zt,setter:di(an,_n),setterContext:Cn})},V0=(zt,Ot)=>{Ot=Zn(Ot),vr(zt,{isVoid:!0,name:Ot,argPackAdvance:0,fromWireType:()=>{},toWireType:(un,kn)=>{}})},z0=(zt,Ot)=>{var un=Ir[zt];return un===void 0&&zn(Ot+" has unknown type "+xa(zt)),un},J0=(zt,Ot)=>{zt=z0(zt,"_emval_take_value");var un=zt.readValueFromPointer(Ot);return Ys.toHandle(un)},Ha=()=>{Tt("")},l0=(zt,Ot,un)=>Ie.copyWithin(zt,Ot,Ot+un),G0=()=>2147483648,S0=zt=>{var Ot=Se.buffer,un=(zt-Ot.byteLength+65535)/65536;try{return Se.grow(un),Qe(),1}catch{}},Tx=zt=>{var Ot=Ie.length;zt>>>=0;var un=G0();if(zt>un)return!1;for(var kn=(_n,Cn)=>_n+(Cn-_n%Cn)%Cn,Mt=1;Mt<=4;Mt*=2){var Rt=Ot*(1+.2/Mt);Rt=Math.min(Rt,zt+100663296);var Zt=Math.min(un,kn(Math.max(zt,Rt),65536)),an=S0(Zt);if(an)return!0}return!1};Hr=b.InternalError=class extends Error{constructor(zt){super(zt),this.name="InternalError"}},er(),Dr=b.BindingError=class extends Error{constructor(zt){super(zt),this.name="BindingError"}},Ss(),Vi(),Wn(),Ai=b.UnboundTypeError=Pi(Error,"UnboundTypeError"),js();var j0={c:Kr,m:Ht,p:In,u:zr,i:Jr,h:Ws,b:Js,e:ss,t:ka,k:_0,d:K0,a:Xx,j:vx,g:Z0,n:U0,f:Sx,l:V0,o:J0,q:Ha,s:l0,r:Tx},Es=tr(),ls=zt=>(ls=Es.x)(zt),T0=zt=>(T0=Es.y)(zt),ex=zt=>(ex=Es.A)(zt),Ns=zt=>(Ns=Es.B)(zt),ds;vt=function zt(){ds||H0(),ds||(vt=zt)};function H0(){if(Qt>0||(mt(),Qt>0))return;function zt(){ds||(ds=!0,b.calledRun=!0,!Ee&&(_t(),$(b),b.onRuntimeInitialized&&b.onRuntimeInitialized(),Lt()))}b.setStatus?(b.setStatus("Running..."),setTimeout(function(){setTimeout(function(){b.setStatus("")},1),zt()},1)):zt()}if(b.preInit)for(typeof b.preInit=="function"&&(b.preInit=[b.preInit]);b.preInit.length>0;)b.preInit.pop()();return H0(),_.ready}})();const jJ=qM();jJ.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,H=>{H&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var jY;(function(H){H[H.DT_INVALID=0]="DT_INVALID",H[H.DT_FLOAT=1]="DT_FLOAT",H[H.DT_DOUBLE=2]="DT_DOUBLE",H[H.DT_INT32=3]="DT_INT32",H[H.DT_UINT8=4]="DT_UINT8",H[H.DT_INT16=5]="DT_INT16",H[H.DT_INT8=6]="DT_INT8",H[H.DT_STRING=7]="DT_STRING",H[H.DT_COMPLEX64=8]="DT_COMPLEX64",H[H.DT_INT64=9]="DT_INT64",H[H.DT_BOOL=10]="DT_BOOL",H[H.DT_QINT8=11]="DT_QINT8",H[H.DT_QUINT8=12]="DT_QUINT8",H[H.DT_QINT32=13]="DT_QINT32",H[H.DT_BFLOAT16=14]="DT_BFLOAT16",H[H.DT_QINT16=15]="DT_QINT16",H[H.DT_QUINT16=16]="DT_QUINT16",H[H.DT_UINT16=17]="DT_UINT16",H[H.DT_COMPLEX128=18]="DT_COMPLEX128",H[H.DT_HALF=19]="DT_HALF",H[H.DT_RESOURCE=20]="DT_RESOURCE",H[H.DT_VARIANT=21]="DT_VARIANT",H[H.DT_UINT32=22]="DT_UINT32",H[H.DT_UINT64=23]="DT_UINT64",H[H.DT_FLOAT_REF=101]="DT_FLOAT_REF",H[H.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",H[H.DT_INT32_REF=103]="DT_INT32_REF",H[H.DT_UINT8_REF=104]="DT_UINT8_REF",H[H.DT_INT16_REF=105]="DT_INT16_REF",H[H.DT_INT8_REF=106]="DT_INT8_REF",H[H.DT_STRING_REF=107]="DT_STRING_REF",H[H.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",H[H.DT_INT64_REF=109]="DT_INT64_REF",H[H.DT_BOOL_REF=110]="DT_BOOL_REF",H[H.DT_QINT8_REF=111]="DT_QINT8_REF",H[H.DT_QUINT8_REF=112]="DT_QUINT8_REF",H[H.DT_QINT32_REF=113]="DT_QINT32_REF",H[H.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",H[H.DT_QINT16_REF=115]="DT_QINT16_REF",H[H.DT_QUINT16_REF=116]="DT_QUINT16_REF",H[H.DT_UINT16_REF=117]="DT_UINT16_REF",H[H.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",H[H.DT_HALF_REF=119]="DT_HALF_REF",H[H.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",H[H.DT_VARIANT_REF=121]="DT_VARIANT_REF",H[H.DT_UINT32_REF=122]="DT_UINT32_REF",H[H.DT_UINT64_REF=123]="DT_UINT64_REF"})(jY||(jY={}));var jP;(function(H){(function(_){_[_.LEGACY=0]="LEGACY",_[_.V1=1]="V1",_[_.V2=2]="V2"})(H.CheckpointFormatVersion||(H.CheckpointFormatVersion={}))})(jP||(jP={}));const jU={};function Lq(H){return jU[H]}function Ln(H,_,b,$,ee){const re=_.inputParams[H];if(re&&re.inputIndexStart!==void 0){const xe=re.inputIndexStart,le=re.inputIndexEnd===0?void 0:re.inputIndexEnd===void 0?xe+1:re.inputIndexEnd,fe=xe<0?_.inputNames.length+xe:xe;if(re.type==="tensor")return Ls(_.inputNames[fe],b,$,ee);if(re.type==="tensors"){const Ee=_.inputs.slice(xe,le);return _.inputNames.slice(xe,le).filter((Ce,Ie)=>{var De;return((De=Ee[Ie])===null||De===void 0?void 0:De.op)!=="NoOp"}).map(Ce=>Ls(Ce,b,$,ee))}const ve=Ls(_.inputNames[fe],b,$,ee),Se=ve.dataSync();return re.type==="number"?Se[0]:l$1(ve.shape,Se)}const ae=_.attrParams[H];return ae&&ae.value}function Ls(H,_,b,$){const[ee,re]=LD(H,b);if($!=null){const xe=$.getHashTableHandleByName(ee);if(xe!=null)return xe}const ae=b.currentContextIds.find(xe=>!!_[LW(ee,xe)]);return ae!==void 0?_[LW(ee,ae)][re]:void 0}function LM(H,_,b){return _[LW(H,b.currentContextId)]}function LF(H,_){const[b,$,ee]=LD(H,_);return[LW(b,_&&_.currentContextId),$,ee]}function LW(H,_){return _?H+"-"+_:H}function LD(H,_){if(H==="")return["",0,void 0];const b=_!=null&&_.parseNodeNameCache!=null;if(b){const re=_.parseNodeNameCache.get(H);if(re!=null)return re}const $=H.split(":");let ee;if($.length===1)ee=[H,0,void 0];else{const re=$[0],ae=$.length===3?$[1]:void 0,xe=Number($[$.length-1]);ee=[re,xe,ae]}return b&&_.parseNodeNameCache.set(H,ee),ee}function LZ(H,_,b){let $=Ln("pad",H,_,b);if($==="explicit"){$=Ln("explicitPaddings",H,_,b);const ee=[[0,0],[0,0],[0,0],[0,0]];for(let re=0;re<4;re++)ee[re][0]=$[re*2],ee[re][1]=$[re*2+1];return ee}return $}function Le(H){return H.kept?H:DX(H)}const Lz=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];var LX=Object.freeze({__proto__:null,json:Lz});const LG=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];var Lj=Object.freeze({__proto__:null,json:LG});const LL=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}];var LR=Object.freeze({__proto__:null,json:LL});const LQ=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}];var LH=Object.freeze({__proto__:null,json:LQ});const LK=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}];var LB=Object.freeze({__proto__:null,json:LK});const LV=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}];var LJ=Object.freeze({__proto__:null,json:LV});const LY=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}];var LP=Object.freeze({__proto__:null,json:LY});const LU=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}];var Iq=Object.freeze({__proto__:null,json:LU});const IM=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}];var IF=Object.freeze({__proto__:null,json:IM});const IW=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}];var ID=Object.freeze({__proto__:null,json:IW});const IZ=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}];var Iz=Object.freeze({__proto__:null,json:IZ});const IX=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}];var IG=Object.freeze({__proto__:null,json:IX});const Iu=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}];var Ij=Object.freeze({__proto__:null,json:Iu});const IL=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}];var IR=Object.freeze({__proto__:null,json:IL});const IQ=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}];var IH=Object.freeze({__proto__:null,json:IQ});const IK=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}];var IB=Object.freeze({__proto__:null,json:IK});const IV=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}];var IJ=Object.freeze({__proto__:null,json:IV});const IY=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}];var IP=Object.freeze({__proto__:null,json:IY});const IU=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];var bq=Object.freeze({__proto__:null,json:IU});let bM$1=class{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const _=[LX,Lj,LR,LH,LB,LJ,LP,Iq,IF,ID,Iz,IG,Ij,IR,IH,IB,IJ,IP,bq],b=[].concat(..._.map($=>$.json));this.opMappers=b.reduce(($,ee)=>($[ee.tfOpName]=ee,$),{})}transformGraph(_,b={}){const $=_.node,ee=[],re=[],ae=[],xe=$.reduce((De,Be)=>(De[Be.name]=this.mapNode(Be),Be.op.startsWith("Placeholder")?ee.push(De[Be.name]):Be.op==="Const"?re.push(De[Be.name]):(Be.input==null||Be.input.length===0)&&ae.push(De[Be.name]),De),{});let le=[];const fe=[];let ve={},Se={};b!=null&&(ve=this.mapSignatureEntries(b.inputs),Se=this.mapSignatureEntries(b.outputs));const Ee=Object.keys(xe);Ee.forEach(De=>{const Be=xe[De];Be.inputNames.forEach((Ne,qe)=>{const[Xe,,Ye]=LF(Ne),Qe=xe[Xe];if(Qe.outputs!=null){const rt=Qe.outputs.indexOf(Ye);if(rt!==-1){const ot=Xe+":"+rt;Be.inputNames[qe]=ot}}Be.inputs.push(Qe),Qe.children.push(Be)})}),Object.keys(Se).length===0?Ee.forEach(De=>{const Be=xe[De];Be.children.length===0&&fe.push(Be)}):Object.keys(Se).forEach(De=>{const[Be]=LF(De),Ne=xe[Be];Ne!=null&&(Ne.signatureKey=Se[De],fe.push(Ne))}),Object.keys(ve).length>0?Object.keys(ve).forEach(De=>{const[Be]=LF(De),Ne=xe[Be];Ne&&(Ne.signatureKey=ve[De],le.push(Ne))}):le=ee;let Ce={};_.library!=null&&_.library.function!=null&&(Ce=_.library.function.reduce((De,Be)=>(De[Be.signature.name]=this.mapFunction(Be),De),{}));const Ie={nodes:xe,inputs:le,outputs:fe,weights:re,placeholders:ee,signature:b,functions:Ce};return ae.length>0&&(Ie.initNodes=ae),Ie}mapSignatureEntries(_){return Object.keys(_||{}).reduce((b,$)=>(b[_[$].name]=$,b),{})}mapNode(_){const b=Lq(_.op)||this.opMappers[_.op]||{};_.attr==null&&(_.attr={});const $={name:_.name,op:_.op,category:b.category,inputNames:(_.input||[]).map(ee=>ee.startsWith("^")?ee.slice(1):ee),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:_.attr,outputs:b.outputs};return b.inputs!=null&&($.inputParams=b.inputs.reduce((ee,re)=>(ee[re.name]={type:re.type,inputIndexStart:re.start,inputIndexEnd:re.end},ee),{})),b.attrs!=null&&($.attrParams=b.attrs.reduce((ee,re)=>{const ae=re.type;let xe;switch(re.type){case"string":xe=bW(_.attr,re.tfName,re.defaultValue),xe===void 0&&re.tfDeprecatedName&&(xe=bW(_.attr,re.tfDeprecatedName,re.defaultValue));break;case"string[]":xe=bQ(_.attr,re.tfName,re.defaultValue),xe===void 0&&re.tfDeprecatedName&&(xe=bQ(_.attr,re.tfDeprecatedName,re.defaultValue));break;case"number":xe=bZ(_.attr,re.tfName,re.defaultValue||0),xe===void 0&&re.tfDeprecatedName&&(xe=bZ(_.attr,re.tfDeprecatedName,re.defaultValue));break;case"number[]":xe=bL$1(_.attr,re.tfName,re.defaultValue),xe===void 0&&re.tfDeprecatedName&&(xe=bL$1(_.attr,re.tfDeprecatedName,re.defaultValue));break;case"bool":xe=bD$1(_.attr,re.tfName,re.defaultValue),xe===void 0&&re.tfDeprecatedName&&(xe=bD$1(_.attr,re.tfDeprecatedName,re.defaultValue));break;case"bool[]":xe=bK(_.attr,re.tfName,re.defaultValue),xe===void 0&&re.tfDeprecatedName&&(xe=bK(_.attr,re.tfDeprecatedName,re.defaultValue));break;case"shape":xe=bj(_.attr,re.tfName,re.defaultValue),xe===void 0&&re.tfDeprecatedName&&(xe=bj(_.attr,re.tfDeprecatedName,re.defaultValue));break;case"shape[]":xe=bH(_.attr,re.tfName,re.defaultValue),xe===void 0&&re.tfDeprecatedName&&(xe=bH(_.attr,re.tfDeprecatedName,re.defaultValue));break;case"dtype":xe=bX(_.attr,re.tfName,re.defaultValue),xe===void 0&&re.tfDeprecatedName&&(xe=bX(_.attr,re.tfDeprecatedName,re.defaultValue));break;case"dtype[]":xe=bG$1(_.attr,re.tfName,re.defaultValue),xe===void 0&&re.tfDeprecatedName&&(xe=bG$1(_.attr,re.tfDeprecatedName,re.defaultValue));break;case"func":xe=bz(_.attr,re.tfName,re.defaultValue),xe===void 0&&re.tfDeprecatedName&&(xe=bz(_.attr,re.tfDeprecatedName,re.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+re.type+" for op: "+_.op)}return ee[re.name]={value:xe,type:ae},ee},{})),$}mapFunction(_){const b=_.nodeDef,$=[],ee=[];let re={};b!=null&&(re=b.reduce((ve,Se)=>(ve[Se.name]=this.mapNode(Se),Se.op==="Const"&&ee.push(ve[Se.name]),ve),{}));const ae=[],xe=[];_.signature.inputArg.forEach(ve=>{const[Se]=LF(ve.name),Ee={name:Se,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:be(ve.type),type:"dtype"}},children:[]};Ee.signatureKey=ve.name,ae.push(Ee),re[Se]=Ee}),Object.keys(re).forEach(ve=>{const Se=re[ve];Se.inputNames.forEach((Ee,Ce)=>{const[Ie,,De]=LF(Ee),Be=re[Ie];if(Be.outputs!=null){const Ne=Be.outputs.indexOf(De);if(Ne!==-1){const qe=Ie+":"+Ne;Se.inputNames[Ce]=qe}}Se.inputs.push(Be),Be.children.push(Se)})});const le=_.ret;_.signature.outputArg.forEach(ve=>{const[Se,Ee]=LF(le[ve.name]),Ce=re[Se];Ce!=null&&(Ce.defaultOutput=Ee,xe.push(Ce))});const fe=this.mapArgsToSignature(_);return{nodes:re,inputs:ae,outputs:xe,weights:ee,placeholders:$,signature:fe}}mapArgsToSignature(_){return{methodName:_.signature.name,inputs:_.signature.inputArg.reduce((b,$)=>(b[$.name]=this.mapArgToTensorInfo($),b),{}),outputs:_.signature.outputArg.reduce((b,$)=>(b[$.name]=this.mapArgToTensorInfo($,_.ret),b),{})}}mapArgToTensorInfo(_,b){let $=_.name;return b!=null&&($=b[$]),{name:$,dtype:_.type}}};function bF$1(H){const _=qM().global;if(typeof _.atob<"u")return _.atob(H);if(typeof Buffer<"u")return new Buffer(H,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function bt(H,_){const b=Array.isArray(H)?String.fromCharCode.apply(null,H):bF$1(H);return _?b:b.toLowerCase()}function bW(H,_,b,$=!1){const ee=H[_];return ee!=null?bt(ee.s,$):b}function bD$1(H,_,b){const $=H[_];return $?$.b:b}function bZ(H,_,b){const $=H[_]||{},ee=$.i!=null?$.i:$.f!=null?$.f:b;return typeof ee=="number"?ee:parseInt(ee,10)}function be(H){switch(typeof H=="string"&&(H=jY[H]),H){case jY.DT_FLOAT:case jY.DT_HALF:return"float32";case jY.DT_INT32:case jY.DT_INT64:case jY.DT_INT8:case jY.DT_UINT8:return"int32";case jY.DT_BOOL:return"bool";case jY.DT_DOUBLE:return"float32";case jY.DT_STRING:return"string";case jY.DT_COMPLEX64:case jY.DT_COMPLEX128:return"complex64";default:return null}}function bz(H,_,b){const $=H[_];return $&&$.func?$.func.name:b}function bX(H,_,b){const $=H[_];return $&&$.type?be($.type):b}function bG$1(H,_,b){const $=H[_];return $&&$.list&&$.list.type?$.list.type.map(ee=>be(ee)):b}function bu$1(H){if(!H.unknownRank)return H.dim!=null?H.dim.map(_=>typeof _.size=="number"?_.size:parseInt(_.size,10)):[]}function bj(H,_,b){const $=H[_];return $&&$.shape?bu$1($.shape):b}function bL$1(H,_,b){const $=H[_];return $?(($.list.f&&$.list.f.length?$.list.f:$.list.i)||[]).map(ee=>typeof ee=="number"?ee:parseInt(ee,10)):b}function bQ(H,_,b,$=!1){const ee=H[_];return ee&&ee.list&&ee.list.s?ee.list.s.map(re=>bt(re,$)):b}function bH(H,_,b){const $=H[_];return $&&$.list&&$.list.shape?$.list.shape.map(ee=>bu$1(ee)):b}function bK(H,_,b){const $=H[_];return $&&$.list&&$.list.b?$.list.b:b}let bB$1=class{constructor(_,b,$){this.node=_,this.tensorMap=b,this.context=$,this.inputs=[],this.attrs={},this.inputs=_.inputNames.map(ee=>this.getInput(ee)),_.rawAttrs!=null&&(this.attrs=Object.keys(_.rawAttrs).reduce((ee,re)=>(ee[re]=this.getAttr(re),ee),{}))}getInput(_){return Ls(_,this.tensorMap,this.context)}getAttr(_,b){const $=this.node.rawAttrs[_];if($.tensor!=null)return Ls(_,this.tensorMap,this.context);if($.i!=null||$.f!=null)return bZ(this.node.rawAttrs,_,b);if($.s!=null)return bW(this.node.rawAttrs,_,b);if($.b!=null)return bD$1(this.node.rawAttrs,_,b);if($.shape!=null)return bj(this.node.rawAttrs,_,b);if($.type!=null)return bX(this.node.rawAttrs,_,b);if($.list!=null){if($.list.i!=null||$.list.f!=null)return bL$1(this.node.rawAttrs,_,b);if($.list.s!=null)return bQ(this.node.rawAttrs,_,b);if($.list.shape!=null)return bH(this.node.rawAttrs,_,b);if($.list.b!=null)return bK(this.node.rawAttrs,_,b);if($.list.type!=null)return bG$1(this.node.rawAttrs,_,b)}return b}};const bV={conv2d:zP,depthwiseConv2d:cD,matMul:cZ},bJ$1={resizeBilinear:XQ};var bY=Object.freeze({__proto__:null,add:WY,addN:iZ,atan2:iz,avgPool:DZ,cast:OM,concat:Dj,conv2d:mF,conv2dTranspose:mZ,cos:mz,depthToSpace:mG,depthwiseConv2d:mj,expandDims:ZM,fill:DP,floor:Za,fused:bV,gather:Ze,greaterEqual:Zj,image:bJ$1,lessEqual:Zr,logicalAnd:ZV,matMul:OW,max:az,maxPool:ZY,maximum:ZU,mean:wM,min:aG,minimum:wZ,mul:it,neg:Oz,pad:wz,prelu:wG,range:eX,relu:ej,relu6:eo,reshape:DW,scalar:aL,sigmoid:DR,sin:eB,squeeze:zq,stack:zF,stridedSlice:ze,sub:ZK,tensor1d:zz,tile:ZW,transpose:Ou,zerosLike:mK});const bP=(H,_,b,$=bY)=>{switch(H.op){case"BiasAdd":case"AddV2":case"Add":return[$.add(Ln("a",H,_,b),Ln("b",H,_,b))];case"AddN":return[$.addN(Ln("tensors",H,_,b))];case"FloorMod":case"Mod":return[$.mod(Ln("a",H,_,b),Ln("b",H,_,b))];case"Mul":return[$.mul(Ln("a",H,_,b),Ln("b",H,_,b))];case"RealDiv":case"Div":return[$.div(Ln("a",H,_,b),Ln("b",H,_,b))];case"DivNoNan":return[$.divNoNan(Ln("a",H,_,b),Ln("b",H,_,b))];case"FloorDiv":return[$.floorDiv(Ln("a",H,_,b),Ln("b",H,_,b))];case"Sub":return[$.sub(Ln("a",H,_,b),Ln("b",H,_,b))];case"Minimum":return[$.minimum(Ln("a",H,_,b),Ln("b",H,_,b))];case"Maximum":return[$.maximum(Ln("a",H,_,b),Ln("b",H,_,b))];case"Pow":return[$.pow(Ln("a",H,_,b),Ln("b",H,_,b))];case"SquaredDifference":return[$.squaredDifference(Ln("a",H,_,b),Ln("b",H,_,b))];default:throw TypeError("Node type "+H.op+" is not implemented")}},bU=(H,_,b,$=bY)=>{switch(H.op){case"Abs":case"ComplexAbs":return[$.abs(Ln("x",H,_,b))];case"Acos":return[$.acos(Ln("x",H,_,b))];case"Acosh":return[$.acosh(Ln("x",H,_,b))];case"Asin":return[$.asin(Ln("x",H,_,b))];case"Asinh":return[$.asinh(Ln("x",H,_,b))];case"Atan":return[$.atan(Ln("x",H,_,b))];case"Atan2":return[$.atan2(Ln("x",H,_,b),Ln("y",H,_,b))];case"Atanh":return[$.atanh(Ln("x",H,_,b))];case"Ceil":return[$.ceil(Ln("x",H,_,b))];case"Complex":return[$.complex(Ln("real",H,_,b),Ln("imag",H,_,b))];case"Cos":return[$.cos(Ln("x",H,_,b))];case"Cosh":return[$.cosh(Ln("x",H,_,b))];case"Elu":return[$.elu(Ln("x",H,_,b))];case"Erf":return[$.erf(Ln("x",H,_,b))];case"Exp":return[$.exp(Ln("x",H,_,b))];case"Expm1":return[$.expm1(Ln("x",H,_,b))];case"Floor":return[$.floor(Ln("x",H,_,b))];case"Log":return[$.log(Ln("x",H,_,b))];case"Log1p":return[$.log1p(Ln("x",H,_,b))];case"Imag":return[$.imag(Ln("x",H,_,b))];case"Neg":return[$.neg(Ln("x",H,_,b))];case"Reciprocal":return[$.reciprocal(Ln("x",H,_,b))];case"Real":return[$.real(Ln("x",H,_,b))];case"Relu":return[$.relu(Ln("x",H,_,b))];case"Round":return[$.round(Ln("x",H,_,b))];case"Selu":return[$.selu(Ln("x",H,_,b))];case"Sigmoid":return[$.sigmoid(Ln("x",H,_,b))];case"Sin":return[$.sin(Ln("x",H,_,b))];case"Sign":return[$.sign(Ln("x",H,_,b))];case"Sinh":return[$.sinh(Ln("x",H,_,b))];case"Softplus":return[$.softplus(Ln("x",H,_,b))];case"Sqrt":return[$.sqrt(Ln("x",H,_,b))];case"Square":return[$.square(Ln("x",H,_,b))];case"Tanh":return[$.tanh(Ln("x",H,_,b))];case"Tan":return[$.tan(Ln("x",H,_,b))];case"ClipByValue":return[$.clipByValue(Ln("x",H,_,b),Ln("clipValueMin",H,_,b),Ln("clipValueMax",H,_,b))];case"Relu6":return[$.relu6(Ln("x",H,_,b))];case"Rsqrt":return[$.rsqrt(Ls(H.inputNames[0],_,b))];case"LeakyRelu":return[$.leakyRelu(Ln("x",H,_,b),Ln("alpha",H,_,b))];case"Prelu":return[$.prelu(Ln("x",H,_,b),Ln("alpha",H,_,b))];case"IsNan":return[$.isNaN(Ls(H.inputNames[0],_,b))];case"IsInf":return[$.isInf(Ls(H.inputNames[0],_,b))];case"IsFinite":return[$.isFinite(Ls(H.inputNames[0],_,b))];default:throw TypeError("Node type "+H.op+" is not implemented")}};function Rq(H,_,b=""){if(!(typeof H=="number"||typeof _=="number")){k(H.length===_.length,()=>b+(" Shapes "+H+" and "+_+" must match"));for(let $=0;$<H.length;$++){const ee=H[$],re=_[$];k(ee<0||re<0||ee===re,()=>b+(" Shapes "+H+" and "+_+" must match"))}}}function Rs(H){return!(typeof H=="number"||H.some(_=>_<0))}function RM(H,_,b){let $=RF(H,b);const ee=!Rs($);if(ee&&_.length===0)throw new Error("Tried to calculate elements of an empty list with non-fully-defined elementShape: "+$);if(ee&&_.forEach(re=>{$=RF(re.shape,$)}),!Rs($))throw new Error("Non-fully-defined elementShape: "+$);return $}function RF(H,_){if(typeof H=="number")return _;if(typeof _=="number")return H;if(H.length!==_.length)throw new Error("Incompatible ranks during merge: "+H+" vs. "+_);const b=[];for(let $=0;$<H.length;++$){const ee=H[$],re=_[$];if(ee>=0&&re>=0&&ee!==re)throw new Error("Incompatible shape during merge: "+H+" vs. "+_);b[$]=ee>=0?ee:re}return b}class RW{constructor(_,b,$,ee,re,ae,xe){this.name=_,this.dtype=b,this.maxSize=$,this.elementShape=ee,this.identicalElementShapes=re,this.dynamicSize=ae,this.clearAfterRead=xe,this.tensors=[],this.closed_=!1,this.idTensor=aL(0),SM(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(_){this.tensors.forEach(b=>{(_==null||!_.has(b.tensor.id))&&b.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(_){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(_<0||_>=this.size())throw new Error("Tried to read from index "+_+", but array size is: "+this.size());const b=this.tensors[_];if(b.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+_+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(b.cleared=!0),b.read=!0,b.tensor}readMany(_){return _.map(b=>this.read(b))}write(_,b){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(_<0||!this.dynamicSize&&_>=this.maxSize)throw new Error("Tried to write to index "+_+", but array is not resizeable and size is: "+this.maxSize);const $=this.tensors[_]||{};if(b.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+_+`,
          because the value dtype is `+b.dtype+", but TensorArray dtype is "+this.dtype+".");if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=b.shape),Rq(this.elementShape,b.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+_+"."),$.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+_+", because it has already been read.");if($.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+_+", because it has already been written.");$.tensor=b,SM(b),$.written=!0,this.tensors[_]=$}writeMany(_,b){if(_.length!==b.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+_.length+" is not the same as tensors size: "+b.length+".");_.forEach(($,ee)=>this.write($,b[ee]))}gather(_,b){if(b&&b!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+b);if(_)_=_.slice(0,this.size());else{_=[];for(let ee=0;ee<this.size();ee++)_.push(ee)}if(_.length===0)return fB([],[0].concat(this.elementShape));const $=this.readMany(_);return Rq(this.elementShape,$[0].shape,"TensorArray shape mismatch: "),zF($,0)}concat(_){if(_&&_!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+_);if(this.size()===0)return fB([],[0].concat(this.elementShape));const b=[];for(let ee=0;ee<this.size();ee++)b.push(ee);const $=this.readMany(b);return Rq(this.elementShape,$[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+$[0].shape+")"),Dj($,0)}scatter(_,b){if(b.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+b.dtype);if(_.length!==b.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+_.length+" vs. "+b.shape[0]);const $=Math.max(..._);if(!this.dynamicSize&&$>=this.maxSize)throw new Error("Max index must be < array size ("+$+"  vs. "+this.maxSize+")");this.writeMany(_,zL(b,0))}split(_,b){if(b.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+b.dtype);let $=0;const ee=_.map(le=>($+=le,$));if($!==b.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+$+", and tensor's shape is: "+b.shape);if(!this.dynamicSize&&_.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+_.length+"), and the TensorArray is not marked as dynamically resizeable");const re=$===0?0:b.size/$,ae=[];Sq(()=>{b=DW(b,[1,$,re]);for(let le=0;le<_.length;++le){const fe=[0,le===0?0:ee[le-1],0],ve=[1,_[le],re];ae[le]=DW(DH(b,fe,ve),this.elementShape)}return ae});const xe=[];for(let le=0;le<_.length;le++)xe[le]=le;this.writeMany(xe,ae)}}class RD{get id(){return this.idTensor.id}constructor(_,b,$,ee=-1){this.tensors=_,this.elementShape=b,this.elementDtype=$,_!=null&&_.forEach(re=>{if($!==re.dtype)throw new Error("Invalid data types; op elements "+$+", but list elements "+re.dtype);Rq(b,re.shape,"TensorList shape mismatch: "),SM(re)}),this.idTensor=aL(0),this.maxNumElements=ee,SM(this.idTensor)}copy(){return new RD([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(_){this.tensors.forEach(b=>{(_==null||!_.has(b.id))&&b.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(_,b,$=-1){if(b!==this.elementDtype)throw new Error("Invalid data types; op elements "+b+", but list elements "+this.elementDtype);if($!==-1&&this.tensors.length!==$)throw new Error("Operation expected a list with "+$+" elements but got a list with "+this.tensors.length+" elements.");Rq(_,this.elementShape,"TensorList shape mismatch: ");const ee=RM(this.elementShape,this.tensors,_);return Sq(()=>{const re=this.tensors.map(ae=>DW(ae,ee));return zF(re,0)})}popBack(_,b){if(b!==this.elementDtype)throw new Error("Invalid data types; op elements "+b+", but list elements "+this.elementDtype);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const $=RM(this.elementShape,this.tensors,_),ee=this.tensors.pop();return ee.kept=!1,Rq(ee.shape,_,"TensorList shape mismatch: "),DW(ee,$)}pushBack(_){if(_.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements "+_.dtype+", but list elements "+this.elementDtype);if(Rq(_.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");SM(_),this.tensors.push(_)}resize(_){if(_<0)throw new Error("TensorListResize expects size to be non-negative. Got: "+_);if(this.maxNumElements!==-1&&_>this.maxNumElements)throw new Error("TensorListResize input size "+_+" is greater maxNumElement "+this.maxNumElements+".");const b=new RD([],this.elementShape,this.elementDtype,this.maxNumElements);b.tensors.length=_;for(let $=0;$<Math.min(this.tensors.length,_);++$)b.tensors[$]=this.tensors[$];return b}getItem(_,b,$){if($!==this.elementDtype)throw new Error("Invalid data types; op elements "+$+", but list elements "+this.elementDtype);if(_<0||_>this.tensors.length)throw new Error("Trying to access element "+_+" in a list with "+this.tensors.length+" elements.");if(this.tensors[_]==null)throw new Error("element at index "+_+" is null.");Rq(this.tensors[_].shape,b,"TensorList shape mismatch: ");const ee=RM(this.elementShape,this.tensors,b);return DW(this.tensors[_],ee)}setItem(_,b){if(b.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements "+b.dtype+", but list elements "+this.elementDtype);if(_<0||this.maxNumElements!==-1&&_>=this.maxNumElements)throw new Error("Trying to set element "+_+" in a list with max "+this.maxNumElements+" elements.");Rq(this.elementShape,b.shape,"TensorList shape mismatch: "),SM(b),this.tensors[_]!=null&&(this.tensors[_].kept=!1),this.tensors[_]=b}gather(_,b,$){if(b!==this.elementDtype)throw new Error("Invalid data types; op elements "+b+", but list elements "+this.elementDtype);Rq(this.elementShape,$,"TensorList shape mismatch: "),_=_.slice(0,this.size());const ee=RM(this.elementShape,this.tensors,$);return _.length===0?fB([],[0].concat(ee)):Sq(()=>{const re=_.map(ae=>DW(this.tensors[ae],ee));return zF(re,0)})}concat(_,b){if(_&&_!==this.elementDtype)throw new Error("TensorList dtype is "+this.elementDtype+" but concat requested dtype "+_);Rq(this.elementShape,b,"TensorList shape mismatch: ");const $=RM(this.elementShape,this.tensors,b);return this.size()===0?fB([],[0].concat($)):Sq(()=>{const ee=this.tensors.map(re=>DW(re,$));return Dj(ee,0)})}}function RZ(H,_,b){const $=H.dtype;if(H.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: "+H.shape);if(H.dtype!==b)throw new Error("Invalid data types; op elements "+H.dtype+", but list elements "+b);const ee=H.shape.slice(1);Rq(ee,_,"TensorList shape mismatch: ");const re=zL(H);return new RD(re,_,$)}function Re(H,_,b,$){return new RD([],H,_,$)}function Rz(H,_,b,$){if(_.length!==H.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+_.length+" vs. "+H.shape[0]);const ee=Math.max(..._);if($!=null&&$!==-1&&ee>=$)throw new Error("Max index must be < array size ("+ee+"  vs. "+$+")");const re=new RD([],b,H.dtype,$),ae=zL(H,0);return _.forEach((xe,le)=>{re.setItem(xe,ae[le])}),re}function RX(H,_,b){let $=0;const ee=_.map(ve=>($+=ve,$));if($!==H.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+$+", and tensor's shape is: "+H.shape);const re=H.shape.slice(1),ae=RF(re,b),xe=$===0?0:H.size/$,le=Sq(()=>{const ve=[];H=DW(H,[1,$,xe]);for(let Se=0;Se<_.length;++Se){const Ee=[0,Se===0?0:ee[Se-1],0],Ce=[1,_[Se],xe];ve[Se]=DW(DH(H,Ee,Ce),ae)}return H.dispose(),ve}),fe=new RD([],b,H.dtype,_.length);for(let ve=0;ve<le.length;ve++)fe.setItem(ve,le[ve]);return fe}const RG=async(H,_,b)=>{switch(H.op){case"If":case"StatelessIf":{const $=Ln("thenBranch",H,_,b),ee=Ln("elseBranch",H,_,b),re=Ln("cond",H,_,b),ae=Ln("args",H,_,b);return(await re.data())[0]?b.functionMap[$].executeFunctionAsync(ae,b.tensorArrayMap,b.tensorListMap):b.functionMap[ee].executeFunctionAsync(ae,b.tensorArrayMap,b.tensorListMap)}case"While":case"StatelessWhile":{const $=Ln("body",H,_,b),ee=Ln("cond",H,_,b),re=Ln("args",H,_,b),ae=await b.functionMap[ee].executeFunctionAsync(re,b.tensorArrayMap,b.tensorListMap),xe=re.map(ve=>ve.id);let le=await ae[0].data();ae.forEach(ve=>{!ve.kept&&xe.indexOf(ve.id)===-1&&ve.dispose()});let fe=re;for(;le[0];){const ve=fe;fe=await b.functionMap[$].executeFunctionAsync(fe,b.tensorArrayMap,b.tensorListMap);const Se=fe.map(Ce=>Ce.id);ve.forEach(Ce=>{!Ce.kept&&xe.indexOf(Ce.id)===-1&&Se.indexOf(Ce.id)===-1&&Ce.dispose()});const Ee=await b.functionMap[ee].executeFunctionAsync(fe,b.tensorArrayMap,b.tensorListMap);le=await Ee[0].data(),Ee.forEach(Ce=>{!Ce.kept&&xe.indexOf(Ce.id)===-1&&Se.indexOf(Ce.id)===-1&&Ce.dispose()})}return fe}case"LoopCond":{const $=Ln("pred",H,_,b);return[Le($)]}case"Switch":{const $=Ln("pred",H,_,b);let ee=Ln("data",H,_,b);return ee.kept||(ee=Le(ee)),(await $.data())[0]?[void 0,ee]:[ee,void 0]}case"Merge":{const $=H.inputNames.find(ee=>Ls(ee,_,b)!==void 0);if($){const ee=Ls($,_,b);return[Le(ee)]}return}case"Enter":{const $=Ln("frameName",H,_,b),ee=Ln("tensor",H,_,b);return b.enterFrame($),[Le(ee)]}case"Exit":{const $=Ln("tensor",H,_,b);return b.exitFrame(),[Le($)]}case"NextIteration":{const $=Ln("tensor",H,_,b);return b.nextIteration(),[Le($)]}case"TensorArrayV3":{const $=Ln("size",H,_,b),ee=Ln("dtype",H,_,b),re=Ln("elementShape",H,_,b),ae=Ln("dynamicSize",H,_,b),xe=Ln("clearAfterRead",H,_,b),le=Ln("identicalElementShapes",H,_,b),fe=Ln("name",H,_,b),ve=new RW(fe,ee,$,re,le,ae,xe);return b.addTensorArray(ve),[ve.idTensor,aL(1)]}case"TensorArrayWriteV3":{const $=Ln("tensorArrayId",H,_,b),ee=Ln("index",H,_,b),re=Ln("tensor",H,_,b),ae=b.getTensorArray($.id);return ae.write(ee,re),[ae.idTensor]}case"TensorArrayReadV3":{const $=Ln("tensorArrayId",H,_,b),ee=Ln("index",H,_,b);return[b.getTensorArray($.id).read(ee)]}case"TensorArrayGatherV3":{const $=Ln("tensorArrayId",H,_,b),ee=Ln("indices",H,_,b),re=Ln("dtype",H,_,b);return[b.getTensorArray($.id).gather(ee,re)]}case"TensorArrayScatterV3":{const $=Ln("tensorArrayId",H,_,b),ee=Ln("indices",H,_,b),re=Ln("tensor",H,_,b),ae=b.getTensorArray($.id);return ae.scatter(ee,re),[ae.idTensor]}case"TensorArrayConcatV3":{const $=Ln("tensorArrayId",H,_,b),ee=b.getTensorArray($.id),re=Ln("dtype",H,_,b);return[ee.concat(re)]}case"TensorArraySplitV3":{const $=Ln("tensorArrayId",H,_,b),ee=Ln("tensor",H,_,b),re=Ln("lengths",H,_,b),ae=b.getTensorArray($.id);return ae.split(re,ee),[ae.idTensor]}case"TensorArraySizeV3":{const $=Ln("tensorArrayId",H,_,b),ee=b.getTensorArray($.id);return[aL(ee.size(),"int32")]}case"TensorArrayCloseV3":{const $=Ln("tensorArrayId",H,_,b),ee=b.getTensorArray($.id);return ee.clearAndClose(),[ee.idTensor]}case"TensorListSetItem":{const $=Ln("tensorListId",H,_,b),ee=Ln("index",H,_,b),re=Ln("tensor",H,_,b),ae=b.getTensorList($.id);return ae.setItem(ee,re),[ae.idTensor]}case"TensorListGetItem":{const $=Ln("tensorListId",H,_,b),ee=Ln("index",H,_,b),re=Ln("elementShape",H,_,b),ae=Ln("elementDType",H,_,b);return[b.getTensorList($.id).getItem(ee,re,ae)]}case"TensorListScatterV2":case"TensorListScatter":{const $=Ln("indices",H,_,b),ee=Ln("tensor",H,_,b),re=Ln("elementShape",H,_,b),ae=Ln("numElements",H,_,b),xe=Rz(ee,$,re,ae);return b.addTensorList(xe),[xe.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const $=Ln("elementShape",H,_,b),ee=Ln("elementDType",H,_,b);let re;H.op==="TensorListReserve"?re="numElements":re="maxNumElements";const ae=Ln(re,H,_,b),xe=H.op==="TensorListReserve"?-1:ae,le=Re($,ee,ae,xe);return b.addTensorList(le),[le.idTensor]}case"TensorListGather":{const $=Ln("tensorListId",H,_,b),ee=Ln("indices",H,_,b),re=Ln("elementShape",H,_,b),ae=Ln("elementDType",H,_,b);return[b.getTensorList($.id).gather(ee,ae,re)]}case"TensorListStack":{const $=Ln("tensorListId",H,_,b),ee=Ln("elementShape",H,_,b),re=Ln("elementDType",H,_,b),ae=Ln("numElements",H,_,b);return[b.getTensorList($.id).stack(ee,re,ae)]}case"TensorListFromTensor":{const $=Ln("tensor",H,_,b),ee=Ln("elementShape",H,_,b),re=Ln("elementDType",H,_,b),ae=RZ($,ee,re);return b.addTensorList(ae),[ae.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const $=Ln("tensorListId",H,_,b),ee=b.getTensorList($.id),re=Ln("dtype",H,_,b),ae=Ln("elementShape",H,_,b);return[ee.concat(re,ae)]}case"TensorListPushBack":{const $=Ln("tensorListId",H,_,b),ee=Ln("tensor",H,_,b),re=b.getTensorList($.id);return re.pushBack(ee),[re.idTensor]}case"TensorListPopBack":{const $=Ln("tensorListId",H,_,b),ee=Ln("elementShape",H,_,b),re=Ln("elementDType",H,_,b);return[b.getTensorList($.id).popBack(ee,re)]}case"TensorListSplit":{const $=Ln("tensor",H,_,b),ee=Ln("elementShape",H,_,b),re=Ln("lengths",H,_,b),ae=RX($,re,ee);return b.addTensorList(ae),[ae.idTensor]}case"TensorListLength":{const $=Ln("tensorListId",H,_,b),ee=b.getTensorList($.id);return[aL(ee.size(),"int32")]}case"TensorListResize":{const $=Ln("tensorListId",H,_,b),ee=Ln("size",H,_,b),re=b.getTensorList($.id).resize(ee);return b.addTensorList(re),[re.idTensor]}default:throw TypeError("Node type "+H.op+" is not implemented")}};function Ru(H,_,b){const[$,ee]=Ln("fusedOps",H,_,b),re=$==="biasadd",ae=!re,xe=ee==="prelu",le=$==="fusedbatchnorm",fe=Ln("numArgs",H,_,b);if(re){if(xe&&fe!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!xe&&re&&fe!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(le)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const ve=Ln("strides",H,_,b),Se=LZ(H,_,b),Ee=Ln("dataFormat",H,_,b).toUpperCase(),Ce=Ln("dilations",H,_,b);let[Ie,De]=Ln("args",H,_,b);ae&&(De=Ie,Ie=void 0);const Be=Ln("leakyreluAlpha",H,_,b);return{stride:ve,pad:Se,dataFormat:Ee,dilations:Ce,biasArg:Ie,preluArg:De,activationFunc:ee,leakyreluAlpha:Be}}const Rj=(H,_,b,$=bY)=>{switch(H.op){case"Conv1D":{const ee=Ln("stride",H,_,b),re=Ln("pad",H,_,b),ae=Ln("dataFormat",H,_,b).toUpperCase(),xe=Ln("dilation",H,_,b);return[$.conv1d(Ln("x",H,_,b),Ln("filter",H,_,b),ee,re,ae,xe)]}case"Conv2D":{const ee=Ln("strides",H,_,b),re=LZ(H,_,b),ae=Ln("dataFormat",H,_,b).toUpperCase(),xe=Ln("dilations",H,_,b);return[$.conv2d(Ln("x",H,_,b),Ln("filter",H,_,b),[ee[1],ee[2]],re,ae,[xe[1],xe[2]])]}case"_FusedConv2D":{const{stride:ee,pad:re,dataFormat:ae,dilations:xe,biasArg:le,preluArg:fe,activationFunc:ve,leakyreluAlpha:Se}=Ru(H,_,b),Ee=H.name.endsWith("batch_normalization_88/FusedBatchNormV3")||H.name.endsWith("batch_normalization_90/FusedBatchNormV3")?qM().get("WEBGL_USE_SHAPES_UNIFORMS"):void 0;Ee&&qM().set("WEBGL_USE_SHAPES_UNIFORMS",!1);const Ce=[$.fused.conv2d({x:Ln("x",H,_,b),filter:Ln("filter",H,_,b),strides:[ee[1],ee[2]],pad:re,dataFormat:ae,dilations:[xe[1],xe[2]],bias:le,activation:ve,preluActivationWeights:fe,leakyreluAlpha:Se})];return Ee&&qM().set("WEBGL_USE_SHAPES_UNIFORMS",!0),Ce}case"FusedDepthwiseConv2dNative":{const{stride:ee,pad:re,dataFormat:ae,dilations:xe,biasArg:le,preluArg:fe,activationFunc:ve,leakyreluAlpha:Se}=Ru(H,_,b);return[$.fused.depthwiseConv2d({x:Ln("x",H,_,b),filter:Ln("filter",H,_,b),strides:[ee[1],ee[2]],pad:re,dataFormat:ae,dilations:[xe[1],xe[2]],bias:le,activation:ve,preluActivationWeights:fe,leakyreluAlpha:Se})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const ee=Ln("outputShape",H,_,b),re=Ln("strides",H,_,b),ae=LZ(H,_,b);return[$.conv2dTranspose(Ln("x",H,_,b),Ln("filter",H,_,b),ee,[re[1],re[2]],ae)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const ee=Ln("strides",H,_,b),re=LZ(H,_,b),ae=Ln("dilations",H,_,b),xe=Ln("dataFormat",H,_,b).toUpperCase();return[$.depthwiseConv2d(Ln("input",H,_,b),Ln("filter",H,_,b),[ee[1],ee[2]],re,xe,[ae[1],ae[2]])]}case"Conv3D":{const ee=Ln("strides",H,_,b),re=Ln("pad",H,_,b),ae=Ln("dataFormat",H,_,b).toUpperCase(),xe=Ln("dilations",H,_,b);return[$.conv3d(Ln("x",H,_,b),Ln("filter",H,_,b),[ee[1],ee[2],ee[3]],re,ae,[xe[1],xe[2],xe[3]])]}case"AvgPool":{const ee=Ln("strides",H,_,b),re=Ln("pad",H,_,b),ae=Ln("kernelSize",H,_,b);return[$.avgPool(Ln("x",H,_,b),[ae[1],ae[2]],[ee[1],ee[2]],re)]}case"MaxPool":{const ee=Ln("strides",H,_,b),re=Ln("pad",H,_,b),ae=Ln("kernelSize",H,_,b);return[$.maxPool(Ln("x",H,_,b),[ae[1],ae[2]],[ee[1],ee[2]],re)]}case"MaxPoolWithArgmax":{const ee=Ln("strides",H,_,b),re=Ln("pad",H,_,b),ae=Ln("kernelSize",H,_,b),xe=Ln("includeBatchInIndex",H,_,b),{result:le,indexes:fe}=$.maxPoolWithArgmax(Ln("x",H,_,b),[ae[1],ae[2]],[ee[1],ee[2]],re,xe);return[le,fe]}case"AvgPool3D":{const ee=Ln("strides",H,_,b),re=Ln("pad",H,_,b),ae=Ln("kernelSize",H,_,b);return[$.avgPool3d(Ln("x",H,_,b),[ae[1],ae[2],ae[3]],[ee[1],ee[2],ee[3]],re)]}case"MaxPool3D":{const ee=Ln("strides",H,_,b),re=Ln("pad",H,_,b),ae=Ln("kernelSize",H,_,b);return[$.maxPool3d(Ln("x",H,_,b),[ae[1],ae[2],ae[3]],[ee[1],ee[2],ee[3]],re)]}case"Dilation2D":{const ee=Ln("strides",H,_,b),re=Ln("pad",H,_,b),ae=Ln("dilations",H,_,b),xe=ee[1],le=ee[2],fe=ae[1],ve=ae[2];return[$.dilation2d(Ln("x",H,_,b),Ln("filter",H,_,b),[xe,le],re,[fe,ve],"NHWC")]}default:throw TypeError("Node type "+H.op+" is not implemented")}},RL=(H,_,b,$=bY)=>{switch(H.op){case"Fill":{const ee=Ln("shape",H,_,b),re=Ln("dtype",H,_,b),ae=Ln("value",H,_,b);return[$.fill(ee,ae,re)]}case"LinSpace":{const ee=Ln("start",H,_,b),re=Ln("stop",H,_,b),ae=Ln("num",H,_,b);return[$.linspace(ee,re,ae)]}case"Multinomial":{const ee=Ln("logits",H,_,b),re=Ln("numSamples",H,_,b),ae=Ln("seed",H,_,b);return[$.multinomial(ee,re,ae)]}case"OneHot":{const ee=Ln("indices",H,_,b),re=Ln("depth",H,_,b),ae=Ln("onValue",H,_,b),xe=Ln("offValue",H,_,b),le=Ln("dtype",H,_,b);return[$.oneHot(ee,re,ae,xe,le)]}case"Ones":return[$.ones(Ln("shape",H,_,b),Ln("dtype",H,_,b))];case"OnesLike":return[$.onesLike(Ln("x",H,_,b))];case"RandomStandardNormal":return[$.randomStandardNormal(Ln("shape",H,_,b),Ln("dtype",H,_,b),Ln("seed",H,_,b))];case"RandomUniform":return[$.randomUniform(Ln("shape",H,_,b),Ln("minval",H,_,b),Ln("maxval",H,_,b),Ln("dtype",H,_,b))];case"RandomUniformInt":return[$.randomUniformInt(Ln("shape",H,_,b),Ln("minval",H,_,b),Ln("maxval",H,_,b),Ln("seed",H,_,b))];case"Range":{const ee=Ln("start",H,_,b),re=Ln("stop",H,_,b),ae=Ln("step",H,_,b);return[$.range(ee,re,ae,Ln("dtype",H,_,b))]}case"TruncatedNormal":{const ee=Ln("shape",H,_,b),re=Ln("mean",H,_,b),ae=Ln("stdDev",H,_,b),xe=Ln("seed",H,_,b);return[$.truncatedNormal(ee,re,ae,Ln("dtype",H,_,b),xe)]}case"Zeros":return[$.zeros(Ln("shape",H,_,b),Ln("dtype",H,_,b))];case"ZerosLike":return[$.zerosLike(Ln("x",H,_,b))];default:throw TypeError("Node type "+H.op+" is not implemented")}};function RR(H,_,b){const $=Ln("boxes",H,_,b),ee=Ln("scores",H,_,b),re=Ln("maxOutputSize",H,_,b),ae=Ln("iouThreshold",H,_,b),xe=Ln("scoreThreshold",H,_,b),le=Ln("softNmsSigma",H,_,b);return{boxes:$,scores:ee,maxOutputSize:re,iouThreshold:ae,scoreThreshold:xe,softNmsSigma:le}}const Rr=async(H,_,b,$,ee=bY)=>{switch(H.op){case"NonMaxSuppressionV5":{const{boxes:re,scores:ae,maxOutputSize:xe,iouThreshold:le,scoreThreshold:fe,softNmsSigma:ve}=RR(H,_,b),Se=await ee.image.nonMaxSuppressionWithScoreAsync(re,ae,xe,le,fe,ve);return[Se.selectedIndices,Se.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:re,scores:ae,maxOutputSize:xe,iouThreshold:le,scoreThreshold:fe}=RR(H,_,b),ve=Ln("padToMaxOutputSize",H,_,b),Se=await ee.image.nonMaxSuppressionPaddedAsync(re,ae,xe,le,fe,ve);return[Se.selectedIndices,Se.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:re,scores:ae,maxOutputSize:xe,iouThreshold:le,scoreThreshold:fe}=RR(H,_,b);return[await ee.image.nonMaxSuppressionAsync(re,ae,xe,le,fe)]}case"Where":{const re=ee.cast(Ln("condition",H,_,b),"bool"),ae=[await ee.whereAsync(re)];return re.dispose(),ae}case"ListDiff":return ee.setdiff1dAsync(Ln("x",H,_,b),Ln("y",H,_,b));default:throw TypeError("Node type "+H.op+" is not implemented")}},RQ=(H,_,b,$=bY)=>{switch(H.op){case"LowerBound":{const ee=Ln("sortedSequence",H,_,b),re=Ln("values",H,_,b);return[$.lowerBound(ee,re)]}case"TopKV2":{const ee=Ln("x",H,_,b),re=Ln("k",H,_,b),ae=Ln("sorted",H,_,b),xe=$.topk(ee,re,ae);return[xe.values,xe.indices]}case"UpperBound":{const ee=Ln("sortedSequence",H,_,b),re=Ln("values",H,_,b);return[$.upperBound(ee,re)]}case"Unique":{const ee=Ln("x",H,_,b),re=$.unique(ee);return[re.values,re.indices]}case"UniqueV2":{const ee=Ln("x",H,_,b),re=Ln("axis",H,_,b),ae=$.unique(ee,re);return[ae.values,ae.indices]}default:throw TypeError("Node type "+H.op+" is not implemented")}},RH=(H,_,b,$=bY)=>{switch(H.op){case"Const":return _[H.name];case"PlaceholderWithDefault":const ee=Ln("default",H,_,b);return[Ls(H.name,_,b)||ee];case"Placeholder":return[Ls(H.name,_,b)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const ve=Ln("x",H,_,b);return[Le(ve)]}case"IdentityN":return Ln("x",H,_,b).map(ve=>Le(ve));case"Snapshot":const re=Ln("x",H,_,b);return[Le(re)];case"Shape":return[$.tensor1d(Ln("x",H,_,b).shape,"int32")];case"ShapeN":return Ln("x",H,_,b).map(ve=>$.tensor1d(ve.shape));case"Size":return[$.scalar(Ln("x",H,_,b).size,"int32")];case"Rank":return[$.scalar(Ln("x",H,_,b).rank,"int32")];case"NoOp":return[$.scalar(1)];case"Print":const ae=Ln("x",H,_,b),xe=Ln("data",H,_,b),le=Ln("message",H,_,b),fe=Ln("summarize",H,_,b);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(le);for(let ve=0;ve<xe.length;ve++)console.log(Array.prototype.slice.call(xe[ve].dataSync()).slice(0,fe));return[ae];default:throw TypeError("Node type "+H.op+" is not implemented")}};class RK{get id(){return this.handle.id}constructor(_,b){this.keyDType=_,this.valueDType=b,this.handle=aL(0),this.tensorMap=new Map,SM(this.handle)}clearAndClose(){this.tensorMap.forEach(_=>_.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return aL(this.size(),"int32")}async import(_,b){this.checkKeyAndValueTensor(_,b);const $=await _.data();return this.tensorMap.forEach(ee=>ee.dispose()),this.tensorMap.clear(),Sq(()=>{const ee=zL(b),re=$.length,ae=ee.length;k(re===ae,()=>"The number of elements doesn't match, keys has "+re+" elements, the values has "+ae+" elements.");for(let xe=0;xe<re;xe++){const le=$[xe],fe=ee[xe];SM(fe),this.tensorMap.set(le,fe)}return this.handle})}async find(_,b){this.checkKeyAndValueTensor(_,b);const $=await _.data();return Sq(()=>{const ee=[];for(let re=0;re<$.length;re++){const ae=$[re],xe=this.findWithDefault(ae,b);ee.push(xe)}return zF(ee)})}findWithDefault(_,b){const $=this.tensorMap.get(_);return $??b}checkKeyAndValueTensor(_,b){if(_.dtype!==this.keyDType)throw new Error("Expect key dtype "+this.keyDType+", but got "+_.dtype);if(b.dtype!==this.valueDType)throw new Error("Expect value dtype "+this.valueDType+", but got "+b.dtype)}}const RB=async(H,_,b,$)=>{switch(H.op){case"HashTable":case"HashTableV2":{const ee=$.getHashTableHandleByName(H.name);if(ee!=null)return[ee];{const re=Ln("keyDType",H,_,b),ae=Ln("valueDType",H,_,b),xe=new RK(re,ae);return $.addHashTable(H.name,xe),[xe.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const ee=Ln("tableHandle",H,_,b,$),re=Ln("keys",H,_,b),ae=Ln("values",H,_,b);return[await $.getHashTableById(ee.id).import(re,ae)]}case"LookupTableFind":case"LookupTableFindV2":{const ee=Ln("tableHandle",H,_,b,$),re=Ln("keys",H,_,b),ae=Ln("defaultValue",H,_,b);return[await $.getHashTableById(ee.id).find(re,ae)]}case"LookupTableSize":case"LookupTableSizeV2":{const ee=Ln("tableHandle",H,_,b,$);return[$.getHashTableById(ee.id).tensorSize()]}default:throw TypeError("Node type "+H.op+" is not implemented")}},RV=(H,_,b,$=bY)=>{switch(H.op){case"ResizeBilinear":{const ee=Ln("images",H,_,b),re=Ln("size",H,_,b),ae=Ln("alignCorners",H,_,b),xe=Ln("halfPixelCenters",H,_,b);return[$.image.resizeBilinear(ee,[re[0],re[1]],ae,xe)]}case"ResizeNearestNeighbor":{const ee=Ln("images",H,_,b),re=Ln("size",H,_,b),ae=Ln("alignCorners",H,_,b),xe=Ln("halfPixelCenters",H,_,b);return[$.image.resizeNearestNeighbor(ee,[re[0],re[1]],ae,xe)]}case"CropAndResize":{const ee=Ln("image",H,_,b),re=Ln("boxes",H,_,b),ae=Ln("boxInd",H,_,b),xe=Ln("cropSize",H,_,b),le=Ln("method",H,_,b),fe=Ln("extrapolationValue",H,_,b);return[$.image.cropAndResize(ee,re,ae,xe,le,fe)]}case"ImageProjectiveTransformV3":{const ee=Ln("images",H,_,b),re=Ln("transforms",H,_,b),ae=Ln("outputShape",H,_,b),xe=Ln("fillValue",H,_,b),le=Ln("interpolation",H,_,b),fe=Ln("fillMode",H,_,b);return[$.image.transform(ee,re,le.toLowerCase(),fe.toLowerCase(),xe,ae)]}default:throw TypeError("Node type "+H.op+" is not implemented")}},RJ=(H,_,b,$=bY)=>{switch(H.op){case"Equal":return[$.equal(Ln("a",H,_,b),Ln("b",H,_,b))];case"NotEqual":return[$.notEqual(Ln("a",H,_,b),Ln("b",H,_,b))];case"Greater":return[$.greater(Ln("a",H,_,b),Ln("b",H,_,b))];case"GreaterEqual":return[$.greaterEqual(Ln("a",H,_,b),Ln("b",H,_,b))];case"Less":return[$.less(Ln("a",H,_,b),Ln("b",H,_,b))];case"LessEqual":return[$.lessEqual(Ln("a",H,_,b),Ln("b",H,_,b))];case"LogicalAnd":return[$.logicalAnd(Ln("a",H,_,b),Ln("b",H,_,b))];case"LogicalNot":return[$.logicalNot(Ln("a",H,_,b))];case"LogicalOr":return[$.logicalOr(Ln("a",H,_,b),Ln("b",H,_,b))];case"Select":case"SelectV2":return[$.where(Ln("condition",H,_,b),Ln("a",H,_,b),Ln("b",H,_,b))];case"BitwiseAnd":return[$.bitwiseAnd(Ln("a",H,_,b),Ln("b",H,_,b))];default:throw TypeError("Node type "+H.op+" is not implemented")}},RY=(H,_,b,$=bY)=>{switch(H.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[$.matMul(Ln("a",H,_,b),Ln("b",H,_,b),Ln("transposeA",H,_,b),Ln("transposeB",H,_,b))];case"Einsum":return[$.einsum(Ln("equation",H,_,b),...Ln("tensors",H,_,b))];case"Transpose":return[$.transpose(Ln("x",H,_,b),Ln("perm",H,_,b))];case"_FusedMatMul":const[ee,re]=Ln("fusedOps",H,_,b),ae=ee==="biasadd",xe=re==="prelu",le=Ln("numArgs",H,_,b),fe=Ln("leakyreluAlpha",H,_,b);if(ae){if(xe&&le!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!xe&&le!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[ve,Se]=Ln("args",H,_,b);return[$.fused.matMul({a:Ln("a",H,_,b),b:Ln("b",H,_,b),transposeA:Ln("transposeA",H,_,b),transposeB:Ln("transposeB",H,_,b),bias:ve,activation:re,preluActivationWeights:Se,leakyreluAlpha:fe})];case"MatrixBandPart":return[$.linalg.bandPart(Ln("a",H,_,b),Ln("numLower",H,_,b),Ln("numUpper",H,_,b))];default:throw TypeError("Node type "+H.op+" is not implemented")}},RP=(H,_,b,$=bY)=>{switch(H.op){case"EuclideanNorm":return[$.euclideanNorm(Ln("x",H,_,b),Ln("axis",H,_,b),Ln("keepDims",H,_,b))];case"FusedBatchNorm":case"FusedBatchNormV2":return[$.batchNorm(Ln("x",H,_,b),Ln("mean",H,_,b),Ln("variance",H,_,b),Ln("offset",H,_,b),Ln("scale",H,_,b),Ln("epsilon",H,_,b))];case"FusedBatchNormV3":return[$.batchNorm(Ln("x",H,_,b),Ln("mean",H,_,b),Ln("variance",H,_,b),Ln("offset",H,_,b),Ln("scale",H,_,b),Ln("epsilon",H,_,b))];case"LRN":return[$.localResponseNormalization(Ln("x",H,_,b),Ln("radius",H,_,b),Ln("bias",H,_,b),Ln("alpha",H,_,b),Ln("beta",H,_,b))];case"Softmax":return[$.softmax(Ln("x",H,_,b))];case"LogSoftmax":return[$.logSoftmax(Ln("x",H,_,b))];default:throw TypeError("Node type "+H.op+" is not implemented")}},RU=(H,_,b,$=bY)=>{switch(H.op){case"RaggedGather":{const{outputNestedSplits:ee,outputDenseValues:re}=$.raggedGather(Ln("paramsNestedSplits",H,_,b),Ln("paramsDenseValues",H,_,b),Ln("indices",H,_,b),Ln("outputRaggedRank",H,_,b));return ee.concat(re)}case"RaggedRange":{const{rtNestedSplits:ee,rtDenseValues:re}=$.raggedRange(Ln("starts",H,_,b),Ln("limits",H,_,b),Ln("splits",H,_,b));return[ee,re]}case"RaggedTensorToTensor":return[$.raggedTensorToTensor(Ln("shape",H,_,b),Ln("values",H,_,b),Ln("defaultValue",H,_,b),Ln("rowPartitionTensors",H,_,b),Ln("rowPartitionTypes",H,_,b))];default:throw TypeError("Node type "+H.op+" is not implemented")}},oq=(H,_,b,$=bY)=>{switch(H.op){case"Max":{const xe=Ln("axis",H,_,b),le=Ln("keepDims",H,_,b);return[$.max(Ln("x",H,_,b),xe,le)]}case"Mean":{const xe=Ln("axis",H,_,b),le=Ln("keepDims",H,_,b);return[$.mean(Ln("x",H,_,b),xe,le)]}case"Min":{const xe=Ln("axis",H,_,b),le=Ln("keepDims",H,_,b);return[$.min(Ln("x",H,_,b),xe,le)]}case"Sum":{const xe=Ln("axis",H,_,b),le=Ln("keepDims",H,_,b);return[$.sum(Ln("x",H,_,b),xe,le)]}case"All":{const xe=Ln("axis",H,_,b),le=Ln("keepDims",H,_,b);return[$.all(Ln("x",H,_,b),xe,le)]}case"Any":{const xe=Ln("axis",H,_,b),le=Ln("keepDims",H,_,b);return[$.any(Ln("x",H,_,b),xe,le)]}case"ArgMax":{const xe=Ln("axis",H,_,b);return[$.argMax(Ln("x",H,_,b),xe)]}case"ArgMin":{const xe=Ln("axis",H,_,b);return[$.argMin(Ln("x",H,_,b),xe)]}case"Prod":{const xe=Ln("axis",H,_,b),le=Ln("keepDims",H,_,b);return[$.prod(Ln("x",H,_,b),xe,le)]}case"Cumprod":{const xe=Ln("axis",H,_,b),le=Ln("exclusive",H,_,b),fe=Ln("reverse",H,_,b);return[$.cumprod(Ln("x",H,_,b),xe,le,fe)]}case"Cumsum":{const xe=Ln("axis",H,_,b),le=Ln("exclusive",H,_,b),fe=Ln("reverse",H,_,b);return[$.cumsum(Ln("x",H,_,b),xe,le,fe)]}case"Bincount":const ee=Ln("x",H,_,b),re=Ln("weights",H,_,b),ae=Ln("size",H,_,b);return[$.bincount(ee,re,ae)];case"DenseBincount":{const xe=Ln("x",H,_,b),le=Ln("weights",H,_,b),fe=Ln("size",H,_,b),ve=Ln("binaryOutput",H,_,b);return[$.denseBincount(xe,le,fe,ve)]}default:throw TypeError("Node type "+H.op+" is not implemented")}},oM=(H,_,b,$=bY)=>{switch(H.op){case"ConcatV2":case"Concat":{const ee=Ln("n",H,_,b),re=Ln("axis",H,_,b);let ae=Ln("tensors",H,_,b);return ae=ae.slice(0,ee),[$.concat(ae,re)]}case"Gather":{const ee=Ln("x",H,_,b),re=Ln("indices",H,_,b);return[$.gather(ee,$.cast(re,"int32"),0)]}case"GatherV2":{const ee=Ln("axis",H,_,b),re=Ln("batchDims",H,_,b),ae=Ln("x",H,_,b),xe=Ln("indices",H,_,b);return[$.gather(ae,$.cast(xe,"int32"),ee,re)]}case"Reverse":{const ee=Ln("dims",H,_,b),re=[];for(let xe=0;xe<ee.length;xe++)ee[xe]&&re.push(xe);const ae=Ln("x",H,_,b);return[$.reverse(ae,re)]}case"ReverseV2":{const ee=Ln("axis",H,_,b),re=Ln("x",H,_,b);return[$.reverse(re,ee)]}case"Slice":{const ee=Ln("begin",H,_,b),re=Ln("size",H,_,b);return[$.slice(Ln("x",H,_,b),ee,re)]}case"StridedSlice":{const ee=Ln("begin",H,_,b),re=Ln("end",H,_,b),ae=Ln("strides",H,_,b),xe=Ln("beginMask",H,_,b),le=Ln("endMask",H,_,b),fe=Ln("ellipsisMask",H,_,b),ve=Ln("newAxisMask",H,_,b),Se=Ln("shrinkAxisMask",H,_,b),Ee=Ln("x",H,_,b);return[$.stridedSlice(Ee,ee,re,ae,xe,le,fe,ve,Se)]}case"Pack":return Sq(()=>{const ee=Ln("axis",H,_,b),re=Ln("tensors",H,_,b),ae=re[0].shape,xe=$.squeeze(re[0]).shape,le=re.map(fe=>{const ve=D(fe.shape,ae);if(!ve&&!D($.squeeze(fe).shape,xe))throw new Error("the input tensors shape does not match");return ve?fe:$.reshape(fe,ae)});return[$.stack(le,ee)]});case"Unpack":{const ee=Ln("axis",H,_,b),re=Ln("tensor",H,_,b);return $.unstack(re,ee)}case"Tile":{const ee=Ln("reps",H,_,b);return[$.tile(Ln("x",H,_,b),ee)]}case"Split":case"SplitV":{const ee=Ln("axis",H,_,b),re=Ln("numOrSizeSplits",H,_,b),ae=Ln("x",H,_,b);return $.split(ae,re,ee)}case"ScatterNd":{const ee=Ln("indices",H,_,b),re=Ln("values",H,_,b),ae=Ln("shape",H,_,b);return[$.scatterND(ee,re,ae)]}case"GatherNd":{const ee=Ln("x",H,_,b),re=Ln("indices",H,_,b);return[$.gatherND(ee,re)]}case"SparseToDense":{const ee=Ln("sparseIndices",H,_,b),re=Ln("outputShape",H,_,b),ae=Ln("sparseValues",H,_,b),xe=Ln("defaultValue",H,_,b);return[$.sparseToDense(ee,ae,re,ae.dtype===xe.dtype?xe:$.cast(xe,ae.dtype))]}case"TensorScatterUpdate":{const ee=Ln("indices",H,_,b),re=Ln("values",H,_,b),ae=Ln("tensor",H,_,b);return[$.tensorScatterUpdate(ae,ee,re)]}default:throw TypeError("Node type "+H.op+" is not implemented")}},oF=(H,_,b,$=bY)=>{switch(H.op){case"SparseFillEmptyRows":{const{outputIndices:ee,outputValues:re,emptyRowIndicator:ae,reverseIndexMap:xe}=$.sparse.sparseFillEmptyRows(Ln("indices",H,_,b),Ln("values",H,_,b),Ln("denseShape",H,_,b),Ln("defaultValue",H,_,b));return[ee,re,ae,xe]}case"SparseReshape":{const{outputIndices:ee,outputShape:re}=$.sparse.sparseReshape(Ln("inputIndices",H,_,b),Ln("inputShape",H,_,b),Ln("newShape",H,_,b));return[ee,re]}case"SparseSegmentMean":return[$.sparse.sparseSegmentMean(Ln("data",H,_,b),Ln("indices",H,_,b),Ln("segmentIds",H,_,b))];case"SparseSegmentSum":return[$.sparse.sparseSegmentSum(Ln("data",H,_,b),Ln("indices",H,_,b),Ln("segmentIds",H,_,b))];default:throw TypeError("Node type "+H.op+" is not implemented")}},oW=(H,_,b,$=bY)=>{switch(H.op){case"FFT":return[$.fft(Ln("x",H,_,b))];case"IFFT":return[$.ifft(Ln("x",H,_,b))];case"RFFT":return[$.rfft(Ln("x",H,_,b))];case"IRFFT":return[$.irfft(Ln("x",H,_,b))];default:throw TypeError("Node type "+H.op+" is not implemented")}},oD=(H,_,b,$=bY)=>{switch(H.op){case"StaticRegexReplace":return[$.string.staticRegexReplace(Ln("input",H,_,b),Ln("pattern",H,_,b),Ln("rewrite",H,_,b),Ln("replaceGlobal",H,_,b))];case"StringNGrams":{const{nGrams:ee,nGramsSplits:re}=$.string.stringNGrams(Ln("data",H,_,b),Ln("dataSplits",H,_,b),Ln("separator",H,_,b),Ln("nGramWidths",H,_,b),Ln("leftPad",H,_,b),Ln("rightPad",H,_,b),Ln("padWidth",H,_,b),Ln("preserveShortSequences",H,_,b));return[ee,re]}case"StringSplit":{const{indices:ee,values:re,shape:ae}=$.string.stringSplit(Ln("input",H,_,b),Ln("delimiter",H,_,b),Ln("skipEmpty",H,_,b));return[ee,re,ae]}case"StringToHashBucketFast":return[$.string.stringToHashBucketFast(Ln("input",H,_,b),Ln("numBuckets",H,_,b))];default:throw TypeError("Node type "+H.op+" is not implemented")}},oa=(H,_,b,$=bY)=>{switch(H.op){case"Cast":return[$.cast(Ln("x",H,_,b),Ln("dtype",H,_,b))];case"ExpandDims":{const ee=Ln("axis",H,_,b);return[$.expandDims(Ln("x",H,_,b),ee)]}case"Squeeze":{const ee=Ln("axis",H,_,b);return[$.squeeze(Ln("x",H,_,b),ee)]}case"Reshape":return[$.reshape(Ln("x",H,_,b),Ln("shape",H,_,b))];case"EnsureShape":return[$.ensureShape(Ln("x",H,_,b),Ln("shape",H,_,b))];case"MirrorPad":return[$.mirrorPad(Ln("x",H,_,b),Ln("padding",H,_,b),Ln("mode",H,_,b))];case"PadV2":case"Pad":return[$.pad(Ln("x",H,_,b),Ln("padding",H,_,b),Ln("constantValue",H,_,b))];case"SpaceToBatchND":{const ee=Ln("blockShape",H,_,b),re=Ln("paddings",H,_,b);return[$.spaceToBatchND(Ln("x",H,_,b),ee,re)]}case"BatchToSpaceND":{const ee=Ln("blockShape",H,_,b),re=Ln("crops",H,_,b);return[$.batchToSpaceND(Ln("x",H,_,b),ee,re)]}case"DepthToSpace":{const ee=Ln("blockSize",H,_,b),re=Ln("dataFormat",H,_,b).toUpperCase();return[$.depthToSpace(Ln("x",H,_,b),ee,re)]}case"BroadcastTo":return[$.broadcastTo(Ln("x",H,_,b),Ln("shape",H,_,b))];case"BroadcastArgs":return[$.broadcastArgs(Ln("s0",H,_,b),Ln("s1",H,_,b))];default:throw TypeError("Node type "+H.op+" is not implemented")}};function oZ(H,_,b,$,ee=Sq){const re=((ae,xe,le)=>{switch(ae.category){case"arithmetic":return ee(()=>bP(ae,xe,le));case"basic_math":return ee(()=>bU(ae,xe,le));case"control":return RG(ae,xe,le);case"convolution":return ee(()=>Rj(ae,xe,le));case"creation":return ee(()=>RL(ae,xe,le));case"dynamic":return Rr(ae,xe,le);case"evaluation":return ee(()=>RQ(ae,xe,le));case"image":return ee(()=>RV(ae,xe,le));case"graph":return ee(()=>RH(ae,xe,le));case"logical":return ee(()=>RJ(ae,xe,le));case"matrices":return ee(()=>RY(ae,xe,le));case"normalization":return ee(()=>RP(ae,xe,le));case"ragged":return ee(()=>RU(ae,xe,le));case"reduction":return ee(()=>oq(ae,xe,le));case"slice_join":return ee(()=>oM(ae,xe,le));case"sparse":return ee(()=>oF(ae,xe,le));case"spectral":return ee(()=>oW(ae,xe,le));case"string":return ee(()=>oD(ae,xe,le));case"transformation":return ee(()=>oa(ae,xe,le));case"hash_table":return RB(ae,xe,le,$);case"custom":const fe=Lq(ae.op);if(fe&&fe.customExecutor)return fe.customExecutor(new bB$1(ae,xe,le));throw TypeError("Custom op "+ae.op+" is not registered.");default:throw TypeError("Unknown op '"+ae.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}})(H,_,b);return J(re)?re.then(ae=>[].concat(ae)):[].concat(re)}class oe{constructor(_={},b={},$={},ee={},re){this.weightMap=_,this.tensorArrayMap=b,this.tensorListMap=$,this.functionMap=ee,this.parseNodeNameCache=re,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(_,b){return{id:_,frameName:b,iterationId:0}}set currentContext(_){this.contexts!==_&&(this.contexts=_,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const _=[];for(let b=0;b<this.contexts.length-1;b++){const $=this.contexts.slice(0,this.contexts.length-b);_.push(this.contextIdforContexts($))}_.push(""),this._currentContextIds=_}contextIdforContexts(_){return _?_.map(b=>b.id===0&&b.iterationId===0?"":b.frameName+"-"+b.iterationId).join("/"):""}enterFrame(_){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,_)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const _=Object.assign({},this.contexts[this.contexts.length-1]);_.iterationId+=1,_.id=this.lastId,this.contexts.splice(-1,1,_),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(_){return this.weightMap[_]}addTensorArray(_){this.tensorArrayMap[_.id]=_}getTensorArray(_){return this.tensorArrayMap[_]}addTensorList(_){this.tensorListMap[_.id]=_}getTensorList(_){return this.tensorListMap[_]}dispose(_){for(const b in this.tensorArrayMap)this.tensorArrayMap[b].clearAndClose(_);for(const b in this.tensorListMap)this.tensorListMap[b].clearAndClose(_)}}function oz(H,_,b,$){const ee=new Set,re=[];let ae=null,xe=null;const le=new Set,fe=new Set(Object.keys(H).map(Ee=>LD(Ee)[0]));$=$||[];const ve=new Set($.map(Ee=>LD(Ee.name)[0])),Se=[..._];for(;Se.length>0;){const Ee=Se.pop();if((oH(Ee)||oK(Ee)||oB(Ee))&&ae==null&&(ae=Ee,xe=ae.children.map(Ce=>Ce.name).filter(Ce=>ee.has(Ce))),ee.add(Ee.name),b[Ee.name]==null&&!fe.has(Ee.name)&&!ve.has(Ee.name)){if(Ee.inputs.length===0){re.push(Ee.name);continue}Ee.inputs.forEach(Ce=>{le.has(Ce.name)||(le.add(Ce.name),Se.push(Ce))})}}return{inputs:H,outputs:_,usedNodes:ee,missingInputs:re,dynamicNode:ae,syncInputs:xe}}function oX(H,_){const{usedNodes:b,inputs:$}=_,ee=Object.keys($).map(Be=>LD(Be)[0]).map(Be=>H.nodes[Be]),re=H.initNodes||[],ae=Be=>b.has(typeof Be=="string"?Be:Be.name);function xe(Be){return[...new Map(Be.map(Ne=>[Ne.name,Ne])).values()]}const le=xe([...ee,...H.weights,...re]).filter(ae),fe=xe([...le,...Object.values(H.nodes)]).filter(ae),ve=new Map(fe.map(Be=>[Be.name,Be])),Se={};for(const Be of fe){Se[Be.name]=Se[Be.name]||0;for(const Ne of Be.children)ae(Ne)||(Se[Ne.name]=Number.POSITIVE_INFINITY),Se[Ne.name]=(Se[Ne.name]||0)+1}const Ee=Object.entries(Se).filter(([,Be])=>Be===0).map(([Be])=>Be),Ce=[...Ee];for(;Ee.length>0;){const Be=Ee.pop(),Ne=ve.get(Be);for(const qe of Ne.children.filter(ae))--Se[qe.name]===0&&(Ce.push(qe.name),Ee.push(qe.name))}const Ie=Ce.map(Be=>ve.get(Be)),De=oG(Ie,le);return oj(De,le),De}function oG(H,_){const b=new Map(H.map(re=>[re.name,re])),$=_.map(re=>re.name),ee=new Set($);for(;$.length>0;){const re=$.pop(),ae=b.get(re);for(const xe of ae.children)!b.has(xe.name)||ee.has(xe.name)||(ee.add(xe.name),$.push(xe.name))}return H.filter(re=>ee.has(re.name))}class ou extends Error{constructor(_){super("NodesExecutionOrderError: "+_)}}function oj(H,_){const b=new Map(H.map((xe,le)=>[xe.name,le])),$=new Set(_.map(xe=>xe.name)),ee=xe=>$.has(typeof xe=="string"?xe:xe.name),re=new Set(H.map(xe=>xe.name)),ae=xe=>re.has(typeof xe=="string"?xe:xe.name);for(const xe of H){for(const le of xe.children.filter(ae)){if(!b.has(le.name))throw new ou("Child "+le.name+" of node "+xe.name+" is unreachable.");if(b.get(xe.name)>b.get(le.name))throw new ou("Node "+xe.name+" is scheduled to run after its child "+le.name+".")}if(!ee(xe))for(const le of xe.inputs){if(!b.has(le.name))throw new ou("Input "+le.name+" of node "+xe.name+" is unreachable.");if(b.get(le.name)>b.get(xe.name))throw new ou("Node "+xe.name+" is scheduled to run before its input "+le.name+".")}}}function oL(H){const _=new Map(H.map((xe,le)=>[xe.name,le])),b=Number.MAX_SAFE_INTEGER,$=H.map((xe,le)=>oH(xe)?b:le),ee=xe=>{const le=$[_.get(xe.name)];return le??-1},re=H.map((xe,le)=>xe.children.map(ee).reduce((fe,ve)=>Math.max(fe,ve),$[le])),ae=new Map;for(let xe=0;xe<H.length;++xe){const le=re[xe];if(le===b)continue;const fe=H[xe],ve=H[le];ae.has(ve.name)||ae.set(ve.name,[]),ae.get(ve.name).push(fe)}return ae}const oo=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),or=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),oQ=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function oH(H){return oo.has(H.op)}function oK(H){return or.has(H.op)}function oB(H){return oQ.has(H.op)}class oV{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(_){const b=Object.keys(_).map($=>_[$].map(ee=>ee.id));this._weightIds=[].concat(...b),this._weightMap=_}set resourceManager(_){this._resourceManager=_}get inputs(){return this._inputs.map(_=>({name:_.name,shape:_.attrParams.shape?_.attrParams.shape.value:void 0,dtype:_.attrParams.dtype?_.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(_=>({name:_.name,shape:_.attrParams.shape?_.attrParams.shape.value:void 0,dtype:_.attrParams.dtype?_.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(_=>_.signatureKey||_.name)}get outputNodes(){return this._outputs.map(_=>{const b=_.signatureKey||_.name;return _.defaultOutput?b+":"+_.defaultOutput:b})}get functions(){return Object.keys(this._functions).reduce((_,b)=>(_[b]=this._functions[b].signature,_),{})}constructor(_,b){this.graph=_,this.parent=b,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=_.outputs,this._inputs=_.inputs,this._initNodes=_.initNodes,this._signature=_.signature,this._functions=_.functions,_.functions!=null&&Object.keys(_.functions).forEach($=>{this._functionExecutorMap[$]=new oV(_.functions[$],this)})}getCompilationKey(_,b){const $=_.map(re=>re.name).sort(),ee=b.map(re=>re.name).sort();return $.join(this.SEPARATOR)+"--"+ee.join(this.SEPARATOR)}compile(_,b){const $=oz(_,b,this.weightMap,this._initNodes),{missingInputs:ee,dynamicNode:re,syncInputs:ae}=$;if(re!=null)throw new Error("This execution contains the node '"+re.name+"', which has the dynamic op '"+re.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+ae+"]");if(ee.length>0){const fe=b.map(Se=>Se.name),ve=Object.keys(_);throw new Error("Cannot compute the outputs ["+fe+"] from the provided inputs ["+ve+"]. Missing the following inputs: ["+ee+"]")}const xe=oX(this.graph,$),le=oL(xe);return{orderedNodes:xe,nodeLiveUntilMap:le}}cloneAndKeepTensor(_){if(_==null)return null;const b=_.clone();return SM(b),b}cloneTensorList(_){return _?_.map(b=>this.cloneAndKeepTensor(b)):null}cloneTensorMap(_){return Object.fromEntries(Object.entries(_).map(([b,$])=>[b,this.cloneTensorList($)]))}execute(_,b){this.disposeIntermediateTensors(),_=this.mapInputs(_);const $=Object.keys(_).sort();this.checkInputs(_),this.checkInputShapeAndType(_),b=this.mapOutputs(b),this.checkOutputs(b);const ee=$.map(Ee=>this.graph.nodes[LD(Ee)[0]]),re=b.map(Ee=>LD(Ee)[0]),ae=new Set(re);let xe=re.map(Ee=>this.graph.nodes[Ee]);xe.length===0&&(xe=this._outputs);const le=this.getCompilationKey(ee,xe);let fe=this.compiledMap.get(le);fe==null&&(fe=this.compile(_,xe),this.compiledMap.set(le,fe));try{this.keepIntermediateTensors=qM().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(Ee){this.keepIntermediateTensors=!1,console.warn(Ee.message)}const ve={},Se={};return Sq(()=>{const Ee=new oe(this.weightMap,ve,Se,this.functionExecutorMap,this.parseNodeNameCache),Ce=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(_).forEach(Ne=>{const[qe,Xe]=LD(Ne,Ee),Ye=[];Ye[Xe]=_[Ne],Ce[qe]=Ye,this.keepIntermediateTensors&&(this.clonedTensorsMap[qe]=this.cloneTensorList(Ye))});const Ie=this.getFrozenTensorIds(Ce),{orderedNodes:De,nodeLiveUntilMap:Be}=fe;for(const Ne of De){if(Ce[Ne.name])continue;const qe=oZ(Ne,Ce,Ee,this._resourceManager);if(J(qe))throw new Error("The execution of the op '"+Ne.op+"' returned a promise. Please use model.executeAsync() instead.");Ce[Ne.name]=qe,this.keepIntermediateTensors&&(this.clonedTensorsMap[Ne.name]=this.cloneTensorList(qe)),this.checkTensorForDisposalWithNodeLiveUntilInfo(Ne,Ce,Ee,Ie,ae,Be.get(Ne.name))}return this.parent==null&&Ee.dispose(Ie),b.map(Ne=>Ls(Ne,Ce,Ee))})}getFrozenTensorIds(_){const b=[].concat.apply([],Object.keys(_).map($=>_[$]).map($=>$.map(ee=>ee.id)));return new Set(b)}checkTensorForDisposal(_,b,$,ee,re,ae,xe){if(!(oH(b)||ae.has(_))){for(const le of $[_])le!=null&&(xe[le.id]=(xe[le.id]||0)+b.children.length);for(const le of b.inputs){if(oH(le))continue;const fe=LM(le.name,$,ee);if(fe!=null)for(const ve of fe){if(!ve||ve.kept||re.has(ve.id))continue;const Se=xe[ve.id];Se===1?(ve.dispose(),delete xe[ve.id]):Se!=null&&xe[ve.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(_,b,$,ee,re,ae){function xe(le){return oH(le)||re.has(le.name)}if(!(oH(_)||ae==null))for(const le of ae){if(xe(le))continue;const fe=LM(le.name,b,$);for(const ve of fe)!ve||ve.kept||ee.has(ve.id)||ve.dispose()}}async executeAsync(_,b){return this._executeAsync(_,b)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(_=>{for(const b of _)b&&!b.isDisposed&&b.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(_,b,$=!1,ee={},re={}){this.disposeIntermediateTensors(),$||(_=this.mapInputs(_),this.checkInputs(_),this.checkInputShapeAndType(_),b=this.mapOutputs(b),this.checkOutputs(b));try{this.keepIntermediateTensors=qM().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(Ee){this.keepIntermediateTensors=!1,console.warn(Ee.message)}const ae=new oe(this.weightMap,ee,re,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const xe=await this.executeWithControlFlow(_,ae,b,$),le=b.map(Ee=>Ls(Ee,xe,ae)),fe=le.map(Ee=>Ee.id),ve=Object.keys(_).map(Ee=>_[Ee].id),Se=new Set([...fe,...ve,...this.weightIds]);return Object.values(xe).forEach(Ee=>{Ee.forEach(Ce=>{Ce&&!Ce.isDisposed&&!Se.has(Ce.id)&&Ce.dispose()})}),this.parent==null&&ae.dispose(Se),le}async executeFunctionAsync(_,b,$){const ee=_.reduce((re,ae,xe)=>(re[this.inputs[xe].name]=ae,re),{});return this._executeAsync(ee,this.outputNodes,!0,b,$)}async executeWithControlFlow(_,b,$,ee){const re=Object.keys(_),ae=re.map(Ye=>this.graph.nodes[LD(Ye)[0]]),xe=$.map(Ye=>LD(Ye)[0]),le=new Set(xe);let fe=xe.map(Ye=>this.graph.nodes[Ye]);fe.length===0&&(fe=this._outputs);const{usedNodes:ve,missingInputs:Se,dynamicNode:Ee,syncInputs:Ce}=oz(_,fe,this.weightMap,this._initNodes),Ie=[...ae,...this.graph.weights,...this._initNodes||[]].map(Ye=>({node:Ye,contexts:b.currentContext})),De=Object.assign({},this.weightMap);Object.keys(_).forEach(Ye=>{const[Qe,rt]=LD(Ye),ot=[];ot[rt]=_[Ye],De[Qe]=ot});const Be={},Ne=this.getFrozenTensorIds(De),qe={};for(;Ie.length>0;){const Ye=this.processStack(ae,Ie,b,De,qe,Ne,le,Be,ve);await Promise.all(Ye)}Ee==null&&!ee&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const Xe=fe.filter(Ye=>!oH(Ye)&&!Ls(Ye.name,De,b)).map(Ye=>Ye.name);if(Xe.length>0){let Ye="";throw Ee!=null&&(Ye="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+Ce+"]"),new Error("Cannot compute the outputs ["+Xe+"] from the provided inputs ["+re+"]. Consider providing the following inputs: ["+Se+"]. "+Ye)}return De}processStack(_,b,$,ee,re,ae,xe,le,fe){const ve=[];for(;b.length>0;){const Se=b.pop();$.currentContext=Se.contexts;let Ee="";if(Se.node.op==="Enter"&&Ln("isConstant",Se.node,ee,$)&&([Ee]=LF(Se.node.name,$)),ee[Se.node.name]==null){const Ce=oZ(Se.node,ee,$,this._resourceManager);Ee||([Ee]=LF(Se.node.name,$));const Ie=$.currentContext;J(Ce)?ve.push(Ce.then(De=>(ee[Ee]=De,this.keepIntermediateTensors&&(this.clonedTensorsMap[Ee]=this.cloneTensorList(De)),$.currentContext=Ie,this.checkTensorForDisposal(Ee,Se.node,ee,$,ae,xe,le),this.processChildNodes(Se.node,b,$,ee,re,fe),De))):(ee[Ee]=Ce,this.keepIntermediateTensors&&(this.clonedTensorsMap[Ee]=this.cloneTensorList(Ce)),this.checkTensorForDisposal(Ee,Se.node,ee,$,ae,xe,le),this.processChildNodes(Se.node,b,$,ee,re,fe))}else this.processChildNodes(Se.node,b,$,ee,re,fe)}return ve}processChildNodes(_,b,$,ee,re,ae){_.children.forEach(xe=>{const[le]=LF(xe.name,$);re[le]||!ae.has(xe.name)||(xe.op==="Merge"?xe.inputNames.some(fe=>!!Ls(fe,ee,$))&&(re[le]=!0,b.push({contexts:$.currentContext,node:xe})):xe.inputNames.every(fe=>!!Ls(fe,ee,$))&&(re[le]=!0,b.push({contexts:$.currentContext,node:xe})))})}dispose(){Object.keys(this.weightMap).forEach(_=>this.weightMap[_].forEach(b=>b.dispose()))}checkInputShapeAndType(_){Object.keys(_).forEach(b=>{const $=_[b],[ee]=LD(b),re=this.graph.nodes[ee];if(re.attrParams.shape&&re.attrParams.shape.value){const ae=re.attrParams.shape.value,xe=ae.length===$.shape.length&&$.shape.every((le,fe)=>ae[fe]===-1||ae[fe]===le);k(xe,()=>"The shape of dict['"+re.name+"'] provided in model.execute(dict) must be ["+ae+"], but was ["+$.shape+"]")}re.attrParams.dtype&&re.attrParams.dtype.value&&k($.dtype===re.attrParams.dtype.value,()=>"The dtype of dict['"+re.name+"'] provided in model.execute(dict) must be "+re.attrParams.dtype.value+", but was "+$.dtype)})}mapInputs(_){var b,$;const ee={};for(const re in _){const ae=($=(b=this._signature)===null||b===void 0?void 0:b.inputs)===null||$===void 0?void 0:$[re];ae!=null?ee[ae.name]=_[re]:ee[re]=_[re]}return ee}checkInputs(_){const b=Object.keys(_).filter($=>{const[ee]=LD($);return this.graph.nodes[ee]==null});if(b.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+b+"] that are not part of graph")}mapOutputs(_){return _.map(b=>{var $,ee;const re=(ee=($=this._signature)===null||$===void 0?void 0:$.outputs)===null||ee===void 0?void 0:ee[b];return re!=null?re.name:b},{})}checkOutputs(_){_.forEach(b=>{const[$]=LD(b);if(!this.graph.nodes[$])throw new Error("The output '"+b+"' is not found in the graph")})}}class oJ{constructor(_={},b={}){this.hashTableNameToHandle=_,this.hashTableMap=b}addHashTable(_,b){this.hashTableNameToHandle[_]=b.handle,this.hashTableMap[b.id]=b}getHashTableHandleByName(_){return this.hashTableNameToHandle[_]}getHashTableById(_){return this.hashTableMap[_]}dispose(){for(const _ in this.hashTableMap)this.hashTableMap[_].clearAndClose(),delete this.hashTableMap[_];for(const _ in this.hashTableNameToHandle)this.hashTableNameToHandle[_].dispose(),delete this.hashTableNameToHandle[_]}}const oY="?tfjs-format=file",oP="model.json";class oU{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(_,b={},$=Oq){this.modelUrl=_,this.loadOptions=b,this.version="n/a",this.io=$,b==null&&(this.loadOptions={}),this.resourceManager=new oJ}findIOHandler(){const _=this.modelUrl;if(_.load!=null)this.handler=_;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(_,this.loadOptions);else{const b=this.io.getLoadHandlers(_,this.loadOptions);if(b.length===0)b.push(this.io.browserHTTPRequest(_,this.loadOptions));else if(b.length>1)throw new Error("Found more than one ("+b.length+") load handlers for URL '"+[_]+"'");this.handler=b[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const _=this.handler.load();return J(_)?_.then(b=>b.getWeightStream==null?this.loadSync(b):this.loadStreaming(b)):this.loadSync(_)}loadSync(_){const b=this.io.decodeWeights(_.weightData,_.weightSpecs);return this.loadWithWeightMap(_,b)}async loadStreaming(_){if(_.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const b=await SQ(_.getWeightStream(),_.weightSpecs);return this.loadWithWeightMap(_,b)}loadWithWeightMap(_,b){this.artifacts=_;const $=this.artifacts.modelTopology;let ee=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const re=this.artifacts.userDefinedMetadata;re.signature!=null&&(ee=re.signature),re.structuredOutputKeys!=null&&(this.structuredOutputKeys=re.structuredOutputKeys)}if(this.signature=ee,this.version=$.versions.producer+"."+$.versions.minConsumer,this.executor=new oV(bM$1.Instance.transformGraph($,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(b),this.executor.resourceManager=this.resourceManager,_.modelInitializer!=null&&_.modelInitializer.node!=null){const re=bM$1.Instance.transformGraph(_.modelInitializer);this.initializer=new oV(re),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=_.initializerSignature}return!0}async save(_,b){if(typeof _=="string"){const $=this.io.getSaveHandlers(_);if($.length===0)throw new Error("Cannot find any save handlers for URL '"+_+"'");if($.length>1)throw new Error("Found more than one ("+$.length+") save handlers for URL '"+_+"'");_=$[0]}if(_.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return _.save(this.artifacts)}addStructuredOutputNames(_){if(this.structuredOutputKeys){const b=_ instanceof MF?[_]:_,$={};return b.forEach((ee,re)=>$[this.structuredOutputKeys[re]]=ee),$}return _}predict(_,b){const $=this.execute(_,this.outputNodes);return this.addStructuredOutputNames($)}async predictAsync(_,b){const $=await this.executeAsync(_,this.outputNodes);return this.addStructuredOutputNames($)}normalizeInputs(_){var b;if(!(_ instanceof MF)&&!Array.isArray(_)){const re=(b=this.signature)===null||b===void 0?void 0:b.inputs;if(re!=null)for(const ae in re){const xe=re[ae];xe.resourceId!=null&&(_[ae]=this.resourceIdToCapturedInput[xe.resourceId])}return _}_=Array.isArray(_)?_:[_];const $=Object.keys(this.resourceIdToCapturedInput).length;if(_.length+$!==this.inputNodes.length)throw new Error("Input tensor count mismatch, the graph model has "+(this.inputNodes.length-$)+" non-resource placeholders, while there are "+_.length+" input tensors provided.");let ee=0;return this.inputNodes.reduce((re,ae)=>{var xe,le,fe;const ve=(fe=(le=(xe=this.signature)===null||xe===void 0?void 0:xe.inputs)===null||le===void 0?void 0:le[ae])===null||fe===void 0?void 0:fe.resourceId;return ve!=null?re[ae]=this.resourceIdToCapturedInput[ve]:re[ae]=_[ee++],re},{})}normalizeOutputs(_){return _=_||this.outputNodes,Array.isArray(_)?_:[_]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(_){if(this.resourceIdToCapturedInput={},this.initializerSignature){const b=this.initializerSignature.outputs,$=Object.keys(b);for(let ee=0;ee<$.length;ee++){const re=$[ee],ae=b[re];this.resourceIdToCapturedInput[ae.resourceId]=_[ee]}}}execute(_,b){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),_=this.normalizeInputs(_),b=this.normalizeOutputs(b);const $=this.executor.execute(_,b);return $.length>1?$:$[0]}async executeAsync(_,b){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),_=this.normalizeInputs(_),b=this.normalizeOutputs(b);const $=await this.executor.executeAsync(_,b);return $.length>1?$:$[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(_){return Object.keys(_).reduce((b,$)=>(b[$]=[_[$]],b),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Sn(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function rq(H,_={},b=Oq){if(H==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");_==null&&(_={}),_.fromTFHub&&typeof H=="string"&&(H=rn(H));const $=new oU(H,_,b);return await $.load(),$}function rn(H){return H.endsWith("/")||(H=H+"/"),""+H+oP+oY}const rs={},rM={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function rF(H,_){rs[H]=_}function rW(H,_){if(!(H in rs)||_!=null){const $=rZ(H,_);if($!==null)rs[H]=$;else return console.log("Could not get context for WebGL version",H),null}const b=rs[H];return b==null||b.isContextLost()?(delete rs[H],rW(H)):(b.disable(b.DEPTH_TEST),b.disable(b.STENCIL_TEST),b.disable(b.BLEND),b.disable(b.DITHER),b.disable(b.POLYGON_OFFSET_FILL),b.disable(b.SAMPLE_COVERAGE),b.enable(b.SCISSOR_TEST),b.enable(b.CULL_FACE),b.cullFace(b.BACK),rs[H])}function rD(H){if(!qM().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&H===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function rZ(H,_){if(H!==1&&H!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const b=_??rD(H);return b.addEventListener("webglcontextlost",$=>{$.preventDefault(),delete rs[H]},!1),qM().getBool("SOFTWARE_WEBGL_ENABLED")&&(rM.failIfMajorPerformanceCaveat=!1),H===1?b.getContext("webgl",rM)||b.getContext("experimental-webgl",rM):b.getContext("webgl2",rM)}var rz;(function(H){H[H.DENSE=0]="DENSE",H[H.SHARED_BATCH=1]="SHARED_BATCH"})(rz||(rz={}));var rX;(function(H){H[H.RENDER=0]="RENDER",H[H.UPLOAD=1]="UPLOAD",H[H.PIXELS=2]="PIXELS",H[H.DOWNLOAD=3]="DOWNLOAD"})(rX||(rX={}));var rG;(function(H){H[H.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",H[H.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",H[H.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",H[H.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",H[H.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(rG||(rG={}));function ru(H,_){return[_,H]}function rj(H,_){return H*_}function rL(H){const _=i$1(H),b=Math.ceil(_/4);return a$1(b)}function ro(H,_){return[Math.max(1,Math.ceil(_/2)),Math.max(1,Math.ceil(H/2))]}function rQ(H,_){const[b,$]=ro(H,_);return b*$*4}function rH(H,_){const b=H;let $,ee,re,ae,xe,le,fe,ve,Se,Ee;return qM().getNumber("WEBGL_VERSION")===2?($=b.R32F,ee=b.R16F,re=b.RGBA16F,ae=b.RGBA32F,xe=b.RED,fe=4,ve=1,Se=b.HALF_FLOAT,Ee=b.FLOAT,le=b.RGBA8):($=H.RGBA,ee=H.RGBA,re=H.RGBA,ae=b.RGBA,xe=H.RGBA,fe=4,ve=4,Se=_!=null?_.HALF_FLOAT_OES:null,Ee=H.FLOAT,le=H.RGBA),{internalFormatFloat:$,internalFormatHalfFloat:ee,internalFormatPackedHalfFloat:re,internalFormatPackedFloat:ae,textureFormatFloat:xe,downloadTextureFormat:le,downloadUnpackNumChannels:fe,defaultNumChannels:ve,textureTypeHalfFloat:Se,textureTypeFloat:Ee}}function rK(H,_){const b=_();return qM().getBool("DEBUG")&&rB(H),b}function rB(H){const _=H.getError();if(_!==H.NO_ERROR)throw new Error("WebGL Error: "+rP(H,_))}const rV=596e-10,rJ=65504;function rY(H){return!!(qM().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||H===0||rV<Math.abs(H)&&Math.abs(H)<rJ)}function rP(H,_){switch(_){case H.NO_ERROR:return"NO_ERROR";case H.INVALID_ENUM:return"INVALID_ENUM";case H.INVALID_VALUE:return"INVALID_VALUE";case H.INVALID_OPERATION:return"INVALID_OPERATION";case H.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case H.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case H.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+_}}function rU(H,_){return QY(H,()=>H.getExtension(_),'Extension "'+_+'" not supported on this browser.')}function Qq(H,_){const b=QY(H,()=>H.createShader(H.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(rK(H,()=>H.shaderSource(b,_)),rK(H,()=>H.compileShader(b)),H.getShaderParameter(b,H.COMPILE_STATUS)===!1)throw console.log(H.getShaderInfoLog(b)),new Error("Failed to compile vertex shader.");return b}function QM(H,_){const b=QY(H,()=>H.createShader(H.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(rK(H,()=>H.shaderSource(b,_)),rK(H,()=>H.compileShader(b)),qM().get("ENGINE_COMPILE_ONLY"))return b;if(H.getShaderParameter(b,H.COMPILE_STATUS)===!1)throw QW(_,H.getShaderInfoLog(b)),new Error("Failed to compile fragment shader.");return b}const QF=/ERROR: [0-9]+:([0-9]+):/g;function QW(H,_){const b=QF.exec(_);if(b==null){console.log("Couldn't parse line number in error: "+_),console.log(H);return}const $=+b[1],ee=H.split(`
`),re=ee.length.toString().length+2,ae=ee.map((Se,Ee)=>Z$1((Ee+1).toString(),re)+Se);let xe=0;for(let Se=0;Se<ae.length;Se++)xe=Math.max(ae[Se].length,xe);const le=ae.slice(0,$-1),fe=ae.slice($-1,$),ve=ae.slice($);console.log(le.join(`
`)),console.log(_.split(`
`)[0]),console.log("%c "+Z$1(fe[0],xe),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(ve.join(`
`))}function QD(H){return QY(H,()=>H.createProgram(),"Unable to create WebGLProgram.")}function Qa(H,_){if(rK(H,()=>H.linkProgram(_)),!qM().get("ENGINE_COMPILE_ONLY")&&H.getProgramParameter(_,H.LINK_STATUS)===!1)throw console.log(H.getProgramInfoLog(_)),new Error("Failed to link vertex and fragment shaders.")}function QZ(H,_){if(rK(H,()=>H.validateProgram(_)),H.getProgramParameter(_,H.VALIDATE_STATUS)===!1)throw console.log(H.getProgramInfoLog(_)),new Error("Shader program validation failed.")}function Qz(H,_){const b=QY(H,()=>H.createBuffer(),"Unable to create WebGLBuffer");return rK(H,()=>H.bindBuffer(H.ARRAY_BUFFER,b)),rK(H,()=>H.bufferData(H.ARRAY_BUFFER,_,H.STATIC_DRAW)),b}function QX(H,_){const b=QY(H,()=>H.createBuffer(),"Unable to create WebGLBuffer");return rK(H,()=>H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,b)),rK(H,()=>H.bufferData(H.ELEMENT_ARRAY_BUFFER,_,H.STATIC_DRAW)),b}function QG(H){return QY(H,()=>H.createTexture(),"Unable to create WebGLTexture.")}function Qj(H,_){const b=qM().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(H<=0||_<=0){const $="["+H+"x"+_+"]";throw new Error("Requested texture size "+$+" is invalid.")}if(H>b||_>b){const $="["+H+"x"+_+"]",ee="["+b+"x"+b+"]";throw new Error("Requested texture size "+$+" greater than WebGL maximum on this browser / GPU "+ee+".")}}function QL(H){return QY(H,()=>H.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function QR(H,_,b,$,ee,re,ae){const xe=H.getAttribLocation(_,b);return xe===-1?!1:(rK(H,()=>H.bindBuffer(H.ARRAY_BUFFER,$)),rK(H,()=>H.vertexAttribPointer(xe,ee,H.FLOAT,!1,re,ae)),rK(H,()=>H.enableVertexAttribArray(xe)),!0)}function Qo(H,_,b){QP(H,b),rK(H,()=>H.activeTexture(H.TEXTURE0+b)),rK(H,()=>H.bindTexture(H.TEXTURE_2D,_))}function QQ(H,_,b){return QY(H,()=>H.getUniformLocation(_,b),'uniform "'+b+'" not present in program.')}function QH(H,_,b){return H.getUniformLocation(_,b)}function Qh(H,_,b,$){rK(H,()=>Qo(H,_,$)),rK(H,()=>H.uniform1i(b,$))}function QK(H,_,b){rK(H,()=>H.bindFramebuffer(H.FRAMEBUFFER,b)),rK(H,()=>H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,_,0))}function QB(H,_){rK(H,()=>H.bindFramebuffer(H.FRAMEBUFFER,_)),rK(H,()=>H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,null,0))}function QV(H){const _=H.checkFramebufferStatus(H.FRAMEBUFFER);if(_!==H.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+QJ(H,_))}function QJ(H,_){switch(_){case H.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case H.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case H.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case H.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+_}}function QY(H,_,b){const $=rK(H,()=>_());if($==null)throw new Error(b);return $}function QP(H,_){const b=H.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,$=_+H.TEXTURE0;if($<H.TEXTURE0||$>b){const ee="[gl.TEXTURE0, gl.TEXTURE"+b+"]";throw new Error("textureUnit must be in "+ee+".")}}function QU(H,_=2){return i$1(H.slice(0,H.length-_))}function d1(H){if(H.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[H.length>1?H[H.length-2]:1,H[H.length-1]]}function dq(H){let _=[1,1,1];return H.length===0||H.length===1&&H[0]===1||(_=[QU(H),...d1(H)]),_}function dM(H,_=!1){let b=qM().getNumber("WEBGL_MAX_TEXTURE_SIZE"),$=qM().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");$===1/0&&qM().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&($=b/2),_&&(b=b*2,$=$*2,H=H.map((xe,le)=>le>=H.length-2?f$1(H[le]):H[le]),H.length===1&&(H=[2,H[0]])),H.length!==2&&(H=c$1(H).newShape);let ee=i$1(H),re=null;H.length<=1&&ee<=b?re=[1,ee]:H.length===2&&H[0]<=b&&H[1]<=b?re=H:H.length===3&&H[0]*H[1]<=b&&H[2]<=b?re=[H[0]*H[1],H[2]]:H.length===3&&H[0]<=b&&H[1]*H[2]<=b?re=[H[0],H[1]*H[2]]:H.length===4&&H[0]*H[1]*H[2]<=b&&H[3]<=b?re=[H[0]*H[1]*H[2],H[3]]:H.length===4&&H[0]<=b&&H[1]*H[2]*H[3]<=b&&(re=[H[0],H[1]*H[2]*H[3]]);const ae=re!=null&&Math.max(...re)>$&&Math.min(...re)<=(_?2:1)&&Math.min(...re)>0;if(re==null||ae)if(_){const xe=QU(H);let le=2,fe=2;H.length&&([le,fe]=d1(H)),ee=xe*(le/2)*(fe/2),re=a$1(ee).map(ve=>ve*2)}else re=a$1(ee);return re}function dF(H){return H%2===0}function dt(H,_){if(H=H.slice(-2),_=_.slice(-2),D(H,_)||!H.length||!_.length||H[0]===0||H[1]===0||_[0]===0||_[1]===0)return!0;if(H.length!==_.length){const b=H[H.length-1],$=_[_.length-1];if(b===$||dF(b)&&dF($)&&(H[0]===1||_[0]===1))return!0}return H[1]===_[1]&&dF(H[0])&&dF(_[0])}let dW,dD;function da(H){if(dW==null){const _=rW(H);dW=_.getParameter(_.MAX_TEXTURE_SIZE)}return dW}function dZ(H){if(dD==null){const _=rW(H);dD=_.getParameter(_.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,dD)}function de(H){if(H===0)return 0;let _;const b=rW(H);return dz(b,"EXT_disjoint_timer_query_webgl2")&&H===2?_=2:dz(b,"EXT_disjoint_timer_query")?_=1:_=0,_}function dz(H,_){return H.getExtension(_)!=null}function dX(H){try{if(rW(H)!=null)return!0}catch(_){return console.log("Error when getting WebGL context: ",_),!1}return!1}function dG(H){if(H===0)return!1;const _=rW(H);if(H===1){if(!dz(_,"OES_texture_float"))return!1}else if(!dz(_,"EXT_color_buffer_float"))return!1;return dj(_)}function du(H){if(H===0)return!1;const _=rW(H);if(H===1){if(!dz(_,"OES_texture_float")||!dz(_,"WEBGL_color_buffer_float"))return!1}else{if(dz(_,"EXT_color_buffer_float"))return dj(_);const b="EXT_color_buffer_half_float";if(dz(_,b)){const $=_.getExtension(b);return dL(_,$)}return!1}return dj(_)}function dj(H){const _=rH(H),b=H.createTexture();H.bindTexture(H.TEXTURE_2D,b),H.texImage2D(H.TEXTURE_2D,0,_.internalFormatFloat,1,1,0,_.textureFormatFloat,_.textureTypeFloat,null);const $=H.createFramebuffer();H.bindFramebuffer(H.FRAMEBUFFER,$),H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,b,0);const ee=H.checkFramebufferStatus(H.FRAMEBUFFER)===H.FRAMEBUFFER_COMPLETE;return H.bindTexture(H.TEXTURE_2D,null),H.bindFramebuffer(H.FRAMEBUFFER,null),H.deleteTexture(b),H.deleteFramebuffer($),ee}function dL(H,_){const b=rH(H,_),$=H.createTexture();H.bindTexture(H.TEXTURE_2D,$),H.texImage2D(H.TEXTURE_2D,0,b.internalFormatHalfFloat,1,1,0,b.textureFormatFloat,b.textureTypeHalfFloat,null);const ee=H.createFramebuffer();H.bindFramebuffer(H.FRAMEBUFFER,ee),H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,$,0);const re=H.checkFramebufferStatus(H.FRAMEBUFFER)===H.FRAMEBUFFER_COMPLETE;return H.bindTexture(H.TEXTURE_2D,null),H.bindFramebuffer(H.FRAMEBUFFER,null),H.deleteTexture($),H.deleteFramebuffer(ee),re}function dQ(H){return H!==2?!1:rW(H).fenceSync!=null}function dH(H,_){Array.isArray(H)||(H=[H]),H.forEach(b=>{b!=null&&k(b.dtype!=="complex64",()=>_+" does not support complex64 tensors in the WebGL backend.")})}const dK=qM();dK.registerFlag("HAS_WEBGL",()=>dK.getNumber("WEBGL_VERSION")>0),dK.registerFlag("WEBGL_VERSION",()=>dX(2)?2:dX(1)?1:0),dK.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),dK.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>dK.get("WEBGL_VERSION")===2),dK.registerFlag("WEBGL_CPU_FORWARD",()=>!0),dK.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),dK.registerFlag("WEBGL_PACK",()=>dK.getBool("HAS_WEBGL")),dK.registerFlag("WEBGL_PACK_NORMALIZATION",()=>dK.getBool("WEBGL_PACK")),dK.registerFlag("WEBGL_PACK_CLIP",()=>dK.getBool("WEBGL_PACK")),dK.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>dK.getBool("WEBGL_PACK")),dK.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>dK.getBool("WEBGL_PACK")),dK.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>dK.getBool("WEBGL_PACK")),dK.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>dK.getBool("WEBGL_PACK")),dK.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>dK.getBool("WEBGL_PACK")),dK.registerFlag("WEBGL_PACK_REDUCE",()=>dK.getBool("WEBGL_PACK")),dK.registerFlag("WEBGL_LAZILY_UNPACK",()=>dK.getBool("WEBGL_PACK")),dK.registerFlag("WEBGL_CONV_IM2COL",()=>dK.getBool("WEBGL_PACK")),dK.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>dK.getBool("WEBGL_PACK")),dK.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>da(dK.getNumber("WEBGL_VERSION"))),dK.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>dZ(dK.getNumber("WEBGL_VERSION"))),dK.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const H=dK.getNumber("WEBGL_VERSION");return H===0?0:de(H)}),dK.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>dK.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!fW()),dK.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>dG(dK.getNumber("WEBGL_VERSION"))),dK.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>dK.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:dK.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),dK.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>du(dK.getNumber("WEBGL_VERSION"))),dK.registerFlag("WEBGL_FENCE_API_ENABLED",()=>dQ(dK.getNumber("WEBGL_VERSION"))),dK.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>dK.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),dK.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,H=>{if(typeof H!="number")throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got "+H+".");if(H<0&&H!==-1)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got "+H+".")}),dK.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>fW()?1:-1,H=>{if(typeof H!="number")throw new Error("WEBGL_FLUSH_THRESHOLD must be a number but got "+H+".");if(H<0&&H!==-1)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got "+H+".")}),dK.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),dK.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),dK.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),dK.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),dK.registerFlag("WEBGL_EXP_CONV",()=>!1),dK.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>dK.getBool("IS_TEST")),dK.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),dK.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),dK.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),dK.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);function dB(){let H,_,b,$,ee,re,ae,xe,le,fe;return qM().getNumber("WEBGL_VERSION")===2?(H="#version 300 es",_="in",b="out",$="in",ee="texture",re="outputColor",ae="out vec4 outputColor;",xe=qM().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",le="",fe=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(H="",_="attribute",b="varying",$="varying",ee="texture2D",re="gl_FragColor",ae="",xe=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,le=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,fe=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:H,attribute:_,varyingVs:b,varyingFs:$,texture2D:ee,output:re,defineOutput:ae,defineSpecialNaN:xe,defineSpecialInf:le,defineRound:fe}}function dV(H,_,b="index"){const $=y(_);return $.map((ee,re)=>{const ae="int "+H[re]+" = "+b+" / "+ee,xe=re===$.length-1?"int "+H[re+1]+" = "+b+" - "+H[re]+" * "+ee:"index -= "+H[re]+" * "+ee;return ae+"; "+xe+";"}).join("")}function dJ(H,_,b="index"){const $=y(_);return $.map((ee,re)=>{const ae="int "+H[re]+" = "+b+" / outShapeStrides["+re+"]",xe=re===$.length-1?"int "+H[re+1]+" = "+b+" - "+H[re]+" * outShapeStrides["+re+"]":"index -= "+H[re]+" * outShapeStrides["+re+"]";return ae+"; "+xe+";"}).join("")}function dY(H,_){const b=H.length,$=H.map(re=>_+"["+re+"]"),ee=new Array(b-1);ee[b-2]=$[b-1];for(let re=b-3;re>=0;--re)ee[re]="("+ee[re+1]+" * "+$[re+1]+")";return ee}function dP(H,_,b="index"){const $=H.map((re,ae)=>ae),ee=dY($,_);return ee.map((re,ae)=>{const xe="int "+H[ae]+" = "+b+" / "+ee[ae],le=ae===ee.length-1?"int "+H[ae+1]+" = "+b+" - "+H[ae]+" * "+ee[ae]:"index -= "+H[ae]+" * "+ee[ae];return xe+"; "+le+";"}).join("")}function dU(H){const _=y(H).map(b=>b.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+_[0]+" + coords.y * "+_[1]+` + coords.z;
  }
`}function vq(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const vM=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`,{getBroadcastDims:vF}=uQ;function vW(H,_,b){const $=[];if(H.forEach(Ee=>{const Ce=i$1(Ee.shapeInfo.logicalShape);if(Ee.shapeInfo.isUniform?$.push("uniform float "+Ee.name+(Ce>1?"["+Ce+"]":"")+";"):($.push("uniform sampler2D "+Ee.name+";"),$.push("uniform int offset"+Ee.name+";")),b.enableShapeUniforms){const{uniformShape:Ie}=Cq(b.packedInputs,Ee.shapeInfo.logicalShape,Ee.shapeInfo.texShape);switch(Ie.length){case 1:$.push("uniform int "+Ee.name+"Shape;");break;case 2:$.push("uniform ivec2 "+Ee.name+"Shape;");break;case 3:$.push("uniform ivec3 "+Ee.name+"Shape;");break;case 4:$.push("uniform ivec4 "+Ee.name+"Shape;");break}$.push("uniform ivec2 "+Ee.name+"TexShape;")}}),b.enableShapeUniforms){switch(_.logicalShape.length){case 1:$.push("uniform int outShape;");break;case 2:$.push("uniform ivec2 outShape;"),$.push("uniform int outShapeStrides;");break;case 3:$.push("uniform ivec3 outShape;"),$.push("uniform ivec2 outShapeStrides;");break;case 4:$.push("uniform ivec4 outShape;"),$.push("uniform ivec3 outShapeStrides;");break}$.push("uniform ivec2 outTexShape;")}b.customUniforms&&b.customUniforms.forEach(Ee=>{$.push("uniform "+Ee.type+" "+Ee.name+(Ee.arrayIndex?"["+Ee.arrayIndex+"]":"")+";")});const ee=$.join(`
`),re=H.map(Ee=>vz(Ee,_,b.packedInputs,b.enableShapeUniforms)).join(`
`),ae=_.texShape,xe=dB(),le=vu(xe);let fe,ve,Se=vQ(xe);return _.isPacked?(fe=vX(_.logicalShape,ae,b.enableShapeUniforms),ve=vL(xe)):(fe=vG(_.logicalShape,ae,b.enableShapeUniforms),ve=vj(xe)),b.packedInputs&&(Se+=vV),[Se,le,ve,ee,fe,re,b.userCode].join(`
`)}function vD(H,_=!1){const b=H.shapeInfo.logicalShape;switch(b.length){case 0:return yz(H,_);case 1:return yG(H,_);case 2:return yj(H,_);case 3:return yQ(H,_);case 4:return yK(H,_);case 5:return yB(H);case 6:return yV(H);default:throw new Error(b.length+"-D input sampling is not yet supported")}}function vZ(H,_){switch(H.shapeInfo.logicalShape.length){case 0:return yZ(H);case 1:return yX(H,_);case 2:return yu(H,_);case 3:return yL(H,_);default:return yH(H,_)}}function vz(H,_,b=!1,$){let ee="";b?ee+=vZ(H,$):ee+=vD(H,$);const re=H.shapeInfo.logicalShape,ae=_.logicalShape;return re.length<=ae.length&&(b?ee+=yY(H,_):ee+=yP(H,_)),ee}function vX(H,_,b){switch(H.length){case 0:return vJ();case 1:return vY(H,_,b);case 2:return yW(H,_,b);case 3:return vU(H,_,b);default:return ys(H,_,b)}}function vG(H,_,b){switch(H.length){case 0:return vJ();case 1:return vP(H,_,b);case 2:return yD(H,_,b);case 3:return yq(H,_,b);case 4:return yM(H,_,b);case 5:return yF(H,_);case 6:return yt(H,_);default:throw new Error(H.length+"-D output sampling is not yet supported")}}function vu(H){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+H.texture2D+`(textureSampler, uv).r;
    }
  `}function vj(H){return`
    void setOutput(float val) {
      `+H.output+` = vec4(val, 0, 0, 0);
    }
  `}function vL(H){return`
    void setOutput(vec4 val) {
      `+H.output+` = val;
    }
  `}function vQ(H){return H.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+H.varyingFs+` vec2 resultUV;
    `+H.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+H.defineSpecialNaN+`
    `+H.defineSpecialInf+`
    `+H.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+vH+`
    `+vK+`
    `+vB+`
  `}const vH=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,vK=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,vB=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,vV=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function vJ(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function vY(H,_,b){const $=[Math.ceil(_[0]/2),Math.ceil(_[1]/2)];return $[0]===1?b?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+$[1]+`.0);
      }
    `:$[1]===1?b?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+$[0]+`.0);
      }
    `:b?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+$[0]+", "+$[1]+`));
      return 2 * (resTexRC.x * `+$[1]+` + resTexRC.y);
    }
  `}function vP(H,_,b){return _[0]===1?b?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * `+_[1]+`.0);
      }
    `:_[1]===1?b?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * `+_[0]+`.0);
      }
    `:b?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      return resTexRC.x * `+_[1]+` + resTexRC.y;
    }
  `}function vU(H,_,b){if(b)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const $=[Math.ceil(_[0]/2),Math.ceil(_[1]/2)],ee=Math.ceil(H[2]/2),re=ee*Math.ceil(H[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+$[0]+", "+$[1]+`));
      int index = resTexRC.x * `+$[1]+` + resTexRC.y;

      int b = index / `+re+`;
      index -= b * `+re+`;

      int r = 2 * (index / `+ee+`);
      int c = imod(index, `+ee+`) * 2;

      return ivec3(b, r, c);
    }
  `}function yq(H,_,b){if(b)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    `+dJ(["r","c","d"],H)+`
    return ivec3(r, c, d);
  }
`;const $=dV(["r","c","d"],H);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      `+$+`
      return ivec3(r, c, d);
    }
  `}function ys(H,_,b){if(b)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const $=[Math.ceil(_[0]/2),Math.ceil(_[1]/2)],ee=Math.ceil(H[H.length-1]/2),re=ee*Math.ceil(H[H.length-2]/2);let ae=re,xe="",le="b, r, c";for(let fe=2;fe<H.length-1;fe++)ae*=H[H.length-fe-1],xe=`
      int b`+fe+" = index / "+ae+`;
      index -= b`+fe+" * "+ae+`;
    `+xe,le="b"+fe+", "+le;return`
    ivec`+H.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+$[0]+", "+$[1]+`));
      int index = resTexRC.x * `+$[1]+` + resTexRC.y;

      `+xe+`

      int b = index / `+re+`;
      index -= b * `+re+`;

      int r = 2 * (index / `+ee+`);
      int c = imod(index, `+ee+`) * 2;

      return ivec`+H.length+"("+le+`);
    }
  `}function yM(H,_,b){if(b)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      `+dJ(["r","c","d","d2"],H)+`
      return ivec4(r, c, d, d2);
    }
  `;const $=dV(["r","c","d","d2"],H);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      `+$+`
      return ivec4(r, c, d, d2);
    }
  `}function yF(H,_){const b=dV(["r","c","d","d2","d3"],H);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+_[0]+`,
                             `+_[1]+`));

      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function yt(H,_){const b=dV(["r","c","d","d2","d3","d4"],H);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function yW(H,_,b){const $=[Math.ceil(_[0]/2),Math.ceil(_[1]/2)];if(D(H,_))return b?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+$[0]+", "+$[1]+`));
      }
    `;const ee=Math.ceil(H[1]/2);return b?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+$[0]+", "+$[1]+`));

      int index = resTexRC.x * `+$[1]+` + resTexRC.y;
      int r = 2 * (index / `+ee+`);
      int c = imod(index, `+ee+`) * 2;

      return ivec2(r, c);
    }
  `}function yD(H,_,b){return D(H,_)?b?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+_[0]+", "+_[1]+`));
      }
    `:H[1]===1?b?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+_[0]+", "+_[1]+`));
        int index = resTexRC.x * `+_[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:H[0]===1?b?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+_[0]+", "+_[1]+`));
        int index = resTexRC.x * `+_[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:b?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+_[0]+", "+_[1]+`));
      int index = resTexRC.x * `+_[1]+` + resTexRC.y;
      int r = index / `+H[1]+`;
      int c = index - r * `+H[1]+`;
      return ivec2(r, c);
    }
  `}function ya(H){return"offset"+H}function yZ(H){const _=H.name,b="get"+_.charAt(0).toUpperCase()+_.slice(1),$=dB();return`
    vec4 `+b+`() {
      return `+$.texture2D+"("+_+`, halfCR);
    }
  `}function yz(H,_){const b=H.name,$="get"+b.charAt(0).toUpperCase()+b.slice(1);if(H.shapeInfo.isUniform)return"float "+$+"() {return "+b+";}";const[ee,re]=H.shapeInfo.texShape;if(ee===1&&re===1)return`
      float `+$+`() {
        return sampleTexture(`+b+`, halfCR);
      }
    `;const ae=ya(b);if(_)return`
    float `+$+`() {
      vec2 uv = uvFromFlat(`+b+"TexShape[0], "+b+"TexShape[1], "+ae+`);
      return sampleTexture(`+b+`, uv);
    }
  `;const[xe,le]=H.shapeInfo.texShape;return`
    float `+$+`() {
      vec2 uv = uvFromFlat(`+xe+", "+le+", "+ae+`);
      return sampleTexture(`+b+`, uv);
    }
  `}function yX(H,_){const b=H.name,$="get"+b.charAt(0).toUpperCase()+b.slice(1),ee=H.shapeInfo.texShape,re=dB();if(_)return`
    vec4 `+$+`(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(`+b+"TexShape[0]) / 2.0), ceil(float("+b+`TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return `+re.texture2D+"("+b+`, uv);
    }
  `;const ae=[Math.ceil(ee[0]/2),Math.ceil(ee[1]/2)];return`
    vec4 `+$+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+ae[0]+", "+ae[1]+`, index);
      return `+re.texture2D+"("+b+`, uv);
    }
  `}function yG(H,_){const b=H.name,$="get"+b.charAt(0).toUpperCase()+b.slice(1);if(H.shapeInfo.isUniform)return`
      float `+$+`(int index) {
        `+yJ(H)+`
      }
    `;const ee=H.shapeInfo.texShape,re=ee[0],ae=ee[1];if(ae===1&&re===1)return`
      float `+$+`(int index) {
        return sampleTexture(`+b+`, halfCR);
      }
    `;const xe=ya(b);return ae===1?_?`
      float `+$+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+xe+") + 0.5) / float("+b+`TexShape[0]));
        return sampleTexture(`+b+`, uv);
      }
    `:`
      float `+$+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+xe+") + 0.5) / "+re+`.0);
        return sampleTexture(`+b+`, uv);
      }
    `:re===1?_?`
      float `+$+`(int index) {
        vec2 uv = vec2((float(index + `+xe+") + 0.5) / float("+b+`TexShape[1]), 0.5);
        return sampleTexture(`+b+`, uv);
      }
    `:`
      float `+$+`(int index) {
        vec2 uv = vec2((float(index + `+xe+") + 0.5) / "+ae+`.0, 0.5);
        return sampleTexture(`+b+`, uv);
      }
    `:_?`
    float `+$+`(int index) {
      vec2 uv = uvFromFlat(`+b+"TexShape[0], "+b+"TexShape[1], index + "+xe+`);
      return sampleTexture(`+b+`, uv);
    }
  `:`
    float `+$+`(int index) {
      vec2 uv = uvFromFlat(`+re+", "+ae+", index + "+xe+`);
      return sampleTexture(`+b+`, uv);
    }
  `}function yu(H,_){const b=H.shapeInfo.logicalShape,$=H.name,ee="get"+$.charAt(0).toUpperCase()+$.slice(1),re=H.shapeInfo.texShape,ae=re[0],xe=re[1],le=dB();if(re!=null&&D(b,re))return _?`
      vec4 `+ee+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+$+"TexShape[1], "+$+`TexShape[0]);

        return `+le.texture2D+"("+$+`, uv);
      }
    `:`
      vec4 `+ee+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+xe+".0, "+ae+`.0);

        return `+le.texture2D+"("+$+`, uv);
      }
    `;if(_)return`
    vec4 `+ee+`(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(`+$+"TexShape[0]) / 2.0), ceil(float("+$+`TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(`+$+`Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return `+le.texture2D+"("+$+`, uv);
    }
  `;const fe=[Math.ceil(re[0]/2),Math.ceil(re[1]/2)],ve=Math.ceil(b[1]/2);return`
    vec4 `+ee+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+ve+", "+fe[0]+", "+fe[1]+`, row, col);
      return `+le.texture2D+"("+$+`, uv);
    }
  `}function yj(H,_){const b=H.shapeInfo.logicalShape,$=H.name,ee="get"+$.charAt(0).toUpperCase()+$.slice(1),re=H.shapeInfo.texShape;if(re!=null&&D(b,re)){if(_)return`
      float `+ee+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+$+"TexShape[1], "+$+`TexShape[0]);
        return sampleTexture(`+$+`, uv);
      }
    `;const Ee=re[0],Ce=re[1];return`
    float `+ee+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+Ce+".0, "+Ee+`.0);
      return sampleTexture(`+$+`, uv);
    }
  `}const{newShape:ae,keptDims:xe}=c$1(b),le=ae;if(le.length<b.length){const Ee=CM(H,le),Ce=["row","col"];return`
      `+vD(Ee,_)+`
      float `+ee+`(int row, int col) {
        return `+ee+"("+CF(Ce,xe)+`);
      }
    `}if(H.shapeInfo.isUniform)return`
      float `+ee+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+b[1]+`, 1)));
        `+yJ(H)+`
      }
    `;const fe=re[0],ve=re[1],Se=ya($);return ve===1?_?`
      float `+ee+`(int row, int col) {
        float index = dot(vec3(row, col, `+Se+"), vec3("+$+`Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(`+$+`TexShape[0]));
        return sampleTexture(`+$+`, uv);
      }
    `:`
    float `+ee+`(int row, int col) {
      float index = dot(vec3(row, col, `+Se+"), vec3("+b[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+fe+`.0);
      return sampleTexture(`+$+`, uv);
    }
  `:fe===1?_?`
      float `+ee+`(int row, int col) {
        float index = dot(vec3(row, col, `+Se+"), vec3("+$+`Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(`+$+`TexShape[1]), 0.5);
        return sampleTexture(`+$+`, uv);
      }
    `:`
    float `+ee+`(int row, int col) {
      float index = dot(vec3(row, col, `+Se+"), vec3("+b[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+ve+`.0, 0.5);
      return sampleTexture(`+$+`, uv);
    }
  `:_?`
      float `+ee+`(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+$+"Shape[1] + col + "+Se+`;
        vec2 uv = uvFromFlat(`+$+"TexShape[0], "+$+`TexShape[1], index);
        return sampleTexture(`+$+`, uv);
      }
    `:`
  float `+ee+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+b[1]+" + col + "+Se+`;
    vec2 uv = uvFromFlat(`+fe+", "+ve+`, index);
    return sampleTexture(`+$+`, uv);
  }
`}function yL(H,_){const b=H.shapeInfo.logicalShape,$=H.name,ee="get"+$.charAt(0).toUpperCase()+$.slice(1),re=H.shapeInfo.texShape,ae=[Math.ceil(re[0]/2),Math.ceil(re[1]/2)];if(b[0]===1){const Ee=b.slice(1),Ce=[1,2],Ie=CM(H,Ee),De=["b","row","col"];return`
        `+vZ(Ie,_)+`
        vec4 `+ee+`(int b, int row, int col) {
          return `+ee+"("+CF(De,Ce)+`);
        }
      `}const xe=dB();if(_)return`
    vec4 `+ee+`(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(`+$+"TexShape[0]) / 2.0), ceil(float("+$+`TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(`+$+`Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(`+$+`Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return `+xe.texture2D+"("+$+`, uv);
    }
  `;const le=ae[0],fe=ae[1],ve=Math.ceil(b[2]/2),Se=ve*Math.ceil(b[1]/2);return`
    vec4 `+ee+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+le+", "+fe+", "+Se+", "+ve+`, b, row, col);
      return `+xe.texture2D+"("+$+`, uv);
    }
  `}function yQ(H,_){const b=H.shapeInfo.logicalShape,$=H.name,ee="get"+$.charAt(0).toUpperCase()+$.slice(1),re=b[1]*b[2],ae=b[2],{newShape:xe,keptDims:le}=c$1(b),fe=xe;if(fe.length<b.length){const De=CM(H,fe),Be=["row","col","depth"];return`
        `+vD(De,_)+`
        float `+ee+`(int row, int col, int depth) {
          return `+ee+"("+CF(Be,le)+`);
        }
      `}if(H.shapeInfo.isUniform)return`
      float `+ee+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+re+", "+ae+`, 1)));
        `+yJ(H)+`
      }
    `;const ve=H.shapeInfo.texShape,Se=ve[0],Ee=ve[1],Ce=H.shapeInfo.flatOffset;if(Ee===re&&Ce==null)return _?`
      float `+ee+`(int row, int col, int depth) {
        int stride1 = `+$+`Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+$+"TexShape[1], "+$+`TexShape[0]);
        return sampleTexture(`+$+`, uv);
      }
    `:`
        float `+ee+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+ae+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+Ee+".0, "+Se+`.0);
          return sampleTexture(`+$+`, uv);
        }
      `;if(Ee===ae&&Ce==null)return _?`
      float `+ee+`(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(`+$+`Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+$+"TexShape[1], "+$+`TexShape[0]);
        return sampleTexture(`+$+`, uv);
      }
    `:`
    float `+ee+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+b[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+Ee+".0, "+Se+`.0);
      return sampleTexture(`+$+`, uv);
    }
  `;const Ie=ya($);return _?`
    float `+ee+`(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = `+$+"Shape[1] * "+$+`Shape[2];
      int stride1 = `+$+`Shape[2];
      int index = row * stride0 + col * stride1 + depth + `+Ie+`;
      vec2 uv = uvFromFlat(`+$+"TexShape[0], "+$+`TexShape[1], index);
      return sampleTexture(`+$+`, uv);
    }
    `:`
      float `+ee+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+re+" + col * "+ae+" + depth + "+Ie+`;
        vec2 uv = uvFromFlat(`+Se+", "+Ee+`, index);
        return sampleTexture(`+$+`, uv);
      }
  `}function yH(H,_){const b=H.name,$="get"+b.charAt(0).toUpperCase()+b.slice(1),ee=dB();if(_)return`
    vec4 `+$+`(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(`+b+`Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(`+b+`Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= `+b+`Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(`+b+"TexShape[0]) / 2.0), ceil(float("+b+`TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return `+ee.texture2D+"("+b+`, uv);
    }
  `;const re=H.shapeInfo.logicalShape,ae=re.length,xe=H.shapeInfo.texShape,le=[Math.ceil(xe[0]/2),Math.ceil(xe[1]/2)],fe=le[0],ve=le[1],Se=Math.ceil(re[ae-1]/2);let Ee=Se*Math.ceil(re[ae-2]/2),Ce="int b, int row, int col",Ie="b * "+Ee+" + (row / 2) * "+Se+" + (col / 2)";for(let De=2;De<ae-1;De++)Ce="int b"+De+", "+Ce,Ee*=re[ae-De-1],Ie="b"+De+" * "+Ee+" + "+Ie;return`
    vec4 `+$+"("+Ce+`) {
      int index = `+Ie+`;
      int texR = index / `+ve+`;
      int texC = index - texR * `+ve+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+ve+", "+fe+`);
      return `+ee.texture2D+"("+b+`, uv);
    }
  `}function yK(H,_){const b=H.shapeInfo.logicalShape,$=H.name,ee="get"+$.charAt(0).toUpperCase()+$.slice(1),re=b[3],ae=b[2]*re,xe=b[1]*ae,{newShape:le,keptDims:fe}=c$1(b);if(le.length<b.length){const qe=CM(H,le),Xe=["row","col","depth","depth2"];return`
      `+vD(qe,_)+`
      float `+ee+`(int row, int col, int depth, int depth2) {
        return `+ee+"("+CF(Xe,fe)+`);
      }
    `}if(H.shapeInfo.isUniform)return`
      float `+ee+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+xe+", "+ae+", "+re+`, 1)));
        `+yJ(H)+`
      }
    `;const ve=H.shapeInfo.flatOffset,Se=H.shapeInfo.texShape,Ee=Se[0],Ce=Se[1],Ie="int stride2 = "+$+"Shape[3];",De="int stride1 = "+$+"Shape[2] * stride2;",Be="int stride0 = "+$+"Shape[1] * stride1;";if(Ce===xe&&ve==null)return _?`
      float `+ee+`(int row, int col, int depth, int depth2) {
        `+Ie+`
        `+De+`
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+$+"TexShape[1], "+$+`TexShape[0]);
        return sampleTexture(`+$+`, uv);
      }
    `:`
      float `+ee+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+ae+", "+re+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+Ce+".0, "+Ee+`.0);
        return sampleTexture(`+$+`, uv);
      }
    `;if(Ce===re&&ve==null)return _?`
      float `+ee+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+$+"Shape[1] * "+$+"Shape[2], "+$+`Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+$+"TexShape[1], "+$+`TexShape[0]);
        return sampleTexture(`+$+`, uv);
      }
    `:`
      float `+ee+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+b[1]*b[2]+", "+b[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+Ce+".0, "+Ee+`.0);
        return sampleTexture(`+$+`, uv);
      }
    `;const Ne=ya($);return _?`
    float `+ee+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      `+Ie+`
      `+De+`
      `+Be+`
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(`+$+"TexShape[0], "+$+"TexShape[1], index + "+Ne+`);
      return sampleTexture(`+$+`, uv);
    }
  `:`
    float `+ee+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+xe+" + col * "+ae+` +
          depth * `+re+` + depth2;
      vec2 uv = uvFromFlat(`+Ee+", "+Ce+", index + "+Ne+`);
      return sampleTexture(`+$+`, uv);
    }
  `}function yB(H){const _=H.shapeInfo.logicalShape,b=H.name,$="get"+b.charAt(0).toUpperCase()+b.slice(1),ee=_[4],re=_[3]*ee,ae=_[2]*re,xe=_[1]*ae,{newShape:le,keptDims:fe}=c$1(_);if(le.length<_.length){const De=CM(H,le),Be=["row","col","depth","depth2","depth3"];return`
      `+vD(De)+`
      float `+$+`(int row, int col, int depth, int depth2, int depth3) {
        return `+$+"("+CF(Be,fe)+`);
      }
    `}if(H.shapeInfo.isUniform)return`
      float `+$+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+xe+", "+ae+", "+re+", "+ee+`)) +
          depth3;
        `+yJ(H)+`
      }
    `;const ve=H.shapeInfo.flatOffset,Se=H.shapeInfo.texShape,Ee=Se[0],Ce=Se[1];if(Ce===xe&&ve==null)return`
      float `+$+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+ae+", "+re+", "+ee+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+Ce+".0, "+Ee+`.0);
        return sampleTexture(`+b+`, uv);
      }
    `;if(Ce===ee&&ve==null)return`
      float `+$+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+_[1]*_[2]*_[3]+`,
               `+_[2]*_[3]+", "+_[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+Ce+".0, "+Ee+`.0);
        return sampleTexture(`+b+`, uv);
      }
    `;const Ie=ya(b);return`
    float `+$+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+xe+" + col * "+ae+" + depth * "+re+` +
          depth2 * `+ee+" + depth3 + "+Ie+`;
      vec2 uv = uvFromFlat(`+Ee+", "+Ce+`, index);
      return sampleTexture(`+b+`, uv);
    }
  `}function yV(H){const _=H.shapeInfo.logicalShape,b=H.name,$="get"+b.charAt(0).toUpperCase()+b.slice(1),{newShape:ee,keptDims:re}=c$1(_);if(ee.length<_.length){const Be=CM(H,ee),Ne=["row","col","depth","depth2","depth3","depth4"];return`
      `+vD(Be)+`
      float `+$+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+$+"("+CF(Ne,re)+`);
      }
    `}const ae=_[5],xe=_[4]*ae,le=_[3]*xe,fe=_[2]*le,ve=_[1]*fe;if(H.shapeInfo.isUniform)return`
      float `+$+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+ve+", "+fe+", "+le+", "+xe+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+ae+`, 1)));
        `+yJ(H)+`
      }
    `;const Se=H.shapeInfo.flatOffset,Ee=H.shapeInfo.texShape,Ce=Ee[0],Ie=Ee[1];if(Ie===ve&&Se==null)return`
      float `+$+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+fe+", "+le+", "+xe+", "+ae+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+Ie+".0, "+Ce+`.0);
        return sampleTexture(`+b+`, uv);
      }
    `;if(Ie===ae&&Se==null)return`
      float `+$+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+_[1]*_[2]*_[3]*_[4]+`,
               `+_[2]*_[3]*_[4]+`,
               `+_[3]*_[4]+`,
               `+_[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+Ie+".0, "+Ce+`.0);
        return sampleTexture(`+b+`, uv);
      }
    `;const De=ya(b);return`
    float `+$+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+ve+" + col * "+fe+" + depth * "+le+` +
          depth2 * `+xe+" + depth3 * "+ae+" + depth4 + "+De+`;
      vec2 uv = uvFromFlat(`+Ce+", "+Ie+`, index);
      return sampleTexture(`+b+`, uv);
    }
  `}function yJ(H){const _=H.name,b=i$1(H.shapeInfo.logicalShape);return b<2?"return "+_+";":`
    for (int i = 0; i < `+b+`; i++) {
      if (i == index) {
        return `+_+`[i];
      }
    }
  `}function yY(H,_){const b=H.name,$=b.charAt(0).toUpperCase()+b.slice(1),ee="get"+$+"AtOutCoords",re=H.shapeInfo.logicalShape.length,ae=_.logicalShape.length,xe=vF(H.shapeInfo.logicalShape,_.logicalShape),le=yU(ae),fe=ae-re;let ve;const Se=["x","y","z","w","u","v"];re===0?ve="":ae<2&&xe.length>=1?ve="coords = 0;":ve=xe.map(Be=>"coords."+Se[Be+fe]+" = 0;").join(`
`);let Ee="";ae<2&&re>0?Ee="coords":Ee=H.shapeInfo.logicalShape.map((Be,Ne)=>"coords."+Se[Ne+fe]).join(", ");let Ce="return outputValue;";const Ie=i$1(H.shapeInfo.logicalShape)===1,De=i$1(_.logicalShape)===1;if(re===1&&!Ie&&!De)Ce=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(Ie&&!De)ae===1?Ce=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:Ce=`
        return vec4(outputValue.x);
      `;else if(xe.length){const Be=re-2,Ne=re-1;xe.indexOf(Be)>-1&&xe.indexOf(Ne)>-1?Ce="return vec4(outputValue.x);":xe.indexOf(Be)>-1?Ce="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":xe.indexOf(Ne)>-1&&(Ce="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 `+ee+`() {
      `+le+` coords = getOutputCoords();
      `+ve+`
      vec4 outputValue = get`+$+"("+Ee+`);
      `+Ce+`
    }
  `}function yP(H,_){const b=H.name,$=b.charAt(0).toUpperCase()+b.slice(1),ee="get"+$+"AtOutCoords",re=_.texShape,ae=H.shapeInfo.texShape,xe=H.shapeInfo.logicalShape.length,le=_.logicalShape.length;if(!H.shapeInfo.isUniform&&xe===le&&H.shapeInfo.flatOffset==null&&D(ae,re))return`
      float `+ee+`() {
        return sampleTexture(`+b+`, resultUV);
      }
    `;const fe=yU(le),ve=vF(H.shapeInfo.logicalShape,_.logicalShape),Se=le-xe;let Ee;const Ce=["x","y","z","w","u","v"];xe===0?Ee="":le<2&&ve.length>=1?Ee="coords = 0;":Ee=ve.map(De=>"coords."+Ce[De+Se]+" = 0;").join(`
`);let Ie="";return le<2&&xe>0?Ie="coords":Ie=H.shapeInfo.logicalShape.map((De,Be)=>"coords."+Ce[Be+Se]).join(", "),`
    float `+ee+`() {
      `+fe+` coords = getOutputCoords();
      `+Ee+`
      return get`+$+"("+Ie+`);
    }
  `}function yU(H){if(H<=1)return"int";if(H===2)return"ivec2";if(H===3)return"ivec3";if(H===4)return"ivec4";if(H===5)return"ivec5";if(H===6)return"ivec6";throw Error("GPU for rank "+H+" is not yet supported")}function Cq(H,_,b){const{newShape:$,keptDims:ee}=c$1(_),re=_.length,ae=H&&re===3&&_[0]===1,xe=ae?_.slice(1):$,le=!H&&re>1&&!D(_,b)&&$.length<re||ae;return{useSqueezeShape:le,uniformShape:le?xe:_,keptDims:ee}}function CM(H,_){const b=JSON.parse(JSON.stringify(H));return b.shapeInfo.logicalShape=_,b}function CF(H,_){return _.map(b=>H[b]).join(", ")}function CW(H,_,b,$){const ee=b.map((ve,Se)=>{const Ee={logicalShape:ve.shape,texShape:ve.isUniform?null:ve.texData.texShape,isUniform:ve.isUniform,isPacked:ve.isUniform?!1:ve.texData.isPacked,flatOffset:null};return ve.texData!=null&&ve.texData.slice!=null&&ve.texData.slice.flatOffset>0&&(Ee.flatOffset=ve.texData.slice.flatOffset),{name:_.variableNames[Se],shapeInfo:Ee}}),re=ee.map(ve=>ve.shapeInfo),ae={logicalShape:$.shape,texShape:$.texData.texShape,isUniform:!1,isPacked:$.texData.isPacked,flatOffset:null},xe=vW(ee,ae,_),le=QM(H.gl,xe),fe=H.createProgram(le);return qM().get("ENGINE_COMPILE_ONLY")?{program:_,fragmentShader:le,source:xe,webGLProgram:fe,inShapeInfos:re,outShapeInfo:ae,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(H.buildVao(fe),Object.assign({program:_,fragmentShader:le,source:xe,webGLProgram:fe,inShapeInfos:re,outShapeInfo:ae},CD(H,_,fe)))}function CD(H,_,b){const $=[],ee=[];let re,ae,xe,le=null,fe=null;fe=H.getUniformLocation(b,"NAN",!1),qM().getNumber("WEBGL_VERSION")===1&&(le=H.getUniformLocation(b,"INFINITY",!1));const ve=!1;for(const Se of _.variableNames){const Ee={name:Se,uniform:H.getUniformLocation(b,Se,ve),offset:H.getUniformLocation(b,"offset"+Se,ve)};_.enableShapeUniforms&&(Ee.shape=H.getUniformLocation(b,Se+"Shape",ve),Ee.texShape=H.getUniformLocation(b,Se+"TexShape",ve)),$.push(Ee)}if(_.enableShapeUniforms&&(re=H.getUniformLocation(b,"outShape",ve),xe=H.getUniformLocation(b,"outShapeStrides",ve),ae=H.getUniformLocation(b,"outTexShape",ve)),_.customUniforms)for(const Se of _.customUniforms)ee.push(H.getUniformLocation(b,Se.name,ve));return{variablesLocations:$,customUniformLocations:ee,infLoc:le,nanLoc:fe,outShapeLocation:re,outShapeStridesLocation:xe,outTexShapeLocation:ae}}function CZ(H,_){if(H.length!==_.length)throw Error("Binary was compiled with "+H.length+" inputs, but was executed with "+_.length+" inputs");H.forEach((b,$)=>{const ee=b.logicalShape,re=_[$],ae=re.shape;if(!D(ee,ae))throw Error("Binary was compiled with different shapes than the current args. Shapes "+ee+" and "+ae+" must match");if(b.isUniform&&re.isUniform)return;const xe=b.texShape,le=re.isUniform?null:re.texData.texShape;if(!D(xe,le))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+xe+" and "+le+" must match")})}function Cz(H,_,b,$,ee){_.program.enableShapeUniforms||(CZ(_.inShapeInfos,b),CZ([_.outShapeInfo],[$]));const re=$.texData.texture,ae=$.texData.texShape;$.texData.isPacked?H.setOutputPackedMatrixTexture(re.texture,ae[0],ae[1]):H.setOutputMatrixTexture(re.texture,ae[0],ae[1]),H.setProgram(_.webGLProgram),H.bindVertexArray(_.webGLProgram.vao),qM().getNumber("WEBGL_VERSION")===1&&_.infLoc!==null&&H.gl.uniform1f(_.infLoc,1/0),_.nanLoc!==null&&H.gl.uniform1f(_.nanLoc,NaN);for(let le=0;le<b.length;++le){const fe=b[le],{uniform:ve,offset:Se,shape:Ee,texShape:Ce}=_.variablesLocations[le];if(Ee){const{uniformShape:Ie}=Cq(_.program.packedInputs,fe.shape,fe.texData.texShape);switch(Ie.length){case 1:H.gl.uniform1iv(Ee,new Int32Array(Ie));break;case 2:H.gl.uniform2iv(Ee,new Int32Array(Ie));break;case 3:H.gl.uniform3iv(Ee,new Int32Array(Ie));break;case 4:H.gl.uniform4iv(Ee,new Int32Array(Ie));break}}if(Ce&&H.gl.uniform2i(Ce,fe.texData.texShape[0],fe.texData.texShape[1]),ve!=null){if(fe.isUniform){if(i$1(fe.shape)<2)H.gl.uniform1f(ve,fe.uniformValues[0]);else{let Ie=fe.uniformValues;Ie instanceof Float32Array||(Ie=new Float32Array(Ie)),H.gl.uniform1fv(ve,Ie)}continue}fe.texData.slice!=null&&Se!=null&&H.gl.uniform1i(Se,fe.texData.slice.flatOffset),H.setInputMatrixTexture(fe.texData.texture.texture,ve,le)}}const xe=_.outShapeLocation;if(xe)switch($.shape.length){case 1:H.gl.uniform1iv(xe,new Int32Array($.shape));break;case 2:H.gl.uniform2iv(xe,new Int32Array($.shape));break;case 3:H.gl.uniform3iv(xe,new Int32Array($.shape));break;case 4:H.gl.uniform4iv(xe,new Int32Array($.shape));break}if(_.outShapeStridesLocation){const le=y($.shape);switch($.shape.length){case 2:H.gl.uniform1iv(_.outShapeStridesLocation,new Int32Array(le));break;case 3:H.gl.uniform2iv(_.outShapeStridesLocation,new Int32Array(le));break;case 4:H.gl.uniform3iv(_.outShapeStridesLocation,new Int32Array(le));break}}if(_.outTexShapeLocation&&H.gl.uniform2i(_.outTexShapeLocation,$.texData.texShape[0],$.texData.texShape[1]),_.program.customUniforms&&ee)for(let le=0;le<_.program.customUniforms.length;++le){const fe=_.program.customUniforms[le],ve=_.customUniformLocations[le],Se=ee[le];if(fe.type==="float")H.gl.uniform1fv(ve,Se);else if(fe.type==="vec2")H.gl.uniform2fv(ve,Se);else if(fe.type==="vec3")H.gl.uniform3fv(ve,Se);else if(fe.type==="vec4")H.gl.uniform4fv(ve,Se);else if(fe.type==="int")H.gl.uniform1iv(ve,Se);else if(fe.type==="ivec2")H.gl.uniform2iv(ve,Se);else if(fe.type==="ivec3")H.gl.uniform3iv(ve,Se);else if(fe.type==="ivec4")H.gl.uniform4iv(ve,Se);else throw Error("uniform type "+fe.type+" is not supported yet.")}H.executeProgram()}function CX(H,_,b){let $="";_.concat(b).forEach(ae=>{const xe=ae.texData!=null&&ae.texData.slice!=null&&ae.texData.slice.flatOffset>0;if(H.enableShapeUniforms&&!ae.isUniform){const le=ae.texData.texShape,{useSqueezeShape:fe,uniformShape:ve,keptDims:Se}=Cq(H.packedInputs,ae.shape,le);let Ee="",Ce="",Ie="";if(ve.length===1&&H.packedInputs){const Qe=[Math.ceil(le[0]/2),Math.ceil(le[1]/2)];Ee=(Qe[0]>1)+"_"+(Qe[1]>1)}else if(ve.length===2&&!H.packedInputs)Ce=(ve[0]>1)+"_"+(ve[1]>1);else if(ve.length>2&&!H.packedInputs){const Qe=y(ve);Ie=(Qe[0]===le[1])+"_"+(Qe[Qe.length-1]===le[1])}const De=ae.shape.length,Be=ve.length===2&&D(ae.shape,le),Ne=i$1(ae.shape)===1,qe=Oj(ae.shape,b.shape),Xe=!H.packedInputs&&De===b.shape.length&&D(le,b.texData.texShape),Ye=H.packedInputs||ve.length>2?"":(le[0]>1)+"_"+(le[1]>1);$+=De+"_"+Xe+"_"+(fe?Se:"")+"_"+ve.length+"_"+Ne+"_"+qe+"_"+Be+"_"+Ee+"_"+Ce+"_"+Ie+"_"+Ye+"_"+xe}else{const le=ae.isUniform?"uniform":ae.texData.texShape;$+=ae.shape+"_"+le+"_"+xe}});const ee=H.userCode;let re=H.constructor.name;return re+="_"+$+"_"+ee+(""+qM().getNumber("WEBGL_VERSION")),re}function CG(H){return qM().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&H<=4}class Cu{constructor(_){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=rz.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const b=dB();this.outputShape=_,this.enableShapeUniforms=CG(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+(this.enableShapeUniforms?dJ(["r","c","d"],_):dV(["r","c","d"],_))+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+b.output+` = result;
      }
    `}}class Cj{constructor(_){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=rz.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const b=dB();this.outputShape=_,this.enableShapeUniforms=CG(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+(this.enableShapeUniforms?dJ(["r","c","d"],_):dV(["r","c","d"],_))+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+b.output+` = result;
      }
    `}}class CL{constructor(_){this.variableNames=["A"],this.outTexUsage=rX.DOWNLOAD;const b=dB();this.outputShape=_,this.userCode=`
      `+vM+`

      void main() {
        float x = getAAtOutCoords();
        `+b.output+` = encode_float(x);
      }
    `}}class CQ{constructor(_){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=rX.DOWNLOAD;const b=dB();this.outputShape=_,this.userCode=`
      `+vM+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+b.output+` = encode_float(x);
      }
    `}}const CH={R:0,G:1,B:2,A:3};class CK{constructor(_,b=!1,$="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const ee=dB();this.outputShape=_,this.enableShapeUniforms=CG(this.outputShape.length);let re="result";b&&(re="floor(result * 255. + 0.5)");let ae="";for(let xe=0;xe<$.length;xe++){const le=$[xe];ae+=`
          if(offset == `+xe+`) {
            result = values[`+CH[le]+`];
          }`}this.userCode=`
      `+(this.enableShapeUniforms?vq():dU(_))+`

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, `+$.length+`);

        flatIndex = idiv(flatIndex, `+$.length+`, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = `+ee.texture2D+`(A, uv);
          `+ae+`
        }
        `+ee.output+" = vec4("+re+`, 0., 0., 0.);
      }
    `}}class CB{constructor(_,b=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const $=dB();this.outputShape=_,this.enableShapeUniforms=CG(this.outputShape.length);let ee="",re="result";b&&(re="floor(result * 255. + 0.5)");for(let ae=0;ae<=1;ae++)for(let xe=0;xe<=1;xe++){const le=ae*2+xe;ee+=`
          localCoords = coords;
          if(localCoords[2] + `+xe+" < "+(this.enableShapeUniforms?"outShape[2]":""+_[2])+`) {
          localCoords[2] += `+xe+`;
          if (localCoords[1] + `+ae+" < "+(this.enableShapeUniforms?"outShape[1]":""+_[1])+`) {
            localCoords[1] += `+ae+`;

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = `+$.texture2D+`(A, uv);

            if (offset == 0) {
              result[`+le+`] = values[0];
            } else if (offset == 1) {
              result[`+le+`] = values[1];
            } else if (offset == 2) {
              result[`+le+`] = values[2];
            } else {
              result[`+le+`] = values[3];
            }
          }
        }
        `}this.userCode=`
        `+(this.enableShapeUniforms?vq():dU(_))+`

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          `+ee+`

          `+$.output+" = "+re+`;
        }
    `}}function CV(H){const _=dB(),b=_.version+`
    precision highp float;
    `+_.attribute+` vec3 clipSpacePos;
    `+_.attribute+` vec2 uv;
    `+_.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return Qq(H,b)}function CJ(H){const _=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Qz(H,_)}function CY(H){const _=new Uint16Array([0,1,2,2,1,3]);return QX(H,_)}function CP(H,_,b,$,ee,re){Qj(_,b);const ae=QG(H),xe=H.TEXTURE_2D;return rK(H,()=>H.bindTexture(xe,ae)),rK(H,()=>H.texParameteri(xe,H.TEXTURE_WRAP_S,H.CLAMP_TO_EDGE)),rK(H,()=>H.texParameteri(xe,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE)),rK(H,()=>H.texParameteri(xe,H.TEXTURE_MIN_FILTER,H.NEAREST)),rK(H,()=>H.texParameteri(xe,H.TEXTURE_MAG_FILTER,H.NEAREST)),qM().getNumber("WEBGL_VERSION")===1?rK(H,()=>H.texImage2D(xe,0,$,_,b,0,ee,re,null)):rK(H,()=>H.texStorage2D(xe,1,$,_,b)),rK(H,()=>H.bindTexture(H.TEXTURE_2D,null)),{texture:ae,texShape:[b,_]}}function CU(H){return H.internalFormatFloat}function l1(H,_,b,$){const[ee,re]=ru(_,b);return CP(H,ee,re,CU($),$.textureFormatFloat,H.FLOAT)}function lq(H){return H.internalFormatHalfFloat}function ln(H,_,b,$){const[ee,re]=ru(_,b);return CP(H,ee,re,lq($),$.textureFormatFloat,$.textureTypeHalfFloat)}function lM(H){return H.downloadTextureFormat}function lF(H,_,b,$){const[ee,re]=ru(_,b);return CP(H,ee,re,lM($),H.RGBA,H.UNSIGNED_BYTE)}function lW(H){return H.internalFormatPackedFloat}function lD(H,_,b,$){const[ee,re]=ro(_,b);return CP(H,ee,re,lW($),H.RGBA,H.FLOAT)}function la(H){return H.internalFormatPackedHalfFloat}function lZ(H,_,b,$){const[ee,re]=ro(_,b);return CP(H,ee,re,la($),H.RGBA,$.textureTypeHalfFloat)}function lz(H,_,b){return rK(H,()=>H.bindBuffer(H.ARRAY_BUFFER,b)),QR(H,_,"clipSpacePos",b,3,20,0)&&QR(H,_,"uv",b,2,20,12)}function lX(H,_,b,$,ee,re){rK(H,()=>H.bindTexture(H.TEXTURE_2D,_));let ae,xe,le;ee instanceof Uint8Array?(ae=new Uint8Array(b*$*4),xe=H.UNSIGNED_BYTE,le=H.RGBA):(ae=new Float32Array(b*$*4),xe=H.FLOAT,le=re.internalFormatPackedFloat),ae.set(ee),qM().getNumber("WEBGL_VERSION")===2?rK(H,()=>H.texSubImage2D(H.TEXTURE_2D,0,0,0,b,$,H.RGBA,xe,ae)):rK(H,()=>H.texImage2D(H.TEXTURE_2D,0,le,b,$,0,H.RGBA,xe,ae)),rK(H,()=>H.bindTexture(H.TEXTURE_2D,null))}function lG(H,_,b){rK(H,()=>H.bindTexture(H.TEXTURE_2D,_)),b.data instanceof Uint8Array?qM().getNumber("WEBGL_VERSION")===2?rK(H,()=>H.texSubImage2D(H.TEXTURE_2D,0,0,0,b.width,b.height,H.RGBA,H.UNSIGNED_BYTE,b.data)):rK(H,()=>H.texImage2D(H.TEXTURE_2D,0,H.RGBA,b.width,b.height,0,H.RGBA,H.UNSIGNED_BYTE,b.data)):qM().getNumber("WEBGL_VERSION")===2?rK(H,()=>H.texSubImage2D(H.TEXTURE_2D,0,0,0,H.RGBA,H.UNSIGNED_BYTE,b)):rK(H,()=>H.texImage2D(H.TEXTURE_2D,0,H.RGBA,H.RGBA,H.UNSIGNED_BYTE,b)),rK(H,()=>H.bindTexture(H.TEXTURE_2D,null))}function lu(H,_,b,$){const ee=H.createBuffer();rK(H,()=>H.bindBuffer(H.PIXEL_PACK_BUFFER,ee));const re=4*4*_*b;return rK(H,()=>H.bufferData(H.PIXEL_PACK_BUFFER,re,H.STREAM_READ)),rK(H,()=>H.readPixels(0,0,b,_,H.RGBA,H.FLOAT,0)),rK(H,()=>H.bindBuffer(H.PIXEL_PACK_BUFFER,null)),ee}function lj(H,_,b){const $=H,ee=new Float32Array(b);return $.bindBuffer($.PIXEL_PACK_BUFFER,_),$.getBufferSubData($.PIXEL_PACK_BUFFER,0,ee),$.bindBuffer($.PIXEL_PACK_BUFFER,null),ee}function lL(H,_,b,$){const[ee,re]=ru(_,b),ae=4,xe=new Uint8Array(rj(_*b,ae));return rK(H,()=>H.readPixels(0,0,ee,re,$.downloadTextureFormat,H.UNSIGNED_BYTE,xe)),new Float32Array(xe.buffer)}function lo(H,_,b,$,ee,re,ae,xe){const le=H,fe=new Float32Array(rQ(re,ae));return le.bindBuffer(le.PIXEL_PACK_BUFFER,_),le.getBufferSubData(le.PIXEL_PACK_BUFFER,0,fe),le.bindBuffer(le.PIXEL_PACK_BUFFER,null),fe}function lr(H,_,b){const $=new Float32Array(_*b*4);return rK(H,()=>H.readPixels(0,0,b,_,H.RGBA,H.FLOAT,$)),$}class lQ{constructor(_){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const b=qM().getNumber("WEBGL_VERSION");if(_!=null?(this.gl=_,rF(b,_)):this.gl=rW(b),_=this.gl,qM().getNumber("WEBGL_VERSION")===2){const re=_;this.createVertexArray=()=>rK(re,()=>re.createVertexArray()),this.bindVertexArray=ae=>rK(re,()=>re.bindVertexArray(ae)),this.deleteVertexArray=ae=>rK(re,()=>re.deleteVertexArray(ae)),this.getVertexArray=()=>rK(re,()=>re.getParameter(re.VERTEX_ARRAY_BINDING))}else if(_!=null){const re=_.getExtension("OES_vertex_array_object");if(re==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>rK(_,()=>re.createVertexArrayOES()),this.bindVertexArray=ae=>rK(_,()=>re.bindVertexArrayOES(ae)),this.deleteVertexArray=ae=>rK(_,()=>re.deleteVertexArrayOES(ae)),this.getVertexArray=()=>rK(_,()=>_.getParameter(re.VERTEX_ARRAY_BINDING_OES))}let $="WEBGL_color_buffer_float";const ee="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),qM().getNumber("WEBGL_VERSION")===1){const re="OES_texture_float",ae="OES_texture_half_float";if(this.textureFloatExtension=rU(this.gl,re),dz(this.gl,ae))this.textureHalfFloatExtension=rU(this.gl,ae);else if(qM().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension($),dz(this.gl,ee))this.colorBufferHalfFloatExtension=rU(this.gl,ee);else if(qM().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if($="EXT_color_buffer_float",dz(this.gl,$))this.colorBufferFloatExtension=this.gl.getExtension($);else if(dz(this.gl,ee))this.colorBufferHalfFloatExtension=this.gl.getExtension(ee);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=CJ(this.gl),this.indexBuffer=CY(this.gl),this.framebuffer=QL(this.gl),this.textureConfig=rH(this.gl,this.textureHalfFloatExtension)}get debug(){return qM().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const _=this.gl;rK(_,()=>_.finish()),rK(_,()=>_.bindFramebuffer(_.FRAMEBUFFER,null)),rK(_,()=>_.deleteFramebuffer(this.framebuffer)),rK(_,()=>_.bindBuffer(_.ARRAY_BUFFER,null)),rK(_,()=>_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,null)),rK(_,()=>_.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(_,b){return this.throwIfDisposed(),l1(this.gl,_,b,this.textureConfig)}createFloat16MatrixTexture(_,b){return this.throwIfDisposed(),ln(this.gl,_,b,this.textureConfig)}createUnsignedBytesMatrixTexture(_,b){return this.throwIfDisposed(),lF(this.gl,_,b,this.textureConfig)}uploadPixelDataToTexture(_,b){this.throwIfDisposed(),lG(this.gl,_,b)}uploadDenseMatrixToTexture(_,b,$,ee){this.throwIfDisposed(),lX(this.gl,_,b,$,ee,this.textureConfig)}createFloat16PackedMatrixTexture(_,b){return this.throwIfDisposed(),lZ(this.gl,_,b,this.textureConfig)}createPackedMatrixTexture(_,b){return this.throwIfDisposed(),lD(this.gl,_,b,this.textureConfig)}deleteMatrixTexture(_){this.throwIfDisposed(),this.outputTexture===_&&(QB(this.gl,this.framebuffer),this.outputTexture=null),rK(this.gl,()=>this.gl.deleteTexture(_))}downloadByteEncodedFloatMatrixFromOutputTexture(_,b,$){return this.downloadMatrixDriver(_,()=>lL(this.gl,b,$,this.textureConfig))}downloadPackedMatrixFromBuffer(_,b,$,ee,re,ae){return lo(this.gl,_,b,$,ee,re,ae,this.textureConfig)}downloadFloat32MatrixFromBuffer(_,b){return lj(this.gl,_,b)}createBufferFromTexture(_,b,$){this.bindTextureToFrameBuffer(_);const ee=lu(this.gl,b,$,this.textureConfig);return this.unbindTextureToFrameBuffer(),ee}createAndWaitForFence(){const _=this.createFence(this.gl);return this.pollFence(_)}createFence(_){let b,$;if(qM().getBool("WEBGL_FENCE_API_ENABLED")){const ee=_,re=ee.fenceSync(ee.SYNC_GPU_COMMANDS_COMPLETE,0);_.flush(),$=()=>{const ae=ee.clientWaitSync(re,0,0);return ae===ee.ALREADY_SIGNALED||ae===ee.CONDITION_SATISFIED},b=re}else qM().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(b=this.beginQuery(),this.endQuery(),$=()=>this.isQueryAvailable(b,qM().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):$=()=>!0;return{query:b,isFencePassed:$}}downloadMatrixFromPackedTexture(_,b,$){return this.downloadMatrixDriver(_,()=>lr(this.gl,b,$))}createProgram(_){this.throwIfDisposed();const b=this.gl;this.vertexShader==null&&(this.vertexShader=CV(b));const $=QD(b);rK(b,()=>b.attachShader($,this.vertexShader)),rK(b,()=>b.attachShader($,_)),Qa(b,$);const ee=Object.assign($,{vao:this.createVertexArray()});return this.debug&&QZ(b,ee),ee}buildVao(_){this.setProgram(_),this.bindVertexArray(_.vao);const b=this.gl;rK(b,()=>b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),lz(b,_,this.vertexBuffer)}deleteProgram(_){this.throwIfDisposed(),_===this.program&&(this.program=null),_!=null&&(rK(this.gl,()=>this.gl.deleteProgram(_)),this.deleteVertexArray(_.vao))}setProgram(_){this.throwIfDisposed(),this.program=_,this.program!=null&&this.debug&&QZ(this.gl,this.program),rK(this.gl,()=>this.gl.useProgram(_))}getUniformLocation(_,b,$=!0){return this.throwIfDisposed(),$?QQ(this.gl,_,b):QH(this.gl,_,b)}getAttributeLocation(_,b){return this.throwIfDisposed(),rK(this.gl,()=>this.gl.getAttribLocation(_,b))}getUniformLocationNoThrow(_,b){return this.throwIfDisposed(),this.gl.getUniformLocation(_,b)}setInputMatrixTexture(_,b,$){this.throwIfDisposed(),this.throwIfNoProgram(),Qh(this.gl,_,b,$)}setOutputMatrixTexture(_,b,$){this.setOutputMatrixTextureDriver(_,$,b)}setOutputPackedMatrixTexture(_,b,$){this.throwIfDisposed();const[ee,re]=ro(b,$);this.setOutputMatrixTextureDriver(_,ee,re)}setOutputMatrixWriteRegion(_,b,$,ee){this.setOutputMatrixWriteRegionDriver($,_,ee,b)}setOutputPackedMatrixWriteRegion(_,b,$,ee){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&QZ(this.gl,this.program),QV(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const _=this.gl;if(this.debug){const b=this.getVertexArray();console.assert(b===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}rK(_,()=>_.drawElements(_.TRIANGLES,6,_.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),rK(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=rU(this.gl,qM().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(qM().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const $=this.gl,ee=this.getQueryTimerExtensionWebGL2(),re=$.createQuery();return $.beginQuery(ee.TIME_ELAPSED_EXT,re),re}const _=this.getQueryTimerExtensionWebGL1(),b=_.createQueryEXT();return _.beginQueryEXT(_.TIME_ELAPSED_EXT,b),b}endQuery(){if(qM().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const b=this.gl,$=this.getQueryTimerExtensionWebGL2();b.endQuery($.TIME_ELAPSED_EXT);return}const _=this.getQueryTimerExtensionWebGL1();_.endQueryEXT(_.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(_){return await w(()=>this.disposed||this.isQueryAvailable(_,qM().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(_,qM().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(_,b){if(b===0)return null;if(b===2){const $=this.gl;return $.getQueryParameter(_,$.QUERY_RESULT)/1e6}else{const $=this.getQueryTimerExtensionWebGL1();return $.getQueryObjectEXT(_,$.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(_,b){if(b===0)return!0;if(b===2){const $=this.gl,ee=this.getQueryTimerExtensionWebGL2(),re=$.getQueryParameter(_,$.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(ee.GPU_DISJOINT_EXT)),re&&!this.disjoint}else{const $=this.getQueryTimerExtensionWebGL1(),ee=$.getQueryObjectEXT(_,$.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter($.GPU_DISJOINT_EXT)),ee&&!this.disjoint}}pollFence(_){return new Promise(b=>{this.addItemToPoll(()=>_.isFencePassed(),()=>b())})}pollItems(){const _=lH(this.itemsToPoll.map(b=>b.isDoneFn));for(let b=0;b<=_;++b){const{resolveFn:$}=this.itemsToPoll[b];$()}this.itemsToPoll=this.itemsToPoll.slice(_+1)}addItemToPoll(_,b){if(this.itemsToPoll.push({isDoneFn:_,resolveFn:b}),this.itemsToPoll.length>1)return;let $;"setTimeoutCustom"in qM().platform&&($=qM().platform.setTimeoutCustom.bind(qM().platform)),w(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,$)}bindTextureToFrameBuffer(_){this.throwIfDisposed(),QK(this.gl,_,this.framebuffer),this.debug&&QV(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(QK(this.gl,this.outputTexture,this.framebuffer),this.debug&&QV(this.gl)):QB(this.gl,this.framebuffer)}downloadMatrixDriver(_,b){this.bindTextureToFrameBuffer(_);const $=b();return this.unbindTextureToFrameBuffer(),$}setOutputMatrixTextureDriver(_,b,$){this.throwIfDisposed();const ee=this.gl;QK(ee,_,this.framebuffer),this.debug&&QV(ee),this.outputTexture=_,rK(ee,()=>ee.viewport(0,0,b,$)),rK(ee,()=>ee.scissor(0,0,b,$))}setOutputMatrixWriteRegionDriver(_,b,$,ee){this.throwIfDisposed(),rK(this.gl,()=>this.gl.scissor(_,b,$,ee))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function lH(H){let _=0;for(;_<H.length&&H[_]();++_);return _-1}function lK(H,_){Array.isArray(H)||(H=[H]),H.forEach(b=>{b!=null&&k(b.dtype!=="complex64",()=>_+" does not support complex64 tensors in the CPU backend.")})}function lB(H){const _=new Float32Array(H.length);for(let b=0;b<H.length;++b)_[b]=Math.abs(H[b]);return _}const lV=H=>{const{x:_}=H.inputs,b=H.backend;lK(_,"abs");let $=new Float32Array(i$1(_.shape));const ee=b.data.get(_.dataId).values;return $=lB(ee),b.makeOutput($,_.shape,_.dtype)},lJ={kernelName:qX,backendName:"cpu",kernelFunc:lV};function lY(H){return(_,b,$,ee,re)=>{const ae=OR(_,b),xe=ae.length,le=y(ae),fe=i$1(ae),ve=X(re,fe),Se=_.length,Ee=b.length,Ce=y(_),Ie=y(b),De=Oj(_,ae),Be=Oj(b,ae);if(De.length+Be.length===0)for(let Ne=0;Ne<ve.length;++Ne)ve[Ne]=H($[Ne%$.length],ee[Ne%ee.length]);else for(let Ne=0;Ne<ve.length;++Ne){const qe=V(Ne,xe,le),Xe=qe.slice(-Se);De.forEach(ot=>Xe[ot]=0);const Ye=B(Xe,Se,Ce),Qe=qe.slice(-Ee);Be.forEach(ot=>Qe[ot]=0);const rt=B(Qe,Ee,Ie);ve[Ne]=H($[Ye],ee[rt])}return[ve,ae]}}function lP(H){const{inputs:_,backend:b}=H,{real:$,imag:ee}=_,re=b.data.get($.dataId).values,ae=b.data.get(ee.dataId).values,xe=b.makeTensorInfo($.shape,"complex64"),le=b.data.get(xe.dataId);return le.complexTensorInfos={real:b.makeTensorInfo($.shape,"float32",re),imag:b.makeTensorInfo(ee.shape,"float32",ae)},xe}function lU(H,_,b="float32"){if(b==="complex64"){const ee=lU(H,_,"float32"),re=lU(H,_,"float32");return lP({inputs:{real:ee,imag:re},backend:H})}const $=T(i$1(_),b);return H.makeTensorInfo(_,b,$)}function H6(H){const{inputs:_,backend:b}=H,{x:$}=_;return b.incRef($.dataId),{dataId:$.dataId,shape:$.shape,dtype:$.dtype}}const Hq={kernelName:no,backendName:"cpu",kernelFunc:H6};function HM(H){const{inputs:_,backend:b}=H,{input:$}=_,ee=b.data.get($.dataId).complexTensorInfos.real,re=b.data.get(ee.dataId).values;return b.makeTensorInfo(ee.shape,ee.dtype,re)}function HF(H,_,b,$){if($==="int32"){const ee=Int32Array.from(H);return[_,"int32",ee]}if($==="bool"){const ee=EM([0],b),[re,ae]=lY((xe,le)=>xe!==le?1:0)(_,[],H,ee,"bool");return[ae,"bool",re]}throw new Error("Error in Cast: failed to cast "+b+" to "+$)}function HW(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{dtype:re}=$;if(re==="complex64"){if(ee.dtype==="complex64")return H6({inputs:{x:ee},backend:b});const ve=lU(b,ee.shape,ee.dtype),Se=HW({inputs:{x:ee},backend:b,attrs:{dtype:"float32"}}),Ee=lP({inputs:{real:Se,imag:ve},backend:b});return b.disposeIntermediateTensorInfo(ve),b.disposeIntermediateTensorInfo(Se),Ee}if(ee.dtype==="complex64"){const ve=HM({inputs:{input:ee},backend:b}),Se=HW({inputs:{x:ve},backend:b,attrs:{dtype:re}});return b.disposeIntermediateTensorInfo(ve),Se}if(!j(ee.dtype,re)){const ve=H6({inputs:{x:ee},backend:b});return{dataId:ve.dataId,shape:ve.shape,dtype:re}}const ae=b.data.get(ee.dataId).values,[xe,le,fe]=HF(ae,ee.shape,ee.dtype,re);return b.makeTensorInfo(xe,le,fe)}const HD={kernelName:qH,backendName:"cpu",kernelFunc:HW};function HZ(H,_,b,$){return b==null?({inputs:ee,backend:re})=>{const{a:ae,b:xe}=ee,le=re;lK([ae,xe],H);const fe=le.data.get(ae.dataId).values,ve=le.data.get(xe.dataId).values,Se=ae.dtype==="string"?uo(fe):fe,Ee=ae.dtype==="string"?uo(ve):ve,Ce=$||ae.dtype,[Ie,De]=_(ae.shape,xe.shape,Se,Ee,Ce);return le.makeTensorInfo(De,Ce,Ie)}:({inputs:ee,backend:re})=>{const{a:ae,b:xe}=ee,le=re;if(ae.dtype==="complex64"||xe.dtype==="complex64"){const fe=HW({inputs:{x:ae},backend:le,attrs:{dtype:"complex64"}}),ve=le.data.get(fe.dataId),Se=ve.complexTensorInfos.real,Ee=ve.complexTensorInfos.imag,Ce=le.data.get(Se.dataId).values,Ie=le.data.get(Ee.dataId).values,De=HW({inputs:{x:xe},backend:le,attrs:{dtype:"complex64"}}),Be=le.data.get(De.dataId),Ne=Be.complexTensorInfos.real,qe=Be.complexTensorInfos.imag,Xe=le.data.get(Ne.dataId).values,Ye=le.data.get(qe.dataId).values,[Qe,rt,ot]=b(ae.shape,xe.shape,Ce,Ie,Xe,Ye),ct=le.makeTensorInfo(ot,"float32",Qe),mt=le.makeTensorInfo(ot,"float32",rt),_t=lP({inputs:{real:ct,imag:mt},backend:le});return le.disposeIntermediateTensorInfo(fe),le.disposeIntermediateTensorInfo(De),le.disposeIntermediateTensorInfo(ct),le.disposeIntermediateTensorInfo(mt),_t}else{const fe=le.data.get(ae.dataId).values,ve=le.data.get(xe.dataId).values,Se=$||ae.dtype,[Ee,Ce]=_(ae.shape,xe.shape,fe,ve,Se);return le.makeTensorInfo(Ce,Se,Ee)}}}function He(H){return(_,b,$,ee,re,ae)=>{const xe=OR(_,b),le=i$1(xe),fe=xe.length,ve=y(xe),Se=X("float32",le),Ee=X("float32",le),Ce=Oj(_,xe),Ie=Oj(b,xe),De=Nt($,ee),Be=Nt(re,ae),Ne=_.length,qe=y(_),Xe=b.length,Ye=y(b);if(Ce.length+Ie.length===0)for(let Qe=0;Qe<Se.length;Qe++){const rt=Qe%De.length,ot=Qe%Be.length,ct=H(De[rt*2],De[rt*2+1],Be[ot*2],Be[ot*2+1]);Se[Qe]=ct.real,Ee[Qe]=ct.imag}else for(let Qe=0;Qe<Se.length;Qe++){const rt=V(Qe,fe,ve),ot=rt.slice(-Ne);Ce.forEach(Vt=>ot[Vt]=0);const ct=B(ot,Ne,qe),mt=rt.slice(-Xe);Ie.forEach(Vt=>mt[Vt]=0);const _t=B(mt,Xe,Ye),Lt=H(De[ct*2],De[ct*2+1],Be[_t*2],Be[_t*2+1]);Se[Qe]=Lt.real,Ee[Qe]=Lt.imag}return[Se,Ee,xe]}}const HX=lY((H,_)=>H+_),HG=He((H,_,b,$)=>({real:H+b,imag:_+$})),Hj=HZ(qG,HX,HG),HL={kernelName:qG,backendName:"cpu",kernelFunc:Hj};function HR(H,_,b,$,ee){const re=i$1($),ae=T(ee,b);for(let xe=0;xe<H.length;xe++){const le=H[xe];if(le<0)throw new Error("Input x must be non-negative!");le>=ee||(re>0?ae[le]+=_[xe]:ae[le]+=1)}return ae}function Ho(H,_,b,$=!1){const ee=H.shape[0],re=H.shape[1],ae=DY([ee,b],_.dtype);for(let xe=0;xe<ee;xe++)for(let le=0;le<re;le++){const fe=H.get(xe,le);if(fe<0)throw new Error("Input x must be non-negative!");fe>=b||($?ae.set(1,xe,fe):_.size>0?ae.set(ae.get(xe,fe)+_.get(xe,le),xe,fe):ae.set(ae.get(xe,fe)+1,xe,fe))}return ae}const HQ=lY((H,_)=>H&_);function HH(H){return(_,b,$)=>{const ee=G(b,_.length);for(let re=0;re<_.length;++re)ee[re]=H(_[re],$);return ee}}function HK(H,_,b){const $=HH(_);return HB(H,$)}function HB(H,_,b){return({inputs:$,attrs:ee,backend:re})=>{const{x:ae}=$;lK(ae,H);const xe=re,le=xe.data.get(ae.dataId).values;let fe;if(ae.dtype==="string"){if(!Array.isArray(le))throw new Error("String tensor's value was not an instance of Array");fe=uo(le)}else fe=le;const ve=ae.dtype,Se=_(fe,ve,ee);return xe.makeTensorInfo(ae.shape,ve,Se)}}const HV=HH(H=>Math.ceil(H));function HJ(H,_,b,$){const ee=G(b,i$1(_));if($&&b!=="string"){let re=0;H.forEach(ae=>{const xe=i$1(ae.shape);ee.set(ae.vals,re),re+=xe})}else{let re=0;H.forEach(ae=>{const xe=b==="string"?uo(ae.vals):ae.vals;let le=0;for(let fe=0;fe<ae.shape[0];++fe){const ve=fe*_[1]+re;for(let Se=0;Se<ae.shape[1];++Se)ee[ve+Se]=xe[le++]}re+=ae.shape[1]})}return ee}const HY=lY((H,_)=>H===_?1:0),HP=HH(H=>Math.exp(H)),HU=HH(H=>Math.expm1(H)),Aq=HH(H=>Math.floor(H)),AM$1=HB(nX,Aq),AF={kernelName:nX,backendName:"cpu",kernelFunc:AM$1},At=lY((H,_)=>Math.floor(H/_));function AW(H,_,b,$,ee,re,ae,xe,le){const fe=DY([$,re],b);for(let ve=0;ve<$;ve++){const Se=[];let Ee=0;for(let Ce=0;Ce<ee;Ce++){const Ie=H[ve*ee+Ce];Ee+=Ie*ae[Ce],Se.push(Ie)}if(Ee<0||Ee>=le/re)throw new Error("Invalid indices: "+Se+" does not index into "+xe);for(let Ce=0;Ce<re;Ce++)fe.values[ve*re+Ce]=_.get(..._.indexToLoc(Ee*re+Ce))}return fe}function AD(H,_,b){const $=DY(b,H.dtype);for(let ee=0;ee<$.size;++ee){const re=$.indexToLoc(ee).slice(),ae=re[0],xe=re[2],le=_.locToIndex([ae,xe]);re[2]=_.values[le];const fe=H.locToIndex(re);0<=fe&&fe<H.values.length&&($.values[ee]=H.values[fe])}return $}const AZ=lY((H,_)=>H>_?1:0),Ae=lY((H,_)=>H>=_?1:0),Az=HZ(nL,Ae,null,"bool"),AX$1={kernelName:nL,backendName:"cpu",kernelFunc:Az},AG=lY((H,_)=>H<_?1:0),Au=HZ(nK,AG,null,"bool"),Aj={kernelName:nK,backendName:"cpu",kernelFunc:Au},AL=lY((H,_)=>H<=_?1:0),AR=HZ(nB,AL,null,"bool"),AQ$1={kernelName:nB,backendName:"cpu",kernelFunc:AR};function AH(H,_,b){const $=(_-H)/(b-1),ee=T(b,"float32");ee[0]=H;for(let re=1;re<ee.length;re++)ee[re]=ee[re-1]+$;return ee}const AK=HH(H=>Math.log(H));function AB$1(H,_,b,$){const ee=X($,i$1(b));for(let re=0;re<ee.length;++re){const ae=re*_;let xe=H[ae];for(let le=0;le<_;++le){const fe=H[ae+le];(Number.isNaN(fe)||fe>xe)&&(xe=fe)}ee[re]=xe}return ee}const AV=lY((H,_)=>Math.max(H,_)),AJ=HZ(nP,AV),AY$1={kernelName:nP,backendName:"cpu",kernelFunc:AJ},AP$1=lY((H,_)=>Math.min(H,_)),AU=HZ(pM,AP$1),h1={kernelName:pM,backendName:"cpu",kernelFunc:AU},hq=lY((H,_)=>H*_),hn=He((H,_,b,$)=>({real:H*b-_*$,imag:H*$+_*b})),hM=HZ(pF,hq,hn),hF={kernelName:pF,backendName:"cpu",kernelFunc:hM};function ht(H,_,b){const $=Eq(-1,b);return hq([],_,$,H,b)}function hW(H){const{inputs:_,backend:b}=H,{x:$}=_;lK($,"neg");const ee=b.data.get($.dataId).values,[re,ae]=ht(ee,$.shape,$.dtype);return b.makeTensorInfo(ae,$.dtype,re)}const hD={kernelName:pt,backendName:"cpu",kernelFunc:hW},ha=lY((H,_)=>H!==_?1:0);function hZ(H,_,b,$,ee){const re=_.length,ae=i$1(_),xe=y(_),le=y(ee),fe=X(b,i$1(ee));for(let ve=0;ve<ae;++ve){const Se=V(ve,re,xe),Ee=new Array(Se.length);for(let Ie=0;Ie<Ee.length;Ie++)Ee[Ie]=Se[$[Ie]];const Ce=B(Ee,re,le);fe[Ce]=H[ve]}return fe}function he(H){const{inputs:_,attrs:b,backend:$}=H,{x:ee}=_,{perm:re}=b;lK(ee,"transpose");const ae=ee.shape.length,xe=new Array(ae);for(let ve=0;ve<xe.length;ve++)xe[ve]=ee.shape[re[ve]];const le=$.data.get(ee.dataId).values,fe=hZ(le,ee.shape,ee.dtype,re,xe);return{dataId:$.write(fe,xe,ee.dtype),shape:xe,dtype:ee.dtype}}const hz={kernelName:gD,backendName:"cpu",kernelFunc:he};function hX(H,_,b,$){const[ee,re]=aq(H,$),ae=ML(_,"int32"),xe=T(i$1(ee),ae),le=i$1(re);for(let fe=0;fe<xe.length;++fe){const ve=fe*le;let Se=1;for(let Ee=0;Ee<le;++Ee)Se*=b[ve+Ee];xe[fe]=Se}return{outVals:xe,outShape:ee,outDtype:ae}}function hG(H,_,b){H.forEach(($,ee)=>{if($<0||$>=b){const re=V(ee,_.length,y(_)).join(",");throw new Error("indices["+re+"] = "+$+" is not in [0, "+b+")")}})}function hu(H,_){for(let b=0;b<H.length;++b){const $=H[b],ee=b===H.length-1?_:H[b+1].length;if($.length===0)throw new Error("Ragged splits may not be empty");if($[0]<0)throw new Error("Ragged splits must be non-negative");if($[$.length-1]>ee)throw new Error("Ragged splits must not point past values");for(let re=1;re<$.length;++re)if($[re-1]>$[re])throw new Error("Ragged splits must be sorted in ascending order")}}function hj(H,_,b,$){const ee=[];let re=0;const ae=_.length-1+b.length,xe=new Array(ae).fill(null).map(()=>[0]);hu(b,$);let le=1;for(let fe=0;fe<_.length-1;++fe){le*=_[fe];const ve=_[fe+1];for(let Se=1;Se<le+1;++Se)xe[fe].push(Se*ve)}for(let fe=0;fe<H.length;++fe){let ve=H[fe],Se=H[fe]+1;for(let Ee=0;Ee<b.length;++Ee){const Ce=b[Ee],Ie=Ee+_.length-1;if(Ie>=0){const De=xe[Ie],Be=De[De.length-1]-Ce[ve];for(let Ne=ve;Ne<Se;++Ne)xe[Ie].push(Ce[Ne+1]+Be)}ve=Ce[ve],Se=Ce[Se]}Se!==ve&&(ee.push([ve,Se]),re+=Se-ve)}return{outSplits:xe,valueSlices:ee,numValues:re}}function hL(H){const _=[];for(let b=0;b<H.length;++b){const $=H[b].length,ee=G("int32",$);_.push(ee),H[b].forEach((re,ae)=>ee[ae]=re)}return _}function ho(H,_){const b=H.slice(0,_);for(;b.length<_;)b.push(1);for(let $=_;$<H.length;$++)b[_-1]*=H[$];return b}function hr(H,_,b,$,ee,re){const ae=ho(_,2)[1],xe=ho(re,2)[1];let le=0;for(const fe of b)for(let ve=fe[0];ve<fe[1];++ve){for(let Se=0;Se<$;++Se)ee[le*xe+Se]=H[ve*ae+Se];++le}}function hQ(H,_,b,$,ee){const re=_.slice();re[0]=ee;const ae=G(b,i$1(re)),xe=H.length,le=xe===0?0:xe/_[0];return hr(H,_,$,le,ae,re),[ae,re]}function hH(H,_,b,$,ee,re,ae,xe){if(H.length===0)throw new Error("paramsNestedSplits must be non empty");if(_[0].length===0)throw new Error("Split tensors must not be scalars");const le=_[0][0]-1;if(hG(re,ae,le),$.length===0)throw new Error("params.rank must be nonzero");const fe=$[0],{outSplits:ve,valueSlices:Se,numValues:Ee}=hj(re,ae,H,fe),Ce=hL(ve),Ie=hQ(b,$,ee,Se,Ee);return[Ce,Ie[0],Ie[1]]}const hK=2147483647;function hB(H,_,b,$,ee,re,ae){if(_.length>1)throw new Error("starts must be a scalar or vector");if(ee.length>1)throw new Error("limits must be a scalar or vector");if(ae.length>1)throw new Error("deltas must be a scalar or vector");const xe=_.length===0,le=ee.length===0,fe=ae.length===0,ve=[];xe||ve.push(_[0]),le||ve.push(ee[0]),fe||ve.push(ae[0]);for(let Be=1;Be<ve.length;++Be)if(ve[Be]!==ve[Be-1])throw new Error("starts, limits, and deltas must have the same shape");const Se=ve.length===0?1:ve[0],Ee=G("int32",Se+1);Ee[0]=0;for(let Be=0;Be<Se;++Be){const Ne=xe?H[0]:H[Be],qe=le?$[0]:$[Be],Xe=fe?re[0]:re[Be];if(Xe===0)throw new Error("Requires delta != 0");let Ye;if(Xe>0&&qe<Ne||Xe<0&&qe>Ne)Ye=0;else if(Ye=Math.ceil(Math.abs((qe-Ne)/Xe)),Ye>hK)throw new Error("Requires ((limit - start) / delta) <= "+hK);Ee[Be+1]=Ee[Be]+Ye}const Ce=Ee[Se],Ie=G(b,Ce);let De=0;for(let Be=0;Be<Se;++Be){const Ne=Ee[Be+1]-Ee[Be];let qe=xe?H[0]:H[Be];const Xe=fe?re[0]:re[Be];for(let Ye=0;Ye<Ne;++Ye)Ie[De++]=qe,qe+=Xe}return[Ee,Ie]}var hV=GZ;class hJ{constructor(_,b,$,ee,re,ae,xe,le,fe,ve){this.shape=_,this.shapeShape=b,this.values=$,this.valuesShape=ee,this.valuesDType=re,this.defaultValue=ae,this.defaultValueShape=xe,this.rowPartitionValues=le,this.rowPartitionValuesShapes=fe,this.rowPartitionTypes=Gz(ve),this.raggedRank=GX(this.rowPartitionTypes)}getRowPartitionTypeByDimension(_){return this.rowPartitionTypes[0]===hV.FIRST_DIM_SIZE?this.rowPartitionTypes[_+1]:this.rowPartitionTypes[_]}getRowPartitionTensor(_){return this.rowPartitionTypes[0]===hV.FIRST_DIM_SIZE?this.rowPartitionValues[_+1]:this.rowPartitionValues[_]}getMaxWidth(_){const b=this.getRowPartitionTensor(_-1);switch(this.getRowPartitionTypeByDimension(_-1)){case hV.VALUE_ROWIDS:return hJ.getMaxWidthValueRowID(b);case hV.ROW_SPLITS:return hJ.getMaxWidthRowSplit(b);default:throw new Error("Cannot handle partition type "+hV[this.getRowPartitionTypeByDimension(_-1)])}}static getMaxWidthRowSplit(_){const b=_.length;if(b===0||b===1)return 0;let $=0;for(let ee=0;ee<b-1;++ee){const re=_[ee+1]-_[ee];re>$&&($=re)}return $}static getMaxWidthValueRowID(_){const b=_.length;if(b===0)return 0;let $=0,ee=_[0],re=0;for(let ae=1;ae<b;++ae){const xe=_[ae];xe!==ee&&(ee=xe,re=Math.max(ae-$,re),$=ae)}return Math.max(b-$,re)}tensorShapeFromTensor(_,b,$=!0){if(b.length===0){if(_[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return hP(_,$)}calculateOutputSize(_){const b=this.valuesShape,$=this.defaultValueShape;GG($,b);const ee=this.tensorShapeFromTensor(this.shape,this.shapeShape),re=Ge(this.raggedRank,ee,b);re[0]<0&&(re[0]=_);for(let ae=1;ae<=this.raggedRank;++ae)re[ae]<0&&(re[ae]=this.getMaxWidth(ae));return re}calculateFirstParentOutputIndex(_,b,$){const ee=Math.min(_,$),re=[];let ae=0;for(let xe=0;xe<ee;++xe,ae+=b)re.push(ae);for(let xe=ee;xe<_;++xe)re.push(-1);return k(re.length===_,()=>"Final length of result must be equal to firstDimension."),re}calculateOutputIndexRowSplit(_,b,$,ee){const re=_.length,ae=[];for(let xe=0;xe<re-1;++xe){const le=_[xe+1]-_[xe];let fe=Math.min(ee,le),ve=b[xe];ve===-1&&(fe=0);for(let Se=0;Se<fe;++Se)ae.push(ve),ve+=$;for(let Se=0;Se<le-fe;++Se)ae.push(-1)}if(re>0&&ae.length!==_[re-1])throw new Error("Invalid row split size.");return ae}calculateOutputIndexValueRowID(_,b,$,ee){const re=_.length,ae=[];if(re===0)return[];let xe=0,le=_[0];if(le>=b.length)throw new Error("Got currentValueRowId="+le+", which is not less than "+b.length);let fe=b[le];ae.push(fe);for(let ve=1;ve<re;++ve){const Se=_[ve];if(Se===le)fe>=0&&(++xe,xe<ee?fe+=$:fe=-1);else{if(xe=0,le=Se,Se>=b.length)throw new Error("Got nextValueRowId="+Se+" which is not less than "+b.length);fe=b[Se]}ae.push(fe)}if(ae.length!==_.length)throw new Error("Invalid row ids.");return ae}calculateOutputIndex(_,b,$,ee){const re=this.getRowPartitionTensor(_),ae=this.getRowPartitionTypeByDimension(_);switch(ae){case hV.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(re,b,$,ee);case hV.ROW_SPLITS:if(re.length-1>b.length)throw new Error("Row partition size is greater than output size: "+(re.length-1)+" > "+b.length);return this.calculateOutputIndexRowSplit(re,b,$,ee);default:throw new Error("Unsupported partition type: "+hV[ae])}}getFirstDimensionSize(){const _=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const b=this.rowPartitionTypes[0];switch(b){case hV.FIRST_DIM_SIZE:return _[0];case hV.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case hV.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type "+hV[b])}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const _=this.getFirstDimensionSize(),b=this.calculateOutputSize(_),$=new Array(this.raggedRank+1);$[$.length-1]=1;for(let ae=$.length-2;ae>=0;--ae)$[ae]=$[ae+1]*b[ae+1];const ee=hP(b,!1),re=G(this.valuesDType,i$1(ee));if($[0]*b[0]>0){let ae=this.calculateFirstParentOutputIndex(_,$[0],b[0]);for(let xe=1;xe<=this.raggedRank;++xe)ae=this.calculateOutputIndex(xe-1,ae,$[xe],b[xe]);this.setOutput(this.raggedRank,ae,re,ee)}return[ee,re]}setOutput(_,b,$,ee){if($.length===0)return;const re=this.values,ae=$;let xe=ee.slice();xe=xe.slice(_+1);const le=i$1(xe),fe=b.length;let ve=this.defaultValue;if(ve.length!==le&&ve.length!==1){const Ie=this.defaultValueShape;Sq(()=>{const De=DW(ve,Ie);ve=DJ(De,xe).dataSync()})}let Se=0,Ee=0,Ce=0;for(let Ie=0;Ie<=fe;++Ie){let De=Ie<fe?b[Ie]:-1;if(De===Ce){++Ce;continue}if(Ee<Ce){const Be=re.subarray(Se*le),Ne=ae.subarray(Ee*le),qe=(Ce-Ee)*le;hY(Ne,Be,qe)}if(Ie>=fe){const Be=$.length;De=Math.floor(Be/le)}if(De>Ce)if(this.defaultValue.length===1)ae.subarray(Ce*le,De*le).fill(this.defaultValue[0]),Ce=De;else for(;De>Ce;){const Be=ae.slice(Ce*le);hY(Be,ve,le),++Ce}De<0?(Se=Ie+1,Ee=Ce):(Se=Ie,Ee=Ce,Ce=Ee+1)}}}function hY(H,_,b){for(let $=0;$<b;$++)H[$]=_[$]}function hP(H,_){const b=[];for(let $ of H){if($<0){if(!_)throw new Error("Dimension "+$+" must be >= 0");if($<-1)throw new Error("Dimension "+$+" must be >= -1");$=-1}b.push($)}return b}function hU(H,_,b,$,ee,re,ae,xe,le,fe){return new hJ(H,_,b,$,ee,re,ae,xe,le,fe).compute()}function Tq(H,_,b,$){const ee=H===_,re=H<_&&b<0,ae=_<H&&b>1;if(ee||re||ae)return T(0,$);const xe=Math.abs(Math.ceil((_-H)/b)),le=T(xe,$);_<H&&b===1&&(b=-1),le[0]=H;for(let fe=1;fe<le.length;fe++)le[fe]=le[fe-1]+b;return le}const TM=HH(H=>1/Math.sqrt(H));function TF(H,_,b,$,ee,re,ae,xe,le,fe){const ve=[$/ee,ee],Se=H.values,Ee=_.values;if($===0)return DY(b,_.dtype);const Ce=le instanceof EU?le:DY(ve,_.dtype);typeof le=="string"||typeof le=="number"?Ce.values.fill(le):typeof le=="boolean"&&Ce.values.fill(+le);for(let Ie=0;Ie<re;Ie++){const De=[];let Be=0;for(let Ne=0;Ne<ae;Ne++){const qe=Se[Ie*ae+Ne];De.push(qe),Be+=qe*xe[Ne]}if(Be<0||Be>=$/ee)throw new Error("Invalid indices: "+De+" does not index into "+b);for(let Ne=0;Ne<ee;Ne++)fe?Ce.values[Be*ee+Ne]+=Ee[Ie*ee+Ne]:Ce.values[Be*ee+Ne]=_.rank===0?Ee[0]:Ee[Ie*ee+Ne]}return Ce}const TW=HH(H=>1/(1+Math.exp(-H))),TD=HK(pY,H=>1/(1+Math.exp(-H))),TZ={kernelName:pY,backendName:"cpu",kernelFunc:TD};function Te(H,_,b,$,ee){const re=WL($,_,b),ae=i$1(b),xe=y($);if(re){const Se=WR(_,xe);return ee==="string"?H.slice(Se,Se+ae):H.subarray(Se,Se+ae)}const le=ee==="string"?uo(H):H,fe=DY($,ee,le),ve=DY(b,ee);for(let Se=0;Se<ve.size;++Se){const Ee=ve.indexToLoc(Se),Ce=Ee.map((Ie,De)=>Ie+_[De]);ve.set(fe.get(...Ce),...Ee)}return ee==="string"?ur(ve.values):ve.values}function Tz(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{begin:re,size:ae}=$;lK(ee,"slice");const[xe,le]=WQ(ee,re,ae);Wq(ee,xe,le);const fe=b.data.get(ee.dataId).values,ve=Te(fe,xe,le,ee.shape,ee.dtype);return b.makeTensorInfo(le,ee.dtype,ve)}const TX={kernelName:pV,backendName:"cpu",kernelFunc:Tz};function TG(H,_,b,$,ee,re,ae){const xe=_[0],le=re[0],fe=new Array(le),ve=new Array(xe),Se=_[1];if(le===0){if(xe!==0)throw new Error(NU(xe));const Be=G(b,0),Ne=G(ee,0);return[Be,[0,Se],Ne,fe,ve]}let Ee=!0,Ce=0;const Ie=new Array(le).fill(0);for(let Be=0;Be<xe;++Be){const Ne=H[Be*Se];if(Ne<0)throw new Error(uq(Be,Ne));if(Ne>=le)throw new Error(uM(Be,Ne,le));++Ie[Ne],Ee=Ee&&Ne>=Ce,Ce=Ne}let De=!0;for(let Be=0;Be<le;++Be){const Ne=Ie[Be]===0;fe[Be]=Ne,De=De&&!Ne,Ie[Be]=Math.max(Ie[Be],1),Be>0&&(Ie[Be]+=Ie[Be-1])}if(De&&Ee){const Be=H,Ne=$;for(let qe=0;qe<xe;++qe)ve[qe]=qe;return[Be,[xe,Se],Ne,fe,ve]}else{const Be=Ie[le-1],Ne=G(b,Be*Se),qe=G(ee,Be),Xe=new Array(le).fill(0);for(let Ye=0;Ye<xe;++Ye){const Qe=H[Ye*Se],rt=Xe[Qe],ot=(Qe===0?0:Ie[Qe-1])+rt;Xe[Qe]++;for(let ct=0;ct<Se;++ct)Ne[ot*Se+ct]=H[Ye*Se+ct];qe[ot]=$[Ye],ve[Ye]=ot}for(let Ye=0;Ye<le;++Ye)if(Xe[Ye]===0){const Qe=Ye===0?0:Ie[Ye-1];Ne[Qe*Se+0]=Ye;for(let rt=1;rt<Se;++rt)Ne[Qe*Se+rt]=0;qe[Qe]=ae}return[Ne,[Be,Se],qe,fe,ve]}}function Tu(H,_,b,$,ee){const re=i$1($),ae=_[0],xe=ee.length,le=[];let fe=1,ve=-1;for(let De=0;De<xe;++De){const Be=ee[De];if(Be===-1){if(ve!==-1)throw new Error(uF(ve,De));ve=De,le.push(1)}else{if(Be<0)throw new Error(ut(De,Be));fe*=Be,le.push(Be)}}if(ve!==-1){if(fe<=0)throw new Error(uW());const De=Math.trunc(re/fe);if(fe*De!==re)throw new Error(uD($,le));le[ve]=De}if(i$1(le)!==re)throw new Error(ua($,le));const Se=$.length,Ee=[];if(Se>0){Ee[Se-1]=1;for(let De=Se-2;De>=0;--De)Ee[De]=Ee[De+1]*$[De+1]}const Ce=[];if(xe>0){Ce[xe-1]=1;for(let De=xe-2;De>=0;--De)Ce[De]=Ce[De+1]*le[De+1]}const Ie=G(b,ae*xe);for(let De=0;De<ae;++De){let Be=0;for(let Ne=0;Ne<Se;++Ne)Be+=H[De*Se+Ne]*Ee[Ne];for(let Ne=0;Ne<xe;++Ne)Ie[De*xe+Ne]=Math.trunc(Be/Ce[Ne]),Be%=Ce[Ne]}return[Ie,[ae,xe],le]}function Tj(H,_,b,$,ee,re=!1,ae=0){const xe=$.length,le=[_[0],H.length/_[0]],fe=le[1],ve=xe>0?ee[xe-1]+1:0;if(ve<0)throw new Error(uZ());const Se=_.slice();Se[0]=ve;const Ee=Se.reduce((qe,Xe)=>qe*Xe,1),Ce=G(b,Ee);if(xe===0)return ve>0&&Ce.fill(ae),[Ce,Se];if(ve<=0)throw new Error(uZ());let Ie=0,De=1,Be=0,Ne=ee[Ie];for(;;){let qe=0;if(De<xe){if(qe=ee[De],Ne===qe){++De;continue}if(Ne>=qe)throw new Error(ue())}if(Ne<0||Ne>=ve)throw new Error(uz(Ne,ve));Ne>Be&&Ce.fill(ae,Be*fe,Ne*fe);for(let Xe=Ie;Xe<De;++Xe){const Ye=$[Xe];if(Ye<0||Ye>=le[0])throw new Error(uX(Xe,$[Xe],le[0]));for(let Qe=0;Qe<fe;Qe++)Ce[Ne*fe+Qe]+=H[Ye*fe+Qe]}if(re)for(let Xe=0;Xe<fe;Xe++)Ce[Ne*fe+Xe]/=De-Ie;if(Ie=De,++De,Be=Ne+1,Ne=qe,De>xe)break}return Be<ve&&Ce.fill(ae,Be*fe,ve*fe),[Ce,Se]}const TL=HH(H=>Math.sqrt(H)),TQ=HK(pP,H=>Math.sqrt(H)),TH={kernelName:pP,backendName:"cpu",kernelFunc:TQ},TK=lY((H,_)=>{const b=H-_;return b*b}),TB=HH((H,_)=>{const{pattern:b,replaceGlobal:$,rewrite:ee}=_;return H.replace(new RegExp(b,$?"g":""),ee)});function TV(H,_,b,$){const ee=DY(H,_.dtype);for(let re=0;re<ee.size;re++){const ae=ee.indexToLoc(re),xe=new Array(ae.length);for(let le=0;le<xe.length;le++)xe[le]=ae[le]*b[le]+$[le];ee.set(_.get(...xe),...ae)}return ee}class TJ{constructor(_,b,$,ee,re,ae){this.separator=Et(_),this.nGramWidths=b,this.leftPad=Et($),this.rightPad=Et(ee),this.padWidth=re,this.preserveShort=ae}getPadWidth(_){return Math.min(this.padWidth<0?_-1:this.padWidth,_-1)}getNumNGrams(_,b){const $=this.getPadWidth(b);return Math.max(0,_+2*$-b+1)}createNGrams(_,b,$,ee,re,ae){for(let xe=0;xe<re;++xe){const le=this.getPadWidth(ae),fe=Math.max(0,le-xe),ve=Math.max(0,le-(re-(xe+1))),Se=ae-(fe+ve),Ee=b+(fe>0?0:xe-le);let Ce=0;Ce+=fe*this.leftPad.length;for(let qe=0;qe<Se;++qe)Ce+=_[Ee+qe].length;Ce+=ve*this.rightPad.length;const Ie=fe+ve+Se-1;Ce+=Ie*this.separator.length,$[ee+xe]=new Uint8Array(Ce);const De=$[ee+xe];let Be=0;const Ne=qe=>qe.forEach(Xe=>De[Be++]=Xe);for(let qe=0;qe<fe;++qe)Ne(this.leftPad),Ne(this.separator);for(let qe=0;qe<Se-1;++qe)Ne(_[Ee+qe]),Ne(this.separator);if(Se>0){Ne(_[Ee+Se-1]);for(let qe=0;qe<ve;++qe)Ne(this.separator),Ne(this.rightPad)}else{for(let qe=0;qe<ve-1;++qe)Ne(this.rightPad),Ne(this.separator);Ne(this.rightPad)}}}compute(_,b){const $=_.length,ee=b.length;if(ee>0){let le=b[0];if(le!==0)throw new Error("First split value must be 0, got "+le);for(let fe=1;fe<ee;++fe){let ve=b[fe]>=le;if(ve=ve&&b[fe]<=$,!ve)throw new Error("Invalid split value "+b[fe]+", must be in ["+le+", "+$+"]");le=b[fe]}if(le!==$)throw new Error("Last split value must be data size. Expected "+$+", got "+le)}const re=ee-1,ae=G("int32",ee);if($===0||ee===0){const le=new Array($);for(let fe=0;fe<=re;++fe)ae[fe]=0;return[le,ae]}ae[0]=0;for(let le=1;le<=re;++le){const fe=b[le]-b[le-1];let ve=0;this.nGramWidths.forEach(Se=>{ve+=this.getNumNGrams(fe,Se)}),this.preserveShort&&fe>0&&ve===0&&(ve=1),ae[le]=ae[le-1]+ve}const xe=new Array(ae[re]);for(let le=0;le<re;++le){const fe=b[le];let ve=ae[le];if(this.nGramWidths.forEach(Se=>{const Ee=b[le+1]-b[le],Ce=this.getNumNGrams(Ee,Se);this.createNGrams(_,fe,xe,ve,Ce,Se),ve+=Ce}),this.preserveShort&&ve===ae[le]){const Se=b[le+1]-b[le];if(Se===0)continue;const Ee=Se+2*this.padWidth;this.createNGrams(_,fe,xe,ve,1,Ee)}}return[xe,ae]}}function TY(H,_,b,$,ee,re,ae,xe){return new TJ(b,$,ee,re,ae,xe).compute(H,_)}function TP(H,_,b,$){if(!H.length)return;if(_.length===0){for(let re=0;re<H.length;++re)$.push(H.subarray(re,re+1));return}if(_.length===1){const re=_[0];let ae=H.indexOf(re);for(;ae!==-1;){const xe=H.subarray(0,ae);(!b||xe.length!==0)&&$.push(xe),H=H.subarray(ae+1),ae=H.indexOf(re)}(!b||H.length!==0)&&$.push(H);return}let ee=0;for(let re=0;re<H.length+1;re++)if(re===H.length||_.indexOf(H[re])!==-1){const ae=H.subarray(ee,re);(!b||ae.length!==0)&&$.push(ae),ee=re+1}}function TU(H,_,b){const $=H.length,ee=[];let re=0,ae=0;const xe=new Array($);for(let Ee=0;Ee<$;++Ee){const Ce=ee.length;TP(H[Ee],_,b,ee);const Ie=ee.length-Ce;xe[Ee]=Ie,re+=Ie,ae=Math.max(ae,Ie)}const le=G("int32",re*2),fe=new Array(re),ve=[$,ae];let Se=0;for(let Ee=0;Ee<$;++Ee)for(let Ce=0;Ce<xe[Ee];++Ce)le[Se*2]=Ee,le[Se*2+1]=Ce,fe[Se]=ee[Se],++Se;return[le,fe,ve]}function K6(H,_){const b=G("int32",H.length);for(let $=0;$<H.length;++$)b[$]=sU(H[$]).modulo(_).getLowBitsUnsigned();return b}const Kq=lY((H,_)=>H-_),Kn=He((H,_,b,$)=>({real:H-b,imag:_-$})),KM=HZ(gM,Kq,Kn),KF={kernelName:gM,backendName:"cpu",kernelFunc:KM};function Kt(H,_){const b=new Array(H.rank);for(let ee=0;ee<b.length;ee++)b[ee]=H.shape[ee]*_[ee];const $=DY(b,H.dtype);for(let ee=0;ee<$.values.length;++ee){const re=$.indexToLoc(ee),ae=new Array(H.rank);for(let le=0;le<ae.length;le++)ae[le]=re[le]%H.shape[le];const xe=H.locToIndex(ae);$.values[ee]=H.values[xe]}return $}const KW=(H,_)=>{const b=_.value-H.value;return b===0?H.index-_.index:b};function KD(H,_,b=0,$=H.length-1){for(;$>b;){if($-b>600){const xe=$-b+1,le=_-b+1,fe=Math.log(xe),ve=.5*Math.exp(2*fe/3),Se=.5*Math.sqrt(fe*ve*(xe-ve)/xe)*Math.sign(le-xe/2),Ee=Math.max(b,Math.floor(_-le*ve/xe+Se)),Ce=Math.min($,Math.floor(_+(xe-le)*ve/xe+Se));KD(H,_,Ee,Ce)}const ee=H[_];let re=b,ae=$;for(S$1(H,b,_),KW(H[$],ee)>0&&S$1(H,b,$);re<ae;){for(S$1(H,re,ae),re++,ae--;KW(H[re],ee)<0;)re=re+1;for(;KW(H[ae],ee)>0;)ae=ae-1}KW(H[b],ee)===0?S$1(H,b,ae):(ae=ae+1,S$1(H,ae,$)),ae<=_&&(b=ae+1),_<=ae&&($=ae-1)}}function Ka(H,_,b,$,ee){const re=_[_.length-1],[ae,xe]=[H.length/re,re],le=X(b,ae*$),fe=X("int32",ae*$);for(let Se=0;Se<ae;Se++){const Ee=Se*xe,Ce=H.subarray(Ee,Ee+xe);let Ie=new Array(Ce.length);Ce.forEach((qe,Xe)=>Ie[Xe]={value:qe,index:Xe}),$<Ie.length&&(KD(Ie,$),Ie=Ie.slice(0,$)),ee&&Ie.sort(KW);const De=Se*$,Be=le.subarray(De,De+$),Ne=fe.subarray(De,De+$);for(let qe=0;qe<$;qe++)Be[qe]=Ie[qe].value,Ne[qe]=Ie[qe].index}const ve=_.slice();return ve[ve.length-1]=$,[DY(ve,b,le),DY(ve,"int32",fe)]}function KZ(H,_,b,$){const ee=z$1(_,b)[0],re=[1,b[0],1];for(let Ie=0;Ie<ee;Ie++)re[0]*=b[Ie];re[1]=b[ee];for(let Ie=ee+1;Ie<b.length;Ie++)re[2]*=b[Ie];const ae=new Map,xe=new Int32Array(b[ee]),le=new EU(re,$,H),fe=[],ve=re[0]===1&&re[2]===1;for(let Ie=0;Ie<b[ee];Ie++){let De;if(ve)De=H[Ie].toString();else{const Ne=[];for(let qe=0;qe<re[0];qe++)for(let Xe=0;Xe<re[2];Xe++)Ne.push(le.get(qe,Ie,Xe));De=Ne.join(",")}const Be=ae.get(De);if(Be!=null)xe[Ie]=Be;else{const Ne=ae.size;ae.set(De,Ne),xe[Ie]=Ne,fe.push(Ie)}}const Se=re.slice();Se[1]=ae.size;const Ee=new EU(Se,$);fe.forEach((Ie,De)=>{for(let Be=0;Be<re[0];Be++)for(let Ne=0;Ne<re[2];Ne++)Ee.set(le.get(Be,Ie,Ne),Be,De,Ne)});const Ce=b.slice();return Ce[ee]=Se[1],{outputValues:Ee.values,outputShape:Ce,indices:xe}}var Ke=Object.freeze({__proto__:null,addImpl:HX,bincountImpl:HR,bincountReduceImpl:Ho,bitwiseAndImpl:HQ,castImpl:HF,ceilImpl:HV,concatImpl:HJ,equalImpl:HY,expImpl:HP,expm1Impl:HU,floorDivImpl:At,floorImpl:Aq,gatherNdImpl:AW,gatherV2Impl:AD,greaterEqualImpl:Ae,greaterImpl:AZ,lessEqualImpl:AL,lessImpl:AG,linSpaceImpl:AH,logImpl:AK,maxImpl:AB$1,maximumImpl:AV,minimumImpl:AP$1,multiplyImpl:hq,negImpl:ht,notEqualImpl:ha,prodImpl:hX,raggedGatherImpl:hH,raggedRangeImpl:hB,raggedTensorToTensorImpl:hU,rangeImpl:Tq,rsqrtImpl:TM,scatterImpl:TF,sigmoidImpl:TW,simpleAbsImpl:lB,sliceImpl:Te,sparseFillEmptyRowsImpl:TG,sparseReshapeImpl:Tu,sparseSegmentReductionImpl:Tj,sqrtImpl:TL,squaredDifferenceImpl:TK,staticRegexReplaceImpl:TB,stridedSliceImpl:TV,stringNGramsImpl:TY,stringSplitImpl:TU,stringToHashBucketFastImpl:K6,subImpl:Kq,tileImpl:Kt,topKImpl:Ka,transposeImpl:hZ,uniqueImpl:KZ});const{addImpl:Kz,bincountImpl:KX,bincountReduceImpl:KG,bitwiseAndImpl:Kj,castImpl:KL,ceilImpl:KR,concatImpl:Ko,equalImpl:KQ,expImpl:KH,expm1Impl:KK,floorImpl:KB,gatherNdImpl:KV,gatherV2Impl:KJ,greaterImpl:KY,greaterEqualImpl:KP,lessImpl:KU,lessEqualImpl:Bq,linSpaceImpl:Bn,logImpl:Bs,maxImpl:BM,maximumImpl:BF,minimumImpl:Bt,multiplyImpl:BW,negImpl:BD,notEqualImpl:BZ,prodImpl:Bz,raggedGatherImpl:BX,raggedRangeImpl:BG,raggedTensorToTensorImpl:Bj,rangeImpl:BL,rsqrtImpl:BR,scatterImpl:BQ,sigmoidImpl:BH,simpleAbsImpl:BK,sliceImpl:BB,sparseFillEmptyRowsImpl:BV,sparseReshapeImpl:BJ,sparseSegmentReductionImpl:BY,sqrtImpl:BP,staticRegexReplaceImpl:BU,stridedSliceImpl:Vq,stringNGramsImpl:Vn,stringSplitImpl:Vs,stringToHashBucketFastImpl:VM,subImpl:VF,tileImpl:VW,topKImpl:VD,transposeImpl:VZ,uniqueImpl:Ve}=Ke;function Vz(H,_){return["x","y","z","w","u","v"].slice(0,_).map(b=>H+"."+b)}function VX(H,_){return _===1?[H]:Vz(H,_)}function VG(H,_){if(H===1)return"rc";let b="";for(let $=0;$<H;$++)b+=_[$],$<H-1&&(b+=",");return b}class Vj{constructor(_){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=_,this.rank=_.length,this.enableShapeUniforms=CG(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const b=VX("rc",this.rank),$=yU(this.rank),ee=this.getOutOfBoundsCondition(b),re=this.getSetup(b),ae=this.getOutput(b);this.userCode=`
        void main() {
          `+$+` rc = getOutputCoords();

          if(`+ee+`) {
            setOutput(vec4(0));
          } else {
            `+re+`

            setOutput(vec4(`+ae+`));
          }
        }
      `}}getSourceCoordsArr(_){const b=[];for(let $=0;$<=1;$++)for(let ee=0;ee<=1;ee++){let re=($===0?"r":"rp1")+", "+(ee===0?"c":"cp1");for(let ae=2;ae<this.rank;ae++)re=_[_.length-1-ae]+","+re;b.push(re)}return b}getOutOfBoundsCondition(_){if(this.rank===1)return"rc > "+(this.enableShapeUniforms?"outShape":this.outputShape[0]);let b="";for(let $=this.rank-2;$<this.rank;$++)b+=_[$]+" >= "+(this.enableShapeUniforms?"outShape["+$+"]":this.outputShape[$]),$<this.rank-1&&(b+="||");return b}getSetup(_){if(this.rank===1)return"";const b=_.slice(-2),$=this.enableShapeUniforms?"outShape["+this.rank+" - 1]":this.outputShape[this.rank-1],ee=this.enableShapeUniforms?"outShape["+this.rank+" - 2]":this.outputShape[this.rank-2];return`
      int r = `+b[0]+`;
      int c = `+b[1]+`;
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= `+$+`;
      bool rEdge = rp1 >= `+ee+`;
    `}getOutput(_){const b=this.getSourceCoordsArr(_);return this.rank===1?"getA(rc), (rc + 1 >= "+(this.enableShapeUniforms?"outShape":this.outputShape[0])+" ? 0. : getA(rc + 1)), 0, 0":"getA("+b[0]+`),
            cEdge ? 0. : getA(`+b[1]+`),
            rEdge ? 0. : getA(`+b[2]+`),
            rEdge || cEdge ? 0. : getA(`+b[3]+")"}}class VL{constructor(_,b){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=_,this.enableShapeUniforms=CG(this.outputShape.length);let $="";for(let ee=0;ee<4;ee++){let re="thisRC = rc;";ee%2===1&&(re+="thisRC.z += 1;"),ee>1&&(re+="thisRC.y += 1;"),$+=`
        `+re+`
        `+(ee>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+ee+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(ee>0?"}":"")+`
      `}this.userCode=`
      `+VR(b,this.enableShapeUniforms)+`
      `+(this.enableShapeUniforms?vq():dU(_))+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+(this.enableShapeUniforms?"outShape[1]":_[1])+`;
        int cols = `+(this.enableShapeUniforms?"outShape[2]":_[2])+`;

        `+$+`

        setOutput(result);
      }
    `}}function VR(H,_){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+(_?dP(["r","c","d"],"inputShape"):dV(["r","c","d"],H))+`
      return ivec3(r, c, d);
    }
  `}class VQ{constructor(_){this.gpgpu=_,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(_,b,$){const ee=VJ(b,$),re=VY(_,ee,$);re in this.freeTextures||(this.freeTextures[re]=[]),re in this.usedTextures||(this.usedTextures[re]=[]);const ae=VK(_,ee,this.gpgpu.gl,this.gpgpu.textureConfig,$);if(this.freeTextures[re].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=ae,this.log();const le=this.freeTextures[re].pop();return this.usedTextures[re].push(le),le}let xe;return ee===rG.PACKED_2X2_FLOAT32?xe=this.gpgpu.createPackedMatrixTexture(_[0],_[1]):ee===rG.PACKED_2X2_FLOAT16?xe=this.gpgpu.createFloat16PackedMatrixTexture(_[0],_[1]):ee===rG.UNPACKED_FLOAT32?xe=this.gpgpu.createFloat32MatrixTexture(_[0],_[1]):ee===rG.UNPACKED_FLOAT16?xe=this.gpgpu.createFloat16MatrixTexture(_[0],_[1]):ee===rG.PACKED_4X1_UNSIGNED_BYTE&&(xe=this.gpgpu.createUnsignedBytesMatrixTexture(_[0],_[1])),this.usedTextures[re].push(xe),this.numUsedTextures++,this._numBytesAllocated+=ae,this.log(),xe}releaseTexture(_,b,$,ee){if(this.freeTextures==null)return;const re=VJ($,ee),ae=VY(b,re,ee);ae in this.freeTextures||(this.freeTextures[ae]=[]);const xe=VK(b,re,this.gpgpu.gl,this.gpgpu.textureConfig,ee),le=qM().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");le!==-1&&this._numBytesAllocated>le?(this.gpgpu.deleteMatrixTexture(_.texture),this._numBytesAllocated-=xe):(this.freeTextures[ae].push(_),this.numFreeTextures++,this._numBytesFree+=xe),this.numUsedTextures--;const fe=this.usedTextures[ae],ve=fe&&fe.indexOf(_);if(ve==null||ve<0)throw new Error("Cannot release a texture that was never provided by this texture manager");fe[ve]=fe[fe.length-1],fe.pop(),this.log()}log(){if(!this.logEnabled)return;const _=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+_+")");const b=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: "+this._numBytesAllocated),console.log("Bytes unused: "+this._numBytesFree+" ("+Math.round(100*b)+"%)")}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const _ in this.freeTextures)this.freeTextures[_].forEach(b=>{this.gpgpu.deleteMatrixTexture(b.texture)});for(const _ in this.usedTextures)this.usedTextures[_].forEach(b=>{this.gpgpu.deleteMatrixTexture(b.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function VH(H,_){const b=H;if(_===b.R32F)return 4;if(_===b.R16F)return 2;if(_===b.RGBA32F||_===H.RGBA)return 16;if(_===b.RGBA16F)return 8;if(_===b.RGBA8)return 4;throw new Error("Unknown internal format "+_)}function VK(H,_,b,$,ee){const re=VB(_,$);let ae;if(ee){const[le,fe]=ro(H[0],H[1]);ae=le*fe}else{const[le,fe]=ru(H[0],H[1]);ae=le*fe}const xe=VH(b,re);return ae*xe}function VB(H,_){switch(H){case rG.PACKED_2X2_FLOAT32:return lW(_);case rG.PACKED_2X2_FLOAT16:return la(_);case rG.UNPACKED_FLOAT32:return CU(_);case rG.UNPACKED_FLOAT16:return lq(_);case rG.PACKED_4X1_UNSIGNED_BYTE:return lM(_);default:throw new Error("Unknown physical texture type "+H)}}function VV(H){return qM().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?H?rG.PACKED_2X2_FLOAT32:rG.UNPACKED_FLOAT32:H?rG.PACKED_2X2_FLOAT16:rG.UNPACKED_FLOAT16}function VJ(H,_){if(H===rX.UPLOAD)return rG.PACKED_2X2_FLOAT32;if(H===rX.RENDER||H==null)return VV(_);if(H===rX.DOWNLOAD||H===rX.PIXELS)return rG.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+H)}function VY(H,_,b){return H[0]+"_"+H[1]+"_"+_+"_"+b}class VP{constructor(_,b){this.variableNames=["A"],this.outputShape=_,this.enableShapeUniforms=CG(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        `+b+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const VU="if (isnan(x)) return x;",Jq="return x;",JM="return abs(x);",JF="return (x >= 0.0) ? x : (exp(x) - 1.0);",JW=VU+`
  return (x < 0.0) ? 0.0 : x;
`,JD=VU+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ja="return x;",JZ="return 1.0 / (1.0 + exp(-1.0 * x));",Je="return x;",Jz=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,JX=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,JG=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Jj="return 1.0 / (1.0 + exp(-1.0 * x));";class JL{constructor(_,b){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=_,this.enableShapeUniforms=CG(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+b+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}class JR{constructor(_){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=_,this.enableShapeUniforms=CG(this.outputShape.length);const b=_.length,$=VX("rc",b),ee=yU(b),re=VG(b,$),ae=$.slice(-2),xe=b<=1?"rc":"vec2("+ae.join(",")+")";this.userCode=`
      void main() {
        `+ee+` rc = getOutputCoords();
        vec4 packedInput = getA(`+re+`);

        setOutput(getChannel(packedInput, `+xe+`));
      }
    `}}const Jo=zR,JQ=1e-7,JH=1e-4,JK={};function JB(H){return H in JK||(JK[H]={}),JK[H]}const JV=qM().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),JJ=600;function JY(){return qM().global.screen==null?1024:qM().global.screen.height*qM().global.screen.width*window.devicePixelRatio*JJ/1024/1024}class JP extends x$1{nextDataId(){return JP.nextDataId++}constructor(_){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!qM().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let b;if(_!=null){if(_ instanceof lQ)b=_;else{const $=rW(qM().getNumber("WEBGL_VERSION"),_);b=new lQ($)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const $=rW(qM().getNumber("WEBGL_VERSION"));b=new lQ($),this.binaryCache=JB(qM().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=b,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new VQ(this.gpgpu),this.numMBBeforeWarning=JY(),this.texData=new g(this,fU())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(_,b,$,ee,re,ae){const xe=this.makeTensorInfo(b,$),le=this.texData.get(xe.dataId);le.isPacked=!1,le.texture={texture:_,texShape:[ee,re]},le.texShape=[ee,re];const fe=dq(b),ve=new CK(fe,!1,ae),Se=this.runWebGLProgram(ve,[xe],$,[[ee,re]]);return Se.shape=b,le.texture=null,this.disposeIntermediateTensorInfo(xe),Se.dataId}write(_,b,$){if((qM().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||qM().getBool("DEBUG"))&&this.checkNumericalProblems(_),$==="complex64"&&_!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const ee={id:this.nextDataId()};return this.texData.set(ee,{shape:b,dtype:$,values:_,usage:rX.UPLOAD,refCount:1}),ee}refCount(_){return this.texData.has(_)?this.texData.get(_).refCount:0}incRef(_){const b=this.texData.get(_);b.refCount++}decRef(_){if(this.texData.has(_)){const b=this.texData.get(_);b.refCount--}}move(_,b,$,ee,re){if(qM().getBool("DEBUG")&&this.checkNumericalProblems(b),ee==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(_,{shape:$,dtype:ee,values:b,usage:rX.UPLOAD,refCount:re})}disposeIntermediateTensorInfo(_){this.disposeData(_.dataId)}readSync(_){const b=this.texData.get(_),{values:$,dtype:ee,complexTensorInfos:re,slice:ae,shape:xe,isPacked:le}=b;if(ae!=null){let Ee;le?Ee=new JL(xe,Ja):Ee=new VP(xe,Ja);const Ce=this.runWebGLProgram(Ee,[{dataId:_,shape:xe,dtype:ee}],ee),Ie=this.readSync(Ce.dataId);return this.disposeIntermediateTensorInfo(Ce),Ie}if($!=null)return this.convertAndCacheOnCPU(_);if(ee==="string")return $;const fe=this.activeTimers!=null;let ve;fe&&(ve=EF());let Se;if(ee==="complex64"){const Ee=this.readSync(re.real.dataId),Ce=this.readSync(re.imag.dataId);Se=Nt(Ee,Ce)}else Se=this.getValuesFromTexture(_);return fe&&(this.downloadWaitMs+=EF()-ve),this.convertAndCacheOnCPU(_,Se)}async read(_){if(this.pendingRead.has(_)){const Ie=this.pendingRead.get(_);return new Promise(De=>Ie.push(De))}const b=this.texData.get(_),{values:$,shape:ee,slice:re,dtype:ae,complexTensorInfos:xe,isPacked:le}=b;if(re!=null){let Ie;le?Ie=new JL(ee,Ja):Ie=new VP(ee,Ja);const De=this.runWebGLProgram(Ie,[{dataId:_,shape:ee,dtype:ae}],ae),Be=this.read(De.dataId);return this.disposeIntermediateTensorInfo(De),Be}if($!=null)return this.convertAndCacheOnCPU(_);if(qM().getBool("DEBUG")&&!qM().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&qM().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let fe=null,ve;if(ae!=="complex64"&&qM().get("WEBGL_BUFFER_SUPPORTED")){ve=this.decode(_);const Ie=this.texData.get(ve.dataId);fe=this.gpgpu.createBufferFromTexture(Ie.texture.texture,...rL(ee))}this.pendingRead.set(_,[]),ae!=="complex64"&&await this.gpgpu.createAndWaitForFence();let Se;if(ae==="complex64"){const Ie=await Promise.all([this.read(xe.real.dataId),this.read(xe.imag.dataId)]),De=Ie[0],Be=Ie[1];Se=Nt(De,Be)}else if(fe==null)Se=this.getValuesFromTexture(_);else{const Ie=i$1(ee);Se=this.gpgpu.downloadFloat32MatrixFromBuffer(fe,Ie)}if(ve!=null&&this.disposeIntermediateTensorInfo(ve),fe!=null){const Ie=this.gpgpu.gl;rK(Ie,()=>Ie.deleteBuffer(fe))}const Ee=this.convertAndCacheOnCPU(_,Se),Ce=this.pendingRead.get(_);return this.pendingRead.delete(_),Ce.forEach(Ie=>Ie(Ee)),this.pendingDisposal.has(_)&&(this.pendingDisposal.delete(_),this.disposeData(_)&&fU().removeDataId(_,this),this.pendingDeletes--),Ee}readToGPU(_,b={}){const $=this.texData.get(_),{values:ee,shape:re,slice:ae,dtype:xe,isPacked:le,texture:fe}=$;if(xe==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(ae!=null){let Ce;le?Ce=new JL(re,Ja):Ce=new VP(re,Ja);const Ie=this.runWebGLProgram(Ce,[{dataId:_,shape:re,dtype:xe}],xe),De=this.readToGPU(Ie,b);return this.disposeIntermediateTensorInfo(Ie),De}if(fe==null)throw ee!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const ve=this.decode(_,b.customTexShape),Se=fU().makeTensorFromTensorInfo(ve),Ee=this.texData.get(ve.dataId);return Object.assign({tensorRef:Se},Ee.texture)}bufferSync(_){const b=this.readSync(_.dataId);if(_.dtype==="string")try{const $=b.map(ee=>EW(ee));return DY(_.shape,_.dtype,$)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return DY(_.shape,_.dtype,b)}checkNumericalProblems(_){if(_!=null)for(let b=0;b<_.length;b++){const $=_[b];if(!rY($))throw qM().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+$+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+$+" cannot be represented on this device.")}}getValuesFromTexture(_){const{shape:b,dtype:$,isPacked:ee}=this.texData.get(_),re=i$1(b);if(qM().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const Ee=this.decode(_),Ce=this.texData.get(Ee.dataId),Ie=this.gpgpu.downloadMatrixFromPackedTexture(Ce.texture.texture,...rL(b)).subarray(0,re);return this.disposeIntermediateTensorInfo(Ee),Ie}const ae=qM().getBool("WEBGL_PACK")&&ee===!0,xe=ae?dq(b):b,le=ae?new CQ(xe):new CL(xe),fe=this.runWebGLProgram(le,[{shape:xe,dtype:$,dataId:_}],"float32"),ve=this.texData.get(fe.dataId),Se=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(ve.texture.texture,ve.texShape[0],ve.texShape[1]).subarray(0,re);return this.disposeIntermediateTensorInfo(fe),Se}timerAvailable(){return qM().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(_){const b=this.activeTimers,$=[];let ee=!1;this.programTimersStack==null?(this.programTimersStack=$,ee=!0):this.activeTimers.push($),this.activeTimers=$,_();const re=EZ(this.activeTimers.map(le=>le.query)).filter(le=>le!=null),ae=EZ(this.activeTimers.map(le=>le.name)).filter(le=>le!=null);this.activeTimers=b,ee&&(this.programTimersStack=null);const xe={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(qM().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const le=await Promise.all(re);xe.kernelMs=F$1(le),xe.getExtraProfileInfo=()=>le.map((fe,ve)=>({name:ae[ve],ms:fe})).map(fe=>fe.name+": "+fe.ms).join(", ")}else xe.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,xe})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return qM().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:EF(),endMs:null}}endTimer(_){return qM().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),_):(_.endMs=EF(),_)}async getQueryTime(_){if(qM().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(_);const b=_;return b.endMs-b.startMs}disposeData(_,b=!1){if(this.pendingDisposal.has(_))return!1;if(!this.texData.has(_))return!0;if(b?this.texData.get(_).refCount=0:this.texData.get(_).refCount--,!b&&this.texData.get(_).refCount>0)return!1;if(this.pendingRead.has(_))return this.pendingDisposal.add(_),this.pendingDeletes++,!1;this.releaseGPUData(_);const{complexTensorInfos:$}=this.texData.get(_);return $!=null&&(this.disposeData($.real.dataId,b),this.disposeData($.imag.dataId,b)),this.texData.delete(_),!0}releaseGPUData(_){const{texture:b,dtype:$,texShape:ee,usage:re,isPacked:ae,slice:xe}=this.texData.get(_),le=xe&&xe.origDataId||_,fe=this.dataRefCount.get(le);fe>1?this.dataRefCount.set(le,fe-1):(this.dataRefCount.delete(le),b!=null&&(this.numBytesInGPU-=this.computeBytes(ee,$),this.textureManager.releaseTexture(b,ee,re,ae)));const ve=this.texData.get(_);ve.texture=null,ve.texShape=null,ve.isPacked=!1,ve.slice=null}getTexture(_){return this.uploadToGPU(_),this.texData.get(_).texture.texture}getDataInfo(_){return this.texData.get(_)}shouldExecuteOnCPU(_,b=JV){return qM().getBool("WEBGL_CPU_FORWARD")&&_.every($=>this.texData.get($.dataId).texture==null&&i$1($.shape)<b)}getGPGPUContext(){return this.gpgpu}where(_){gL("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const b=_.dataSync();return Jo(_.shape,b)}packedUnaryOp(_,b,$){const ee=new JL(_.shape,b),re=this.compileAndRun(ee,[_],$);return fU().makeTensorFromTensorInfo(re)}abs(_){if(this.shouldExecuteOnCPU([_])&&_.dtype!=="complex64"){const ee=BK(this.texData.get(_.dataId).values);return this.makeOutput(_.shape,_.dtype,ee)}if(qM().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(_,JM,_.dtype);const b=new VP(_.shape,JM),$=this.compileAndRun(b,[_]);return fU().makeTensorFromTensorInfo($)}makeTensorInfo(_,b,$){let ee;if(b==="string"&&$!=null&&$.length>0&&R$1($[0])){const re=$.map(ae=>Et(ae));ee=this.write(re,_,b)}else ee=this.write($,_,b);return this.texData.get(ee).usage=null,{dataId:ee,shape:_,dtype:b}}makeOutput(_,b,$){return fU().makeTensorFromTensorInfo(this.makeTensorInfo(_,b,$),this)}unpackTensor(_){const b=new JR(_.shape);return this.runWebGLProgram(b,[_],_.dtype)}packTensor(_){const b=new Vj(_.shape);return this.runWebGLProgram(b,[_],_.dtype,null,!0)}packedReshape(_,b){const $=[QU(_.shape),...d1(_.shape)],ee={dtype:_.dtype,shape:$,dataId:_.dataId},re=[QU(b),...d1(b)],ae=new VL(re,$),xe=!0,le=[$],fe=this.runWebGLProgram(ae,[ee],_.dtype,le,xe);return{dataId:fe.dataId,shape:b,dtype:fe.dtype}}decode(_,b){const $=this.texData.get(_),{isPacked:ee,shape:re,dtype:ae}=$;if(b!=null){const Ee=i$1(re),Ce=b[0]*b[1]*4;k(Ee<=Ce,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const xe=dq(re);let le;ee?le=new Cj(xe):le=new Cu(xe);const fe=!0,ve=[b??rL(xe)],Se=this.runWebGLProgram(le,[{shape:xe,dtype:ae,dataId:_}],ae,ve,fe,b);return{dtype:ae,shape:re,dataId:Se.dataId}}runWebGLProgram(_,b,$,ee,re=!1,ae){const xe=this.makeTensorInfo(_.outputShape,$),le=this.texData.get(xe.dataId);if(_.packedOutput&&(le.isPacked=!0),_.outPackingScheme===rz.DENSE){const Ne=ae??rL(_.outputShape);le.texShape=Ne.map(qe=>qe*2)}if(_.outTexUsage!=null&&(le.usage=_.outTexUsage),i$1(xe.shape)===0)return le.values=X(xe.dtype,0),xe;const fe=[],ve=b.map(Ne=>{if(Ne.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let qe=this.texData.get(Ne.dataId);if(qe.texture==null){if(!_.packedInputs&&i$1(Ne.shape)<=qM().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:Ne.shape,texData:null,isUniform:!0,uniformValues:qe.values};_.packedInputs&&(qe.isPacked=!0,qe.shape=Ne.shape)}if(this.uploadToGPU(Ne.dataId),!!qe.isPacked!=!!_.packedInputs)Ne=qe.isPacked?this.unpackTensor(Ne):this.packTensor(Ne),fe.push(Ne),qe=this.texData.get(Ne.dataId);else if(qe.isPacked&&!dt(qe.shape,Ne.shape)){const Xe=Ne,Ye=Ne.shape;Ne.shape=qe.shape,Ne=this.packedReshape(Ne,Ye),fe.push(Ne),qe=this.texData.get(Ne.dataId),Xe.shape=Ye}return{shape:Ne.shape,texData:qe,isUniform:!1}});this.uploadToGPU(xe.dataId);const Se={shape:xe.shape,texData:le,isUniform:!1},Ee=CX(_,ve,Se),Ce=this.getAndSaveBinary(Ee,()=>CW(this.gpgpu,_,ve,Se)),Ie=this.activeTimers!=null;let De;Ie&&(De=this.startTimer()),qM().get("ENGINE_COMPILE_ONLY")||Cz(this.gpgpu,Ce,ve,Se,ee),fe.forEach(Ne=>this.disposeIntermediateTensorInfo(Ne)),Ie&&(De=this.endTimer(De),this.activeTimers.push({name:_.constructor.name,query:this.getQueryTime(De)}));const Be=qM().getNumber("WEBGL_FLUSH_THRESHOLD");if(Be>0){const Ne=EF();Ne-this.lastGlFlushTime>Be&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=Ne)}if(!qM().getBool("WEBGL_LAZILY_UNPACK")&&le.isPacked&&re===!1){const Ne=this.unpackTensor(xe);return this.disposeIntermediateTensorInfo(xe),Ne}return xe}compileAndRun(_,b,$,ee,re=!1){return $=$||b[0].dtype,this.runWebGLProgram(_,b,$,ee,re)}getAndSaveBinary(_,b){return _ in this.binaryCache||(this.binaryCache[_]=b()),this.binaryCache[_]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(qM().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(_=>{this.gpgpu.deleteProgram(this.binaryCache[_].webGLProgram),delete this.binaryCache[_]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Sq(()=>{if(!qM().get("WEBGL_RENDER_FLOAT32_ENABLED")){const _=qM().getBool("DEBUG");qM().set("DEBUG",!1);const b=this.abs(aL(1e-8)).dataSync()[0];if(qM().set("DEBUG",_),b>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?JQ:JH}uploadToGPU(_){const b=this.texData.get(_),{shape:$,dtype:ee,values:re,texture:ae,usage:xe,isPacked:le}=b;if(ae!=null)return;const fe=this.activeTimers!=null;let ve;fe&&(ve=EF());let Se=b.texShape;if(Se==null&&(Se=dM($,le),b.texShape=Se),re!=null){const Ee=dq($);let Ce,Ie=Se[1],De=Se[0];const Be=re instanceof Uint8Array||re instanceof Uint8ClampedArray;(le||!Be)&&([Ie,De]=ro(Se[0],Se[1])),le?Ce=new CB(Ee,Be):Ce=new CK(Ee,Be);const Ne=Be?[De,Ie]:Se,qe=this.makeTensorInfo(Ne,ee),Xe=this.texData.get(qe.dataId);Be?Xe.usage=rX.PIXELS:Xe.usage=rX.UPLOAD,Xe.texShape=Ne,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(qe.dataId),Ie,De,re);const Ye=[[De,Ie]],Qe=this.runWebGLProgram(Ce,[qe],ee,Ye,!0),rt=this.texData.get(Qe.dataId);b.texShape=rt.texShape,b.isPacked=rt.isPacked,b.usage=rt.usage,qM().get("ENGINE_COMPILE_ONLY")?this.disposeData(Qe.dataId):(b.texture=rt.texture,b.values=null,this.texData.delete(Qe.dataId)),this.disposeIntermediateTensorInfo(qe),fe&&(this.uploadWaitMs+=EF()-ve)}else{const Ee=this.acquireTexture(Se,xe,ee,le);b.texture=Ee}}convertAndCacheOnCPU(_,b){const $=this.texData.get(_),{dtype:ee}=$;return b!=null&&($.values=JU(b,ee)),$.values}acquireTexture(_,b,$,ee){if(this.numBytesInGPU+=this.computeBytes(_,$),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const re=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+re+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(_,b,ee)}computeBytes(_,b){return _[0]*_[1]*L(b)}checkCompileCompletion(){for(const[,_]of Object.entries(this.binaryCache))this.checkCompletion_(_)}async checkCompileCompletionAsync(){const _=[];if(this.gpgpu.parallelCompilationExtension){for(const[,b]of Object.entries(this.binaryCache))_.push(this.checkCompletionAsync_(b));return Promise.all(_)}else{for(const[,b]of Object.entries(this.binaryCache)){const $=new Promise(ee=>{try{this.checkCompletion_(b),ee(!0)}catch(re){throw re}});_.push($)}return Promise.all(_)}}async checkCompletionAsync_(_){return this.gpgpu.gl.getProgramParameter(_.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(_):(await GF(),this.checkCompletionAsync_(_))}checkCompletion_(_){if(this.gpgpu.gl.getProgramParameter(_.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(_.webGLProgram)),this.gpgpu.gl.getShaderParameter(_.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(QW(_.source,this.gpgpu.gl.getShaderInfoLog(_.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const _ of Object.values(this.binaryCache)){this.gpgpu.buildVao(_.webGLProgram);const{variablesLocations:b,customUniformLocations:$,infLoc:ee,nanLoc:re,outShapeLocation:ae,outShapeStridesLocation:xe,outTexShapeLocation:le}=CD(this.gpgpu,_.program,_.webGLProgram);_.variablesLocations=b,_.customUniformLocations=$,_.infLoc=ee,_.nanLoc=re,_.outShapeLocation=ae,_.outShapeStridesLocation=xe,_.outTexShapeLocation=le}}createTensorFromGPUData(_,b,$){_.channels=_.channels||"RGBA";const{texture:ee,height:re,width:ae,channels:xe}=_,le=fU().backend;if(!le.gpgpu.gl.isTexture(ee))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const fe=le.writeTexture(ee,b,$,re,ae,xe);return fU().makeTensorFromDataId(fe,b,$,le)}}JP.nextDataId=0;function JU(H,_){if(_==="float32"||_==="complex64")return H;if(_==="int32"||_==="bool"){const b=_==="int32"?new Int32Array(H.length):new Uint8Array(H.length);for(let $=0;$<b.length;++$)b[$]=Math.round(H[$]);return b}else throw new Error("Unknown dtype "+_)}fD()&&SW("webgl",()=>new JP,2);const Y6="return abs(x);";function Yq(H){const{inputs:_,backend:b}=H,{x:$}=_;if(b.shouldExecuteOnCPU([$])&&$.dtype!=="complex64"){const re=b.texData.get($.dataId),ae=BK(re.values);return b.makeTensorInfo($.shape,$.dtype,ae)}let ee;return qM().getBool("WEBGL_PACK_UNARY_OPERATIONS")?ee=new JL($.shape,Y6):ee=new VP($.shape,Y6),b.runWebGLProgram(ee,[$],$.dtype)}const YM={kernelName:qX,backendName:"webgl",kernelFunc:Yq},YF=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Yt{constructor(_,b,$){this.variableNames=["A","B"],this.outputShape=OR(b,$),this.enableShapeUniforms=CG(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        `+_+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}const YW=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class YD{constructor(_,b,$,ee=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=OR(b,$);const re=this.outputShape.length;this.enableShapeUniforms=CG(re);let ae="";if(ee)if(re===0||i$1(this.outputShape)===1)ae=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(ae=`
          `+yU(re)+` coords = getOutputCoords();
        `,re===1)this.enableShapeUniforms?ae+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:ae+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const xe=VX("coords",re);this.enableShapeUniforms?ae+=`
            bool nextRowOutOfBounds =
              (`+xe[re-2]+" + 1) >= outShape["+re+` - 2];
            bool nextColOutOfBounds =
              (`+xe[re-1]+" + 1) >= outShape["+re+` - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:ae+=`
            bool nextRowOutOfBounds =
              (`+xe[re-2]+" + 1) >= "+this.outputShape[re-2]+`;
            bool nextColOutOfBounds =
              (`+xe[re-1]+" + 1) >= "+this.outputShape[re-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+_+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+ae+`

        setOutput(result);
      }
    `}}function Ya(H){const{inputs:_,backend:b}=H,{x:$}=_;return b.incRef($.dataId),{dataId:$.dataId,shape:$.shape,dtype:$.dtype}}const YZ={kernelName:no,backendName:"webgl",kernelFunc:Ya};function Yz(H){const{inputs:_,backend:b}=H,{real:$,imag:ee}=_,re=b.makeTensorInfo($.shape,"complex64"),ae=b.texData.get(re.dataId),xe=Ya({inputs:{x:$},backend:b}),le=Ya({inputs:{x:ee},backend:b});return ae.complexTensorInfos={real:xe,imag:le},re}const YX="return (a < 0.) ? b * a : a;",YG=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Yj="return (a < 0.) ? b * a : a;",YL=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function YR(H){const{inputs:_,backend:b}=H,{x:$,alpha:ee}=_,re=qM().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new YD(YL,$.shape,ee.shape):new Yt(Yj,$.shape,ee.shape);return b.runWebGLProgram(re,[$,ee],"float32")}const Yo={kernelName:pX,backendName:"webgl",kernelFunc:YR},YQ="if (isnan(x)) return x;";function YH({opSnippet:H,packedOpSnippet:_,cpuKernelImpl:b,dtype:$}){return({inputs:ee,backend:re})=>{const{x:ae}=ee,xe=re,le=$||ae.dtype;if(xe.shouldExecuteOnCPU([ae])&&b!=null){const Se=xe.texData.get(ae.dataId),Ee=b(Se.values,le);return xe.makeTensorInfo(ae.shape,le,Ee)}const fe=qM().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&_!=null;let ve;return fe?ve=new JL(ae.shape,_):ve=new VP(ae.shape,H),xe.runWebGLProgram(ve,[ae],le)}}function YK({opSnippet:H,packedOpSnippet:_,checkOutOfBounds:b=!1,supportsComplex:$=!1,cpuKernelImpl:ee,dtype:re}){return({inputs:ae,backend:xe})=>{const{a:le,b:fe}=ae,ve=xe;if($&&le.dtype==="complex64"){const Ie=ve.texData.get(le.dataId),De=ve.texData.get(fe.dataId),[Be,Ne]=[[Ie.complexTensorInfos.real,De.complexTensorInfos.real],[Ie.complexTensorInfos.imag,De.complexTensorInfos.imag]].map(Xe=>{const[Ye,Qe]=Xe,rt={dataId:Ye.dataId,dtype:Ye.dtype,shape:le.shape},ot={dataId:Qe.dataId,dtype:Qe.dtype,shape:fe.shape},ct=new Yt(H,le.shape,fe.shape);return ve.runWebGLProgram(ct,[rt,ot],ML(Ye.dtype,Qe.dtype))}),qe=Yz({inputs:{real:Be,imag:Ne},backend:ve});return ve.disposeIntermediateTensorInfo(Be),ve.disposeIntermediateTensorInfo(Ne),qe}const Se=re||ML(le.dtype,fe.dtype);if((le.dtype==="string"||fe.dtype==="string"||ve.shouldExecuteOnCPU([le,fe]))&&ee!=null){const Ie=ve.texData.get(le.dataId).values,De=ve.texData.get(fe.dataId).values,Be=le.dtype==="string"?uo(Ie):Ie,Ne=le.dtype==="string"?uo(De):De,[qe,Xe]=ee(le.shape,fe.shape,Be,Ne,Se),Ye=ve.makeTensorInfo(Xe,Se),Qe=ve.texData.get(Ye.dataId);return Qe.values=qe,Ye}const Ee=qM().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&_!=null;let Ce;return Ee?Ce=new YD(_,le.shape,fe.shape,b):Ce=new Yt(H,le.shape,fe.shape),ve.runWebGLProgram(Ce,[le,fe],Se)}}function YB(H,_=!1){if(H==="linear")return _?Je:Jq;if(H==="relu")return _?JX:JW;if(H==="elu")return _?Jz:JF;if(H==="relu6")return _?JG:JD;if(H==="prelu")return _?YL:Yj;if(H==="leakyrelu")return _?YG:YX;if(H==="sigmoid")return _?Jj:JZ;throw new Error("Activation "+H+" has not been implemented for the WebGL backend.")}const YV="return a + b;",YJ=YK({opSnippet:YV,packedOpSnippet:YV,supportsComplex:!0,cpuKernelImpl:Kz}),YY={kernelName:qG,backendName:"webgl",kernelFunc:YJ};class YP{constructor(_,b){this.outputShape=[],this.outputShape=_,this.variableNames=b.map((re,ae)=>"T"+ae);const $=[];this.variableNames.forEach(re=>{$.push("float v"+re+" = get"+re+"AtOutCoords();")});const ee=this.variableNames.map(re=>"v"+re).join(" + ");this.userCode=`
      void main() {
        `+$.join(`
        `)+`

        float result = `+ee+`;
        setOutput(result);
      }
    `}}class YU{constructor(_,b){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=_,this.variableNames=b.map((re,ae)=>"T"+ae);const $=[];this.variableNames.forEach(re=>{$.push("vec4 v"+re+" = get"+re+"AtOutCoords();")});const ee=this.variableNames.map(re=>"v"+re).join(" + ");this.userCode=`
      void main() {
        `+$.join(`
        `)+`

        vec4 result = `+ee+`;
        setOutput(result);
      }
    `}}function Pq(H){const{inputs:_,backend:b}=H,$=_;if($.length===1)return Ya({inputs:{x:$[0]},backend:b});if($.length>qM().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const xe=Math.floor($.length/2),le=Pq({inputs:$.slice(0,xe),backend:b}),fe=Pq({inputs:$.slice(xe),backend:b});return Pq({inputs:[le,fe],backend:b})}const ee=$.map(xe=>xe.dtype).reduce((xe,le)=>ML(xe,le)),re=$.map(xe=>xe.shape),ae=qM().getBool("WEBGL_PACK")?new YU($[0].shape,re):new YP($[0].shape,re);return b.runWebGLProgram(ae,$,ee)}const Ps={kernelName:qj,backendName:"webgl",kernelFunc:Pq},PM=YF+`
  return atan(a, b);
`,PF=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+YW+`
  return result;
`,PW=YK({opSnippet:PM,packedOpSnippet:PF}),PD={kernelName:qL,backendName:"webgl",kernelFunc:PW};class PZ{constructor(_,b,$,ee=!1,re=!1){if(this.variableNames=["x"],b==="avg"&&$)throw new Error("Cannot compute positions for average pool.");const ae=_.filterWidth,xe=_.strideHeight,le=_.strideWidth,fe=_.dilationHeight,ve=_.dilationWidth,Se=_.effectiveFilterHeight,Ee=_.effectiveFilterWidth,Ce=_.padInfo.top,Ie=_.padInfo.left;this.outputShape=_.outShape;const De=b==="avg",Be="((batch  * "+_.inHeight+" + xR) * "+_.inWidth+" + xC) * "+_.inChannels+" + d",Ne="(xR * "+_.inWidth+" + xC) * "+_.inChannels+" + d";let qe="0.0";if(De||(qe="-1.0 / 1e-20"),$){const ct=">=";this.userCode=`
        const ivec2 strides = ivec2(`+xe+", "+le+`);
        const ivec2 pads = ivec2(`+Ce+", "+Ie+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+Se+`;
              wR += `+fe+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+_.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+Ee+`;
                wC += `+ve+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+_.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value `+ct+` currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = `+(ee?re?Be:Ne:"wR * "+Ee+" + wC")+`;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const Xe="max";let Ye=b+"("+b+"("+b+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";b==="avg"&&(Ye="avgValue / max(count, 1.0)");const Qe=Math.floor(ae/4)*4,rt=ae%4,ot=`
      if (`+De+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = `+Xe+`(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+xe+", "+le+`);
      const ivec2 pads = ivec2(`+Ce+", "+Ie+`);
      const float initializationValue = `+qe+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+_.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+qe+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+Se+`;
            wR += `+fe+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+_.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+Qe+`; wC += 4) {
            int xC = xCCorner + wC * `+ve+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+ve+`, d),
              getValue(batch, xR, xC + 2 * `+ve+`, d),
              getValue(batch, xR, xC + 3 * `+ve+`, d)
            );

            `+ot+`
          }

          int xC = xCCorner + `+Qe+`;
          if (`+(rt===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+ot+`
          } else if (`+(rt===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+ve+`, d),
              initializationValue,
              initializationValue
            );

            `+ot+`
          } else if (`+(rt===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+ve+`, d),
              getValue(batch, xR, xC + 2 * `+ve+`, d),
              initializationValue
            );

            `+ot+`
          }
        }
        setOutput(`+Ye+`);
      }
    `}}function Pz(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_;dH(ee,"avgPool");const{filterSize:re,strides:ae,pad:xe,dimRoundingMode:le}=$,fe=1;k(iU(ae,fe),()=>"Error in avgPool: Either strides or dilations must be 1. Got strides "+ae+" and dilations '"+fe+"'");const ve=iG(ee.shape,re,ae,fe,xe,le);if(ve.filterWidth===1&&ve.filterHeight===1&&D(ve.inShape,ve.outShape))return Ya({inputs:{x:ee},backend:b});const Se=new PZ(ve,"avg",!1);return b.runWebGLProgram(Se,[ee],"float32")}const PX={kernelName:qR,backendName:"webgl",kernelFunc:Pz};class PG{constructor(_,b,$,ee=!1,re=!1,ae=!1,xe=null,le=!1,fe=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=$,this.enableShapeUniforms=CG(this.outputShape.length);const ve=ee?_[1]:_[2],Se=Math.ceil(ve/2),Ee=ee?"i * 2, rc.y":"rc.y, i * 2",Ce=re?"rc.z, i * 2":"i * 2, rc.z",Ie=ee?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],De=re?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let Be="",Ne="";xe&&(le?Be=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+xe+`
        }`:fe?Be=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          `+xe+`
        }`:Be=`vec4 activation(vec4 x) {
          `+xe+`
        }`,Ne="result = activation(result);");const qe=ae?"result += getBiasAtOutCoords();":"";ae&&this.variableNames.push("bias"),le&&this.variableNames.push("preluActivationWeights"),fe&&this.variableNames.push("leakyreluAlpha");let Xe="rc.x",Ye="rc.x";_[0]<b[0]?Xe="imod(rc.x, "+_[0]+")":b[0]<_[0]&&(Ye="imod(rc.x, "+b[0]+")"),this.userCode=`
      `+Be+`
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = `+Se+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = `+Xe+`;
        int batchB = `+Ye+`;
        for (int i = 0; i < `+Se+`; i++) {
          vec4 a = getMatrixA(batchA, `+Ee+`);
          vec4 b = getMatrixB(batchB, `+Ce+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+Ie[0]+" * "+De[0]+`);
          result += (`+Ie[1]+" * "+De[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+qe+`

        `+Ne+`

        setOutput(result);
      }
    `}}const Pj={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class PL{constructor(_,b,$){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=OR(b,$),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+_+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}const PR="return a * b;";function PQ(H){const{inputs:_,backend:b}=H,{a:$,b:ee}=_,re=ML($.dtype,ee.dtype);if($.dtype==="complex64"){const xe=b.texData.get($.dataId),le=b.texData.get(ee.dataId),fe=new PL(Pj.REAL,$.shape,ee.shape),ve=new PL(Pj.IMAG,$.shape,ee.shape),Se=[{dataId:xe.complexTensorInfos.real.dataId,dtype:xe.complexTensorInfos.real.dtype,shape:$.shape},{dataId:xe.complexTensorInfos.imag.dataId,dtype:xe.complexTensorInfos.imag.dtype,shape:$.shape},{dataId:le.complexTensorInfos.real.dataId,dtype:le.complexTensorInfos.real.dtype,shape:ee.shape},{dataId:le.complexTensorInfos.imag.dataId,dtype:le.complexTensorInfos.imag.dtype,shape:ee.shape}],Ee=b.runWebGLProgram(fe,Se,"float32"),Ce=b.runWebGLProgram(ve,Se,"float32"),Ie=Yz({inputs:{real:Ee,imag:Ce},backend:b});return b.disposeIntermediateTensorInfo(Ee),b.disposeIntermediateTensorInfo(Ce),Ie}if(b.shouldExecuteOnCPU([$,ee])){const xe=b.texData.get($.dataId),le=b.texData.get(ee.dataId),[fe,ve]=BW($.shape,ee.shape,xe.values,le.values,re),Se=b.makeTensorInfo(ve,re),Ee=b.texData.get(Se.dataId);return Ee.values=fe,Se}let ae;return qM().getBool("WEBGL_PACK_BINARY_OPERATIONS")?ae=new YD(PR,$.shape,ee.shape):ae=new Yt(PR,$.shape,ee.shape),b.runWebGLProgram(ae,[$,ee],re)}const PH={kernelName:pF,backendName:"webgl",kernelFunc:PQ};function PK(H,_,b){const $=[QU(H.shape),...d1(H.shape)],ee={dtype:H.dtype,shape:$,dataId:H.dataId},re=[QU(_),...d1(_)],ae=new VL(re,$),xe=!0,le=[$],fe=b.runWebGLProgram(ae,[ee],H.dtype,le,xe);return{dataId:fe.dataId,shape:_,dtype:fe.dtype}}function PB(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{shape:re}=$,ae=b,xe=i$1(ee.shape),le=e$1(re,xe),fe=i$1(le);k(xe===fe,()=>"The new shape ("+le+") has "+fe+" elements and the old shape ("+ee.shape+") has "+xe+" elements. The new shape and old shape must have the same number of elements.");const ve=ae.texData.get(ee.dataId);return ve.isPacked&&!dt(ee.shape,le)&&!(ve.texture!==null&&dt(ve.shape,le))?PK(ee,le,ae):(ae.incRef(ee.dataId),{dataId:ee.dataId,shape:le,dtype:ee.dtype})}const PV={kernelName:pL,backendName:"webgl",kernelFunc:PB};class PJ{constructor(_,b){this.variableNames=["x"];const{windowSize:$,batchSize:ee,inSize:re,outSize:ae}=_;this.outputShape=[ee,ae];const xe=Math.floor($/4)*4,le=$%4;let fe="sumValue += dot(values, ones);";if(b!=null){const Se=1/b;fe="sumValue += dot(values * "+(m$1(Se)?Se.toPrecision(2):Se)+", ones);"}let ve="";re%$>0&&(ve=`
        if (inIdx < 0 || inIdx >= `+re+`) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+ve+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+$+`;

        float sumValue = 0.0;

        for (int i = 0; i < `+xe+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+fe+`
        }

        int inIdx = inOffset + `+xe+`;
        if (`+(le===1)+`) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          `+fe+`
        } else if (`+(le===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          `+fe+`
        } else if (`+(le===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          `+fe+`
        }
        setOutput(sumValue);
      }
    `}}class PY{constructor(_,b){this.variableNames=["x"];const{windowSize:$,batchSize:ee,inSize:re,outSize:ae}=_;this.outputShape=[ee,ae];let xe="0.0",le="";b==="prod"?xe="1.0":b==="min"?(xe="1.0 / 1e-20",le="min"):b==="max"&&(xe="-1.0 / 1e-20",le="max");let fe=b+"("+b+"("+b+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";b==="sum"?fe="sumValue":b==="prod"?fe="prodValue":b==="all"?fe="allValue":b==="any"&&(fe="anyValue");const ve=Math.floor($/4)*4,Se=$%4;let Ee=`
      if (`+(b==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(b==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+le+`(values, minMaxValue);
        if (`+(b==="min")+" || "+(b==="max")+`) {
          minMaxValue = `+le+`(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,Ce="vec4";b==="all"?(xe="1.0",Ee=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,Ce="bvec4"):b==="any"&&(xe="0.0",Ee=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,Ce="bvec4");let Ie="";re%$>0&&(Ie=`
        if (inIdx < 0 || inIdx >= `+re+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+xe+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+Ie+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+$+`;

        vec4 minMaxValue = vec4(`+xe+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+ve+`; i += 4) {
          int inIdx = inOffset + i;
          `+Ce+" values = "+Ce+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+Ee+`
        }

        int inIdx = inOffset + `+ve+`;
        if (`+(Se===1)+`) {
          `+Ce+" values = "+Ce+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+Ee+`
        } else if (`+(Se===2)+`) {
          `+Ce+" values = "+Ce+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+Ee+`
        } else if (`+(Se===3)+`) {
          `+Ce+" values = "+Ce+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+Ee+`
        }
        setOutput(`+fe+`);
      }
    `}}function PP(H){const _=[];for(;_.length===0||_[_.length-1].outSize!==1;){const b=_.length?_[_.length-1].outSize:H[1],$=GL(b);_.push({inSize:b,windowSize:$,outSize:Math.ceil(b/$)})}return _}function PU(H,_,b,$){const ee=PP(H.shape);let re=H;for(let ae=0;ae<ee.length;ae++){const{inSize:xe,windowSize:le,outSize:fe}=ee[ae];let ve,Se;b==="mean"?ve=ae===0?new PJ({windowSize:le,inSize:xe,batchSize:H.shape[0],outSize:fe},xe):new PJ({windowSize:le,inSize:xe,batchSize:H.shape[0],outSize:fe}):ve=new PY({windowSize:le,inSize:xe,batchSize:H.shape[0],outSize:fe},b),Se=re,re=$.runWebGLProgram(ve,[re],_),Se.dataId!==H.dataId&&$.disposeIntermediateTensorInfo(Se)}return re}class Uq{constructor(_,b){this.variableNames=["A"];const $=new Array(_.length);for(let ae=0;ae<$.length;ae++)$[ae]=_[b[ae]];this.outputShape=$,this.rank=$.length;const ee=yU(this.rank),re=Un(b);this.userCode=`
    void main() {
      `+ee+` resRC = getOutputCoords();
      setOutput(getA(`+re+`));
    }
    `}}function Un(H){const _=H.length;if(_>6)throw Error("Transpose for rank "+_+" is not yet supported");const b=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],$=new Array(_);for(let ee=0;ee<H.length;ee++)$[H[ee]]=b[ee];return $.join()}class Us{constructor(_,b){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const $=new Array(_.length);for(let ve=0;ve<$.length;ve++)$[ve]=_[b[ve]];if(this.outputShape=$,this.rank=$.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");const ee=yU(this.rank),re=Vz("rc",this.rank),ae=new Array(this.rank);for(let ve=0;ve<b.length;ve++)ae[b[ve]]=re[ve];const xe="vec2("+ae.slice(-2).join()+")",le="++"+re[this.rank-1]+" < "+$[this.rank-1],fe="getChannel(getA("+ae.join()+"), "+xe+")";this.userCode=`
    void main() {
      `+ee+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+fe+`;
      if(`+le+`) {
        result[1] = `+fe+`;
      }
      --`+re[this.rank-1]+`;
      if(++`+re[this.rank-2]+" < "+$[this.rank-2]+`) {
        result[2] = `+fe+`;
        if(`+le+`) {
          result[3] = `+fe+`;
        }
      }
      setOutput(result);
    }
    `}}function UM(H,_,b){const $=qM().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Us(H.shape,_):new Uq(H.shape,_);return b.runWebGLProgram($,[H],H.dtype)}function UF(H,_,b,$){const ee=_,re=H.shape.length,ae=z$1(ee,H.shape);let xe=ae;const le=at(xe,re),fe=le!=null;let ve=H;fe&&(ve=UM(H,le,$),xe=aD(xe.length,re)),aF("sum",xe,re);const[Se,Ee]=aq(ve.shape,xe);let Ce=Se;b&&(Ce=aM(Se,ae));const Ie=i$1(Ee),De=i$1(H.shape)/Ie,Be=PB({inputs:{x:ve},attrs:{shape:[De,Ie]},backend:$}),Ne=MR(H.dtype),qe=PU(Be,Ne,"sum",$),Xe=PB({inputs:{x:qe},attrs:{shape:Ce},backend:$});return $.disposeIntermediateTensorInfo(Be),$.disposeIntermediateTensorInfo(qe),fe&&$.disposeIntermediateTensorInfo(ve),Xe}function Ut(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{axis:re,keepDims:ae}=$;return UF(ee,re,ae,b)}const UW={kernelName:pU,backendName:"webgl",kernelFunc:Ut};function UD(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{perm:re}=$,ae=b,xe=ee.shape.length,le=new Array(xe);for(let ve=0;ve<le.length;ve++)le[ve]=ee.shape[re[ve]];let fe;if(ae.shouldExecuteOnCPU([ee])){const ve=ae.texData.get(ee.dataId).values,Se=VZ(ve,ee.shape,ee.dtype,re,le);fe=ae.makeTensorInfo(le,ee.dtype);const Ee=ae.texData.get(fe.dataId);Ee.values=Se}else fe=UM(ee,re,ae);return fe}const UZ={kernelName:gD,backendName:"webgl",kernelFunc:UD},Ue=1e3;function Uz({a:H,b:_,transposeA:b,transposeB:$,backend:ee,bias:re=null,preluActivationWeights:ae=null,leakyreluAlpha:xe=0,activation:le=null}){const fe=H.shape.length,ve=_.shape.length,Se=b?H.shape[fe-2]:H.shape[fe-1],Ee=$?_.shape[ve-1]:_.shape[ve-2],Ce=b?H.shape[fe-1]:H.shape[fe-2],Ie=$?_.shape[ve-2]:_.shape[ve-1],De=H.shape.slice(0,-2),Be=_.shape.slice(0,-2),Ne=i$1(De),qe=i$1(Be),Xe=OR(H.shape.slice(0,-2),_.shape.slice(0,-2)).concat([Ce,Ie]);k(Se===Ee,()=>"Error in matMul: inner shapes ("+Se+") and ("+Ee+") of Tensors with shapes "+H.shape+" and "+_.shape+" and transposeA="+b+" and transposeB="+$+" must match.");const Ye=b?[Ne,Se,Ce]:[Ne,Ce,Se],Qe=$?[qe,Ie,Ee]:[qe,Ee,Ie],rt=PB({inputs:{x:H},backend:ee,attrs:{shape:Ye}}),ot=PB({inputs:{x:_},backend:ee,attrs:{shape:Qe}}),ct=[rt,ot],mt=Math.max(Ne,qe),_t=b?rt.shape[1]:rt.shape[2],Lt=re!=null,Vt=ae!=null,Gt=le==="leakyrelu",$t=le!=null?YB(le,!0):null,Qt=Lt||Vt||Gt||$t!=null;let vt;if((Ce===1||Ie===1)&&_t>Ue&&Qt===!1){let gt=rt,Tt=ot;b&&(gt=UD({inputs:{x:rt},backend:ee,attrs:{perm:[0,2,1]}}),ct.push(gt)),$&&(Tt=UD({inputs:{x:ot},backend:ee,attrs:{perm:[0,2,1]}}),ct.push(Tt));const Ct=Ie!==1,Ft=Ie===1;let sn=gt;Ct&&(sn=PB({inputs:{x:gt},backend:ee,attrs:{shape:[mt,_t,1]}}),ct.push(sn));const cn=Ie===1?2:1;let en=Tt;Ft&&(en=PB({inputs:{x:Tt},backend:ee,attrs:{shape:[mt,1,_t]}}),ct.push(en));const yn=PQ({inputs:{a:sn,b:en},backend:ee});vt=Ut({inputs:{x:yn},backend:ee,attrs:{axis:cn,keepDims:!0}}),ct.push(yn)}else{const gt=ML(H.dtype,_.dtype),Tt=new PG(Ye,Qe,[mt,Ce,Ie],b,$,Lt,$t,Vt,Gt),Ct=[rt,ot];if(re!=null&&Ct.push(re),Vt&&Ct.push(ae),Gt){const Ft=ee.makeTensorInfo([],"float32",Eq(xe,"float32"));Ct.push(Ft),ct.push(Ft)}vt=ee.runWebGLProgram(Tt,Ct,gt)}const It=PB({inputs:{x:vt},backend:ee,attrs:{shape:Xe}});ct.push(vt);for(const gt of ct)ee.disposeIntermediateTensorInfo(gt);return It}function UX(H){const{inputs:_,backend:b,attrs:$}=H,{a:ee,b:re}=_,{transposeA:ae,transposeB:xe}=$;return Uz({a:ee,b:re,transposeA:ae,transposeB:xe,backend:b})}const UG={kernelName:qo,backendName:"webgl",kernelFunc:UX},Uj="return float(a != b);",UL=YK({opSnippet:Uj,cpuKernelImpl:BZ,dtype:"bool"});function UR(H){const{inputs:_,backend:b}=H,{input:$}=_,ee=b.texData.get($.dataId);return Ya({inputs:{x:ee.complexTensorInfos.real},backend:b})}const UQ="return float(int(x));";function UH(H,_){const b=new VP(H.shape,UQ),$=_.runWebGLProgram(b,[H],"int32");return{dataId:$.dataId,shape:$.shape,dtype:$.dtype}}function UK(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{dtype:re}=$;if(re==="complex64"){if(ee.dtype==="complex64")return Ya({inputs:{x:ee},backend:b});const ae=wF(ee.shape),xe=UK({inputs:{x:ee},backend:b,attrs:{dtype:"float32"}}),le=Yz({inputs:{real:xe,imag:ae},backend:b});return ae.dispose(),b.disposeIntermediateTensorInfo(xe),le}if(ee.dtype==="complex64"){const ae=UR({inputs:{input:ee},backend:b}),xe=UK({inputs:{x:ae},backend:b,attrs:{dtype:re}});return b.disposeIntermediateTensorInfo(ae),xe}if(!j(ee.dtype,re)){const ae=Ya({inputs:{x:ee},backend:b});return{dataId:ae.dataId,shape:ae.shape,dtype:re}}if(b.shouldExecuteOnCPU([ee])){const ae=b.texData.get(ee.dataId).values,[xe,le,fe]=KL(ae,ee.shape,ee.dtype,re);return b.makeTensorInfo(xe,le,fe)}if(re==="int32")return UH(ee,b);if(re==="bool"){const ae=b.makeTensorInfo([],"bool",X("bool",1)),xe=UL({inputs:{a:ee,b:ae},backend:b});return b.disposeIntermediateTensorInfo(ae),xe}throw new Error("Error in Cast: failed to cast "+ee.dtype+" to "+re)}const UB={kernelName:qH,backendName:"webgl",kernelFunc:UK};class UV{constructor(_){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=_,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}class UJ{constructor(_){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=_,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}function UY(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{clipValueMin:re,clipValueMax:ae}=$;let xe;qM().getBool("WEBGL_PACK_CLIP")?xe=new UJ(ee.shape):xe=new UV(ee.shape);const le=[[re],[ae]];return b.runWebGLProgram(xe,[ee],ee.dtype,le)}const UP={kernelName:qK,backendName:"webgl",kernelFunc:UY};class UU{constructor(_){this.outputShape=[],this.outputShape=GD(_,1),this.variableNames=_.map((ae,xe)=>"T"+xe);const b=new Array(_.length-1);b[0]=_[0][1];for(let ae=1;ae<b.length;ae++)b[ae]=b[ae-1]+_[ae][1];const $=["if (yC < "+b[0]+") setOutput(getT0(yR, yC));"];for(let ae=1;ae<b.length;ae++){const xe=b[ae-1];$.push("else if (yC < "+b[ae]+") setOutput(getT"+ae+"(yR, yC-"+xe+"));")}const ee=b.length,re=b[b.length-1];$.push("else setOutput(getT"+ee+"(yR, yC-"+re+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+$.join(`
        `)+`
      }
    `}}class q00{constructor(_,b){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=GD(_,b);const $=this.outputShape,ee=$.length,re=yU(ee),ae=VX("coords",ee),xe=["x","y","z","w","u","v"].slice(0,ee);this.variableNames=_.map((De,Be)=>"T"+Be);const le=new Array(_.length-1);le[0]=_[0][b];for(let De=1;De<le.length;De++)le[De]=le[De-1]+_[De][b];const fe=xe[b],ve=xe.slice(-2),Se=xe.join();let Ee="if ("+fe+" < "+le[0]+`) {
        return getChannel(
            getT0(`+Se+"), vec2("+ve.join()+`));
        }`;for(let De=1;De<le.length;De++){const Be=le[De-1];Ee+=`
        if (`+fe+" < "+le[De]+"  && "+fe+" >= "+le[De-1]+`) {
          return getChannel(
            getT`+De+"("+q01(xe,fe,Be)+`),
            vec2(`+q01(ve,fe,Be)+`));
        }`}const Ce=le.length,Ie=le[le.length-1];Ee+=`
        return getChannel(
          getT`+Ce+"("+q01(xe,fe,Ie)+`),
          vec2(`+q01(ve,fe,Ie)+"));",this.userCode=`
      float getValue(`+xe.map(De=>"int "+De)+`) {
        `+Ee+`
      }

      void main() {
        `+re+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+ae+`), 0., 0., 0.);

        `+ae[ee-1]+" = "+ae[ee-1]+` + 1;
        if (`+ae[ee-1]+" < "+$[ee-1]+`) {
          result.g = getValue(`+ae+`);
        }

        `+ae[ee-2]+" = "+ae[ee-2]+` + 1;
        if (`+ae[ee-2]+" < "+$[ee-2]+`) {
          result.a = getValue(`+ae+`);
        }

        `+ae[ee-1]+" = "+ae[ee-1]+` - 1;
        if (`+ae[ee-2]+" < "+$[ee-2]+` &&
            `+ae[ee-1]+" < "+$[ee-1]+`) {
          result.b = getValue(`+ae+`);
        }
        setOutput(result);
      }
    `}}function q01(H,_,b){const $=H.indexOf(_);return H.map((ee,re)=>re===$?ee+" - "+b:ee).join()}function q02(H){const{inputs:_,backend:b}=H,{input:$}=_,ee=b.texData.get($.dataId);return Ya({inputs:{x:ee.complexTensorInfos.imag},backend:b})}function q03(H,_,b){const $=H[0].dtype;if($==="complex64"){const Ce=H.map(qe=>UR({inputs:{input:qe},backend:b})),Ie=H.map(qe=>q02({inputs:{input:qe},backend:b})),De=q03(Ce,_,b),Be=q03(Ie,_,b),Ne=Yz({inputs:{real:De,imag:Be},backend:b});return Ce.forEach(qe=>b.disposeIntermediateTensorInfo(qe)),Ie.forEach(qe=>b.disposeIntermediateTensorInfo(qe)),b.disposeIntermediateTensorInfo(De),b.disposeIntermediateTensorInfo(Be),Ne}let ee=b.shouldExecuteOnCPU(H);if($==="string"&&(ee=!0),ee){const Ce=H.map(Ye=>{const Qe=[-1,i$1(Ye.shape.slice(_))];return PB({inputs:{x:Ye},backend:b,attrs:{shape:Qe}})}),Ie=Ce.map(Ye=>({vals:b.readSync(Ye.dataId),shape:Ye.shape})),De=GD(Ce.map(Ye=>Ye.shape),1),Be=Ce[0].shape[0]===1,Ne=Ko(Ie,De,$,Be),qe=GD(H.map(Ye=>Ye.shape),_),Xe=b.makeTensorInfo(qe,$,Ne);return Ce.forEach(Ye=>b.disposeIntermediateTensorInfo(Ye)),Xe}const re=H.filter(Ce=>i$1(Ce.shape)>0),ae=qM().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&re[0].shape.length>1;if(re.length===1){const Ce=ae?new VP(H[0].shape,Ja):new JL(H[0].shape,Ja);return b.runWebGLProgram(Ce,H,$)}const xe=qM().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(re.length>xe){const Ce=[];for(let De=0;De<re.length;De+=xe){const Be=re.slice(De,De+xe);Ce.push(q03(Be,_,b))}const Ie=q03(Ce,_,b);for(const De of Ce)b.disposeIntermediateTensorInfo(De);return Ie}if(ae){const Ce=new q00(re.map(Ie=>Ie.shape),_);return b.runWebGLProgram(Ce,re,$)}const{tensors2D:le,outShape:fe}=q04(re,_,b),ve=new UU(le.map(Ce=>Ce.shape)),Se=b.runWebGLProgram(ve,le,$);le.forEach(Ce=>b.disposeIntermediateTensorInfo(Ce));const Ee=PB({inputs:{x:Se},attrs:{shape:fe},backend:b});return b.disposeIntermediateTensorInfo(Se),Ee}function q04(H,_,b){const $=GD(H.map(ee=>ee.shape),_);return{tensors2D:H.map(ee=>PB({inputs:{x:ee},attrs:{shape:[-1,i$1(ee.shape.slice(_))]},backend:b})),outShape:$}}function q05(H){const{inputs:_,backend:b,attrs:$}=H,{axis:ee}=$,re=z$1(ee,_[0].shape)[0],ae=_.map(fe=>fe.shape);GW(ae,re);const xe=GD(_.map(fe=>fe.shape),re);if(i$1(xe)===0)return b.makeTensorInfo(xe,_[0].dtype,[]);const le=_.filter(fe=>i$1(fe.shape)>0);return le.length===1?Ya({inputs:{x:le[0]},backend:b}):q03(le,re,b)}const q06={kernelName:qJ,backendName:"webgl",kernelFunc:q05};class q07{constructor(_,b=!1,$=null,ee=!1,re=!1){this.variableNames=["x","W"],this.outputShape=_.outShape;const ae=_.padInfo.top,xe=_.padInfo.left,le=_.strideHeight,fe=_.strideWidth,ve=_.dilationHeight,Se=_.dilationWidth,Ee=_.filterHeight,Ce=_.filterWidth,Ie=Math.floor(_.inChannels/4)*4,De=_.inChannels%4,Be=_.dataFormat==="channelsLast",Ne=Be?1:2,qe=Be?2:3,Xe=Be?3:1;let Ye="",Qe="";$&&(ee?Ye=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+$+`
        }`:re?Ye=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          `+$+`
        }`:Ye=`
          float activation(float x) {
            `+$+`
          }
        `,Qe="result = activation(result);");const rt=b?"result += getBiasAtOutCoords();":"";b&&this.variableNames.push("bias"),ee&&this.variableNames.push("preluActivationWeights"),re&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      `+Ye+`

      const ivec2 strides = ivec2(`+le+", "+fe+`);
      const ivec2 pads = ivec2(`+ae+", "+xe+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+Xe+`];

        ivec2 xRCCorner =
            ivec2(coords[`+Ne+"], coords["+qe+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+Ee+`; wR++) {
          int xR = xRCorner + wR * `+ve+`;

          if (xR < 0 || xR >= `+_.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+Ce+`; wC++) {
            int xC = xCCorner + wC * `+Se+`;

            if (xC < 0 || xC >= `+_.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+Ie+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+Be+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(De===1)+`) {

              if (`+Be+`) {
                dotProd +=
                    getX(batch, xR, xC, `+Ie+`) *
                    getW(wR, wC, `+Ie+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+Ie+`, xR, xC) *
                    getW(wR, wC, `+Ie+`, d2);
              }

            } else if (`+(De===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+Ie+`, d2),
                getW(wR, wC, `+Ie+` + 1, d2)
              );

              if (`+Be+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+Ie+`),
                  getX(batch, xR, xC, `+Ie+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+Ie+`, xR, xC),
                  getX(batch, `+Ie+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(De===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+Ie+`, d2),
                getW(wR, wC, `+Ie+` + 1, d2),
                getW(wR, wC, `+Ie+` + 2, d2)
              );

              if (`+Be+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+Ie+`),
                  getX(batch, xR, xC, `+Ie+` + 1),
                  getX(batch, xR, xC, `+Ie+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+Ie+`, xR, xC),
                  getX(batch, `+Ie+` + 1, xR, xC),
                  getX(batch, `+Ie+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+rt+`
        `+Qe+`
        setOutput(result);
      }
    `}}class q08{constructor(_,b=!1,$=null,ee=!1,re=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=_.outShape,this.enableShapeUniforms=CG(this.outputShape.length);const ae=_.padInfo.left,xe=_.strideWidth,le=_.dilationWidth,fe=_.filterHeight,ve=_.filterWidth,Se=ve;let Ee=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let Be=0;Be<ve;Be++)Ee+=`
           vec4 xTexelC`+Be*2+`;
           int xTexelC`+Be*2+`Ready;
           vec4 xTexelC`+(Be*2+1)+`;
           int xTexelC`+(Be*2+1)+`Ready;
           vec4 xC`+Be+";";Ee+=`
     for (int r = 0; r < `+fe+`; r++) {
      for (int d1 = 0; d1 < `+_.inChannels+`; d1 += 2) {
       `;for(let Be=0;Be<ve;Be++)Ee+=`
           xTexelC`+Be*2+` = vec4(0.0);
           xTexelC`+Be*2+`Ready = 0;
           xTexelC`+(Be*2+1)+` = vec4(0.0);
           xTexelC`+(Be*2+1)+`Ready = 0;
           xC`+Be+" = vec4(0.0);";Ee+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let Be=0;Be<(Se+1)/2;Be++){const Ne=Be*2;if(Ee+=`
           xC = xCCorner + `+Ne*le+`;
           `,xe===1){if(Ne<ve&&(ae%2===1?(Ee+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC`+Ne+`Ready == 0) {
                   xTexelC`+Ne+` = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC`+Ne+`.zw = vec2(0.0);
                   }
                   xTexelC`+Ne+`Ready = 1;
                 }
               `,le===1&&Ne>0?Ee+=`
                 xC`+Ne+" = vec4(xTexelC"+(Ne-2)+".zw, xTexelC"+Ne+`.xy);
                 `:Ee+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC`+Ne+" = vec4(previous.zw, xTexelC"+Ne+`.xy);
                   } else {
                     xC`+Ne+" = vec4(0.0, 0.0, xTexelC"+Ne+`.xy);
                   }
                   `):Ee+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC`+Ne+`Ready == 0) {
                   xTexelC`+Ne+` = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC`+Ne+`.zw = vec2(0.0);
                   }
                   xTexelC`+Ne+`Ready = 1;
                 }

                 xC`+Ne+" = xTexelC"+Ne+`;
                 `,Ne+1<ve)){const qe=ae%2===0?f$1(le):le;le%2===0&&ae%2===1||le%2!==0&&ae%2!==1?(Ee+=`
                   xCOffset = xC + imod(pads[1], 2) + `+qe+`;

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC`+(Ne+1)+`Ready == 0) {
                     xTexelC`+(Ne+1)+` = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC`+(Ne+1)+`.zw = vec2(0.0);
                     }
                     xTexelC`+(Ne+1)+`Ready = 1;
                   }
                   `,le>1?Ee+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC`+(Ne+1)+" = vec4(previous.zw, xTexelC"+(Ne+1)+`.xy);
                     } else {
                      xC`+(Ne+1)+" = vec4(0.0, 0.0, xTexelC"+(Ne+1)+`.xy);
                     }
                     `:Ee+=`
                     xC`+(Ne+1)+" = vec4(xTexelC"+Ne+".zw, xTexelC"+(Ne+1)+`.xy);
                     `):qe===1?Ee+=`
                     xC`+(Ne+1)+" = xTexelC"+Ne+`;
                     `:Ee+=`
                     xCOffset = xC + `+qe+`;

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC`+(Ne+1)+`Ready == 0) {
                       xTexelC`+(Ne+1)+` = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC`+(Ne+1)+`.zw = vec2(0.0);
                       }
                       xTexelC`+(Ne+1)+`Ready = 1;
                     }

                     xC`+(Ne+1)+" = xTexelC"+(Ne+1)+`;
                     `}}else Ne<ve&&(ae%2===1?(Ee+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC`+Ne+`Ready == 0) {
                   xTexelC`+Ne+` = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC`+Ne+`.zw = vec2(0.0);
                   }
                   xTexelC`+Ne+`Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC`+(Ne+1)+`Ready == 0) {
                   xTexelC`+(Ne+1)+` = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC`+(Ne+1)+`.zw = vec2(0.0);
                   }
                   xTexelC`+(Ne+1)+`Ready = 1;
                 }

                 xC`+Ne+" = vec4(xTexelC"+Ne+".zw, xTexelC"+(Ne+1)+`.zw);
               `,Ne+1<ve&&(Ee+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC`+(Ne+1)+" = vec4(xTexelC"+(Ne+1)+`.xy, final.xy);
                 `)):(Ee+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC`+Ne+`Ready == 0) {
                   xTexelC`+Ne+` = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC`+Ne+`.zw = vec2(0.0);
                   }
                   xTexelC`+Ne+`Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC`+(Ne+1)+`Ready == 0) {
                   xTexelC`+(Ne+1)+` = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC`+(Ne+1)+`.zw = vec2(0.);
                   }
                   xTexelC`+(Ne+1)+`Ready = 1;
                 }

                 xC`+Ne+` = vec4(
                   xTexelC`+Ne+".xy, xTexelC"+(Ne+1)+`.xy);
               `,Ne+1<ve&&(Ee+=`
                   xC`+(Ne+1)+" = vec4(xTexelC"+Ne+".zw, xTexelC"+(Ne+1)+`.zw);
                 `)));Ne<ve&&(Ee+=`
             wTexel = getW(r, `+Ne+`, d1, d2);
             dotProd += xC`+Ne+`.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < `+_.inChannels+`) {
               dotProd += xC`+Ne+`.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,Ne+1<ve&&(Ee+=`
               wTexel = getW(r, `+(Ne+1)+`, d1, d2);
               dotProd += xC`+(Ne+1)+`.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < `+_.inChannels+`) {
                 dotProd += xC`+(Ne+1)+`.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}Ee+=`
     }
   `,Ee+=`
     }
   `,Ee+=`
     }
   `;let Ce="",Ie="";$&&(ee?Ce=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           `+$+`
         }`:re?Ce=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           `+$+`
         }`:Ce=`vec4 activation(vec4 x) {
           `+$+`
         }`,Ie="result = activation(result);");const De=b?"result += getBiasAtOutCoords();":"";b&&this.variableNames.push("bias"),ee&&this.variableNames.push("preluActivationWeights"),re&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       `+Ce+`

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         `+Ee+`

         vec4 result = dotProd - vec4(0.000000000000001);
         `+De+`
         `+Ie+`
         setOutput(result);
       }
     `}}class q09{constructor(_,b){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=_,this.enableShapeUniforms=CG(this.outputShape.length);const{dataFormat:$}=b,ee=dB(),re=$==="channelsLast",ae=re?1:2,xe=re?2:3,le=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < "+_[2]+" && pos < "+_[1]+") {";let fe="";for(let ve=0;ve<=1;ve++)for(let Se=0;Se<=1;Se++)fe+=`
          blockIndex = rc.z + `+Se+`;
          pos = rc.y + `+ve+`;

          `+le+`
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[`+ae+`] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[`+xe+`] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (`+re+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(ve*2+Se)+`] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(ve*2+Se)+`] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+fe+`

        `+ee.output+` = result;
      }
    `}}function q0q(H,_){const b=H.length;return b>=3?_?[...H.slice(0,-3),H[b-3]*H[b-2],H[b-1]]:[...H.slice(0,-3),H[b-3],H[b-2]*H[b-1]]:!_&&b===1&&H[0]>1?[H[0],1]:null}function q0n({x:H,filter:_,convInfo:b,backend:$,bias:ee=null,preluActivationWeights:re=null,leakyreluAlpha:ae=0,activation:xe=null}){const le=H.shape,fe=$.texData.get(H.dataId),ve=b.inChannels,Se=le[0]*le[1]*le[2],Ee=b.outChannels,Ce=b.dataFormat==="channelsLast",Ie=!1,De=!1;let Be;const Ne=[];if(re!=null){const qe=q0q(re.shape,Ce);qe!=null&&(re=PB({inputs:{x:re},backend:$,attrs:{shape:qe}}),Ne.push(re))}if(ee!=null){const qe=q0q(ee.shape,Ce);qe!=null&&(ee=PB({inputs:{x:ee},backend:$,attrs:{shape:qe}}),Ne.push(ee))}if(!((Se===1||Ee===1)&&ve>Ue)&&fe.isPacked&&Ce&&fe.texture!=null&&le[2]%2!==0&&D(fe.shape.slice(-3),le.slice(-3))){const qe=le[0]*le[1]*(le[2]+1),Xe={dataId:H.dataId,shape:[1,qe,b.inChannels],dtype:H.dtype},Ye=fe.shape;fe.shape=fe.shape.slice(),fe.shape[fe.shape.length-2]++,k(dt(fe.shape,Xe.shape),()=>"packed reshape "+fe.shape+" to "+Xe.shape+" isn't free");const Qe=PB({inputs:{x:_},backend:$,attrs:{shape:[1,b.inChannels,b.outChannels]}});Ne.push(Qe);const rt=Uz({a:Xe,b:Qe,backend:$,transposeA:Ie,transposeB:De,bias:ee,activation:xe,preluActivationWeights:re,leakyreluAlpha:ae}),ot=$.texData.get(rt.dataId);k(ot.isPacked,()=>"batchMatMul result is expected to be packed"),fe.shape=Ye,ot.shape=b.outShape,Be=Ya({inputs:{x:rt},backend:$}),Be.shape=b.outShape,Ne.push(rt)}else{const qe=b.outHeight*b.outWidth,Xe=PB({inputs:{x:H},backend:$,attrs:{shape:Ce?[b.batchSize,qe,b.inChannels]:[b.batchSize,b.inChannels,qe]}}),Ye=PB({inputs:{x:_},backend:$,attrs:{shape:[1,b.inChannels,b.outChannels]}}),Qe=Uz({a:Ce?Xe:Ye,b:Ce?Ye:Xe,transposeA:!Ce,transposeB:De,backend:$,bias:ee,activation:xe,preluActivationWeights:re,leakyreluAlpha:ae});Be=PB({inputs:{x:Qe},backend:$,attrs:{shape:b.outShape}}),Ne.push(Xe),Ne.push(Ye),Ne.push(Qe)}for(const qe of Ne)$.disposeIntermediateTensorInfo(qe);return Be}function q0p({x:H,filter:_,convInfo:b,backend:$,bias:ee=null,preluActivationWeights:re=null,leakyreluAlpha:ae=0,activation:xe=null}){const{filterWidth:le,filterHeight:fe,inChannels:ve,outWidth:Se,outHeight:Ee,dataFormat:Ce}=b,Ie=Ce==="channelsLast",De=le*fe*ve,Be=Ee*Se,Ne=[b.batchSize,De,Be],qe=!0,Xe=!1,Ye=[];if(re!=null){const gt=q0q(re.shape,Ie);gt!=null&&(re=PB({inputs:{x:re},backend:$,attrs:{shape:gt}}),Ye.push(re))}if(ee!=null){const gt=q0q(ee.shape,Ie);gt!=null&&(ee=PB({inputs:{x:ee},backend:$,attrs:{shape:gt}}),Ye.push(ee))}const Qe=PB({inputs:{x:_},backend:$,attrs:{shape:[1,De,i$1(_.shape)/De]}});Ye.push(Qe);const rt=new q09(Ne,b),ot=[H.shape,[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inChannels],[b.filterWidth*b.inChannels],[b.outWidth]],ct=$.runWebGLProgram(rt,[H],"float32",ot),mt=PB({inputs:{x:ct},backend:$,attrs:{shape:Ne}});Ye.push(ct),Ye.push(mt);const _t=ee!=null,Lt=re!=null,Vt=xe==="leakyrelu",Gt=xe?YB(xe,!0):null,$t=new PG(Ie?mt.shape:Qe.shape,Ie?Qe.shape:mt.shape,Ie?[b.batchSize,Be,b.outChannels]:[b.batchSize,b.outChannels,Be],qe,Xe,_t,Gt,Lt,Vt),Qt=Ie?[mt,Qe]:[Qe,mt];if(ee&&Qt.push(ee),Lt&&Qt.push(re),Vt){const gt=$.makeTensorInfo([],"float32",Eq(ae,"float32"));Qt.push(gt),Ye.push(gt)}const vt=$.runWebGLProgram($t,Qt,"float32"),It=PB({inputs:{x:vt},backend:$,attrs:{shape:b.outShape}});Ye.push(vt);for(const gt of Ye)$.disposeIntermediateTensorInfo(gt);return It}function q0g(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee,filter:re}=_,{strides:ae,pad:xe,dataFormat:le,dilations:fe,dimRoundingMode:ve}=$,Se=Ds(le),Ee=ij(ee.shape,re.shape,ae,fe,xe,ve,!1,Se);let Ce;if(Ee.filterHeight===1&&Ee.filterWidth===1&&Ee.dilationHeight===1&&Ee.dilationWidth===1&&Ee.strideHeight===1&&Ee.strideWidth===1&&(Ee.padInfo.type==="SAME"||Ee.padInfo.type==="VALID"))Ce=q0n({x:ee,filter:re,convInfo:Ee,backend:b});else if(Ee.strideWidth<=2&&Se==="channelsLast"&&qM().getBool("WEBGL_EXP_CONV")){const De=new q08(Ee),Be=[[Ee.padInfo.top,Ee.padInfo.left],[Ee.strideHeight,Ee.strideWidth],[Ee.dilationHeight,Ee.dilationWidth],[Ee.inHeight,Ee.inWidth]];Ce=b.runWebGLProgram(De,[ee,re],"float32",Be)}else if(qM().getBool("WEBGL_CONV_IM2COL"))Ce=q0p({x:ee,filter:re,convInfo:Ee,backend:b});else{const De=new q07(Ee);Ce=b.runWebGLProgram(De,[ee,re],"float32")}const Ie=PB({inputs:{x:Ce},backend:b,attrs:{shape:Ee.outShape}});return b.disposeIntermediateTensorInfo(Ce),Ie}const q0x={kernelName:qY,backendName:"webgl",kernelFunc:q0g};class q0s{constructor(_){this.variableNames=["dy","W"],this.outputShape=_.inShape;const b=_.filterHeight,$=_.filterWidth,ee=_.strideHeight,re=_.strideWidth,ae=_.dataFormat==="channelsLast",xe=b-1-_.padInfo.top,le=$-1-_.padInfo.left,fe=ae?1:2,ve=ae?2:3,Se=ae?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+xe+", "+le+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+Se+`];

        ivec2 dyCorner = ivec2(coords[`+fe+"], coords["+ve+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+b+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+ee+`.0;

          if (dyR < 0.0 || dyR >= `+_.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+b+` - 1 - wR;

          for (int wC = 0; wC < `+$+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+re+`.0;

            if (dyC < 0.0 || dyC >= `+_.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+$+` - 1 - wC;

            for (int d2 = 0; d2 < `+_.outChannels+`; d2++) {

              if (`+ae+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class q0E{constructor(_){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=_.inShape,this.enableShapeUniforms=CG(this.outputShape.length);const b=_.filterHeight,$=_.filterWidth,ee=b-1-_.padInfo.top,re=$-1-_.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(`+ee+", "+re+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < `+b+`; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= `+_.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = `+b+` - 1 - wR;

          for (int wC = 0; wC < `+$+`; wC++) {
            int wCPerm = `+$+` - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < `+_.outWidth+`.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < `+_.outWidth+`.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < `+_.outChannels+`; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < `+_.outChannels+`; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < `+_.outChannels+`; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}function q0M(H){const{inputs:_,backend:b,attrs:$}=H,{dy:ee,filter:re}=_,{inputShape:ae,strides:xe,pad:le,dataFormat:fe,dimRoundingMode:ve}=$,Se=Ds(fe),Ee=ij(ae,re.shape,xe,1,le,ve,!1,Se);if(qM().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&Se==="channelsLast"){const Ce=[[Ee.strideHeight,Ee.strideWidth]],Ie=new q0E(Ee);return b.runWebGLProgram(Ie,[ee,re],"float32",Ce)}else{const Ce=new q0s(Ee);return b.runWebGLProgram(Ce,[ee,re],"float32")}}const q0f={kernelName:qU,backendName:"webgl",kernelFunc:q0M},q0S=YQ+`
  return cos(x);
`,q0F=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  `+YW+`
  return result;
`,q0t=YH({opSnippet:q0S,packedOpSnippet:q0F}),q0k={kernelName:nq,backendName:"webgl",kernelFunc:q0t};class q0O{constructor(_,b,$,ee,re){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[ae,xe,le,fe]=_,[ve]=b,[Se,Ee]=$;this.outputShape=[ve,Se,Ee,fe];const Ce=ee==="bilinear"?1:0,[Ie,De]=[xe-1+".0",le-1+".0"],[Be,Ne,qe]=Se>1?[""+(xe-1)/(Se-1),"(y2-y1) * height_ratio","y1*"+Ie+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+Ie],[Xe,Ye,Qe]=Ee>1?[""+(le-1)/(Ee-1),"(x2-x1) * width_ratio","x1*"+De+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+De];this.userCode=`
      const float height_ratio = float(`+Be+`);
      const float width_ratio = float(`+Xe+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+ae+`) {
          return;
        }

        float height_scale = `+Ne+`;
        float width_scale = `+Ye+`;

        float in_y = `+qe+`;
        if( in_y < 0.0 || in_y > `+Ie+` ) {
          setOutput(float(`+re+`));
          return;
        }
        float in_x = `+Qe+`;
        if( in_x < 0.0 || in_x > `+De+` ) {
          setOutput(float(`+re+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+Ce+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}const q0W=H=>{const{inputs:_,backend:b,attrs:$}=H,{image:ee,boxes:re,boxInd:ae}=_,{cropSize:xe,method:le,extrapolationValue:fe}=$,ve=new q0O(ee.shape,re.shape,xe,le,fe);return b.runWebGLProgram(ve,[ee,re,ae],"float32")},q0i={kernelName:nn,backendName:"webgl",kernelFunc:q0W};class q0D{constructor(_,b,$){this.variableNames=["x"],this.outputShape=[],this.outputShape=_,this.blockSize=b,this.dataFormat=$,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+b+`;
      int offset_h = imod(h, `+b+`);
      int in_w = w / `+b+`;
      int offset_w = imod(w, `+b+`);
      int offset_d = (offset_h * `+b+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}function q0m(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{blockSize:re,dataFormat:ae}=$,xe=ee.shape[0],le=ae==="NHWC"?ee.shape[1]:ee.shape[2],fe=ae==="NHWC"?ee.shape[2]:ee.shape[3],ve=ae==="NHWC"?ee.shape[3]:ee.shape[1],Se=le*re,Ee=fe*re,Ce=ve/(re*re),Ie=ae==="NHWC"?[xe,Se,Ee,Ce]:[xe,Ce,Se,Ee],De=new q0D(Ie,re,ae);return b.runWebGLProgram(De,[ee],ee.dtype)}const q0a={kernelName:ns,backendName:"webgl",kernelFunc:q0m};class q0Z{constructor(_,b=!1,$=null,ee=!1,re=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=_.outShape,this.enableShapeUniforms=CG(this.outputShape.length);const ae=_.filterHeight,xe=_.filterWidth,le=_.outChannels/_.inChannels;let fe="",ve="";$&&(ee?fe=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+$+`
        }`:re?fe=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          `+$+`
        }`:fe=`
          float activation(float x) {
            `+$+`
          }
        `,ve="result = activation(result);");const Se=b?"result += getBiasAtOutCoords();":"";b&&this.variableNames.push("bias"),ee&&this.variableNames.push("preluActivationWeights"),re&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      `+fe+`

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+le+`;
        int q = d2 - d1 * `+le+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+ae+`; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < `+xe+`; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+Se+`
        `+ve+`
        setOutput(result);
      }
    `}}class q0w{constructor(_,b=!1,$=null,ee=!1,re=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=_.outShape,this.enableShapeUniforms=CG(this.outputShape.length);const ae=_.outChannels/_.inChannels,xe=_.padInfo.left,le=_.strideWidth,fe=_.dilationWidth,ve=_.filterHeight,Se=_.filterWidth,Ee=Se;let Ce=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let Ne=0;Ne<Se;Ne++)Ce+=`
          vec4 xTexelC`+Ne*2+`;
          int xTexelC`+Ne*2+`Ready;
          vec4 xTexelC`+(Ne*2+1)+`;
          int xTexelC`+(Ne*2+1)+`Ready;
          vec4 xC`+Ne+";";Ce+=`
    for (int r = 0; r < `+ve+`; r++) {
      `;for(let Ne=0;Ne<Se;Ne++)Ce+=`
          xTexelC`+Ne*2+` = vec4(0.0);
          xTexelC`+Ne*2+`Ready = 0;
          xTexelC`+(Ne*2+1)+` = vec4(0.0);
          xTexelC`+(Ne*2+1)+`Ready = 0;
          xC`+Ne+" = vec4(0.0);";Ce+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let Ne=0;Ne<(Ee+1)/2;Ne++){const qe=Ne*2;if(Ce+=`
          xC = xCCorner + `+qe*fe+`;
          `,le===1){if(qe<Se&&(xe%2===1?(Ce+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC`+qe+`Ready == 0) {
                  xTexelC`+qe+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC`+qe+`.zw = vec2(0.0);
                  }
                  xTexelC`+qe+`Ready = 1;
                }
              `,fe===1&&qe>0?Ce+=`
                xC`+qe+" = vec4(xTexelC"+(qe-2)+".zw, xTexelC"+qe+`.xy);
                `:Ce+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC`+qe+" = vec4(previous.zw, xTexelC"+qe+`.xy);
                  } else {
                    xC`+qe+" = vec4(0.0, 0.0, xTexelC"+qe+`.xy);
                  }
                  `):Ce+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC`+qe+`Ready == 0) {
                  xTexelC`+qe+` = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC`+qe+`.zw = vec2(0.0);
                  }
                  xTexelC`+qe+`Ready = 1;
                }

                xC`+qe+" = xTexelC"+qe+`;
                `,qe+1<Se)){const Xe=xe%2===0?f$1(fe):fe;fe%2===0&&xe%2===1||fe%2!==0&&xe%2!==1?(Ce+=`
                  xCOffset = xC + imod(pads[1], 2) + `+Xe+`;

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC`+(qe+1)+`Ready == 0) {
                    xTexelC`+(qe+1)+` = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC`+(qe+1)+`.zw = vec2(0.0);
                    }
                    xTexelC`+(qe+1)+`Ready = 1;
                  }
                  `,fe>1?Ce+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC`+(qe+1)+" = vec4(previous.zw, xTexelC"+(qe+1)+`.xy);
                    } else {
                     xC`+(qe+1)+" = vec4(0.0, 0.0, xTexelC"+(qe+1)+`.xy);
                    }
                    `:Ce+=`
                    xC`+(qe+1)+" = vec4(xTexelC"+qe+".zw, xTexelC"+(qe+1)+`.xy);
                    `):Xe===1?Ce+=`
                    xC`+(qe+1)+" = xTexelC"+qe+`;
                    `:Ce+=`
                    xCOffset = xC + `+Xe+`;

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC`+(qe+1)+`Ready == 0) {
                      xTexelC`+(qe+1)+` = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC`+(qe+1)+`.zw = vec2(0.0);
                      }
                      xTexelC`+(qe+1)+`Ready = 1;
                    }

                    xC`+(qe+1)+" = xTexelC"+(qe+1)+`;
                    `}}else qe<Se&&(xe%2===1?(Ce+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC`+qe+`Ready == 0) {
                  xTexelC`+qe+` = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC`+qe+`.zw = vec2(0.0);
                  }
                  xTexelC`+qe+`Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC`+(qe+1)+`Ready == 0) {
                  xTexelC`+(qe+1)+` = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC`+(qe+1)+`.zw = vec2(0.0);
                  }
                  xTexelC`+(qe+1)+`Ready = 1;
                }

                xC`+qe+" = vec4(xTexelC"+qe+".zw, xTexelC"+(qe+1)+`.zw);
              `,qe+1<Se&&(Ce+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC`+(qe+1)+" = vec4(xTexelC"+(qe+1)+`.xy, final.xy);
                `)):(Ce+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC`+qe+`Ready == 0) {
                  xTexelC`+qe+` = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC`+qe+`.zw = vec2(0.0);
                  }
                  xTexelC`+qe+`Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC`+(qe+1)+`Ready == 0) {
                  xTexelC`+(qe+1)+` = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC`+(qe+1)+`.zw = vec2(0.);
                  }
                  xTexelC`+(qe+1)+`Ready = 1;
                }

                xC`+qe+` = vec4(
                  xTexelC`+qe+".xy, xTexelC"+(qe+1)+`.xy);
              `,qe+1<Se&&(Ce+=`
                  xC`+(qe+1)+" = vec4(xTexelC"+qe+".zw, xTexelC"+(qe+1)+`.zw);
                `)));qe<Se&&(Ce+=`
            wTexel = getW(r, `+qe+`, d1, q);
            dotProd += xC`+qe+` * vec4(wTexel.xz, wTexel.xz);
          `,qe+1<Se&&(Ce+=`
              wTexel = getW(r, `+(qe+1)+`, d1, q);
              dotProd += xC`+(qe+1)+` * vec4(wTexel.xz, wTexel.xz);
            `))}Ce+=`
    }
  `,Ce+=`
      }
    `;let Ie="",De="";$&&(ee?Ie=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+$+`
        }`:re?Ie=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          `+$+`
        }`:Ie=`vec4 activation(vec4 x) {
          `+$+`
        }`,De="result = activation(result);");const Be=b?"result += getBiasAtOutCoords();":"";b&&this.variableNames.push("bias"),ee&&this.variableNames.push("preluActivationWeights"),re&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      `+Ie+`

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+ae+`;
        int q = d2 - d1 * `+ae+`;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        `+Ce+`

        vec4 result = dotProd - vec4(0.000000000000001);
        `+Be+`
        `+De+`
        setOutput(result);
      }
    `}}function q0e(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee,filter:re}=_,{strides:ae,pad:xe,dilations:le,dimRoundingMode:fe}=$;let ve=le;ve==null&&(ve=[1,1]),k(iU(ae,ve),()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+ae+" and dilations '"+ve+"'");const Se=ij(ee.shape,re.shape,ae,ve,xe,fe,!0);let Ee;qM().getBool("WEBGL_PACK_DEPTHWISECONV")&&Se.strideWidth<=2&&Se.outChannels/Se.inChannels===1?Ee=new q0w(Se):Ee=new q0Z(Se);const Ce=[[Se.padInfo.top,Se.padInfo.left],[Se.strideHeight,Se.strideWidth],[Se.dilationHeight,Se.dilationWidth],[Se.inHeight,Se.inWidth]];return b.runWebGLProgram(Ee,[ee,re],"float32",Ce)}const q0z={kernelName:nM,backendName:"webgl",kernelFunc:q0e};function q0c(H){const{inputs:_,attrs:b,backend:$}=H,{dim:ee}=b,{input:re}=_,ae=re.shape.length,xe=re.shape.slice();let le=ee;return ee<0&&(k(-(ae+1)<=ee,()=>"Axis must be in the interval ["+-(ae+1)+", "+ae+"]"),le=ae+ee+1),xe.splice(le,0,1),PB({inputs:{x:re},backend:$,attrs:{shape:xe}})}const q0X={kernelName:nZ,backendName:"webgl",kernelFunc:q0c};class q0G{constructor(_,b){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=_,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}function q0N(H){const{backend:_,attrs:b}=H,{shape:$,value:ee}=b;let{dtype:re}=b;if(re=re||Q(ee),re==="string"){const ae=G(re,i$1($));return ae.fill(ee),_.makeTensorInfo($,re,ae)}else{const ae=new q0G($,ee),xe=[[ee]];return _.runWebGLProgram(ae,[],re,xe)}}const q0u={kernelName:ne,backendName:"webgl",kernelFunc:q0N},q0j="return floor(x);",q0L=YH({opSnippet:q0j,packedOpSnippet:q0j,cpuKernelImpl:KB}),q0I={kernelName:nX,backendName:"webgl",kernelFunc:q0L};class q0b{constructor(_){this.variableNames=["A"];const b=dB(),[$,ee]=_;this.outputShape=_,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+ee+".0, "+$+`.0);

        vec4 values = `+b.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}class q0R{constructor(_){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const b=dB(),[$,ee]=_;this.outputShape=_,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+ee+".0, "+$+`.0);
            vec4 values = `+b.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+b.output+` = result;
      }
    `}}const q0o={kernelName:gz,backendName:"webgl",kernelFunc:q0d};let q0r,q0Q=qM().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function q0d(H){const{inputs:_,backend:b,attrs:$}=H;let{pixels:ee}=_;const{numChannels:re}=$,ae=typeof HTMLVideoElement<"u"&&ee instanceof HTMLVideoElement,xe=typeof HTMLImageElement<"u"&&ee instanceof HTMLImageElement,[le,fe]=ae?[ee.videoWidth,ee.videoHeight]:[ee.width,ee.height],ve=[fe,le],Se=[fe,le,re];if(xe||ae){const De=qM().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(q0r==null||De!==q0Q)&&(q0Q=De,q0r=document.createElement("canvas").getContext("2d",{willReadFrequently:q0Q})),q0r.canvas.width=le,q0r.canvas.height=fe,q0r.drawImage(ee,0,0,le,fe),ee=q0r.canvas}const Ee=b.makeTensorInfo(ve,"int32");b.texData.get(Ee.dataId).usage=rX.PIXELS,b.gpgpu.uploadPixelDataToTexture(b.getTexture(Ee.dataId),ee);const Ce=qM().getBool("WEBGL_PACK")?new q0R(Se):new q0b(Se),Ie=b.runWebGLProgram(Ce,[Ee],"int32");return b.disposeData(Ee.dataId),Ie}function q0v(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee,filter:re,bias:ae,preluActivationWeights:xe}=_,{strides:le,pad:fe,dataFormat:ve,dilations:Se,dimRoundingMode:Ee,activation:Ce,leakyreluAlpha:Ie}=$,De=Ds(ve),Be=ij(ee.shape,re.shape,le,Se,fe,Ee,!1,De);let Ne;const qe=[],Xe=ae!=null,Ye=xe!=null,Qe=Ce==="leakyrelu",rt=()=>{const ct=[ee,re],mt=(_t,Lt)=>{if(Lt==="NCHW"&&_t.shape.length===1&&_t.shape[0]!==1){const Vt=PB({inputs:{x:_t},backend:b,attrs:{shape:[_t.shape[0],1,1]}});return qe.push(Vt),Vt}return _t};if(Xe&&ct.push(mt(ae,ve)),Ye&&ct.push(mt(xe,ve)),Qe){const _t=b.makeTensorInfo([],"float32",Eq(Ie,"float32"));ct.push(_t),qe.push(_t)}return ct};if(Be.filterHeight===1&&Be.filterWidth===1&&Be.dilationHeight===1&&Be.dilationWidth===1&&Be.strideHeight===1&&Be.strideWidth===1&&(Be.padInfo.type==="SAME"||Be.padInfo.type==="VALID"))Ne=q0n({x:ee,filter:re,convInfo:Be,backend:b,bias:ae,activation:Ce,preluActivationWeights:xe,leakyreluAlpha:Ie});else if(Be.strideWidth<=2&&De==="channelsLast"&&qM().getBool("WEBGL_EXP_CONV")){const ct=Ce?YB(Ce,!0):null,mt=new q08(Be,Xe,ct,Ye,Qe),_t=[[Be.padInfo.top,Be.padInfo.left],[Be.strideHeight,Be.strideWidth],[Be.dilationHeight,Be.dilationWidth],[Be.inHeight,Be.inWidth]],Lt=rt();Ne=b.runWebGLProgram(mt,Lt,"float32",_t)}else if(qM().getBool("WEBGL_CONV_IM2COL"))Ne=q0p({x:ee,filter:re,convInfo:Be,backend:b,bias:ae,activation:Ce,preluActivationWeights:xe,leakyreluAlpha:Ie});else{const ct=Ce?YB(Ce,!1):null,mt=new q07(Be,Xe,ct,Ye,Qe),_t=rt();Ne=b.runWebGLProgram(mt,_t,"float32")}const ot=PB({inputs:{x:Ne},backend:b,attrs:{shape:Be.outShape}});return qe.push(Ne),qe.forEach(ct=>b.disposeIntermediateTensorInfo(ct)),ot}const q0y={kernelName:gu,backendName:"webgl",kernelFunc:q0v};function q0C(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee,filter:re,bias:ae,preluActivationWeights:xe}=_,{strides:le,pad:fe,dilations:ve,dimRoundingMode:Se,activation:Ee,leakyreluAlpha:Ce}=$,Ie=[];let De=ve;De==null&&(De=[1,1]),k(iU(le,De),()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+le+" and dilations '"+De+"'");const Be=ij(ee.shape,re.shape,le,De,fe,Se,!0),Ne=qM().getBool("WEBGL_PACK_DEPTHWISECONV")&&Be.strideWidth<=2&&Be.outChannels/Be.inChannels===1,qe=Ee?YB(Ee,Ne):null,Xe=[ee,re],Ye=ae!=null,Qe=xe!=null,rt=Ee==="leakyrelu";if(Ye&&Xe.push(ae),Qe&&Xe.push(xe),rt){const _t=b.makeTensorInfo([],"float32",Eq(Ce,"float32"));Xe.push(_t),Ie.push(_t)}let ot;Ne?ot=new q0w(Be,Ye,qe,Qe,rt):ot=new q0Z(Be,Ye,qe,Qe,rt);const ct=[[Be.padInfo.top,Be.padInfo.left],[Be.strideHeight,Be.strideWidth],[Be.dilationHeight,Be.dilationWidth],[Be.inHeight,Be.inWidth]],mt=b.runWebGLProgram(ot,Xe,"float32",ct);return Ie.forEach(_t=>b.disposeIntermediateTensorInfo(_t)),mt}const q0l={kernelName:gj,backendName:"webgl",kernelFunc:q0C};class q0H{constructor(_,b){this.variableNames=["A","indices"],this.outputShape=b,this.rank=b.length;const $=yU(this.rank),ee=q0A(_);this.userCode=`
      void main() {
        `+$+` resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < `+_[2]+`) ? 1.0 : 0.0;
        setOutput(inBounds * getA(`+ee+`));
      }
    `}}function q0A(H,_){const b=["resRC.x","resRC.y","resRC.z","resRC.w"],$=[];for(let ee=0;ee<H.length;ee++)ee===2?$.push("index"):$.push(""+b[ee]);return $.join()}function q0h(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee,indices:re}=_,{axis:ae,batchDims:xe}=$,le=z$1(ae,ee.shape)[0];if(qM().get("DEBUG")){const qe=b.readSync(re.dataId),Xe=ee.shape[le];for(let Ye=0;Ye<qe.length;++Ye){const Qe=qe[Ye];k(Qe<=Xe-1&&Qe>=0,()=>"GatherV2: the index value "+Qe+" is not in [0, "+(Xe-1)+"]")}}const fe=uj(ee,re,le,xe),ve=i$1(re.shape),Se=[],Ee=PB({inputs:{x:ee},backend:b,attrs:{shape:[fe.batchSize,fe.outerSize,fe.dimSize,fe.sliceSize]}}),Ce=PB({inputs:{x:re},backend:b,attrs:{shape:[fe.batchSize,ve/fe.batchSize]}});Se.push(Ee),Se.push(Ce);const Ie=[fe.batchSize,fe.outerSize,ve/fe.batchSize,fe.sliceSize];if(b.shouldExecuteOnCPU([ee,re])||ee.dtype==="string"){const qe=b.bufferSync(Ce),Xe=b.bufferSync(Ee),Ye=KJ(Xe,qe,Ie);return Se.forEach(Qe=>b.disposeIntermediateTensorInfo(Qe)),b.makeTensorInfo(fe.outputShape,Ye.dtype,Ye.values)}const De=new q0H(Ee.shape,Ie),Be=b.runWebGLProgram(De,[Ee,Ce],Ee.dtype);Se.push(Be);const Ne=PB({inputs:{x:Be},backend:b,attrs:{shape:fe.outputShape}});return Se.forEach(qe=>b.disposeIntermediateTensorInfo(qe)),Ne}const q0T={kernelName:nu,backendName:"webgl",kernelFunc:q0h},q0K="return float(a >= b);",q0B=`
  return vec4(greaterThanEqual(a, b));
`,q0V=YK({opSnippet:q0K,packedOpSnippet:q0B,dtype:"bool",cpuKernelImpl:KP}),q0J={kernelName:nL,backendName:"webgl",kernelFunc:q0V},q0Y="return float(a < b);",q0P=`
  return vec4(lessThan(a, b));
`,q0U=YK({opSnippet:q0Y,packedOpSnippet:q0P,cpuKernelImpl:KU,dtype:"bool"}),q10={kernelName:nK,backendName:"webgl",kernelFunc:q0U},q11="return float(a <= b);",q12=`
  return vec4(lessThanEqual(a, b));
`,q13=YK({opSnippet:q11,packedOpSnippet:q12,cpuKernelImpl:Bq,dtype:"bool"}),q14={kernelName:nB,backendName:"webgl",kernelFunc:q13},q15="return float(a >= 1.0 && b >= 1.0);",q16=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,q17=YK({opSnippet:q15,packedOpSnippet:q16,dtype:"bool"}),q18={kernelName:nV,backendName:"webgl",kernelFunc:q17},q19="return float(a >= 1.0 || b >= 1.0);",q1q=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,q1n=YK({opSnippet:q19,packedOpSnippet:q1q,dtype:"bool"}),q1p={kernelName:nJ,backendName:"webgl",kernelFunc:q1n};function q1g(H,_,b,$){const ee=i$1(_),re=i$1(H.shape)/ee,ae=PB({inputs:{x:H},attrs:{shape:[re,ee]},backend:$}),xe=PU(ae,H.dtype,"max",$),le=PB({inputs:{x:xe},attrs:{shape:b},backend:$});return $.disposeIntermediateTensorInfo(ae),$.disposeIntermediateTensorInfo(xe),le}function q1x(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{reductionIndices:re,keepDims:ae}=$,xe=ee.shape.length,le=z$1(re,ee.shape);let fe=le;const ve=at(fe,xe),Se=ve!=null,Ee=b.shouldExecuteOnCPU([ee]);let Ce=ee;if(Se){if(Ee){const qe=b.texData.get(Ce.dataId).values,Xe=new Array(xe);for(let rt=0;rt<Xe.length;rt++)Xe[rt]=ee.shape[ve[rt]];const Ye=VZ(qe,ee.shape,ee.dtype,ve,Xe);Ce=b.makeTensorInfo(Xe,ee.dtype);const Qe=b.texData.get(Ce.dataId);Qe.values=Ye}else Ce=UM(ee,ve,b);fe=aD(fe.length,xe)}aF("max",fe,xe);const[Ie,De]=aq(Ce.shape,fe);let Be=Ie;ae&&(Be=aM(Ie,le));let Ne;if(Ee){const qe=b.texData.get(Ce.dataId).values,Xe=BM(qe,i$1(De),Be,ee.dtype);Ne=b.makeTensorInfo(Be,ee.dtype);const Ye=b.texData.get(Ne.dataId);Ye.values=Xe}else Ne=q1g(Ce,De,Be,b);return Se&&b.disposeIntermediateTensorInfo(Ce),Ne}const q1s={kernelName:nY,backendName:"webgl",kernelFunc:q1x};function q1E(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_;dH(ee,"maxPool");const{filterSize:re,strides:ae,pad:xe,dimRoundingMode:le}=$,fe=1;k(iU(ae,fe),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides "+ae+" and dilations '"+fe+"'");const ve=iG(ee.shape,re,ae,fe,xe,le);if(ve.filterWidth===1&&ve.filterHeight===1&&D(ve.inShape,ve.outShape))return Ya({inputs:{x:ee},backend:b});const Se=new PZ(ve,"max",!1);return b.runWebGLProgram(Se,[ee],ee.dtype)}const q1M={kernelName:nU,backendName:"webgl",kernelFunc:q1E},q1f=YF+`
  return max(a, b);
`,q1S=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+YW+`
  return result;
`,q1F=YK({opSnippet:q1f,packedOpSnippet:q1S,cpuKernelImpl:BF}),q1t={kernelName:nP,backendName:"webgl",kernelFunc:q1F};function q1k(H,_,b,$){const ee=i$1(_),re=i$1(H.shape)/ee,ae=PB({inputs:{x:H},attrs:{shape:[re,ee]},backend:$}),xe=PU(ae,"float32","mean",$),le=PB({inputs:{x:xe},attrs:{shape:b},backend:$});return $.disposeIntermediateTensorInfo(ae),$.disposeIntermediateTensorInfo(xe),le}const q1O={kernelName:p1,backendName:"webgl",kernelFunc:({inputs:H,attrs:_,backend:b})=>{const{x:$}=H,{keepDims:ee,axis:re}=_,ae=b,xe=$.shape.length,le=z$1(re,$.shape);let fe=le;const ve=at(fe,xe),Se=ve!=null,Ee=ae.shouldExecuteOnCPU([$]),Ce=[];let Ie=$;if(Se){if(Ee){const Xe=ae.texData.get(Ie.dataId).values,Ye=new Array(xe);for(let ot=0;ot<Ye.length;ot++)Ye[ot]=$.shape[ve[ot]];const Qe=VZ(Xe,$.shape,$.dtype,ve,Ye);Ie=ae.makeTensorInfo(Ye,$.dtype);const rt=ae.texData.get(Ie.dataId);rt.values=Qe}else Ie=UM($,ve,ae);Ce.push(Ie),fe=aD(fe.length,xe)}aF("sum",fe,xe);const[De,Be]=aq(Ie.shape,fe);let Ne=De;ee&&(Ne=aM(De,le));const qe=q1k(Ie,Be,Ne,ae);for(const Xe of Ce)ae.disposeIntermediateTensorInfo(Xe);return qe}};function q1W(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{axis:re,keepDims:ae}=$,xe=ee.shape.length,le=z$1(re,ee.shape);let fe=le;const ve=at(fe,xe);let Se=ee;ve!=null&&(Se=UD({inputs:{x:ee},backend:b,attrs:{perm:ve}}),fe=aD(fe.length,ee.shape.length)),aF("min",fe,xe);const[Ee,Ce]=aq(Se.shape,fe),Ie=i$1(Ce),De=PB({inputs:{x:Se},backend:b,attrs:{shape:[-1,Ie]}}),Be=PU(De,De.dtype,"min",b);let Ne;if(ae){const qe=aM(Ee,le);Ne=PB({inputs:{x:Be},backend:b,attrs:{shape:qe}})}else Ne=PB({inputs:{x:Be},backend:b,attrs:{shape:Ee}});return b.disposeIntermediateTensorInfo(De),b.disposeIntermediateTensorInfo(Be),ve!=null&&b.disposeIntermediateTensorInfo(Se),Ne}const q1i={kernelName:pq,backendName:"webgl",kernelFunc:q1W},q1D=YF+`
  return min(a, b);
`,q1m=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+YW+`
  return result;
`,q1a=YK({opSnippet:q1D,packedOpSnippet:q1m,cpuKernelImpl:Bt}),q1Z={kernelName:pM,backendName:"webgl",kernelFunc:q1a},q1w=VU+`
  return -x;
`,q1e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function q1z(H){const{inputs:_,backend:b}=H,{x:$}=_;if(b.shouldExecuteOnCPU([$])){const re=b.texData.get($.dataId),[ae,xe]=BD(re.values,$.shape,$.dtype);return b.makeTensorInfo(xe,$.dtype,ae)}let ee;return qM().getBool("WEBGL_PACK_UNARY_OPERATIONS")?ee=new JL($.shape,q1e):ee=new VP($.shape,q1w),b.runWebGLProgram(ee,[$],$.dtype)}const q1c={kernelName:pt,backendName:"webgl",kernelFunc:q1z};function q1X(H){const{inputs:_,backend:b,attrs:$}=H,{axis:ee}=$;if(_.length===1)return q0c({inputs:{input:_[0]},backend:b,attrs:{dim:ee}});const re=_[0].shape,ae=_[0].dtype;_.forEach(ve=>{O(re,ve.shape,"All tensors passed to stack must have matching shapes"),k(ae===ve.dtype,()=>"All tensors passed to stack must have matching dtypes")});const xe=[],le=_.map(ve=>{const Se=q0c({inputs:{input:ve},backend:b,attrs:{dim:ee}});return xe.push(Se),Se}),fe=q05({inputs:le,backend:b,attrs:{axis:ee}});return xe.forEach(ve=>b.disposeIntermediateTensorInfo(ve)),fe}const q1G={kernelName:pZ,backendName:"webgl",kernelFunc:q1X};class q1N{constructor(_,b,$){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=b.map((fe,ve)=>fe[0]+_[ve]+fe[1]);const ee=_.length,re=yU(ee),ae=b.map(fe=>fe[0]).join(","),xe=b.map((fe,ve)=>fe[0]+_[ve]).join(","),le=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,ee);if(ee===1){this.userCode=`
        int start = `+ae+`;
        int end = `+xe+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      `+re+" start = "+re+"("+ae+`);
      `+re+" end = "+re+"("+xe+`);

      void main() {
        `+re+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          `+re+` coords = outC - start;
          setOutput(getX(`+le+`));
        }
      }
    `}}class q1u{constructor(_,b,$){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=b.map((De,Be)=>De[0]+_[Be]+De[1]);const ee=_.length,re=yU(ee),ae=b.map(De=>De[0]).join(","),xe=b.map((De,Be)=>De[0]+_[Be]).join(","),le=VX("rc",ee),fe=VX("source",ee),ve=le[ee-1]+" < "+this.outputShape[ee-1],Se=ee===1?"source":"vec2("+fe.slice(-2).join()+")",Ee=[re+" rc = outputLoc;",le[ee-1]+` += 1;
       if(`+ve+`) {
      `,ee===1?"":`}
       rc = outputLoc;
       `+le[ee-2]+` += 1;
       if(`+le[ee-2]+" < "+this.outputShape[ee-2]+") {",ee===1?"":"  "+le[ee-1]+` += 1;
         if(`+ve+") {"],Ce=ee===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let Ie="";for(let De=0,Be=ee===1?2:4;De<Be;De++)Ie+=`
        `+Ee[De]+`
        if (`+Ce+`) {
          result[`+De+`] = float(value);
        } else {
          `+re+` source = rc - start;
          result[`+De+"] = getChannel(getX("+fe.join()+"), "+Se+`);
        }
      `;Ie+=ee===1?"} ":"}}",this.userCode=`
      const `+re+" start = "+re+"("+ae+`);
      const `+re+" end = "+re+"("+xe+`);

      void main() {
        `+re+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+Ie+`
        setOutput(result);
      }
    `}}const q1j=H=>{const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{paddings:re,constantValue:ae}=$;if(i$1(ee.shape)===0){const fe=re.map((ve,Se)=>ve[0]+ee.shape[Se]+ve[1]);return q0N({backend:b,attrs:{shape:fe,value:ae,dtype:ee.dtype}})}const xe=qM().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new q1u(ee.shape,re,ae):new q1N(ee.shape,re,ae),le=[[ae]];return b.runWebGLProgram(xe,[ee],ee.dtype,le)},q1L={kernelName:pe,backendName:"webgl",kernelFunc:q1j},q1I=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,q1b=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+YW+`
  return result;
`,q1R=YK({opSnippet:q1I,packedOpSnippet:q1b}),q1o={kernelName:pz,backendName:"webgl",kernelFunc:q1R},q1r=H=>{const{backend:_,attrs:b}=H,{start:$,stop:ee,step:re,dtype:ae}=b,xe=BL($,ee,re,ae);return _.makeTensorInfo([xe.length],ae,xe)},q1Q={kernelName:pG,backendName:"webgl",kernelFunc:q1r},q1d=`
if (a == b) {
  return 1.0;
};
return a / b;`,q1v=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,q1y=YK({opSnippet:q1d,packedOpSnippet:q1v,checkOutOfBounds:!0}),q1C={kernelName:nW,backendName:"webgl",kernelFunc:q1y},q1l=VU+`
  return (x < 0.0) ? 0.0 : x;
`,q1H=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,q1A=YH({opSnippet:q1l,packedOpSnippet:q1H}),q1h={kernelName:pj,backendName:"webgl",kernelFunc:q1A},q1T=VU+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,q1K=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,q1B=YH({opSnippet:q1T,packedOpSnippet:q1K}),q1V={kernelName:pQ,backendName:"webgl",kernelFunc:q1B};class q1J{constructor(_,b,$,ee,re){this.variableNames=["A"],this.outputShape=[];const[ae,xe,le,fe]=_;this.outputShape=[ae,b,$,fe];const ve=[ee&&b>1?xe-1:xe,ee&&$>1?le-1:le],Se=[ee&&b>1?b-1:b,ee&&$>1?$-1:$];let Ee;re?Ee="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":Ee="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+ve[0]/Se[0]+`,
          `+ve[1]/Se[1]+`);
      const vec2 inputShapeRC = vec2(`+xe+".0, "+le+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = `+Ee+`;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}class q1Y{constructor(_,b,$,ee,re){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[ae,xe,le,fe]=_;this.outputShape=[ae,b,$,fe];const ve=[ee&&b>1?xe-1:xe,ee&&$>1?le-1:le],Se=[ee&&b>1?b-1:b,ee&&$>1?$-1:$];let Ee;re?Ee="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":Ee="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+ve[0]/Se[0]+`,
          `+ve[1]/Se[1]+`,
          `+ve[1]/Se[1]+`);
      const vec3 inputShapeRC = vec3(`+xe+".0, "+le+`.0,
                                     `+le+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = `+Ee+`;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(fe-1)+`;
        bool hasNextRow = coords.z < `+($-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}function q1P(H){const{inputs:_,backend:b,attrs:$}=H,{images:ee}=_,{alignCorners:re,halfPixelCenters:ae,size:xe}=$,[le,fe]=xe,ve=qM().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new q1Y(ee.shape,le,fe,re,ae):new q1J(ee.shape,le,fe,re,ae);return b.runWebGLProgram(ve,[ee],"float32")}const q1U={kernelName:pr,backendName:"webgl",kernelFunc:q1P};class q20{constructor(_,b){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const $=_[1],ee=_[2];this.outputShape=_;let re="";typeof b=="number"?re="float outputValue = "+b.toFixed(2)+";":re=`
        vec3 fill = vec3(`+b.join(",")+`);
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          `+re+`
          if(coordX >= 0 && coordX < `+ee+" && coordY >= 0 && coordY < "+$+`) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}const q21={kernelName:gX,backendName:"webgl",kernelFunc:({inputs:H,attrs:_,backend:b})=>{const{image:$}=H,{radians:ee,fillValue:re,center:ae}=_,xe=b,le=new q20($.shape,re),[fe,ve]=GR(ae,$.shape[1],$.shape[2]),Se=[[fe,ve,Math.sin(ee),Math.cos(ee)]];return xe.runWebGLProgram(le,[$],$.dtype,Se)}},q22=YQ+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,q23=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,q24=YH({opSnippet:q22,packedOpSnippet:q23,cpuKernelImpl:BH}),q25={kernelName:pY,backendName:"webgl",kernelFunc:q24},q26=YQ+`
  return sin(x);
`,q27=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  `+YW+`
  return result;
`,q28=YH({opSnippet:q26,packedOpSnippet:q27}),q29={kernelName:pJ,backendName:"webgl",kernelFunc:q28};class q2q{constructor(_){this.variableNames=["source"],this.outputShape=_,this.rank=_.length;const b=yU(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const $=q2p(this.rank);let ee;const re=_.map((ae,xe)=>"sourceLoc."+q2n[xe]+" = start["+xe+"] + coords."+q2n[xe]+";");ee=`
        `+b+` sourceLoc;
        `+b+` coords = getOutputCoords();
        `+re.join(`
`)+`
      `,this.userCode=`
      void main() {
        `+ee+`
        setOutput(getSource(`+$+`));
      }
    `}}const q2n=["x","y","z","w","u","v"];function q2p(H){if(H===1)return"sourceLoc";if(H<=6)return q2n.slice(0,H).map(_=>"sourceLoc."+_).join(",");throw Error("Slicing for rank "+H+" is not yet supported")}class q2g{constructor(_){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=_,this.rank=_.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const b=yU(this.rank),$=VX("coords",this.rank),ee=VX("sourceLoc",this.rank),re=this.rank===1?"sourceLoc":"vec2("+ee.slice(-2).join()+")",ae="getChannel(getSource("+ee.join()+"), "+re+")",xe=`
      result.x = `+ae+`;
      if (++`+$[this.rank-1]+" < "+_[this.rank-1]+`) {
        ++`+ee[this.rank-1]+`;
        result.y = `+ae+`;
        --`+ee[this.rank-1]+`;
      }
    `,le=this.rank===1?"":`
      --`+$[this.rank-1]+`;
      if (++`+$[this.rank-2]+" < "+_[this.rank-2]+`) {
        ++`+ee[this.rank-2]+`;
        result.z = `+ae+`;
        if (++`+$[this.rank-1]+" < "+_[this.rank-1]+`) {
          ++`+ee[this.rank-1]+`;
          result.w = `+ae+`;
        }
      }
    `,fe=this.rank<=4?`sourceLoc = coords +
            `+b+"("+_.map((ve,Se)=>"start["+Se+"]").join()+");":_.map((ve,Se)=>ee[Se]+" = "+$[Se]+" + start["+Se+"];").join(`
`);this.userCode=`
      void main() {
        `+b+` coords = getOutputCoords();
        `+b+` sourceLoc;
        `+fe+`
        vec4 result = vec4(0.);
        `+xe+`
        `+le+`
        setOutput(result);
      }
    `}}function q2x(H,_,b,$){const ee=$.texData.get(H.dataId),re=$.makeTensorInfo(b,H.dtype),ae=$.texData.get(re.dataId);Object.assign(ae,ee),ae.refCount=1,ae.shape=b,ae.dtype=H.dtype;let xe=WR(_,y(H.shape));ee.slice&&(xe+=ee.slice.flatOffset),ae.slice={flatOffset:xe,origDataId:ee.slice&&ee.slice.origDataId||H.dataId};const le=$.dataRefCount.get(ae.slice.origDataId)||1;return $.dataRefCount.set(ae.slice.origDataId,le+1),re}function q2s(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{begin:re,size:ae}=$,[xe,le]=WQ(ee,re,ae);if(Wq(ee,xe,le),i$1(le)===0)return b.makeTensorInfo(le,ee.dtype,[]);if(b.shouldExecuteOnCPU([ee])||ee.dtype==="string"){const Se=b.texData.get(ee.dataId),Ee=BB(Se.values,xe,le,ee.shape,ee.dtype);return b.makeTensorInfo(le,ee.dtype,Ee)}const{isPacked:fe}=b.texData.get(ee.dataId),ve=WL(ee.shape,xe,le);if(fe||!ve){const Se=qM().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new q2g(le):new q2q(le),Ee=[xe];return b.runWebGLProgram(Se,[ee],ee.dtype,Ee)}return b.uploadToGPU(ee.dataId),q2x(ee,xe,le,b)}const q2E={kernelName:pV,backendName:"webgl",kernelFunc:q2s},q2M="return sqrt(x);",q2f=YH({opSnippet:q2M,packedOpSnippet:q2M,cpuKernelImpl:BP}),q2S={kernelName:pP,backendName:"webgl",kernelFunc:q2f},q2F="return x * x;",q2t=YH({opSnippet:q2F}),q2k={kernelName:gn,backendName:"webgl",kernelFunc:q2t};class q2O{constructor(_,b,$){this.variableNames=["x"],this.outputShape=$;const ee=$.length,re=yU($.length),ae=yU($.length);let xe="";if(ee===1)xe="coords * strides + begin";else{let le=0;xe=$.map((fe,ve)=>(le++,$.length===1?"coords * strides["+ve+"] + begin["+ve+"]":"coords["+(le-1)+"] * strides["+ve+"] + begin["+ve+"]")).join(",")}this.userCode=`
      `+re+" begin = "+re+"("+_+`);
      `+re+" strides = "+re+"("+b+`);

      void main() {
        `+ae+` coords = getOutputCoords();
        setOutput(getX(`+xe+`));
      }
    `}}function q2W(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{begin:re,end:ae,strides:xe,beginMask:le,endMask:fe,ellipsisMask:ve,newAxisMask:Se,shrinkAxisMask:Ee}=$,{finalShapeSparse:Ce,finalShape:Ie,isIdentity:De,sliceDim0:Be,isSimpleSlice:Ne,begin:qe,end:Xe,strides:Ye}=WH(ee.shape,re,ae,xe,le,fe,ve,Se,Ee);let Qe;if(De)Qe=PB({inputs:{x:ee},backend:b,attrs:{shape:Ie}});else if(Be||Ne){k(ee.shape.length>=1,()=>"Input must have rank at least 1, got: "+ee.shape.length);const ot=WF(qe,Xe,Ye),ct=q2s({inputs:{x:ee},backend:b,attrs:{begin:qe,size:ot}});Qe=PB({inputs:{x:ct},backend:b,attrs:{shape:Ie}}),b.disposeIntermediateTensorInfo(ct)}else if(b.shouldExecuteOnCPU([ee])){const ot=b.readSync(ee.dataId),ct=DY(ee.shape,ee.dtype,ot),mt=Vq(Ce,ct,Ye,qe);Qe=b.makeTensorInfo(Ie,ee.dtype,mt.values)}else{const ot=new q2O(qe,Ye,Ce);Qe=b.runWebGLProgram(ot,[ee],ee.dtype)}const rt=PB({inputs:{x:Qe},backend:b,attrs:{shape:Ie}});return b.disposeIntermediateTensorInfo(Qe),rt}const q2i={kernelName:gs,backendName:"webgl",kernelFunc:q2W},q2D="return a - b;",q2m=YK({opSnippet:q2D,packedOpSnippet:q2D,supportsComplex:!0,cpuKernelImpl:VF}),q2a={kernelName:gM,backendName:"webgl",kernelFunc:q2m};class q2Z{constructor(_,b){this.variableNames=["A"];const $=new Array(_.length);for(let ae=0;ae<$.length;ae++)$[ae]=_[ae]*b[ae];this.outputShape=$,this.rank=$.length;const ee=yU(this.rank),re=q2w(_);this.userCode=`
      void main() {
        `+ee+` resRC = getOutputCoords();
        setOutput(getA(`+re+`));
      }
    `}}function q2w(H){const _=H.length;if(_>5)throw Error("Tile for rank "+_+" is not yet supported");if(_===1)return"imod(resRC, "+H[0]+")";const b=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],$=[];for(let ee=0;ee<H.length;ee++)$.push("imod("+b[ee]+", "+H[ee]+")");return $.join()}function q2e(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{reps:re}=$;if(ee.dtype==="string"||ee.shape.length>5){const xe=b.readSync(ee.dataId),le=ee.dtype==="string"?xe.map(Se=>EW(Se)):xe,fe=DY(ee.shape,ee.dtype,le),ve=VW(fe,re);return b.makeTensorInfo(ve.shape,ve.dtype,ve.values)}const ae=new q2Z(ee.shape,re);return b.runWebGLProgram(ae,[ee],ee.dtype)}const q2z={kernelName:gF,backendName:"webgl",kernelFunc:q2e};class q2c{constructor(_,b,$,ee,re,ae){this.variableNames=["Image","Transforms"],this.outputShape=ae;const xe=$==="nearest"?1:2;let le;switch(ee){case"constant":le=1;break;case"reflect":le=2;break;case"wrap":le=3;break;case"nearest":le=4;break;default:le=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(`+le+` == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (`+le+` == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (`+le+` == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < `+_+" && 0 <= coordX && coordX < "+b+`) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(`+re+`);
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(`+re+`);
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(`+b+`));
                float mapY = mapCoord(inY, float(`+_+`));

                if (`+xe+` == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}function q2X(H){const{inputs:_,backend:b,attrs:$}=H,{image:ee,transforms:re}=_,{interpolation:ae,fillMode:xe,fillValue:le,outputShape:fe}=$,[ve,Se,Ee,Ce]=ee.shape,[Ie,De]=fe??[Se,Ee],Be=[ve,Ie,De,Ce],Ne=new q2c(Se,Ee,ae,xe,le,Be);return b.runWebGLProgram(Ne,[ee,re],"float32")}const q2G={kernelName:gW,backendName:"webgl",kernelFunc:q2X};function q2N(H){const{inputs:_,backend:b}=H,{x:$}=_;if($.dtype==="complex64"){const ee=UR({inputs:{input:$},backend:b}),re=q2N({inputs:{x:ee},backend:b}),ae=q02({inputs:{input:$},backend:b}),xe=q2N({inputs:{x:ae},backend:b}),le=Yz({inputs:{real:re,imag:xe},backend:b});return b.disposeIntermediateTensorInfo(ee),b.disposeIntermediateTensorInfo(re),b.disposeIntermediateTensorInfo(ae),b.disposeIntermediateTensorInfo(xe),le}else return q0N({attrs:{shape:$.shape,dtype:$.dtype,value:$.dtype==="string"?"":0},backend:b})}const q2u={kernelName:gZ,backendName:"webgl",kernelFunc:q2N};function q2j(H){const{inputs:_,backend:b,attrs:$}=H,{a:ee,b:re,bias:ae,preluActivationWeights:xe}=_,{transposeA:le,transposeB:fe,activation:ve,leakyreluAlpha:Se}=$;return Uz({a:ee,b:re,transposeA:le,transposeB:fe,backend:b,bias:ae,preluActivationWeights:xe,leakyreluAlpha:Se,activation:ve})}const q2L={kernelName:gG,backendName:"webgl",kernelFunc:q2j},q2I=zR;class q2b extends x$1{nextDataId(){return q2b.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new g(this,fU())}write(_,b,$){this.firstUse&&(this.firstUse=!1,qM().get("IS_NODE")&&gL(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const ee={id:this.nextDataId()};return this.data.set(ee,{values:_,dtype:$,refCount:1}),ee}makeTensorInfo(_,b,$){let ee;if(b==="string"&&$!=null&&$.length>0&&R$1($[0])){const re=$.map(ae=>Et(ae));ee=this.write(re,_,b)}else ee=this.write($,_,b);return{dataId:ee,shape:_,dtype:b}}refCount(_){return this.data.has(_)?this.data.get(_).refCount:0}incRef(_){const b=this.data.get(_);b.refCount++}decRef(_){if(this.data.has(_)){const b=this.data.get(_);b.refCount--}}move(_,b,$,ee,re){this.data.set(_,{values:b,dtype:ee,refCount:re})}numDataIds(){return this.data.numDataIds()}async read(_){return this.readSync(_)}readSync(_){const{dtype:b,complexTensorInfos:$}=this.data.get(_);if(b==="complex64"){const ee=this.readSync($.real.dataId),re=this.readSync($.imag.dataId);return Nt(ee,re)}return A$1(this.data.get(_).values,b)}bufferSync(_){const b=this.readSync(_.dataId);if(_.dtype==="string")try{const $=b.map(ee=>EW(ee));return DY(_.shape,_.dtype,$)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return DY(_.shape,_.dtype,b)}makeOutput(_,b,$){return fU().makeTensorFromTensorInfo(this.makeTensorInfo(b,$,_),this)}disposeData(_,b=!1){if(this.data.has(_)){if(this.data.get(_).refCount--,!b&&this.data.get(_).refCount>0)return!1;const{complexTensorInfos:$}=this.data.get(_);$!=null&&(this.disposeData($.real.dataId,!0),this.disposeData($.imag.dataId,!0)),this.data.delete(_)}return!0}disposeIntermediateTensorInfo(_){this.disposeData(_.dataId)}async time(_){const b=EF();return _(),{kernelMs:EF()-b}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(_){lK([_],"where");const b=this.readSync(_.dataId);return q2I(_.shape,b)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}q2b.nextDataId=0,SW("cpu",()=>new q2b,1);function q2R(H){const{inputs:_,backend:b}=H,$=_;lK(_,"addN");const ee=$.map(xe=>b.data.get(xe.dataId).values),re=DY($[0].shape,$[0].dtype),ae=re.values;for(let xe=0;xe<$.length;xe++){const le=ee[xe];for(let fe=0;fe<ae.length;fe++)ae[fe]+=le[fe]}return b.makeTensorInfo(re.shape,re.dtype,re.values)}const q2o={kernelName:qj,backendName:"cpu",kernelFunc:q2R},q2r=lY((H,_)=>Math.atan2(H,_)),q2Q=HZ(qL,q2r),q2d={kernelName:qL,backendName:"cpu",kernelFunc:q2Q};function q2v(H,_,b,$,ee,re){const ae=ee.strideHeight,xe=ee.strideWidth,le=ee.dilationHeight,fe=ee.dilationWidth,ve=ee.effectiveFilterHeight,Se=ee.effectiveFilterWidth,Ee=ee.padInfo.top,Ce=ee.padInfo.left,Ie=re==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,De=DY(ee.outShape,b),Be=De.values,Ne=ee.outShape[1]*ee.outShape[2]*ee.outShape[3],qe=ee.outShape[2]*ee.outShape[3],Xe=ee.outShape[3];for(let Ye=0;Ye<ee.batchSize;++Ye){const Qe=Ye*Ne,rt=Ye*$[0];for(let ot=0;ot<ee.inChannels;++ot)for(let ct=0;ct<ee.outHeight;++ct){const mt=ct*ae-Ee,_t=Math.max(0,mt),Lt=Math.min(ee.inHeight,ve+mt),Vt=Qe+ct*qe;for(let Gt=0;Gt<ee.outWidth;++Gt){const $t=Gt*xe-Ce,Qt=Math.max(0,$t),vt=Math.min(ee.inWidth,Se+$t);let It=Ie,gt=0,Tt=0;for(let Ft=_t;Ft<Lt;Ft+=le){const sn=rt+Ft*$[1];for(let cn=Qt;cn<vt;cn+=fe){const en=sn+cn*$[2],yn=H[en+ot];re==="max"&&yn>It?It=yn:re==="avg"&&(gt+=yn,Tt++)}if(isNaN(It))break}const Ct=Vt+Gt*Xe+ot;Be[Ct]=re==="avg"?gt/Tt:It}}}return De}function q2y(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_;lK(ee,"avgPool");const{filterSize:re,strides:ae,pad:xe,dimRoundingMode:le}=$,fe=1;k(iU(ae,fe),()=>"Error in avgPool: Either strides or dilations must be 1. Got strides "+ae+" and dilations '"+fe+"'");const ve=iG(ee.shape,re,ae,fe,xe,le);let Se;if(ve.filterWidth===1&&ve.filterHeight===1&&D(ve.inShape,ve.outShape))Se=H6({inputs:{x:ee},backend:b});else{const Ee=b.data.get(ee.dataId).values,Ce=y(ee.shape),Ie=q2v(Ee,ee.shape,ee.dtype,Ce,ve,"avg");Se=b.makeTensorInfo(ve.outShape,ee.dtype,Ie.values)}return Se}const q2C={kernelName:qR,backendName:"cpu",kernelFunc:q2y};function q2l(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{shape:re}=$,ae=i$1(ee.shape),xe=e$1(re,ae),le=i$1(xe);k(ae===le,()=>"The new shape ("+xe+") has "+le+" elements and the old shape ("+ee.shape+") has "+ae+" elements. The new shape and old shape must have the same number of elements."),b.incRef(ee.dataId);const fe=b.data.get(ee.dataId);if(fe.complexTensorInfos!=null){const ve=fe.complexTensorInfos.real,Se=fe.complexTensorInfos.imag;ve.shape=xe,Se.shape=xe}return{dataId:ee.dataId,shape:xe,dtype:ee.dtype}}const q2H={kernelName:pL,backendName:"cpu",kernelFunc:q2l};function q2A(H){const{inputs:_,backend:b,attrs:$}=H,{a:ee,b:re}=_,{transposeA:ae,transposeB:xe}=$;lK([ee,re],"matMul");const le=ee.shape.length,fe=re.shape.length,ve=ae?ee.shape[le-2]:ee.shape[le-1],Se=xe?re.shape[fe-1]:re.shape[fe-2],Ee=ae?ee.shape[le-1]:ee.shape[le-2],Ce=xe?re.shape[fe-2]:re.shape[fe-1],Ie=ee.shape.slice(0,-2),De=re.shape.slice(0,-2),Be=i$1(Ie),Ne=i$1(De),qe=OR(ee.shape.slice(0,-2),re.shape.slice(0,-2)).concat([Ee,Ce]);k(ve===Se,()=>"Error in matMul: inner shapes ("+ve+") and ("+Se+") of Tensors with shapes "+ee.shape+" and "+re.shape+" and transposeA="+ae+" and transposeB="+xe+" must match.");const Xe=ae?[Be,ve,Ee]:[Be,Ee,ve],Ye=xe?[Ne,Ce,Se]:[Ne,Se,Ce],Qe=q2l({inputs:{x:ee},backend:b,attrs:{shape:Xe}}),rt=q2l({inputs:{x:re},backend:b,attrs:{shape:Ye}}),ot=ae?Qe.shape[1]:Qe.shape[2],ct=ae?Qe.shape[2]:Qe.shape[1],mt=xe?rt.shape[1]:rt.shape[2],_t=Math.max(Be,Ne),Lt=b.data.get(Qe.dataId).values,Vt=b.data.get(rt.dataId).values,Gt=y(Qe.shape),$t=y(rt.shape),[Qt,vt,It]=ae?[Gt[0],1,Gt[1]]:[Gt[0],Gt[1],1],[gt,Tt,Ct]=xe?[1,$t[1],$t[0]]:[$t[1],1,$t[0]],Ft=ct*mt,sn=DY([_t,ct,mt],Qe.dtype),cn=sn.values,en=b.blockSize;for(let yn=0;yn<_t;yn++){const Pn=yn%Be,tr=yn%Ne;for(let nr=0;nr<ct;nr+=en){const Fr=Math.min(nr+en,ct);for(let Ur=0;Ur<mt;Ur+=en){const Kr=Math.min(Ur+en,mt);for(let on=0;on<ot;on+=en){const qr=Math.min(on+en,ot);for(let rr=nr;rr<Fr;rr++)for(let Qr=Ur;Qr<Kr;Qr++){let Ir=0;for(let ai=on;ai<qr;ai++){const Hr=Lt[Pn*Qt+rr*vt+ai*It],Vr=Vt[ai*gt+Qr*Tt+tr*Ct];Ir+=Hr*Vr}cn[yn*Ft+(rr*mt+Qr)]+=Ir}}}}}return b.disposeIntermediateTensorInfo(Qe),b.disposeIntermediateTensorInfo(rt),b.makeTensorInfo(qe,sn.dtype,sn.values)}const q2h={kernelName:qo,backendName:"cpu",kernelFunc:q2A},q2T=HK(qK,(H,_)=>{const b=_;return H>b.clipValueMax?b.clipValueMax:H<b.clipValueMin?b.clipValueMin:H}),q2K={kernelName:qK,backendName:"cpu",kernelFunc:q2T};function q2B(H){const{inputs:_,backend:b}=H,{input:$}=_,ee=b.data.get($.dataId).complexTensorInfos.imag,re=b.data.get(ee.dataId).values;return b.makeTensorInfo(ee.shape,ee.dtype,re)}function q2V(H){const{inputs:_,backend:b,attrs:$}=H,{axis:ee}=$,re=z$1(ee,_[0].shape)[0],ae=_.map(De=>De.shape);GW(ae,re);let xe=GD(_.map(De=>De.shape),re);if(i$1(xe)===0)return b.makeTensorInfo(xe,_[0].dtype,[]);const le=_.filter(De=>i$1(De.shape)>0);if(le.length===1)return H6({inputs:{x:le[0]},backend:b});if(le[0].dtype==="complex64"){const De=le.map(Ye=>HM({inputs:{input:Ye},backend:b})),Be=le.map(Ye=>q2B({inputs:{input:Ye},backend:b})),Ne=q2V({inputs:De,backend:b,attrs:{axis:re}}),qe=q2V({inputs:Be,backend:b,attrs:{axis:re}}),Xe=lP({inputs:{real:Ne,imag:qe},backend:b});return De.forEach(Ye=>b.disposeIntermediateTensorInfo(Ye)),Be.forEach(Ye=>b.disposeIntermediateTensorInfo(Ye)),b.disposeIntermediateTensorInfo(Ne),b.disposeIntermediateTensorInfo(qe),Xe}const fe=le.map(De=>{const Be=[-1,i$1(De.shape.slice(re))];return q2l({inputs:{x:De},backend:b,attrs:{shape:Be}})}),ve=fe.map(De=>({vals:b.data.get(De.dataId).values,shape:De.shape}));xe=GD(fe.map(De=>De.shape),1);const Se=fe[0].shape[0]===1,Ee=HJ(ve,xe,_[0].dtype,Se),Ce=GD(le.map(De=>De.shape),re),Ie=b.makeTensorInfo(Ce,_[0].dtype,Ee);return fe.forEach(De=>b.disposeIntermediateTensorInfo(De)),Ie}const q2J={kernelName:qJ,backendName:"cpu",kernelFunc:q2V};function q2Y(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee,filter:re}=_,{strides:ae,pad:xe,dataFormat:le,dilations:fe,dimRoundingMode:ve}=$;lK([ee,re],"conv2d");const Se=Ds(le),Ee=ij(ee.shape,re.shape,ae,fe,xe,ve,!1,Se),Ce=Ee.filterHeight,Ie=Ee.filterWidth,De=Ee.dilationHeight,Be=Ee.dilationWidth,Ne=Ee.padInfo.left,qe=Ee.padInfo.top,Xe=Ee.dataFormat==="channelsLast",Ye=new EU(Ee.outShape,ee.dtype),Qe=y(ee.shape),rt=y(re.shape),ot=Qe[0],ct=Xe?Qe[1]:Qe[2],mt=Xe?Qe[2]:1,_t=Xe?1:Qe[1],Lt=Ye.strides[0],Vt=Xe?Ye.strides[1]:Ye.strides[2],Gt=Xe?Ye.strides[2]:1,$t=Xe?1:Ye.strides[1],Qt=b.data.get(ee.dataId).values,vt=b.data.get(re.dataId).values,It=Ye.values;for(let gt=0;gt<Ee.batchSize;++gt){const Tt=gt*ot,Ct=gt*Lt;for(let Ft=0;Ft<Ee.outHeight;++Ft){const sn=Ct+Ft*Vt,cn=Ft*Ee.strideHeight-qe;for(let en=0;en<Ce;++en){const yn=cn+en*De;if(yn<0||yn>=Ee.inHeight)continue;const Pn=en*rt[0],tr=Tt+yn*ct;for(let nr=0;nr<Ee.outWidth;++nr){const Fr=sn+nr*Gt,Ur=nr*Ee.strideWidth-Ne;for(let Kr=0;Kr<Ie;++Kr){const on=Ur+Kr*Be;if(on<0||on>=Ee.inWidth)continue;const qr=Pn+Kr*rt[1],rr=tr+on*mt;let Qr=qr;for(let Ir=0;Ir<Ee.inChannels;++Ir){const ai=Qt[rr+Ir*_t];for(let Hr=0;Hr<Ee.outChannels;++Hr)It[Fr+Hr*$t]+=ai*vt[Qr+Hr];Qr+=Ee.outChannels}}}}}}return b.makeTensorInfo(Ye.shape,Ye.dtype,It)}const q2P={kernelName:qY,backendName:"cpu",kernelFunc:q2Y};function q2U(H){const{inputs:_,backend:b,attrs:$}=H,{dy:ee,filter:re}=_,{inputShape:ae,strides:xe,pad:le,dataFormat:fe,dimRoundingMode:ve}=$;lK([ee,re],"conv2dBackpropInput");const Se=y(re.shape),Ee=y(ee.shape);let Ce=Ds(fe);const Ie=ij(ae,re.shape,xe,1,le,ve,!1,Ce),De=new EU(Ie.inShape,"float32"),Be=De.values,Ne=b.data.get(ee.dataId).values,qe=b.data.get(re.dataId).values,[Xe,Ye,Qe]=Se,{batchSize:rt,filterHeight:ot,filterWidth:ct,inChannels:mt,inHeight:_t,inWidth:Lt,outChannels:Vt,outHeight:Gt,outWidth:$t,strideHeight:Qt,strideWidth:vt}=Ie;Ce=Ie.dataFormat;const It=ot-1-Ie.padInfo.top,gt=ct-1-Ie.padInfo.left,Tt=Ce==="channelsLast",Ct=De.strides[0],Ft=Tt?De.strides[1]:De.strides[2],sn=Tt?De.strides[2]:1,cn=Tt?1:De.strides[1],en=Ee[0],yn=Tt?Ee[1]:Ee[2],Pn=Tt?Ee[2]:1,tr=Tt?1:Ee[1];for(let nr=0;nr<rt;++nr)for(let Fr=0;Fr<mt;++Fr)for(let Ur=0;Ur<_t;++Ur){const Kr=Ur-It,on=Math.max(0,Math.ceil(Kr/Qt)),qr=Math.min(Gt,(ot+Kr)/Qt);for(let rr=0;rr<Lt;++rr){const Qr=rr-gt,Ir=Math.max(0,Math.ceil(Qr/vt)),ai=Math.min($t,(ct+Qr)/vt);let Hr=0;for(let xn=on;xn<qr;++xn){const Ht=xn*Qt-Kr;for(let In=Ir;In<ai;++In){const er=In*vt-Qr,Hn=en*nr+yn*xn+Pn*In,Zn=Xe*(ot-1-Ht)+Ye*(ct-1-er)+Qe*Fr;for(let Dr=0;Dr<Vt;++Dr){const zn=Ne[Hn+tr*Dr],Nr=qe[Zn+Dr];Hr+=zn*Nr}}}const Vr=Ct*nr+Ft*Ur+sn*rr+cn*Fr;Be[Vr]=Hr}}return b.makeTensorInfo(De.shape,De.dtype,De.values)}const q30={kernelName:qU,backendName:"cpu",kernelFunc:q2U},q31=HK(nq,H=>Math.cos(H)),q32={kernelName:nq,backendName:"cpu",kernelFunc:q31};function q33(H){const{inputs:_,backend:b,attrs:$}=H,{image:ee,boxes:re,boxInd:ae}=_,{cropSize:xe,method:le,extrapolationValue:fe}=$,[ve,Se,Ee,Ce]=ee.shape,Ie=re.shape[0],[De,Be]=xe,Ne=DY([Ie,De,Be,Ce],"float32"),qe=b.data.get(re.dataId).values,Xe=b.data.get(ae.dataId).values,Ye=b.data.get(ee.dataId).values,Qe=y(ee.shape),rt=y(Ne.shape);for(let ot=0;ot<Ie;ot++){const ct=ot*4,mt=qe[ct],_t=qe[ct+1],Lt=qe[ct+2],Vt=qe[ct+3],Gt=Xe[ot];if(Gt>=ve)continue;const $t=De>1?(Lt-mt)*(Se-1)/(De-1):0,Qt=Be>1?(Vt-_t)*(Ee-1)/(Be-1):0;for(let vt=0;vt<De;vt++){const It=De>1?mt*(Se-1)+vt*$t:.5*(mt+Lt)*(Se-1);if(It<0||It>Se-1){for(let gt=0;gt<Be;gt++)for(let Tt=0;Tt<Ce;Tt++){const Ct=Tt+gt*rt[2]+vt*rt[1]+ot*rt[0];Ne.values[Ct]=fe}continue}if(le==="bilinear"){const gt=Math.floor(It),Tt=Math.ceil(It),Ct=It-gt;for(let Ft=0;Ft<Be;Ft++){const sn=Be>1?_t*(Ee-1)+Ft*Qt:.5*(_t+Vt)*(Ee-1);if(sn<0||sn>Ee-1){for(let Pn=0;Pn<Ce;Pn++){const tr=Pn+Ft*rt[2]+vt*rt[1]+ot*rt[0];Ne.values[tr]=fe}continue}const cn=Math.floor(sn),en=Math.ceil(sn),yn=sn-cn;for(let Pn=0;Pn<Ce;Pn++){let tr=Pn+cn*Qe[2]+gt*Qe[1]+Gt*Qe[0];const nr=Ye[tr];tr=Pn+en*Qe[2]+gt*Qe[1]+Gt*Qe[0];const Fr=Ye[tr];tr=Pn+cn*Qe[2]+Tt*Qe[1]+Gt*Qe[0];const Ur=Ye[tr];tr=Pn+en*Qe[2]+Tt*Qe[1]+Gt*Qe[0];const Kr=Ye[tr],on=nr+(Fr-nr)*yn,qr=Ur+(Kr-Ur)*yn;tr=Pn+Ft*rt[2]+vt*rt[1]+ot*rt[0],Ne.values[tr]=on+(qr-on)*Ct}}}else for(let gt=0;gt<Be;++gt){const Tt=Be>1?_t*(Ee-1)+gt*Qt:.5*(_t+Vt)*(Ee-1);if(Tt<0||Tt>Ee-1){for(let sn=0;sn<Ce;sn++){const cn=sn+gt*rt[2]+vt*rt[1]+ot*rt[0];Ne.values[cn]=fe}continue}const Ct=Math.round(Tt),Ft=Math.round(It);for(let sn=0;sn<Ce;sn++){const cn=sn+Ct*Qe[2]+Ft*Qe[1]+Gt*Qe[0],en=sn+gt*rt[2]+vt*rt[1]+ot*rt[0];Ne.values[en]=Ye[cn]}}}}return b.makeTensorInfo(Ne.shape,Ne.dtype,Ne.values)}const q34={kernelName:nn,backendName:"cpu",kernelFunc:q33};function q35(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{blockSize:re,dataFormat:ae}=$;k(ae==="NHWC",()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+ae);const xe=ee.shape[0],le=ee.shape[1],fe=ee.shape[2],ve=ee.shape[3],Se=le*re,Ee=fe*re,Ce=ve/(re*re),Ie=b.data.get(ee.dataId).values,De=new Float32Array(xe*Se*Ee*Ce);let Be=0;for(let Ne=0;Ne<xe;++Ne)for(let qe=0;qe<Se;++qe){const Xe=Math.floor(qe/re),Ye=qe%re;for(let Qe=0;Qe<Ee;++Qe){const rt=Math.floor(Qe/re),ot=Qe%re,ct=(Ye*re+ot)*Ce;for(let mt=0;mt<Ce;++mt){const _t=mt+ct+ve*(rt+fe*(Xe+le*Ne));De[Be++]=Ie[_t]}}}return b.makeTensorInfo([xe,Se,Ee,Ce],ee.dtype,De)}const q36={kernelName:ns,backendName:"cpu",kernelFunc:q35};function q37(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee,filter:re}=_,{strides:ae,pad:xe,dilations:le,dimRoundingMode:fe}=$;lK([ee,re],"depthwiseConv2DNative");const ve=y(ee.shape),Se=y(re.shape);let Ee=le;Ee==null&&(Ee=[1,1]),k(iU(ae,Ee),()=>"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+ae+" and dilations '"+Ee+"'");const Ce=ij(ee.shape,re.shape,ae,Ee,xe,fe,!0),{filterHeight:Ie,filterWidth:De,dilationHeight:Be,dilationWidth:Ne,padInfo:qe}=Ce,Xe=qe.left,Ye=qe.top,Qe=Ce.outChannels/Ce.inChannels,rt=new EU(Ce.outShape,ee.dtype),ot=b.data.get(ee.dataId).values,ct=b.data.get(re.dataId).values,mt=rt.values;for(let _t=0;_t<Ce.batchSize;++_t){const Lt=_t*ve[0],Vt=_t*rt.strides[0];for(let Gt=0;Gt<Ce.outHeight;++Gt){const $t=Vt+Gt*rt.strides[1],Qt=Gt*Ce.strideHeight-Ye;for(let vt=0;vt<Ie;++vt){const It=Qt+vt*Be;if(It<0||It>=Ce.inHeight)continue;const gt=vt*Se[0],Tt=Lt+It*ve[1];for(let Ct=0;Ct<Ce.outWidth;++Ct){const Ft=$t+Ct*rt.strides[2],sn=Ct*Ce.strideWidth-Xe;for(let cn=0;cn<De;++cn){const en=sn+cn*Ne;if(en<0||en>=Ce.inWidth)continue;const yn=gt+cn*Se[1],Pn=Tt+en*Ce.inChannels;let tr=Ft,nr=yn;for(let Fr=0;Fr<Ce.inChannels;++Fr){const Ur=ot[Pn+Fr];for(let Kr=0;Kr<Qe;++Kr)mt[tr+Kr]+=Ur*ct[nr+Kr];tr+=Qe,nr+=Qe}}}}}}return b.makeTensorInfo(rt.shape,rt.dtype,rt.values)}const q38={kernelName:nM,backendName:"cpu",kernelFunc:q37};function q39(H){const{inputs:_,backend:b,attrs:$}=H,{input:ee}=_,{dim:re}=$,ae=ee.shape.length,xe=ee.shape.slice();let le=re;return re<0&&(k(-(ae+1)<=re,()=>"Axis must be in the interval ["+-(ae+1)+", "+ae+"]"),le=ae+re+1),xe.splice(le,0,1),q2l({inputs:{x:ee},backend:b,attrs:{shape:xe}})}const q3q={kernelName:nZ,backendName:"cpu",kernelFunc:q39};function q3n(H){const{backend:_,attrs:b}=H,{shape:$,value:ee,dtype:re}=b,ae=re||Q(ee),xe=G(ae,i$1($));return q3g(xe,ee),_.makeTensorInfo($,ae,xe)}const q3p={kernelName:ne,backendName:"cpu",kernelFunc:q3n};function q3g(H,_,b){H.fill(_)}const q3x=HK(nD,H=>H>=0?H:Math.exp(H)-1);function q3s(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{alpha:re}=$;lK([ee],"leakyRelu");const ae=i$1(ee.shape),xe=b.data.get(ee.dataId).values,le=X("float32",ae);for(let fe=0;fe<xe.length;fe++)le[fe]=xe[fe]<0?re*xe[fe]:xe[fe];return b.makeTensorInfo(ee.shape,"float32",le)}const q3E=lY((H,_)=>H<0?_*H:H);function q3M(H){const{inputs:_,backend:b}=H,{x:$,alpha:ee}=_;lK([$,ee],"prelu");const re=b.data.get($.dataId).values,ae=b.data.get(ee.dataId).values,[xe,le]=q3E($.shape,ee.shape,re,ae,"float32");return b.makeTensorInfo(le,"float32",xe)}const q3f={kernelName:pX,backendName:"cpu",kernelFunc:q3M},q3S=HK(pj,H=>Math.max(0,H)),q3F={kernelName:pj,backendName:"cpu",kernelFunc:q3S},q3t=HK(pQ,H=>Math.min(Math.max(0,H),6)),q3k={kernelName:pQ,backendName:"cpu",kernelFunc:q3t};function q3O(H,_,b,$,ee){if(b==="linear")return H6({inputs:{x:_},backend:H});if(b==="relu")return q3S({inputs:{x:_},backend:H});if(b==="elu")return q3x({inputs:{x:_},backend:H});if(b==="relu6")return q3t({inputs:{x:_},backend:H});if(b==="prelu")return q3M({inputs:{x:_,alpha:$},backend:H});if(b==="leakyrelu")return q3s({inputs:{x:_},backend:H,attrs:{alpha:ee}});if(b==="sigmoid")return TD({inputs:{x:_},backend:H});throw new Error("Activation "+b+" has not been implemented for the CPU backend.")}function q3W(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee,filter:re,bias:ae,preluActivationWeights:xe}=_,{strides:le,pad:fe,dataFormat:ve,dilations:Se,dimRoundingMode:Ee,activation:Ce,leakyreluAlpha:Ie}=$;let De=q2Y({inputs:{x:ee,filter:re},backend:b,attrs:{strides:le,pad:fe,dataFormat:ve,dilations:Se,dimRoundingMode:Ee}});if(ae){const Be=De;if(ve==="NCHW"&&ae.shape.length===1&&ae.shape[0]!==1){const Ne=q2l({inputs:{x:ae},backend:b,attrs:{shape:[ae.shape[0],1,1]}});De=Hj({inputs:{a:De,b:Ne},backend:b}),b.disposeIntermediateTensorInfo(Ne)}else De=Hj({inputs:{a:De,b:ae},backend:b});b.disposeIntermediateTensorInfo(Be)}if(Ce){const Be=De;if(ve==="NCHW"&&Ce==="prelu"&&xe.shape.length===1&&xe.shape[0]!==1){const Ne=q2l({inputs:{x:xe},backend:b,attrs:{shape:[xe.shape[0],1,1]}});De=q3O(b,De,Ce,Ne,Ie),b.disposeIntermediateTensorInfo(Ne)}else De=q3O(b,De,Ce,xe,Ie);b.disposeIntermediateTensorInfo(Be)}return De}const q3i={kernelName:gu,backendName:"cpu",kernelFunc:q3W};function q3D(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee,filter:re,bias:ae,preluActivationWeights:xe}=_,{strides:le,pad:fe,dataFormat:ve,dilations:Se,dimRoundingMode:Ee,activation:Ce,leakyreluAlpha:Ie}=$;let De=q37({inputs:{x:ee,filter:re},backend:b,attrs:{strides:le,pad:fe,dataFormat:ve,dilations:Se,dimRoundingMode:Ee}});if(ae){const Be=De;De=Hj({inputs:{a:De,b:ae},backend:b}),b.disposeIntermediateTensorInfo(Be)}if(Ce){const Be=De;De=q3O(b,De,Ce,xe,Ie),b.disposeIntermediateTensorInfo(Be)}return De}const q3m={kernelName:gj,backendName:"cpu",kernelFunc:q3D};function q3a(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee,indices:re}=_,{axis:ae,batchDims:xe}=$;lK([ee,re],"gatherV2");const le=z$1(ae,ee.shape)[0],fe=b.data.get(re.dataId).values,ve=ee.shape[le];for(let Ye=0;Ye<fe.length;++Ye){const Qe=fe[Ye];k(Qe<=ve-1&&Qe>=0,()=>"GatherV2: the index value "+Qe+" is not in [0, "+(ve-1)+"]")}let Se=xe;xe==null&&(Se=0);const Ee=i$1(re.shape),Ce=uj(ee,re,le,Se),Ie=q2l({inputs:{x:ee},backend:b,attrs:{shape:[Ce.batchSize,Ce.outerSize,Ce.dimSize,Ce.sliceSize]}}),De=q2l({inputs:{x:re},backend:b,attrs:{shape:[Ce.batchSize,Ee/Ce.batchSize]}}),Be=[Ce.batchSize,Ce.outerSize,Ee/Ce.batchSize,Ce.sliceSize],Ne=b.bufferSync(De),qe=b.bufferSync(Ie),Xe=AD(qe,Ne,Be);return b.disposeIntermediateTensorInfo(Ie),b.disposeIntermediateTensorInfo(De),b.makeTensorInfo(Ce.outputShape,Xe.dtype,Xe.values)}const q3Z={kernelName:nu,backendName:"cpu",kernelFunc:q3a},q3w=lY((H,_)=>H&&_),q3e=HZ(nV,q3w,null,"bool"),q3z={kernelName:nV,backendName:"cpu",kernelFunc:q3e},q3c=lY((H,_)=>H||_),q3X=HZ(nJ,q3c,null,"bool"),q3G={kernelName:nJ,backendName:"cpu",kernelFunc:q3X};function q3N(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{reductionIndices:re,keepDims:ae}=$,xe=b;let le=ee.shape;const fe=le.length,ve=z$1(re,le);let Se=ve;const Ee=at(Se,fe);let Ce=xe.data.get(ee.dataId).values;if(Ee!=null){const Ye=new Array(fe);for(let Qe=0;Qe<Ye.length;Qe++)Ye[Qe]=le[Ee[Qe]];Ce=hZ(Ce,le,ee.dtype,Ee,Ye),Se=aD(Se.length,fe),le=Ye}lK(ee,"max"),aF("max",Se,fe);const[Ie,De]=aq(le,Se),Be=i$1(De),Ne=AB$1(Ce,Be,Ie,ee.dtype),qe=xe.write(Ne,Ie,ee.dtype);let Xe=Ie;return ae&&(Xe=aM(Ie,ve)),{dataId:qe,shape:Xe,dtype:ee.dtype}}const q3u={kernelName:nY,backendName:"cpu",kernelFunc:q3N};function q3j(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_;lK(ee,"maxPool");const{filterSize:re,strides:ae,pad:xe,dimRoundingMode:le}=$,fe=1;k(iU(ae,fe),()=>"Error in maxPool: Either strides or dilations must be 1. Got strides "+ae+" and dilations '"+fe+"'");const ve=iG(ee.shape,re,ae,fe,xe,le);let Se;if(ve.filterWidth===1&&ve.filterHeight===1&&D(ve.inShape,ve.outShape))Se=H6({inputs:{x:ee},backend:b});else{const Ee=b.data.get(ee.dataId).values,Ce=y(ee.shape),Ie=q2v(Ee,ee.shape,ee.dtype,Ce,ve,"max");Se=b.makeTensorInfo(ve.outShape,ee.dtype,Ie.values)}return Se}const q3L={kernelName:nU,backendName:"cpu",kernelFunc:q3j},q3I=lY((H,_)=>H/_),q3b=HZ(nW,q3I),q3R={kernelName:nW,backendName:"cpu",kernelFunc:q3b};function q3o(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{axis:re,keepDims:ae}=$;lK(ee,"sum");let xe;ee.dtype==="bool"?xe=HW({inputs:{x:ee},backend:b,attrs:{dtype:"int32"}}):xe=H6({inputs:{x:ee},backend:b});const le=xe.shape.length,fe=z$1(re,xe.shape),ve=at(fe,le);let Se=fe,Ee=xe;ve!=null&&(Ee=he({inputs:{x:xe},backend:b,attrs:{perm:ve}}),Se=aD(Se.length,le)),aF("sum",Se,Ee.shape.length);const[Ce,Ie]=aq(Ee.shape,Se),De=ML(Ee.dtype,"int32");let Be=lU(b,Ce,De);const Ne=i$1(Ie),qe=b.data.get(Be.dataId).values,Xe=b.data.get(Ee.dataId).values;for(let Ye=0;Ye<qe.length;++Ye){const Qe=Ye*Ne;let rt=0;for(let ot=0;ot<Ne;++ot)rt+=Xe[Qe+ot];qe[Ye]=rt}if(ae){const Ye=aM(Be.shape,fe),Qe=Be;Be=q2l({inputs:{x:Be},backend:b,attrs:{shape:Ye}}),b.disposeIntermediateTensorInfo(Qe)}return b.disposeIntermediateTensorInfo(xe),ve!=null&&b.disposeIntermediateTensorInfo(Ee),Be}const q3r={kernelName:pU,backendName:"cpu",kernelFunc:q3o};function q3Q(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{axis:re,keepDims:ae}=$,xe=z$1(re,ee.shape),le=aq(ee.shape,xe)[1],fe=i$1(le),ve=[],Se=b.makeTensorInfo([],"float32",new Float32Array([fe]));ve.push(Se);const Ee=HW({inputs:{x:ee},backend:b,attrs:{dtype:"float32"}});ve.push(Ee);const Ce=q3b({inputs:{a:Ee,b:Se},backend:b});ve.push(Ce);const Ie=q3o({inputs:{x:Ce},backend:b,attrs:{axis:re,keepDims:ae}});return ve.forEach(De=>b.disposeIntermediateTensorInfo(De)),Ie}const q3d={kernelName:p1,backendName:"cpu",kernelFunc:q3Q};function q3v(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{axis:re,keepDims:ae}=$;lK(ee,"min");const xe=z$1(re,ee.shape);let le=xe;const fe=at(le,ee.shape.length);let ve=ee;fe!=null&&(ve=he({inputs:{x:ee},backend:b,attrs:{perm:fe}}),le=aD(le.length,ee.shape.length)),aF("min",le,ve.shape.length);const[Se,Ee]=aq(ve.shape,le),Ce=i$1(Ee),Ie=T(i$1(Se),ve.dtype),De=b.data.get(ve.dataId).values;for(let Ne=0;Ne<Ie.length;++Ne){const qe=Ne*Ce;let Xe=De[qe];for(let Ye=0;Ye<Ce;++Ye){const Qe=De[qe+Ye];(Number.isNaN(Qe)||Qe<Xe)&&(Xe=Qe)}Ie[Ne]=Xe}fe!=null&&b.disposeIntermediateTensorInfo(ve);const Be=b.makeTensorInfo(Se,ve.dtype,Ie);if(ae){const Ne=aM(Se,xe),qe=q2l({inputs:{x:Be},backend:b,attrs:{shape:Ne}});return b.disposeIntermediateTensorInfo(Be),qe}return Be}const q3y={kernelName:pq,backendName:"cpu",kernelFunc:q3v};function q3C(H){const{inputs:_,backend:b,attrs:$}=H,{axis:ee}=$;if(_.length===1)return q39({inputs:{input:_[0]},backend:b,attrs:{dim:ee}});const re=_[0].shape,ae=_[0].dtype;_.forEach(ve=>{O(re,ve.shape,"All tensors passed to stack must have matching shapes"),k(ae===ve.dtype,()=>"All tensors passed to stack must have matching dtypes")});const xe=[],le=_.map(ve=>{const Se=q39({inputs:{input:ve},backend:b,attrs:{dim:ee}});return xe.push(Se),Se}),fe=q2V({inputs:le,backend:b,attrs:{axis:ee}});return xe.forEach(ve=>b.disposeIntermediateTensorInfo(ve)),fe}const q3l={kernelName:pZ,backendName:"cpu",kernelFunc:q3C};function q3H(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{paddings:re,constantValue:ae}=$;lK(ee,"pad");const xe=re.map((Ne,qe)=>Ne[0]+ee.shape[qe]+Ne[1]),le=re.map(Ne=>Ne[0]),fe=b.data.get(ee.dataId).values,ve=i$1(ee.shape),Se=ee.shape.length,Ee=y(ee.shape),Ce=i$1(xe),Ie=xe.length,De=y(xe),Be=X(ee.dtype,Ce);ae!==0&&Be.fill(ae);for(let Ne=0;Ne<ve;Ne++){const qe=V(Ne,Se,Ee).map((Ye,Qe)=>Ye+le[Qe]),Xe=B(qe,Ie,De);Be[Xe]=fe[Ne]}return{dataId:b.write(Be,xe,ee.dtype),shape:xe,dtype:ee.dtype}}const q3A={kernelName:pe,backendName:"cpu",kernelFunc:q3H},q3h=lY((H,_)=>Math.pow(H,_)),q3T=HZ(pz,q3h),q3K={kernelName:pz,backendName:"cpu",kernelFunc:q3T};function q3B(H){const{backend:_,attrs:b}=H,{start:$,stop:ee,dtype:re,step:ae}=b,xe=Tq($,ee,ae,re);return _.makeTensorInfo([xe.length],re,xe)}const q3V={kernelName:pG,backendName:"cpu",kernelFunc:q3B};function q3J(H){const{inputs:_,backend:b,attrs:$}=H,{images:ee}=_,{alignCorners:re,halfPixelCenters:ae,size:xe}=$;lK(ee,"resizeBilinear");const le=y(ee.shape),[fe,ve]=xe,[Se,Ee,Ce,Ie]=ee.shape,De=b.data.get(ee.dataId).values,Be=new Float32Array(i$1([Se,fe,ve,Ie])),Ne=[re&&fe>1?Ee-1:Ee,re&&ve>1?Ce-1:Ce],qe=[re&&fe>1?fe-1:fe,re&&ve>1?ve-1:ve];let Xe=0;const Ye=Ne[0]/qe[0],Qe=Ne[1]/qe[1];for(let rt=0;rt<Se;rt++)for(let ot=0;ot<fe;ot++){let ct;ae?ct=Ye*(ot+.5)-.5:ct=Ye*ot;const mt=Math.max(0,Math.floor(ct)),_t=ct-mt,Lt=Math.min(Ee-1,Math.ceil(ct)),Vt=rt*le[0]+mt*le[1],Gt=rt*le[0]+Lt*le[1];for(let $t=0;$t<ve;$t++){let Qt;ae?Qt=Qe*($t+.5)-.5:Qt=Qe*$t;const vt=Math.max(0,Math.floor(Qt)),It=Qt-vt,gt=Math.min(Ce-1,Math.ceil(Qt)),Tt=Vt+vt*le[2],Ct=Gt+vt*le[2],Ft=Vt+gt*le[2],sn=Gt+gt*le[2];for(let cn=0;cn<Ie;cn++){const en=De[Tt+cn],yn=De[Ct+cn],Pn=De[Ft+cn],tr=De[sn+cn],nr=en+(Pn-en)*It,Fr=yn+(tr-yn)*It,Ur=nr+(Fr-nr)*_t;Be[Xe++]=Ur}}}return b.makeTensorInfo([Se,fe,ve,Ie],"float32",Be)}const q3Y={kernelName:pr,backendName:"cpu",kernelFunc:q3J},q3P={kernelName:gX,backendName:"cpu",kernelFunc:({inputs:H,attrs:_,backend:b})=>{const{image:$}=H,{radians:ee,fillValue:re,center:ae}=_,xe=b,le=X($.dtype,i$1($.shape)),[fe,ve,Se,Ee]=$.shape,[Ce,Ie]=GR(ae,ve,Se),De=255,Be=Math.sin(ee),Ne=Math.cos(ee),qe=xe.data.get($.dataId).values;for(let Xe=0;Xe<fe;Xe++){const Ye=Xe*Se*ve*Ee;for(let Qe=0;Qe<ve;Qe++){const rt=Qe*(Se*Ee);for(let ot=0;ot<Se;ot++){const ct=ot*Ee;for(let mt=0;mt<Ee;mt++){const _t=[fe,Qe,ot,mt],Lt=_t[2],Vt=_t[1];let Gt=(Lt-Ce)*Ne-(Vt-Ie)*Be,$t=(Lt-Ce)*Be+(Vt-Ie)*Ne;Gt=Math.round(Gt+Ce),$t=Math.round($t+Ie);let Qt=re;if(typeof re!="number"&&(mt===3?Qt=De:Qt=re[mt]),Gt>=0&&Gt<Se&&$t>=0&&$t<ve){const It=$t*(Se*Ee),gt=Gt*Ee,Tt=Ye+It+gt+mt;Qt=qe[Tt]}const vt=Ye+rt+ct+mt;le[vt]=Qt}}}}return{dataId:xe.write(le,$.shape,$.dtype),shape:$.shape,dtype:$.dtype}}},q3U=HK(pJ,H=>Math.sin(H)),q40={kernelName:pJ,backendName:"cpu",kernelFunc:q3U},q41={kernelName:gn,backendName:"cpu",kernelFunc:({inputs:H,backend:_})=>{const{x:b}=H,$=_;lK(b,"square");const ee=$.data.get(b.dataId).values,re=new Float32Array(ee.length);for(let ae=0;ae<ee.length;++ae){const xe=ee[ae];re[ae]=xe*xe}return{dataId:$.write(re,b.shape,b.dtype),shape:b.shape,dtype:b.dtype}}};function q42(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{begin:re,end:ae,strides:xe,beginMask:le,endMask:fe,ellipsisMask:ve,newAxisMask:Se,shrinkAxisMask:Ee}=$;lK(ee,"stridedSlice");const{finalShapeSparse:Ce,finalShape:Ie,isIdentity:De,sliceDim0:Be,isSimpleSlice:Ne,begin:qe,end:Xe,strides:Ye}=WH(ee.shape,re,ae,xe,le,fe,ve,Se,Ee);let Qe;if(De)Qe=q2l({inputs:{x:ee},backend:b,attrs:{shape:Ie}});else if(Be||Ne){k(ee.shape.length>=1,()=>"Input must have rank at least 1, got: "+ee.shape.length);const rt=WF(qe,Xe,Ye),ot=Tz({inputs:{x:ee},backend:b,attrs:{begin:qe,size:rt}});Qe=q2l({inputs:{x:ot},backend:b,attrs:{shape:Ie}}),b.disposeIntermediateTensorInfo(ot)}else{const rt=b.bufferSync(ee),ot=TV(Ce,rt,Ye,qe);Qe=b.makeTensorInfo(Ie,ot.dtype,ot.values)}return Qe}const q43={kernelName:gs,backendName:"cpu",kernelFunc:q42};function q44(H){const{inputs:_,backend:b,attrs:$}=H,{x:ee}=_,{reps:re}=$;lK(ee,"tile");const ae=Kt(b.bufferSync(ee),re);return b.makeTensorInfo(ae.shape,ae.dtype,ae.values)}const q45={kernelName:gF,backendName:"cpu",kernelFunc:q44};function q46(H){const{inputs:_,attrs:b,backend:$}=H,{image:ee,transforms:re}=_,{interpolation:ae,fillMode:xe,fillValue:le,outputShape:fe}=b,[ve,Se,Ee,Ce]=ee.shape,[Ie,De]=fe??[Se,Ee],Be=[ve,Ie,De,Ce],Ne=y(ee.shape),qe=Ne[0],Xe=Ne[1],Ye=Ne[2],Qe=y(Be),rt=Qe[0],ot=Qe[1],ct=Qe[2],mt=X(ee.dtype,i$1(Be));mt.fill(le);const _t=$.data.get(ee.dataId).values,Lt=$.data.get(re.dataId).values;for(let Vt=0;Vt<ve;++Vt){const Gt=re.shape[0]===1?Lt:Lt.subarray(Vt*8,Vt*8+8);for(let $t=0;$t<Ie;++$t)for(let Qt=0;Qt<De;++Qt)for(let vt=0;vt<Ce;++vt){let It;const gt=Gt[6]*Qt+Gt[7]*$t+1;if(gt===0)continue;const Tt=(Gt[0]*Qt+Gt[1]*$t+Gt[2])/gt,Ct=(Gt[3]*Qt+Gt[4]*$t+Gt[5])/gt,Ft=q48(Tt,Ee,xe),sn=q48(Ct,Se,xe);switch(ae){case"nearest":It=q4x(_t,Se,Ee,qe,Xe,Ye,Vt,sn,Ft,vt,le);break;case"bilinear":It=q4s(_t,Se,Ee,qe,Xe,Ye,Vt,sn,Ft,vt,le);break;default:throw new Error("Error in Transform: Expect 'nearest' or 'bilinear', but got "+ae)}const cn=Vt*rt+$t*ot+Qt*ct+vt;mt[cn]=It}return $.makeTensorInfo(Be,ee.dtype,mt)}return{dataId:$.write(mt,Be,ee.dtype),shape:ee.shape,dtype:ee.dtype}}const q47={kernelName:gW,backendName:"cpu",kernelFunc:q46};function q48(H,_,b){switch(b){case"reflect":return q49(H,_);case"wrap":return q4q(H,_);case"nearest":return q4p(H,_);case"constant":default:return q4n(H)}}function q49(H,_){let b=H;if(b<0)if(_<=1)b=0;else{const $=2*_;b<$&&(b=$*Math.trunc(-b/$)+b),b=b<-_?b+$:-b-1}else if(b>_-1)if(_<=1)b=0;else{const $=2*_;b-=$*Math.trunc(b/$),b>=_&&(b=$-b-1)}return E$1(0,b,_-1)}function q4q(H,_){let b=H;if(b<0)if(_<=1)b=0;else{const $=_-1;b+=_*(Math.trunc(-b/$)+1)}else if(b>_-1)if(_<=1)b=0;else{const $=_-1;b-=_*Math.trunc(b/$)}return E$1(0,b,_-1)}function q4n(H,_){return H}function q4p(H,_){return E$1(0,H,_-1)}function q4g(H,_,b,$,ee,re,ae,xe,le,fe,ve){const Se=ae*$+xe*ee+le*re+fe;return 0<=xe&&xe<_&&0<=le&&le<b?H[Se]:ve}function q4x(H,_,b,$,ee,re,ae,xe,le,fe,ve){const Se=Math.round(xe),Ee=Math.round(le);return q4g(H,_,b,$,ee,re,ae,Se,Ee,fe,ve)}function q4s(H,_,b,$,ee,re,ae,xe,le,fe,ve){const Se=Math.floor(xe),Ee=Math.floor(le),Ce=Se+1,Ie=Ee+1,De=(Ie-le)*q4g(H,_,b,$,ee,re,ae,Se,Ee,fe,ve)+(le-Ee)*q4g(H,_,b,$,ee,re,ae,Se,Ie,fe,ve),Be=(Ie-le)*q4g(H,_,b,$,ee,re,ae,Ce,Ee,fe,ve)+(le-Ee)*q4g(H,_,b,$,ee,re,ae,Ce,Ie,fe,ve);return(Ce-xe)*De+(xe-Se)*Be}function q4E(H){const{inputs:_,backend:b}=H,{x:$}=_;if($.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if($.dtype==="complex64"){const ee=HM({inputs:{input:$},backend:b}),re=q4E({inputs:{x:ee},backend:b}),ae=q2B({inputs:{input:$},backend:b}),xe=q4E({inputs:{x:ae},backend:b}),le=lP({inputs:{real:re,imag:xe},backend:b});return b.disposeIntermediateTensorInfo(ee),b.disposeIntermediateTensorInfo(re),b.disposeIntermediateTensorInfo(ae),b.disposeIntermediateTensorInfo(xe),le}else return q3n({backend:b,attrs:{shape:$.shape,value:0,dtype:$.dtype}})}const q4M={kernelName:gZ,backendName:"cpu",kernelFunc:q4E};function q4f(H){const{inputs:_,backend:b,attrs:$}=H,{a:ee,b:re,bias:ae,preluActivationWeights:xe}=_,{transposeA:le,transposeB:fe,activation:ve,leakyreluAlpha:Se}=$;let Ee,Ce,Ie;const De=[];Ee=q2A({inputs:{a:ee,b:re},attrs:{transposeA:le,transposeB:fe},backend:b}),ae&&(Ce=Hj({inputs:{a:Ee,b:ae},backend:b}),De.push(Ee),Ee=Ce),ve&&(Ie=q3O(b,Ee,ve,xe,Se),De.push(Ee),Ee=Ie);for(const Be of De)b.disposeIntermediateTensorInfo(Be);return Ee}const q4S={kernelName:gG,backendName:"cpu",kernelFunc:q4f};gY(YM),gY(YY),gY(Ps),gY(PD),gY(PX),gY(UG),gY(UB),gY(UP),gY(q06),gY(q0x),gY(q0f),gY(q0k),gY(q0i),gY(q0a),gY(q0z),gY(q0X),gY(q0u),gY(q0I),gY(q0o),gY(q0y),gY(q0l),gY(q0T),gY(q0J),gY(YZ),gY(q10),gY(q14),gY(q18),gY(q1p),gY(q1s),gY(q1M),gY(q1t),gY(q1O),gY(q1i),gY(q1Z),gY(PH),gY(q1c),gY(q1G),gY(q1L),gY(q1o),gY(Yo),gY(q1Q),gY(q1C),gY(q1h),gY(q1V),gY(PV),gY(q1U),gY(q21),gY(q25),gY(q29),gY(q2E),gY(q2S),gY(q2k),gY(q2i),gY(q2a),gY(UW),gY(q2z),gY(q2G),gY(UZ),gY(q2u),gY(q2L),gY(lJ),gY(HL),gY(q2o),gY(q2d),gY(q2C),gY(q2h),gY(HD),gY(q2K),gY(q2J),gY(q2P),gY(q30),gY(q32),gY(q34),gY(q36),gY(q38),gY(q3q),gY(q3p),gY(AF),gY(q3i),gY(q3m),gY(q3Z),gY(AX$1),gY(Hq),gY(Aj),gY(AQ$1),gY(q3z),gY(q3G),gY(q3u),gY(q3L),gY(AY$1),gY(q3d),gY(q3y),gY(h1),gY(hF),gY(hD),gY(q3l),gY(q3A),gY(q3K),gY(q3f),gY(q3V),gY(q3R),gY(q3F),gY(q3k),gY(q2H),gY(q3Y),gY(q3P),gY(TZ),gY(q40),gY(TX),gY(TH),gY(q41),gY(q43),gY(KF),gY(q3r),gY(q45),gY(q47),gY(hz),gY(q4M),gY(q4S);class q4t{constructor(){this.bodyTracks=[],this.poseFilters=[],this.angle=15/180*Math.PI,this.ratio=1920/1080,this.near=1,this.poseScore=.6,this.alignScore=.9,this.alignVisibility=.9,this.skipCount=2,this.skipMax=2}async process(_,b){var $,ee;if(this.bodyTracks.length<1&&this.skipCount<this.skipMax)return this.skipCount++,[];this.skipCount=0;const re=Sq(()=>{const Ee=OM(OK(_,3),"float32"),Ce=ZK(iM(Ee,255*.5),1);return ZM(Ce,0)}),[ae,xe]=[re.shape[1],re.shape[2]];if(this.bodyTracks.length===0){const Ee=await(($=this.bodyDetector)==null?void 0:$.process(re))||[];this.bodyTracks=Ee.map(Ce=>({center:Ce.points[0],top:Ce.points[1]})),this.bodyTracks.forEach(()=>this.poseFilters.push(new jL))}const le=this.bodyTracks.length>0?((ee=this.poseDetector)==null?void 0:ee.process(re,this.bodyTracks))||[]:[];le.forEach((Ee,Ce)=>{var Ie;if(b!==void 0){const De=xe/ae,Be=Ee.top[0]-Ee.center[0],Ne=(Ee.top[1]-Ee.center[1])/De,qe=Math.sqrt(Be*Be+Ne*Ne)*2*(1+De)*.5;le[Ce]=this.poseFilters[Ce].filter(Ee,b,1/qe)}(Ie=this.poseAligner)==null||Ie.alignPoints(le[Ce].keypoints)}),re.dispose();let fe=[],ve=[],Se=[];for(let Ee=0;Ee<this.bodyTracks.length;Ee++){const Ce={center:[this.bodyTracks[Ee].center[0]*xe,this.bodyTracks[Ee].center[1]*ae],top:[this.bodyTracks[Ee].top[0]*xe,this.bodyTracks[Ee].top[1]*ae]};let Ie={center:[le[Ee].center[0]*xe,le[Ee].center[1]*ae],top:[le[Ee].top[0]*xe,le[Ee].top[1]*ae]};const De=[Ce,Ie].map(Be=>{const{center:Ne,top:qe}=Be,Xe=[qe[0]-Ne[0],qe[1]-Ne[1]],Ye=Math.sqrt(Xe[0]*Xe[0]+Xe[1]*Xe[1]);return[[Ne[0]-Ye,Ne[1]-Ye],[Ne[0]+Ye,Ne[1]+Ye]]});jo(De[0],De[1])>.5&&le[Ee].score>this.poseScore&&(fe.push({center:[...le[Ee].center],top:[...le[Ee].top]}),ve.push(this.poseFilters[Ee]),Se.push(le[Ee]))}return this.bodyTracks=fe,this.poseFilters=ve,Se}setCamera(_,b,$=1){var ee;this.angle=_,this.ratio=b,this.near=$,(ee=this.poseAligner)==null||ee.setCamera(_,b,$)}async init(_,b="./",$=!1,ee=!1,re="webgl"){const ae=await jB(_,b,$),xe=new ae.ParseLoader(b);if($||(await xe.remove("pose.wasm"),await xe.remove("poseutils.wasm")),!await xe.loadDict(["pose.wasm","poseutils.wasm"])||!await xe.load("pose.wasm")||!xe.parse())return;qM().set("WEBGL_USE_SHAPES_UNIFORMS",!0),fP(),await SF(re);const le={weightUrlConverter:async Ee=>Ee,fetchFunc:async Ee=>{const Ce=new Blob([xe.file(Ee)]);return fetch(URL.createObjectURL(Ce))}},fe=await rq("bodymodel.def",le),ve=await rq("posemodel.def",le);if(this.bodyDetector=new jF(fe),this.poseDetector=new jD(ve,ee),!await xe.load("poseutils.wasm"))return;const Se=await jV({wasmBinary:xe.data()});xe.delete(),Se.PoseAligner.prototype.alignPoints=function(Ee){const Ce=new Se.VectorFloat,Ie=new Se.VectorFloat,De=new Se.VectorFloat,Be=new Se.VectorFloat;Ee.forEach(qe=>{Ce.push_back(qe.pixel[0]),Ce.push_back(qe.pixel[1]),Ce.push_back(qe.pixel[2]),Ie.push_back(qe.metric[0]),Ie.push_back(qe.metric[1]),Ie.push_back(qe.metric[2]),De.push_back(qe.score),Be.push_back(qe.visibility)});const Ne=this.align(Ce,Ie,De,Be);Ee.forEach((qe,Xe)=>{qe.metric=[Ne.get(Xe*3),Ne.get(Xe*3+1),Ne.get(Xe*3+2)]}),Ce.delete(),Ie.delete(),De.delete(),Be.delete(),Ne.delete()},this.poseModule=Se,this.poseAligner=new this.poseModule.PoseAligner,this.poseAligner.setThresh(this.alignScore,this.alignVisibility)}reset(){var _;this.bodyTracks=[],this.poseFilters=[],this.skipCount=this.skipMax,(_=this.poseDetector)==null||_.reset()}async prepare(){var _,b;qM().set("ENGINE_COMPILE_ONLY",!0),await((_=this.bodyDetector)==null?void 0:_.prepare()),await((b=this.poseDetector)==null?void 0:b.prepare());const $=SD();$ instanceof JP&&($.checkCompileCompletion(),$.getUniformLocations()),qM().set("ENGINE_COMPILE_ONLY",!1)}dispose(){var _,b,$;this.reset(),(_=this.bodyDetector)==null||_.dispose(),delete this.bodyDetector,(b=this.poseDetector)==null||b.dispose(),delete this.poseDetector,($=this.poseAligner)==null||$.delete(),delete this.poseAligner}}var q4O=Object.defineProperty,q4W=Object.getOwnPropertySymbols,q4i=Object.prototype.hasOwnProperty,q4D=Object.prototype.propertyIsEnumerable,q4m=(H,_,b)=>_ in H?q4O(H,_,{enumerable:!0,configurable:!0,writable:!0,value:b}):H[_]=b,q4a=(H,_)=>{for(var b in _||(_={}))q4i.call(_,b)&&q4m(H,b,_[b]);if(q4W)for(var b of q4W(_))q4D.call(_,b)&&q4m(H,b,_[b]);return H};class q4Z{constructor(_){this.model=_,this.facesMax=3,this.iouThresh=.3,this.scoreThresh=.5,this.keypointCount=6,this.model=_,this.modelSize=_.inputs[0].shape?{width:_.inputs[0].shape[2],height:_.inputs[0].shape[1]}:{width:128,height:128},this.modelRatio=this.modelSize.width/this.modelSize.height,this.anchorsData=this.buildAnchors(this.modelSize),this.anchors=zX(this.anchorsData),this.size=zz([this.modelSize.width,this.modelSize.height])}async process(_,b){let $={x:0,y:0};const[ee,re,ae]=Sq(()=>{const De={width:_.shape[2],height:_.shape[1]},Be=De.width/De.height;let Ne=q4a({},De),qe={x:0,y:0};Be>this.modelRatio?(Ne.height=De.width/this.modelRatio,qe.y=Math.floor((Ne.height-De.height)*.5),$.y=qe.y/Ne.height):Be<this.modelRatio&&(Ne.width=De.height*this.modelRatio,qe.x=Math.floor((Ne.width-De.width)*.5),$.x=qe.x/Ne.width);const Xe=wz(_,[[0,0],[qe.y,qe.y],[qe.x,qe.x],[0,0]],0),Ye=Gq.resizeBilinear(Xe,[this.modelSize.height,this.modelSize.width]),Qe=WY(it(Ye,2),-1),rt=zq(this.model.execute(Qe,"objects")),ot=DH(rt,[0,0],[-1,1]),ct=zq(DR(ot)),mt=this.decodeBoxes(rt,this.anchors,this.size);return[rt,mt,ct]}),xe=await Gq.nonMaxSuppressionAsync(re,ae,this.facesMax,this.iouThresh,this.scoreThresh),le=await xe.data();xe.dispose();const fe=[];for(let De=0;De<le.length;De++){const Be=le[De];fe.push({box:DH(re,[Be,0],[1,-1]),score:DH(ae,Be,1),anchorI:Be,points:b?DH(ee,[Be,5],[1,-1]):void 0})}const ve=await Promise.all(fe.map(async De=>{var Be,Ne;const qe=await De.box.data(),Xe=await De.score.data(),Ye=await((Be=De.points)==null?void 0:Be.data());return De.box.dispose(),De.score.dispose(),(Ne=De.points)==null||Ne.dispose(),{box:qe,score:Xe[0],anchorI:De.anchorI,points:Ye}})),Se={width:1-2*$.x,height:1-2*$.y};$.x/=Se.width,$.y/=Se.height;const Ee=this.modelSize.width*Se.width,Ce=this.modelSize.height*Se.height,Ie=[];for(let De=0;De<ve.length;De++){const Be=ve[De].box,Ne=this.anchorsData[ve[De].anchorI],qe=ve[De].points,Xe=[];for(let Ye=0;Ye<this.keypointCount&&qe;Ye++)Xe.push({x:(qe[Ye*2+0]+Ne[0])/Ee-$.x,y:(qe[Ye*2+1]+Ne[1])/Ce-$.y});Ie.push({box:[[Be[0]/Ee-$.x,Be[1]/Ce-$.y],[Be[2]/Ee-$.x,Be[3]/Ce-$.y]],score:ve[De].score,keypoints:qe&&Xe})}return ee.dispose(),re.dispose(),ae.dispose(),Ie}decodeBoxes(_,b,$){const ee=DH(_,[0,1],[-1,2]),re=WY(ee,b),ae=DH(_,[0,3],[-1,2]),xe=iM(ae,2),le=ZK(re,xe),fe=WY(re,xe);return ms([le,fe],1)}buildAnchors(_){const b=[8,16],$=[2,6],ee=[];for(let re=0;re<b.length;re++){const ae=b[re],xe=Math.floor((_.height+ae-1)/ae),le=Math.floor((_.width+ae-1)/ae),fe=$[re];for(let ve=0;ve<xe;ve++){const Se=ae*(ve+.5);for(let Ee=0;Ee<le;Ee++){const Ce=ae*(Ee+.5);for(let Ie=0;Ie<fe;Ie++)ee.push([Ce,Se])}}}return ee}async prepare(){const{width:_,height:b}=this.modelSize,$=wF([1,b,_,3]),ee=this.model.execute($,"objects");await ee.data(),$.dispose(),ee.dispose()}dispose(){this.model.dispose(),this.anchors.dispose()}}var q4w=(H=>(H[H.EyeR=0]="EyeR",H[H.EyeL=1]="EyeL",H[H.Nose=2]="Nose",H[H.Mouth=3]="Mouth",H[H.EarR=4]="EarR",H[H.EarL=5]="EarL",H))(q4w||{});class q4e{constructor(_){this.model=_,this.boxFactor=1.5,this.symmetryPoints=[13,168],this.modelSize=_.inputs[0].shape?{width:_.inputs[0].shape[2],height:_.inputs[0].shape[1]}:{width:192,height:192},this.modelHighP=this.model.outputs.length===7}process(_,b){const $=b.map(xe=>{const{box:le,symmetry:fe}=xe,ve=.5*(this.boxFactor-1),Se={x:ve*(le[1][0]-le[0][0]),y:ve*(le[1][1]-le[0][1])};return{box:[[le[0][0]-Se.x,le[0][1]-Se.y],[le[1][0]+Se.x,le[1][1]+Se.y]],symmetry:fe}}),[ee,re]=[_.shape[1],_.shape[2]],{modelSize:ae}=this;return $.map(xe=>{const{box:le,symmetry:fe}=xe,ve=Math.atan2((fe[1].x-fe[0].x)*re,(fe[0].y-fe[1].y)*ee),Se=[.5*(le[0][0]+le[1][0]),.5*(le[0][1]+le[1][1])],Ee={width:le[1][0]-le[0][0],height:le[1][1]-le[0][1]},Ce=[le[0][1]*ee,le[0][0]*re,le[1][1]*ee,le[1][0]*re],Ie=this.rotatedRect(_,Ce,ve,ae),De=this.modelHighP?["output_mesh_identity","output_faceflag","output_lips","Identity_1:0","Identity_5:0","Identity_2:0","Identity_6:0"]:["output_mesh","output_faceflag"],[Be,Ne,qe,Xe,Ye,Qe,rt]=this.model.execute(Ie,De),ot=Be.dataSync(),ct=Ne.dataSync()[0];let mt=[];for(let Tt=0;Tt<ot.length/3;Tt++)mt.push([ot[Tt*3+0],ot[Tt*3+1],ot[Tt*3+2]]);if(qe){const Tt=qe.dataSync();q4c(mt,Tt,q4G)}if(Xe&&Ye){const Tt=Xe.dataSync(),Ct=Ye.dataSync();q4c(mt,Tt,q4N),q4c(mt,Ct,q4u)}if(Qe&&rt){const Tt=Qe.dataSync(),Ct=rt.dataSync(),Ft=[33,7,163,144,145,153,154,155,133,246,161,160,159,158,157,173].map(cn=>mt[cn]),sn=[263,249,390,373,374,380,381,382,362,466,388,387,386,385,384,398].map(cn=>mt[cn]);for(let cn=0;cn<Tt.length/2;cn++){const en=[Tt[cn*2+0],Tt[cn*2+1]];mt.push([en[0],en[1],q4X(en,Ft)])}for(let cn=0;cn<Ct.length/2;cn++){const en=[Ct[cn*2+0],Ct[cn*2+1]];mt.push([en[0],en[1],q4X(en,sn)])}}const _t=[Ee.width*re/ae.width,Ee.height*ee/ae.height],Lt=mt.map(Tt=>[(Tt[0]-ae.width/2)*_t[0],(Tt[1]-ae.height/2)*_t[1],Tt[2]*_t[0]]),Vt=Math.sin(ve),Gt=Math.cos(ve),$t=Lt.map(Tt=>[(Tt[0]*Gt-Tt[1]*Vt)/re+Se[0],(Tt[0]*Vt+Tt[1]*Gt)/ee+Se[1],Tt[2]/re]),Qt=$t.map(Tt=>Tt[0]),vt=$t.map(Tt=>Tt[1]),It=[Math.min(...Qt),Math.min(...vt)],gt=[Math.max(...Qt),Math.max(...vt)];return Ie.dispose(),Be.dispose(),Ne.dispose(),qe==null||qe.dispose(),Xe==null||Xe.dispose(),Ye==null||Ye.dispose(),Qe==null||Qe.dispose(),rt==null||rt.dispose(),{keypoints:$t,score:ct,box:[[It[0],It[1]],[gt[0],gt[1]]]}})}rotatedRect(_,b,$,ee){const[re,ae]=[b[2]-b[0],b[3]-b[1]],[xe,le]=[(b[2]+b[0])*.5,(b[3]+b[1])*.5],[fe,ve]=[re/ee.height,ae/ee.width],[Se,Ee]=[Math.cos($),Math.sin($)],Ce=[Se*ve,-Ee*fe,(-Se*ae+Ee*re)*.5+le,Ee*ve,Se*fe,(-Ee*ae-Se*re)*.5+xe,0,0];return Gq.transform(_,[Ce],"bilinear","constant",0,[ee.height,ee.width])}async prepare(){const{width:_,height:b}=this.modelSize,$=wF([1,b,_,3]),ee=this.model.execute($);await Promise.all(ee.map(async re=>{await re.data(),re.dispose()})),$.dispose()}dispose(){this.model.dispose()}}function q4c(H,_,b){for(let $=0;$<b.length;$++)H[b[$]][0]=_[$*2+0],H[b[$]][1]=_[$*2+1]}function q4X(H,_){let b=0,$=Number.MAX_VALUE;for(let ee=0;ee<_.length;ee++){const re=[_[ee][0]-H[0],_[ee][1]-H[1]],ae=re[0]*re[0]+re[1]*re[1];ae<$&&($=ae,b=ee)}return _[b][2]}const q4G=[61,146,91,181,84,17,314,405,321,375,291,185,40,39,37,0,267,269,270,409,78,95,88,178,87,14,317,402,318,324,308,191,80,81,82,13,312,311,310,415,76,77,90,180,85,16,315,404,320,307,306,184,74,73,72,11,302,303,304,408,62,96,89,179,86,15,316,403,319,325,292,183,42,41,38,12,268,271,272,407],q4N=[33,7,163,144,145,153,154,155,133,246,161,160,159,158,157,173,130,25,110,24,23,22,26,112,243,247,30,29,27,28,56,190,226,31,228,229,230,231,232,233,244,113,225,224,223,222,221,189,35,124,46,53,52,65,143,111,117,118,119,120,121,128,245,156,70,63,105,66,107,55,193],q4u=[263,249,390,373,374,380,381,382,362,466,388,387,386,385,384,398,359,255,339,254,253,252,256,341,463,467,260,259,257,258,286,414,446,261,448,449,450,451,452,453,464,342,445,444,443,442,441,413,265,353,276,283,282,295,372,340,346,347,348,349,350,357,465,383,300,293,334,296,336,285,417];var q4j=Object.defineProperty,q4L=Object.getOwnPropertySymbols,q4I=Object.prototype.hasOwnProperty,q4b=Object.prototype.propertyIsEnumerable,q4R=(H,_,b)=>_ in H?q4j(H,_,{enumerable:!0,configurable:!0,writable:!0,value:b}):H[_]=b,q4o=(H,_)=>{for(var b in _||(_={}))q4I.call(_,b)&&q4R(H,b,_[b]);if(q4L)for(var b of q4L(_))q4b.call(_,b)&&q4R(H,b,_[b]);return H};class q4r{constructor(_,b=!1){this.model=_,this.modelSize=_.inputs[0].shape?{width:_.inputs[0].shape[2],height:_.inputs[0].shape[1]}:{width:256,height:256},this.modelRatio=this.modelSize.width/this.modelSize.height,b&&(this.maskFilter=new jW(this.modelSize))}process(_,b){var $,ee;const{modelSize:re}=this,ae=_.shape[2]/_.shape[1],xe=this.modelRatio/ae,le={width:b[1][0]-b[0][0],height:b[1][1]-b[0][1]},fe={x:(b[1][0]+b[0][0])*.5,y:(b[1][1]+b[0][1])*.5};le.width/le.height>xe?le.height=le.width/xe:le.width=le.height*xe;const ve=[fe.y-le.height*.5,fe.x-le.width*.5,fe.y+le.height*.5,fe.x+le.width*.5],Se=Gq.cropAndResize(_,[ve],[0],[re.height,re.width]),Ee=($=this.model)==null?void 0:$.execute(Se),Ce=DH(Ee,[0,0,0,1],-1),Ie=zq(Ce),De=((ee=this.maskFilter)==null?void 0:ee.process(Ie))||Ie,Be=it(De,255),Ne=new Uint8Array(Be.dataSync());return Se.dispose(),Ee.dispose(),Ce.dispose(),Ie.dispose(),Be.dispose(),{buffer:Ne,size:q4o({},this.modelSize),box:[[ve[1],ve[0]],[ve[3],ve[2]]]}}resize(_){var b;if(this.modelSize.width===_.width&&this.modelSize.height===_.height)return;const{model:$}=this,ee=[Math.round(_.height/16),Math.round(_.width/16)];$.weights["up_sampling2d/mul"][0]=zz([ee[0]*2,ee[1]*2],"int32"),$.weights["up_sampling2d_1/mul"][0]=zz([ee[0]*4,ee[1]*4],"int32"),$.weights["up_sampling2d_2/mul"][0]=zz([ee[0]*8,ee[1]*8],"int32"),$.weights["segment/stack/1"][0]=zz([ee[0]*16],"int32"),$.weights["segment/stack/2"][0]=zz([ee[1]*16],"int32");const re=$.executor;re._inputs[0].attrParams.shape.value[1]=ee[0]*16,re._inputs[0].attrParams.shape.value[2]=ee[1]*16;const ae=$.executor.graph.nodes,xe=(le,fe)=>{const ve=ae[le].attrParams;ve.kernelSize.value[1]=fe[0],ve.kernelSize.value[2]=fe[1],ve.strides.value[1]=fe[0],ve.strides.value[2]=fe[1]};xe("average_pooling2d/AvgPool",[ee[0]*4,ee[1]*4]),xe("average_pooling2d_1/AvgPool",[ee[0],ee[1]]),xe("average_pooling2d_2/AvgPool",[ee[0],ee[1]]),xe("average_pooling2d_3/AvgPool",[ee[0],ee[1]]),xe("average_pooling2d_4/AvgPool",[ee[0],ee[1]]),xe("average_pooling2d_5/AvgPool",[ee[0],ee[1]]),xe("average_pooling2d_6/AvgPool",[ee[0],ee[1]]),xe("average_pooling2d_7/AvgPool",[ee[0]*2,ee[1]*2]),xe("average_pooling2d_8/AvgPool",[ee[0]*4,ee[1]*4]),xe("average_pooling2d_9/AvgPool",[ee[0]*8,ee[1]*8]),this.modelSize=_,this.modelRatio=_.width/_.height,(b=this.maskFilter)==null||b.resize(this.modelSize)}size(){return this.modelSize}reset(){var _;(_=this.maskFilter)==null||_.reset()}async prepare(){var _;const{width:b,height:$}=this.modelSize,ee=wF([1,$,b,3]),re=this.model.execute(ee),ae=DH(re,[0,0,0,1],-1),xe=zq(ae);await(((_=this.maskFilter)==null?void 0:_.process(xe))||xe).data(),ee.dispose(),re.dispose(),ae.dispose(),xe.dispose()}dispose(){var _;this.model.dispose(),(_=this.maskFilter)==null||_.dispose(),delete this.maskFilter}}var q4Q=(()=>{var H=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return function(_={}){var b=_,$,ee;b.ready=new Promise((Mt,Rt)=>{$=Mt,ee=Rt});var re=Object.assign({},b),ae=!0,xe="";function le(Mt){return b.locateFile?b.locateFile(Mt,xe):xe+Mt}typeof document<"u"&&document.currentScript&&(xe=document.currentScript.src),H&&(xe=H),xe.startsWith("blob:")?xe="":xe=xe.substr(0,xe.replace(/[?#].*/,"").lastIndexOf("/")+1),b.print||console.log.bind(console);var fe=b.printErr||console.error.bind(console);Object.assign(b,re),re=null,b.arguments&&b.arguments,b.thisProgram&&b.thisProgram,b.quit&&b.quit;var ve;b.wasmBinary&&(ve=b.wasmBinary);var Se,Ee=!1,Ce,Ie,De,Be,Ne,qe,Xe,Ye;function Qe(){var Mt=Se.buffer;b.HEAP8=Ce=new Int8Array(Mt),b.HEAP16=De=new Int16Array(Mt),b.HEAPU8=Ie=new Uint8Array(Mt),b.HEAPU16=Be=new Uint16Array(Mt),b.HEAP32=Ne=new Int32Array(Mt),b.HEAPU32=qe=new Uint32Array(Mt),b.HEAPF32=Xe=new Float32Array(Mt),b.HEAPF64=Ye=new Float64Array(Mt)}var rt=[],ot=[],ct=[];function mt(){if(b.preRun)for(typeof b.preRun=="function"&&(b.preRun=[b.preRun]);b.preRun.length;)Vt(b.preRun.shift());nr(rt)}function _t(){nr(ot)}function Lt(){if(b.postRun)for(typeof b.postRun=="function"&&(b.postRun=[b.postRun]);b.postRun.length;)$t(b.postRun.shift());nr(ct)}function Vt(Mt){rt.unshift(Mt)}function Gt(Mt){ot.unshift(Mt)}function $t(Mt){ct.unshift(Mt)}var Qt=0,vt=null;function It(Mt){var Rt;Qt++,(Rt=b.monitorRunDependencies)==null||Rt.call(b,Qt)}function gt(Mt){var Rt;if(Qt--,(Rt=b.monitorRunDependencies)==null||Rt.call(b,Qt),Qt==0&&vt){var Zt=vt;vt=null,Zt()}}function Tt(Mt){var Rt;(Rt=b.onAbort)==null||Rt.call(b,Mt),Mt="Aborted("+Mt+")",fe(Mt),Ee=!0,Mt+=". Build with -sASSERTIONS for more info.";var Zt=new WebAssembly.RuntimeError(Mt);throw ee(Zt),Zt}var Ct="data:application/octet-stream;base64,",Ft=Mt=>Mt.startsWith(Ct),sn;sn="faceutils.wasm",Ft(sn)||(sn=le(sn));function cn(Mt){if(Mt==sn&&ve)return new Uint8Array(ve);throw"both async and sync fetching of the wasm failed"}function en(Mt){return!ve&&ae&&typeof fetch=="function"?fetch(Mt,{credentials:"same-origin"}).then(Rt=>{if(!Rt.ok)throw"failed to load wasm binary file at '"+Mt+"'";return Rt.arrayBuffer()}).catch(()=>cn(Mt)):Promise.resolve().then(()=>cn(Mt))}function yn(Mt,Rt,Zt){return en(Mt).then(an=>WebAssembly.instantiate(an,Rt)).then(Zt,an=>{fe("failed to asynchronously prepare wasm: "+an),Tt(an)})}function Pn(Mt,Rt,Zt,an){return!Mt&&typeof WebAssembly.instantiateStreaming=="function"&&!Ft(Rt)&&typeof fetch=="function"?fetch(Rt,{credentials:"same-origin"}).then(_n=>{var Cn=WebAssembly.instantiateStreaming(_n,Zt);return Cn.then(an,function(Dn){return fe("wasm streaming compile failed: "+Dn),fe("falling back to ArrayBuffer instantiation"),yn(Rt,Zt,an)})}):yn(Rt,Zt,an)}function tr(){var Mt={a:ex};function Rt(an,_n){return Ns=an.exports,Se=Ns.y,Qe(),ii=Ns.C,Gt(Ns.z),gt(),Ns}It();function Zt(an){Rt(an.instance)}if(b.instantiateWasm)try{return b.instantiateWasm(Mt,Rt)}catch(an){fe("Module.instantiateWasm callback failed with error: "+an),ee(an)}return Pn(ve,sn,Mt,Zt).catch(ee),{}}var nr=Mt=>{for(;Mt.length>0;)Mt.shift()(b)};b.noExitRuntime;class Fr{constructor(Rt){this.excPtr=Rt,this.ptr=Rt-24}set_type(Rt){qe[this.ptr+4>>2]=Rt}get_type(){return qe[this.ptr+4>>2]}set_destructor(Rt){qe[this.ptr+8>>2]=Rt}get_destructor(){return qe[this.ptr+8>>2]}set_caught(Rt){Rt=Rt?1:0,Ce[this.ptr+12]=Rt}get_caught(){return Ce[this.ptr+12]!=0}set_rethrown(Rt){Rt=Rt?1:0,Ce[this.ptr+13]=Rt}get_rethrown(){return Ce[this.ptr+13]!=0}init(Rt,Zt){this.set_adjusted_ptr(0),this.set_type(Rt),this.set_destructor(Zt)}set_adjusted_ptr(Rt){qe[this.ptr+16>>2]=Rt}get_adjusted_ptr(){return qe[this.ptr+16>>2]}get_exception_ptr(){var Rt=Ot(this.get_type());if(Rt)return qe[this.excPtr>>2];var Zt=this.get_adjusted_ptr();return Zt!==0?Zt:this.excPtr}}var Ur=0,Kr=(Mt,Rt,Zt)=>{var an=new Fr(Mt);throw an.init(Rt,Zt),Ur=Mt,Ur},on={},qr=Mt=>{for(;Mt.length;){var Rt=Mt.pop(),Zt=Mt.pop();Zt(Rt)}};function rr(Mt){return this.fromWireType(qe[Mt>>2])}var Qr={},Ir={},ai={},Hr,Vr=Mt=>{throw new Hr(Mt)},xn=(Mt,Rt,Zt)=>{Mt.forEach(function(Fn){ai[Fn]=Rt});function an(Fn){var yr=Zt(Fn);yr.length!==Mt.length&&Vr("Mismatched type converter count");for(var wr=0;wr<Mt.length;++wr)zr(Mt[wr],yr[wr])}var _n=new Array(Rt.length),Cn=[],Dn=0;Rt.forEach((Fn,yr)=>{Ir.hasOwnProperty(Fn)?_n[yr]=Ir[Fn]:(Cn.push(Fn),Qr.hasOwnProperty(Fn)||(Qr[Fn]=[]),Qr[Fn].push(()=>{_n[yr]=Ir[Fn],++Dn,Dn===Cn.length&&an(_n)}))}),Cn.length===0&&an(_n)},Ht=Mt=>{var Rt=on[Mt];delete on[Mt];var Zt=Rt.elements,an=Zt.length,_n=Zt.map(Fn=>Fn.getterReturnType).concat(Zt.map(Fn=>Fn.setterArgumentType)),Cn=Rt.rawConstructor,Dn=Rt.rawDestructor;xn([Mt],_n,Fn=>(Zt.forEach((yr,wr)=>{var Ar=Fn[wr],li=yr.getter,vi=yr.getterContext,Ei=Fn[wr+an],Gi=yr.setter,Ki=yr.setterContext;yr.read=Ii=>Ar.fromWireType(li(vi,Ii)),yr.write=(Ii,Wi)=>{var Fa=[];Gi(Ki,Ii,Ei.toWireType(Fa,Wi)),qr(Fa)}}),[{name:Rt.name,fromWireType:yr=>{for(var wr=new Array(an),Ar=0;Ar<an;++Ar)wr[Ar]=Zt[Ar].read(yr);return Dn(yr),wr},toWireType:(yr,wr)=>{if(an!==wr.length)throw new TypeError("Incorrect number of tuple elements for "+Rt.name+": expected="+an+", actual="+wr.length);for(var Ar=Cn(),li=0;li<an;++li)Zt[li].write(Ar,wr[li]);return yr!==null&&yr.push(Dn,Ar),Ar},argPackAdvance:gi,readValueFromPointer:rr,destructorFunction:Dn}]))},In={},er=Mt=>{var Rt=In[Mt];delete In[Mt];var Zt=Rt.rawConstructor,an=Rt.rawDestructor,_n=Rt.fields,Cn=_n.map(Dn=>Dn.getterReturnType).concat(_n.map(Dn=>Dn.setterArgumentType));xn([Mt],Cn,Dn=>{var Fn={};return _n.forEach((yr,wr)=>{var Ar=yr.fieldName,li=Dn[wr],vi=yr.getter,Ei=yr.getterContext,Gi=Dn[wr+_n.length],Ki=yr.setter,Ii=yr.setterContext;Fn[Ar]={read:Wi=>li.fromWireType(vi(Ei,Wi)),write:(Wi,Fa)=>{var cs=[];Ki(Ii,Wi,Gi.toWireType(cs,Fa)),qr(cs)}}}),[{name:Rt.name,fromWireType:yr=>{var wr={};for(var Ar in Fn)wr[Ar]=Fn[Ar].read(yr);return an(yr),wr},toWireType:(yr,wr)=>{for(var Ar in Fn)if(!(Ar in wr))throw new TypeError('Missing field: "'+Ar+'"');var li=Zt();for(Ar in Fn)Fn[Ar].write(li,wr[Ar]);return yr!==null&&yr.push(an,li),li},argPackAdvance:gi,readValueFromPointer:rr,destructorFunction:an}]})},Hn=(Mt,Rt,Zt,an,_n)=>{},Zn=()=>{for(var Mt=new Array(256),Rt=0;Rt<256;++Rt)Mt[Rt]=String.fromCharCode(Rt);Dr=Mt},Dr,zn=Mt=>{for(var Rt="",Zt=Mt;Ie[Zt];)Rt+=Dr[Ie[Zt++]];return Rt},Nr,vr=Mt=>{throw new Nr(Mt)};function Sr(Mt,Rt,Zt={}){var an=Rt.name;if(Mt||vr('type "'+an+'" must have a positive integer typeid pointer'),Ir.hasOwnProperty(Mt)){if(Zt.ignoreDuplicateRegistrations)return;vr("Cannot register type '"+an+"' twice")}if(Ir[Mt]=Rt,delete ai[Mt],Qr.hasOwnProperty(Mt)){var _n=Qr[Mt];delete Qr[Mt],_n.forEach(Cn=>Cn())}}function zr(Mt,Rt,Zt={}){if(!("argPackAdvance"in Rt))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Sr(Mt,Rt,Zt)}var gi=8,oi=(Mt,Rt,Zt,an)=>{Rt=zn(Rt),zr(Mt,{name:Rt,fromWireType:function(_n){return!!_n},toWireType:function(_n,Cn){return Cn?Zt:an},argPackAdvance:gi,readValueFromPointer:function(_n){return this.fromWireType(Ie[_n])},destructorFunction:null})},Gr=Mt=>({count:Mt.count,deleteScheduled:Mt.deleteScheduled,preservePointerOnDelete:Mt.preservePointerOnDelete,ptr:Mt.ptr,ptrType:Mt.ptrType,smartPtr:Mt.smartPtr,smartPtrType:Mt.smartPtrType}),ri=Mt=>{function Rt(Zt){return Zt.$$.ptrType.registeredClass.name}vr(Rt(Mt)+" instance already deleted")},yi=!1,Ci=Mt=>{},wn=Mt=>{Mt.smartPtr?Mt.smartPtrType.rawDestructor(Mt.smartPtr):Mt.ptrType.registeredClass.rawDestructor(Mt.ptr)},Pr=Mt=>{Mt.count.value-=1;var Rt=Mt.count.value===0;Rt&&wn(Mt)},xr=(Mt,Rt,Zt)=>{if(Rt===Zt)return Mt;if(Zt.baseClass===void 0)return null;var an=xr(Mt,Rt,Zt.baseClass);return an===null?null:Zt.downcast(an)},gr={},Mr=()=>Object.keys(Ra).length,ci=()=>{var Mt=[];for(var Rt in Ra)Ra.hasOwnProperty(Rt)&&Mt.push(Ra[Rt]);return Mt},fi=[],Ui=()=>{for(;fi.length;){var Mt=fi.pop();Mt.$$.deleteScheduled=!1,Mt.delete()}},Vi,bi=Mt=>{Vi=Mt,fi.length&&Vi&&Vi(Ui)},Ga=()=>{b.getInheritedInstanceCount=Mr,b.getLiveInheritedInstances=ci,b.flushPendingDeletes=Ui,b.setDelayFunction=bi},Ra={},sa=(Mt,Rt)=>{for(Rt===void 0&&vr("ptr should not be undefined");Mt.baseClass;)Rt=Mt.upcast(Rt),Mt=Mt.baseClass;return Rt},$i=(Mt,Rt)=>(Rt=sa(Mt,Rt),Ra[Rt]),Fi=(Mt,Rt)=>{(!Rt.ptrType||!Rt.ptr)&&Vr("makeClassHandle requires ptr and ptrType");var Zt=!!Rt.smartPtrType,an=!!Rt.smartPtr;return Zt!==an&&Vr("Both smartPtrType and smartPtr must be specified"),Rt.count={value:1},ta(Object.create(Mt,{$$:{value:Rt,writable:!0}}))};function Ss(Mt){var Rt=this.getPointee(Mt);if(!Rt)return this.destructor(Mt),null;var Zt=$i(this.registeredClass,Rt);if(Zt!==void 0){if(Zt.$$.count.value===0)return Zt.$$.ptr=Rt,Zt.$$.smartPtr=Mt,Zt.clone();var an=Zt.clone();return this.destructor(Mt),an}function _n(){return this.isSmartPointer?Fi(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:Rt,smartPtrType:this,smartPtr:Mt}):Fi(this.registeredClass.instancePrototype,{ptrType:this,ptr:Mt})}var Cn=this.registeredClass.getActualType(Rt),Dn=gr[Cn];if(!Dn)return _n.call(this);var Fn;this.isConst?Fn=Dn.constPointerType:Fn=Dn.pointerType;var yr=xr(Rt,this.registeredClass,Fn.registeredClass);return yr===null?_n.call(this):this.isSmartPointer?Fi(Fn.registeredClass.instancePrototype,{ptrType:Fn,ptr:yr,smartPtrType:this,smartPtr:Mt}):Fi(Fn.registeredClass.instancePrototype,{ptrType:Fn,ptr:yr})}var ta=Mt=>typeof FinalizationRegistry>"u"?(ta=Rt=>Rt,Mt):(yi=new FinalizationRegistry(Rt=>{Pr(Rt.$$)}),ta=Rt=>{var Zt=Rt.$$,an=!!Zt.smartPtr;if(an){var _n={$$:Zt};yi.register(Rt,_n,Rt)}return Rt},Ci=Rt=>yi.unregister(Rt),ta(Mt)),Na=()=>{Object.assign(is.prototype,{isAliasOf(Mt){if(!(this instanceof is)||!(Mt instanceof is))return!1;var Rt=this.$$.ptrType.registeredClass,Zt=this.$$.ptr;Mt.$$=Mt.$$;for(var an=Mt.$$.ptrType.registeredClass,_n=Mt.$$.ptr;Rt.baseClass;)Zt=Rt.upcast(Zt),Rt=Rt.baseClass;for(;an.baseClass;)_n=an.upcast(_n),an=an.baseClass;return Rt===an&&Zt===_n},clone(){if(this.$$.ptr||ri(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var Mt=ta(Object.create(Object.getPrototypeOf(this),{$$:{value:Gr(this.$$)}}));return Mt.$$.count.value+=1,Mt.$$.deleteScheduled=!1,Mt},delete(){this.$$.ptr||ri(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&vr("Object already scheduled for deletion"),Ci(this),Pr(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},isDeleted(){return!this.$$.ptr},deleteLater(){return this.$$.ptr||ri(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&vr("Object already scheduled for deletion"),fi.push(this),fi.length===1&&Vi&&Vi(Ui),this.$$.deleteScheduled=!0,this}})};function is(){}var Hs=(Mt,Rt)=>Object.defineProperty(Rt,"name",{value:Mt}),$s=(Mt,Rt,Zt)=>{if(Mt[Rt].overloadTable===void 0){var an=Mt[Rt];Mt[Rt]=function(..._n){return Mt[Rt].overloadTable.hasOwnProperty(_n.length)||vr("Function '"+Zt+"' called with an invalid number of arguments ("+_n.length+") - expects one of ("+Mt[Rt].overloadTable+")!"),Mt[Rt].overloadTable[_n.length].apply(this,_n)},Mt[Rt].overloadTable=[],Mt[Rt].overloadTable[an.argCount]=an}},v0=(Mt,Rt,Zt)=>{b.hasOwnProperty(Mt)?(vr("Cannot register public name '"+Mt+"' twice"),$s(b,Mt,Mt),b.hasOwnProperty(Zt)&&vr("Cannot register multiple overloads of a function with the same number of arguments ("+Zt+")!"),b[Mt].overloadTable[Zt]=Rt):b[Mt]=Rt},Qs=48,Zs=57,as=Mt=>{if(Mt===void 0)return"_unknown";Mt=Mt.replace(/[^a-zA-Z0-9_]/g,"$");var Rt=Mt.charCodeAt(0);return Rt>=Qs&&Rt<=Zs?"_"+Mt:Mt};function Jt(Mt,Rt,Zt,an,_n,Cn,Dn,Fn){this.name=Mt,this.constructor=Rt,this.instancePrototype=Zt,this.rawDestructor=an,this.baseClass=_n,this.getActualType=Cn,this.upcast=Dn,this.downcast=Fn,this.pureVirtualFunctions=[]}var vn=(Mt,Rt,Zt)=>{for(;Rt!==Zt;)Rt.upcast||vr("Expected null or instance of "+Zt.name+", got an instance of "+Rt.name),Mt=Rt.upcast(Mt),Rt=Rt.baseClass;return Mt};function $n(Mt,Rt){if(Rt===null)return this.isReference&&vr("null is not a valid "+this.name),0;Rt.$$||vr('Cannot pass "'+_0(Rt)+'" as a '+this.name),Rt.$$.ptr||vr("Cannot pass deleted object as a pointer of type "+this.name);var Zt=Rt.$$.ptrType.registeredClass,an=vn(Rt.$$.ptr,Zt,this.registeredClass);return an}function Wn(Mt,Rt){var Zt;if(Rt===null)return this.isReference&&vr("null is not a valid "+this.name),this.isSmartPointer?(Zt=this.rawConstructor(),Mt!==null&&Mt.push(this.rawDestructor,Zt),Zt):0;(!Rt||!Rt.$$)&&vr('Cannot pass "'+_0(Rt)+'" as a '+this.name),Rt.$$.ptr||vr("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&Rt.$$.ptrType.isConst&&vr("Cannot convert argument of type "+(Rt.$$.smartPtrType?Rt.$$.smartPtrType.name:Rt.$$.ptrType.name)+" to parameter type "+this.name);var an=Rt.$$.ptrType.registeredClass;if(Zt=vn(Rt.$$.ptr,an,this.registeredClass),this.isSmartPointer)switch(Rt.$$.smartPtr===void 0&&vr("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:Rt.$$.smartPtrType===this?Zt=Rt.$$.smartPtr:vr("Cannot convert argument of type "+(Rt.$$.smartPtrType?Rt.$$.smartPtrType.name:Rt.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:Zt=Rt.$$.smartPtr;break;case 2:if(Rt.$$.smartPtrType===this)Zt=Rt.$$.smartPtr;else{var _n=Rt.clone();Zt=this.rawShare(Zt,ka.toHandle(()=>_n.delete())),Mt!==null&&Mt.push(this.rawDestructor,Zt)}break;default:vr("Unsupporting sharing policy")}return Zt}function An(Mt,Rt){if(Rt===null)return this.isReference&&vr("null is not a valid "+this.name),0;Rt.$$||vr('Cannot pass "'+_0(Rt)+'" as a '+this.name),Rt.$$.ptr||vr("Cannot pass deleted object as a pointer of type "+this.name),Rt.$$.ptrType.isConst&&vr("Cannot convert argument of type "+Rt.$$.ptrType.name+" to parameter type "+this.name);var Zt=Rt.$$.ptrType.registeredClass,an=vn(Rt.$$.ptr,Zt,this.registeredClass);return an}var Cr=()=>{Object.assign($r.prototype,{getPointee(Mt){return this.rawGetPointee&&(Mt=this.rawGetPointee(Mt)),Mt},destructor(Mt){var Rt;(Rt=this.rawDestructor)==null||Rt.call(this,Mt)},argPackAdvance:gi,readValueFromPointer:rr,fromWireType:Ss})};function $r(Mt,Rt,Zt,an,_n,Cn,Dn,Fn,yr,wr,Ar){this.name=Mt,this.registeredClass=Rt,this.isReference=Zt,this.isConst=an,this.isSmartPointer=_n,this.pointeeType=Cn,this.sharingPolicy=Dn,this.rawGetPointee=Fn,this.rawConstructor=yr,this.rawShare=wr,this.rawDestructor=Ar,!_n&&Rt.baseClass===void 0?an?(this.toWireType=$n,this.destructorFunction=null):(this.toWireType=An,this.destructorFunction=null):this.toWireType=Wn}var Xr=(Mt,Rt,Zt)=>{b.hasOwnProperty(Mt)||Vr("Replacing nonexistent public symbol"),b[Mt].overloadTable!==void 0&&Zt!==void 0?b[Mt].overloadTable[Zt]=Rt:(b[Mt]=Rt,b[Mt].argCount=Zt)},Yr=(Mt,Rt,Zt)=>{var an=b["dynCall_"+Mt];return an(Rt,...Zt)},ui=[],ii,jr=Mt=>{var Rt=ui[Mt];return Rt||(Mt>=ui.length&&(ui.length=Mt+1),ui[Mt]=Rt=ii.get(Mt)),Rt},di=(Mt,Rt,Zt=[])=>{if(Mt.includes("j"))return Yr(Mt,Rt,Zt);var an=jr(Rt)(...Zt);return an},Pi=(Mt,Rt)=>(...Zt)=>di(Mt,Rt,Zt),Ai=(Mt,Rt)=>{Mt=zn(Mt);function Zt(){return Mt.includes("j")?Pi(Mt,Rt):jr(Rt)}var an=Zt();return typeof an!="function"&&vr("unknown function pointer with signature "+Mt+": "+Rt),an},xa=(Mt,Rt)=>{var Zt=Hs(Rt,function(an){this.name=Rt,this.message=an;var _n=new Error(an).stack;_n!==void 0&&(this.stack=this.toString()+`
`+_n.replace(/^Error(:[^\n]*)?\n/,""))});return Zt.prototype=Object.create(Mt.prototype),Zt.prototype.constructor=Zt,Zt.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},Zt},Mi,Jr=Mt=>{var Rt=zt(Mt),Zt=zn(Rt);return ds(Rt),Zt},Zi=(Mt,Rt)=>{var Zt=[],an={};function _n(Cn){if(!an[Cn]&&!Ir[Cn]){if(ai[Cn]){ai[Cn].forEach(_n);return}Zt.push(Cn),an[Cn]=!0}}throw Rt.forEach(_n),new Mi(Mt+": "+Zt.map(Jr).join([", "]))},Ri=(Mt,Rt,Zt,an,_n,Cn,Dn,Fn,yr,wr,Ar,li,vi)=>{Ar=zn(Ar),Cn=Ai(_n,Cn),Fn&&(Fn=Ai(Dn,Fn)),wr&&(wr=Ai(yr,wr)),vi=Ai(li,vi);var Ei=as(Ar);v0(Ei,function(){Zi("Cannot construct "+Ar+" due to unbound types",[an])}),xn([Mt,Rt,Zt],an?[an]:[],Gi=>{var Ki;Gi=Gi[0];var Ii,Wi;an?(Ii=Gi.registeredClass,Wi=Ii.instancePrototype):Wi=is.prototype;var Fa=Hs(Ar,function(...Ex){if(Object.getPrototypeOf(this)!==cs)throw new Nr("Use 'new' to construct "+Ar);if($a.constructor_body===void 0)throw new Nr(Ar+" has no accessible constructor");var Qx=$a.constructor_body[Ex.length];if(Qx===void 0)throw new Nr("Tried to invoke ctor of "+Ar+" with invalid number of parameters ("+Ex.length+") - expected ("+Object.keys($a.constructor_body).toString()+") parameters instead!");return Qx.apply(this,Ex)}),cs=Object.create(Wi,{constructor:{value:Fa}});Fa.prototype=cs;var $a=new Jt(Ar,Fa,cs,vi,Ii,Cn,Fn,wr);$a.baseClass&&((Ki=$a.baseClass).__derivedClasses!=null||(Ki.__derivedClasses=[]),$a.baseClass.__derivedClasses.push($a));var ws=new $r(Ar,$a,!0,!1,!1),E0=new $r(Ar+"*",$a,!1,!1,!1),Co=new $r(Ar+" const*",$a,!1,!0,!1);return gr[Mt]={pointerType:E0,constPointerType:Co},Xr(Ei,Fa),[ws,E0,Co]})},zi=(Mt,Rt)=>{for(var Zt=[],an=0;an<Mt;an++)Zt.push(qe[Rt+an*4>>2]);return Zt};function Ws(Mt){for(var Rt=1;Rt<Mt.length;++Rt)if(Mt[Rt]!==null&&Mt[Rt].destructorFunction===void 0)return!0;return!1}function Da(Mt,Rt,Zt,an,_n,Cn){var Dn=Rt.length;Dn<2&&vr("argTypes array size mismatch! Must at least get return value and 'this' types!");var Fn=Rt[1]!==null&&Zt!==null,yr=Ws(Rt),wr=Rt[0].name!=="void",Ar=Dn-2,li=new Array(Ar),vi=[],Ei=[],Gi=function(...Ki){Ki.length!==Ar&&vr("function "+Mt+" called with "+Ki.length+" arguments, expected "+Ar),Ei.length=0;var Ii;vi.length=Fn?2:1,vi[0]=_n,Fn&&(Ii=Rt[1].toWireType(Ei,this),vi[1]=Ii);for(var Wi=0;Wi<Ar;++Wi)li[Wi]=Rt[Wi+2].toWireType(Ei,Ki[Wi]),vi.push(li[Wi]);var Fa=an(...vi);function cs($a){if(yr)qr(Ei);else for(var ws=Fn?1:2;ws<Rt.length;ws++){var E0=ws===1?Ii:li[ws-2];Rt[ws].destructorFunction!==null&&Rt[ws].destructorFunction(E0)}if(wr)return Rt[0].fromWireType($a)}return cs(Fa)};return Hs(Mt,Gi)}var Js=(Mt,Rt,Zt,an,_n,Cn)=>{var Dn=zi(Rt,Zt);_n=Ai(an,_n),xn([],[Mt],Fn=>{Fn=Fn[0];var yr="constructor "+Fn.name;if(Fn.registeredClass.constructor_body===void 0&&(Fn.registeredClass.constructor_body=[]),Fn.registeredClass.constructor_body[Rt-1]!==void 0)throw new Nr("Cannot register multiple constructors with identical number of parameters ("+(Rt-1)+") for class '"+Fn.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return Fn.registeredClass.constructor_body[Rt-1]=()=>{Zi("Cannot construct "+Fn.name+" due to unbound types",Dn)},xn([],Dn,wr=>(wr.splice(1,0,null),Fn.registeredClass.constructor_body[Rt-1]=Da(yr,wr,null,_n,Cn),[])),[]})},Ji=Mt=>{Mt=Mt.trim();const Rt=Mt.indexOf("(");return Rt!==-1?Mt.substr(0,Rt):Mt},ss=(Mt,Rt,Zt,an,_n,Cn,Dn,Fn,yr)=>{var wr=zi(Zt,an);Rt=zn(Rt),Rt=Ji(Rt),Cn=Ai(_n,Cn),xn([],[Mt],Ar=>{Ar=Ar[0];var li=Ar.name+"."+Rt;Rt.startsWith("@@")&&(Rt=Symbol[Rt.substring(2)]),Fn&&Ar.registeredClass.pureVirtualFunctions.push(Rt);function vi(){Zi("Cannot call "+li+" due to unbound types",wr)}var Ei=Ar.registeredClass.instancePrototype,Gi=Ei[Rt];return Gi===void 0||Gi.overloadTable===void 0&&Gi.className!==Ar.name&&Gi.argCount===Zt-2?(vi.argCount=Zt-2,vi.className=Ar.name,Ei[Rt]=vi):($s(Ei,Rt,li),Ei[Rt].overloadTable[Zt-2]=vi),xn([],wr,Ki=>{var Ii=Da(li,Ki,Ar,Cn,Dn);return Ei[Rt].overloadTable===void 0?(Ii.argCount=Zt-2,Ei[Rt]=Ii):Ei[Rt].overloadTable[Zt-2]=Ii,[]}),[]})},qs=(Mt,Rt,Zt)=>(Mt instanceof Object||vr(Zt+' with invalid "this": '+Mt),Mt instanceof Rt.registeredClass.constructor||vr(Zt+' incompatible with "this" of type '+Mt.constructor.name),Mt.$$.ptr||vr("cannot call emscripten binding method "+Zt+" on deleted object"),vn(Mt.$$.ptr,Mt.$$.ptrType.registeredClass,Rt.registeredClass)),Di=(Mt,Rt,Zt,an,_n,Cn,Dn,Fn,yr,wr)=>{Rt=zn(Rt),_n=Ai(an,_n),xn([],[Mt],Ar=>{Ar=Ar[0];var li=Ar.name+"."+Rt,vi={get(){Zi("Cannot access "+li+" due to unbound types",[Zt,Dn])},enumerable:!0,configurable:!0};return yr?vi.set=()=>Zi("Cannot access "+li+" due to unbound types",[Zt,Dn]):vi.set=Ei=>vr(li+" is a read-only property"),Object.defineProperty(Ar.registeredClass.instancePrototype,Rt,vi),xn([],yr?[Zt,Dn]:[Zt],Ei=>{var Gi=Ei[0],Ki={get(){var Wi=qs(this,Ar,li+" getter");return Gi.fromWireType(_n(Cn,Wi))},enumerable:!0};if(yr){yr=Ai(Fn,yr);var Ii=Ei[1];Ki.set=function(Wi){var Fa=qs(this,Ar,li+" setter"),cs=[];yr(wr,Fa,Ii.toWireType(cs,Wi)),qr(cs)}}return Object.defineProperty(Ar.registeredClass.instancePrototype,Rt,Ki),[]}),[]})},Ts=[],Pa=[],js=Mt=>{Mt>9&&--Pa[Mt+1]===0&&(Pa[Mt]=void 0,Ts.push(Mt))},Ys=()=>Pa.length/2-5-Ts.length,yx=()=>{Pa.push(0,1,void 0,1,null,1,!0,1,!1,1),b.count_emval_handles=Ys},ka={toValue:Mt=>(Mt||vr("Cannot use deleted val. handle = "+Mt),Pa[Mt]),toHandle:Mt=>{switch(Mt){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:{const Rt=Ts.pop()||Pa.length;return Pa[Rt]=Mt,Pa[Rt+1]=1,Rt}}}},e0={name:"emscripten::val",fromWireType:Mt=>{var Rt=ka.toValue(Mt);return js(Mt),Rt},toWireType:(Mt,Rt)=>ka.toHandle(Rt),argPackAdvance:gi,readValueFromPointer:rr,destructorFunction:null},Yx=Mt=>zr(Mt,e0),_0=Mt=>{if(Mt===null)return"null";var Rt=typeof Mt;return Rt==="object"||Rt==="array"||Rt==="function"?Mt.toString():""+Mt},gx=(Mt,Rt)=>{switch(Rt){case 4:return function(Zt){return this.fromWireType(Xe[Zt>>2])};case 8:return function(Zt){return this.fromWireType(Ye[Zt>>3])};default:throw new TypeError("invalid float width ("+Rt+"): "+Mt)}},K0=(Mt,Rt,Zt)=>{Rt=zn(Rt),zr(Mt,{name:Rt,fromWireType:an=>an,toWireType:(an,_n)=>_n,argPackAdvance:gi,readValueFromPointer:gx(Rt,Zt),destructorFunction:null})},Xx=(Mt,Rt,Zt)=>{switch(Rt){case 1:return Zt?an=>Ce[an]:an=>Ie[an];case 2:return Zt?an=>De[an>>1]:an=>Be[an>>1];case 4:return Zt?an=>Ne[an>>2]:an=>qe[an>>2];default:throw new TypeError("invalid integer width ("+Rt+"): "+Mt)}},Kx=(Mt,Rt,Zt,an,_n)=>{Rt=zn(Rt);var Cn=Ar=>Ar;if(an===0){var Dn=32-8*Zt;Cn=Ar=>Ar<<Dn>>>Dn}var Fn=Rt.includes("unsigned"),yr=(Ar,li)=>{},wr;Fn?wr=function(Ar,li){return yr(li,this.name),li>>>0}:wr=function(Ar,li){return yr(li,this.name),li},zr(Mt,{name:Rt,fromWireType:Cn,toWireType:wr,argPackAdvance:gi,readValueFromPointer:Xx(Rt,Zt,an!==0),destructorFunction:null})},O0=(Mt,Rt,Zt)=>{var an=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],_n=an[Rt];function Cn(Dn){var Fn=qe[Dn>>2],yr=qe[Dn+4>>2];return new _n(Ce.buffer,yr,Fn)}Zt=zn(Zt),zr(Mt,{name:Zt,fromWireType:Cn,argPackAdvance:gi,readValueFromPointer:Cn},{ignoreDuplicateRegistrations:!0})},B0=(Mt,Rt,Zt,an)=>{if(!(an>0))return 0;for(var _n=Zt,Cn=Zt+an-1,Dn=0;Dn<Mt.length;++Dn){var Fn=Mt.charCodeAt(Dn);if(Fn>=55296&&Fn<=57343){var yr=Mt.charCodeAt(++Dn);Fn=65536+((Fn&1023)<<10)|yr&1023}if(Fn<=127){if(Zt>=Cn)break;Rt[Zt++]=Fn}else if(Fn<=2047){if(Zt+1>=Cn)break;Rt[Zt++]=192|Fn>>6,Rt[Zt++]=128|Fn&63}else if(Fn<=65535){if(Zt+2>=Cn)break;Rt[Zt++]=224|Fn>>12,Rt[Zt++]=128|Fn>>6&63,Rt[Zt++]=128|Fn&63}else{if(Zt+3>=Cn)break;Rt[Zt++]=240|Fn>>18,Rt[Zt++]=128|Fn>>12&63,Rt[Zt++]=128|Fn>>6&63,Rt[Zt++]=128|Fn&63}}return Rt[Zt]=0,Zt-_n},os=(Mt,Rt,Zt)=>B0(Mt,Ie,Rt,Zt),x0=Mt=>{for(var Rt=0,Zt=0;Zt<Mt.length;++Zt){var an=Mt.charCodeAt(Zt);an<=127?Rt++:an<=2047?Rt+=2:an>=55296&&an<=57343?(Rt+=4,++Zt):Rt+=3}return Rt},t0=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,vx=(Mt,Rt,Zt)=>{for(var an=Rt+Zt,_n=Rt;Mt[_n]&&!(_n>=an);)++_n;if(_n-Rt>16&&Mt.buffer&&t0)return t0.decode(Mt.subarray(Rt,_n));for(var Cn="";Rt<_n;){var Dn=Mt[Rt++];if(!(Dn&128)){Cn+=String.fromCharCode(Dn);continue}var Fn=Mt[Rt++]&63;if((Dn&224)==192){Cn+=String.fromCharCode((Dn&31)<<6|Fn);continue}var yr=Mt[Rt++]&63;if((Dn&240)==224?Dn=(Dn&15)<<12|Fn<<6|yr:Dn=(Dn&7)<<18|Fn<<12|yr<<6|Mt[Rt++]&63,Dn<65536)Cn+=String.fromCharCode(Dn);else{var wr=Dn-65536;Cn+=String.fromCharCode(55296|wr>>10,56320|wr&1023)}}return Cn},La=(Mt,Rt)=>Mt?vx(Ie,Mt,Rt):"",bx=(Mt,Rt)=>{Rt=zn(Rt);var Zt=Rt==="std::string";zr(Mt,{name:Rt,fromWireType(an){var _n=qe[an>>2],Cn=an+4,Dn;if(Zt)for(var Fn=Cn,yr=0;yr<=_n;++yr){var wr=Cn+yr;if(yr==_n||Ie[wr]==0){var Ar=wr-Fn,li=La(Fn,Ar);Dn===void 0?Dn=li:(Dn+="\0",Dn+=li),Fn=wr+1}}else{for(var vi=new Array(_n),yr=0;yr<_n;++yr)vi[yr]=String.fromCharCode(Ie[Cn+yr]);Dn=vi.join("")}return ds(an),Dn},toWireType(an,_n){_n instanceof ArrayBuffer&&(_n=new Uint8Array(_n));var Cn,Dn=typeof _n=="string";Dn||_n instanceof Uint8Array||_n instanceof Uint8ClampedArray||_n instanceof Int8Array||vr("Cannot pass non-string to std::string"),Zt&&Dn?Cn=x0(_n):Cn=_n.length;var Fn=H0(4+Cn+1),yr=Fn+4;if(qe[Fn>>2]=Cn,Zt&&Dn)os(_n,yr,Cn+1);else if(Dn)for(var wr=0;wr<Cn;++wr){var Ar=_n.charCodeAt(wr);Ar>255&&(ds(yr),vr("String has UTF-16 code units that do not fit in 8 bits")),Ie[yr+wr]=Ar}else for(var wr=0;wr<Cn;++wr)Ie[yr+wr]=_n[wr];return an!==null&&an.push(ds,Fn),Fn},argPackAdvance:gi,readValueFromPointer:rr,destructorFunction(an){ds(an)}})},o0=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Xs=(Mt,Rt)=>{for(var Zt=Mt,an=Zt>>1,_n=an+Rt/2;!(an>=_n)&&Be[an];)++an;if(Zt=an<<1,Zt-Mt>32&&o0)return o0.decode(Ie.subarray(Mt,Zt));for(var Cn="",Dn=0;!(Dn>=Rt/2);++Dn){var Fn=De[Mt+Dn*2>>1];if(Fn==0)break;Cn+=String.fromCharCode(Fn)}return Cn},Q0=(Mt,Rt,Zt)=>{if(Zt!=null||(Zt=2147483647),Zt<2)return 0;Zt-=2;for(var an=Rt,_n=Zt<Mt.length*2?Zt/2:Mt.length,Cn=0;Cn<_n;++Cn){var Dn=Mt.charCodeAt(Cn);De[Rt>>1]=Dn,Rt+=2}return De[Rt>>1]=0,Rt-an},D0=Mt=>Mt.length*2,n0=(Mt,Rt)=>{for(var Zt=0,an="";!(Zt>=Rt/4);){var _n=Ne[Mt+Zt*4>>2];if(_n==0)break;if(++Zt,_n>=65536){var Cn=_n-65536;an+=String.fromCharCode(55296|Cn>>10,56320|Cn&1023)}else an+=String.fromCharCode(_n)}return an},Z0=(Mt,Rt,Zt)=>{if(Zt!=null||(Zt=2147483647),Zt<4)return 0;for(var an=Rt,_n=an+Zt-4,Cn=0;Cn<Mt.length;++Cn){var Dn=Mt.charCodeAt(Cn);if(Dn>=55296&&Dn<=57343){var Fn=Mt.charCodeAt(++Cn);Dn=65536+((Dn&1023)<<10)|Fn&1023}if(Ne[Rt>>2]=Dn,Rt+=4,Rt+4>_n)break}return Ne[Rt>>2]=0,Rt-an},U0=Mt=>{for(var Rt=0,Zt=0;Zt<Mt.length;++Zt){var an=Mt.charCodeAt(Zt);an>=55296&&an<=57343&&++Zt,Rt+=4}return Rt},Sx=(Mt,Rt,Zt)=>{Zt=zn(Zt);var an,_n,Cn,Dn;Rt===2?(an=Xs,_n=Q0,Dn=D0,Cn=Fn=>Be[Fn>>1]):Rt===4&&(an=n0,_n=Z0,Dn=U0,Cn=Fn=>qe[Fn>>2]),zr(Mt,{name:Zt,fromWireType:Fn=>{for(var yr=qe[Fn>>2],wr,Ar=Fn+4,li=0;li<=yr;++li){var vi=Fn+4+li*Rt;if(li==yr||Cn(vi)==0){var Ei=vi-Ar,Gi=an(Ar,Ei);wr===void 0?wr=Gi:(wr+="\0",wr+=Gi),Ar=vi+Rt}}return ds(Fn),wr},toWireType:(Fn,yr)=>{typeof yr!="string"&&vr("Cannot pass non-string to C++ string type "+Zt);var wr=Dn(yr),Ar=H0(4+wr+Rt);return qe[Ar>>2]=wr/Rt,_n(yr,Ar+4,wr+Rt),Fn!==null&&Fn.push(ds,Ar),Ar},argPackAdvance:gi,readValueFromPointer:rr,destructorFunction(Fn){ds(Fn)}})},V0=(Mt,Rt,Zt,an,_n,Cn)=>{on[Mt]={name:zn(Rt),rawConstructor:Ai(Zt,an),rawDestructor:Ai(_n,Cn),elements:[]}},z0=(Mt,Rt,Zt,an,_n,Cn,Dn,Fn,yr)=>{on[Mt].elements.push({getterReturnType:Rt,getter:Ai(Zt,an),getterContext:_n,setterArgumentType:Cn,setter:Ai(Dn,Fn),setterContext:yr})},J0=(Mt,Rt,Zt,an,_n,Cn)=>{In[Mt]={name:zn(Rt),rawConstructor:Ai(Zt,an),rawDestructor:Ai(_n,Cn),fields:[]}},Ha=(Mt,Rt,Zt,an,_n,Cn,Dn,Fn,yr,wr)=>{In[Mt].fields.push({fieldName:zn(Rt),getterReturnType:Zt,getter:Ai(an,_n),getterContext:Cn,setterArgumentType:Dn,setter:Ai(Fn,yr),setterContext:wr})},l0=(Mt,Rt)=>{Rt=zn(Rt),zr(Mt,{isVoid:!0,name:Rt,argPackAdvance:0,fromWireType:()=>{},toWireType:(Zt,an)=>{}})},G0=(Mt,Rt)=>{var Zt=Ir[Mt];return Zt===void 0&&vr(Rt+" has unknown type "+Jr(Mt)),Zt},S0=(Mt,Rt)=>{Mt=G0(Mt,"_emval_take_value");var Zt=Mt.readValueFromPointer(Rt);return ka.toHandle(Zt)},Tx=()=>{Tt("")},j0=(Mt,Rt,Zt)=>Ie.copyWithin(Mt,Rt,Rt+Zt),Es=()=>2147483648,ls=Mt=>{var Rt=Se.buffer,Zt=(Mt-Rt.byteLength+65535)/65536;try{return Se.grow(Zt),Qe(),1}catch{}},T0=Mt=>{var Rt=Ie.length;Mt>>>=0;var Zt=Es();if(Mt>Zt)return!1;for(var an=(yr,wr)=>yr+(wr-yr%wr)%wr,_n=1;_n<=4;_n*=2){var Cn=Rt*(1+.2/_n);Cn=Math.min(Cn,Mt+100663296);var Dn=Math.min(Zt,an(Math.max(Mt,Cn),65536)),Fn=ls(Dn);if(Fn)return!0}return!1};Hr=b.InternalError=class extends Error{constructor(Mt){super(Mt),this.name="InternalError"}},Zn(),Nr=b.BindingError=class extends Error{constructor(Mt){super(Mt),this.name="BindingError"}},Na(),Ga(),Cr(),Mi=b.UnboundTypeError=xa(Error,"UnboundTypeError"),yx();var ex={b:Kr,h:Ht,x:er,q:Hn,v:oi,l:Ri,g:Js,c:ss,f:Di,u:Yx,n:K0,e:Kx,a:O0,m:bx,j:Sx,i:V0,d:z0,o:J0,k:Ha,w:l0,p:S0,r:Tx,t:j0,s:T0},Ns=tr(),ds=Mt=>(ds=Ns.A)(Mt),H0=Mt=>(H0=Ns.B)(Mt),zt=Mt=>(zt=Ns.D)(Mt),Ot=Mt=>(Ot=Ns.E)(Mt),un;vt=function Mt(){un||kn(),un||(vt=Mt)};function kn(){if(Qt>0||(mt(),Qt>0))return;function Mt(){un||(un=!0,b.calledRun=!0,!Ee&&(_t(),$(b),b.onRuntimeInitialized&&b.onRuntimeInitialized(),Lt()))}b.setStatus?(b.setStatus("Running..."),setTimeout(function(){setTimeout(function(){b.setStatus("")},1),Mt()},1)):Mt()}if(b.preInit)for(typeof b.preInit=="function"&&(b.preInit=[b.preInit]);b.preInit.length>0;)b.preInit.pop()();return kn(),_.ready}})();class q4d{constructor(){this.faceTracks=[],this.faceFilters=[],this.meshScore=.9,this.maskSize=256}async process(_,b){var $,ee,re,ae,xe;const le=Sq(()=>{const Ie=OM(OK(_,3),"float32"),De=it(Ie,1/255);return ZM(De,0)});let fe=[];this.faceTracks.length===0&&(fe=await(($=this.faceDetector)==null?void 0:$.process(le,!0))||[],fe.forEach(Ie=>{if(!Ie.keypoints)return;const{box:De}=Ie,Be=.5*.3*(Ie.box[1][1]-Ie.box[0][1]);this.faceTracks.push({box:[[De[0][0],De[0][1]-Be],[De[1][0],De[1][1]+Be]],symmetry:[Ie.keypoints[q4w.Mouth],Ie.keypoints[q4w.Nose]]}),this.faceFilters.push(new this.faceModule.FaceFilter({minCutOff:1,minCutOffD:2,beta:30},{minCutOff:1,minCutOffD:2,beta:30},1))}),(ee=this.bodySegmenter)==null||ee.reset());const ve=this.faceTracks.length>0?((re=this.meshDetector)==null?void 0:re.process(le,this.faceTracks))||[]:[],Se=[],Ee=[],Ce=[];for(let Ie=0;Ie<this.faceTracks.length;Ie++){const De=ve[Ie],{box:Be}=De,Ne=[De.keypoints[((ae=this.meshDetector)==null?void 0:ae.symmetryPoints[0])||0],De.keypoints[((xe=this.meshDetector)==null?void 0:xe.symmetryPoints[1])||0]];if(jo(this.faceTracks[Ie].box,Be)>.5&&De.score>this.meshScore){if(Ce.push(De),Se.push({box:Be,symmetry:[{x:Ne[0][0],y:Ne[0][1]},{x:Ne[1][0],y:Ne[1][1]}]}),b===void 0)continue;const[qe,Xe]=[le.shape[1],le.shape[2]],[Ye,Qe]=[Be[1][0]-Be[0][0],Be[1][1]-Be[0][1]],rt=(Ye+Qe*Xe/qe)*.5;this.faceFilters[Ie].smoothFilter(De,b,1/rt),De.keypoints=this.faceFilters[Ie].smoothPixel(),De.box=this.faceFilters[Ie].smoothBox();const{bodySegmenter:ot,maskExt:ct}=this;if(ot){const mt=ot.size(),_t=Xe/qe,Lt=mt.width/mt.height/_t,Vt=Lt<1?{width:Lt,height:1}:{width:1,height:1/Lt},Gt=[.5*(Be[0][0]+Be[1][0]),.5*(Be[0][1]+Be[1][1])],$t=ct?[[Be[0][0]-Ye*ct,Be[0][1]-Qe*ct],[Be[1][0]+Ye*ct,Be[1][1]+Qe*ct]]:[[Gt[0]-.5*Vt.width,Gt[1]-.5*Vt.height],[Gt[0]+.5*Vt.width,Gt[1]+.5*Vt.height]];$t[0][0]<0&&($t[1][0]-=$t[0][0],$t[0][0]=0),$t[0][1]<0&&($t[1][1]-=$t[0][1],$t[0][1]=0),$t[1][0]>1&&($t[0][0]-=$t[1][0]-1,$t[1][0]=1),$t[1][1]>1&&($t[0][1]-=$t[1][1]-1,$t[1][1]=1),$t[0][0]<0&&($t[0][0]*=.5,$t[1][0]-=$t[0][0]),$t[0][1]<0&&($t[0][1]*=.5,$t[1][1]-=$t[0][1]),De.mask=ot.process(le,$t)}Ee.push(this.faceFilters[Ie])}else this.faceFilters[Ie].delete()}return le.dispose(),this.faceTracks=Se,this.faceFilters=Ee,Ce}align(_){var b;const $=new this.faceModule.VectorFloat;return _.flat().forEach(ee=>$.push_back(ee)),(b=this.faceAligner)==null||b.align($),$.delete(),this.alignTransform()}alignTransform(){if(!this.faceAligner)return;const _=this.faceAligner.rotation,b=this.faceAligner.translation,$=this.faceAligner.scale,ee=this.faceAligner.shapeScale;return{rotation:[_[0],_[1],_[2],_[3]],translation:[b[0],b[1],b[2]],scale:$,shapeScale:[ee[0],ee[1],ee[2]]}}metricPoints(){if(!this.faceAligner)return;let _=[];const b=this.faceAligner.metricPoints();for(let $=0;$<b.size();$+=3)_.push([b.get($+0),b.get($+1),b.get($+2)]);return b.delete(),_}referencePoints(){if(!this.faceAligner)return;let _=[];const b=this.faceAligner.referencePoints();for(let $=0;$<b.size();$+=3)_.push([b.get($+0),b.get($+1),b.get($+2)]);return b.delete(),_}backprojPoints(){if(!this.faceAligner)return;let _=[];const b=this.faceAligner.backprojPoints();for(let $=0;$<b.size();$+=3)_.push([b.get($+0),b.get($+1),b.get($+2)]);return b.delete(),_}setCamera(_,b,$){var ee;if((ee=this.faceAligner)==null||ee.setCamera(_,b,$),this.bodySegmenter&&!this.maskExt){const re=this.maskSize/16,[ae,xe]=b>1?[re,Math.round(re/b)]:[Math.round(re*b),re];this.bodySegmenter.resize({width:ae*16,height:xe*16})}}async init(_,b="./",$=!1,ee=!1,re=!1,ae,xe=256,le="webgl"){const fe=await jB(_,b,$),ve=new fe.ParseLoader(b),[Se,Ee]=ee?["faceext.wasm","meshextmodel.def"]:["face.wasm","meshmodel.def"],Ce=[Se,"faceutils.wasm"];if(re&&Ce.push("mask.wasm"),!$)for(const Xe of Ce)await ve.remove(Xe);if(!await ve.loadDict(Ce)||!await ve.load(Se)||!ve.parse())return;qM().set("WEBGL_USE_SHAPES_UNIFORMS",!0),fP(),await SF(le);const Ie={weightUrlConverter:async Xe=>Xe,fetchFunc:async Xe=>{const Ye=new Blob([ve.file(Xe)]);return fetch(URL.createObjectURL(Ye))}},De=await rq("facemodel.def",Ie),Be=await rq(Ee,Ie),Ne=re&&await ve.load("mask.wasm")&&ve.parse()&&await rq("maskmodel.def",Ie);if(this.faceDetector=new q4Z(De),this.meshDetector=new q4e(Be),Ne&&(this.bodySegmenter=new q4r(Ne,typeof re=="object"&&re.smooth),this.bodySegmenter.resize({width:xe,height:xe}),this.maskSize=this.bodySegmenter.size().width,this.maskExt=ae),!await ve.load("faceutils.wasm"))return;const qe=await q4Q({wasmBinary:ve.data()});ve.delete(),qe.FaceFilter.prototype.smoothFilter=function(Xe,Ye){const Qe=new qe.VectorFloat,rt=new qe.VectorFloat;Xe.keypoints.flat().forEach(ot=>Qe.push_back(ot)),Xe.box.flat().forEach(ot=>rt.push_back(ot)),this.filter(Qe,rt,Xe.score,Ye,1),Qe.delete(),rt.delete()},qe.FaceFilter.prototype.smoothPixel=function(){let Xe=[];const Ye=this.pixel();for(let Qe=0;Qe<Ye.size();Qe+=3)Xe.push([Ye.get(Qe+0),Ye.get(Qe+1),Ye.get(Qe+2)]);return Ye.delete(),Xe},qe.FaceFilter.prototype.smoothBox=function(){const Xe=this.box(),Ye=[[Xe[0],Xe[1]],[Xe[2],Xe[3]]];return Xe.delete(),Ye},this.faceModule=qe,this.faceAligner=new this.faceModule.FaceAligner}reset(){var _;this.faceFilters.forEach(b=>b.delete()),this.faceFilters=[],this.faceTracks=[],(_=this.bodySegmenter)==null||_.reset()}async prepare(){var _,b,$;qM().set("ENGINE_COMPILE_ONLY",!0),await((_=this.faceDetector)==null?void 0:_.prepare()),await((b=this.meshDetector)==null?void 0:b.prepare()),await(($=this.bodySegmenter)==null?void 0:$.prepare());const ee=SD();ee instanceof JP&&(ee.checkCompileCompletion(),ee.getUniformLocations()),qM().set("ENGINE_COMPILE_ONLY",!1)}dispose(){var _,b,$,ee;this.reset(),(_=this.faceDetector)==null||_.dispose(),(b=this.meshDetector)==null||b.dispose(),($=this.bodySegmenter)==null||$.dispose(),(ee=this.faceAligner)==null||ee.delete()}}var q4T;(H=>(H.add=(_,b)=>[_[0]+b[0],_[1]+b[1],_[2]+b[2]],H.sub=(_,b)=>[_[0]-b[0],_[1]-b[1],_[2]-b[2]],H.cross=(_,b)=>[_[1]*b[2]-_[2]*b[1],_[2]*b[0]-_[0]*b[2],_[0]*b[1]-_[1]*b[0]],H.dot=(_,b)=>_[0]*b[0]+_[1]*b[1]+_[2]*b[2],H.lerp=(_,b,$)=>[_[0]+(b[0]-_[0])*$,_[1]+(b[1]-_[1])*$,_[2]+(b[2]-_[2])*$],H.scale=(_,b)=>[_[0]*b,_[1]*b,_[2]*b],H.scaleInPlace=(_,b)=>(_[0]*=b,_[1]*=b,_[2]*=b,_),H.negate=_=>[-_[0],-_[1],-_[2]],H.negateInPlace=_=>(_[0]=-_[0],_[1]=-_[1],_[2]=-_[2],_),H.normalize=_=>(0,H.scale)(_,1/(0,H.length)(_)),H.normalizeInPlace=_=>(0,H.scaleInPlace)(_,1/(0,H.length)(_)),H.normalizeToLen=(_,b)=>(0,H.scale)(_,b/(0,H.length)(_)),H.normalizeToLenInPlace=(_,b)=>(0,H.scaleInPlace)(_,b/(0,H.length)(_)),H.lengthSqr=_=>_[0]**2+_[1]**2+_[2]**2,H.length=_=>Math.sqrt(_[0]**2+_[1]**2+_[2]**2)))(q4T||(q4T={}));var q5q=typeof self<"u"?self:{};function q5n(){throw Error("Invalid UTF8")}function q5p(H,_){return _=String.fromCharCode.apply(null,_),H==null?_:H+_}let q5g,q5x;const q5s=typeof TextDecoder<"u";let q5E;const q5M=typeof TextEncoder<"u";function q5f(H){if(q5M)H=(q5E||(q5E=new TextEncoder)).encode(H);else{let b=0;const $=new Uint8Array(3*H.length);for(let ee=0;ee<H.length;ee++){var _=H.charCodeAt(ee);if(_<128)$[b++]=_;else{if(_<2048)$[b++]=_>>6|192;else{if(_>=55296&&_<=57343){if(_<=56319&&ee<H.length){const re=H.charCodeAt(++ee);if(re>=56320&&re<=57343){_=1024*(_-55296)+re-56320+65536,$[b++]=_>>18|240,$[b++]=_>>12&63|128,$[b++]=_>>6&63|128,$[b++]=63&_|128;continue}ee--}_=65533}$[b++]=_>>12|224,$[b++]=_>>6&63|128}$[b++]=63&_|128}}H=b===$.length?$:$.subarray(0,b)}return H}var q5S,q5F;e:{for(var q5t=["CLOSURE_FLAGS"],q5k=q5q,q5O=0;q5O<q5t.length;q5O++)if((q5k=q5k[q5t[q5O]])==null){q5F=null;break e}q5F=q5k}var q5W,q5i=q5F&&q5F[610401301];q5S=q5i!=null&&q5i;const q5D=q5q.navigator;function q5m(H){return!!q5S&&!!q5W&&q5W.brands.some(({brand:_})=>_&&_.indexOf(H)!=-1)}function q5a(H){var _;return(_=q5q.navigator)&&(_=_.userAgent)||(_=""),_.indexOf(H)!=-1}function q5Z(){return!!q5S&&!!q5W&&q5W.brands.length>0}function q5w(){return q5Z()?q5m("Chromium"):(q5a("Chrome")||q5a("CriOS"))&&!(!q5Z()&&q5a("Edge"))||q5a("Silk")}function q5e(H){return q5e[" "](H),H}q5W=q5D&&q5D.userAgentData||null,q5e[" "]=function(){};var q5z=!q5Z()&&(q5a("Trident")||q5a("MSIE"));!q5a("Android")||q5w(),q5w(),q5a("Safari")&&(q5w()||!q5Z()&&q5a("Coast")||!q5Z()&&q5a("Opera")||!q5Z()&&q5a("Edge")||(q5Z()?q5m("Microsoft Edge"):q5a("Edg/"))||q5Z()&&q5m("Opera"));var q5c={},q5X=null;function q5G(H){const _=H.length;let b=3*_/4;b%3?b=Math.floor(b):"=.".indexOf(H[_-1])!=-1&&(b="=.".indexOf(H[_-2])!=-1?b-2:b-1);const $=new Uint8Array(b);let ee=0;return function(re,ae){function xe(fe){for(;le<re.length;){const ve=re.charAt(le++),Se=q5X[ve];if(Se!=null)return Se;if(!/^[\s\xa0]*$/.test(ve))throw Error("Unknown base64 encoding at char: "+ve)}return fe}q5N();let le=0;for(;;){const fe=xe(-1),ve=xe(0),Se=xe(64),Ee=xe(64);if(Ee===64&&fe===-1)break;ae(fe<<2|ve>>4),Se!=64&&(ae(ve<<4&240|Se>>2),Ee!=64&&ae(Se<<6&192|Ee))}}(H,function(re){$[ee++]=re}),ee!==b?$.subarray(0,ee):$}function q5N(){if(!q5X){q5X={};var H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),_=["+/=","+/","-_=","-_.","-_"];for(let b=0;b<5;b++){const $=H.concat(_[b].split(""));q5c[b]=$;for(let ee=0;ee<$.length;ee++){const re=$[ee];q5X[re]===void 0&&(q5X[re]=ee)}}}}var q5u=typeof Uint8Array<"u",q5j=!q5z&&typeof btoa=="function";function q5L(H){if(!q5j){var _;_===void 0&&(_=0),q5N(),_=q5c[_];var b=Array(Math.floor(H.length/3)),$=_[64]||"";let le=0,fe=0;for(;le<H.length-2;le+=3){var ee=H[le],re=H[le+1],ae=H[le+2],xe=_[ee>>2];ee=_[(3&ee)<<4|re>>4],re=_[(15&re)<<2|ae>>6],ae=_[63&ae],b[fe++]=xe+ee+re+ae}switch(xe=0,ae=$,H.length-le){case 2:ae=_[(15&(xe=H[le+1]))<<2]||$;case 1:H=H[le],b[fe]=_[H>>2]+_[(3&H)<<4|xe>>4]+ae+$}return b.join("")}for(_="",b=0,$=H.length-10240;b<$;)_+=String.fromCharCode.apply(null,H.subarray(b,b+=10240));return _+=String.fromCharCode.apply(null,b?H.subarray(b):H),btoa(_)}const q5I=/[-_.]/g,q5b={"-":"+",_:"/",".":"="};function q5R(H){return q5b[H]||""}function q5o(H){if(!q5j)return q5G(H);q5I.test(H)&&(H=H.replace(q5I,q5R)),H=atob(H);const _=new Uint8Array(H.length);for(let b=0;b<H.length;b++)_[b]=H.charCodeAt(b);return _}function q5r(H){return q5u&&H!=null&&H instanceof Uint8Array}var q5Q={};function q5d(){return q5C||(q5C=new q5y(null,q5Q))}function q5v(H){q5H(q5Q);var _=H.g;return(_=_==null||q5r(_)?_:typeof _=="string"?q5o(_):null)==null?_:H.g=_}var q5y=class{h(){return new Uint8Array(q5v(this)||0)}constructor(H,_){if(q5H(_),this.g=H,H!=null&&H.length===0)throw Error("ByteString should be constructed with non-empty values")}};let q5C,q5l;function q5H(H){if(H!==q5Q)throw Error("illegal external caller")}function q5A(H,_){H.__closure__error__context__984382||(H.__closure__error__context__984382={}),H.__closure__error__context__984382.severity=_}function q5h(H){return q5A(H=Error(H),"warning"),H}var q5T=typeof Symbol=="function"&&typeof Symbol()=="symbol",q5K=new Set;function q5B(H,_,b=!1,$=!1){return H=typeof Symbol=="function"&&typeof Symbol()=="symbol"?$&&Symbol.for&&H?Symbol.for(H):H!=null?Symbol(H):Symbol():_,b&&q5K.add(H),H}var q5V=q5B("jas",void 0,!0,!0),q5J=q5B(void 0,"0di"),q5Y=q5B(void 0,"2ex"),q5P=q5B(void 0,"1oa",!0),q5U=q5B(void 0,Symbol(),!0);const q60=q5T?q5V:"Ga",q61={Ga:{value:0,configurable:!0,writable:!0,enumerable:!1}},q62=Object.defineProperties;function q63(H,_){q5T||q60 in H||q62(H,q61),H[q60]|=_}function q64(H,_){q5T||q60 in H||q62(H,q61),H[q60]=_}function q65(H){return q63(H,34),H}function q66(H,_){q64(_,-30975&(0|H))}function q67(H,_){q64(_,-30941&(34|H))}function q68(){return typeof BigInt=="function"}function q69(H){return Array.prototype.slice.call(H)}var q6q,q6n={},q6p={};function q6g(H){return!(!H||typeof H!="object"||H.Ia!==q6p)}function q6x(H){return H!==null&&typeof H=="object"&&!Array.isArray(H)&&H.constructor===Object}function q6s(H,_){if(H!=null){if(typeof H=="string")H=H?new q5y(H,q5Q):q5d();else if(H.constructor!==q5y)if(q5r(H))H=H.length?new q5y(new Uint8Array(H),q5Q):q5d();else{if(!_)throw Error();H=void 0}}return H}function q6E(H){return!(!Array.isArray(H)||H.length)&&!!(1&(0|H[q60]))}const q6M=[];function q6f(H){if(2&H)throw Error()}q64(q6M,55),q6q=Object.freeze(q6M);class q6S{constructor(_,b,$){this.l=0,this.g=_,this.h=b,this.m=$}next(){if(this.l<this.g.length){const _=this.g[this.l++];return{done:!1,value:this.h?this.h.call(this.m,_):_}}return{done:!0,value:void 0}}[Symbol.iterator](){return new q6S(this.g,this.h,this.m)}}function q6F(H){return q5U?H[q5U]:void 0}var q6t=Object.freeze({});function q6k(H){return H.Qa=!0,H}var q6O=q6k(H=>typeof H=="number"),q6W=q6k(H=>typeof H=="string"),q6i=q6k(H=>typeof H=="boolean"),q6D=typeof q5q.BigInt=="function"&&typeof q5q.BigInt(0)=="bigint",q6m=q6k(H=>q6D?H>=q6Z&&H<=q6e:H[0]==="-"?q6z(H,q6a):q6z(H,q6w));const q6a=Number.MIN_SAFE_INTEGER.toString(),q6Z=q6D?BigInt(Number.MIN_SAFE_INTEGER):void 0,q6w=Number.MAX_SAFE_INTEGER.toString(),q6e=q6D?BigInt(Number.MAX_SAFE_INTEGER):void 0;function q6z(H,_){if(H.length>_.length)return!1;if(H.length<_.length||H===_)return!0;for(let b=0;b<H.length;b++){const $=H[b],ee=_[b];if($>ee)return!1;if($<ee)return!0}}const q6c=typeof Uint8Array.prototype.slice=="function";let q6X,q6G=0,q6N=0;function q6u(H){const _=H>>>0;q6G=_,q6N=(H-_)/4294967296>>>0}function q6j(H){if(H<0){q6u(-H);const[_,b]=q6Q(q6G,q6N);q6G=_>>>0,q6N=b>>>0}else q6u(H)}function q6L(H){const _=q6X||(q6X=new DataView(new ArrayBuffer(8)));_.setFloat32(0,+H,!0),q6N=0,q6G=_.getUint32(0,!0)}function q6I(H,_){const b=4294967296*_+(H>>>0);return Number.isSafeInteger(b)?b:q6R(H,_)}function q6b(H,_){const b=2147483648&_;return b&&(_=~_>>>0,(H=1+~H>>>0)==0&&(_=_+1>>>0)),typeof(H=q6I(H,_))=="number"?b?-H:H:b?"-"+H:H}function q6R(H,_){if(H>>>=0,(_>>>=0)<=2097151)var b=""+(4294967296*_+H);else q68()?b=""+(BigInt(_)<<BigInt(32)|BigInt(H)):(H=(16777215&H)+6777216*(b=16777215&(H>>>24|_<<8))+6710656*(_=_>>16&65535),b+=8147497*_,_*=2,H>=1e7&&(b+=H/1e7>>>0,H%=1e7),b>=1e7&&(_+=b/1e7>>>0,b%=1e7),b=_+q6o(b)+q6o(H));return b}function q6o(H){return H=String(H),"0000000".slice(H.length)+H}function q6r(H){if(H.length<16)q6j(Number(H));else if(q68())H=BigInt(H),q6G=Number(H&BigInt(4294967295))>>>0,q6N=Number(H>>BigInt(32)&BigInt(4294967295));else{const _=+(H[0]==="-");q6N=q6G=0;const b=H.length;for(let $=_,ee=(b-_)%6+_;ee<=b;$=ee,ee+=6){const re=Number(H.slice($,ee));q6N*=1e6,q6G=1e6*q6G+re,q6G>=4294967296&&(q6N+=Math.trunc(q6G/4294967296),q6N>>>=0,q6G>>>=0)}if(_){const[$,ee]=q6Q(q6G,q6N);q6G=$,q6N=ee}}}function q6Q(H,_){return _=~_,H?H=1+~H:_+=1,[H,_]}const q6d=typeof BigInt=="function"?BigInt.asIntN:void 0,q6v=typeof BigInt=="function"?BigInt.asUintN:void 0,q6y=Number.isSafeInteger,q6C=Number.isFinite,q6l=Math.trunc;function q6H(H){return H==null||typeof H=="number"?H:H==="NaN"||H==="Infinity"||H==="-Infinity"?Number(H):void 0}function q6A(H){return H==null||typeof H=="boolean"?H:typeof H=="number"?!!H:void 0}const q6h=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function q6T(H){switch(typeof H){case"bigint":return!0;case"number":return q6C(H);case"string":return q6h.test(H);default:return!1}}function q6K(H){if(H==null)return H;if(typeof H=="string"&&H)H=+H;else if(typeof H!="number")return;return q6C(H)?0|H:void 0}function q6B(H){if(H==null)return H;if(typeof H=="string"&&H)H=+H;else if(typeof H!="number")return;return q6C(H)?H>>>0:void 0}function q6V(H){if(H[0]==="-")return!1;const _=H.length;return _<20||_===20&&Number(H.substring(0,6))<184467}function q6J(H){return H=q6l(H),q6y(H)||(q6j(H),H=q6b(q6G,q6N)),H}function q6Y(H){var _=q6l(Number(H));if(q6y(_))return String(_);if((_=H.indexOf("."))!==-1&&(H=H.substring(0,_)),_=H.length,!(H[0]==="-"?_<20||_===20&&Number(H.substring(0,7))>-922337:_<19||_===19&&Number(H.substring(0,6))<922337))if(q6r(H),H=q6G,2147483648&(_=q6N))if(q68())H=""+(BigInt(0|_)<<BigInt(32)|BigInt(H>>>0));else{const[b,$]=q6Q(H,_);H="-"+q6R(b,$)}else H=q6R(H,_);return H}function q6P(H){return H==null?H:typeof H=="bigint"?(q6m(H)?H=Number(H):(H=q6d(64,H),H=q6m(H)?Number(H):String(H)),H):q6T(H)?typeof H=="number"?q6J(H):q6Y(H):void 0}function q6U(H){if(H==null)return H;var _=typeof H;if(_==="bigint")return String(q6v(64,H));if(q6T(H)){if(_==="string")return _=q6l(Number(H)),q6y(_)&&_>=0?H=String(_):((_=H.indexOf("."))!==-1&&(H=H.substring(0,_)),q6V(H)||(q6r(H),H=q6R(q6G,q6N))),H;if(_==="number")return(H=q6l(H))>=0&&q6y(H)?H:function(b){if(b<0){q6j(b);var $=q6R(q6G,q6N);return b=Number($),q6y(b)?b:$}return q6V($=String(b))?$:(q6j(b),q6I(q6G,q6N))}(H)}}function q70(H){if(typeof H!="string")throw Error();return H}function q71(H){if(H!=null&&typeof H!="string")throw Error();return H}function q72(H){return H==null||typeof H=="string"?H:void 0}function q73(H,_,b,$){if(H!=null&&typeof H=="object"&&H.W===q6n)return H;if(!Array.isArray(H))return b?2&$?((H=_[q5J])||(q65((H=new _).u),H=_[q5J]=H),_=H):_=new _:_=void 0,_;let ee=b=0|H[q60];return ee===0&&(ee|=32&$),ee|=2&$,ee!==b&&q64(H,ee),new _(H)}function q74(H,_,b){if(_)e:{if(!q6T(_=H))throw q5h("int64");switch(typeof _){case"string":_=q6Y(_);break e;case"bigint":if(H=_=q6d(64,_),q6W(H)){if(!/^\s*(?:-?[1-9]\d*|0)?\s*$/.test(H))throw Error(String(H))}else if(q6O(H)&&!Number.isSafeInteger(H))throw Error(String(H));_=q6D?BigInt(_):q6i(_)?_?"1":"0":q6W(_)?_.trim()||"0":String(_);break e;default:_=q6J(_)}}else _=q6P(H);return typeof(b=(H=_)==null?b?0:void 0:H)=="string"&&q6y(_=+b)?_:b}const q75={};let q76=function(){try{return q5e(new class extends Map{constructor(){super()}}),!1}catch{return!0}}();class q77{constructor(){this.g=new Map}get(_){return this.g.get(_)}set(_,b){return this.g.set(_,b),this.size=this.g.size,this}delete(_){return _=this.g.delete(_),this.size=this.g.size,_}clear(){this.g.clear(),this.size=this.g.size}has(_){return this.g.has(_)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(_,b){return this.g.forEach(_,b)}[Symbol.iterator](){return this.entries()}}const q78=q76?(Object.setPrototypeOf(q77.prototype,Map.prototype),Object.defineProperties(q77.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),q77):class extends Map{constructor(){super()}};function q79(H){return H}function q7q(H){if(2&H.L)throw Error("Cannot mutate an immutable Map")}var q7n=class extends q78{constructor(H,_,b=q79,$=q79){super();let ee=0|H[q60];ee|=64,q64(H,ee),this.L=ee,this.S=_,this.R=b,this.Y=this.S?q7p:$;for(let re=0;re<H.length;re++){const ae=H[re],xe=b(ae[0],!1,!0);let le=ae[1];_?le===void 0&&(le=null):le=$(ae[1],!1,!0,void 0,void 0,ee),super.set(xe,le)}}na(H=q7g){if(this.size!==0)return this.X(H)}X(H=q7g){const _=[],b=super.entries();for(var $;!($=b.next()).done;)($=$.value)[0]=H($[0]),$[1]=H($[1]),_.push($);return _}clear(){q7q(this),super.clear()}delete(H){return q7q(this),super.delete(this.R(H,!0,!1))}entries(){var H=this.ma();return new q6S(H,q7x,this)}keys(){return this.Ha()}values(){var H=this.ma();return new q6S(H,q7n.prototype.get,this)}forEach(H,_){super.forEach((b,$)=>{H.call(_,this.get($),$,this)})}set(H,_){return q7q(this),(H=this.R(H,!0,!1))==null?this:_==null?(super.delete(H),this):super.set(H,this.Y(_,!0,!0,this.S,!1,this.L))}Na(H){const _=this.R(H[0],!1,!0);H=H[1],H=this.S?H===void 0?null:H:this.Y(H,!1,!0,void 0,!1,this.L),super.set(_,H)}has(H){return super.has(this.R(H,!1,!1))}get(H){H=this.R(H,!1,!1);const _=super.get(H);if(_!==void 0){var b=this.S;return b?((b=this.Y(_,!1,!0,b,this.ra,this.L))!==_&&super.set(H,b),b):_}}ma(){return Array.from(super.keys())}Ha(){return super.keys()}[Symbol.iterator](){return this.entries()}};function q7p(H,_,b,$,ee,re){return H=q73(H,$,b,re),ee&&(H=q7a(H)),H}function q7g(H){return H}function q7x(H){return[H,this.get(H)]}let q7s,q7E,q7M;function q7f(){return q7s||(q7s=new q7n(q65([]),void 0,void 0,void 0,q75))}function q7S(H,_,b,$,ee){if(H!=null){if(Array.isArray(H))H=q6E(H)?void 0:ee&&2&(0|H[q60])?H:q7F(H,_,b,$!==void 0,ee);else if(q6x(H)){const re={};for(let ae in H)re[ae]=q7S(H[ae],_,b,$,ee);H=re}else H=_(H,$);return H}}function q7F(H,_,b,$,ee){const re=$||b?0|H[q60]:0,ae=$?!!(32&re):void 0;$=q69(H);for(let xe=0;xe<$.length;xe++)$[xe]=q7S($[xe],_,b,ae,ee);return b&&((H=q6F(H))&&($[q5U]=q69(H)),b(re,$)),$}function q7t(H){return q7S(H,q7k,void 0,void 0,!1)}function q7k(H){return H.W===q6n?H.toJSON():H instanceof q7n?H.na(q7t):function(_){switch(typeof _){case"number":return isFinite(_)?_:String(_);case"bigint":return q6m(_)?Number(_):String(_);case"boolean":return _?1:0;case"object":if(_)if(Array.isArray(_)){if(q6E(_))return}else{if(q5r(_))return q5L(_);if(_ instanceof q5y){const b=_.g;return b==null?"":typeof b=="string"?b:_.g=q5L(b)}if(_ instanceof q7n)return _.na()}}return _}(H)}function q7O(H){return q7F(H,q7k,void 0,void 0,!1)}function q7W(H,_,b){return H=q7i(H,_[0],_[1],b?1:2),_!==q7E&&b&&q63(H,16384),H}function q7i(H,_,b,$){if(H==null){var ee=96;b?(H=[b],ee|=512):H=[],_&&(ee=-33521665&ee|(1023&_)<<15)}else{if(!Array.isArray(H))throw Error("narr");if(2048&(ee=0|H[q60]))throw Error("farr");if(64&ee)return H;if($===1||$===2||(ee|=64),b&&(ee|=512,b!==H[0]))throw Error("mid");e:{if($=(b=H).length){const re=$-1;if(q6x(b[re])){if((_=re-(512&(ee|=256)?0:-1))>=1024)throw Error("pvtlmt");ee=-33521665&ee|(1023&_)<<15;break e}}if(_){if((_=Math.max(_,$-(512&ee?0:-1)))>1024)throw Error("spvt");ee=-33521665&ee|(1023&_)<<15}}}return q64(H,ee),H}function q7D(H,_,b=q67){if(H!=null){if(q5u&&H instanceof Uint8Array)return _?H:new Uint8Array(H);if(Array.isArray(H)){var $=0|H[q60];return 2&$?H:(_&&(_=$===0||!!(32&$)&&!(64&$||!(16&$))),_?(q64(H,-12293&(34|$)),H):q7F(H,q7D,4&$?q67:b,!0,!0))}return H.W===q6n?H=2&($=0|(b=H.u)[q60])?H:new H.constructor(q7m(b,$,!0)):H instanceof q7n&&!(2&H.L)&&(b=q65(H.X(q7D)),H=new q7n(b,H.S,H.R,H.Y)),H}}function q7m(H,_,b){const $=b||2&_?q67:q66,ee=!!(32&_);return H=function(re,ae,xe){const le=q69(re);var fe=le.length;const ve=256&ae?le[fe-1]:void 0;for(fe+=ve?-1:0,ae=512&ae?1:0;ae<fe;ae++)le[ae]=xe(le[ae]);if(ve){ae=le[ae]={};for(const Se in ve)ae[Se]=xe(ve[Se])}return(re=q6F(re))&&(le[q5U]=q69(re)),le}(H,_,re=>q7D(re,ee,$)),q63(H,32|(b?2:0)),H}function q7a(H){const _=H.u,b=0|_[q60];return 2&b?new H.constructor(q7m(_,b,!1)):H}function q7Z(H,_){return q7w(H=H.u,0|H[q60],_)}function q7w(H,_,b,$){if(b===-1)return null;var ee=b+(512&_?0:-1);const re=H.length-1;return ee>=re&&256&_?H[re][b]:$&&256&_&&(_=H[re][b])!=null?(H[ee]!=null&&q5Y!=null&&((ee=(H=q5l??(q5l={}))[q5Y]||0)>=4||(H[q5Y]=ee+1,q5A(H=Error(),"incident"),function(ae){q5q.setTimeout(()=>{throw ae},0)}(H))),_):ee<=re?H[ee]:void 0}function q7e(H,_,b){const $=H.u;let ee=0|$[q60];return q6f(ee),q7z($,ee,_,b),H}function q7z(H,_,b,$){const ee=512&_?0:-1,re=b+ee;var ae=H.length-1;return re>=ae&&256&_?(H[ae][b]=$,_):re<=ae?(H[re]=$,256&_&&b in(H=H[ae])&&delete H[b],_):($!==void 0&&(b>=(ae=_>>15&1023||536870912)?$!=null&&(H[ae+ee]={[b]:$},q64(H,_|=256)):H[re]=$),_)}function q7c(H,_){let b=0|(H=H.u)[q60];const $=q7w(H,b,_),ee=q6H($);return ee!=null&&ee!==$&&q7z(H,b,_,ee),ee}function q7X(H){let _=0|(H=H.u)[q60];const b=q7w(H,_,1),$=q6s(b,!0);return $!=null&&$!==b&&q7z(H,_,1,$),$}function q7G(){return q6t===void 0?2:4}function q7N(H,_,b,$,ee){const re=H.u,ae=2&(H=0|re[q60])?1:$;ee=!!ee;let xe=0|($=q7u(re,H,_))[q60];if(!(4&xe)){4&xe&&($=q69($),xe=q7T(xe,H),H=q7z(re,H,_,$));let le=0,fe=0;for(;le<$.length;le++){const ve=b($[le]);ve!=null&&($[fe++]=ve)}fe<le&&($.length=fe),xe=q7j(xe,H),b=-4097&(20|xe),xe=b&=-8193,q64($,xe),2&xe&&Object.freeze($)}return ae===1||ae===4&&32&xe?q7L(xe)||(ee=xe,xe|=2,xe!==ee&&q64($,xe),Object.freeze($)):(ae===2&&q7L(xe)&&($=q69($),xe=q7T(xe,H),xe=q7K(xe,H,ee),q64($,xe),H=q7z(re,H,_,$)),q7L(xe)||(_=xe,xe=q7K(xe,H,ee),xe!==_&&q64($,xe))),$}function q7u(H,_,b,$){return H=q7w(H,_,b,$),Array.isArray(H)?H:q6q}function q7j(H,_){return H===0&&(H=q7T(H,_)),1|H}function q7L(H){return!!(2&H)&&!!(4&H)||!!(2048&H)}function q7I(H){H=q69(H);for(let _=0;_<H.length;_++){const b=H[_]=q69(H[_]);Array.isArray(b[1])&&(b[1]=q65(b[1]))}return H}function q7b(H,_,b,$){let ee=0|(H=H.u)[q60];q6f(ee),q7z(H,ee,_,($==="0"?Number(b)===0:b===$)?void 0:b)}function q7R(H,_,b,$,ee){q6f(_);var re=!(!(64&_)&&16384&_);const ae=(ee=q7u(H,_,b,ee))!==q6q;if(re||!ae){let xe=re=ae?0|ee[q60]:0;(!ae||2&xe||q7L(xe)||4&xe&&!(32&xe))&&(ee=q69(ee),xe=q7T(xe,_),_=q7z(H,_,b,ee)),xe=-13&q7j(xe,_),xe=q7K($?-17&xe:16|xe,_,!0),xe!==re&&q64(ee,xe)}return ee}function q7o(H,_){var b=qqR;return q7d(q7r(H=H.u),H,0|H[q60],b)===_?_:-1}function q7r(H){var _;if(q5T)return(_=H[q5P])!=null?_:H[q5P]=new Map;if(q5P in H)return H[q5P];const b=new Map;return Object.defineProperty(H,q5P,{value:b}),b}function q7Q(H,_,b,$){const ee=q7r(H),re=q7d(ee,H,_,b);return re!==$&&(re&&(_=q7z(H,_,re)),ee.set(b,$)),_}function q7d(H,_,b,$){let ee=H.get($);if(ee!=null)return ee;ee=0;for(let re=0;re<$.length;re++){const ae=$[re];q7w(_,b,ae)!=null&&(ee!==0&&(b=q7z(_,b,ee)),ee=ae)}return H.set($,ee),ee}function q7v(H,_,b,$){let ee,re=0|H[q60];if(($=q7w(H,re,b,$))!=null&&$.W===q6n)return(_=q7a($))!==$&&q7z(H,re,b,_),_.u;if(Array.isArray($)){const ae=0|$[q60];ee=2&ae?q7W(q7m($,ae,!1),_,!0):64&ae?$:q7W(ee,_,!0)}else ee=q7W(void 0,_,!0);return ee!==$&&q7z(H,re,b,ee),ee}function q7y(H,_,b,$){let ee=0|(H=H.u)[q60];return(_=q73($=q7w(H,ee,b,$),_,!1,ee))!==$&&_!=null&&q7z(H,ee,b,_),_}function q7C(H,_,b,$=!1){if((_=q7y(H,_,b,$))==null)return _;if(!(2&($=0|(H=H.u)[q60]))){const ee=q7a(_);ee!==_&&q7z(H,$,b,_=ee)}return _}function q7l(H,_,b,$,ee,re,ae){H=H.u;var xe=!!(2&_);const le=xe?1:ee;re=!!re,ae&&(ae=!xe);var fe=0|(ee=q7u(H,_,$))[q60];if(!(xe=!!(4&fe))){var ve=ee,Se=_;const Ee=!!(2&(fe=q7j(fe,_)));Ee&&(Se|=2);let Ce=!Ee,Ie=!0,De=0,Be=0;for(;De<ve.length;De++){const Ne=q73(ve[De],b,!1,Se);if(Ne instanceof b){if(!Ee){const qe=!!(2&(0|Ne.u[q60]));Ce&&(Ce=!qe),Ie&&(Ie=qe)}ve[Be++]=Ne}}Be<De&&(ve.length=Be),fe|=4,fe=Ie?16|fe:-17&fe,q64(ve,fe=Ce?8|fe:-9&fe),Ee&&Object.freeze(ve)}if(ae&&!(8&fe||!ee.length&&(le===1||le===4&&32&fe))){for(q7L(fe)&&(ee=q69(ee),fe=q7T(fe,_),_=q7z(H,_,$,ee)),b=ee,ae=fe,ve=0;ve<b.length;ve++)(fe=b[ve])!==(Se=q7a(fe))&&(b[ve]=Se);ae|=8,q64(b,ae=b.length?-17&ae:16|ae),fe=ae}return le===1||le===4&&32&fe?q7L(fe)||(_=fe,(fe|=!ee.length||16&fe&&(!xe||32&fe)?2:2048)!==_&&q64(ee,fe),Object.freeze(ee)):(le===2&&q7L(fe)&&(q64(ee=q69(ee),fe=q7K(fe=q7T(fe,_),_,re)),_=q7z(H,_,$,ee)),q7L(fe)||($=fe,(fe=q7K(fe,_,re))!==$&&q64(ee,fe))),ee}function q7H(H,_,b){const $=0|H.u[q60];return q7l(H,$,_,b,q7G(),!1,!(2&$))}function q7A(H,_,b,$){return $==null&&($=void 0),q7e(H,b,$)}function q7h(H,_,b,$){$==null&&($=void 0);e:{let ee=0|(H=H.u)[q60];if(q6f(ee),$==null){const re=q7r(H);if(q7d(re,H,ee,b)!==_)break e;re.set(b,0)}else ee=q7Q(H,ee,b,_);q7z(H,ee,_,$)}}function q7T(H,_){return-2049&(H=32|(2&_?2|H:-3&H))}function q7K(H,_,b){return 32&_&&b||(H&=-33),H}function q7B(H,_,b,$){const ee=0|H.u[q60];q6f(ee),H=q7l(H,ee,b,_,2,!0),$=$??new b,H.push($),H[q60]=2&(0|$.u[q60])?-9&H[q60]:-17&H[q60]}function q7V(H,_){return q6K(q7Z(H,_))}function q7J(H,_){return q72(q7Z(H,_))}function q7Y(H,_){var b;return(b=q7c(H,_))!=null?b:0}function q7P(H,_,b){if(b!=null&&typeof b!="boolean")throw H=typeof b,Error("Expected boolean but got "+(H!="object"?H:b?Array.isArray(b)?"array":H:"null")+": "+b);q7e(H,_,b)}function q7U(H,_,b){if(b!=null){if(typeof b!="number"||!q6C(b))throw q5h("int32");b|=0}q7e(H,_,b)}function q80(H,_,b){if(b!=null&&typeof b!="number")throw Error("Value of float/double field must be a number, found "+typeof b+": "+b);q7e(H,_,b)}function q81(H,_,b){{const ae=H.u;let xe=0|ae[q60];if(q6f(xe),b==null)q7z(ae,xe,_);else{var $=H=0|b[q60],ee=q7L(H),re=ee||Object.isFrozen(b);for(ee||(H=0),re||(b=q69(b),$=0,H=q7K(H=q7T(H,xe),xe,!0),re=!1),H|=21,ee=0;ee<b.length;ee++){const le=b[ee],fe=q70(le);Object.is(le,fe)||(re&&(b=q69(b),$=0,H=q7K(H=q7T(H,xe),xe,!0),re=!1),b[ee]=fe)}H!==$&&(re&&(b=q69(b),H=q7K(H=q7T(H,xe),xe,!0)),q64(b,H)),q7z(ae,xe,_,b)}}}function q82(H,_,b){q6f(0|H.u[q60]),q7N(H,_,q72,2,!0).push(q70(b))}function q83(H,_){return Error("Invalid wire type: "+H+" (at position "+_+")")}function q84(){return Error("Failed to read varint, encoding is invalid.")}function q85(H,_){return Error("Tried to read past the end of the data "+_+" > "+H)}function q86(H){if(typeof H=="string")return{buffer:q5o(H),N:!1};if(Array.isArray(H))return{buffer:new Uint8Array(H),N:!1};if(H.constructor===Uint8Array)return{buffer:H,N:!1};if(H.constructor===ArrayBuffer)return{buffer:new Uint8Array(H),N:!1};if(H.constructor===q5y)return{buffer:q5v(H)||new Uint8Array(0),N:!0};if(H instanceof Uint8Array)return{buffer:new Uint8Array(H.buffer,H.byteOffset,H.byteLength),N:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function q87(H,_){let b,$=0,ee=0,re=0;const ae=H.h;let xe=H.g;do b=ae[xe++],$|=(127&b)<<re,re+=7;while(re<32&&128&b);for(re>32&&(ee|=(127&b)>>4),re=3;re<32&&128&b;re+=7)b=ae[xe++],ee|=(127&b)<<re;if(q8s(H,xe),b<128)return _($>>>0,ee>>>0);throw q84()}function q88(H){let _=0,b=H.g;const $=b+10,ee=H.h;for(;b<$;){const re=ee[b++];if(_|=re,(128&re)==0)return q8s(H,b),!!(127&_)}throw q84()}function q89(H){const _=H.h;let b=H.g,$=_[b++],ee=127&$;if(128&$&&($=_[b++],ee|=(127&$)<<7,128&$&&($=_[b++],ee|=(127&$)<<14,128&$&&($=_[b++],ee|=(127&$)<<21,128&$&&($=_[b++],ee|=$<<28,128&$&&128&_[b++]&&128&_[b++]&&128&_[b++]&&128&_[b++]&&128&_[b++])))))throw q84();return q8s(H,b),ee}function q8q(H){return q89(H)>>>0}function q8n(H){var _=H.h;const b=H.g,$=_[b],ee=_[b+1],re=_[b+2];return _=_[b+3],q8s(H,H.g+4),($<<0|ee<<8|re<<16|_<<24)>>>0}function q8p(H){var _=q8n(H);H=2*(_>>31)+1;const b=_>>>23&255;return _&=8388607,b==255?_?NaN:H*(1/0):b==0?1401298464324817e-60*H*_:H*Math.pow(2,b-150)*(_+8388608)}function q8g(H){return q89(H)}function q8x(H,_,{ba:b=!1}={}){H.ba=b,_&&(_=q86(_),H.h=_.buffer,H.m=_.N,H.j=0,H.l=H.h.length,H.g=H.j)}function q8s(H,_){if(H.g=_,_>H.l)throw q85(H.l,_)}function q8E(H,_){if(_<0)throw Error("Tried to read a negative byte length: "+_);const b=H.g,$=b+_;if($>H.l)throw q85(_,H.l-b);return H.g=$,b}function q8M(H,_){if(_==0)return q5d();var b=q8E(H,_);return H.ba&&H.m?b=H.h.subarray(b,b+_):(H=H.h,b=b===(_=b+_)?new Uint8Array(0):q6c?H.slice(b,_):new Uint8Array(H.subarray(b,_))),b.length==0?q5d():new q5y(b,q5Q)}q7n.prototype.toJSON=void 0,q7n.prototype.Ia=q6p;var q8f=[];function q8S(H){var _=H.g;if(_.g==_.l)return!1;H.l=H.g.g;var b=q8q(H.g);if(_=b>>>3,!((b&=7)>=0&&b<=5))throw q83(b,H.l);if(_<1)throw Error("Invalid field number: "+_+" (at position "+H.l+")");return H.m=_,H.h=b,!0}function q8F(H){switch(H.h){case 0:H.h!=0?q8F(H):q88(H.g);break;case 1:q8s(H=H.g,H.g+8);break;case 2:if(H.h!=2)q8F(H);else{var _=q8q(H.g);q8s(H=H.g,H.g+_)}break;case 5:q8s(H=H.g,H.g+4);break;case 3:for(_=H.m;;){if(!q8S(H))throw Error("Unmatched start-group tag: stream EOF");if(H.h==4){if(H.m!=_)throw Error("Unmatched end-group tag");break}q8F(H)}break;default:throw q83(H.h,H.l)}}function q8t(H,_,b){const $=H.g.l,ee=q8q(H.g),re=H.g.g+ee;let ae=re-$;if(ae<=0&&(H.g.l=re,b(_,H,void 0,void 0,void 0),ae=re-H.g.g),ae)throw Error("Message parsing ended unexpectedly. Expected to read "+ee+" bytes, instead read "+(ee-ae)+" bytes, either the data ended unexpectedly or the message misreported its own length");return H.g.g=re,H.g.l=$,_}function q8k(H){var _=q8q(H.g),b=q8E(H=H.g,_);if(H=H.h,q5s){var $,ee=H;($=q5x)||($=q5x=new TextDecoder("utf-8",{fatal:!0})),_=b+_,ee=b===0&&_===ee.length?ee:ee.subarray(b,_);try{var re=$.decode(ee)}catch(xe){if(q5g===void 0){try{$.decode(new Uint8Array([128]))}catch{}try{$.decode(new Uint8Array([97])),q5g=!0}catch{q5g=!1}}throw!q5g&&(q5x=void 0),xe}}else{_=(re=b)+_,b=[];let xe,le=null;for(;re<_;){var ae=H[re++];ae<128?b.push(ae):ae<224?re>=_?q5n():(xe=H[re++],ae<194||(192&xe)!=128?(re--,q5n()):b.push((31&ae)<<6|63&xe)):ae<240?re>=_-1?q5n():(xe=H[re++],(192&xe)!=128||ae===224&&xe<160||ae===237&&xe>=160||(192&($=H[re++]))!=128?(re--,q5n()):b.push((15&ae)<<12|(63&xe)<<6|63&$)):ae<=244?re>=_-2?q5n():(xe=H[re++],(192&xe)!=128||xe-144+(ae<<28)>>30!=0||(192&($=H[re++]))!=128||(192&(ee=H[re++]))!=128?(re--,q5n()):(ae=(7&ae)<<18|(63&xe)<<12|(63&$)<<6|63&ee,ae-=65536,b.push(55296+(ae>>10&1023),56320+(1023&ae)))):q5n(),b.length>=8192&&(le=q5p(le,b),b.length=0)}re=q5p(le,b)}return re}function q8O(H){const _=q8q(H.g);return q8M(H.g,_)}function q8W(H,_,b){var $=q8q(H.g);for($=H.g.g+$;H.g.g<$;)b.push(_(H.g))}var q8i=[];function q8D(H){return H}let q8m;function q8a(H,_,b){_.g?_.m(H,_.g,_.h,b):_.m(H,_.h,b)}var q8Z=class{constructor(H,_){this.u=q7i(H,_)}toJSON(){const H=!q8m;try{return H&&(q8m=q7O),q8w(this)}finally{H&&(q8m=void 0)}}l(){var H=qnZ;return H.g?H.l(this,H.g,H.h,!0):H.l(this,H.h,H.defaultValue,!0)}clone(){const H=this.u;return new this.constructor(q7m(H,0|H[q60],!1))}N(){return!!(2&(0|this.u[q60]))}};function q8w(H){var _=H.u;{_=(H=q8m(_))!==_;let fe=H.length;if(fe){var b=H[fe-1],$=q6x(b);$?fe--:b=void 0;var ee=H;if($){e:{var re,ae=b,xe=!1;if(ae)for(let ve in ae)isNaN(+ve)?(re??(re={}))[ve]=ae[ve]:($=ae[ve],Array.isArray($)&&(q6E($)||q6g($)&&$.size===0)&&($=null),$==null&&(xe=!0),$!=null&&((re??(re={}))[ve]=$));if(xe||(re=ae),re)for(let ve in re){xe=re;break e}xe=null}ae=xe==null?b!=null:xe!==b}for(;fe>0&&((re=ee[fe-1])==null||q6E(re)||q6g(re)&&re.size===0);fe--)var le=!0;(ee!==H||ae||le)&&(_?(le||ae||xe)&&(ee.length=fe):ee=Array.prototype.slice.call(ee,0,fe),xe&&ee.push(xe)),le=ee}else le=H}return le}function q8e(H){return H?/^\d+$/.test(H)?(q6r(H),new q8z(q6G,q6N)):null:q8c||(q8c=new q8z(0,0))}q8Z.prototype.W=q6n,q8Z.prototype.toString=function(){try{return q8m=q8D,q8w(this).toString()}finally{q8m=void 0}};var q8z=class{constructor(H,_){this.h=H>>>0,this.g=_>>>0}};let q8c;function q8X(H){return H?/^-?\d+$/.test(H)?(q6r(H),new q8G(q6G,q6N)):null:q8N||(q8N=new q8G(0,0))}var q8G=class{constructor(H,_){this.h=H>>>0,this.g=_>>>0}};let q8N;function q8u(H,_,b){for(;b>0||_>127;)H.g.push(127&_|128),_=(_>>>7|b<<25)>>>0,b>>>=7;H.g.push(_)}function q8j(H,_){for(;_>127;)H.g.push(127&_|128),_>>>=7;H.g.push(_)}function q8L(H,_){if(_>=0)q8j(H,_);else{for(let b=0;b<9;b++)H.g.push(127&_|128),_>>=7;H.g.push(1)}}function q8I(H,_){H.g.push(_>>>0&255),H.g.push(_>>>8&255),H.g.push(_>>>16&255),H.g.push(_>>>24&255)}function q8b(H,_){_.length!==0&&(H.l.push(_),H.h+=_.length)}function q8R(H,_,b){q8j(H.g,8*_+b)}function q8o(H,_){return q8R(H,_,2),_=H.g.end(),q8b(H,_),_.push(H.h),_}function q8r(H,_){var b=_.pop();for(b=H.h+H.g.length()-b;b>127;)_.push(127&b|128),b>>>=7,H.h++;_.push(b),H.h++}function q8Q(H,_,b){q8R(H,_,2),q8j(H.g,b.length),q8b(H,H.g.end()),q8b(H,b)}function q8d(H,_,b,$){b!=null&&(_=q8o(H,_),$(b,H),q8r(H,_))}function q8v(){const H=class{constructor(){throw Error()}};return Object.setPrototypeOf(H,H.prototype),H}var q8y=q8v(),q8C=q8v(),q8l=q8v(),q8H=q8v(),q8A=q8v(),q8h=q8v(),q8T=q8v(),q8K=q8v(),q8B=q8v(),q8V=class{constructor(H,_,b){this.g=H,this.h=_,H=q8y,this.l=!!H&&b===H||!1}};function q8J(H,_){return new q8V(H,_,q8y)}function q8Y(H,_,b,$,ee){q8d(H,b,q98(_,$),ee)}const q8P=q8J(function(H,_,b,$,ee){return H.h===2&&(q8t(H,q7v(_,$,b),ee),!0)},q8Y),q8U=q8J(function(H,_,b,$,ee){return H.h===2&&(q8t(H,q7v(_,$,b,!0),ee),!0)},q8Y);var q90=Symbol(),q91=Symbol(),q92=Symbol(),q93=Symbol();let q94,q95;function q96(H,_,b,$){var ee=$[H];if(ee)return ee;(ee={}).Pa=$,ee.V=function(Se){switch(typeof Se){case"boolean":return q7E||(q7E=[0,void 0,!0]);case"number":return Se>0?void 0:Se===0?q7M||(q7M=[0,void 0]):[-Se,void 0];case"string":return[0,Se];case"object":return Se}}($[0]);var re=$[1];let ae=1;re&&re.constructor===Object&&(ee.ga=re,typeof(re=$[++ae])=="function"&&(ee.la=!0,q94!=null||(q94=re),q95!=null||(q95=$[ae+1]),re=$[ae+=2]));const xe={};for(;re&&Array.isArray(re)&&re.length&&typeof re[0]=="number"&&re[0]>0;){for(var le=0;le<re.length;le++)xe[re[le]]=re;re=$[++ae]}for(le=1;re!==void 0;){let Se;typeof re=="number"&&(le+=re,re=$[++ae]);var fe=void 0;if(re instanceof q8V?Se=re:(Se=q8P,ae--),Se==null?void 0:Se.l){re=$[++ae],fe=$;var ve=ae;typeof re=="function"&&(re=re(),fe[ve]=re),fe=re}for(ve=le+1,typeof(re=$[++ae])=="number"&&re<0&&(ve-=re,re=$[++ae]);le<ve;le++){const Ee=xe[le];fe?b(ee,le,Se,fe,Ee):_(ee,le,Se,Ee)}}return $[H]=ee}function q97(H){return Array.isArray(H)?H[0]instanceof q8V?H:[q8U,H]:[H,void 0]}function q98(H,_){return H instanceof q8Z?H.u:Array.isArray(H)?q7W(H,_,!1):void 0}function q99(H,_,b,$){const ee=b.g;H[_]=$?(re,ae,xe)=>ee(re,ae,xe,$):ee}function q9q(H,_,b,$,ee){const re=b.g;let ae,xe;H[_]=(le,fe,ve)=>re(le,fe,ve,xe||(xe=q96(q91,q99,q9q,$).V),ae||(ae=q9n($)),ee)}function q9n(H){let _=H[q92];if(_!=null)return _;const b=q96(q91,q99,q9q,H);return _=b.la?($,ee)=>q94($,ee,b):($,ee)=>{const re=0|$[q60];for(;q8S(ee)&&ee.h!=4;){var ae=ee.m,xe=b[ae];if(xe==null){var le=b.ga;le&&(le=le[ae])&&(le=q9p(le))!=null&&(xe=b[ae]=le)}xe!=null&&xe(ee,$,ae)||(ae=(xe=ee).l,q8F(xe),xe.fa?xe=void 0:(le=xe.g.g-ae,xe.g.g=ae,xe=q8M(xe.g,le)),ae=$,xe&&((le=ae[q5U])?le.push(xe):ae[q5U]=[xe]))}return 16384&re&&q65($),!0},H[q92]=_}function q9p(H){const _=(H=q97(H))[0].g;if(H=H[1]){const b=q9n(H),$=q96(q91,q99,q9q,H).V;return(ee,re,ae)=>_(ee,re,ae,$,b)}return _}function q9g(H,_,b){H[_]=b.h}function q9x(H,_,b,$){let ee,re;const ae=b.h;H[_]=(xe,le,fe)=>ae(xe,le,fe,re||(re=q96(q90,q9g,q9x,$).V),ee||(ee=q9s($)))}function q9s(H){let _=H[q93];if(!_){const b=q96(q90,q9g,q9x,H);_=($,ee)=>q9E($,ee,b),H[q93]=_}return _}function q9E(H,_,b){for(var $=0|H[q60],ee=512&$?0:-1,re=H.length,ae=512&$?1:0,xe=re+(256&$?-1:0);ae<xe;ae++){const le=H[ae];if(le==null)continue;const fe=ae-ee,ve=q9M(b,fe);ve&&ve(_,le,fe)}if(256&$){$=H[re-1];for(const le in $)ee=+le,Number.isNaN(ee)||(re=$[ee])!=null&&(xe=q9M(b,ee))&&xe(_,re,ee)}if(H=q6F(H))for(q8b(_,_.g.end()),b=0;b<H.length;b++)q8b(_,q5v(H[b])||new Uint8Array(0))}function q9M(H,_){var b=H[_];if(b)return b;if((b=H.ga)&&(b=b[_])){var $=(b=q97(b))[0].h;if(b=b[1]){const ee=q9s(b),re=q96(q90,q9g,q9x,b).V;b=H.la?q95(re,ee):(ae,xe,le)=>$(ae,xe,le,re,ee)}else b=$;return H[_]=b}}function q9f(H,_){if(Array.isArray(_)){var b=0|_[q60];if(4&b)return _;for(var $=0,ee=0;$<_.length;$++){const re=H(_[$]);re!=null&&(_[ee++]=re)}return ee<$&&(_.length=ee),q64(_,-12289&(5|b)),2&b&&Object.freeze(_),_}}function q9S(H,_,b){return new q8V(H,_,b)}function q9F(H,_,b){return new q8V(H,_,b)}function q9t(H,_,b){q7z(H,0|H[q60],_,b)}var q9k=q8J(function(H,_,b,$,ee){return H.h===2&&(H=q8t(H,q7W([void 0,void 0],$,!0),ee),q6f($=0|_[q60]),(ee=q7w(_,$,b))instanceof q7n?(2&ee.L)!=0?((ee=ee.X()).push(H),q7z(_,$,b,ee)):ee.Na(H):Array.isArray(ee)?(2&(0|ee[q60])&&q7z(_,$,b,ee=q7I(ee)),ee.push(H)):q7z(_,$,b,[H]),!0)},function(H,_,b,$,ee){if(_ instanceof q7n)_.forEach((re,ae)=>{q8d(H,b,q7W([ae,re],$,!1),ee)});else if(Array.isArray(_))for(let re=0;re<_.length;re++){const ae=_[re];Array.isArray(ae)&&q8d(H,b,q7W(ae,$,!1),ee)}});function q9O(H,_,b){if(_=function($){if($==null)return $;const ee=typeof $;if(ee==="bigint")return String(q6d(64,$));if(q6T($)){if(ee==="string")return q6Y($);if(ee==="number")return q6J($)}}(_),_!=null&&(typeof _=="string"&&q8X(_),_!=null))switch(q8R(H,b,0),typeof _){case"number":H=H.g,q6j(_),q8u(H,q6G,q6N);break;case"bigint":b=BigInt.asUintN(64,_),b=new q8G(Number(b&BigInt(4294967295)),Number(b>>BigInt(32))),q8u(H.g,b.h,b.g);break;default:b=q8X(_),q8u(H.g,b.h,b.g)}}function q9W(H,_,b){(_=q6K(_))!=null&&_!=null&&(q8R(H,b,0),q8L(H.g,_))}function q9i(H,_,b){(_=q6A(_))!=null&&(q8R(H,b,0),H.g.g.push(_?1:0))}function q9D(H,_,b){(_=q72(_))!=null&&q8Q(H,b,q5f(_))}function q9m(H,_,b,$,ee){q8d(H,b,q98(_,$),ee)}function q9a(H,_,b){(_=_==null||typeof _=="string"||q5r(_)||_ instanceof q5y?_:void 0)!=null&&q8Q(H,b,q86(_).buffer)}function q9Z(H,_,b){return(H.h===5||H.h===2)&&(_=q7R(_,0|_[q60],b,!1,!1),H.h==2?q8W(H,q8p,_):_.push(q8p(H.g)),!0)}var q9w=q9S(function(H,_,b){if(H.h!==1)return!1;var $=H.g;H=q8n($);const ee=q8n($);$=2*(ee>>31)+1;const re=ee>>>20&2047;return H=4294967296*(1048575&ee)+H,q9t(_,b,re==2047?H?NaN:$*(1/0):re==0?5e-324*$*H:$*Math.pow(2,re-1075)*(H+4503599627370496)),!0},function(H,_,b){(_=q6H(_))!=null&&(q8R(H,b,1),H=H.g,(b=q6X||(q6X=new DataView(new ArrayBuffer(8)))).setFloat64(0,+_,!0),q6G=b.getUint32(0,!0),q6N=b.getUint32(4,!0),q8I(H,q6G),q8I(H,q6N))},q8v()),q9e=q9S(function(H,_,b){return H.h===5&&(q9t(_,b,q8p(H.g)),!0)},function(H,_,b){(_=q6H(_))!=null&&(q8R(H,b,5),H=H.g,q6L(_),q8I(H,q6G))},q8T),q9z=q9F(q9Z,function(H,_,b){if((_=q9f(q6H,_))!=null)for(let ae=0;ae<_.length;ae++){var $=H,ee=b,re=_[ae];re!=null&&(q8R($,ee,5),$=$.g,q6L(re),q8I($,q6G))}},q8T),q9c=q9F(q9Z,function(H,_,b){if((_=q9f(q6H,_))!=null&&_.length){q8R(H,b,2),q8j(H.g,4*_.length);for(let $=0;$<_.length;$++)b=H.g,q6L(_[$]),q8I(b,q6G)}},q8T),q9X=q9S(function(H,_,b){return H.h===0&&(q9t(_,b,q87(H.g,q6b)),!0)},q9O,q8h),q9G=q9S(function(H,_,b){return H.h===0&&(q9t(_,b,(H=q87(H.g,q6b))===0?void 0:H),!0)},q9O,q8h),q9N=q9S(function(H,_,b){return H.h===0&&(q9t(_,b,q87(H.g,q6I)),!0)},function(H,_,b){if((_=q6U(_))!=null&&(typeof _=="string"&&q8e(_),_!=null))switch(q8R(H,b,0),typeof _){case"number":H=H.g,q6j(_),q8u(H,q6G,q6N);break;case"bigint":b=BigInt.asUintN(64,_),b=new q8z(Number(b&BigInt(4294967295)),Number(b>>BigInt(32))),q8u(H.g,b.h,b.g);break;default:b=q8e(_),q8u(H.g,b.h,b.g)}},q8v()),q9u=q9S(function(H,_,b){return H.h===0&&(q9t(_,b,q89(H.g)),!0)},q9W,q8H),q9j=q9F(function(H,_,b){return(H.h===0||H.h===2)&&(_=q7R(_,0|_[q60],b,!1,!1),H.h==2?q8W(H,q89,_):_.push(q89(H.g)),!0)},function(H,_,b){if((_=q9f(q6K,_))!=null&&_.length){b=q8o(H,b);for(let $=0;$<_.length;$++)q8L(H.g,_[$]);q8r(H,b)}},q8H),q9L=q9S(function(H,_,b){return H.h===0&&(q9t(_,b,(H=q89(H.g))===0?void 0:H),!0)},q9W,q8H),q9I=q9S(function(H,_,b){return H.h===0&&(q9t(_,b,q88(H.g)),!0)},q9i,q8C),q9b=q9S(function(H,_,b){return H.h===0&&(q9t(_,b,(H=q88(H.g))===!1?void 0:H),!0)},q9i,q8C),q9R=q9F(function(H,_,b){return H.h===2&&(H=q8k(H),q7R(_,0|_[q60],b,!1).push(H),!0)},function(H,_,b){if((_=q9f(q72,_))!=null)for(let ae=0;ae<_.length;ae++){var $=H,ee=b,re=_[ae];re!=null&&q8Q($,ee,q5f(re))}},q8l),q9o=q9S(function(H,_,b){return H.h===2&&(q9t(_,b,(H=q8k(H))===""?void 0:H),!0)},q9D,q8l),q9r=q9S(function(H,_,b){return H.h===2&&(q9t(_,b,q8k(H)),!0)},q9D,q8l),q9Q=function(H,_,b=q8y){return new q8V(H,_,b)}(function(H,_,b,$,ee){return H.h===2&&($=q7W(void 0,$,!0),q7R(_,0|_[q60],b,!0).push($),q8t(H,$,ee),!0)},function(H,_,b,$,ee){if(Array.isArray(_))for(let re=0;re<_.length;re++)q9m(H,_[re],b,$,ee)}),q9d=q8J(function(H,_,b,$,ee,re){return H.h===2&&(q7Q(_,0|_[q60],re,b),q8t(H,_=q7v(_,$,b),ee),!0)},q9m),q9v=q9S(function(H,_,b){return H.h===2&&(q9t(_,b,q8O(H)),!0)},q9a,q8K),q9y=q9F(function(H,_,b){return(H.h===0||H.h===2)&&(_=q7R(_,0|_[q60],b,!1,!1),H.h==2?q8W(H,q8q,_):_.push(q8q(H.g)),!0)},function(H,_,b){if((_=q9f(q6B,_))!=null)for(let ae=0;ae<_.length;ae++){var $=H,ee=b,re=_[ae];re!=null&&(q8R($,ee,0),q8j($.g,re))}},q8A),q9C=q9S(function(H,_,b){return H.h===0&&(q9t(_,b,(H=q8q(H.g))===0?void 0:H),!0)},function(H,_,b){(_=q6B(_))!=null&&_!=null&&(q8R(H,b,0),q8j(H.g,_))},q8A),q9l=q9S(function(H,_,b){return H.h===0&&(q9t(_,b,q89(H.g)),!0)},function(H,_,b){(_=q6K(_))!=null&&(_=parseInt(_,10),q8R(H,b,0),q8L(H.g,_))},q8B);class q9H{constructor(_,b){this.h=_,this.g=b,this.l=q7C,this.m=q7A,this.defaultValue=void 0}}function q9A(H,_){return new q9H(H,_)}function q9h(H,_){return(b,$)=>{if(q8i.length){const re=q8i.pop();re.o($),q8x(re.g,b,$),b=re}else b=new class{constructor(re,ae){if(q8f.length){const xe=q8f.pop();q8x(xe,re,ae),re=xe}else re=new class{constructor(xe,le){this.h=null,this.m=!1,this.g=this.l=this.j=0,q8x(this,xe,le)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ba=!1}}(re,ae);this.g=re,this.l=this.g.g,this.h=this.m=-1,this.o(ae)}o({fa:re=!1}={}){this.fa=re}}(b,$);try{const re=new H,ae=re.u;q9n(_)(ae,b);var ee=re}finally{b.g.clear(),b.m=-1,b.h=-1,q8i.length<100&&q8i.push(b)}return ee}}function q9T(H){return function(){const _=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const ae=this.g;return this.g=[],ae}}}};q9E(this.u,_,q96(q90,q9g,q9x,H)),q8b(_,_.g.end());const b=new Uint8Array(_.h),$=_.l,ee=$.length;let re=0;for(let ae=0;ae<ee;ae++){const xe=$[ae];b.set(xe,re),re+=xe.length}return _.l=[b],b}}var q9K=class extends q8Z{constructor(H){super(H)}},q9B=[0,q9o,q9S(function(H,_,b){return H.h===2&&(q9t(_,b,(H=q8O(H))===q5d()?void 0:H),!0)},function(H,_,b){if(_!=null){if(_ instanceof q8Z){const $=_.Ra;return void($&&(_=$(_),_!=null&&q8Q(H,b,q86(_).buffer)))}if(Array.isArray(_))return}q9a(H,_,b)},q8K)],q9U=[0,q9u,q9l,q9I,-1,q9j,q9l,-1],qq0=class extends q8Z{constructor(H){super(H)}},qq1=[0,q9I,q9r,q9I,q9l,-1,q9F(function(H,_,b){return(H.h===0||H.h===2)&&(_=q7R(_,0|_[q60],b,!1,!1),H.h==2?q8W(H,q8g,_):_.push(q89(H.g)),!0)},function(H,_,b){if((_=q9f(q6K,_))!=null&&_.length){b=q8o(H,b);for(let $=0;$<_.length;$++)q8L(H.g,_[$]);q8r(H,b)}},q8B),q9r,-1,[0,q9I,-1],q9l,q9I,-1],qq2=[0,q9r,-2],qq3=class extends q8Z{constructor(H){super(H)}},qq4=[0],qq5=[0,q9u,q9I,1,q9I,-3],qq6=class extends q8Z{constructor(H){super(H,2)}},qq7={};qq7[336783863]=[0,q9r,q9I,-1,q9u,[0,[1,2,3,4,5,6,7,8],q9d,qq4,q9d,qq1,q9d,qq2,q9d,qq5,q9d,q9U,q9d,[0,q9r,-2],q9d,[0,q9r,q9l],q9d,[0,q9l,q9r]],[0,q9r],q9I,[0,[1,3],[2,4],q9d,[0,q9j],-1,q9d,[0,q9R],-1,q9Q,[0,q9r,-1]],q9r];var qq8=[0,q9G,-1,q9b,-3,q9G,q9j,q9o,q9L,q9G,-1,q9b,q9L,q9b,-2,q9o];function qq9(H,_){q7b(H,2,q71(_),"")}function qqq(H,_){q82(H,3,_)}function qqn(H,_){q82(H,4,_)}var qqp=class extends q8Z{constructor(H){super(H,500)}o(H){return q7A(this,0,7,H)}},qqg=[-1,{}],qqx=[0,q9r,1,qqg],qqs=[0,q9r,q9R,qqg];function qqE(H,_){q7B(H,1,qqp,_)}function qqM(H,_){q82(H,10,_)}function qqf(H,_){q82(H,15,_)}var qqS=class extends q8Z{constructor(H){super(H,500)}o(H){return q7A(this,0,1001,H)}},qqF=[-500,q9Q,[-500,q9o,-1,q9R,-3,[-2,qq7,q9I],q9Q,q9B,q9L,-1,qqx,qqs,q9Q,[0,q9o,q9b],q9o,qq8,q9L,q9R,987,q9R],4,q9Q,[-500,q9r,-1,[-1,{}],998,q9r],q9Q,[-500,q9r,q9R,-1,[-2,{},q9I],997,q9R,-1],q9L,q9Q,[-500,q9r,q9R,qqg,998,q9R],q9R,q9L,qqx,qqs,q9Q,[0,q9o,-1,qqg],q9R,-2,qq8,q9o,-1,q9b,[0,q9b,q9C],978,qqg,q9Q,q9B];qqS.prototype.g=q9T(qqF);var qqt=q9h(qqS,qqF),qqk=class extends q8Z{constructor(H){super(H)}},qqO=class extends q8Z{constructor(H){super(H)}g(){return q7H(this,qqk,1)}},qqW=[0,q9Q,[0,q9u,q9e,q9r,-1]],qqi=q9h(qqO,qqW),qqD=class extends q8Z{constructor(H){super(H)}},qqm=class extends q8Z{constructor(H){super(H)}},qqa=class extends q8Z{constructor(H){super(H)}h(){return q7C(this,qqD,2)}g(){return q7H(this,qqm,5)}},qqZ=q9h(class extends q8Z{constructor(H){super(H)}},[0,q9R,q9j,q9c,[0,q9l,[0,q9u,-3],[0,q9e,-3],[0,q9u,-1,[0,q9Q,[0,q9u,-2]]],q9Q,[0,q9e,-1,q9r,q9e]],q9r,-1,q9X,q9Q,[0,q9u,q9e],q9R,q9X]),qqw=class extends q8Z{constructor(H){super(H)}},qqe=q9h(class extends q8Z{constructor(H){super(H)}},[0,q9Q,[0,q9e,-4]]),qqz=class extends q8Z{constructor(H){super(H)}},qqc=q9h(class extends q8Z{constructor(H){super(H)}},[0,q9Q,[0,q9e,-4]]),qqX=class extends q8Z{constructor(H){super(H)}},qqG=[0,q9u,-1,q9c,q9l],qqN=class extends q8Z{constructor(H){super(H)}};qqN.prototype.g=q9T([0,q9e,-4,q9X]);var qqu=class extends q8Z{constructor(H){super(H)}},qqj=q9h(class extends q8Z{constructor(H){super(H)}},[0,q9Q,[0,1,q9u,q9r,qqW],q9X]),qqL=class extends q8Z{constructor(H){super(H)}},qqI=class extends q8Z{constructor(H){super(H)}oa(){const H=q7X(this);return H??q5d()}},qqb=class extends q8Z{constructor(H){super(H)}},qqR=[1,2],qqo=q9h(class extends q8Z{constructor(H){super(H)}},[0,q9Q,[0,qqR,q9d,[0,q9c],q9d,[0,q9v],q9u,q9r],q9X]),qqr=class extends q8Z{constructor(H){super(H)}},qqQ=[0,q9r,q9u,q9e,q9R,-1],qqd=class extends q8Z{constructor(H){super(H)}},qqv=[0,q9I,-1],qqy=class extends q8Z{constructor(H){super(H)}},qqC=[1,2,3,4,5],qql=class extends q8Z{constructor(H){super(H)}g(){return q7X(this)!=null}h(){return q7J(this,2)!=null}},qqH=class extends q8Z{constructor(H){super(H)}g(){var H;return(H=q6A(q7Z(this,2)))!=null?H:!1}},qqA=[0,q9v,q9r,[0,q9u,q9X,-1],[0,q9N,q9X]],qqh=[0,qqA,q9I,[0,qqC,q9d,qq5,q9d,qq1,q9d,q9U,q9d,qq4,q9d,qq2],q9l],qqT=class extends q8Z{constructor(H){super(H)}},qqK=[0,qqh,q9e,-1,q9u],qqB=q9A(502141897,qqT);qq7[502141897]=qqK;var qqV=q9h(class extends q8Z{constructor(H){super(H)}},[0,[0,q9l,-1,q9z,q9y],qqG]),qqJ=class extends q8Z{constructor(H){super(H)}},qqY=class extends q8Z{constructor(H){super(H)}},qqP=[0,qqh,q9e,[0,qqh],q9I],qqU=[0,qqh,qqK,qqP,q9e,[0,[0,qqA]]],qn0=q9A(508968150,qqY);qq7[508968150]=qqU,qq7[508968149]=qqP;var qn1=class extends q8Z{constructor(H){super(H)}},qn2=q9A(513916220,qn1);qq7[513916220]=[0,qqh,qqU,q9u];var qn3=class extends q8Z{constructor(H){super(H)}h(){return q7C(this,qqr,2)}g(){q7e(this,2)}},qn4=[0,qqh,qqQ];qq7[478825465]=qn4;var qn5=class extends q8Z{constructor(H){super(H)}},qn6=class extends q8Z{constructor(H){super(H)}},qn7=class extends q8Z{constructor(H){super(H)}},qn8=class extends q8Z{constructor(H){super(H)}},qn9=class extends q8Z{constructor(H){super(H)}},qnq=[0,qqh,[0,qqh],qn4,-1],qnn=[0,qqh,q9e,q9u],qnp=[0,qqh,q9e],qng=[0,qqh,qnn,qnp,q9e],qnx=q9A(479097054,qn9);qq7[479097054]=[0,qqh,qng,qnq],qq7[463370452]=qnq,qq7[464864288]=qnn;var qns=q9A(462713202,qn8);qq7[462713202]=qng,qq7[474472470]=qnp;var qnE=class extends q8Z{constructor(H){super(H)}},qnM=class extends q8Z{constructor(H){super(H)}},qnf=class extends q8Z{constructor(H){super(H)}},qnS=class extends q8Z{constructor(H){super(H)}},qnF=[0,qqh,q9e,-1,q9u],qnt=[0,qqh,q9e,q9I];qnS.prototype.g=q9T([0,qqh,qnp,[0,qqh],qqK,qqP,qnF,qnt]);var qnk=class extends q8Z{constructor(H){super(H)}},qnO=q9A(456383383,qnk);qq7[456383383]=[0,qqh,qqQ];var qnW=class extends q8Z{constructor(H){super(H)}},qni=q9A(476348187,qnW);qq7[476348187]=[0,qqh,qqv];var qnD=class extends q8Z{constructor(H){super(H)}},qnm=class extends q8Z{constructor(H){super(H)}},qna=[0,q9l,-1],qnZ=q9A(458105876,class extends q8Z{constructor(H){super(H)}g(){var H=this.u;const _=0|H[q60],b=2&_;return H=function($,ee,re){var ae=qnm;const xe=2&ee;let le=!1;if(re==null){if(xe)return q7f();re=[]}else if(re.constructor===q7n){if((2&re.L)==0||xe)return re;re=re.X()}else Array.isArray(re)?le=!!(2&(0|re[q60])):re=[];if(xe){if(!re.length)return q7f();le||(le=!0,q65(re))}else le&&(le=!1,re=q7I(re));return le||(64&(0|re[q60])?re[q60]&=-33:32&ee&&q63(re,32)),q7z($,ee,2,ae=new q7n(re,ae,q74,void 0)),ae}(H,_,q7w(H,_,2)),!b&&qnm&&(H.ra=!0),H}});qq7[458105876]=[0,qna,q9k,[!0,q9X,[0,q9r,-1,q9R]]];var qnw=class extends q8Z{constructor(H){super(H)}},qne=q9A(458105758,qnw);qq7[458105758]=[0,qqh,q9r,qna];var qnz=class extends q8Z{constructor(H){super(H)}},qnc=q9A(443442058,qnz);qq7[443442058]=[0,qqh,q9r,q9u,q9e,q9R,-1,q9I,q9e],qq7[514774813]=qnF;var qnX=class extends q8Z{constructor(H){super(H)}},qnG=q9A(516587230,qnX);function qnN(H,_){return _=_?_.clone():new qqr,H.displayNamesLocale!==void 0?q7e(_,1,q71(H.displayNamesLocale)):H.displayNamesLocale===void 0&&q7e(_,1),H.maxResults!==void 0?q7U(_,2,H.maxResults):"maxResults"in H&&q7e(_,2),H.scoreThreshold!==void 0?q80(_,3,H.scoreThreshold):"scoreThreshold"in H&&q7e(_,3),H.categoryAllowlist!==void 0?q81(_,4,H.categoryAllowlist):"categoryAllowlist"in H&&q7e(_,4),H.categoryDenylist!==void 0?q81(_,5,H.categoryDenylist):"categoryDenylist"in H&&q7e(_,5),_}function qnu(H,_=-1,b=""){return{categories:H.map($=>{var ee,re,ae,xe,le,fe,ve;return{index:(re=(ee=q7V($,1))!=null?ee:0)!=null?re:-1,score:(ae=q7Y($,2))!=null?ae:0,categoryName:(le=(xe=q7J($,3))!=null?xe:"")!=null?le:"",displayName:(ve=(fe=q7J($,4))!=null?fe:"")!=null?ve:""}}),headIndex:_,headName:b}}function qnj(H){var _,b,$,ee,re,ae,xe,le,fe,ve,Se,Ee,Ce,Ie=q7N(H,3,q6H,q7G()),De=q7N(H,2,q6K,q7G()),Be=q7N(H,1,q72,q7G()),Ne=q7N(H,9,q72,q7G());const qe={categories:[],keypoints:[]};for(let Xe=0;Xe<Ie.length;Xe++)qe.categories.push({score:Ie[Xe],index:(_=De[Xe])!=null?_:-1,categoryName:(b=Be[Xe])!=null?b:"",displayName:($=Ne[Xe])!=null?$:""});if((Ie=(ee=q7C(H,qqa,4))==null?void 0:ee.h())&&(qe.boundingBox={originX:(re=q7V(Ie,1))!=null?re:0,originY:(ae=q7V(Ie,2))!=null?ae:0,width:(xe=q7V(Ie,3))!=null?xe:0,height:(le=q7V(Ie,4))!=null?le:0,angle:0}),(fe=q7C(H,qqa,4))==null?void 0:fe.g().length)for(const Xe of q7C(H,qqa,4).g())qe.keypoints.push({x:(ve=q7c(Xe,1))!=null?ve:0,y:(Se=q7c(Xe,2))!=null?Se:0,score:(Ee=q7c(Xe,4))!=null?Ee:0,label:(Ce=q7J(Xe,3))!=null?Ce:""});return qe}function qnL(H){var _,b,$,ee;const re=[];for(const ae of q7H(H,qqz,1))re.push({x:(_=q7Y(ae,1))!=null?_:0,y:(b=q7Y(ae,2))!=null?b:0,z:($=q7Y(ae,3))!=null?$:0,visibility:(ee=q7Y(ae,4))!=null?ee:0});return re}function qnI(H){var _,b,$,ee;const re=[];for(const ae of q7H(H,qqw,1))re.push({x:(_=q7Y(ae,1))!=null?_:0,y:(b=q7Y(ae,2))!=null?b:0,z:($=q7Y(ae,3))!=null?$:0,visibility:(ee=q7Y(ae,4))!=null?ee:0});return re}function qnb(H){return Array.from(H,_=>_>127?_-256:_)}function qnR(H,_){if(H.length!==_.length)throw Error("Cannot compute cosine similarity between embeddings of different sizes ("+H.length+" vs. "+_.length+").");let b=0,$=0,ee=0;for(let re=0;re<H.length;re++)b+=H[re]*_[re],$+=H[re]*H[re],ee+=_[re]*_[re];if($<=0||ee<=0)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return b/Math.sqrt($*ee)}qq7[516587230]=[0,qqh,qnF,qnt,q9e],qq7[518928384]=qnt;function qny(){var H=navigator;return typeof OffscreenCanvas<"u"&&(!function(_=navigator){return(_=_.userAgent).includes("Safari")&&!_.includes("Chrome")}(H)||!!((H=H.userAgent.match(/Version\/([\d]+).*Safari/))&&H.length>=1&&Number(H[1])>=17))}async function qnC(H){if(typeof importScripts!="function"){const _=document.createElement("script");return _.src=H.toString(),_.crossOrigin="anonymous",new Promise((b,$)=>{_.addEventListener("load",()=>{b()},!1),_.addEventListener("error",ee=>{$(ee)},!1),document.body.appendChild(_)})}importScripts(H.toString())}function qnl(H){return H.videoWidth!==void 0?[H.videoWidth,H.videoHeight]:H.naturalWidth!==void 0?[H.naturalWidth,H.naturalHeight]:H.displayWidth!==void 0?[H.displayWidth,H.displayHeight]:[H.width,H.height]}function qnH(H,_,b){H.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),b(_=H.i.stringToNewUTF8(_)),H.i._free(_)}function qnA(H,_,b){if(!H.i.canvas)throw Error("No OpenGL canvas configured.");if(b?H.i._bindTextureToStream(b):H.i._bindTextureToCanvas(),!(b=H.i.canvas.getContext("webgl2")||H.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");H.i.gpuOriginForWebTexturesIsBottomLeft&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,_),H.i.gpuOriginForWebTexturesIsBottomLeft&&b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);const[$,ee]=qnl(_);return!H.l||$===H.i.canvas.width&&ee===H.i.canvas.height||(H.i.canvas.width=$,H.i.canvas.height=ee),[$,ee]}function qnh(H,_,b){H.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const $=new Uint32Array(_.length);for(let ee=0;ee<_.length;ee++)$[ee]=H.i.stringToNewUTF8(_[ee]);_=H.i._malloc(4*$.length),H.i.HEAPU32.set($,_>>2),b(_);for(const ee of $)H.i._free(ee);H.i._free(_)}function qnT(H,_,b){H.i.simpleListeners=H.i.simpleListeners||{},H.i.simpleListeners[_]=b}function qnK(H,_,b){let $=[];H.i.simpleListeners=H.i.simpleListeners||{},H.i.simpleListeners[_]=(ee,re,ae)=>{re?(b($,ae),$=[]):$.push(ee)}}async function qnB(H,_,b,$){return H=await(async(ee,re,ae,xe,le)=>{if(re&&await qnC(re),!self.ModuleFactory||ae&&(await qnC(ae),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&le&&((re=self.Module).locateFile=le.locateFile,le.mainScriptUrlOrBlob&&(re.mainScriptUrlOrBlob=le.mainScriptUrlOrBlob)),le=await self.ModuleFactory(self.Module||le),self.ModuleFactory=self.Module=void 0,new ee(le,xe)})(H,b.wasmLoaderPath,b.assetLoaderPath,_,{locateFile:ee=>ee.endsWith(".wasm")?b.wasmBinaryPath.toString():b.assetBinaryPath&&ee.endsWith(".data")?b.assetBinaryPath.toString():ee}),await H.o($),H}function qnV(H,_){const b=q7C(H.baseOptions,qql,1)||new qql;typeof _=="string"?(q7e(b,2,q71(_)),q7e(b,1)):_ instanceof Uint8Array&&(q7e(b,1,q6s(_,!1)),q7e(b,2)),q7A(H.baseOptions,0,1,b)}function qnJ(H){try{const _=H.G.length;if(_===1)throw Error(H.G[0].message);if(_>1)throw Error("Encountered multiple errors: "+H.G.map(b=>b.message).join(", "))}finally{H.G=[]}}function qnY(H,_){H.B=Math.max(H.B,_)}function qnP(H,_){H.A=new qqp,qq9(H.A,"PassThroughCalculator"),qqq(H.A,"free_memory"),qqn(H.A,"free_memory_unused_out"),qqM(_,"free_memory"),qqE(_,H.A)}function qnU(H,_){qqq(H.A,_),qqn(H.A,_+"_unused_out")}function qp0(H){H.g.addBoolToStream(!0,"free_memory",H.B)}var qp1=class{constructor(H){this.g=H,this.G=[],this.B=0,this.g.setAutoRenderToScreen(!1)}l(H,_=!0){var b,$,ee,re,ae,xe;if(_){const le=H.baseOptions||{};if((b=H.baseOptions)!=null&&b.modelAssetBuffer&&($=H.baseOptions)!=null&&$.modelAssetPath)throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!((ee=q7C(this.baseOptions,qql,1))!=null&&ee.g()||(re=q7C(this.baseOptions,qql,1))!=null&&re.h()||(ae=H.baseOptions)!=null&&ae.modelAssetBuffer||(xe=H.baseOptions)!=null&&xe.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(fe,ve){let Se=q7C(fe.baseOptions,qqy,3);if(!Se){var Ee=Se=new qqy,Ce=new qq3;q7h(Ee,4,qqC,Ce)}"delegate"in ve&&(ve.delegate==="GPU"?(ve=Se,Ee=new qq0,q7h(ve,2,qqC,Ee)):(ve=Se,Ee=new qq3,q7h(ve,4,qqC,Ee))),q7A(fe.baseOptions,0,3,Se)}(this,le),le.modelAssetPath)return fetch(le.modelAssetPath.toString()).then(fe=>{if(fe.ok)return fe.arrayBuffer();throw Error("Failed to fetch model: "+le.modelAssetPath+" ("+fe.status+")")}).then(fe=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(fe),!0,!1,!1),qnV(this,"/model.dat"),this.m(),this.I()});if(le.modelAssetBuffer instanceof Uint8Array)qnV(this,le.modelAssetBuffer);else if(le.modelAssetBuffer)return async function(fe){const ve=[];for(var Se=0;;){const{done:Ee,value:Ce}=await fe.read();if(Ee)break;ve.push(Ce),Se+=Ce.length}if(ve.length===0)return new Uint8Array(0);if(ve.length===1)return ve[0];fe=new Uint8Array(Se),Se=0;for(const Ee of ve)fe.set(Ee,Se),Se+=Ee.length;return fe}(le.modelAssetBuffer).then(fe=>{qnV(this,fe),this.m(),this.I()})}return this.m(),this.I(),Promise.resolve()}I(){}da(){let H;if(this.g.da(_=>{H=qqt(_)}),!H)throw Error("Failed to retrieve CalculatorGraphConfig");return H}setGraph(H,_){this.g.attachErrorListener((b,$)=>{this.G.push(Error($))}),this.g.La(),this.g.setGraph(H,_),this.A=void 0,qnJ(this)}finishProcessing(){this.g.finishProcessing(),qnJ(this)}close(){this.A=void 0,this.g.closeGraph()}};function qp2(H,_){if(!H)throw Error("Unable to obtain required WebGL resource: "+_);return H}qp1.prototype.close=qp1.prototype.close,function(H,_){H=H.split(".");var b,$=q5q;for((H[0]in $)||$.execScript===void 0||$.execScript("var "+H[0]);H.length&&(b=H.shift());)H.length||_===void 0?$=$[b]&&$[b]!==Object.prototype[b]?$[b]:$[b]={}:$[b]=_}("TaskRunner",qp1);class qp3{constructor(_,b,$,ee){this.g=_,this.h=b,this.m=$,this.l=ee}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function qp4(H,_,b){const $=H.g;if(b=qp2($.createShader(b),"Failed to create WebGL shader"),$.shaderSource(b,_),$.compileShader(b),!$.getShaderParameter(b,$.COMPILE_STATUS))throw Error("Could not compile WebGL shader: "+$.getShaderInfoLog(b));return $.attachShader(H.h,b),b}function qp5(H,_){const b=H.g,$=qp2(b.createVertexArray(),"Failed to create vertex array");b.bindVertexArray($);const ee=qp2(b.createBuffer(),"Failed to create buffer");b.bindBuffer(b.ARRAY_BUFFER,ee),b.enableVertexAttribArray(H.O),b.vertexAttribPointer(H.O,2,b.FLOAT,!1,0,0),b.bufferData(b.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),b.STATIC_DRAW);const re=qp2(b.createBuffer(),"Failed to create buffer");return b.bindBuffer(b.ARRAY_BUFFER,re),b.enableVertexAttribArray(H.I),b.vertexAttribPointer(H.I,2,b.FLOAT,!1,0,0),b.bufferData(b.ARRAY_BUFFER,new Float32Array(_?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),b.STATIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,null),b.bindVertexArray(null),new qp3(b,$,ee,re)}function qp6(H,_){if(H.g){if(_!==H.g)throw Error("Cannot change GL context once initialized")}else H.g=_}function qp7(H,_,b,$){return qp6(H,_),H.h||(H.m(),H.C()),b?(H.s||(H.s=qp5(H,!0)),b=H.s):(H.v||(H.v=qp5(H,!1)),b=H.v),_.useProgram(H.h),b.bind(),H.l(),H=$(),b.g.bindVertexArray(null),H}function qp8(H,_,b){return qp6(H,_),H=qp2(_.createTexture(),"Failed to create texture"),_.bindTexture(_.TEXTURE_2D,H),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,b??_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,b??_.LINEAR),_.bindTexture(_.TEXTURE_2D,null),H}function qp9(H,_,b){qp6(H,_),H.A||(H.A=qp2(_.createFramebuffer(),"Failed to create framebuffe.")),_.bindFramebuffer(_.FRAMEBUFFER,H.A),_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,b,0)}function qpq(H){var _;(_=H.g)==null||_.bindFramebuffer(H.g.FRAMEBUFFER,null)}var qpn=class{G(){return`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D inputTexture;
  void main() {
    gl_FragColor = texture2D(inputTexture, vTex);
  }
 `}m(){const H=this.g;if(this.h=qp2(H.createProgram(),"Failed to create WebGL program"),this.aa=qp4(this,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,H.VERTEX_SHADER),this.Z=qp4(this,this.G(),H.FRAGMENT_SHADER),H.linkProgram(this.h),!H.getProgramParameter(this.h,H.LINK_STATUS))throw Error("Error during program linking: "+H.getProgramInfoLog(this.h));this.O=H.getAttribLocation(this.h,"aVertex"),this.I=H.getAttribLocation(this.h,"aTex")}C(){}l(){}close(){if(this.h){const H=this.g;H.deleteProgram(this.h),H.deleteShader(this.aa),H.deleteShader(this.Z)}this.A&&this.g.deleteFramebuffer(this.A),this.v&&this.v.close(),this.s&&this.s.close()}};function qpp(H,_){switch(_){case 0:return H.g.find(b=>b instanceof Uint8Array);case 1:return H.g.find(b=>b instanceof Float32Array);case 2:return H.g.find(b=>typeof WebGLTexture<"u"&&b instanceof WebGLTexture);default:throw Error("Type is not supported: "+_)}}function qpg(H){var _=qpp(H,1);if(!_){if(_=qpp(H,0))_=new Float32Array(_).map($=>$/255);else{_=new Float32Array(H.width*H.height);const $=qps(H);var b=qpM(H);if(qp9(b,$,qpx(H)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"document"in self&&"ontouchend"in self.document){b=new Float32Array(H.width*H.height*4),$.readPixels(0,0,H.width,H.height,$.RGBA,$.FLOAT,b);for(let ee=0,re=0;ee<_.length;++ee,re+=4)_[ee]=b[re]}else $.readPixels(0,0,H.width,H.height,$.RED,$.FLOAT,_)}H.g.push(_)}return _}function qpx(H){let _=qpp(H,2);if(!_){const b=qps(H);_=qpf(H);const $=qpg(H),ee=qpE(H);b.texImage2D(b.TEXTURE_2D,0,ee,H.width,H.height,0,b.RED,b.FLOAT,$),qpS(H)}return _}function qps(H){if(!H.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return H.h||(H.h=qp2(H.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),H.h}function qpE(H){if(H=qps(H),!qpF)if(H.getExtension("EXT_color_buffer_float")&&H.getExtension("OES_texture_float_linear")&&H.getExtension("EXT_float_blend"))qpF=H.R32F;else{if(!H.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");qpF=H.R16F}return qpF}function qpM(H){return H.l||(H.l=new qpn),H.l}function qpf(H){const _=qps(H);_.viewport(0,0,H.width,H.height),_.activeTexture(_.TEXTURE0);let b=qpp(H,2);return b||(b=qp8(qpM(H),_,H.m?_.LINEAR:_.NEAREST),H.g.push(b),H.j=!0),_.bindTexture(_.TEXTURE_2D,b),b}function qpS(H){H.h.bindTexture(H.h.TEXTURE_2D,null)}var qpF,qpt=class{constructor(H,_,b,$,ee,re,ae){this.g=H,this.m=_,this.j=b,this.canvas=$,this.l=ee,this.width=re,this.height=ae,this.j&&--qpk===0&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Fa(){return!!qpp(this,0)}ja(){return!!qpp(this,1)}P(){return!!qpp(this,2)}ia(){return(_=qpp(H=this,0))||(_=qpg(H),_=new Uint8Array(_.map(b=>255*b)),H.g.push(_)),_;var H,_}ha(){return qpg(this)}M(){return qpx(this)}clone(){const H=[];for(const _ of this.g){let b;if(_ instanceof Uint8Array)b=new Uint8Array(_);else if(_ instanceof Float32Array)b=new Float32Array(_);else{if(!(_ instanceof WebGLTexture))throw Error("Type is not supported: "+_);{const $=qps(this),ee=qpM(this);$.activeTexture($.TEXTURE1),b=qp8(ee,$,this.m?$.LINEAR:$.NEAREST),$.bindTexture($.TEXTURE_2D,b);const re=qpE(this);$.texImage2D($.TEXTURE_2D,0,re,this.width,this.height,0,$.RED,$.FLOAT,null),$.bindTexture($.TEXTURE_2D,null),qp9(ee,$,b),qp7(ee,$,!1,()=>{qpf(this),$.clearColor(0,0,0,0),$.clear($.COLOR_BUFFER_BIT),$.drawArrays($.TRIANGLE_FAN,0,4),qpS(this)}),qpq(ee),qpS(this)}}H.push(b)}return new qpt(H,this.m,this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&qps(this).deleteTexture(qpp(this,2)),qpk=-1}};qpt.prototype.close=qpt.prototype.close,qpt.prototype.clone=qpt.prototype.clone,qpt.prototype.getAsWebGLTexture=qpt.prototype.M,qpt.prototype.getAsFloat32Array=qpt.prototype.ha,qpt.prototype.getAsUint8Array=qpt.prototype.ia,qpt.prototype.hasWebGLTexture=qpt.prototype.P,qpt.prototype.hasFloat32Array=qpt.prototype.ja,qpt.prototype.hasUint8Array=qpt.prototype.Fa;var qpk=250;function qpO(H,_){switch(_){case 0:return H.g.find(b=>b instanceof ImageData);case 1:return H.g.find(b=>typeof ImageBitmap<"u"&&b instanceof ImageBitmap);case 2:return H.g.find(b=>typeof WebGLTexture<"u"&&b instanceof WebGLTexture);default:throw Error("Type is not supported: "+_)}}function qpW(H){var _=qpO(H,0);if(!_){_=qpD(H);const b=qpm(H),$=new Uint8Array(H.width*H.height*4);qp9(b,_,qpi(H)),_.readPixels(0,0,H.width,H.height,_.RGBA,_.UNSIGNED_BYTE,$),qpq(b),_=new ImageData(new Uint8ClampedArray($.buffer),H.width,H.height),H.g.push(_)}return _}function qpi(H){let _=qpO(H,2);if(!_){const b=qpD(H);_=qpa(H);const $=qpO(H,1)||qpW(H);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,$),qpZ(H)}return _}function qpD(H){if(!H.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return H.h||(H.h=qp2(H.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),H.h}function qpm(H){return H.l||(H.l=new qpn),H.l}function qpa(H){const _=qpD(H);_.viewport(0,0,H.width,H.height),_.activeTexture(_.TEXTURE0);let b=qpO(H,2);return b||(b=qp8(qpm(H),_),H.g.push(b),H.m=!0),_.bindTexture(_.TEXTURE_2D,b),b}function qpZ(H){H.h.bindTexture(H.h.TEXTURE_2D,null)}function qpw(H){const _=qpD(H);return qp7(qpm(H),_,!0,()=>function(b,$){const ee=b.canvas;if(ee.width===b.width&&ee.height===b.height)return $();const re=ee.width,ae=ee.height;return ee.width=b.width,ee.height=b.height,b=$(),ee.width=re,ee.height=ae,b}(H,()=>{if(_.bindFramebuffer(_.FRAMEBUFFER,null),_.clearColor(0,0,0,0),_.clear(_.COLOR_BUFFER_BIT),_.drawArrays(_.TRIANGLE_FAN,0,4),!(H.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return H.canvas.transferToImageBitmap()}))}var qpe=class{constructor(H,_,b,$,ee,re,ae){this.g=H,this.j=_,this.m=b,this.canvas=$,this.l=ee,this.width=re,this.height=ae,(this.j||this.m)&&--qpz===0&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources.")}Ea(){return!!qpO(this,0)}ka(){return!!qpO(this,1)}P(){return!!qpO(this,2)}Ca(){return qpW(this)}Ba(){var H=qpO(this,1);return H||(qpi(this),qpa(this),H=qpw(this),qpZ(this),this.g.push(H),this.j=!0),H}M(){return qpi(this)}clone(){const H=[];for(const _ of this.g){let b;if(_ instanceof ImageData)b=new ImageData(_.data,this.width,this.height);else if(_ instanceof WebGLTexture){const $=qpD(this),ee=qpm(this);$.activeTexture($.TEXTURE1),b=qp8(ee,$),$.bindTexture($.TEXTURE_2D,b),$.texImage2D($.TEXTURE_2D,0,$.RGBA,this.width,this.height,0,$.RGBA,$.UNSIGNED_BYTE,null),$.bindTexture($.TEXTURE_2D,null),qp9(ee,$,b),qp7(ee,$,!1,()=>{qpa(this),$.clearColor(0,0,0,0),$.clear($.COLOR_BUFFER_BIT),$.drawArrays($.TRIANGLE_FAN,0,4),qpZ(this)}),qpq(ee),qpZ(this)}else{if(!(_ instanceof ImageBitmap))throw Error("Type is not supported: "+_);qpi(this),qpa(this),b=qpw(this),qpZ(this)}H.push(b)}return new qpe(H,this.ka(),this.P(),this.canvas,this.l,this.width,this.height)}close(){this.j&&qpO(this,1).close(),this.m&&qpD(this).deleteTexture(qpO(this,2)),qpz=-1}};qpe.prototype.close=qpe.prototype.close,qpe.prototype.clone=qpe.prototype.clone,qpe.prototype.getAsWebGLTexture=qpe.prototype.M,qpe.prototype.getAsImageBitmap=qpe.prototype.Ba,qpe.prototype.getAsImageData=qpe.prototype.Ca,qpe.prototype.hasWebGLTexture=qpe.prototype.P,qpe.prototype.hasImageBitmap=qpe.prototype.ka,qpe.prototype.hasImageData=qpe.prototype.Ea;var qpz=250;function qpc(...H){return H.map(([_,b])=>({start:_,end:b}))}const qpX=function(H){return class extends H{La(){this.i._registerModelResourcesGraphService()}}}((qpG=class{constructor(H,_){this.l=!0,this.i=H,this.g=null,this.h=0,this.m=typeof this.i._addIntToInputStream=="function",_!==void 0?this.i.canvas=_:qny()?this.i.canvas=new OffscreenCanvas(1,1):(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas"))}async initializeGraph(H){const _=await(await fetch(H)).arrayBuffer();H=!(H.endsWith(".pbtxt")||H.endsWith(".textproto")),this.setGraph(new Uint8Array(_),H)}setGraphFromString(H){this.setGraph(new TextEncoder().encode(H),!1)}setGraph(H,_){const b=H.length,$=this.i._malloc(b);this.i.HEAPU8.set(H,$),_?this.i._changeBinaryGraph(b,$):this.i._changeTextGraph(b,$),this.i._free($)}configureAudio(H,_,b,$,ee){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),qnH(this,$||"input_audio",re=>{qnH(this,ee=ee||"audio_header",ae=>{this.i._configureAudio(re,ae,H,_??0,b)})})}setAutoResizeCanvas(H){this.l=H}setAutoRenderToScreen(H){this.i._setAutoRenderToScreen(H)}setGpuBufferVerticalFlip(H){this.i.gpuOriginForWebTexturesIsBottomLeft=H}da(H){qnT(this,"__graph_config__",_=>{H(_)}),qnH(this,"__graph_config__",_=>{this.i._getGraphConfig(_,void 0)}),delete this.i.simpleListeners.__graph_config__}attachErrorListener(H){this.i.errorListener=H}attachEmptyPacketListener(H,_){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[H]=_}addAudioToStream(H,_,b){this.addAudioToStreamWithShape(H,0,0,_,b)}addAudioToStreamWithShape(H,_,b,$,ee){const re=4*H.length;this.h!==re&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(re),this.h=re),this.i.HEAPF32.set(H,this.g/4),qnH(this,$,ae=>{this.i._addAudioToInputStream(this.g,_,b,ae,ee)})}addGpuBufferToStream(H,_,b){qnH(this,_,$=>{const[ee,re]=qnA(this,H,$);this.i._addBoundTextureToStream($,ee,re,b)})}addBoolToStream(H,_,b){qnH(this,_,$=>{this.i._addBoolToInputStream(H,$,b)})}addDoubleToStream(H,_,b){qnH(this,_,$=>{this.i._addDoubleToInputStream(H,$,b)})}addFloatToStream(H,_,b){qnH(this,_,$=>{this.i._addFloatToInputStream(H,$,b)})}addIntToStream(H,_,b){qnH(this,_,$=>{this.i._addIntToInputStream(H,$,b)})}addUintToStream(H,_,b){qnH(this,_,$=>{this.i._addUintToInputStream(H,$,b)})}addStringToStream(H,_,b){qnH(this,_,$=>{qnH(this,H,ee=>{this.i._addStringToInputStream(ee,$,b)})})}addStringRecordToStream(H,_,b){qnH(this,_,$=>{qnh(this,Object.keys(H),ee=>{qnh(this,Object.values(H),re=>{this.i._addFlatHashMapToInputStream(ee,re,Object.keys(H).length,$,b)})})})}addProtoToStream(H,_,b,$){qnH(this,b,ee=>{qnH(this,_,re=>{const ae=this.i._malloc(H.length);this.i.HEAPU8.set(H,ae),this.i._addProtoToInputStream(ae,H.length,re,ee,$),this.i._free(ae)})})}addEmptyPacketToStream(H,_){qnH(this,H,b=>{this.i._addEmptyPacketToInputStream(b,_)})}addBoolVectorToStream(H,_,b){qnH(this,_,$=>{const ee=this.i._allocateBoolVector(H.length);if(!ee)throw Error("Unable to allocate new bool vector on heap.");for(const re of H)this.i._addBoolVectorEntry(ee,re);this.i._addBoolVectorToInputStream(ee,$,b)})}addDoubleVectorToStream(H,_,b){qnH(this,_,$=>{const ee=this.i._allocateDoubleVector(H.length);if(!ee)throw Error("Unable to allocate new double vector on heap.");for(const re of H)this.i._addDoubleVectorEntry(ee,re);this.i._addDoubleVectorToInputStream(ee,$,b)})}addFloatVectorToStream(H,_,b){qnH(this,_,$=>{const ee=this.i._allocateFloatVector(H.length);if(!ee)throw Error("Unable to allocate new float vector on heap.");for(const re of H)this.i._addFloatVectorEntry(ee,re);this.i._addFloatVectorToInputStream(ee,$,b)})}addIntVectorToStream(H,_,b){qnH(this,_,$=>{const ee=this.i._allocateIntVector(H.length);if(!ee)throw Error("Unable to allocate new int vector on heap.");for(const re of H)this.i._addIntVectorEntry(ee,re);this.i._addIntVectorToInputStream(ee,$,b)})}addUintVectorToStream(H,_,b){qnH(this,_,$=>{const ee=this.i._allocateUintVector(H.length);if(!ee)throw Error("Unable to allocate new unsigned int vector on heap.");for(const re of H)this.i._addUintVectorEntry(ee,re);this.i._addUintVectorToInputStream(ee,$,b)})}addStringVectorToStream(H,_,b){qnH(this,_,$=>{const ee=this.i._allocateStringVector(H.length);if(!ee)throw Error("Unable to allocate new string vector on heap.");for(const re of H)qnH(this,re,ae=>{this.i._addStringVectorEntry(ee,ae)});this.i._addStringVectorToInputStream(ee,$,b)})}addBoolToInputSidePacket(H,_){qnH(this,_,b=>{this.i._addBoolToInputSidePacket(H,b)})}addDoubleToInputSidePacket(H,_){qnH(this,_,b=>{this.i._addDoubleToInputSidePacket(H,b)})}addFloatToInputSidePacket(H,_){qnH(this,_,b=>{this.i._addFloatToInputSidePacket(H,b)})}addIntToInputSidePacket(H,_){qnH(this,_,b=>{this.i._addIntToInputSidePacket(H,b)})}addUintToInputSidePacket(H,_){qnH(this,_,b=>{this.i._addUintToInputSidePacket(H,b)})}addStringToInputSidePacket(H,_){qnH(this,_,b=>{qnH(this,H,$=>{this.i._addStringToInputSidePacket($,b)})})}addProtoToInputSidePacket(H,_,b){qnH(this,b,$=>{qnH(this,_,ee=>{const re=this.i._malloc(H.length);this.i.HEAPU8.set(H,re),this.i._addProtoToInputSidePacket(re,H.length,ee,$),this.i._free(re)})})}addBoolVectorToInputSidePacket(H,_){qnH(this,_,b=>{const $=this.i._allocateBoolVector(H.length);if(!$)throw Error("Unable to allocate new bool vector on heap.");for(const ee of H)this.i._addBoolVectorEntry($,ee);this.i._addBoolVectorToInputSidePacket($,b)})}addDoubleVectorToInputSidePacket(H,_){qnH(this,_,b=>{const $=this.i._allocateDoubleVector(H.length);if(!$)throw Error("Unable to allocate new double vector on heap.");for(const ee of H)this.i._addDoubleVectorEntry($,ee);this.i._addDoubleVectorToInputSidePacket($,b)})}addFloatVectorToInputSidePacket(H,_){qnH(this,_,b=>{const $=this.i._allocateFloatVector(H.length);if(!$)throw Error("Unable to allocate new float vector on heap.");for(const ee of H)this.i._addFloatVectorEntry($,ee);this.i._addFloatVectorToInputSidePacket($,b)})}addIntVectorToInputSidePacket(H,_){qnH(this,_,b=>{const $=this.i._allocateIntVector(H.length);if(!$)throw Error("Unable to allocate new int vector on heap.");for(const ee of H)this.i._addIntVectorEntry($,ee);this.i._addIntVectorToInputSidePacket($,b)})}addUintVectorToInputSidePacket(H,_){qnH(this,_,b=>{const $=this.i._allocateUintVector(H.length);if(!$)throw Error("Unable to allocate new unsigned int vector on heap.");for(const ee of H)this.i._addUintVectorEntry($,ee);this.i._addUintVectorToInputSidePacket($,b)})}addStringVectorToInputSidePacket(H,_){qnH(this,_,b=>{const $=this.i._allocateStringVector(H.length);if(!$)throw Error("Unable to allocate new string vector on heap.");for(const ee of H)qnH(this,ee,re=>{this.i._addStringVectorEntry($,re)});this.i._addStringVectorToInputSidePacket($,b)})}attachBoolListener(H,_){qnT(this,H,_),qnH(this,H,b=>{this.i._attachBoolListener(b)})}attachBoolVectorListener(H,_){qnK(this,H,_),qnH(this,H,b=>{this.i._attachBoolVectorListener(b)})}attachIntListener(H,_){qnT(this,H,_),qnH(this,H,b=>{this.i._attachIntListener(b)})}attachIntVectorListener(H,_){qnK(this,H,_),qnH(this,H,b=>{this.i._attachIntVectorListener(b)})}attachUintListener(H,_){qnT(this,H,_),qnH(this,H,b=>{this.i._attachUintListener(b)})}attachUintVectorListener(H,_){qnK(this,H,_),qnH(this,H,b=>{this.i._attachUintVectorListener(b)})}attachDoubleListener(H,_){qnT(this,H,_),qnH(this,H,b=>{this.i._attachDoubleListener(b)})}attachDoubleVectorListener(H,_){qnK(this,H,_),qnH(this,H,b=>{this.i._attachDoubleVectorListener(b)})}attachFloatListener(H,_){qnT(this,H,_),qnH(this,H,b=>{this.i._attachFloatListener(b)})}attachFloatVectorListener(H,_){qnK(this,H,_),qnH(this,H,b=>{this.i._attachFloatVectorListener(b)})}attachStringListener(H,_){qnT(this,H,_),qnH(this,H,b=>{this.i._attachStringListener(b)})}attachStringVectorListener(H,_){qnK(this,H,_),qnH(this,H,b=>{this.i._attachStringVectorListener(b)})}attachProtoListener(H,_,b){qnT(this,H,_),qnH(this,H,$=>{this.i._attachProtoListener($,b||!1)})}attachProtoVectorListener(H,_,b){qnK(this,H,_),qnH(this,H,$=>{this.i._attachProtoVectorListener($,b||!1)})}attachAudioListener(H,_,b){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),qnT(this,H,($,ee)=>{$=new Float32Array($.buffer,$.byteOffset,$.length/4),_($,ee)}),qnH(this,H,$=>{this.i._attachAudioListener($,b||!1)})}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends qpG{get ea(){return this.i}qa(H,_,b){qnH(this,_,$=>{const[ee,re]=qnA(this,H,$);this.ea._addBoundTextureAsImageToStream($,ee,re,b)})}U(H,_){qnT(this,H,_),qnH(this,H,b=>{this.ea._attachImageListener(b)})}ca(H,_){qnK(this,H,_),qnH(this,H,b=>{this.ea._attachImageVectorListener(b)})}}));var qpG,qpN=class extends qpX{};async function qpu(H,_,b){var $;return async function(ee,re,ae,xe){return qnB(ee,re,ae,xe)}(H,($=b.canvas)!=null?$:qny()?void 0:document.createElement("canvas"),_,b)}function qpj(H,_,b,$){if(H.T){const re=new qqN;if(b!=null&&b.regionOfInterest){if(!H.pa)throw Error("This task doesn't support region-of-interest.");var ee=b.regionOfInterest;if(ee.left>=ee.right||ee.top>=ee.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(ee.left<0||ee.top<0||ee.right>1||ee.bottom>1)throw Error("Expected RectF values to be in [0,1].");q80(re,1,(ee.left+ee.right)/2),q80(re,2,(ee.top+ee.bottom)/2),q80(re,4,ee.right-ee.left),q80(re,3,ee.bottom-ee.top)}else q80(re,1,.5),q80(re,2,.5),q80(re,4,1),q80(re,3,1);if(b!=null&&b.rotationDegrees){if((b==null?void 0:b.rotationDegrees)%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(q80(re,5,-Math.PI*b.rotationDegrees/180),(b==null?void 0:b.rotationDegrees)%180!=0){const[ae,xe]=qnl(_);b=q7Y(re,3)*xe/ae,ee=q7Y(re,4)*ae/xe,q80(re,4,b),q80(re,3,ee)}}H.g.addProtoToStream(re.g(),"mediapipe.NormalizedRect",H.T,$)}H.g.qa(_,H.aa,$??performance.now()),H.finishProcessing()}function qpL(H,_,b){var $;if(($=H.baseOptions)!=null&&$.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");qpj(H,_,b,H.B+1)}function qpI(H,_,b,$){var ee;if(!((ee=H.baseOptions)!=null&&ee.g()))throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");qpj(H,_,b,$)}function qpb(H,_,b,$){var ee=_.data;const re=_.width,ae=re*(_=_.height);if((ee instanceof Uint8Array||ee instanceof Float32Array)&&ee.length!==ae)throw Error("Unsupported channel count: "+ee.length/ae);return H=new qpt([ee],b,!1,H.g.i.canvas,H.O,re,_),$?H.clone():H}var qpR=class extends qp1{constructor(H,_,b,$){super(H),this.g=H,this.aa=_,this.T=b,this.pa=$,this.O=new qpn}l(H,_=!0){if("runningMode"in H&&q7P(this.baseOptions,2,!!H.runningMode&&H.runningMode!=="IMAGE"),H.canvas!==void 0&&this.g.i.canvas!==H.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(H,_)}close(){this.O.close(),super.close()}};qpR.prototype.close=qpR.prototype.close;var qpo=class extends qpR{constructor(H,_){super(new qpN(H,_),"image_in","norm_rect_in",!1),this.j={detections:[]},q7A(H=this.h=new qqT,0,1,_=new qqH),q80(this.h,2,.5),q80(this.h,3,.3)}get baseOptions(){return q7C(this.h,qqH,1)}set baseOptions(H){q7A(this.h,0,1,H)}o(H){var _,b;return"minDetectionConfidence"in H&&q80(this.h,2,(_=H.minDetectionConfidence)!=null?_:.5),"minSuppressionThreshold"in H&&q80(this.h,3,(b=H.minSuppressionThreshold)!=null?b:.3),this.l(H)}D(H,_){return this.j={detections:[]},qpL(this,H,_),this.j}F(H,_,b){return this.j={detections:[]},qpI(this,H,b,_),this.j}m(){var H=new qqS;qqM(H,"image_in"),qqM(H,"norm_rect_in"),qqf(H,"detections");const _=new qq6;q8a(_,qqB,this.h);const b=new qqp;qq9(b,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),qqq(b,"IMAGE:image_in"),qqq(b,"NORM_RECT:norm_rect_in"),qqn(b,"DETECTIONS:detections"),b.o(_),qqE(H,b),this.g.attachProtoVectorListener("detections",($,ee)=>{for(const re of $)$=qqZ(re),this.j.detections.push(qnj($));qnY(this,ee)}),this.g.attachEmptyPacketListener("detections",$=>{qnY(this,$)}),H=H.g(),this.setGraph(new Uint8Array(H),!0)}};qpo.prototype.detectForVideo=qpo.prototype.F,qpo.prototype.detect=qpo.prototype.D,qpo.prototype.setOptions=qpo.prototype.o,qpo.createFromModelPath=async function(H,_){return qpu(qpo,H,{baseOptions:{modelAssetPath:_}})},qpo.createFromModelBuffer=function(H,_){return qpu(qpo,H,{baseOptions:{modelAssetBuffer:_}})},qpo.createFromOptions=function(H,_){return qpu(qpo,H,_)};var qpr=qpc([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),qpQ=qpc([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),qpd=qpc([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),qpv=qpc([474,475],[475,476],[476,477],[477,474]),qpy=qpc([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),qpC=qpc([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),qpl=qpc([469,470],[470,471],[471,472],[472,469]),qpH=qpc([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),qpA=[...qpr,...qpQ,...qpd,...qpy,...qpC,...qpH],qph=qpc([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function qpT(H){H.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var qpK=class extends qpR{constructor(H,_){super(new qpN(H,_),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,q7A(H=this.h=new qqY,0,1,_=new qqH),this.v=new qqJ,q7A(this.h,0,3,this.v),this.s=new qqT,q7A(this.h,0,2,this.s),q7U(this.s,4,1),q80(this.s,2,.5),q80(this.v,2,.5),q80(this.h,4,.5)}get baseOptions(){return q7C(this.h,qqH,1)}set baseOptions(H){q7A(this.h,0,1,H)}o(H){var _,b,$,ee;return"numFaces"in H&&q7U(this.s,4,(_=H.numFaces)!=null?_:1),"minFaceDetectionConfidence"in H&&q80(this.s,2,(b=H.minFaceDetectionConfidence)!=null?b:.5),"minTrackingConfidence"in H&&q80(this.h,4,($=H.minTrackingConfidence)!=null?$:.5),"minFacePresenceConfidence"in H&&q80(this.v,2,(ee=H.minFacePresenceConfidence)!=null?ee:.5),"outputFaceBlendshapes"in H&&(this.outputFaceBlendshapes=!!H.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in H&&(this.outputFacialTransformationMatrixes=!!H.outputFacialTransformationMatrixes),this.l(H)}D(H,_){return qpT(this),qpL(this,H,_),this.j}F(H,_,b){return qpT(this),qpI(this,H,b,_),this.j}m(){var H=new qqS;qqM(H,"image_in"),qqM(H,"norm_rect"),qqf(H,"face_landmarks");const _=new qq6;q8a(_,qn0,this.h);const b=new qqp;qq9(b,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),qqq(b,"IMAGE:image_in"),qqq(b,"NORM_RECT:norm_rect"),qqn(b,"NORM_LANDMARKS:face_landmarks"),b.o(_),qqE(H,b),this.g.attachProtoVectorListener("face_landmarks",($,ee)=>{for(const re of $)$=qqc(re),this.j.faceLandmarks.push(qnL($));qnY(this,ee)}),this.g.attachEmptyPacketListener("face_landmarks",$=>{qnY(this,$)}),this.outputFaceBlendshapes&&(qqf(H,"blendshapes"),qqn(b,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",($,ee)=>{var re;if(this.outputFaceBlendshapes)for(const ae of $)$=qqi(ae),this.j.faceBlendshapes.push(qnu((re=$.g())!=null?re:[]));qnY(this,ee)}),this.g.attachEmptyPacketListener("blendshapes",$=>{qnY(this,$)})),this.outputFacialTransformationMatrixes&&(qqf(H,"face_geometry"),qqn(b,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",($,ee)=>{var re,ae,xe,le,fe;if(this.outputFacialTransformationMatrixes)for(const ve of $)($=q7C(qqV(ve),qqX,2))&&this.j.facialTransformationMatrixes.push({rows:(ae=(re=q7V($,1))!=null?re:0)!=null?ae:0,columns:(le=(xe=q7V($,2))!=null?xe:0)!=null?le:0,data:(fe=q7N($,3,q6H,q7G()).slice())!=null?fe:[]});qnY(this,ee)}),this.g.attachEmptyPacketListener("face_geometry",$=>{qnY(this,$)})),H=H.g(),this.setGraph(new Uint8Array(H),!0)}};qpK.prototype.detectForVideo=qpK.prototype.F,qpK.prototype.detect=qpK.prototype.D,qpK.prototype.setOptions=qpK.prototype.o,qpK.createFromModelPath=function(H,_){return qpu(qpK,H,{baseOptions:{modelAssetPath:_}})},qpK.createFromModelBuffer=function(H,_){return qpu(qpK,H,{baseOptions:{modelAssetBuffer:_}})},qpK.createFromOptions=function(H,_){return qpu(qpK,H,_)},qpK.FACE_LANDMARKS_LIPS=qpr,qpK.FACE_LANDMARKS_LEFT_EYE=qpQ,qpK.FACE_LANDMARKS_LEFT_EYEBROW=qpd,qpK.FACE_LANDMARKS_LEFT_IRIS=qpv,qpK.FACE_LANDMARKS_RIGHT_EYE=qpy,qpK.FACE_LANDMARKS_RIGHT_EYEBROW=qpC,qpK.FACE_LANDMARKS_RIGHT_IRIS=qpl,qpK.FACE_LANDMARKS_FACE_OVAL=qpH,qpK.FACE_LANDMARKS_CONTOURS=qpA,qpK.FACE_LANDMARKS_TESSELATION=qph;var qpB=class extends qpR{constructor(H,_){super(new qpN(H,_),"image_in","norm_rect",!0),q7A(H=this.j=new qn1,0,1,_=new qqH)}get baseOptions(){return q7C(this.j,qqH,1)}set baseOptions(H){q7A(this.j,0,1,H)}o(H){return super.l(H)}Oa(H,_,b){const $=typeof _!="function"?_:{};if(this.h=typeof _=="function"?_:b,qpL(this,H,$??{}),!this.h)return this.s}m(){var H=new qqS;qqM(H,"image_in"),qqM(H,"norm_rect"),qqf(H,"stylized_image");const _=new qq6;q8a(_,qn2,this.j);const b=new qqp;qq9(b,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),qqq(b,"IMAGE:image_in"),qqq(b,"NORM_RECT:norm_rect"),qqn(b,"STYLIZED_IMAGE:stylized_image"),b.o(_),qqE(H,b),this.g.U("stylized_image",($,ee)=>{var re=!this.h,ae=$.data,xe=$.width;const le=xe*($=$.height);if(ae instanceof Uint8Array)if(ae.length===3*le){const fe=new Uint8ClampedArray(4*le);for(let ve=0;ve<le;++ve)fe[4*ve]=ae[3*ve],fe[4*ve+1]=ae[3*ve+1],fe[4*ve+2]=ae[3*ve+2],fe[4*ve+3]=255;ae=new ImageData(fe,xe,$)}else{if(ae.length!==4*le)throw Error("Unsupported channel count: "+ae.length/le);ae=new ImageData(new Uint8ClampedArray(ae.buffer,ae.byteOffset,ae.length),xe,$)}else if(!(ae instanceof WebGLTexture))throw Error("Unsupported format: "+ae.constructor.name);xe=new qpe([ae],!1,!1,this.g.i.canvas,this.O,xe,$),this.s=re=re?xe.clone():xe,this.h&&this.h(re),qnY(this,ee)}),this.g.attachEmptyPacketListener("stylized_image",$=>{this.s=null,this.h&&this.h(null),qnY(this,$)}),H=H.g(),this.setGraph(new Uint8Array(H),!0)}};qpB.prototype.stylize=qpB.prototype.Oa,qpB.prototype.setOptions=qpB.prototype.o,qpB.createFromModelPath=function(H,_){return qpu(qpB,H,{baseOptions:{modelAssetPath:_}})},qpB.createFromModelBuffer=function(H,_){return qpu(qpB,H,{baseOptions:{modelAssetBuffer:_}})},qpB.createFromOptions=function(H,_){return qpu(qpB,H,_)};var qpV=qpc([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function qpJ(H){H.gestures=[],H.landmarks=[],H.worldLandmarks=[],H.handedness=[]}function qpY(H){return H.gestures.length===0?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:H.gestures,landmarks:H.landmarks,worldLandmarks:H.worldLandmarks,handedness:H.handedness,handednesses:H.handedness}}function qpP(H,_=!0){var b,$,ee,re,ae,xe;const le=[];for(const ve of H){var fe=qqi(ve);H=[];for(const Se of fe.g())fe=_&&q7V(Se,1)!=null?(b=q7V(Se,1))!=null?b:0:-1,H.push({score:($=q7Y(Se,2))!=null?$:0,index:fe,categoryName:(re=(ee=q7J(Se,3))!=null?ee:"")!=null?re:"",displayName:(xe=(ae=q7J(Se,4))!=null?ae:"")!=null?xe:""});le.push(H)}return le}var qpU=class extends qpR{constructor(H,_){super(new qpN(H,_),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],q7A(H=this.j=new qn9,0,1,_=new qqH),this.s=new qn8,q7A(this.j,0,2,this.s),this.C=new qn7,q7A(this.s,0,3,this.C),this.v=new qn6,q7A(this.s,0,2,this.v),this.h=new qn5,q7A(this.j,0,3,this.h),q80(this.v,2,.5),q80(this.s,4,.5),q80(this.C,2,.5)}get baseOptions(){return q7C(this.j,qqH,1)}set baseOptions(H){q7A(this.j,0,1,H)}o(H){var _,b,$,ee,re,ae,xe,le;if(q7U(this.v,3,(_=H.numHands)!=null?_:1),"minHandDetectionConfidence"in H&&q80(this.v,2,(b=H.minHandDetectionConfidence)!=null?b:.5),"minTrackingConfidence"in H&&q80(this.s,4,($=H.minTrackingConfidence)!=null?$:.5),"minHandPresenceConfidence"in H&&q80(this.C,2,(ee=H.minHandPresenceConfidence)!=null?ee:.5),H.cannedGesturesClassifierOptions){var fe=new qn3,ve=fe,Se=qnN(H.cannedGesturesClassifierOptions,(re=q7C(this.h,qn3,3))==null?void 0:re.h());q7A(ve,0,2,Se),q7A(this.h,0,3,fe)}else H.cannedGesturesClassifierOptions===void 0&&((ae=q7C(this.h,qn3,3))==null||ae.g());return H.customGesturesClassifierOptions?(q7A(ve=fe=new qn3,0,2,Se=qnN(H.customGesturesClassifierOptions,(xe=q7C(this.h,qn3,4))==null?void 0:xe.h())),q7A(this.h,0,4,fe)):H.customGesturesClassifierOptions===void 0&&((le=q7C(this.h,qn3,4))==null||le.g()),this.l(H)}Ja(H,_){return qpJ(this),qpL(this,H,_),qpY(this)}Ka(H,_,b){return qpJ(this),qpI(this,H,b,_),qpY(this)}m(){var H=new qqS;qqM(H,"image_in"),qqM(H,"norm_rect"),qqf(H,"hand_gestures"),qqf(H,"hand_landmarks"),qqf(H,"world_hand_landmarks"),qqf(H,"handedness");const _=new qq6;q8a(_,qnx,this.j);const b=new qqp;qq9(b,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),qqq(b,"IMAGE:image_in"),qqq(b,"NORM_RECT:norm_rect"),qqn(b,"HAND_GESTURES:hand_gestures"),qqn(b,"LANDMARKS:hand_landmarks"),qqn(b,"WORLD_LANDMARKS:world_hand_landmarks"),qqn(b,"HANDEDNESS:handedness"),b.o(_),qqE(H,b),this.g.attachProtoVectorListener("hand_landmarks",($,ee)=>{var re,ae,xe,le;for(const fe of $){$=qqc(fe);const ve=[];for(const Se of q7H($,qqz,1))ve.push({x:(re=q7Y(Se,1))!=null?re:0,y:(ae=q7Y(Se,2))!=null?ae:0,z:(xe=q7Y(Se,3))!=null?xe:0,visibility:(le=q7Y(Se,4))!=null?le:0});this.landmarks.push(ve)}qnY(this,ee)}),this.g.attachEmptyPacketListener("hand_landmarks",$=>{qnY(this,$)}),this.g.attachProtoVectorListener("world_hand_landmarks",($,ee)=>{var re,ae,xe,le;for(const fe of $){$=qqe(fe);const ve=[];for(const Se of q7H($,qqw,1))ve.push({x:(re=q7Y(Se,1))!=null?re:0,y:(ae=q7Y(Se,2))!=null?ae:0,z:(xe=q7Y(Se,3))!=null?xe:0,visibility:(le=q7Y(Se,4))!=null?le:0});this.worldLandmarks.push(ve)}qnY(this,ee)}),this.g.attachEmptyPacketListener("world_hand_landmarks",$=>{qnY(this,$)}),this.g.attachProtoVectorListener("hand_gestures",($,ee)=>{this.gestures.push(...qpP($,!1)),qnY(this,ee)}),this.g.attachEmptyPacketListener("hand_gestures",$=>{qnY(this,$)}),this.g.attachProtoVectorListener("handedness",($,ee)=>{this.handedness.push(...qpP($)),qnY(this,ee)}),this.g.attachEmptyPacketListener("handedness",$=>{qnY(this,$)}),H=H.g(),this.setGraph(new Uint8Array(H),!0)}};function qg0(H){return{landmarks:H.landmarks,worldLandmarks:H.worldLandmarks,handednesses:H.handedness,handedness:H.handedness}}qpU.prototype.recognizeForVideo=qpU.prototype.Ka,qpU.prototype.recognize=qpU.prototype.Ja,qpU.prototype.setOptions=qpU.prototype.o,qpU.createFromModelPath=function(H,_){return qpu(qpU,H,{baseOptions:{modelAssetPath:_}})},qpU.createFromModelBuffer=function(H,_){return qpu(qpU,H,{baseOptions:{modelAssetBuffer:_}})},qpU.createFromOptions=function(H,_){return qpu(qpU,H,_)},qpU.HAND_CONNECTIONS=qpV;var qg1=class extends qpR{constructor(H,_){super(new qpN(H,_),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],q7A(H=this.h=new qn8,0,1,_=new qqH),this.s=new qn7,q7A(this.h,0,3,this.s),this.j=new qn6,q7A(this.h,0,2,this.j),q7U(this.j,3,1),q80(this.j,2,.5),q80(this.s,2,.5),q80(this.h,4,.5)}get baseOptions(){return q7C(this.h,qqH,1)}set baseOptions(H){q7A(this.h,0,1,H)}o(H){var _,b,$,ee;return"numHands"in H&&q7U(this.j,3,(_=H.numHands)!=null?_:1),"minHandDetectionConfidence"in H&&q80(this.j,2,(b=H.minHandDetectionConfidence)!=null?b:.5),"minTrackingConfidence"in H&&q80(this.h,4,($=H.minTrackingConfidence)!=null?$:.5),"minHandPresenceConfidence"in H&&q80(this.s,2,(ee=H.minHandPresenceConfidence)!=null?ee:.5),this.l(H)}D(H,_){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],qpL(this,H,_),qg0(this)}F(H,_,b){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],qpI(this,H,b,_),qg0(this)}m(){var H=new qqS;qqM(H,"image_in"),qqM(H,"norm_rect"),qqf(H,"hand_landmarks"),qqf(H,"world_hand_landmarks"),qqf(H,"handedness");const _=new qq6;q8a(_,qns,this.h);const b=new qqp;qq9(b,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),qqq(b,"IMAGE:image_in"),qqq(b,"NORM_RECT:norm_rect"),qqn(b,"LANDMARKS:hand_landmarks"),qqn(b,"WORLD_LANDMARKS:world_hand_landmarks"),qqn(b,"HANDEDNESS:handedness"),b.o(_),qqE(H,b),this.g.attachProtoVectorListener("hand_landmarks",($,ee)=>{for(const re of $)$=qqc(re),this.landmarks.push(qnL($));qnY(this,ee)}),this.g.attachEmptyPacketListener("hand_landmarks",$=>{qnY(this,$)}),this.g.attachProtoVectorListener("world_hand_landmarks",($,ee)=>{for(const re of $)$=qqe(re),this.worldLandmarks.push(qnI($));qnY(this,ee)}),this.g.attachEmptyPacketListener("world_hand_landmarks",$=>{qnY(this,$)}),this.g.attachProtoVectorListener("handedness",($,ee)=>{var re,ae,xe,le,fe,ve,Se,Ee=this.handedness,Ce=Ee.push;const Ie=[];for(const De of $){$=qqi(De);const Be=[];for(const Ne of $.g())Be.push({score:(re=q7Y(Ne,2))!=null?re:0,index:(xe=(ae=q7V(Ne,1))!=null?ae:0)!=null?xe:-1,categoryName:(fe=(le=q7J(Ne,3))!=null?le:"")!=null?fe:"",displayName:(Se=(ve=q7J(Ne,4))!=null?ve:"")!=null?Se:""});Ie.push(Be)}Ce.call(Ee,...Ie),qnY(this,ee)}),this.g.attachEmptyPacketListener("handedness",$=>{qnY(this,$)}),H=H.g(),this.setGraph(new Uint8Array(H),!0)}};qg1.prototype.detectForVideo=qg1.prototype.F,qg1.prototype.detect=qg1.prototype.D,qg1.prototype.setOptions=qg1.prototype.o,qg1.createFromModelPath=function(H,_){return qpu(qg1,H,{baseOptions:{modelAssetPath:_}})},qg1.createFromModelBuffer=function(H,_){return qpu(qg1,H,{baseOptions:{modelAssetBuffer:_}})},qg1.createFromOptions=function(H,_){return qpu(qg1,H,_)},qg1.HAND_CONNECTIONS=qpV;var qg2=qpc([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function qg3(H){H.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function qg4(H){try{if(!H.C)return H.h;H.C(H.h)}finally{qp0(H)}}function qg5(H,_){H=qqc(H),_.push(qnL(H))}var qg6=class extends qpR{constructor(H,_){super(new qpN(H,_),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,q7A(H=this.j=new qnS,0,1,_=new qqH),this.J=new qn7,q7A(this.j,0,2,this.J),this.Z=new qnE,q7A(this.j,0,3,this.Z),this.s=new qqT,q7A(this.j,0,4,this.s),this.H=new qqJ,q7A(this.j,0,5,this.H),this.v=new qnM,q7A(this.j,0,6,this.v),this.K=new qnf,q7A(this.j,0,7,this.K),q80(this.s,2,.5),q80(this.s,3,.3),q80(this.H,2,.5),q80(this.v,2,.5),q80(this.v,3,.3),q80(this.K,2,.5),q80(this.J,2,.5)}get baseOptions(){return q7C(this.j,qqH,1)}set baseOptions(H){q7A(this.j,0,1,H)}o(H){var _,b,$,ee,re,ae,xe;return"minFaceDetectionConfidence"in H&&q80(this.s,2,(_=H.minFaceDetectionConfidence)!=null?_:.5),"minFaceSuppressionThreshold"in H&&q80(this.s,3,(b=H.minFaceSuppressionThreshold)!=null?b:.3),"minFacePresenceConfidence"in H&&q80(this.H,2,($=H.minFacePresenceConfidence)!=null?$:.5),"outputFaceBlendshapes"in H&&(this.outputFaceBlendshapes=!!H.outputFaceBlendshapes),"minPoseDetectionConfidence"in H&&q80(this.v,2,(ee=H.minPoseDetectionConfidence)!=null?ee:.5),"minPoseSuppressionThreshold"in H&&q80(this.v,3,(re=H.minPoseSuppressionThreshold)!=null?re:.3),"minPosePresenceConfidence"in H&&q80(this.K,2,(ae=H.minPosePresenceConfidence)!=null?ae:.5),"outputPoseSegmentationMasks"in H&&(this.outputPoseSegmentationMasks=!!H.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in H&&q80(this.J,2,(xe=H.minHandLandmarksConfidence)!=null?xe:.5),this.l(H)}D(H,_,b){const $=typeof _!="function"?_:{};return this.C=typeof _=="function"?_:b,qg3(this),qpL(this,H,$),qg4(this)}F(H,_,b,$){const ee=typeof b!="function"?b:{};return this.C=typeof b=="function"?b:$,qg3(this),qpI(this,H,ee,_),qg4(this)}m(){var H=new qqS;qqM(H,"input_frames_image"),qqf(H,"pose_landmarks"),qqf(H,"pose_world_landmarks"),qqf(H,"face_landmarks"),qqf(H,"left_hand_landmarks"),qqf(H,"left_hand_world_landmarks"),qqf(H,"right_hand_landmarks"),qqf(H,"right_hand_world_landmarks");const _=new qq6,b=new q9K;q7b(b,1,q71("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(ee,re){if(re!=null)if(Array.isArray(re))q7e(ee,2,q7O(re));else{if(!(typeof re=="string"||re instanceof q5y||q5r(re)))throw Error("invalid value in Any.value field: "+re+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");q7b(ee,2,q6s(re,!1),q5d())}}(b,this.j.g());const $=new qqp;qq9($,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),q7B($,8,q9K,b),qqq($,"IMAGE:input_frames_image"),qqn($,"POSE_LANDMARKS:pose_landmarks"),qqn($,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),qqn($,"FACE_LANDMARKS:face_landmarks"),qqn($,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),qqn($,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),qqn($,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),qqn($,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),$.o(_),qqE(H,$),qnP(this,H),this.g.attachProtoListener("pose_landmarks",(ee,re)=>{qg5(ee,this.h.poseLandmarks),qnY(this,re)}),this.g.attachEmptyPacketListener("pose_landmarks",ee=>{qnY(this,ee)}),this.g.attachProtoListener("pose_world_landmarks",(ee,re)=>{var ae=this.h.poseWorldLandmarks;ee=qqe(ee),ae.push(qnI(ee)),qnY(this,re)}),this.g.attachEmptyPacketListener("pose_world_landmarks",ee=>{qnY(this,ee)}),this.outputPoseSegmentationMasks&&(qqn($,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),qnU(this,"pose_segmentation_mask"),this.g.U("pose_segmentation_mask",(ee,re)=>{this.h.poseSegmentationMasks=[qpb(this,ee,!0,!this.C)],qnY(this,re)}),this.g.attachEmptyPacketListener("pose_segmentation_mask",ee=>{this.h.poseSegmentationMasks=[],qnY(this,ee)})),this.g.attachProtoListener("face_landmarks",(ee,re)=>{qg5(ee,this.h.faceLandmarks),qnY(this,re)}),this.g.attachEmptyPacketListener("face_landmarks",ee=>{qnY(this,ee)}),this.outputFaceBlendshapes&&(qqf(H,"extra_blendshapes"),qqn($,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",(ee,re)=>{var ae,xe=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(ee=qqi(ee),xe.push(qnu((ae=ee.g())!=null?ae:[]))),qnY(this,re)}),this.g.attachEmptyPacketListener("extra_blendshapes",ee=>{qnY(this,ee)})),this.g.attachProtoListener("left_hand_landmarks",(ee,re)=>{qg5(ee,this.h.leftHandLandmarks),qnY(this,re)}),this.g.attachEmptyPacketListener("left_hand_landmarks",ee=>{qnY(this,ee)}),this.g.attachProtoListener("left_hand_world_landmarks",(ee,re)=>{var ae=this.h.leftHandWorldLandmarks;ee=qqe(ee),ae.push(qnI(ee)),qnY(this,re)}),this.g.attachEmptyPacketListener("left_hand_world_landmarks",ee=>{qnY(this,ee)}),this.g.attachProtoListener("right_hand_landmarks",(ee,re)=>{qg5(ee,this.h.rightHandLandmarks),qnY(this,re)}),this.g.attachEmptyPacketListener("right_hand_landmarks",ee=>{qnY(this,ee)}),this.g.attachProtoListener("right_hand_world_landmarks",(ee,re)=>{var ae=this.h.rightHandWorldLandmarks;ee=qqe(ee),ae.push(qnI(ee)),qnY(this,re)}),this.g.attachEmptyPacketListener("right_hand_world_landmarks",ee=>{qnY(this,ee)}),H=H.g(),this.setGraph(new Uint8Array(H),!0)}};qg6.prototype.detectForVideo=qg6.prototype.F,qg6.prototype.detect=qg6.prototype.D,qg6.prototype.setOptions=qg6.prototype.o,qg6.createFromModelPath=function(H,_){return qpu(qg6,H,{baseOptions:{modelAssetPath:_}})},qg6.createFromModelBuffer=function(H,_){return qpu(qg6,H,{baseOptions:{modelAssetBuffer:_}})},qg6.createFromOptions=function(H,_){return qpu(qg6,H,_)},qg6.HAND_CONNECTIONS=qpV,qg6.POSE_CONNECTIONS=qg2,qg6.FACE_LANDMARKS_LIPS=qpr,qg6.FACE_LANDMARKS_LEFT_EYE=qpQ,qg6.FACE_LANDMARKS_LEFT_EYEBROW=qpd,qg6.FACE_LANDMARKS_LEFT_IRIS=qpv,qg6.FACE_LANDMARKS_RIGHT_EYE=qpy,qg6.FACE_LANDMARKS_RIGHT_EYEBROW=qpC,qg6.FACE_LANDMARKS_RIGHT_IRIS=qpl,qg6.FACE_LANDMARKS_FACE_OVAL=qpH,qg6.FACE_LANDMARKS_CONTOURS=qpA,qg6.FACE_LANDMARKS_TESSELATION=qph;var qg7=class extends qpR{constructor(H,_){super(new qpN(H,_),"input_image","norm_rect",!0),this.j={classifications:[]},q7A(H=this.h=new qnk,0,1,_=new qqH)}get baseOptions(){return q7C(this.h,qqH,1)}set baseOptions(H){q7A(this.h,0,1,H)}o(H){return q7A(this.h,0,2,qnN(H,q7C(this.h,qqr,2))),this.l(H)}sa(H,_){return this.j={classifications:[]},qpL(this,H,_),this.j}ta(H,_,b){return this.j={classifications:[]},qpI(this,H,b,_),this.j}m(){var H=new qqS;qqM(H,"input_image"),qqM(H,"norm_rect"),qqf(H,"classifications");const _=new qq6;q8a(_,qnO,this.h);const b=new qqp;qq9(b,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),qqq(b,"IMAGE:input_image"),qqq(b,"NORM_RECT:norm_rect"),qqn(b,"CLASSIFICATIONS:classifications"),b.o(_),qqE(H,b),this.g.attachProtoListener("classifications",($,ee)=>{this.j=function(re){var ae;const xe={classifications:q7H(re,qqu,1).map(le=>{var fe,ve,Se,Ee;return qnu((ve=(fe=q7C(le,qqO,4))==null?void 0:fe.g())!=null?ve:[],(Se=q7V(le,2))!=null?Se:0,(Ee=q7J(le,3))!=null?Ee:"")})};return q6P(q7Z(re,2))!=null&&(xe.timestampMs=(ae=q6P(q7Z(re,2)))!=null?ae:0),xe}(qqj($)),qnY(this,ee)}),this.g.attachEmptyPacketListener("classifications",$=>{qnY(this,$)}),H=H.g(),this.setGraph(new Uint8Array(H),!0)}};qg7.prototype.classifyForVideo=qg7.prototype.ta,qg7.prototype.classify=qg7.prototype.sa,qg7.prototype.setOptions=qg7.prototype.o,qg7.createFromModelPath=function(H,_){return qpu(qg7,H,{baseOptions:{modelAssetPath:_}})},qg7.createFromModelBuffer=function(H,_){return qpu(qg7,H,{baseOptions:{modelAssetBuffer:_}})},qg7.createFromOptions=function(H,_){return qpu(qg7,H,_)};var qg8=class extends qpR{constructor(H,_){super(new qpN(H,_),"image_in","norm_rect",!0),this.h=new qnW,this.embeddings={embeddings:[]},q7A(H=this.h,0,1,_=new qqH)}get baseOptions(){return q7C(this.h,qqH,1)}set baseOptions(H){q7A(this.h,0,1,H)}o(H){var _=this.h,b=q7C(this.h,qqd,2);return b=b?b.clone():new qqd,H.l2Normalize!==void 0?q7P(b,1,H.l2Normalize):"l2Normalize"in H&&q7e(b,1),H.quantize!==void 0?q7P(b,2,H.quantize):"quantize"in H&&q7e(b,2),q7A(_,0,2,b),this.l(H)}za(H,_){return qpL(this,H,_),this.embeddings}Aa(H,_,b){return qpI(this,H,b,_),this.embeddings}m(){var H=new qqS;qqM(H,"image_in"),qqM(H,"norm_rect"),qqf(H,"embeddings_out");const _=new qq6;q8a(_,qni,this.h);const b=new qqp;qq9(b,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),qqq(b,"IMAGE:image_in"),qqq(b,"NORM_RECT:norm_rect"),qqn(b,"EMBEDDINGS:embeddings_out"),b.o(_),qqE(H,b),this.g.attachProtoListener("embeddings_out",($,ee)=>{$=qqo($),this.embeddings=function(re){var ae;return{embeddings:q7H(re,qqb,1).map(xe=>{var le,fe,ve,Se,Ee,Ce,Ie;const De={headIndex:(fe=(le=q7V(xe,3))!=null?le:0)!=null?fe:-1,headName:(Se=(ve=q7J(xe,4))!=null?ve:"")!=null?Se:""};if(q7y(xe,qqL,q7o(xe,1))!==void 0)xe=q7N(xe=q7C(xe,qqL,q7o(xe,1)),1,q6H,q7G()),De.floatEmbedding=xe.slice();else{const Be=new Uint8Array(0);De.quantizedEmbedding=(Ie=(Ce=(Ee=q7C(xe,qqI,q7o(xe,2)))==null?void 0:Ee.oa())==null?void 0:Ce.h())!=null?Ie:Be}return De}),timestampMs:(ae=q6P(q7Z(re,2)))!=null?ae:0}}($),qnY(this,ee)}),this.g.attachEmptyPacketListener("embeddings_out",$=>{qnY(this,$)}),H=H.g(),this.setGraph(new Uint8Array(H),!0)}};qg8.cosineSimilarity=function(H,_){if(H.floatEmbedding&&_.floatEmbedding)H=qnR(H.floatEmbedding,_.floatEmbedding);else{if(!H.quantizedEmbedding||!_.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");H=qnR(qnb(H.quantizedEmbedding),qnb(_.quantizedEmbedding))}return H},qg8.prototype.embedForVideo=qg8.prototype.Aa,qg8.prototype.embed=qg8.prototype.za,qg8.prototype.setOptions=qg8.prototype.o,qg8.createFromModelPath=function(H,_){return qpu(qg8,H,{baseOptions:{modelAssetPath:_}})},qg8.createFromModelBuffer=function(H,_){return qpu(qg8,H,{baseOptions:{modelAssetBuffer:_}})},qg8.createFromOptions=function(H,_){return qpu(qg8,H,_)};var qg9=class{constructor(H,_,b){this.confidenceMasks=H,this.categoryMask=_,this.qualityScores=b}close(){var H,_;(H=this.confidenceMasks)==null||H.forEach(b=>{b.close()}),(_=this.categoryMask)==null||_.close()}};function qgq(H){H.categoryMask=void 0,H.confidenceMasks=void 0,H.qualityScores=void 0}function qgn(H){try{const _=new qg9(H.confidenceMasks,H.categoryMask,H.qualityScores);if(!H.j)return _;H.j(_)}finally{qp0(H)}}qg9.prototype.close=qg9.prototype.close;var qgp=class extends qpR{constructor(H,_){super(new qpN(H,_),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new qnw,this.v=new qnD,q7A(this.h,0,3,this.v),q7A(H=this.h,0,1,_=new qqH)}get baseOptions(){return q7C(this.h,qqH,1)}set baseOptions(H){q7A(this.h,0,1,H)}o(H){var _,b;return H.displayNamesLocale!==void 0?q7e(this.h,2,q71(H.displayNamesLocale)):"displayNamesLocale"in H&&q7e(this.h,2),"outputCategoryMask"in H&&(this.outputCategoryMask=(_=H.outputCategoryMask)!=null?_:!1),"outputConfidenceMasks"in H&&(this.outputConfidenceMasks=(b=H.outputConfidenceMasks)!=null?b:!0),super.l(H)}I(){(function(H){var _,b,$;const ee=q7H(H.da(),qqp,1).filter(re=>{var ae;return((ae=q7J(re,1))!=null?ae:"").includes("mediapipe.tasks.TensorsToSegmentationCalculator")});if(H.s=[],ee.length>1)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");ee.length===1&&(($=(b=(_=q7C(ee[0],qq6,7))==null?void 0:_.l())==null?void 0:b.g())!=null?$:new Map).forEach((re,ae)=>{var xe;H.s[Number(ae)]=(xe=q7J(re,1))!=null?xe:""})})(this)}segment(H,_,b){const $=typeof _!="function"?_:{};return this.j=typeof _=="function"?_:b,qgq(this),qpL(this,H,$),qgn(this)}Ma(H,_,b,$){const ee=typeof b!="function"?b:{};return this.j=typeof b=="function"?b:$,qgq(this),qpI(this,H,ee,_),qgn(this)}Da(){return this.s}m(){var H=new qqS;qqM(H,"image_in"),qqM(H,"norm_rect");const _=new qq6;q8a(_,qne,this.h);const b=new qqp;qq9(b,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),qqq(b,"IMAGE:image_in"),qqq(b,"NORM_RECT:norm_rect"),b.o(_),qqE(H,b),qnP(this,H),this.outputConfidenceMasks&&(qqf(H,"confidence_masks"),qqn(b,"CONFIDENCE_MASKS:confidence_masks"),qnU(this,"confidence_masks"),this.g.ca("confidence_masks",($,ee)=>{this.confidenceMasks=$.map(re=>qpb(this,re,!0,!this.j)),qnY(this,ee)}),this.g.attachEmptyPacketListener("confidence_masks",$=>{this.confidenceMasks=[],qnY(this,$)})),this.outputCategoryMask&&(qqf(H,"category_mask"),qqn(b,"CATEGORY_MASK:category_mask"),qnU(this,"category_mask"),this.g.U("category_mask",($,ee)=>{this.categoryMask=qpb(this,$,!1,!this.j),qnY(this,ee)}),this.g.attachEmptyPacketListener("category_mask",$=>{this.categoryMask=void 0,qnY(this,$)})),qqf(H,"quality_scores"),qqn(b,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",($,ee)=>{this.qualityScores=$,qnY(this,ee)}),this.g.attachEmptyPacketListener("quality_scores",$=>{this.categoryMask=void 0,qnY(this,$)}),H=H.g(),this.setGraph(new Uint8Array(H),!0)}};qgp.prototype.getLabels=qgp.prototype.Da,qgp.prototype.segmentForVideo=qgp.prototype.Ma,qgp.prototype.segment=qgp.prototype.segment,qgp.prototype.setOptions=qgp.prototype.o,qgp.createFromModelPath=function(H,_){return qpu(qgp,H,{baseOptions:{modelAssetPath:_}})},qgp.createFromModelBuffer=function(H,_){return qpu(qgp,H,{baseOptions:{modelAssetBuffer:_}})},qgp.createFromOptions=function(H,_){return qpu(qgp,H,_)};var qgg=class{constructor(H,_,b){this.confidenceMasks=H,this.categoryMask=_,this.qualityScores=b}close(){var H,_;(H=this.confidenceMasks)==null||H.forEach(b=>{b.close()}),(_=this.categoryMask)==null||_.close()}};qgg.prototype.close=qgg.prototype.close;var qgx=class extends q8Z{constructor(H){super(H)}},qgs=[0,q9u,-2],qgE=[0,q9w,-3,q9I,q9w,-1],qgM=[0,qgE],qgf=[0,qgE,q9u,-1],qgS=class extends q8Z{constructor(H){super(H)}},qgF=[0,q9w,-1,q9I],qgt=class extends q8Z{constructor(H){super(H)}},qgk=class extends q8Z{constructor(H){super(H)}},qgO=[1,2,3,4,5,6,7,8,9,10,14,15],qgW=class extends q8Z{constructor(H){super(H)}};qgW.prototype.g=q9T([0,q9Q,[0,qgO,q9d,qgE,q9d,[0,qgE,qgs],q9d,qgM,q9d,[0,qgM,qgs],q9d,qgF,q9d,[0,q9w,-3,q9I,q9l],q9d,[0,q9w,-3,q9I],q9d,[0,q9r,q9w,-2,q9I,q9u,q9I,-1,2,q9w,qgs],q9d,qgf,q9d,[0,qgf,qgs],q9w,qgs,q9r,q9d,[0,q9w,-3,q9I,qgs,-1],q9d,[0,q9Q,qgF]],q9r,[0,q9r,q9u,-1,q9I]]);var qgi=class extends qpR{constructor(H,_){super(new qpN(H,_),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new qnw,this.s=new qnD,q7A(this.h,0,3,this.s),q7A(H=this.h,0,1,_=new qqH)}get baseOptions(){return q7C(this.h,qqH,1)}set baseOptions(H){q7A(this.h,0,1,H)}o(H){var _,b;return"outputCategoryMask"in H&&(this.outputCategoryMask=(_=H.outputCategoryMask)!=null?_:!1),"outputConfidenceMasks"in H&&(this.outputConfidenceMasks=(b=H.outputConfidenceMasks)!=null?b:!0),super.l(H)}segment(H,_,b,$){const ee=typeof b!="function"?b:{};this.j=typeof b=="function"?b:$,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,b=this.B+1,$=new qgW;const re=new qgk;var ae=new qgx;if(q7U(ae,1,255),q7A(re,0,12,ae),_.keypoint&&_.scribble)throw Error("Cannot provide both keypoint and scribble.");if(_.keypoint){var xe=new qgS;q7P(xe,3,!0),q80(xe,1,_.keypoint.x),q80(xe,2,_.keypoint.y),q7h(re,5,qgO,xe)}else{if(!_.scribble)throw Error("Must provide either a keypoint or a scribble.");for(xe of(ae=new qgt,_.scribble))q7P(_=new qgS,3,!0),q80(_,1,xe.x),q80(_,2,xe.y),q7B(ae,1,qgS,_);q7h(re,15,qgO,ae)}q7B($,1,qgk,re),this.g.addProtoToStream($.g(),"drishti.RenderData","roi_in",b),qpL(this,H,ee);e:{try{const fe=new qgg(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var le=fe;break e}this.j(fe)}finally{qp0(this)}le=void 0}return le}m(){var H=new qqS;qqM(H,"image_in"),qqM(H,"roi_in"),qqM(H,"norm_rect_in");const _=new qq6;q8a(_,qne,this.h);const b=new qqp;qq9(b,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),qqq(b,"IMAGE:image_in"),qqq(b,"ROI:roi_in"),qqq(b,"NORM_RECT:norm_rect_in"),b.o(_),qqE(H,b),qnP(this,H),this.outputConfidenceMasks&&(qqf(H,"confidence_masks"),qqn(b,"CONFIDENCE_MASKS:confidence_masks"),qnU(this,"confidence_masks"),this.g.ca("confidence_masks",($,ee)=>{this.confidenceMasks=$.map(re=>qpb(this,re,!0,!this.j)),qnY(this,ee)}),this.g.attachEmptyPacketListener("confidence_masks",$=>{this.confidenceMasks=[],qnY(this,$)})),this.outputCategoryMask&&(qqf(H,"category_mask"),qqn(b,"CATEGORY_MASK:category_mask"),qnU(this,"category_mask"),this.g.U("category_mask",($,ee)=>{this.categoryMask=qpb(this,$,!1,!this.j),qnY(this,ee)}),this.g.attachEmptyPacketListener("category_mask",$=>{this.categoryMask=void 0,qnY(this,$)})),qqf(H,"quality_scores"),qqn(b,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",($,ee)=>{this.qualityScores=$,qnY(this,ee)}),this.g.attachEmptyPacketListener("quality_scores",$=>{this.categoryMask=void 0,qnY(this,$)}),H=H.g(),this.setGraph(new Uint8Array(H),!0)}};qgi.prototype.segment=qgi.prototype.segment,qgi.prototype.setOptions=qgi.prototype.o,qgi.createFromModelPath=function(H,_){return qpu(qgi,H,{baseOptions:{modelAssetPath:_}})},qgi.createFromModelBuffer=function(H,_){return qpu(qgi,H,{baseOptions:{modelAssetBuffer:_}})},qgi.createFromOptions=function(H,_){return qpu(qgi,H,_)};var qgD=class extends qpR{constructor(H,_){super(new qpN(H,_),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},q7A(H=this.h=new qnz,0,1,_=new qqH)}get baseOptions(){return q7C(this.h,qqH,1)}set baseOptions(H){q7A(this.h,0,1,H)}o(H){return H.displayNamesLocale!==void 0?q7e(this.h,2,q71(H.displayNamesLocale)):"displayNamesLocale"in H&&q7e(this.h,2),H.maxResults!==void 0?q7U(this.h,3,H.maxResults):"maxResults"in H&&q7e(this.h,3),H.scoreThreshold!==void 0?q80(this.h,4,H.scoreThreshold):"scoreThreshold"in H&&q7e(this.h,4),H.categoryAllowlist!==void 0?q81(this.h,5,H.categoryAllowlist):"categoryAllowlist"in H&&q7e(this.h,5),H.categoryDenylist!==void 0?q81(this.h,6,H.categoryDenylist):"categoryDenylist"in H&&q7e(this.h,6),this.l(H)}D(H,_){return this.j={detections:[]},qpL(this,H,_),this.j}F(H,_,b){return this.j={detections:[]},qpI(this,H,b,_),this.j}m(){var H=new qqS;qqM(H,"input_frame_gpu"),qqM(H,"norm_rect"),qqf(H,"detections");const _=new qq6;q8a(_,qnc,this.h);const b=new qqp;qq9(b,"mediapipe.tasks.vision.ObjectDetectorGraph"),qqq(b,"IMAGE:input_frame_gpu"),qqq(b,"NORM_RECT:norm_rect"),qqn(b,"DETECTIONS:detections"),b.o(_),qqE(H,b),this.g.attachProtoVectorListener("detections",($,ee)=>{for(const re of $)$=qqZ(re),this.j.detections.push(qnj($));qnY(this,ee)}),this.g.attachEmptyPacketListener("detections",$=>{qnY(this,$)}),H=H.g(),this.setGraph(new Uint8Array(H),!0)}};qgD.prototype.detectForVideo=qgD.prototype.F,qgD.prototype.detect=qgD.prototype.D,qgD.prototype.setOptions=qgD.prototype.o,qgD.createFromModelPath=async function(H,_){return qpu(qgD,H,{baseOptions:{modelAssetPath:_}})},qgD.createFromModelBuffer=function(H,_){return qpu(qgD,H,{baseOptions:{modelAssetBuffer:_}})},qgD.createFromOptions=function(H,_){return qpu(qgD,H,_)};var qgm=class{constructor(H,_,b){this.landmarks=H,this.worldLandmarks=_,this.segmentationMasks=b}close(){var H;(H=this.segmentationMasks)==null||H.forEach(_=>{_.close()})}};function qga(H){H.landmarks=[],H.worldLandmarks=[],H.segmentationMasks=void 0}function qgZ(H){try{const _=new qgm(H.landmarks,H.worldLandmarks,H.segmentationMasks);if(!H.s)return _;H.s(_)}finally{qp0(H)}}qgm.prototype.close=qgm.prototype.close;var qgw=class extends qpR{constructor(H,_){super(new qpN(H,_),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,q7A(H=this.h=new qnX,0,1,_=new qqH),this.v=new qnf,q7A(this.h,0,3,this.v),this.j=new qnM,q7A(this.h,0,2,this.j),q7U(this.j,4,1),q80(this.j,2,.5),q80(this.v,2,.5),q80(this.h,4,.5)}get baseOptions(){return q7C(this.h,qqH,1)}set baseOptions(H){q7A(this.h,0,1,H)}o(H){var _,b,$,ee,re;return"numPoses"in H&&q7U(this.j,4,(_=H.numPoses)!=null?_:1),"minPoseDetectionConfidence"in H&&q80(this.j,2,(b=H.minPoseDetectionConfidence)!=null?b:.5),"minTrackingConfidence"in H&&q80(this.h,4,($=H.minTrackingConfidence)!=null?$:.5),"minPosePresenceConfidence"in H&&q80(this.v,2,(ee=H.minPosePresenceConfidence)!=null?ee:.5),"outputSegmentationMasks"in H&&(this.outputSegmentationMasks=(re=H.outputSegmentationMasks)!=null?re:!1),this.l(H)}D(H,_,b){const $=typeof _!="function"?_:{};return this.s=typeof _=="function"?_:b,qga(this),qpL(this,H,$),qgZ(this)}F(H,_,b,$){const ee=typeof b!="function"?b:{};return this.s=typeof b=="function"?b:$,qga(this),qpI(this,H,ee,_),qgZ(this)}m(){var H=new qqS;qqM(H,"image_in"),qqM(H,"norm_rect"),qqf(H,"normalized_landmarks"),qqf(H,"world_landmarks"),qqf(H,"segmentation_masks");const _=new qq6;q8a(_,qnG,this.h);const b=new qqp;qq9(b,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),qqq(b,"IMAGE:image_in"),qqq(b,"NORM_RECT:norm_rect"),qqn(b,"NORM_LANDMARKS:normalized_landmarks"),qqn(b,"WORLD_LANDMARKS:world_landmarks"),b.o(_),qqE(H,b),qnP(this,H),this.g.attachProtoVectorListener("normalized_landmarks",($,ee)=>{this.landmarks=[];for(const re of $)$=qqc(re),this.landmarks.push(qnL($));qnY(this,ee)}),this.g.attachEmptyPacketListener("normalized_landmarks",$=>{this.landmarks=[],qnY(this,$)}),this.g.attachProtoVectorListener("world_landmarks",($,ee)=>{this.worldLandmarks=[];for(const re of $)$=qqe(re),this.worldLandmarks.push(qnI($));qnY(this,ee)}),this.g.attachEmptyPacketListener("world_landmarks",$=>{this.worldLandmarks=[],qnY(this,$)}),this.outputSegmentationMasks&&(qqn(b,"SEGMENTATION_MASK:segmentation_masks"),qnU(this,"segmentation_masks"),this.g.ca("segmentation_masks",($,ee)=>{this.segmentationMasks=$.map(re=>qpb(this,re,!0,!this.s)),qnY(this,ee)}),this.g.attachEmptyPacketListener("segmentation_masks",$=>{this.segmentationMasks=[],qnY(this,$)})),H=H.g(),this.setGraph(new Uint8Array(H),!0)}};qgw.prototype.detectForVideo=qgw.prototype.F,qgw.prototype.detect=qgw.prototype.D,qgw.prototype.setOptions=qgw.prototype.o,qgw.createFromModelPath=function(H,_){return qpu(qgw,H,{baseOptions:{modelAssetPath:_}})},qgw.createFromModelBuffer=function(H,_){return qpu(qgw,H,{baseOptions:{modelAssetBuffer:_}})},qgw.createFromOptions=function(H,_){return qpu(qgw,H,_)},qgw.POSE_CONNECTIONS=qg2;var events={exports:{}},hasRequiredEvents;function requireEvents(){if(hasRequiredEvents)return events.exports;hasRequiredEvents=1;var H=typeof Reflect=="object"?Reflect:null,_=H&&typeof H.apply=="function"?H.apply:function(Qe,rt,ot){return Function.prototype.apply.call(Qe,rt,ot)},b;H&&typeof H.ownKeys=="function"?b=H.ownKeys:Object.getOwnPropertySymbols?b=function(Qe){return Object.getOwnPropertyNames(Qe).concat(Object.getOwnPropertySymbols(Qe))}:b=function(Qe){return Object.getOwnPropertyNames(Qe)};function $(Ye){console&&console.warn&&console.warn(Ye)}var ee=Number.isNaN||function(Qe){return Qe!==Qe};function re(){re.init.call(this)}events.exports=re,events.exports.once=Ne,re.EventEmitter=re,re.prototype._events=void 0,re.prototype._eventsCount=0,re.prototype._maxListeners=void 0;var ae=10;function xe(Ye){if(typeof Ye!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Ye)}Object.defineProperty(re,"defaultMaxListeners",{enumerable:!0,get:function(){return ae},set:function(Ye){if(typeof Ye!="number"||Ye<0||ee(Ye))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Ye+".");ae=Ye}}),re.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},re.prototype.setMaxListeners=function(Qe){if(typeof Qe!="number"||Qe<0||ee(Qe))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Qe+".");return this._maxListeners=Qe,this};function le(Ye){return Ye._maxListeners===void 0?re.defaultMaxListeners:Ye._maxListeners}re.prototype.getMaxListeners=function(){return le(this)},re.prototype.emit=function(Qe){for(var rt=[],ot=1;ot<arguments.length;ot++)rt.push(arguments[ot]);var ct=Qe==="error",mt=this._events;if(mt!==void 0)ct=ct&&mt.error===void 0;else if(!ct)return!1;if(ct){var _t;if(rt.length>0&&(_t=rt[0]),_t instanceof Error)throw _t;var Lt=new Error("Unhandled error."+(_t?" ("+_t.message+")":""));throw Lt.context=_t,Lt}var Vt=mt[Qe];if(Vt===void 0)return!1;if(typeof Vt=="function")_(Vt,this,rt);else for(var Gt=Vt.length,$t=Ie(Vt,Gt),ot=0;ot<Gt;++ot)_($t[ot],this,rt);return!0};function fe(Ye,Qe,rt,ot){var ct,mt,_t;if(xe(rt),mt=Ye._events,mt===void 0?(mt=Ye._events=Object.create(null),Ye._eventsCount=0):(mt.newListener!==void 0&&(Ye.emit("newListener",Qe,rt.listener?rt.listener:rt),mt=Ye._events),_t=mt[Qe]),_t===void 0)_t=mt[Qe]=rt,++Ye._eventsCount;else if(typeof _t=="function"?_t=mt[Qe]=ot?[rt,_t]:[_t,rt]:ot?_t.unshift(rt):_t.push(rt),ct=le(Ye),ct>0&&_t.length>ct&&!_t.warned){_t.warned=!0;var Lt=new Error("Possible EventEmitter memory leak detected. "+_t.length+" "+String(Qe)+" listeners added. Use emitter.setMaxListeners() to increase limit");Lt.name="MaxListenersExceededWarning",Lt.emitter=Ye,Lt.type=Qe,Lt.count=_t.length,$(Lt)}return Ye}re.prototype.addListener=function(Qe,rt){return fe(this,Qe,rt,!1)},re.prototype.on=re.prototype.addListener,re.prototype.prependListener=function(Qe,rt){return fe(this,Qe,rt,!0)};function ve(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Se(Ye,Qe,rt){var ot={fired:!1,wrapFn:void 0,target:Ye,type:Qe,listener:rt},ct=ve.bind(ot);return ct.listener=rt,ot.wrapFn=ct,ct}re.prototype.once=function(Qe,rt){return xe(rt),this.on(Qe,Se(this,Qe,rt)),this},re.prototype.prependOnceListener=function(Qe,rt){return xe(rt),this.prependListener(Qe,Se(this,Qe,rt)),this},re.prototype.removeListener=function(Qe,rt){var ot,ct,mt,_t,Lt;if(xe(rt),ct=this._events,ct===void 0)return this;if(ot=ct[Qe],ot===void 0)return this;if(ot===rt||ot.listener===rt)--this._eventsCount===0?this._events=Object.create(null):(delete ct[Qe],ct.removeListener&&this.emit("removeListener",Qe,ot.listener||rt));else if(typeof ot!="function"){for(mt=-1,_t=ot.length-1;_t>=0;_t--)if(ot[_t]===rt||ot[_t].listener===rt){Lt=ot[_t].listener,mt=_t;break}if(mt<0)return this;mt===0?ot.shift():De(ot,mt),ot.length===1&&(ct[Qe]=ot[0]),ct.removeListener!==void 0&&this.emit("removeListener",Qe,Lt||rt)}return this},re.prototype.off=re.prototype.removeListener,re.prototype.removeAllListeners=function(Qe){var rt,ot,ct;if(ot=this._events,ot===void 0)return this;if(ot.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):ot[Qe]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete ot[Qe]),this;if(arguments.length===0){var mt=Object.keys(ot),_t;for(ct=0;ct<mt.length;++ct)_t=mt[ct],_t!=="removeListener"&&this.removeAllListeners(_t);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(rt=ot[Qe],typeof rt=="function")this.removeListener(Qe,rt);else if(rt!==void 0)for(ct=rt.length-1;ct>=0;ct--)this.removeListener(Qe,rt[ct]);return this};function Ee(Ye,Qe,rt){var ot=Ye._events;if(ot===void 0)return[];var ct=ot[Qe];return ct===void 0?[]:typeof ct=="function"?rt?[ct.listener||ct]:[ct]:rt?Be(ct):Ie(ct,ct.length)}re.prototype.listeners=function(Qe){return Ee(this,Qe,!0)},re.prototype.rawListeners=function(Qe){return Ee(this,Qe,!1)},re.listenerCount=function(Ye,Qe){return typeof Ye.listenerCount=="function"?Ye.listenerCount(Qe):Ce.call(Ye,Qe)},re.prototype.listenerCount=Ce;function Ce(Ye){var Qe=this._events;if(Qe!==void 0){var rt=Qe[Ye];if(typeof rt=="function")return 1;if(rt!==void 0)return rt.length}return 0}re.prototype.eventNames=function(){return this._eventsCount>0?b(this._events):[]};function Ie(Ye,Qe){for(var rt=new Array(Qe),ot=0;ot<Qe;++ot)rt[ot]=Ye[ot];return rt}function De(Ye,Qe){for(;Qe+1<Ye.length;Qe++)Ye[Qe]=Ye[Qe+1];Ye.pop()}function Be(Ye){for(var Qe=new Array(Ye.length),rt=0;rt<Qe.length;++rt)Qe[rt]=Ye[rt].listener||Ye[rt];return Qe}function Ne(Ye,Qe){return new Promise(function(rt,ot){function ct(_t){Ye.removeListener(Qe,mt),ot(_t)}function mt(){typeof Ye.removeListener=="function"&&Ye.removeListener("error",ct),rt([].slice.call(arguments))}Xe(Ye,Qe,mt,{once:!0}),Qe!=="error"&&qe(Ye,ct,{once:!0})})}function qe(Ye,Qe,rt){typeof Ye.on=="function"&&Xe(Ye,"error",Qe,rt)}function Xe(Ye,Qe,rt,ot){if(typeof Ye.on=="function")ot.once?Ye.once(Qe,rt):Ye.on(Qe,rt);else if(typeof Ye.addEventListener=="function")Ye.addEventListener(Qe,function ct(mt){ot.once&&Ye.removeEventListener(Qe,ct),rt(mt)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Ye)}return events.exports}var eventsExports=requireEvents();class c extends eventsExports.EventEmitter{}var R=Object.defineProperty,h=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,f=(H,_,b)=>_ in H?R(H,_,{enumerable:!0,configurable:!0,writable:!0,value:b}):H[_]=b,a=(H,_)=>{for(var b in _||(_={}))p.call(_,b)&&f(H,b,_[b]);if(h)for(var b of h(_))I.call(_,b)&&f(H,b,_[b]);return H};let r$1=class{constructor(_="canvas"){this.size={width:0,height:0},this.transpose=!1,this.context=null,this.canvas=document.createElement("canvas"),this.canvas.id="engeenee.capture."+_,this.canvas.hidden=!0,this.context=this.canvas.getContext("2d",{alpha:!1})}capture(_){const{context:b,clipPix:$,transpose:ee}=this;if(!b)return!1;let{width:re,height:ae}=this.size;return ee&&([re,ae]=[ae,re]),ee&&b.setTransform(0,1,1,0,0,0),$?b.drawImage(_,$.left,$.top,$.width,$.height,0,0,re,ae):b.drawImage(_,0,0,re,ae),ee&&b.resetTransform(),!0}fill(){const{context:_}=this;if(!_)return;let{width:b,height:$}=this.size;_.fillStyle="rgba(255, 255, 255, 1)",_.fillRect(0,0,b,$)}data(){const{context:_}=this;if(!_)return;const{width:b,height:$}=this.size;return _.getImageData(0,0,b,$)}setSize(_){let{width:b,height:$}=_;this.transpose&&([b,$]=[$,b]),this.size={width:b,height:$},this.canvas.width=b,this.canvas.height=$,this.setClip(this.clip)}setClip(_){let{width:b,height:$}=this.size;this.transpose&&([b,$]=[$,b]),this.clip=_,this.clipPix=_&&{left:_.left*b,top:_.top*$,width:_.width*b,height:_.height*$}}setTranspose(_){if(_==this.transpose)return;let{width:b,height:$}=this.size;this.transpose&&([b,$]=[$,b]),this.transpose=_,this.setSize({width:b,height:$})}dispose(){this.context=null,this.canvas.remove()}};class M extends c{constructor(){super(),this.buffer=new r$1("capture"),this.captureTime=0}async setup(_){delete this.sizeMax,delete this.aspectRatio,delete this.clipRect,delete this.transpose;const b=(ee=>ee!==void 0&&typeof ee!="string"&&"size"in ee)(_)?_:void 0,$=(b==null?void 0:b.size)||{width:1920,height:1080};return b&&(this.aspectRatio=b.ratio,this.clipRect=b.clip,this.transpose=b.transpose),this.updateSize($),this.buffer.fill(),!0}dispose(){this.reset(),this.buffer.dispose()}async start(){this.captureTime=0,this.timer=Date.now()}pause(){}reset(){this.pause(),delete this.timer}capture(){return this.timer===void 0?!1:(this.captureTime=(Date.now()-this.timer)*1e3,!0)}size(){return a({},this.buffer.size)}ratio(){const _=this.buffer.size;return _.width/_.height}updateSize(_){let{width:b,height:$}=_,{sizeMax:ee,aspectRatio:re,clipRect:ae,transpose:xe}=this;if(ee&&(b>ee||$>ee)){const fe=b/$;fe>1?(b=ee,$=ee/fe):($=ee,b=fe*ee),_={width:b,height:$}}const le=b/$;re&&le>re?(ae={left:.5*(le/re-1),top:0,width:1,height:1},b=$*re,_={width:b,height:$}):re&&le<re&&(ae={top:.5*(re/le-1),left:0,width:1,height:1},$=b/re,_={width:b,height:$}),this.buffer.setSize(_),this.buffer.setClip(ae),this.buffer.setTranspose(!!xe),this.emit("resize",this.buffer.size)}}var n=Object.defineProperty,u=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,l=(H,_,b)=>_ in H?n(H,_,{enumerable:!0,configurable:!0,writable:!0,value:b}):H[_]=b,F=(H,_)=>{for(var b in _||(_={}))t.call(_,b)&&l(H,b,_[b]);if(u)for(var b of u(_))A.call(_,b)&&l(H,b,_[b]);return H},m=(H,_)=>{var b={};for(var $ in H)t.call(H,$)&&_.indexOf($)<0&&(b[$]=H[$]);if(H!=null&&u)for(var $ of u(H))_.indexOf($)<0&&A.call(H,$)&&(b[$]=H[$]);return b};class x extends M{constructor(){super(),this.timeShift=0,this.videoRef=document.createElement("video"),this.videoRef.id="engeenee.capture.source",this.videoRef.muted=!0,this.videoRef.loop=!0,this.videoRef.playsInline=!0}async setup(_){const b=le=>typeof le=="string"||"url"in le&&typeof le.url=="string",$=le=>b(le)||"getVideoTracks"in le,ee=le=>b(le)&&typeof le!="string"?(this.sizeMax=le.sizeMax,le.url):le,re=le=>{var fe,ve;if(!le)return{video:!0,audio:!1};this.aspectRatio=le.ratio,this.clipRect=le.clip,this.transpose=le.transpose;const Se=le.opts||{},{video:Ee}=Se,Ce=m(Se,["video"]);return F({video:F({facingMode:le.rear===void 0?void 0:le.rear?"environment":"user",width:(fe=le.size)==null?void 0:fe.width,height:(ve=le.size)==null?void 0:ve.height,frameRate:le.fps},Ee instanceof Object?Ee:{}),audio:!1},Ce)};delete this.sizeMax,delete this.aspectRatio,delete this.clipRect,delete this.transpose;const ae=_!==void 0&&$(_)?ee(_):await navigator.mediaDevices.getUserMedia(re(_)).catch(()=>{});if(!ae)return!1;const{videoRef:xe}=this;return new Promise(le=>{xe.onloadedmetadata=()=>{this.updateSize({width:xe.videoWidth,height:xe.videoHeight}),xe.onresize=()=>{this.updateSize({width:xe.videoWidth,height:xe.videoHeight})},xe.onseeked=()=>{this.timeShift=this.captureTime,this.captureTime=0},le(!0)},typeof ae=="string"?xe.src=ae:xe.srcObject=ae})}dispose(){super.dispose(),this.videoRef.remove()}async start(){this.captureTime=0,this.timeShift=0,(this.videoRef.srcObject||this.videoRef.src)&&await this.videoRef.play()}pause(){this.videoRef.pause()}reset(){this.pause(),this.videoRef.srcObject&&(this.videoRef.srcObject.getTracks().forEach(_=>_.stop()),this.videoRef.srcObject=null)}capture(){const{videoRef:_,buffer:b}=this,$=_.currentTime+this.timeShift;return $<=this.captureTime?!1:(this.captureTime=$,b.capture(_))}}class i extends c{constructor(_,b,$=x){super(),this.engineParams=b,this.renderers=[],this.videoRatio=1920/1080,this.streamSize={width:1920,height:1080},this.processSize={width:1920,height:1080},this.resizeEnabled=!1,this.loopState=!1,this.init=async ee=>{const re=await this.setupProcessor(ee);return this.emit("init",re),re},this.setup=async ee=>{this.pause();const re=await this.setupVideo(ee);return this.emit("setup",re),re},this.start=async()=>{await this.video.start(),this.loopState=!0,this.emit("start"),this.enqueue()},this.pause=()=>{this.loopState=!1,this.loopId&&(window.cancelAnimationFrame(this.loopId),delete this.loopId),this.video.pause(),this.emit("pause")},this.reset=()=>{this.pause(),this.video.reset(),delete this.streamCanvas,delete this.processCanvas,this.processor.reset()},this.iterate=async()=>{var ee;const{video:re,streamCanvas:ae,processCanvas:xe}=this;if(!re.capture()||!ae||!xe)return this.enqueue();this.resizeEnabled&&((ee=this.resizeBuffer)==null||ee.capture(re.buffer.canvas));const le=await this.processor.process(xe,re.captureTime);le&&await Promise.all(this.renderers.map(fe=>fe.update(le,ae))),this.enqueue()},this.processor=typeof _=="function"?new _:_,this.video=typeof $=="function"?new $:$,this.video.on("resize",this.resizeVideo.bind(this))}async addRenderer(_){this.renderers.push(_),await _.load(),_.setupVideo(this.video.size(),this.video.ratio()),_.setupCamera(this.processor.cameraRatio,this.processor.cameraAngle)}removeRenderer(_){const{renderers:b}=this,$=b.indexOf(_);$<0||(b[$].dispose(),b.splice($,1))}enqueue(){this.loopId=this.loopState?window.requestAnimationFrame(this.iterate):void 0}async setupProcessor(_){var b;const $=this.resizeEnabled&&((b=this.resizeBuffer)==null?void 0:b.size)||this.video.size();return this.processor.init(_,$,this.video.ratio())}async setupVideo(_){return this.video.reset(),await this.video.setup(_)?(this.setupSize(this.video.size()),!0):!1}async setupSize(_){var b,$;const{width:ee,height:re}=_;this.videoRatio=ee/re;const ae=Math.max(ee,re),xe=((b=this.engineParams)==null?void 0:b.max)||this.processor.optimalSize;if(this.resizeEnabled=!1,xe<ae){this.resizeEnabled=!0;const le=ae/xe;this.resizeBuffer||(this.resizeBuffer=new r$1("resize")),this.resizeBuffer.setSize({width:ee/le,height:re/le})}this.resizeEnabled&&this.resizeBuffer?(this.processCanvas=this.resizeBuffer.canvas,this.processSize=this.resizeBuffer.size):(this.processCanvas=this.video.buffer.canvas,this.processSize=this.video.size()),(($=this.engineParams)==null?void 0:$.orig)!==!1?(this.streamCanvas=this.video.buffer.canvas,this.streamSize=this.video.size()):(this.streamCanvas=this.processCanvas,this.streamSize=this.streamSize)}resizeVideo(_){this.setupSize(_),this.processor.setupVideo(this.processSize,this.videoRatio),this.renderers.forEach(b=>b.setupVideo(this.streamSize,this.videoRatio)),this.renderers.forEach(b=>b.setupCamera(this.processor.cameraRatio,this.processor.cameraAngle))}}var o$1=Object.defineProperty,d=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,s$1=Object.prototype.propertyIsEnumerable,U=(H,_,b)=>_ in H?o$1(H,_,{enumerable:!0,configurable:!0,writable:!0,value:b}):H[_]=b,E=(H,_)=>{for(var b in _||(_={}))e.call(_,b)&&U(H,b,_[b]);if(d)for(var b of d(_))s$1.call(_,b)&&U(H,b,_[b]);return H};class b0 extends c{constructor(){super(),this.params={},this.videoSize={width:1920,height:1080},this.videoRatio=this.videoSize.width/this.videoSize.height,this.optimalSize=1024,this.cameraRatio=this.videoRatio,this.cameraAngle=60/180*Math.PI}async process(_,b){return{}}async init(_,b,$){return this.params=_,!$&&b&&($=b.width/b.height),this.setupVideo(b||this.videoSize,$||this.videoRatio),this.emit("init",!0),!0}reset(){this.emit("reset")}dispose(){}setupVideo(_,b){b=b||_.width/_.height,this.videoSize=E({},_),this.videoRatio=b,this.cameraRatio=b}}class b2 extends c{constructor(_,b="crop",$=1,ee=!1,re=1){super(),this.container=_,this.mode=b,this.layerCount=$,this.mirror=ee,this.aspectRatio=re,this.layers=[],this.padsSize=[1,1],this.setAspectRatio=ae=>{this.aspectRatio=ae,this.updateSizes(this.container.clientWidth/this.container.clientHeight)},this.setMirror=ae=>{this.mirror=ae,this.layers.forEach(xe=>{xe.style.transform=ae?"scaleX(-1)":""})},this.getMirror=()=>this.mirror,this.setMode=ae=>{if(this.mode=ae,this.mode==="pad"&&!this.pads){this.pads=[document.createElement("canvas"),document.createElement("canvas")];const xe=-10*(this.layerCount+1)+"";for(let le=0;le<2;le++)this.pads[le].id="engeenee.canvas.pad"+le,this.pads[le].style.position="absolute",this.pads[le].style.zIndex=xe,this.container.appendChild(this.pads[le])}this.mode!=="pad"&&this.pads&&(this.pads.forEach(xe=>xe.remove()),delete this.pads),this.setAspectRatio(this.aspectRatio)},this.getMode=()=>this.mode,this.dispose=()=>{var ae,xe;(ae=this.observer)==null||ae.disconnect(),delete this.observer,(xe=this.pads)==null||xe.forEach(le=>le.remove()),delete this.pads,this.layers.forEach(le=>le.remove()),this.layers=[]},this.updateSizes=ae=>{let xe=1,le=1;ae>this.aspectRatio?this.mode==="crop"?le=ae/this.aspectRatio:xe=this.aspectRatio/ae:this.mode==="crop"?xe=this.aspectRatio/ae:le=ae/this.aspectRatio;const fe=(1-xe)/2,ve=(1-le)/2,Se=xe*100+"%",Ee=le*100+"%",Ce=fe*100+"%",Ie=ve*100+"%";for(const De of this.layers)De.style.width=Se,De.style.height=Ee,De.style.left=Ce,De.style.top=Ie;if(this.pads){this.padsSize=fe>0?[fe,1]:[1,ve];const De=10,{clientWidth:Be,clientHeight:Ne}=this.container,qe=[2*De/Be,2*De/Ne],Xe=(this.padsSize[0]+2*qe[0])*100+"%",Ye=(this.padsSize[1]+2*qe[1])*100+"%";this.pads[0].style.width=Xe,this.pads[0].style.height=Ye,this.pads[1].style.width=Xe,this.pads[1].style.height=Ye;const Qe=-qe[0]*100+"%",rt=-qe[1]*100+"%";this.pads[0].style.top=rt,this.pads[1].style.bottom=rt,this.pads[0].style.left="unset",this.pads[0].style.right="unset",this.pads[1].style.left="unset",this.pads[1].style.right="unset",this.pads[this.mirror?1:0].style.left=Qe,this.pads[this.mirror?0:1].style.right=Qe;const ot=fe>0?this.mirror?"":"scaleX(-1)":"scaleY(-1) "+(this.mirror?"scaleX(-1)":"");this.pads[0].style.transform=ot,this.pads[1].style.transform=ot;const ct="blur("+De+"px)";this.pads[0].style.filter=ct,this.pads[1].style.filter=ct}this.emit("resize")},this.handleResize=ae=>{if(ae.length<1)return;const xe=ae[0].contentRect;this.updateSizes(xe.width/xe.height)};for(let ae=0;ae<$;ae++){const xe=document.createElement("canvas");xe.id="engeenee.canvas.layer"+ae,xe.style.position="absolute",xe.style.zIndex=-10*($-ae)+"",this.mirror&&(xe.style.transform="scaleX(-1)"),this.container.appendChild(xe),this.layers.push(xe)}this.setMode(b),this.observer=new ResizeObserver(this.handleResize),this.observer.observe(this.container),this.container.style.overflow="hidden"}}var b3=Object.defineProperty,b4=Object.getOwnPropertySymbols,b5=Object.prototype.hasOwnProperty,b6=Object.prototype.propertyIsEnumerable,b7=(H,_,b)=>_ in H?b3(H,_,{enumerable:!0,configurable:!0,writable:!0,value:b}):H[_]=b,b8=(H,_)=>{for(var b in _||(_={}))b5.call(_,b)&&b7(H,b,_[b]);if(b4)for(var b of b4(_))b6.call(_,b)&&b7(H,b,_[b]);return H};class b9 extends c{constructor(){super(),this.loaded=!1,this.videoSize={width:1920,height:1080},this.videoRatio=this.videoSize.width/this.videoSize.height,this.cameraRatio=this.videoRatio,this.cameraAngle=10/180*Math.PI}async load(){this.loaded||(this.loaded=!0,this.emit("load"))}unload(){this.loaded&&(this.loaded=!1)}async update(_,b){this.loaded&&(this.updateVideo(b),this.updateScene(),this.emit("render"))}updateVideo(_){}updateScene(){}dispose(){this.unload()}setupVideo(_,b){this.videoSize=b8({},_),this.videoRatio=b||_.width/_.height,this.emit("resize",this.videoSize,this.videoRatio)}setupCamera(_,b){this.cameraRatio=_,this.cameraAngle=b}}class bb extends b9{constructor(){super(...arguments),this.plugins=[]}async load(){if(!this.loaded)return await Promise.all(this.plugins.map(_=>_.load(this))),super.load()}unload(){this.plugins.forEach(_=>_.unload()),super.unload()}async update(_,b){if(this.loaded)return await this.updatePlugins(_,b),super.update(_,b)}async updatePlugins(_,b){for(let $ of this.plugins)$.loaded&&await $.update(_,b)}dispose(){this.plugins.forEach(_=>_.dispose()),this.plugins=[],super.dispose()}async addPlugin(_){const{plugins:b}=this;this.loaded&&!_.loaded&&await _.load(this),b.push(_),b.sort(($,ee)=>$.ordinal-ee.ordinal)}removePlugin(_){const{plugins:b}=this,$=b.indexOf(_);$<0||b.splice($,1)[0].unload()}removeAllPlugins(){this.plugins.forEach(_=>_.dispose()),this.plugins=[]}setupVideo(_,b){super.setupVideo(_,b),this.plugins.forEach($=>$.setupVideo(_))}setupCamera(_,b){super.setupCamera(_,b),this.plugins.forEach($=>$.setupCamera(_,b))}}class bD extends bb{constructor(_){super(),this.padCtx=[null,null],this.setupPadding=()=>{if(!this.canvas.pads)return;const{width:b,height:$}=this.videoSize,{padsSize:ee}=this.canvas,re=b*ee[0]/(ee[0]<.5?1-2*ee[0]:1),ae=$*ee[1]/(ee[1]<.5?1-2*ee[1]:1);this.canvas.pads[0].width=re,this.canvas.pads[0].height=ae,this.canvas.pads[1].width=re,this.canvas.pads[1].height=ae},this.canvas=new b2(_.container,_.mode,_.layerCount,_.mirror,_.aspectRatio),this.canvas.pads&&(this.padCtx=[this.canvas.pads[0].getContext("2d"),this.canvas.pads[1].getContext("2d")]),this.canvas.addListener("resize",this.setupPadding)}updateVideo(_){super.updateVideo(_),this.updatePads(_)}dispose(){this.padCtx=[null,null],this.canvas.dispose(),super.dispose()}setupVideo(_,b){super.setupVideo(_,b),this.canvas.setAspectRatio(this.videoRatio)}setMirror(_){this.canvas.setMirror(_)}setMode(_){this.canvas.setMode(_),this.canvas.pads?this.padCtx=[this.canvas.pads[0].getContext("2d"),this.canvas.pads[1].getContext("2d")]:this.padCtx=[null,null]}updatePads(_){if(!this.padCtx[0]||!this.padCtx[1]||!this.canvas.pads)return;const{videoSize:{width:b,height:$}}=this,{width:ee,height:re}=this.canvas.pads[0];this.padCtx[0].clearRect(0,0,ee,re),this.padCtx[0].drawImage(_,0,0,ee,re,0,0,ee,re),this.padCtx[1].clearRect(0,0,ee,re),this.padCtx[1].drawImage(_,b-ee,$-re,ee,re,0,0,ee,re)}}var bC=Object.defineProperty,bc=Object.getOwnPropertySymbols,bL=Object.prototype.hasOwnProperty,bB=Object.prototype.propertyIsEnumerable,bR=(H,_,b)=>_ in H?bC(H,_,{enumerable:!0,configurable:!0,writable:!0,value:b}):H[_]=b,bk=(H,_)=>{for(var b in _||(_={}))bL.call(_,b)&&bR(H,b,_[b]);if(bc)for(var b of bc(_))bB.call(_,b)&&bR(H,b,_[b]);return H};class bh{constructor(_,b={width:1920,height:1080},$=!1,ee=!1,re=!1){this.gl=_,this.size=b,this.grayscale=$,this.linear=ee,this.mipmap=re,this.buffer=null,this.levels=0,this.resize(b)}update(_){const{gl:b,size:{width:$,height:ee}}=this,re=b.getParameter(b.TEXTURE_BINDING_2D),ae=b.getParameter(b.UNPACK_FLIP_Y_WEBGL);return b.bindTexture(b.TEXTURE_2D,this.buffer),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1),_ instanceof Float32Array?b.texSubImage2D(b.TEXTURE_2D,0,0,0,$,ee,this.grayscale?b.RED:b.RGBA,b.FLOAT,_):_ instanceof Uint8Array?b.texSubImage2D(b.TEXTURE_2D,0,0,0,$,ee,this.grayscale?b.RED:b.RGBA,b.UNSIGNED_BYTE,_):b.texSubImage2D(b.TEXTURE_2D,0,0,0,$,ee,this.grayscale?b.RED:b.RGBA,b.UNSIGNED_BYTE,_),this.genLevels(),b.bindTexture(b.TEXTURE_2D,re),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,ae),this.buffer}resize(_){const{width:b,height:$}=_;if(b===this.size.width&&$===this.size.height&&this.buffer)return!0;const{gl:ee}=this;if(ee.deleteTexture(this.buffer),this.buffer=null,(b>0||$>0)&&(this.buffer=ee.createTexture()),!this.buffer)return!1;const re=this.linear?ee.LINEAR:ee.NEAREST,ae=this.mipmap?this.linear?ee.LINEAR_MIPMAP_LINEAR:ee.NEAREST_MIPMAP_NEAREST:re,xe=ee.getParameter(ee.TEXTURE_BINDING_2D),le=ee.getParameter(ee.UNPACK_FLIP_Y_WEBGL);return ee.bindTexture(ee.TEXTURE_2D,this.buffer),ee.pixelStorei(ee.UNPACK_FLIP_Y_WEBGL,!1),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_R,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,ae),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MAG_FILTER,re),this.size={width:b,height:$},this.levels=1+(this.mipmap?Math.floor(Math.log2(Math.max(b,$))):0),ee.texStorage2D(ee.TEXTURE_2D,this.levels,this.grayscale?ee.R8:ee.RGBA8,b,$),ee.bindTexture(ee.TEXTURE_2D,xe),ee.pixelStorei(ee.UNPACK_FLIP_Y_WEBGL,le),!0}dispose(){this.gl.deleteTexture(this.buffer),this.buffer=null}texture(){return this.buffer}textureSize(){return this.size}valid(){return!!this.buffer}isGrayscale(){return this.grayscale}genLevels(){if(!this.buffer||!this.mipmap)return!1;const{gl:_}=this,b=_.getParameter(_.TEXTURE_BINDING_2D);return _.bindTexture(_.TEXTURE_2D,this.buffer),_.generateMipmap(_.TEXTURE_2D),_.bindTexture(_.TEXTURE_2D,b),!0}levelCount(){return this.levels}levelSize(_){const b=bk({},this.size);for(let $=0;$<_&&$<this.levels;$++)b.width=Math.max(Math.floor(b.width/2),1),b.height=Math.max(Math.floor(b.height/2),1);return b}}var bN=Object.defineProperty,bp=Object.getOwnPropertySymbols,bJ=Object.prototype.hasOwnProperty,bI=Object.prototype.propertyIsEnumerable,by=(H,_,b)=>_ in H?bN(H,_,{enumerable:!0,configurable:!0,writable:!0,value:b}):H[_]=b,bf=(H,_)=>{for(var b in _||(_={}))bJ.call(_,b)&&by(H,b,_[b]);if(bp)for(var b of bp(_))bI.call(_,b)&&by(H,b,_[b]);return H};class bG{constructor(_,b={width:1920,height:1080},$=["image"],ee={},re=br,ae=ba,xe=!1,le=!1,fe=!1){this.gl=_,this.size=b,this.inputs=$,this.uniforms=ee,this.vertShader=null,this.fragShader=null,this.shaderProgram=null,this.vertBuffer=null,this.vertAttrs=null,this.uniformsLoc={},this.frameBuffer=null,re.includes("uniform vec2 wh;")&&!ee.wh&&(ee.wh="2f"),ae.includes("uniform float flip;")&&!ee.flip&&(ee.flip="1f"),this.outputTexture=new bh(_,b,xe,le,fe),this.compile(re,ae),this.resize(b)}process(_,b={}){const{gl:$,outputTexture:ee}=this;if(!$||!ee||_.length!==this.inputs.length)return null;const re=ee.texture();if(!re)return null;const ae=this.save($);return $.bindFramebuffer($.FRAMEBUFFER,this.frameBuffer),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,re,0),b=bf({flip:[-1]},b),this.prepare($,_,b),$.drawArrays($.TRIANGLES,0,6),ee.genLevels(),this.restore($,ae),re}render(_,b={}){const{gl:$,outputTexture:ee}=this;if(!$||!ee||_.length!==this.inputs.length)return;const re=this.save($);$.bindFramebuffer($.FRAMEBUFFER,null),b=bf({flip:[1]},b),this.prepare($,_,b),$.drawArrays($.TRIANGLES,0,6),this.restore($,re)}output(){var _;return((_=this.outputTexture)==null?void 0:_.texture())||null}read(){const{gl:_,outputTexture:b,frameBuffer:$}=this;if(!_||!b||!$)return null;const ee=b.texture();if(!ee)return null;const re=_.getParameter(_.TEXTURE_BINDING_2D),ae=_.getParameter(_.FRAMEBUFFER_BINDING);_.bindFramebuffer(_.FRAMEBUFFER,this.frameBuffer),_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,ee,0);const{width:xe,height:le}=b.textureSize(),fe=b.isGrayscale(),ve=new Uint8Array(xe*le*(fe?1:4)),Se=fe?_.RED:_.RGBA;return _.readPixels(0,0,xe,le,Se,_.UNSIGNED_BYTE,ve),_.bindTexture(_.TEXTURE_2D,re),_.bindFramebuffer(_.FRAMEBUFFER,ae),ve}program(){return this.shaderProgram}resize(_){var b;const{gl:$}=this;this.size=bf({},_),(b=this.outputTexture)==null||b.resize(_);const ee=$.getParameter($.CURRENT_PROGRAM);$.useProgram(this.shaderProgram),this.uniformsLoc.wh&&$.uniform2f(this.uniformsLoc.wh,_.width,_.height),$.useProgram(ee)}setUniform(_,b){const{gl:$}=this,ee=$.getParameter($.CURRENT_PROGRAM);$.useProgram(this.shaderProgram),this.setUniformUnsafe(_,b),$.useProgram(ee)}dispose(){var _;const{gl:b}=this;b.deleteBuffer(this.vertBuffer),this.vertBuffer=null,b.deleteFramebuffer(this.frameBuffer),this.frameBuffer=null,b.deleteShader(this.vertShader),this.vertShader=null,b.deleteShader(this.fragShader),this.fragShader=null,b.deleteProgram(this.shaderProgram),this.shaderProgram=null,(_=this.outputTexture)==null||_.dispose(),delete this.outputTexture}compile(_,b){const{gl:$}=this,ee=this.save($);if(this.vertBuffer=$.createBuffer(),this.vertAttrs=$.createVertexArray(),this.frameBuffer=$.createFramebuffer(),!this.vertBuffer||!this.frameBuffer||!this.vertAttrs){$.deleteBuffer(this.vertBuffer),this.vertBuffer=null,$.deleteFramebuffer(this.frameBuffer),this.frameBuffer=null,$.deleteVertexArray(this.vertAttrs),this.vertAttrs=null;return}if(this.vertShader=$.createShader($.VERTEX_SHADER),this.fragShader=$.createShader($.FRAGMENT_SHADER),this.shaderProgram=$.createProgram(),!this.vertShader||!this.fragShader||!this.shaderProgram){$.deleteBuffer(this.vertBuffer),this.vertBuffer=null,$.deleteFramebuffer(this.frameBuffer),this.frameBuffer=null,$.deleteShader(this.vertShader),this.vertShader=null,$.deleteShader(this.fragShader),this.fragShader=null,$.deleteProgram(this.shaderProgram),this.shaderProgram=null;return}$.shaderSource(this.vertShader,b),$.shaderSource(this.fragShader,_),$.compileShader(this.vertShader),$.compileShader(this.fragShader),$.attachShader(this.shaderProgram,this.vertShader),$.attachShader(this.shaderProgram,this.fragShader),$.linkProgram(this.shaderProgram),$.useProgram(this.shaderProgram),$.bindBuffer($.ARRAY_BUFFER,this.vertBuffer),$.bufferData($.ARRAY_BUFFER,new Float32Array([-1,-1,1,1,-1,1,-1,-1,1,-1,1,1]),$.STATIC_DRAW),$.bindVertexArray(this.vertAttrs);const re=$.getAttribLocation(this.shaderProgram,"pos");$.vertexAttribPointer(re,2,$.FLOAT,!1,0,0),$.enableVertexAttribArray(re),this.uniformsLoc={};for(let ae in this.uniforms)this.uniformsLoc[ae]=$.getUniformLocation(this.shaderProgram,ae);for(let ae=0;ae<this.inputs.length;ae++)$.uniform1i($.getUniformLocation(this.shaderProgram,this.inputs[ae]),ae);this.restore($,ee)}prepare(_,b,$={}){const{size:{width:ee,height:re}}=this;for(let ae=0;ae<b.length;ae++)_.activeTexture(_.TEXTURE0+ae),_.bindTexture(_.TEXTURE_2D,b[ae]);_.useProgram(this.shaderProgram),_.bindVertexArray(this.vertAttrs);for(let ae in $)this.setUniformUnsafe(ae,$[ae]);_.disable(_.CULL_FACE),_.disable(_.BLEND),_.colorMask(!0,!0,!0,!0),_.viewport(0,0,ee,re),_.scissor(0,0,ee,re),_.clear(_.COLOR_BUFFER_BIT)}save(_){return{program:_.getParameter(_.CURRENT_PROGRAM),arrayBuffer:_.getParameter(_.ARRAY_BUFFER_BINDING),framebuffer:_.getParameter(_.FRAMEBUFFER_BINDING),vertexArray:_.getParameter(_.VERTEX_ARRAY_BINDING),viewport:_.getParameter(_.VIEWPORT),scissor:_.getParameter(_.SCISSOR_BOX),colorMask:_.getParameter(_.COLOR_WRITEMASK),cullFace:_.getParameter(_.CULL_FACE),blend:_.getParameter(_.BLEND),activeTexture:_.getParameter(_.ACTIVE_TEXTURE),textures:this.inputs.map((b,$)=>(_.activeTexture(_.TEXTURE0+$),_.getParameter(_.TEXTURE_BINDING_2D)))}}restore(_,b){_.useProgram(b.program),_.bindBuffer(_.ARRAY_BUFFER,b.arrayBuffer),_.bindFramebuffer(_.FRAMEBUFFER,b.framebuffer),_.bindVertexArray(b.vertexArray),_.viewport(b.viewport[0],b.viewport[1],b.viewport[2],b.viewport[3]),_.scissor(b.scissor[0],b.scissor[1],b.scissor[2],b.scissor[3]),_.colorMask(b.colorMask[0],b.colorMask[1],b.colorMask[2],b.colorMask[3]);for(let $=0;$<b.textures.length;$++)_.activeTexture(_.TEXTURE0+$),_.bindTexture(_.TEXTURE_2D,b.textures[$]);_.activeTexture(b.activeTexture),b.cullFace?_.enable(_.CULL_FACE):_.disable(_.CULL_FACE),b.blend?_.enable(_.BLEND):_.disable(_.BLEND)}setUniformUnsafe(_,b){const $=this.uniformsLoc[_];if(!$)return;const{gl:ee}=this;switch(this.uniforms[_]){case"1f":b.length===1&&ee.uniform1f($,b[0]);break;case"2f":b.length===2&&ee.uniform2f($,b[0],b[1]);break;case"3f":b.length===3&&ee.uniform3f($,b[0],b[1],b[2]);break;case"4f":b.length===4&&ee.uniform4f($,b[0],b[1],b[2],b[3]);break;case"1fv":ee.uniform1fv($,b);break;case"2fv":ee.uniform2fv($,b);break;case"3fv":ee.uniform3fv($,b);break;case"4fv":ee.uniform4fv($,b);break;case"1i":b.length===1&&ee.uniform1i($,b[0]);break;case"2i":b.length===2&&ee.uniform2i($,b[0],b[1]);break;case"3i":b.length===3&&ee.uniform3i($,b[0],b[1],b[2]);break;case"4i":b.length===4&&ee.uniform4i($,b[0],b[1],b[2],b[3]);break;case"1iv":ee.uniform1iv($,b);break;case"2iv":ee.uniform2iv($,b);break;case"3iv":ee.uniform3iv($,b);break;case"4iv":ee.uniform4iv($,b);break}}}const ba=`
attribute vec2 pos;
uniform float flip;
varying vec2 xy;
void main() {
    xy = (vec2(pos.x, -pos.y) + 1.0) * 0.5;
    gl_Position = vec4(pos.x, pos.y * flip, 0, 1.0);
}`,br=`
precision mediump float;
varying vec2 xy;
uniform vec2 wh;
uniform sampler2D image;
void main() {
    gl_FragColor = texture2D(image, xy);
}`;class bM extends bD{constructor(_){super(_),this.shaderCtx=null,this.current=null;const b=this.canvas.layers[0];this.shaderCtx=b.getContext("webgl2",{alpha:!0,preserveDrawingBuffer:!0})}async load(){if(this.loaded)return;const{shaderCtx:_,videoSize:b}=this;if(_)return this.shader=new bG(_,b),this.input=new bh(_,b),super.load()}unload(){var _,b;(_=this.input)==null||_.dispose(),delete this.input,(b=this.shader)==null||b.dispose(),delete this.shader,super.unload()}async update(_,b){if(!this.loaded)return;const{input:$}=this,ee=$==null?void 0:$.texture();if(!(!$||!ee))return $.update(b),this.current=ee,super.update(_,b)}updateVideo(_){this.shader&&(this.shader.render([this.current]),super.updateVideo(_))}setupVideo(_,b){var $,ee;super.setupVideo(_,b);const{width:re,height:ae}=this.videoSize;this.canvas.layers[0].width=re,this.canvas.layers[0].height=ae,($=this.input)==null||$.resize({width:re,height:ae}),(ee=this.shader)==null||ee.resize({width:re,height:ae})}}class bn extends bM{dispose(){delete this.scene,super.dispose()}}class bT{constructor(){this.loaded=!1,this.ordinal=800}async load(_){this.loaded||(this.renderer=_,this.loaded=!0)}unload(){this.loaded&&(this.loaded=!1)}async update(_,b){this.loaded}dispose(){this.unload()}setupVideo(_){}setupCamera(_,b){}}var bu=(H=>(H[H.PreProcess=100]="PreProcess",H[H.Process=200]="Process",H[H.PostProcess=300]="PostProcess",H[H.PreRender=700]="PreRender",H[H.Render=800]="Render",H[H.PostRender=900]="PostRender",H))(bu||{});class bF extends bT{constructor(){super(),this.ordinal=bu.Render}async load(_){if(!(this.loaded||!(_ instanceof bn)||!_.scene))return this.scene=_.scene,super.load(_)}unload(){this.loaded&&(delete this.scene,super.unload())}}class bm{constructor(_,b=!1,$="video",ee){this.renderer=_,this.mirror=b,this.sizeMode=$,this.sizeMax=ee}async snapshot(){return new Promise(_=>{this.renderer.once("render",()=>{const{renderer:b}=this,{layers:$}=b.canvas;let{width:ee,height:re}=b.canvas.layers[0];this.sizeMode==="max"?(ee=Math.max(...$.map(fe=>fe.width)),re=Math.max(...$.map(fe=>fe.height))):this.sizeMode==="min"&&(ee=Math.min(...$.map(fe=>fe.width)),re=Math.min(...$.map(fe=>fe.height)));const ae=document.createElement("canvas");ae.id="engeenee.snapshot",ae.hidden=!0,ae.width=ee,ae.height=re;const xe=ae.getContext("2d",{alpha:!0});if(!xe)return;this.mirror&&(xe.translate(ee,0),xe.scale(-1,1)),$.forEach(fe=>xe.drawImage(fe,0,0,ee,re));const le=xe.getImageData(0,0,ee,re);ae.remove(),_(le)})})}async snapshotLayers(){return new Promise(_=>{this.renderer.once("render",()=>{const b=document.createElement("canvas");b.id="engeenee.snapshot",b.hidden=!0;const $=b.getContext("2d",{alpha:!0});if(!$)return;const ee=this.renderer.canvas.layers.map(re=>{const{width:ae,height:xe}=re;return b.width=ae,b.height=xe,$.resetTransform(),this.mirror&&($.translate(ae,0),$.scale(-1,1)),$.drawImage(re,0,0),$.getImageData(0,0,ae,xe)});b.remove(),_(ee)})})}}class s extends b0{constructor(){super(...arguments),this.faceTracker=new q4d,this.cameraAngleBase=10/180*Math.PI}async init(_,b,$){return await this.faceTracker.init(_.token,_.root,_.cache,_.highP,_.mask,_.maskExt,_.maskSize),await this.faceTracker.prepare(),super.init(_,b,$)}reset(){this.faceTracker.reset(),super.reset()}dispose(){this.faceTracker.dispose()}async process(_,b){return{faces:(await this.faceTracker.process(_,b)).map($=>{const{keypoints:ee,mask:re,score:ae}=$,xe=$&&this.params.transform?this.faceTracker.align($.keypoints):void 0,le=xe&&this.params.metric?this.faceTracker.metricPoints():void 0,fe=xe&&this.params.backproj?this.faceTracker.backprojPoints():void 0;return{pixel:ee,metric:le,backproj:fe,transform:xe,mask:re,score:ae}})}}setupVideo(_,b){super.setupVideo(_,b),this.cameraAngle=this.cameraRatio>=1?this.cameraAngleBase:2*Math.atan(Math.tan(.5*this.cameraAngleBase)/this.cameraRatio),this.faceTracker.setCamera(this.cameraAngle,this.cameraRatio,1),this.faceTracker.reset()}}class Z extends i{constructor(_,b=x){super(s,_,b)}}class o extends b0{constructor(){super(),this.poseTracker=new q4t,this.cameraAngleBase=15/180*Math.PI;const _=/iPhone|iPad|iPod/i.test(navigator.userAgent);this.optimalSize=_?512:1024}async init(_,b,$){return await this.poseTracker.init(_.token,_.root,_.cache,_.mask),await this.poseTracker.prepare(),super.init(_,b,$)}reset(){return this.poseTracker.reset(),super.reset()}dispose(){this.poseTracker.dispose()}async process(_,b){return{poses:(await this.poseTracker.process(_,b)).map($=>({points:S(ee=>$.keypoints[N[ee]]),score:$.score,mask:$.mask,timestamp:b,debug:$.debug}))}}setupVideo(_,b){super.setupVideo(_,b),this.cameraAngle=this.cameraRatio>=1?this.cameraAngleBase:2*Math.atan(Math.tan(.5*this.cameraAngleBase)/this.cameraRatio),this.poseTracker.setCamera(this.cameraAngle,this.cameraRatio,1),this.poseTracker.reset()}}class z extends i{constructor(_,b=x){super(o,_,b)}}const r=["nose","eyeInnerL","eyeL","eyeOutterL","eyeInnerR","eyeR","eyeOutterR","earL","earR","mouthL","mouthR","shoulderL","shoulderR","elbowL","elbowR","wristL","wristR","pinkyL","pinkyR","indexL","indexR","thumbL","thumbR","hipL","hipR","kneeL","kneeR","ankleL","ankleR","heelL","heelR","footIndexL","footIndexR"];function q(H,_){return Object.fromEntries(_.map(b=>[b,H(b)]))}const S=H=>q(H,r),N=S(H=>r.indexOf(H)),REVISION$1="168",CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide$1=0,BackSide$1=1,DoubleSide$1=2,NoBlending=0,NormalBlending$1=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation$1=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor$1=204,OneMinusSrcAlphaFactor$1=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,ConstantColorFactor=211,OneMinusConstantColorFactor=212,ConstantAlphaFactor=213,OneMinusConstantAlphaFactor=214,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth$1=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation$1=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,AgXToneMapping=6,NeutralToneMapping=7,UVMapping$1=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping$1=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping$1=1e3,ClampToEdgeWrapping$1=1001,MirroredRepeatWrapping$1=1002,NearestFilter$1=1003,NearestMipmapNearestFilter$1=1004,NearestMipmapLinearFilter$1=1005,LinearFilter$1=1006,LinearMipmapNearestFilter$1=1007,LinearMipmapLinearFilter$1=1008,UnsignedByteType$1=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType$1=1015,HalfFloatType$1=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,UnsignedInt5999Type=35902,AlphaFormat=1021,RGBFormat=1022,RGBAFormat$1=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat$1=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RGB_BPTC_SIGNED_Format=36494,RGB_BPTC_UNSIGNED_Format=36495,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap$1=0,ObjectSpaceNormalMap=1,NoColorSpace$1="",SRGBColorSpace$1="srgb",LinearSRGBColorSpace$1="srgb-linear",DisplayP3ColorSpace$1="display-p3",LinearDisplayP3ColorSpace$1="display-p3-linear",LinearTransfer$1="linear",SRGBTransfer$1="srgb",Rec709Primaries$1="rec709",P3Primaries$1="p3",KeepStencilOp$1=7680,AlwaysStencilFunc$1=519,NeverCompare=512,LessCompare=513,EqualCompare=514,LessEqualCompare=515,GreaterCompare=516,NotEqualCompare=517,GreaterEqualCompare=518,AlwaysCompare=519,StaticDrawUsage$1=35044,GLSL3="300 es",WebGLCoordinateSystem$1=2e3,WebGPUCoordinateSystem$1=2001,_lut$1=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],DEG2RAD$1=Math.PI/180,RAD2DEG$1=180/Math.PI;function generateUUID$1(){const H=Math.random()*4294967295|0,_=Math.random()*4294967295|0,b=Math.random()*4294967295|0,$=Math.random()*4294967295|0;return(_lut$1[H&255]+_lut$1[H>>8&255]+_lut$1[H>>16&255]+_lut$1[H>>24&255]+"-"+_lut$1[_&255]+_lut$1[_>>8&255]+"-"+_lut$1[_>>16&15|64]+_lut$1[_>>24&255]+"-"+_lut$1[b&63|128]+_lut$1[b>>8&255]+"-"+_lut$1[b>>16&255]+_lut$1[b>>24&255]+_lut$1[$&255]+_lut$1[$>>8&255]+_lut$1[$>>16&255]+_lut$1[$>>24&255]).toLowerCase()}function clamp$1(H,_,b){return Math.max(_,Math.min(b,H))}function euclideanModulo$1(H,_){return(H%_+_)%_}function lerp$1(H,_,b){return(1-b)*H+b*_}function denormalize$1(H,_){switch(_.constructor){case Float32Array:return H;case Uint32Array:return H/4294967295;case Uint16Array:return H/65535;case Uint8Array:return H/255;case Int32Array:return Math.max(H/2147483647,-1);case Int16Array:return Math.max(H/32767,-1);case Int8Array:return Math.max(H/127,-1);default:throw new Error("Invalid component type.")}}function normalize$1(H,_){switch(_.constructor){case Float32Array:return H;case Uint32Array:return Math.round(H*4294967295);case Uint16Array:return Math.round(H*65535);case Uint8Array:return Math.round(H*255);case Int32Array:return Math.round(H*2147483647);case Int16Array:return Math.round(H*32767);case Int8Array:return Math.round(H*127);default:throw new Error("Invalid component type.")}}let Matrix3$1=class wp{constructor(_,b,$,ee,re,ae,xe,le,fe){wp.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],_!==void 0&&this.set(_,b,$,ee,re,ae,xe,le,fe)}set(_,b,$,ee,re,ae,xe,le,fe){const ve=this.elements;return ve[0]=_,ve[1]=ee,ve[2]=xe,ve[3]=b,ve[4]=re,ve[5]=le,ve[6]=$,ve[7]=ae,ve[8]=fe,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_){const b=this.elements,$=_.elements;return b[0]=$[0],b[1]=$[1],b[2]=$[2],b[3]=$[3],b[4]=$[4],b[5]=$[5],b[6]=$[6],b[7]=$[7],b[8]=$[8],this}extractBasis(_,b,$){return _.setFromMatrix3Column(this,0),b.setFromMatrix3Column(this,1),$.setFromMatrix3Column(this,2),this}setFromMatrix4(_){const b=_.elements;return this.set(b[0],b[4],b[8],b[1],b[5],b[9],b[2],b[6],b[10]),this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,b){const $=_.elements,ee=b.elements,re=this.elements,ae=$[0],xe=$[3],le=$[6],fe=$[1],ve=$[4],Se=$[7],Ee=$[2],Ce=$[5],Ie=$[8],De=ee[0],Be=ee[3],Ne=ee[6],qe=ee[1],Xe=ee[4],Ye=ee[7],Qe=ee[2],rt=ee[5],ot=ee[8];return re[0]=ae*De+xe*qe+le*Qe,re[3]=ae*Be+xe*Xe+le*rt,re[6]=ae*Ne+xe*Ye+le*ot,re[1]=fe*De+ve*qe+Se*Qe,re[4]=fe*Be+ve*Xe+Se*rt,re[7]=fe*Ne+ve*Ye+Se*ot,re[2]=Ee*De+Ce*qe+Ie*Qe,re[5]=Ee*Be+Ce*Xe+Ie*rt,re[8]=Ee*Ne+Ce*Ye+Ie*ot,this}multiplyScalar(_){const b=this.elements;return b[0]*=_,b[3]*=_,b[6]*=_,b[1]*=_,b[4]*=_,b[7]*=_,b[2]*=_,b[5]*=_,b[8]*=_,this}determinant(){const _=this.elements,b=_[0],$=_[1],ee=_[2],re=_[3],ae=_[4],xe=_[5],le=_[6],fe=_[7],ve=_[8];return b*ae*ve-b*xe*fe-$*re*ve+$*xe*le+ee*re*fe-ee*ae*le}invert(){const _=this.elements,b=_[0],$=_[1],ee=_[2],re=_[3],ae=_[4],xe=_[5],le=_[6],fe=_[7],ve=_[8],Se=ve*ae-xe*fe,Ee=xe*le-ve*re,Ce=fe*re-ae*le,Ie=b*Se+$*Ee+ee*Ce;if(Ie===0)return this.set(0,0,0,0,0,0,0,0,0);const De=1/Ie;return _[0]=Se*De,_[1]=(ee*fe-ve*$)*De,_[2]=(xe*$-ee*ae)*De,_[3]=Ee*De,_[4]=(ve*b-ee*le)*De,_[5]=(ee*re-xe*b)*De,_[6]=Ce*De,_[7]=($*le-fe*b)*De,_[8]=(ae*b-$*re)*De,this}transpose(){let _;const b=this.elements;return _=b[1],b[1]=b[3],b[3]=_,_=b[2],b[2]=b[6],b[6]=_,_=b[5],b[5]=b[7],b[7]=_,this}getNormalMatrix(_){return this.setFromMatrix4(_).invert().transpose()}transposeIntoArray(_){const b=this.elements;return _[0]=b[0],_[1]=b[3],_[2]=b[6],_[3]=b[1],_[4]=b[4],_[5]=b[7],_[6]=b[2],_[7]=b[5],_[8]=b[8],this}setUvTransform(_,b,$,ee,re,ae,xe){const le=Math.cos(re),fe=Math.sin(re);return this.set($*le,$*fe,-$*(le*ae+fe*xe)+ae+_,-ee*fe,ee*le,-ee*(-fe*ae+le*xe)+xe+b,0,0,1),this}scale(_,b){return this.premultiply(_m3$1.makeScale(_,b)),this}rotate(_){return this.premultiply(_m3$1.makeRotation(-_)),this}translate(_,b){return this.premultiply(_m3$1.makeTranslation(_,b)),this}makeTranslation(_,b){return _.isVector2?this.set(1,0,_.x,0,1,_.y,0,0,1):this.set(1,0,_,0,1,b,0,0,1),this}makeRotation(_){const b=Math.cos(_),$=Math.sin(_);return this.set(b,-$,0,$,b,0,0,0,1),this}makeScale(_,b){return this.set(_,0,0,0,b,0,0,0,1),this}equals(_){const b=this.elements,$=_.elements;for(let ee=0;ee<9;ee++)if(b[ee]!==$[ee])return!1;return!0}fromArray(_,b=0){for(let $=0;$<9;$++)this.elements[$]=_[$+b];return this}toArray(_=[],b=0){const $=this.elements;return _[b]=$[0],_[b+1]=$[1],_[b+2]=$[2],_[b+3]=$[3],_[b+4]=$[4],_[b+5]=$[5],_[b+6]=$[6],_[b+7]=$[7],_[b+8]=$[8],_}clone(){return new this.constructor().fromArray(this.elements)}};const _m3$1=new Matrix3$1,LINEAR_SRGB_TO_LINEAR_DISPLAY_P3$1=new Matrix3$1().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB$1=new Matrix3$1().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),COLOR_SPACES$1={[LinearSRGBColorSpace$1]:{transfer:LinearTransfer$1,primaries:Rec709Primaries$1,luminanceCoefficients:[.2126,.7152,.0722],toReference:H=>H,fromReference:H=>H},[SRGBColorSpace$1]:{transfer:SRGBTransfer$1,primaries:Rec709Primaries$1,luminanceCoefficients:[.2126,.7152,.0722],toReference:H=>H.convertSRGBToLinear(),fromReference:H=>H.convertLinearToSRGB()},[LinearDisplayP3ColorSpace$1]:{transfer:LinearTransfer$1,primaries:P3Primaries$1,luminanceCoefficients:[.2289,.6917,.0793],toReference:H=>H.applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB$1),fromReference:H=>H.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3$1)},[DisplayP3ColorSpace$1]:{transfer:SRGBTransfer$1,primaries:P3Primaries$1,luminanceCoefficients:[.2289,.6917,.0793],toReference:H=>H.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB$1),fromReference:H=>H.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3$1).convertLinearToSRGB()}},SUPPORTED_WORKING_COLOR_SPACES$1=new Set([LinearSRGBColorSpace$1,LinearDisplayP3ColorSpace$1]),ColorManagement$1={enabled:!0,_workingColorSpace:LinearSRGBColorSpace$1,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(H){if(!SUPPORTED_WORKING_COLOR_SPACES$1.has(H))throw new Error(`Unsupported working color space, "${H}".`);this._workingColorSpace=H},convert:function(H,_,b){if(this.enabled===!1||_===b||!_||!b)return H;const $=COLOR_SPACES$1[_].toReference,ee=COLOR_SPACES$1[b].fromReference;return ee($(H))},fromWorkingColorSpace:function(H,_){return this.convert(H,this._workingColorSpace,_)},toWorkingColorSpace:function(H,_){return this.convert(H,_,this._workingColorSpace)},getPrimaries:function(H){return COLOR_SPACES$1[H].primaries},getTransfer:function(H){return H===NoColorSpace$1?LinearTransfer$1:COLOR_SPACES$1[H].transfer},getLuminanceCoefficients:function(H,_=this._workingColorSpace){return H.fromArray(COLOR_SPACES$1[_].luminanceCoefficients)}};function SRGBToLinear$1(H){return H<.04045?H*.0773993808:Math.pow(H*.9478672986+.0521327014,2.4)}function LinearToSRGB$1(H){return H<.0031308?H*12.92:1.055*Math.pow(H,.41666)-.055}const _colorKeywords$1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA$1={h:0,s:0,l:0},_hslB$1={h:0,s:0,l:0};function hue2rgb$1(H,_,b){return b<0&&(b+=1),b>1&&(b-=1),b<1/6?H+(_-H)*6*b:b<1/2?_:b<2/3?H+(_-H)*6*(2/3-b):H}let Color$1=class{constructor(_,b,$){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(_,b,$)}set(_,b,$){if(b===void 0&&$===void 0){const ee=_;ee&&ee.isColor?this.copy(ee):typeof ee=="number"?this.setHex(ee):typeof ee=="string"&&this.setStyle(ee)}else this.setRGB(_,b,$);return this}setScalar(_){return this.r=_,this.g=_,this.b=_,this}setHex(_,b=SRGBColorSpace$1){return _=Math.floor(_),this.r=(_>>16&255)/255,this.g=(_>>8&255)/255,this.b=(_&255)/255,ColorManagement$1.toWorkingColorSpace(this,b),this}setRGB(_,b,$,ee=ColorManagement$1.workingColorSpace){return this.r=_,this.g=b,this.b=$,ColorManagement$1.toWorkingColorSpace(this,ee),this}setHSL(_,b,$,ee=ColorManagement$1.workingColorSpace){if(_=euclideanModulo$1(_,1),b=clamp$1(b,0,1),$=clamp$1($,0,1),b===0)this.r=this.g=this.b=$;else{const re=$<=.5?$*(1+b):$+b-$*b,ae=2*$-re;this.r=hue2rgb$1(ae,re,_+1/3),this.g=hue2rgb$1(ae,re,_),this.b=hue2rgb$1(ae,re,_-1/3)}return ColorManagement$1.toWorkingColorSpace(this,ee),this}setStyle(_,b=SRGBColorSpace$1){function $(re){re!==void 0&&parseFloat(re)<1&&console.warn("THREE.Color: Alpha component of "+_+" will be ignored.")}let ee;if(ee=/^(\w+)\(([^\)]*)\)/.exec(_)){let re;const ae=ee[1],xe=ee[2];switch(ae){case"rgb":case"rgba":if(re=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(xe))return $(re[4]),this.setRGB(Math.min(255,parseInt(re[1],10))/255,Math.min(255,parseInt(re[2],10))/255,Math.min(255,parseInt(re[3],10))/255,b);if(re=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(xe))return $(re[4]),this.setRGB(Math.min(100,parseInt(re[1],10))/100,Math.min(100,parseInt(re[2],10))/100,Math.min(100,parseInt(re[3],10))/100,b);break;case"hsl":case"hsla":if(re=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(xe))return $(re[4]),this.setHSL(parseFloat(re[1])/360,parseFloat(re[2])/100,parseFloat(re[3])/100,b);break;default:console.warn("THREE.Color: Unknown color model "+_)}}else if(ee=/^\#([A-Fa-f\d]+)$/.exec(_)){const re=ee[1],ae=re.length;if(ae===3)return this.setRGB(parseInt(re.charAt(0),16)/15,parseInt(re.charAt(1),16)/15,parseInt(re.charAt(2),16)/15,b);if(ae===6)return this.setHex(parseInt(re,16),b);console.warn("THREE.Color: Invalid hex color "+_)}else if(_&&_.length>0)return this.setColorName(_,b);return this}setColorName(_,b=SRGBColorSpace$1){const $=_colorKeywords$1[_.toLowerCase()];return $!==void 0?this.setHex($,b):console.warn("THREE.Color: Unknown color "+_),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(_){return this.r=_.r,this.g=_.g,this.b=_.b,this}copySRGBToLinear(_){return this.r=SRGBToLinear$1(_.r),this.g=SRGBToLinear$1(_.g),this.b=SRGBToLinear$1(_.b),this}copyLinearToSRGB(_){return this.r=LinearToSRGB$1(_.r),this.g=LinearToSRGB$1(_.g),this.b=LinearToSRGB$1(_.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(_=SRGBColorSpace$1){return ColorManagement$1.fromWorkingColorSpace(_color$1.copy(this),_),Math.round(clamp$1(_color$1.r*255,0,255))*65536+Math.round(clamp$1(_color$1.g*255,0,255))*256+Math.round(clamp$1(_color$1.b*255,0,255))}getHexString(_=SRGBColorSpace$1){return("000000"+this.getHex(_).toString(16)).slice(-6)}getHSL(_,b=ColorManagement$1.workingColorSpace){ColorManagement$1.fromWorkingColorSpace(_color$1.copy(this),b);const $=_color$1.r,ee=_color$1.g,re=_color$1.b,ae=Math.max($,ee,re),xe=Math.min($,ee,re);let le,fe;const ve=(xe+ae)/2;if(xe===ae)le=0,fe=0;else{const Se=ae-xe;switch(fe=ve<=.5?Se/(ae+xe):Se/(2-ae-xe),ae){case $:le=(ee-re)/Se+(ee<re?6:0);break;case ee:le=(re-$)/Se+2;break;case re:le=($-ee)/Se+4;break}le/=6}return _.h=le,_.s=fe,_.l=ve,_}getRGB(_,b=ColorManagement$1.workingColorSpace){return ColorManagement$1.fromWorkingColorSpace(_color$1.copy(this),b),_.r=_color$1.r,_.g=_color$1.g,_.b=_color$1.b,_}getStyle(_=SRGBColorSpace$1){ColorManagement$1.fromWorkingColorSpace(_color$1.copy(this),_);const b=_color$1.r,$=_color$1.g,ee=_color$1.b;return _!==SRGBColorSpace$1?`color(${_} ${b.toFixed(3)} ${$.toFixed(3)} ${ee.toFixed(3)})`:`rgb(${Math.round(b*255)},${Math.round($*255)},${Math.round(ee*255)})`}offsetHSL(_,b,$){return this.getHSL(_hslA$1),this.setHSL(_hslA$1.h+_,_hslA$1.s+b,_hslA$1.l+$)}add(_){return this.r+=_.r,this.g+=_.g,this.b+=_.b,this}addColors(_,b){return this.r=_.r+b.r,this.g=_.g+b.g,this.b=_.b+b.b,this}addScalar(_){return this.r+=_,this.g+=_,this.b+=_,this}sub(_){return this.r=Math.max(0,this.r-_.r),this.g=Math.max(0,this.g-_.g),this.b=Math.max(0,this.b-_.b),this}multiply(_){return this.r*=_.r,this.g*=_.g,this.b*=_.b,this}multiplyScalar(_){return this.r*=_,this.g*=_,this.b*=_,this}lerp(_,b){return this.r+=(_.r-this.r)*b,this.g+=(_.g-this.g)*b,this.b+=(_.b-this.b)*b,this}lerpColors(_,b,$){return this.r=_.r+(b.r-_.r)*$,this.g=_.g+(b.g-_.g)*$,this.b=_.b+(b.b-_.b)*$,this}lerpHSL(_,b){this.getHSL(_hslA$1),_.getHSL(_hslB$1);const $=lerp$1(_hslA$1.h,_hslB$1.h,b),ee=lerp$1(_hslA$1.s,_hslB$1.s,b),re=lerp$1(_hslA$1.l,_hslB$1.l,b);return this.setHSL($,ee,re),this}setFromVector3(_){return this.r=_.x,this.g=_.y,this.b=_.z,this}applyMatrix3(_){const b=this.r,$=this.g,ee=this.b,re=_.elements;return this.r=re[0]*b+re[3]*$+re[6]*ee,this.g=re[1]*b+re[4]*$+re[7]*ee,this.b=re[2]*b+re[5]*$+re[8]*ee,this}equals(_){return _.r===this.r&&_.g===this.g&&_.b===this.b}fromArray(_,b=0){return this.r=_[b],this.g=_[b+1],this.b=_[b+2],this}toArray(_=[],b=0){return _[b]=this.r,_[b+1]=this.g,_[b+2]=this.b,_}fromBufferAttribute(_,b){return this.r=_.getX(b),this.g=_.getY(b),this.b=_.getZ(b),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const _color$1=new Color$1;Color$1.NAMES=_colorKeywords$1;let Quaternion$1=class{constructor(_=0,b=0,$=0,ee=1){this.isQuaternion=!0,this._x=_,this._y=b,this._z=$,this._w=ee}static slerpFlat(_,b,$,ee,re,ae,xe){let le=$[ee+0],fe=$[ee+1],ve=$[ee+2],Se=$[ee+3];const Ee=re[ae+0],Ce=re[ae+1],Ie=re[ae+2],De=re[ae+3];if(xe===0){_[b+0]=le,_[b+1]=fe,_[b+2]=ve,_[b+3]=Se;return}if(xe===1){_[b+0]=Ee,_[b+1]=Ce,_[b+2]=Ie,_[b+3]=De;return}if(Se!==De||le!==Ee||fe!==Ce||ve!==Ie){let Be=1-xe;const Ne=le*Ee+fe*Ce+ve*Ie+Se*De,qe=Ne>=0?1:-1,Xe=1-Ne*Ne;if(Xe>Number.EPSILON){const Qe=Math.sqrt(Xe),rt=Math.atan2(Qe,Ne*qe);Be=Math.sin(Be*rt)/Qe,xe=Math.sin(xe*rt)/Qe}const Ye=xe*qe;if(le=le*Be+Ee*Ye,fe=fe*Be+Ce*Ye,ve=ve*Be+Ie*Ye,Se=Se*Be+De*Ye,Be===1-xe){const Qe=1/Math.sqrt(le*le+fe*fe+ve*ve+Se*Se);le*=Qe,fe*=Qe,ve*=Qe,Se*=Qe}}_[b]=le,_[b+1]=fe,_[b+2]=ve,_[b+3]=Se}static multiplyQuaternionsFlat(_,b,$,ee,re,ae){const xe=$[ee],le=$[ee+1],fe=$[ee+2],ve=$[ee+3],Se=re[ae],Ee=re[ae+1],Ce=re[ae+2],Ie=re[ae+3];return _[b]=xe*Ie+ve*Se+le*Ce-fe*Ee,_[b+1]=le*Ie+ve*Ee+fe*Se-xe*Ce,_[b+2]=fe*Ie+ve*Ce+xe*Ee-le*Se,_[b+3]=ve*Ie-xe*Se-le*Ee-fe*Ce,_}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get w(){return this._w}set w(_){this._w=_,this._onChangeCallback()}set(_,b,$,ee){return this._x=_,this._y=b,this._z=$,this._w=ee,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(_){return this._x=_.x,this._y=_.y,this._z=_.z,this._w=_.w,this._onChangeCallback(),this}setFromEuler(_,b=!0){const $=_._x,ee=_._y,re=_._z,ae=_._order,xe=Math.cos,le=Math.sin,fe=xe($/2),ve=xe(ee/2),Se=xe(re/2),Ee=le($/2),Ce=le(ee/2),Ie=le(re/2);switch(ae){case"XYZ":this._x=Ee*ve*Se+fe*Ce*Ie,this._y=fe*Ce*Se-Ee*ve*Ie,this._z=fe*ve*Ie+Ee*Ce*Se,this._w=fe*ve*Se-Ee*Ce*Ie;break;case"YXZ":this._x=Ee*ve*Se+fe*Ce*Ie,this._y=fe*Ce*Se-Ee*ve*Ie,this._z=fe*ve*Ie-Ee*Ce*Se,this._w=fe*ve*Se+Ee*Ce*Ie;break;case"ZXY":this._x=Ee*ve*Se-fe*Ce*Ie,this._y=fe*Ce*Se+Ee*ve*Ie,this._z=fe*ve*Ie+Ee*Ce*Se,this._w=fe*ve*Se-Ee*Ce*Ie;break;case"ZYX":this._x=Ee*ve*Se-fe*Ce*Ie,this._y=fe*Ce*Se+Ee*ve*Ie,this._z=fe*ve*Ie-Ee*Ce*Se,this._w=fe*ve*Se+Ee*Ce*Ie;break;case"YZX":this._x=Ee*ve*Se+fe*Ce*Ie,this._y=fe*Ce*Se+Ee*ve*Ie,this._z=fe*ve*Ie-Ee*Ce*Se,this._w=fe*ve*Se-Ee*Ce*Ie;break;case"XZY":this._x=Ee*ve*Se-fe*Ce*Ie,this._y=fe*Ce*Se-Ee*ve*Ie,this._z=fe*ve*Ie+Ee*Ce*Se,this._w=fe*ve*Se+Ee*Ce*Ie;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+ae)}return b===!0&&this._onChangeCallback(),this}setFromAxisAngle(_,b){const $=b/2,ee=Math.sin($);return this._x=_.x*ee,this._y=_.y*ee,this._z=_.z*ee,this._w=Math.cos($),this._onChangeCallback(),this}setFromRotationMatrix(_){const b=_.elements,$=b[0],ee=b[4],re=b[8],ae=b[1],xe=b[5],le=b[9],fe=b[2],ve=b[6],Se=b[10],Ee=$+xe+Se;if(Ee>0){const Ce=.5/Math.sqrt(Ee+1);this._w=.25/Ce,this._x=(ve-le)*Ce,this._y=(re-fe)*Ce,this._z=(ae-ee)*Ce}else if($>xe&&$>Se){const Ce=2*Math.sqrt(1+$-xe-Se);this._w=(ve-le)/Ce,this._x=.25*Ce,this._y=(ee+ae)/Ce,this._z=(re+fe)/Ce}else if(xe>Se){const Ce=2*Math.sqrt(1+xe-$-Se);this._w=(re-fe)/Ce,this._x=(ee+ae)/Ce,this._y=.25*Ce,this._z=(le+ve)/Ce}else{const Ce=2*Math.sqrt(1+Se-$-xe);this._w=(ae-ee)/Ce,this._x=(re+fe)/Ce,this._y=(le+ve)/Ce,this._z=.25*Ce}return this._onChangeCallback(),this}setFromUnitVectors(_,b){let $=_.dot(b)+1;return $<Number.EPSILON?($=0,Math.abs(_.x)>Math.abs(_.z)?(this._x=-_.y,this._y=_.x,this._z=0,this._w=$):(this._x=0,this._y=-_.z,this._z=_.y,this._w=$)):(this._x=_.y*b.z-_.z*b.y,this._y=_.z*b.x-_.x*b.z,this._z=_.x*b.y-_.y*b.x,this._w=$),this.normalize()}angleTo(_){return 2*Math.acos(Math.abs(clamp$1(this.dot(_),-1,1)))}rotateTowards(_,b){const $=this.angleTo(_);if($===0)return this;const ee=Math.min(1,b/$);return this.slerp(_,ee),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(_){return this._x*_._x+this._y*_._y+this._z*_._z+this._w*_._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let _=this.length();return _===0?(this._x=0,this._y=0,this._z=0,this._w=1):(_=1/_,this._x=this._x*_,this._y=this._y*_,this._z=this._z*_,this._w=this._w*_),this._onChangeCallback(),this}multiply(_){return this.multiplyQuaternions(this,_)}premultiply(_){return this.multiplyQuaternions(_,this)}multiplyQuaternions(_,b){const $=_._x,ee=_._y,re=_._z,ae=_._w,xe=b._x,le=b._y,fe=b._z,ve=b._w;return this._x=$*ve+ae*xe+ee*fe-re*le,this._y=ee*ve+ae*le+re*xe-$*fe,this._z=re*ve+ae*fe+$*le-ee*xe,this._w=ae*ve-$*xe-ee*le-re*fe,this._onChangeCallback(),this}slerp(_,b){if(b===0)return this;if(b===1)return this.copy(_);const $=this._x,ee=this._y,re=this._z,ae=this._w;let xe=ae*_._w+$*_._x+ee*_._y+re*_._z;if(xe<0?(this._w=-_._w,this._x=-_._x,this._y=-_._y,this._z=-_._z,xe=-xe):this.copy(_),xe>=1)return this._w=ae,this._x=$,this._y=ee,this._z=re,this;const le=1-xe*xe;if(le<=Number.EPSILON){const Ce=1-b;return this._w=Ce*ae+b*this._w,this._x=Ce*$+b*this._x,this._y=Ce*ee+b*this._y,this._z=Ce*re+b*this._z,this.normalize(),this}const fe=Math.sqrt(le),ve=Math.atan2(fe,xe),Se=Math.sin((1-b)*ve)/fe,Ee=Math.sin(b*ve)/fe;return this._w=ae*Se+this._w*Ee,this._x=$*Se+this._x*Ee,this._y=ee*Se+this._y*Ee,this._z=re*Se+this._z*Ee,this._onChangeCallback(),this}slerpQuaternions(_,b,$){return this.copy(_).slerp(b,$)}random(){const _=2*Math.PI*Math.random(),b=2*Math.PI*Math.random(),$=Math.random(),ee=Math.sqrt(1-$),re=Math.sqrt($);return this.set(ee*Math.sin(_),ee*Math.cos(_),re*Math.sin(b),re*Math.cos(b))}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._w===this._w}fromArray(_,b=0){return this._x=_[b],this._y=_[b+1],this._z=_[b+2],this._w=_[b+3],this._onChangeCallback(),this}toArray(_=[],b=0){return _[b]=this._x,_[b+1]=this._y,_[b+2]=this._z,_[b+3]=this._w,_}fromBufferAttribute(_,b){return this._x=_.getX(b),this._y=_.getY(b),this._z=_.getZ(b),this._w=_.getW(b),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},Vector3$1=class Mp{constructor(_=0,b=0,$=0){Mp.prototype.isVector3=!0,this.x=_,this.y=b,this.z=$}set(_,b,$){return $===void 0&&($=this.z),this.x=_,this.y=b,this.z=$,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setComponent(_,b){switch(_){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this}addVectors(_,b){return this.x=_.x+b.x,this.y=_.y+b.y,this.z=_.z+b.z,this}addScaledVector(_,b){return this.x+=_.x*b,this.y+=_.y*b,this.z+=_.z*b,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this}subVectors(_,b){return this.x=_.x-b.x,this.y=_.y-b.y,this.z=_.z-b.z,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this}multiplyVectors(_,b){return this.x=_.x*b.x,this.y=_.y*b.y,this.z=_.z*b.z,this}applyEuler(_){return this.applyQuaternion(_quaternion$5.setFromEuler(_))}applyAxisAngle(_,b){return this.applyQuaternion(_quaternion$5.setFromAxisAngle(_,b))}applyMatrix3(_){const b=this.x,$=this.y,ee=this.z,re=_.elements;return this.x=re[0]*b+re[3]*$+re[6]*ee,this.y=re[1]*b+re[4]*$+re[7]*ee,this.z=re[2]*b+re[5]*$+re[8]*ee,this}applyNormalMatrix(_){return this.applyMatrix3(_).normalize()}applyMatrix4(_){const b=this.x,$=this.y,ee=this.z,re=_.elements,ae=1/(re[3]*b+re[7]*$+re[11]*ee+re[15]);return this.x=(re[0]*b+re[4]*$+re[8]*ee+re[12])*ae,this.y=(re[1]*b+re[5]*$+re[9]*ee+re[13])*ae,this.z=(re[2]*b+re[6]*$+re[10]*ee+re[14])*ae,this}applyQuaternion(_){const b=this.x,$=this.y,ee=this.z,re=_.x,ae=_.y,xe=_.z,le=_.w,fe=2*(ae*ee-xe*$),ve=2*(xe*b-re*ee),Se=2*(re*$-ae*b);return this.x=b+le*fe+ae*Se-xe*ve,this.y=$+le*ve+xe*fe-re*Se,this.z=ee+le*Se+re*ve-ae*fe,this}project(_){return this.applyMatrix4(_.matrixWorldInverse).applyMatrix4(_.projectionMatrix)}unproject(_){return this.applyMatrix4(_.projectionMatrixInverse).applyMatrix4(_.matrixWorld)}transformDirection(_){const b=this.x,$=this.y,ee=this.z,re=_.elements;return this.x=re[0]*b+re[4]*$+re[8]*ee,this.y=re[1]*b+re[5]*$+re[9]*ee,this.z=re[2]*b+re[6]*$+re[10]*ee,this.normalize()}divide(_){return this.x/=_.x,this.y/=_.y,this.z/=_.z,this}divideScalar(_){return this.multiplyScalar(1/_)}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this}clamp(_,b){return this.x=Math.max(_.x,Math.min(b.x,this.x)),this.y=Math.max(_.y,Math.min(b.y,this.y)),this.z=Math.max(_.z,Math.min(b.z,this.z)),this}clampScalar(_,b){return this.x=Math.max(_,Math.min(b,this.x)),this.y=Math.max(_,Math.min(b,this.y)),this.z=Math.max(_,Math.min(b,this.z)),this}clampLength(_,b){const $=this.length();return this.divideScalar($||1).multiplyScalar(Math.max(_,Math.min(b,$)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,b){return this.x+=(_.x-this.x)*b,this.y+=(_.y-this.y)*b,this.z+=(_.z-this.z)*b,this}lerpVectors(_,b,$){return this.x=_.x+(b.x-_.x)*$,this.y=_.y+(b.y-_.y)*$,this.z=_.z+(b.z-_.z)*$,this}cross(_){return this.crossVectors(this,_)}crossVectors(_,b){const $=_.x,ee=_.y,re=_.z,ae=b.x,xe=b.y,le=b.z;return this.x=ee*le-re*xe,this.y=re*ae-$*le,this.z=$*xe-ee*ae,this}projectOnVector(_){const b=_.lengthSq();if(b===0)return this.set(0,0,0);const $=_.dot(this)/b;return this.copy(_).multiplyScalar($)}projectOnPlane(_){return _vector$5.copy(this).projectOnVector(_),this.sub(_vector$5)}reflect(_){return this.sub(_vector$5.copy(_).multiplyScalar(2*this.dot(_)))}angleTo(_){const b=Math.sqrt(this.lengthSq()*_.lengthSq());if(b===0)return Math.PI/2;const $=this.dot(_)/b;return Math.acos(clamp$1($,-1,1))}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const b=this.x-_.x,$=this.y-_.y,ee=this.z-_.z;return b*b+$*$+ee*ee}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)+Math.abs(this.z-_.z)}setFromSpherical(_){return this.setFromSphericalCoords(_.radius,_.phi,_.theta)}setFromSphericalCoords(_,b,$){const ee=Math.sin(b)*_;return this.x=ee*Math.sin($),this.y=Math.cos(b)*_,this.z=ee*Math.cos($),this}setFromCylindrical(_){return this.setFromCylindricalCoords(_.radius,_.theta,_.y)}setFromCylindricalCoords(_,b,$){return this.x=_*Math.sin(b),this.y=$,this.z=_*Math.cos(b),this}setFromMatrixPosition(_){const b=_.elements;return this.x=b[12],this.y=b[13],this.z=b[14],this}setFromMatrixScale(_){const b=this.setFromMatrixColumn(_,0).length(),$=this.setFromMatrixColumn(_,1).length(),ee=this.setFromMatrixColumn(_,2).length();return this.x=b,this.y=$,this.z=ee,this}setFromMatrixColumn(_,b){return this.fromArray(_.elements,b*4)}setFromMatrix3Column(_,b){return this.fromArray(_.elements,b*3)}setFromEuler(_){return this.x=_._x,this.y=_._y,this.z=_._z,this}setFromColor(_){return this.x=_.r,this.y=_.g,this.z=_.b,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z}fromArray(_,b=0){return this.x=_[b],this.y=_[b+1],this.z=_[b+2],this}toArray(_=[],b=0){return _[b]=this.x,_[b+1]=this.y,_[b+2]=this.z,_}fromBufferAttribute(_,b){return this.x=_.getX(b),this.y=_.getY(b),this.z=_.getZ(b),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const _=Math.random()*Math.PI*2,b=Math.random()*2-1,$=Math.sqrt(1-b*b);return this.x=$*Math.cos(_),this.y=b,this.z=$*Math.sin(_),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const _vector$5=new Vector3$1,_quaternion$5=new Quaternion$1;let Box3$1=class{constructor(_=new Vector3$1(1/0,1/0,1/0),b=new Vector3$1(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=_,this.max=b}set(_,b){return this.min.copy(_),this.max.copy(b),this}setFromArray(_){this.makeEmpty();for(let b=0,$=_.length;b<$;b+=3)this.expandByPoint(_vector$4.fromArray(_,b));return this}setFromBufferAttribute(_){this.makeEmpty();for(let b=0,$=_.count;b<$;b++)this.expandByPoint(_vector$4.fromBufferAttribute(_,b));return this}setFromPoints(_){this.makeEmpty();for(let b=0,$=_.length;b<$;b++)this.expandByPoint(_[b]);return this}setFromCenterAndSize(_,b){const $=_vector$4.copy(b).multiplyScalar(.5);return this.min.copy(_).sub($),this.max.copy(_).add($),this}setFromObject(_,b=!1){return this.makeEmpty(),this.expandByObject(_,b)}clone(){return new this.constructor().copy(this)}copy(_){return this.min.copy(_.min),this.max.copy(_.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(_){return this.isEmpty()?_.set(0,0,0):_.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_){return this.isEmpty()?_.set(0,0,0):_.subVectors(this.max,this.min)}expandByPoint(_){return this.min.min(_),this.max.max(_),this}expandByVector(_){return this.min.sub(_),this.max.add(_),this}expandByScalar(_){return this.min.addScalar(-_),this.max.addScalar(_),this}expandByObject(_,b=!1){_.updateWorldMatrix(!1,!1);const $=_.geometry;if($!==void 0){const re=$.getAttribute("position");if(b===!0&&re!==void 0&&_.isInstancedMesh!==!0)for(let ae=0,xe=re.count;ae<xe;ae++)_.isMesh===!0?_.getVertexPosition(ae,_vector$4):_vector$4.fromBufferAttribute(re,ae),_vector$4.applyMatrix4(_.matrixWorld),this.expandByPoint(_vector$4);else _.boundingBox!==void 0?(_.boundingBox===null&&_.computeBoundingBox(),_box$5.copy(_.boundingBox)):($.boundingBox===null&&$.computeBoundingBox(),_box$5.copy($.boundingBox)),_box$5.applyMatrix4(_.matrixWorld),this.union(_box$5)}const ee=_.children;for(let re=0,ae=ee.length;re<ae;re++)this.expandByObject(ee[re],b);return this}containsPoint(_){return _.x>=this.min.x&&_.x<=this.max.x&&_.y>=this.min.y&&_.y<=this.max.y&&_.z>=this.min.z&&_.z<=this.max.z}containsBox(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y&&this.min.z<=_.min.z&&_.max.z<=this.max.z}getParameter(_,b){return b.set((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y),(_.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(_){return _.max.x>=this.min.x&&_.min.x<=this.max.x&&_.max.y>=this.min.y&&_.min.y<=this.max.y&&_.max.z>=this.min.z&&_.min.z<=this.max.z}intersectsSphere(_){return this.clampPoint(_.center,_vector$4),_vector$4.distanceToSquared(_.center)<=_.radius*_.radius}intersectsPlane(_){let b,$;return _.normal.x>0?(b=_.normal.x*this.min.x,$=_.normal.x*this.max.x):(b=_.normal.x*this.max.x,$=_.normal.x*this.min.x),_.normal.y>0?(b+=_.normal.y*this.min.y,$+=_.normal.y*this.max.y):(b+=_.normal.y*this.max.y,$+=_.normal.y*this.min.y),_.normal.z>0?(b+=_.normal.z*this.min.z,$+=_.normal.z*this.max.z):(b+=_.normal.z*this.max.z,$+=_.normal.z*this.min.z),b<=-_.constant&&$>=-_.constant}intersectsTriangle(_){if(this.isEmpty())return!1;this.getCenter(_center$1),_extents$1.subVectors(this.max,_center$1),_v0$4.subVectors(_.a,_center$1),_v1$9.subVectors(_.b,_center$1),_v2$5.subVectors(_.c,_center$1),_f0$1.subVectors(_v1$9,_v0$4),_f1$1.subVectors(_v2$5,_v1$9),_f2$1.subVectors(_v0$4,_v2$5);let b=[0,-_f0$1.z,_f0$1.y,0,-_f1$1.z,_f1$1.y,0,-_f2$1.z,_f2$1.y,_f0$1.z,0,-_f0$1.x,_f1$1.z,0,-_f1$1.x,_f2$1.z,0,-_f2$1.x,-_f0$1.y,_f0$1.x,0,-_f1$1.y,_f1$1.x,0,-_f2$1.y,_f2$1.x,0];return!satForAxes$1(b,_v0$4,_v1$9,_v2$5,_extents$1)||(b=[1,0,0,0,1,0,0,0,1],!satForAxes$1(b,_v0$4,_v1$9,_v2$5,_extents$1))?!1:(_triangleNormal$1.crossVectors(_f0$1,_f1$1),b=[_triangleNormal$1.x,_triangleNormal$1.y,_triangleNormal$1.z],satForAxes$1(b,_v0$4,_v1$9,_v2$5,_extents$1))}clampPoint(_,b){return b.copy(_).clamp(this.min,this.max)}distanceToPoint(_){return this.clampPoint(_,_vector$4).distanceTo(_)}getBoundingSphere(_){return this.isEmpty()?_.makeEmpty():(this.getCenter(_.center),_.radius=this.getSize(_vector$4).length()*.5),_}intersect(_){return this.min.max(_.min),this.max.min(_.max),this.isEmpty()&&this.makeEmpty(),this}union(_){return this.min.min(_.min),this.max.max(_.max),this}applyMatrix4(_){return this.isEmpty()?this:(_points$1[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(_),_points$1[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(_),_points$1[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(_),_points$1[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(_),_points$1[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(_),_points$1[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(_),_points$1[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(_),_points$1[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(_),this.setFromPoints(_points$1),this)}translate(_){return this.min.add(_),this.max.add(_),this}equals(_){return _.min.equals(this.min)&&_.max.equals(this.max)}};const _points$1=[new Vector3$1,new Vector3$1,new Vector3$1,new Vector3$1,new Vector3$1,new Vector3$1,new Vector3$1,new Vector3$1],_vector$4=new Vector3$1,_box$5=new Box3$1,_v0$4=new Vector3$1,_v1$9=new Vector3$1,_v2$5=new Vector3$1,_f0$1=new Vector3$1,_f1$1=new Vector3$1,_f2$1=new Vector3$1,_center$1=new Vector3$1,_extents$1=new Vector3$1,_triangleNormal$1=new Vector3$1,_testAxis$1=new Vector3$1;function satForAxes$1(H,_,b,$,ee){for(let re=0,ae=H.length-3;re<=ae;re+=3){_testAxis$1.fromArray(H,re);const xe=ee.x*Math.abs(_testAxis$1.x)+ee.y*Math.abs(_testAxis$1.y)+ee.z*Math.abs(_testAxis$1.z),le=_.dot(_testAxis$1),fe=b.dot(_testAxis$1),ve=$.dot(_testAxis$1);if(Math.max(-Math.max(le,fe,ve),Math.min(le,fe,ve))>xe)return!1}return!0}const _box$1=new Box3$1,_v1$8=new Vector3$1,_v2$1=new Vector3$1;let Sphere$1=class{constructor(_=new Vector3$1,b=-1){this.isSphere=!0,this.center=_,this.radius=b}set(_,b){return this.center.copy(_),this.radius=b,this}setFromPoints(_,b){const $=this.center;b!==void 0?$.copy(b):_box$1.setFromPoints(_).getCenter($);let ee=0;for(let re=0,ae=_.length;re<ae;re++)ee=Math.max(ee,$.distanceToSquared(_[re]));return this.radius=Math.sqrt(ee),this}copy(_){return this.center.copy(_.center),this.radius=_.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(_){return _.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(_){return _.distanceTo(this.center)-this.radius}intersectsSphere(_){const b=this.radius+_.radius;return _.center.distanceToSquared(this.center)<=b*b}intersectsBox(_){return _.intersectsSphere(this)}intersectsPlane(_){return Math.abs(_.distanceToPoint(this.center))<=this.radius}clampPoint(_,b){const $=this.center.distanceToSquared(_);return b.copy(_),$>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center)),b}getBoundingBox(_){return this.isEmpty()?(_.makeEmpty(),_):(_.set(this.center,this.center),_.expandByScalar(this.radius),_)}applyMatrix4(_){return this.center.applyMatrix4(_),this.radius=this.radius*_.getMaxScaleOnAxis(),this}translate(_){return this.center.add(_),this}expandByPoint(_){if(this.isEmpty())return this.center.copy(_),this.radius=0,this;_v1$8.subVectors(_,this.center);const b=_v1$8.lengthSq();if(b>this.radius*this.radius){const $=Math.sqrt(b),ee=($-this.radius)*.5;this.center.addScaledVector(_v1$8,ee/$),this.radius+=ee}return this}union(_){return _.isEmpty()?this:this.isEmpty()?(this.copy(_),this):(this.center.equals(_.center)===!0?this.radius=Math.max(this.radius,_.radius):(_v2$1.subVectors(_.center,this.center).setLength(_.radius),this.expandByPoint(_v1$8.copy(_.center).add(_v2$1)),this.expandByPoint(_v1$8.copy(_.center).sub(_v2$1))),this)}equals(_){return _.center.equals(this.center)&&_.radius===this.radius}clone(){return new this.constructor().copy(this)}};const _vector1$1=new Vector3$1,_vector2$3=new Vector3$1,_normalMatrix$1=new Matrix3$1;let Plane$1=class{constructor(_=new Vector3$1(1,0,0),b=0){this.isPlane=!0,this.normal=_,this.constant=b}set(_,b){return this.normal.copy(_),this.constant=b,this}setComponents(_,b,$,ee){return this.normal.set(_,b,$),this.constant=ee,this}setFromNormalAndCoplanarPoint(_,b){return this.normal.copy(_),this.constant=-b.dot(this.normal),this}setFromCoplanarPoints(_,b,$){const ee=_vector1$1.subVectors($,b).cross(_vector2$3.subVectors(_,b)).normalize();return this.setFromNormalAndCoplanarPoint(ee,_),this}copy(_){return this.normal.copy(_.normal),this.constant=_.constant,this}normalize(){const _=1/this.normal.length();return this.normal.multiplyScalar(_),this.constant*=_,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(_){return this.normal.dot(_)+this.constant}distanceToSphere(_){return this.distanceToPoint(_.center)-_.radius}projectPoint(_,b){return b.copy(_).addScaledVector(this.normal,-this.distanceToPoint(_))}intersectLine(_,b){const $=_.delta(_vector1$1),ee=this.normal.dot($);if(ee===0)return this.distanceToPoint(_.start)===0?b.copy(_.start):null;const re=-(_.start.dot(this.normal)+this.constant)/ee;return re<0||re>1?null:b.copy(_.start).addScaledVector($,re)}intersectsLine(_){const b=this.distanceToPoint(_.start),$=this.distanceToPoint(_.end);return b<0&&$>0||$<0&&b>0}intersectsBox(_){return _.intersectsPlane(this)}intersectsSphere(_){return _.intersectsPlane(this)}coplanarPoint(_){return _.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(_,b){const $=b||_normalMatrix$1.getNormalMatrix(_),ee=this.coplanarPoint(_vector1$1).applyMatrix4(_),re=this.normal.applyMatrix3($).normalize();return this.constant=-ee.dot(re),this}translate(_){return this.constant-=_.dot(this.normal),this}equals(_){return _.normal.equals(this.normal)&&_.constant===this.constant}clone(){return new this.constructor().copy(this)}};const _sphere$7=new Sphere$1,_vector$3=new Vector3$1;let Frustum$1=class{constructor(_=new Plane$1,b=new Plane$1,$=new Plane$1,ee=new Plane$1,re=new Plane$1,ae=new Plane$1){this.planes=[_,b,$,ee,re,ae]}set(_,b,$,ee,re,ae){const xe=this.planes;return xe[0].copy(_),xe[1].copy(b),xe[2].copy($),xe[3].copy(ee),xe[4].copy(re),xe[5].copy(ae),this}copy(_){const b=this.planes;for(let $=0;$<6;$++)b[$].copy(_.planes[$]);return this}setFromProjectionMatrix(_,b=WebGLCoordinateSystem$1){const $=this.planes,ee=_.elements,re=ee[0],ae=ee[1],xe=ee[2],le=ee[3],fe=ee[4],ve=ee[5],Se=ee[6],Ee=ee[7],Ce=ee[8],Ie=ee[9],De=ee[10],Be=ee[11],Ne=ee[12],qe=ee[13],Xe=ee[14],Ye=ee[15];if($[0].setComponents(le-re,Ee-fe,Be-Ce,Ye-Ne).normalize(),$[1].setComponents(le+re,Ee+fe,Be+Ce,Ye+Ne).normalize(),$[2].setComponents(le+ae,Ee+ve,Be+Ie,Ye+qe).normalize(),$[3].setComponents(le-ae,Ee-ve,Be-Ie,Ye-qe).normalize(),$[4].setComponents(le-xe,Ee-Se,Be-De,Ye-Xe).normalize(),b===WebGLCoordinateSystem$1)$[5].setComponents(le+xe,Ee+Se,Be+De,Ye+Xe).normalize();else if(b===WebGPUCoordinateSystem$1)$[5].setComponents(xe,Se,De,Xe).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+b);return this}intersectsObject(_){if(_.boundingSphere!==void 0)_.boundingSphere===null&&_.computeBoundingSphere(),_sphere$7.copy(_.boundingSphere).applyMatrix4(_.matrixWorld);else{const b=_.geometry;b.boundingSphere===null&&b.computeBoundingSphere(),_sphere$7.copy(b.boundingSphere).applyMatrix4(_.matrixWorld)}return this.intersectsSphere(_sphere$7)}intersectsSprite(_){return _sphere$7.center.set(0,0,0),_sphere$7.radius=.7071067811865476,_sphere$7.applyMatrix4(_.matrixWorld),this.intersectsSphere(_sphere$7)}intersectsSphere(_){const b=this.planes,$=_.center,ee=-_.radius;for(let re=0;re<6;re++)if(b[re].distanceToPoint($)<ee)return!1;return!0}intersectsBox(_){const b=this.planes;for(let $=0;$<6;$++){const ee=b[$];if(_vector$3.x=ee.normal.x>0?_.max.x:_.min.x,_vector$3.y=ee.normal.y>0?_.max.y:_.min.y,_vector$3.z=ee.normal.z>0?_.max.z:_.min.z,ee.distanceToPoint(_vector$3)<0)return!1}return!0}containsPoint(_){const b=this.planes;for(let $=0;$<6;$++)if(b[$].distanceToPoint(_)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},Matrix4$1=class zh{constructor(_,b,$,ee,re,ae,xe,le,fe,ve,Se,Ee,Ce,Ie,De,Be){zh.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_!==void 0&&this.set(_,b,$,ee,re,ae,xe,le,fe,ve,Se,Ee,Ce,Ie,De,Be)}set(_,b,$,ee,re,ae,xe,le,fe,ve,Se,Ee,Ce,Ie,De,Be){const Ne=this.elements;return Ne[0]=_,Ne[4]=b,Ne[8]=$,Ne[12]=ee,Ne[1]=re,Ne[5]=ae,Ne[9]=xe,Ne[13]=le,Ne[2]=fe,Ne[6]=ve,Ne[10]=Se,Ne[14]=Ee,Ne[3]=Ce,Ne[7]=Ie,Ne[11]=De,Ne[15]=Be,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new zh().fromArray(this.elements)}copy(_){const b=this.elements,$=_.elements;return b[0]=$[0],b[1]=$[1],b[2]=$[2],b[3]=$[3],b[4]=$[4],b[5]=$[5],b[6]=$[6],b[7]=$[7],b[8]=$[8],b[9]=$[9],b[10]=$[10],b[11]=$[11],b[12]=$[12],b[13]=$[13],b[14]=$[14],b[15]=$[15],this}copyPosition(_){const b=this.elements,$=_.elements;return b[12]=$[12],b[13]=$[13],b[14]=$[14],this}setFromMatrix3(_){const b=_.elements;return this.set(b[0],b[3],b[6],0,b[1],b[4],b[7],0,b[2],b[5],b[8],0,0,0,0,1),this}extractBasis(_,b,$){return _.setFromMatrixColumn(this,0),b.setFromMatrixColumn(this,1),$.setFromMatrixColumn(this,2),this}makeBasis(_,b,$){return this.set(_.x,b.x,$.x,0,_.y,b.y,$.y,0,_.z,b.z,$.z,0,0,0,0,1),this}extractRotation(_){const b=this.elements,$=_.elements,ee=1/_v1$2.setFromMatrixColumn(_,0).length(),re=1/_v1$2.setFromMatrixColumn(_,1).length(),ae=1/_v1$2.setFromMatrixColumn(_,2).length();return b[0]=$[0]*ee,b[1]=$[1]*ee,b[2]=$[2]*ee,b[3]=0,b[4]=$[4]*re,b[5]=$[5]*re,b[6]=$[6]*re,b[7]=0,b[8]=$[8]*ae,b[9]=$[9]*ae,b[10]=$[10]*ae,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this}makeRotationFromEuler(_){const b=this.elements,$=_.x,ee=_.y,re=_.z,ae=Math.cos($),xe=Math.sin($),le=Math.cos(ee),fe=Math.sin(ee),ve=Math.cos(re),Se=Math.sin(re);if(_.order==="XYZ"){const Ee=ae*ve,Ce=ae*Se,Ie=xe*ve,De=xe*Se;b[0]=le*ve,b[4]=-le*Se,b[8]=fe,b[1]=Ce+Ie*fe,b[5]=Ee-De*fe,b[9]=-xe*le,b[2]=De-Ee*fe,b[6]=Ie+Ce*fe,b[10]=ae*le}else if(_.order==="YXZ"){const Ee=le*ve,Ce=le*Se,Ie=fe*ve,De=fe*Se;b[0]=Ee+De*xe,b[4]=Ie*xe-Ce,b[8]=ae*fe,b[1]=ae*Se,b[5]=ae*ve,b[9]=-xe,b[2]=Ce*xe-Ie,b[6]=De+Ee*xe,b[10]=ae*le}else if(_.order==="ZXY"){const Ee=le*ve,Ce=le*Se,Ie=fe*ve,De=fe*Se;b[0]=Ee-De*xe,b[4]=-ae*Se,b[8]=Ie+Ce*xe,b[1]=Ce+Ie*xe,b[5]=ae*ve,b[9]=De-Ee*xe,b[2]=-ae*fe,b[6]=xe,b[10]=ae*le}else if(_.order==="ZYX"){const Ee=ae*ve,Ce=ae*Se,Ie=xe*ve,De=xe*Se;b[0]=le*ve,b[4]=Ie*fe-Ce,b[8]=Ee*fe+De,b[1]=le*Se,b[5]=De*fe+Ee,b[9]=Ce*fe-Ie,b[2]=-fe,b[6]=xe*le,b[10]=ae*le}else if(_.order==="YZX"){const Ee=ae*le,Ce=ae*fe,Ie=xe*le,De=xe*fe;b[0]=le*ve,b[4]=De-Ee*Se,b[8]=Ie*Se+Ce,b[1]=Se,b[5]=ae*ve,b[9]=-xe*ve,b[2]=-fe*ve,b[6]=Ce*Se+Ie,b[10]=Ee-De*Se}else if(_.order==="XZY"){const Ee=ae*le,Ce=ae*fe,Ie=xe*le,De=xe*fe;b[0]=le*ve,b[4]=-Se,b[8]=fe*ve,b[1]=Ee*Se+De,b[5]=ae*ve,b[9]=Ce*Se-Ie,b[2]=Ie*Se-Ce,b[6]=xe*ve,b[10]=De*Se+Ee}return b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this}makeRotationFromQuaternion(_){return this.compose(_zero$1,_,_one$1)}lookAt(_,b,$){const ee=this.elements;return _z$1.subVectors(_,b),_z$1.lengthSq()===0&&(_z$1.z=1),_z$1.normalize(),_x$1.crossVectors($,_z$1),_x$1.lengthSq()===0&&(Math.abs($.z)===1?_z$1.x+=1e-4:_z$1.z+=1e-4,_z$1.normalize(),_x$1.crossVectors($,_z$1)),_x$1.normalize(),_y$1.crossVectors(_z$1,_x$1),ee[0]=_x$1.x,ee[4]=_y$1.x,ee[8]=_z$1.x,ee[1]=_x$1.y,ee[5]=_y$1.y,ee[9]=_z$1.y,ee[2]=_x$1.z,ee[6]=_y$1.z,ee[10]=_z$1.z,this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,b){const $=_.elements,ee=b.elements,re=this.elements,ae=$[0],xe=$[4],le=$[8],fe=$[12],ve=$[1],Se=$[5],Ee=$[9],Ce=$[13],Ie=$[2],De=$[6],Be=$[10],Ne=$[14],qe=$[3],Xe=$[7],Ye=$[11],Qe=$[15],rt=ee[0],ot=ee[4],ct=ee[8],mt=ee[12],_t=ee[1],Lt=ee[5],Vt=ee[9],Gt=ee[13],$t=ee[2],Qt=ee[6],vt=ee[10],It=ee[14],gt=ee[3],Tt=ee[7],Ct=ee[11],Ft=ee[15];return re[0]=ae*rt+xe*_t+le*$t+fe*gt,re[4]=ae*ot+xe*Lt+le*Qt+fe*Tt,re[8]=ae*ct+xe*Vt+le*vt+fe*Ct,re[12]=ae*mt+xe*Gt+le*It+fe*Ft,re[1]=ve*rt+Se*_t+Ee*$t+Ce*gt,re[5]=ve*ot+Se*Lt+Ee*Qt+Ce*Tt,re[9]=ve*ct+Se*Vt+Ee*vt+Ce*Ct,re[13]=ve*mt+Se*Gt+Ee*It+Ce*Ft,re[2]=Ie*rt+De*_t+Be*$t+Ne*gt,re[6]=Ie*ot+De*Lt+Be*Qt+Ne*Tt,re[10]=Ie*ct+De*Vt+Be*vt+Ne*Ct,re[14]=Ie*mt+De*Gt+Be*It+Ne*Ft,re[3]=qe*rt+Xe*_t+Ye*$t+Qe*gt,re[7]=qe*ot+Xe*Lt+Ye*Qt+Qe*Tt,re[11]=qe*ct+Xe*Vt+Ye*vt+Qe*Ct,re[15]=qe*mt+Xe*Gt+Ye*It+Qe*Ft,this}multiplyScalar(_){const b=this.elements;return b[0]*=_,b[4]*=_,b[8]*=_,b[12]*=_,b[1]*=_,b[5]*=_,b[9]*=_,b[13]*=_,b[2]*=_,b[6]*=_,b[10]*=_,b[14]*=_,b[3]*=_,b[7]*=_,b[11]*=_,b[15]*=_,this}determinant(){const _=this.elements,b=_[0],$=_[4],ee=_[8],re=_[12],ae=_[1],xe=_[5],le=_[9],fe=_[13],ve=_[2],Se=_[6],Ee=_[10],Ce=_[14],Ie=_[3],De=_[7],Be=_[11],Ne=_[15];return Ie*(+re*le*Se-ee*fe*Se-re*xe*Ee+$*fe*Ee+ee*xe*Ce-$*le*Ce)+De*(+b*le*Ce-b*fe*Ee+re*ae*Ee-ee*ae*Ce+ee*fe*ve-re*le*ve)+Be*(+b*fe*Se-b*xe*Ce-re*ae*Se+$*ae*Ce+re*xe*ve-$*fe*ve)+Ne*(-ee*xe*ve-b*le*Se+b*xe*Ee+ee*ae*Se-$*ae*Ee+$*le*ve)}transpose(){const _=this.elements;let b;return b=_[1],_[1]=_[4],_[4]=b,b=_[2],_[2]=_[8],_[8]=b,b=_[6],_[6]=_[9],_[9]=b,b=_[3],_[3]=_[12],_[12]=b,b=_[7],_[7]=_[13],_[13]=b,b=_[11],_[11]=_[14],_[14]=b,this}setPosition(_,b,$){const ee=this.elements;return _.isVector3?(ee[12]=_.x,ee[13]=_.y,ee[14]=_.z):(ee[12]=_,ee[13]=b,ee[14]=$),this}invert(){const _=this.elements,b=_[0],$=_[1],ee=_[2],re=_[3],ae=_[4],xe=_[5],le=_[6],fe=_[7],ve=_[8],Se=_[9],Ee=_[10],Ce=_[11],Ie=_[12],De=_[13],Be=_[14],Ne=_[15],qe=Se*Be*fe-De*Ee*fe+De*le*Ce-xe*Be*Ce-Se*le*Ne+xe*Ee*Ne,Xe=Ie*Ee*fe-ve*Be*fe-Ie*le*Ce+ae*Be*Ce+ve*le*Ne-ae*Ee*Ne,Ye=ve*De*fe-Ie*Se*fe+Ie*xe*Ce-ae*De*Ce-ve*xe*Ne+ae*Se*Ne,Qe=Ie*Se*le-ve*De*le-Ie*xe*Ee+ae*De*Ee+ve*xe*Be-ae*Se*Be,rt=b*qe+$*Xe+ee*Ye+re*Qe;if(rt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ot=1/rt;return _[0]=qe*ot,_[1]=(De*Ee*re-Se*Be*re-De*ee*Ce+$*Be*Ce+Se*ee*Ne-$*Ee*Ne)*ot,_[2]=(xe*Be*re-De*le*re+De*ee*fe-$*Be*fe-xe*ee*Ne+$*le*Ne)*ot,_[3]=(Se*le*re-xe*Ee*re-Se*ee*fe+$*Ee*fe+xe*ee*Ce-$*le*Ce)*ot,_[4]=Xe*ot,_[5]=(ve*Be*re-Ie*Ee*re+Ie*ee*Ce-b*Be*Ce-ve*ee*Ne+b*Ee*Ne)*ot,_[6]=(Ie*le*re-ae*Be*re-Ie*ee*fe+b*Be*fe+ae*ee*Ne-b*le*Ne)*ot,_[7]=(ae*Ee*re-ve*le*re+ve*ee*fe-b*Ee*fe-ae*ee*Ce+b*le*Ce)*ot,_[8]=Ye*ot,_[9]=(Ie*Se*re-ve*De*re-Ie*$*Ce+b*De*Ce+ve*$*Ne-b*Se*Ne)*ot,_[10]=(ae*De*re-Ie*xe*re+Ie*$*fe-b*De*fe-ae*$*Ne+b*xe*Ne)*ot,_[11]=(ve*xe*re-ae*Se*re-ve*$*fe+b*Se*fe+ae*$*Ce-b*xe*Ce)*ot,_[12]=Qe*ot,_[13]=(ve*De*ee-Ie*Se*ee+Ie*$*Ee-b*De*Ee-ve*$*Be+b*Se*Be)*ot,_[14]=(Ie*xe*ee-ae*De*ee-Ie*$*le+b*De*le+ae*$*Be-b*xe*Be)*ot,_[15]=(ae*Se*ee-ve*xe*ee+ve*$*le-b*Se*le-ae*$*Ee+b*xe*Ee)*ot,this}scale(_){const b=this.elements,$=_.x,ee=_.y,re=_.z;return b[0]*=$,b[4]*=ee,b[8]*=re,b[1]*=$,b[5]*=ee,b[9]*=re,b[2]*=$,b[6]*=ee,b[10]*=re,b[3]*=$,b[7]*=ee,b[11]*=re,this}getMaxScaleOnAxis(){const _=this.elements,b=_[0]*_[0]+_[1]*_[1]+_[2]*_[2],$=_[4]*_[4]+_[5]*_[5]+_[6]*_[6],ee=_[8]*_[8]+_[9]*_[9]+_[10]*_[10];return Math.sqrt(Math.max(b,$,ee))}makeTranslation(_,b,$){return _.isVector3?this.set(1,0,0,_.x,0,1,0,_.y,0,0,1,_.z,0,0,0,1):this.set(1,0,0,_,0,1,0,b,0,0,1,$,0,0,0,1),this}makeRotationX(_){const b=Math.cos(_),$=Math.sin(_);return this.set(1,0,0,0,0,b,-$,0,0,$,b,0,0,0,0,1),this}makeRotationY(_){const b=Math.cos(_),$=Math.sin(_);return this.set(b,0,$,0,0,1,0,0,-$,0,b,0,0,0,0,1),this}makeRotationZ(_){const b=Math.cos(_),$=Math.sin(_);return this.set(b,-$,0,0,$,b,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(_,b){const $=Math.cos(b),ee=Math.sin(b),re=1-$,ae=_.x,xe=_.y,le=_.z,fe=re*ae,ve=re*xe;return this.set(fe*ae+$,fe*xe-ee*le,fe*le+ee*xe,0,fe*xe+ee*le,ve*xe+$,ve*le-ee*ae,0,fe*le-ee*xe,ve*le+ee*ae,re*le*le+$,0,0,0,0,1),this}makeScale(_,b,$){return this.set(_,0,0,0,0,b,0,0,0,0,$,0,0,0,0,1),this}makeShear(_,b,$,ee,re,ae){return this.set(1,$,re,0,_,1,ae,0,b,ee,1,0,0,0,0,1),this}compose(_,b,$){const ee=this.elements,re=b._x,ae=b._y,xe=b._z,le=b._w,fe=re+re,ve=ae+ae,Se=xe+xe,Ee=re*fe,Ce=re*ve,Ie=re*Se,De=ae*ve,Be=ae*Se,Ne=xe*Se,qe=le*fe,Xe=le*ve,Ye=le*Se,Qe=$.x,rt=$.y,ot=$.z;return ee[0]=(1-(De+Ne))*Qe,ee[1]=(Ce+Ye)*Qe,ee[2]=(Ie-Xe)*Qe,ee[3]=0,ee[4]=(Ce-Ye)*rt,ee[5]=(1-(Ee+Ne))*rt,ee[6]=(Be+qe)*rt,ee[7]=0,ee[8]=(Ie+Xe)*ot,ee[9]=(Be-qe)*ot,ee[10]=(1-(Ee+De))*ot,ee[11]=0,ee[12]=_.x,ee[13]=_.y,ee[14]=_.z,ee[15]=1,this}decompose(_,b,$){const ee=this.elements;let re=_v1$2.set(ee[0],ee[1],ee[2]).length();const ae=_v1$2.set(ee[4],ee[5],ee[6]).length(),xe=_v1$2.set(ee[8],ee[9],ee[10]).length();this.determinant()<0&&(re=-re),_.x=ee[12],_.y=ee[13],_.z=ee[14],_m1$7.copy(this);const fe=1/re,ve=1/ae,Se=1/xe;return _m1$7.elements[0]*=fe,_m1$7.elements[1]*=fe,_m1$7.elements[2]*=fe,_m1$7.elements[4]*=ve,_m1$7.elements[5]*=ve,_m1$7.elements[6]*=ve,_m1$7.elements[8]*=Se,_m1$7.elements[9]*=Se,_m1$7.elements[10]*=Se,b.setFromRotationMatrix(_m1$7),$.x=re,$.y=ae,$.z=xe,this}makePerspective(_,b,$,ee,re,ae,xe=WebGLCoordinateSystem$1){const le=this.elements,fe=2*re/(b-_),ve=2*re/($-ee),Se=(b+_)/(b-_),Ee=($+ee)/($-ee);let Ce,Ie;if(xe===WebGLCoordinateSystem$1)Ce=-(ae+re)/(ae-re),Ie=-2*ae*re/(ae-re);else if(xe===WebGPUCoordinateSystem$1)Ce=-ae/(ae-re),Ie=-ae*re/(ae-re);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+xe);return le[0]=fe,le[4]=0,le[8]=Se,le[12]=0,le[1]=0,le[5]=ve,le[9]=Ee,le[13]=0,le[2]=0,le[6]=0,le[10]=Ce,le[14]=Ie,le[3]=0,le[7]=0,le[11]=-1,le[15]=0,this}makeOrthographic(_,b,$,ee,re,ae,xe=WebGLCoordinateSystem$1){const le=this.elements,fe=1/(b-_),ve=1/($-ee),Se=1/(ae-re),Ee=(b+_)*fe,Ce=($+ee)*ve;let Ie,De;if(xe===WebGLCoordinateSystem$1)Ie=(ae+re)*Se,De=-2*Se;else if(xe===WebGPUCoordinateSystem$1)Ie=re*Se,De=-1*Se;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+xe);return le[0]=2*fe,le[4]=0,le[8]=0,le[12]=-Ee,le[1]=0,le[5]=2*ve,le[9]=0,le[13]=-Ce,le[2]=0,le[6]=0,le[10]=De,le[14]=-Ie,le[3]=0,le[7]=0,le[11]=0,le[15]=1,this}equals(_){const b=this.elements,$=_.elements;for(let ee=0;ee<16;ee++)if(b[ee]!==$[ee])return!1;return!0}fromArray(_,b=0){for(let $=0;$<16;$++)this.elements[$]=_[$+b];return this}toArray(_=[],b=0){const $=this.elements;return _[b]=$[0],_[b+1]=$[1],_[b+2]=$[2],_[b+3]=$[3],_[b+4]=$[4],_[b+5]=$[5],_[b+6]=$[6],_[b+7]=$[7],_[b+8]=$[8],_[b+9]=$[9],_[b+10]=$[10],_[b+11]=$[11],_[b+12]=$[12],_[b+13]=$[13],_[b+14]=$[14],_[b+15]=$[15],_}};const _v1$2=new Vector3$1,_m1$7=new Matrix4$1,_zero$1=new Vector3$1(0,0,0),_one$1=new Vector3$1(1,1,1),_x$1=new Vector3$1,_y$1=new Vector3$1,_z$1=new Vector3$1;let Vector4$1=class Cp{constructor(_=0,b=0,$=0,ee=1){Cp.prototype.isVector4=!0,this.x=_,this.y=b,this.z=$,this.w=ee}get width(){return this.z}set width(_){this.z=_}get height(){return this.w}set height(_){this.w=_}set(_,b,$,ee){return this.x=_,this.y=b,this.z=$,this.w=ee,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this.w=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setW(_){return this.w=_,this}setComponent(_,b){switch(_){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this.w=_.w!==void 0?_.w:1,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this.w+=_.w,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this.w+=_,this}addVectors(_,b){return this.x=_.x+b.x,this.y=_.y+b.y,this.z=_.z+b.z,this.w=_.w+b.w,this}addScaledVector(_,b){return this.x+=_.x*b,this.y+=_.y*b,this.z+=_.z*b,this.w+=_.w*b,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this.w-=_.w,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this.w-=_,this}subVectors(_,b){return this.x=_.x-b.x,this.y=_.y-b.y,this.z=_.z-b.z,this.w=_.w-b.w,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this.w*=_.w,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this.w*=_,this}applyMatrix4(_){const b=this.x,$=this.y,ee=this.z,re=this.w,ae=_.elements;return this.x=ae[0]*b+ae[4]*$+ae[8]*ee+ae[12]*re,this.y=ae[1]*b+ae[5]*$+ae[9]*ee+ae[13]*re,this.z=ae[2]*b+ae[6]*$+ae[10]*ee+ae[14]*re,this.w=ae[3]*b+ae[7]*$+ae[11]*ee+ae[15]*re,this}divideScalar(_){return this.multiplyScalar(1/_)}setAxisAngleFromQuaternion(_){this.w=2*Math.acos(_.w);const b=Math.sqrt(1-_.w*_.w);return b<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=_.x/b,this.y=_.y/b,this.z=_.z/b),this}setAxisAngleFromRotationMatrix(_){let b,$,ee,re;const le=_.elements,fe=le[0],ve=le[4],Se=le[8],Ee=le[1],Ce=le[5],Ie=le[9],De=le[2],Be=le[6],Ne=le[10];if(Math.abs(ve-Ee)<.01&&Math.abs(Se-De)<.01&&Math.abs(Ie-Be)<.01){if(Math.abs(ve+Ee)<.1&&Math.abs(Se+De)<.1&&Math.abs(Ie+Be)<.1&&Math.abs(fe+Ce+Ne-3)<.1)return this.set(1,0,0,0),this;b=Math.PI;const Xe=(fe+1)/2,Ye=(Ce+1)/2,Qe=(Ne+1)/2,rt=(ve+Ee)/4,ot=(Se+De)/4,ct=(Ie+Be)/4;return Xe>Ye&&Xe>Qe?Xe<.01?($=0,ee=.707106781,re=.707106781):($=Math.sqrt(Xe),ee=rt/$,re=ot/$):Ye>Qe?Ye<.01?($=.707106781,ee=0,re=.707106781):(ee=Math.sqrt(Ye),$=rt/ee,re=ct/ee):Qe<.01?($=.707106781,ee=.707106781,re=0):(re=Math.sqrt(Qe),$=ot/re,ee=ct/re),this.set($,ee,re,b),this}let qe=Math.sqrt((Be-Ie)*(Be-Ie)+(Se-De)*(Se-De)+(Ee-ve)*(Ee-ve));return Math.abs(qe)<.001&&(qe=1),this.x=(Be-Ie)/qe,this.y=(Se-De)/qe,this.z=(Ee-ve)/qe,this.w=Math.acos((fe+Ce+Ne-1)/2),this}setFromMatrixPosition(_){const b=_.elements;return this.x=b[12],this.y=b[13],this.z=b[14],this.w=b[15],this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this.w=Math.min(this.w,_.w),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this.w=Math.max(this.w,_.w),this}clamp(_,b){return this.x=Math.max(_.x,Math.min(b.x,this.x)),this.y=Math.max(_.y,Math.min(b.y,this.y)),this.z=Math.max(_.z,Math.min(b.z,this.z)),this.w=Math.max(_.w,Math.min(b.w,this.w)),this}clampScalar(_,b){return this.x=Math.max(_,Math.min(b,this.x)),this.y=Math.max(_,Math.min(b,this.y)),this.z=Math.max(_,Math.min(b,this.z)),this.w=Math.max(_,Math.min(b,this.w)),this}clampLength(_,b){const $=this.length();return this.divideScalar($||1).multiplyScalar(Math.max(_,Math.min(b,$)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z+this.w*_.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,b){return this.x+=(_.x-this.x)*b,this.y+=(_.y-this.y)*b,this.z+=(_.z-this.z)*b,this.w+=(_.w-this.w)*b,this}lerpVectors(_,b,$){return this.x=_.x+(b.x-_.x)*$,this.y=_.y+(b.y-_.y)*$,this.z=_.z+(b.z-_.z)*$,this.w=_.w+(b.w-_.w)*$,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z&&_.w===this.w}fromArray(_,b=0){return this.x=_[b],this.y=_[b+1],this.z=_[b+2],this.w=_[b+3],this}toArray(_=[],b=0){return _[b]=this.x,_[b+1]=this.y,_[b+2]=this.z,_[b+3]=this.w,_}fromBufferAttribute(_,b){return this.x=_.getX(b),this.y=_.getY(b),this.z=_.getZ(b),this.w=_.getW(b),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}};function WebGLAnimation(){let H=null,_=!1,b=null,$=null;function ee(re,ae){b(re,ae),$=H.requestAnimationFrame(ee)}return{start:function(){_!==!0&&b!==null&&($=H.requestAnimationFrame(ee),_=!0)},stop:function(){H.cancelAnimationFrame($),_=!1},setAnimationLoop:function(re){b=re},setContext:function(re){H=re}}}function WebGLAttributes(H){const _=new WeakMap;function b(xe,le){const fe=xe.array,ve=xe.usage,Se=fe.byteLength,Ee=H.createBuffer();H.bindBuffer(le,Ee),H.bufferData(le,fe,ve),xe.onUploadCallback();let Ce;if(fe instanceof Float32Array)Ce=H.FLOAT;else if(fe instanceof Uint16Array)xe.isFloat16BufferAttribute?Ce=H.HALF_FLOAT:Ce=H.UNSIGNED_SHORT;else if(fe instanceof Int16Array)Ce=H.SHORT;else if(fe instanceof Uint32Array)Ce=H.UNSIGNED_INT;else if(fe instanceof Int32Array)Ce=H.INT;else if(fe instanceof Int8Array)Ce=H.BYTE;else if(fe instanceof Uint8Array)Ce=H.UNSIGNED_BYTE;else if(fe instanceof Uint8ClampedArray)Ce=H.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+fe);return{buffer:Ee,type:Ce,bytesPerElement:fe.BYTES_PER_ELEMENT,version:xe.version,size:Se}}function $(xe,le,fe){const ve=le.array,Se=le._updateRange,Ee=le.updateRanges;if(H.bindBuffer(fe,xe),Se.count===-1&&Ee.length===0&&H.bufferSubData(fe,0,ve),Ee.length!==0){for(let Ce=0,Ie=Ee.length;Ce<Ie;Ce++){const De=Ee[Ce];H.bufferSubData(fe,De.start*ve.BYTES_PER_ELEMENT,ve,De.start,De.count)}le.clearUpdateRanges()}Se.count!==-1&&(H.bufferSubData(fe,Se.offset*ve.BYTES_PER_ELEMENT,ve,Se.offset,Se.count),Se.count=-1),le.onUploadCallback()}function ee(xe){return xe.isInterleavedBufferAttribute&&(xe=xe.data),_.get(xe)}function re(xe){xe.isInterleavedBufferAttribute&&(xe=xe.data);const le=_.get(xe);le&&(H.deleteBuffer(le.buffer),_.delete(xe))}function ae(xe,le){if(xe.isInterleavedBufferAttribute&&(xe=xe.data),xe.isGLBufferAttribute){const ve=_.get(xe);(!ve||ve.version<xe.version)&&_.set(xe,{buffer:xe.buffer,type:xe.type,bytesPerElement:xe.elementSize,version:xe.version});return}const fe=_.get(xe);if(fe===void 0)_.set(xe,b(xe,le));else if(fe.version<xe.version){if(fe.size!==xe.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");$(fe.buffer,xe,le),fe.version=xe.version}}return{get:ee,remove:re,update:ae}}let Vector2$1=class Rp{constructor(_=0,b=0){Rp.prototype.isVector2=!0,this.x=_,this.y=b}get width(){return this.x}set width(_){this.x=_}get height(){return this.y}set height(_){this.y=_}set(_,b){return this.x=_,this.y=b,this}setScalar(_){return this.x=_,this.y=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setComponent(_,b){switch(_){case 0:this.x=b;break;case 1:this.y=b;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y)}copy(_){return this.x=_.x,this.y=_.y,this}add(_){return this.x+=_.x,this.y+=_.y,this}addScalar(_){return this.x+=_,this.y+=_,this}addVectors(_,b){return this.x=_.x+b.x,this.y=_.y+b.y,this}addScaledVector(_,b){return this.x+=_.x*b,this.y+=_.y*b,this}sub(_){return this.x-=_.x,this.y-=_.y,this}subScalar(_){return this.x-=_,this.y-=_,this}subVectors(_,b){return this.x=_.x-b.x,this.y=_.y-b.y,this}multiply(_){return this.x*=_.x,this.y*=_.y,this}multiplyScalar(_){return this.x*=_,this.y*=_,this}divide(_){return this.x/=_.x,this.y/=_.y,this}divideScalar(_){return this.multiplyScalar(1/_)}applyMatrix3(_){const b=this.x,$=this.y,ee=_.elements;return this.x=ee[0]*b+ee[3]*$+ee[6],this.y=ee[1]*b+ee[4]*$+ee[7],this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this}clamp(_,b){return this.x=Math.max(_.x,Math.min(b.x,this.x)),this.y=Math.max(_.y,Math.min(b.y,this.y)),this}clampScalar(_,b){return this.x=Math.max(_,Math.min(b,this.x)),this.y=Math.max(_,Math.min(b,this.y)),this}clampLength(_,b){const $=this.length();return this.divideScalar($||1).multiplyScalar(Math.max(_,Math.min(b,$)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(_){return this.x*_.x+this.y*_.y}cross(_){return this.x*_.y-this.y*_.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(_){const b=Math.sqrt(this.lengthSq()*_.lengthSq());if(b===0)return Math.PI/2;const $=this.dot(_)/b;return Math.acos(clamp$1($,-1,1))}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const b=this.x-_.x,$=this.y-_.y;return b*b+$*$}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,b){return this.x+=(_.x-this.x)*b,this.y+=(_.y-this.y)*b,this}lerpVectors(_,b,$){return this.x=_.x+(b.x-_.x)*$,this.y=_.y+(b.y-_.y)*$,this}equals(_){return _.x===this.x&&_.y===this.y}fromArray(_,b=0){return this.x=_[b],this.y=_[b+1],this}toArray(_=[],b=0){return _[b]=this.x,_[b+1]=this.y,_}fromBufferAttribute(_,b){return this.x=_.getX(b),this.y=_.getY(b),this}rotateAround(_,b){const $=Math.cos(b),ee=Math.sin(b),re=this.x-_.x,ae=this.y-_.y;return this.x=re*$-ae*ee+_.x,this.y=re*ee+ae*$+_.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},EventDispatcher$1=class{addEventListener(_,b){this._listeners===void 0&&(this._listeners={});const $=this._listeners;$[_]===void 0&&($[_]=[]),$[_].indexOf(b)===-1&&$[_].push(b)}hasEventListener(_,b){if(this._listeners===void 0)return!1;const $=this._listeners;return $[_]!==void 0&&$[_].indexOf(b)!==-1}removeEventListener(_,b){if(this._listeners===void 0)return;const ee=this._listeners[_];if(ee!==void 0){const re=ee.indexOf(b);re!==-1&&ee.splice(re,1)}}dispatchEvent(_){if(this._listeners===void 0)return;const $=this._listeners[_.type];if($!==void 0){_.target=this;const ee=$.slice(0);for(let re=0,ae=ee.length;re<ae;re++)ee[re].call(this,_);_.target=null}}};function arrayNeedsUint32$1(H){for(let _=H.length-1;_>=0;--_)if(H[_]>=65535)return!0;return!1}function createElementNS$1(H){return document.createElementNS("http://www.w3.org/1999/xhtml",H)}function createCanvasElement(){const H=createElementNS$1("canvas");return H.style.display="block",H}const _cache$1={};function warnOnce$1(H){H in _cache$1||(_cache$1[H]=!0,console.warn(H))}function probeAsync(H,_,b){return new Promise(function($,ee){function re(){switch(H.clientWaitSync(_,H.SYNC_FLUSH_COMMANDS_BIT,0)){case H.WAIT_FAILED:ee();break;case H.TIMEOUT_EXPIRED:setTimeout(re,b);break;default:$()}}setTimeout(re,b)})}const _vector$2=new Vector3$1,_vector2$2=new Vector2$1;let BufferAttribute$1=class{constructor(_,b,$=!1){if(Array.isArray(_))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=_,this.itemSize=b,this.count=_!==void 0?_.length/b:0,this.normalized=$,this.usage=StaticDrawUsage$1,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=FloatType$1,this.version=0}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}get updateRange(){return warnOnce$1("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(_){return this.usage=_,this}addUpdateRange(_,b){this.updateRanges.push({start:_,count:b})}clearUpdateRanges(){this.updateRanges.length=0}copy(_){return this.name=_.name,this.array=new _.array.constructor(_.array),this.itemSize=_.itemSize,this.count=_.count,this.normalized=_.normalized,this.usage=_.usage,this.gpuType=_.gpuType,this}copyAt(_,b,$){_*=this.itemSize,$*=b.itemSize;for(let ee=0,re=this.itemSize;ee<re;ee++)this.array[_+ee]=b.array[$+ee];return this}copyArray(_){return this.array.set(_),this}applyMatrix3(_){if(this.itemSize===2)for(let b=0,$=this.count;b<$;b++)_vector2$2.fromBufferAttribute(this,b),_vector2$2.applyMatrix3(_),this.setXY(b,_vector2$2.x,_vector2$2.y);else if(this.itemSize===3)for(let b=0,$=this.count;b<$;b++)_vector$2.fromBufferAttribute(this,b),_vector$2.applyMatrix3(_),this.setXYZ(b,_vector$2.x,_vector$2.y,_vector$2.z);return this}applyMatrix4(_){for(let b=0,$=this.count;b<$;b++)_vector$2.fromBufferAttribute(this,b),_vector$2.applyMatrix4(_),this.setXYZ(b,_vector$2.x,_vector$2.y,_vector$2.z);return this}applyNormalMatrix(_){for(let b=0,$=this.count;b<$;b++)_vector$2.fromBufferAttribute(this,b),_vector$2.applyNormalMatrix(_),this.setXYZ(b,_vector$2.x,_vector$2.y,_vector$2.z);return this}transformDirection(_){for(let b=0,$=this.count;b<$;b++)_vector$2.fromBufferAttribute(this,b),_vector$2.transformDirection(_),this.setXYZ(b,_vector$2.x,_vector$2.y,_vector$2.z);return this}set(_,b=0){return this.array.set(_,b),this}getComponent(_,b){let $=this.array[_*this.itemSize+b];return this.normalized&&($=denormalize$1($,this.array)),$}setComponent(_,b,$){return this.normalized&&($=normalize$1($,this.array)),this.array[_*this.itemSize+b]=$,this}getX(_){let b=this.array[_*this.itemSize];return this.normalized&&(b=denormalize$1(b,this.array)),b}setX(_,b){return this.normalized&&(b=normalize$1(b,this.array)),this.array[_*this.itemSize]=b,this}getY(_){let b=this.array[_*this.itemSize+1];return this.normalized&&(b=denormalize$1(b,this.array)),b}setY(_,b){return this.normalized&&(b=normalize$1(b,this.array)),this.array[_*this.itemSize+1]=b,this}getZ(_){let b=this.array[_*this.itemSize+2];return this.normalized&&(b=denormalize$1(b,this.array)),b}setZ(_,b){return this.normalized&&(b=normalize$1(b,this.array)),this.array[_*this.itemSize+2]=b,this}getW(_){let b=this.array[_*this.itemSize+3];return this.normalized&&(b=denormalize$1(b,this.array)),b}setW(_,b){return this.normalized&&(b=normalize$1(b,this.array)),this.array[_*this.itemSize+3]=b,this}setXY(_,b,$){return _*=this.itemSize,this.normalized&&(b=normalize$1(b,this.array),$=normalize$1($,this.array)),this.array[_+0]=b,this.array[_+1]=$,this}setXYZ(_,b,$,ee){return _*=this.itemSize,this.normalized&&(b=normalize$1(b,this.array),$=normalize$1($,this.array),ee=normalize$1(ee,this.array)),this.array[_+0]=b,this.array[_+1]=$,this.array[_+2]=ee,this}setXYZW(_,b,$,ee,re){return _*=this.itemSize,this.normalized&&(b=normalize$1(b,this.array),$=normalize$1($,this.array),ee=normalize$1(ee,this.array),re=normalize$1(re,this.array)),this.array[_+0]=b,this.array[_+1]=$,this.array[_+2]=ee,this.array[_+3]=re,this}onUpload(_){return this.onUploadCallback=_,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const _={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(_.name=this.name),this.usage!==StaticDrawUsage$1&&(_.usage=this.usage),_}},Uint16BufferAttribute$1=class extends BufferAttribute$1{constructor(_,b,$){super(new Uint16Array(_),b,$)}},Uint32BufferAttribute$1=class extends BufferAttribute$1{constructor(_,b,$){super(new Uint32Array(_),b,$)}},Float32BufferAttribute$1=class extends BufferAttribute$1{constructor(_,b,$){super(new Float32Array(_),b,$)}};const _matrix=new Matrix4$1,_quaternion$1=new Quaternion$1;let Euler$1=class Pp{constructor(_=0,b=0,$=0,ee=Pp.DEFAULT_ORDER){this.isEuler=!0,this._x=_,this._y=b,this._z=$,this._order=ee}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get order(){return this._order}set order(_){this._order=_,this._onChangeCallback()}set(_,b,$,ee=this._order){return this._x=_,this._y=b,this._z=$,this._order=ee,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(_){return this._x=_._x,this._y=_._y,this._z=_._z,this._order=_._order,this._onChangeCallback(),this}setFromRotationMatrix(_,b=this._order,$=!0){const ee=_.elements,re=ee[0],ae=ee[4],xe=ee[8],le=ee[1],fe=ee[5],ve=ee[9],Se=ee[2],Ee=ee[6],Ce=ee[10];switch(b){case"XYZ":this._y=Math.asin(clamp$1(xe,-1,1)),Math.abs(xe)<.9999999?(this._x=Math.atan2(-ve,Ce),this._z=Math.atan2(-ae,re)):(this._x=Math.atan2(Ee,fe),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp$1(ve,-1,1)),Math.abs(ve)<.9999999?(this._y=Math.atan2(xe,Ce),this._z=Math.atan2(le,fe)):(this._y=Math.atan2(-Se,re),this._z=0);break;case"ZXY":this._x=Math.asin(clamp$1(Ee,-1,1)),Math.abs(Ee)<.9999999?(this._y=Math.atan2(-Se,Ce),this._z=Math.atan2(-ae,fe)):(this._y=0,this._z=Math.atan2(le,re));break;case"ZYX":this._y=Math.asin(-clamp$1(Se,-1,1)),Math.abs(Se)<.9999999?(this._x=Math.atan2(Ee,Ce),this._z=Math.atan2(le,re)):(this._x=0,this._z=Math.atan2(-ae,fe));break;case"YZX":this._z=Math.asin(clamp$1(le,-1,1)),Math.abs(le)<.9999999?(this._x=Math.atan2(-ve,fe),this._y=Math.atan2(-Se,re)):(this._x=0,this._y=Math.atan2(xe,Ce));break;case"XZY":this._z=Math.asin(-clamp$1(ae,-1,1)),Math.abs(ae)<.9999999?(this._x=Math.atan2(Ee,fe),this._y=Math.atan2(xe,re)):(this._x=Math.atan2(-ve,Ce),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+b)}return this._order=b,$===!0&&this._onChangeCallback(),this}setFromQuaternion(_,b,$){return _matrix.makeRotationFromQuaternion(_),this.setFromRotationMatrix(_matrix,b,$)}setFromVector3(_,b=this._order){return this.set(_.x,_.y,_.z,b)}reorder(_){return _quaternion$1.setFromEuler(this),this.setFromQuaternion(_quaternion$1,_)}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._order===this._order}fromArray(_){return this._x=_[0],this._y=_[1],this._z=_[2],_[3]!==void 0&&(this._order=_[3]),this._onChangeCallback(),this}toArray(_=[],b=0){return _[b]=this._x,_[b+1]=this._y,_[b+2]=this._z,_[b+3]=this._order,_}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Euler$1.DEFAULT_ORDER="XYZ";let Layers$1=class{constructor(){this.mask=1}set(_){this.mask=(1<<_|0)>>>0}enable(_){this.mask|=1<<_|0}enableAll(){this.mask=-1}toggle(_){this.mask^=1<<_|0}disable(_){this.mask&=~(1<<_|0)}disableAll(){this.mask=0}test(_){return(this.mask&_.mask)!==0}isEnabled(_){return(this.mask&(1<<_|0))!==0}},_object3DId$1=0;const _v1$1=new Vector3$1,_q1$1=new Quaternion$1,_m1$6=new Matrix4$1,_target$1=new Vector3$1,_position=new Vector3$1,_scale=new Vector3$1,_quaternion=new Quaternion$1,_xAxis$1=new Vector3$1(1,0,0),_yAxis$1=new Vector3$1(0,1,0),_zAxis$1=new Vector3$1(0,0,1),_addedEvent$1={type:"added"},_removedEvent$1={type:"removed"},_childaddedEvent$1={type:"childadded",child:null},_childremovedEvent$1={type:"childremoved",child:null};let Object3D$1=class Z2 extends EventDispatcher$1{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId$1++}),this.uuid=generateUUID$1(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Z2.DEFAULT_UP.clone();const _=new Vector3$1,b=new Euler$1,$=new Quaternion$1,ee=new Vector3$1(1,1,1);function re(){$.setFromEuler(b,!1)}function ae(){b.setFromQuaternion($,void 0,!1)}b._onChange(re),$._onChange(ae),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:_},rotation:{configurable:!0,enumerable:!0,value:b},quaternion:{configurable:!0,enumerable:!0,value:$},scale:{configurable:!0,enumerable:!0,value:ee},modelViewMatrix:{value:new Matrix4$1},normalMatrix:{value:new Matrix3$1}}),this.matrix=new Matrix4$1,this.matrixWorld=new Matrix4$1,this.matrixAutoUpdate=Z2.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Z2.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers$1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(_){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(_),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(_){return this.quaternion.premultiply(_),this}setRotationFromAxisAngle(_,b){this.quaternion.setFromAxisAngle(_,b)}setRotationFromEuler(_){this.quaternion.setFromEuler(_,!0)}setRotationFromMatrix(_){this.quaternion.setFromRotationMatrix(_)}setRotationFromQuaternion(_){this.quaternion.copy(_)}rotateOnAxis(_,b){return _q1$1.setFromAxisAngle(_,b),this.quaternion.multiply(_q1$1),this}rotateOnWorldAxis(_,b){return _q1$1.setFromAxisAngle(_,b),this.quaternion.premultiply(_q1$1),this}rotateX(_){return this.rotateOnAxis(_xAxis$1,_)}rotateY(_){return this.rotateOnAxis(_yAxis$1,_)}rotateZ(_){return this.rotateOnAxis(_zAxis$1,_)}translateOnAxis(_,b){return _v1$1.copy(_).applyQuaternion(this.quaternion),this.position.add(_v1$1.multiplyScalar(b)),this}translateX(_){return this.translateOnAxis(_xAxis$1,_)}translateY(_){return this.translateOnAxis(_yAxis$1,_)}translateZ(_){return this.translateOnAxis(_zAxis$1,_)}localToWorld(_){return this.updateWorldMatrix(!0,!1),_.applyMatrix4(this.matrixWorld)}worldToLocal(_){return this.updateWorldMatrix(!0,!1),_.applyMatrix4(_m1$6.copy(this.matrixWorld).invert())}lookAt(_,b,$){_.isVector3?_target$1.copy(_):_target$1.set(_,b,$);const ee=this.parent;this.updateWorldMatrix(!0,!1),_position.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$6.lookAt(_position,_target$1,this.up):_m1$6.lookAt(_target$1,_position,this.up),this.quaternion.setFromRotationMatrix(_m1$6),ee&&(_m1$6.extractRotation(ee.matrixWorld),_q1$1.setFromRotationMatrix(_m1$6),this.quaternion.premultiply(_q1$1.invert()))}add(_){if(arguments.length>1){for(let b=0;b<arguments.length;b++)this.add(arguments[b]);return this}return _===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_),this):(_&&_.isObject3D?(_.removeFromParent(),_.parent=this,this.children.push(_),_.dispatchEvent(_addedEvent$1),_childaddedEvent$1.child=_,this.dispatchEvent(_childaddedEvent$1),_childaddedEvent$1.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_),this)}remove(_){if(arguments.length>1){for(let $=0;$<arguments.length;$++)this.remove(arguments[$]);return this}const b=this.children.indexOf(_);return b!==-1&&(_.parent=null,this.children.splice(b,1),_.dispatchEvent(_removedEvent$1),_childremovedEvent$1.child=_,this.dispatchEvent(_childremovedEvent$1),_childremovedEvent$1.child=null),this}removeFromParent(){const _=this.parent;return _!==null&&_.remove(this),this}clear(){return this.remove(...this.children)}attach(_){return this.updateWorldMatrix(!0,!1),_m1$6.copy(this.matrixWorld).invert(),_.parent!==null&&(_.parent.updateWorldMatrix(!0,!1),_m1$6.multiply(_.parent.matrixWorld)),_.applyMatrix4(_m1$6),_.removeFromParent(),_.parent=this,this.children.push(_),_.updateWorldMatrix(!1,!0),_.dispatchEvent(_addedEvent$1),_childaddedEvent$1.child=_,this.dispatchEvent(_childaddedEvent$1),_childaddedEvent$1.child=null,this}getObjectById(_){return this.getObjectByProperty("id",_)}getObjectByName(_){return this.getObjectByProperty("name",_)}getObjectByProperty(_,b){if(this[_]===b)return this;for(let $=0,ee=this.children.length;$<ee;$++){const ae=this.children[$].getObjectByProperty(_,b);if(ae!==void 0)return ae}}getObjectsByProperty(_,b,$=[]){this[_]===b&&$.push(this);const ee=this.children;for(let re=0,ae=ee.length;re<ae;re++)ee[re].getObjectsByProperty(_,b,$);return $}getWorldPosition(_){return this.updateWorldMatrix(!0,!1),_.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position,_,_scale),_}getWorldScale(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position,_quaternion,_),_}getWorldDirection(_){this.updateWorldMatrix(!0,!1);const b=this.matrixWorld.elements;return _.set(b[8],b[9],b[10]).normalize()}raycast(){}traverse(_){_(this);const b=this.children;for(let $=0,ee=b.length;$<ee;$++)b[$].traverse(_)}traverseVisible(_){if(this.visible===!1)return;_(this);const b=this.children;for(let $=0,ee=b.length;$<ee;$++)b[$].traverseVisible(_)}traverseAncestors(_){const b=this.parent;b!==null&&(_(b),b.traverseAncestors(_))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,_=!0);const b=this.children;for(let $=0,ee=b.length;$<ee;$++)b[$].updateMatrixWorld(_)}updateWorldMatrix(_,b){const $=this.parent;if(_===!0&&$!==null&&$.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),b===!0){const ee=this.children;for(let re=0,ae=ee.length;re<ae;re++)ee[re].updateWorldMatrix(!1,!0)}}toJSON(_){const b=_===void 0||typeof _=="string",$={};b&&(_={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},$.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const ee={};ee.uuid=this.uuid,ee.type=this.type,this.name!==""&&(ee.name=this.name),this.castShadow===!0&&(ee.castShadow=!0),this.receiveShadow===!0&&(ee.receiveShadow=!0),this.visible===!1&&(ee.visible=!1),this.frustumCulled===!1&&(ee.frustumCulled=!1),this.renderOrder!==0&&(ee.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(ee.userData=this.userData),ee.layers=this.layers.mask,ee.matrix=this.matrix.toArray(),ee.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(ee.matrixAutoUpdate=!1),this.isInstancedMesh&&(ee.type="InstancedMesh",ee.count=this.count,ee.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(ee.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(ee.type="BatchedMesh",ee.perObjectFrustumCulled=this.perObjectFrustumCulled,ee.sortObjects=this.sortObjects,ee.drawRanges=this._drawRanges,ee.reservedRanges=this._reservedRanges,ee.visibility=this._visibility,ee.active=this._active,ee.bounds=this._bounds.map(xe=>({boxInitialized:xe.boxInitialized,boxMin:xe.box.min.toArray(),boxMax:xe.box.max.toArray(),sphereInitialized:xe.sphereInitialized,sphereRadius:xe.sphere.radius,sphereCenter:xe.sphere.center.toArray()})),ee.maxInstanceCount=this._maxInstanceCount,ee.maxVertexCount=this._maxVertexCount,ee.maxIndexCount=this._maxIndexCount,ee.geometryInitialized=this._geometryInitialized,ee.geometryCount=this._geometryCount,ee.matricesTexture=this._matricesTexture.toJSON(_),this._colorsTexture!==null&&(ee.colorsTexture=this._colorsTexture.toJSON(_)),this.boundingSphere!==null&&(ee.boundingSphere={center:ee.boundingSphere.center.toArray(),radius:ee.boundingSphere.radius}),this.boundingBox!==null&&(ee.boundingBox={min:ee.boundingBox.min.toArray(),max:ee.boundingBox.max.toArray()}));function re(xe,le){return xe[le.uuid]===void 0&&(xe[le.uuid]=le.toJSON(_)),le.uuid}if(this.isScene)this.background&&(this.background.isColor?ee.background=this.background.toJSON():this.background.isTexture&&(ee.background=this.background.toJSON(_).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(ee.environment=this.environment.toJSON(_).uuid);else if(this.isMesh||this.isLine||this.isPoints){ee.geometry=re(_.geometries,this.geometry);const xe=this.geometry.parameters;if(xe!==void 0&&xe.shapes!==void 0){const le=xe.shapes;if(Array.isArray(le))for(let fe=0,ve=le.length;fe<ve;fe++){const Se=le[fe];re(_.shapes,Se)}else re(_.shapes,le)}}if(this.isSkinnedMesh&&(ee.bindMode=this.bindMode,ee.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(re(_.skeletons,this.skeleton),ee.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const xe=[];for(let le=0,fe=this.material.length;le<fe;le++)xe.push(re(_.materials,this.material[le]));ee.material=xe}else ee.material=re(_.materials,this.material);if(this.children.length>0){ee.children=[];for(let xe=0;xe<this.children.length;xe++)ee.children.push(this.children[xe].toJSON(_).object)}if(this.animations.length>0){ee.animations=[];for(let xe=0;xe<this.animations.length;xe++){const le=this.animations[xe];ee.animations.push(re(_.animations,le))}}if(b){const xe=ae(_.geometries),le=ae(_.materials),fe=ae(_.textures),ve=ae(_.images),Se=ae(_.shapes),Ee=ae(_.skeletons),Ce=ae(_.animations),Ie=ae(_.nodes);xe.length>0&&($.geometries=xe),le.length>0&&($.materials=le),fe.length>0&&($.textures=fe),ve.length>0&&($.images=ve),Se.length>0&&($.shapes=Se),Ee.length>0&&($.skeletons=Ee),Ce.length>0&&($.animations=Ce),Ie.length>0&&($.nodes=Ie)}return $.object=ee,$;function ae(xe){const le=[];for(const fe in xe){const ve=xe[fe];delete ve.metadata,le.push(ve)}return le}}clone(_){return new this.constructor().copy(this,_)}copy(_,b=!0){if(this.name=_.name,this.up.copy(_.up),this.position.copy(_.position),this.rotation.order=_.rotation.order,this.quaternion.copy(_.quaternion),this.scale.copy(_.scale),this.matrix.copy(_.matrix),this.matrixWorld.copy(_.matrixWorld),this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrixWorldAutoUpdate=_.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=_.matrixWorldNeedsUpdate,this.layers.mask=_.layers.mask,this.visible=_.visible,this.castShadow=_.castShadow,this.receiveShadow=_.receiveShadow,this.frustumCulled=_.frustumCulled,this.renderOrder=_.renderOrder,this.animations=_.animations.slice(),this.userData=JSON.parse(JSON.stringify(_.userData)),b===!0)for(let $=0;$<_.children.length;$++){const ee=_.children[$];this.add(ee.clone())}return this}};Object3D$1.DEFAULT_UP=new Vector3$1(0,1,0);Object3D$1.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D$1.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;let _id$1=0;const _m1$5=new Matrix4$1,_obj$1=new Object3D$1,_offset$1=new Vector3$1,_box=new Box3$1,_boxMorphTargets$1=new Box3$1,_vector$1=new Vector3$1;let BufferGeometry$1=class Ip extends EventDispatcher$1{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$1++}),this.uuid=generateUUID$1(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(_){return Array.isArray(_)?this.index=new(arrayNeedsUint32$1(_)?Uint32BufferAttribute$1:Uint16BufferAttribute$1)(_,1):this.index=_,this}getAttribute(_){return this.attributes[_]}setAttribute(_,b){return this.attributes[_]=b,this}deleteAttribute(_){return delete this.attributes[_],this}hasAttribute(_){return this.attributes[_]!==void 0}addGroup(_,b,$=0){this.groups.push({start:_,count:b,materialIndex:$})}clearGroups(){this.groups=[]}setDrawRange(_,b){this.drawRange.start=_,this.drawRange.count=b}applyMatrix4(_){const b=this.attributes.position;b!==void 0&&(b.applyMatrix4(_),b.needsUpdate=!0);const $=this.attributes.normal;if($!==void 0){const re=new Matrix3$1().getNormalMatrix(_);$.applyNormalMatrix(re),$.needsUpdate=!0}const ee=this.attributes.tangent;return ee!==void 0&&(ee.transformDirection(_),ee.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(_){return _m1$5.makeRotationFromQuaternion(_),this.applyMatrix4(_m1$5),this}rotateX(_){return _m1$5.makeRotationX(_),this.applyMatrix4(_m1$5),this}rotateY(_){return _m1$5.makeRotationY(_),this.applyMatrix4(_m1$5),this}rotateZ(_){return _m1$5.makeRotationZ(_),this.applyMatrix4(_m1$5),this}translate(_,b,$){return _m1$5.makeTranslation(_,b,$),this.applyMatrix4(_m1$5),this}scale(_,b,$){return _m1$5.makeScale(_,b,$),this.applyMatrix4(_m1$5),this}lookAt(_){return _obj$1.lookAt(_),_obj$1.updateMatrix(),this.applyMatrix4(_obj$1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset$1).negate(),this.translate(_offset$1.x,_offset$1.y,_offset$1.z),this}setFromPoints(_){const b=[];for(let $=0,ee=_.length;$<ee;$++){const re=_[$];b.push(re.x,re.y,re.z||0)}return this.setAttribute("position",new Float32BufferAttribute$1(b,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3$1);const _=this.attributes.position,b=this.morphAttributes.position;if(_&&_.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Vector3$1(-1/0,-1/0,-1/0),new Vector3$1(1/0,1/0,1/0));return}if(_!==void 0){if(this.boundingBox.setFromBufferAttribute(_),b)for(let $=0,ee=b.length;$<ee;$++){const re=b[$];_box.setFromBufferAttribute(re),this.morphTargetsRelative?(_vector$1.addVectors(this.boundingBox.min,_box.min),this.boundingBox.expandByPoint(_vector$1),_vector$1.addVectors(this.boundingBox.max,_box.max),this.boundingBox.expandByPoint(_vector$1)):(this.boundingBox.expandByPoint(_box.min),this.boundingBox.expandByPoint(_box.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere$1);const _=this.attributes.position,b=this.morphAttributes.position;if(_&&_.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Vector3$1,1/0);return}if(_){const $=this.boundingSphere.center;if(_box.setFromBufferAttribute(_),b)for(let re=0,ae=b.length;re<ae;re++){const xe=b[re];_boxMorphTargets$1.setFromBufferAttribute(xe),this.morphTargetsRelative?(_vector$1.addVectors(_box.min,_boxMorphTargets$1.min),_box.expandByPoint(_vector$1),_vector$1.addVectors(_box.max,_boxMorphTargets$1.max),_box.expandByPoint(_vector$1)):(_box.expandByPoint(_boxMorphTargets$1.min),_box.expandByPoint(_boxMorphTargets$1.max))}_box.getCenter($);let ee=0;for(let re=0,ae=_.count;re<ae;re++)_vector$1.fromBufferAttribute(_,re),ee=Math.max(ee,$.distanceToSquared(_vector$1));if(b)for(let re=0,ae=b.length;re<ae;re++){const xe=b[re],le=this.morphTargetsRelative;for(let fe=0,ve=xe.count;fe<ve;fe++)_vector$1.fromBufferAttribute(xe,fe),le&&(_offset$1.fromBufferAttribute(_,fe),_vector$1.add(_offset$1)),ee=Math.max(ee,$.distanceToSquared(_vector$1))}this.boundingSphere.radius=Math.sqrt(ee),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const _=this.index,b=this.attributes;if(_===null||b.position===void 0||b.normal===void 0||b.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const $=b.position,ee=b.normal,re=b.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute$1(new Float32Array(4*$.count),4));const ae=this.getAttribute("tangent"),xe=[],le=[];for(let ct=0;ct<$.count;ct++)xe[ct]=new Vector3$1,le[ct]=new Vector3$1;const fe=new Vector3$1,ve=new Vector3$1,Se=new Vector3$1,Ee=new Vector2$1,Ce=new Vector2$1,Ie=new Vector2$1,De=new Vector3$1,Be=new Vector3$1;function Ne(ct,mt,_t){fe.fromBufferAttribute($,ct),ve.fromBufferAttribute($,mt),Se.fromBufferAttribute($,_t),Ee.fromBufferAttribute(re,ct),Ce.fromBufferAttribute(re,mt),Ie.fromBufferAttribute(re,_t),ve.sub(fe),Se.sub(fe),Ce.sub(Ee),Ie.sub(Ee);const Lt=1/(Ce.x*Ie.y-Ie.x*Ce.y);isFinite(Lt)&&(De.copy(ve).multiplyScalar(Ie.y).addScaledVector(Se,-Ce.y).multiplyScalar(Lt),Be.copy(Se).multiplyScalar(Ce.x).addScaledVector(ve,-Ie.x).multiplyScalar(Lt),xe[ct].add(De),xe[mt].add(De),xe[_t].add(De),le[ct].add(Be),le[mt].add(Be),le[_t].add(Be))}let qe=this.groups;qe.length===0&&(qe=[{start:0,count:_.count}]);for(let ct=0,mt=qe.length;ct<mt;++ct){const _t=qe[ct],Lt=_t.start,Vt=_t.count;for(let Gt=Lt,$t=Lt+Vt;Gt<$t;Gt+=3)Ne(_.getX(Gt+0),_.getX(Gt+1),_.getX(Gt+2))}const Xe=new Vector3$1,Ye=new Vector3$1,Qe=new Vector3$1,rt=new Vector3$1;function ot(ct){Qe.fromBufferAttribute(ee,ct),rt.copy(Qe);const mt=xe[ct];Xe.copy(mt),Xe.sub(Qe.multiplyScalar(Qe.dot(mt))).normalize(),Ye.crossVectors(rt,mt);const Lt=Ye.dot(le[ct])<0?-1:1;ae.setXYZW(ct,Xe.x,Xe.y,Xe.z,Lt)}for(let ct=0,mt=qe.length;ct<mt;++ct){const _t=qe[ct],Lt=_t.start,Vt=_t.count;for(let Gt=Lt,$t=Lt+Vt;Gt<$t;Gt+=3)ot(_.getX(Gt+0)),ot(_.getX(Gt+1)),ot(_.getX(Gt+2))}}computeVertexNormals(){const _=this.index,b=this.getAttribute("position");if(b!==void 0){let $=this.getAttribute("normal");if($===void 0)$=new BufferAttribute$1(new Float32Array(b.count*3),3),this.setAttribute("normal",$);else for(let Ee=0,Ce=$.count;Ee<Ce;Ee++)$.setXYZ(Ee,0,0,0);const ee=new Vector3$1,re=new Vector3$1,ae=new Vector3$1,xe=new Vector3$1,le=new Vector3$1,fe=new Vector3$1,ve=new Vector3$1,Se=new Vector3$1;if(_)for(let Ee=0,Ce=_.count;Ee<Ce;Ee+=3){const Ie=_.getX(Ee+0),De=_.getX(Ee+1),Be=_.getX(Ee+2);ee.fromBufferAttribute(b,Ie),re.fromBufferAttribute(b,De),ae.fromBufferAttribute(b,Be),ve.subVectors(ae,re),Se.subVectors(ee,re),ve.cross(Se),xe.fromBufferAttribute($,Ie),le.fromBufferAttribute($,De),fe.fromBufferAttribute($,Be),xe.add(ve),le.add(ve),fe.add(ve),$.setXYZ(Ie,xe.x,xe.y,xe.z),$.setXYZ(De,le.x,le.y,le.z),$.setXYZ(Be,fe.x,fe.y,fe.z)}else for(let Ee=0,Ce=b.count;Ee<Ce;Ee+=3)ee.fromBufferAttribute(b,Ee+0),re.fromBufferAttribute(b,Ee+1),ae.fromBufferAttribute(b,Ee+2),ve.subVectors(ae,re),Se.subVectors(ee,re),ve.cross(Se),$.setXYZ(Ee+0,ve.x,ve.y,ve.z),$.setXYZ(Ee+1,ve.x,ve.y,ve.z),$.setXYZ(Ee+2,ve.x,ve.y,ve.z);this.normalizeNormals(),$.needsUpdate=!0}}normalizeNormals(){const _=this.attributes.normal;for(let b=0,$=_.count;b<$;b++)_vector$1.fromBufferAttribute(_,b),_vector$1.normalize(),_.setXYZ(b,_vector$1.x,_vector$1.y,_vector$1.z)}toNonIndexed(){function _(xe,le){const fe=xe.array,ve=xe.itemSize,Se=xe.normalized,Ee=new fe.constructor(le.length*ve);let Ce=0,Ie=0;for(let De=0,Be=le.length;De<Be;De++){xe.isInterleavedBufferAttribute?Ce=le[De]*xe.data.stride+xe.offset:Ce=le[De]*ve;for(let Ne=0;Ne<ve;Ne++)Ee[Ie++]=fe[Ce++]}return new BufferAttribute$1(Ee,ve,Se)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const b=new Ip,$=this.index.array,ee=this.attributes;for(const xe in ee){const le=ee[xe],fe=_(le,$);b.setAttribute(xe,fe)}const re=this.morphAttributes;for(const xe in re){const le=[],fe=re[xe];for(let ve=0,Se=fe.length;ve<Se;ve++){const Ee=fe[ve],Ce=_(Ee,$);le.push(Ce)}b.morphAttributes[xe]=le}b.morphTargetsRelative=this.morphTargetsRelative;const ae=this.groups;for(let xe=0,le=ae.length;xe<le;xe++){const fe=ae[xe];b.addGroup(fe.start,fe.count,fe.materialIndex)}return b}toJSON(){const _={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_.uuid=this.uuid,_.type=this.type,this.name!==""&&(_.name=this.name),Object.keys(this.userData).length>0&&(_.userData=this.userData),this.parameters!==void 0){const le=this.parameters;for(const fe in le)le[fe]!==void 0&&(_[fe]=le[fe]);return _}_.data={attributes:{}};const b=this.index;b!==null&&(_.data.index={type:b.array.constructor.name,array:Array.prototype.slice.call(b.array)});const $=this.attributes;for(const le in $){const fe=$[le];_.data.attributes[le]=fe.toJSON(_.data)}const ee={};let re=!1;for(const le in this.morphAttributes){const fe=this.morphAttributes[le],ve=[];for(let Se=0,Ee=fe.length;Se<Ee;Se++){const Ce=fe[Se];ve.push(Ce.toJSON(_.data))}ve.length>0&&(ee[le]=ve,re=!0)}re&&(_.data.morphAttributes=ee,_.data.morphTargetsRelative=this.morphTargetsRelative);const ae=this.groups;ae.length>0&&(_.data.groups=JSON.parse(JSON.stringify(ae)));const xe=this.boundingSphere;return xe!==null&&(_.data.boundingSphere={center:xe.center.toArray(),radius:xe.radius}),_}clone(){return new this.constructor().copy(this)}copy(_){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const b={};this.name=_.name;const $=_.index;$!==null&&this.setIndex($.clone(b));const ee=_.attributes;for(const fe in ee){const ve=ee[fe];this.setAttribute(fe,ve.clone(b))}const re=_.morphAttributes;for(const fe in re){const ve=[],Se=re[fe];for(let Ee=0,Ce=Se.length;Ee<Ce;Ee++)ve.push(Se[Ee].clone(b));this.morphAttributes[fe]=ve}this.morphTargetsRelative=_.morphTargetsRelative;const ae=_.groups;for(let fe=0,ve=ae.length;fe<ve;fe++){const Se=ae[fe];this.addGroup(Se.start,Se.count,Se.materialIndex)}const xe=_.boundingBox;xe!==null&&(this.boundingBox=xe.clone());const le=_.boundingSphere;return le!==null&&(this.boundingSphere=le.clone()),this.drawRange.start=_.drawRange.start,this.drawRange.count=_.drawRange.count,this.userData=_.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};class BoxGeometry extends BufferGeometry$1{constructor(_=1,b=1,$=1,ee=1,re=1,ae=1){super(),this.type="BoxGeometry",this.parameters={width:_,height:b,depth:$,widthSegments:ee,heightSegments:re,depthSegments:ae};const xe=this;ee=Math.floor(ee),re=Math.floor(re),ae=Math.floor(ae);const le=[],fe=[],ve=[],Se=[];let Ee=0,Ce=0;Ie("z","y","x",-1,-1,$,b,_,ae,re,0),Ie("z","y","x",1,-1,$,b,-_,ae,re,1),Ie("x","z","y",1,1,_,$,b,ee,ae,2),Ie("x","z","y",1,-1,_,$,-b,ee,ae,3),Ie("x","y","z",1,-1,_,b,$,ee,re,4),Ie("x","y","z",-1,-1,_,b,-$,ee,re,5),this.setIndex(le),this.setAttribute("position",new Float32BufferAttribute$1(fe,3)),this.setAttribute("normal",new Float32BufferAttribute$1(ve,3)),this.setAttribute("uv",new Float32BufferAttribute$1(Se,2));function Ie(De,Be,Ne,qe,Xe,Ye,Qe,rt,ot,ct,mt){const _t=Ye/ot,Lt=Qe/ct,Vt=Ye/2,Gt=Qe/2,$t=rt/2,Qt=ot+1,vt=ct+1;let It=0,gt=0;const Tt=new Vector3$1;for(let Ct=0;Ct<vt;Ct++){const Ft=Ct*Lt-Gt;for(let sn=0;sn<Qt;sn++){const cn=sn*_t-Vt;Tt[De]=cn*qe,Tt[Be]=Ft*Xe,Tt[Ne]=$t,fe.push(Tt.x,Tt.y,Tt.z),Tt[De]=0,Tt[Be]=0,Tt[Ne]=rt>0?1:-1,ve.push(Tt.x,Tt.y,Tt.z),Se.push(sn/ot),Se.push(1-Ct/ct),It+=1}}for(let Ct=0;Ct<ct;Ct++)for(let Ft=0;Ft<ot;Ft++){const sn=Ee+Ft+Qt*Ct,cn=Ee+Ft+Qt*(Ct+1),en=Ee+(Ft+1)+Qt*(Ct+1),yn=Ee+(Ft+1)+Qt*Ct;le.push(sn,cn,yn),le.push(cn,en,yn),gt+=6}xe.addGroup(Ce,gt,mt),Ce+=gt,Ee+=It}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new BoxGeometry(_.width,_.height,_.depth,_.widthSegments,_.heightSegments,_.depthSegments)}}class PlaneGeometry extends BufferGeometry$1{constructor(_=1,b=1,$=1,ee=1){super(),this.type="PlaneGeometry",this.parameters={width:_,height:b,widthSegments:$,heightSegments:ee};const re=_/2,ae=b/2,xe=Math.floor($),le=Math.floor(ee),fe=xe+1,ve=le+1,Se=_/xe,Ee=b/le,Ce=[],Ie=[],De=[],Be=[];for(let Ne=0;Ne<ve;Ne++){const qe=Ne*Ee-ae;for(let Xe=0;Xe<fe;Xe++){const Ye=Xe*Se-re;Ie.push(Ye,-qe,0),De.push(0,0,1),Be.push(Xe/xe),Be.push(1-Ne/le)}}for(let Ne=0;Ne<le;Ne++)for(let qe=0;qe<xe;qe++){const Xe=qe+fe*Ne,Ye=qe+fe*(Ne+1),Qe=qe+1+fe*(Ne+1),rt=qe+1+fe*Ne;Ce.push(Xe,Ye,rt),Ce.push(Ye,Qe,rt)}this.setIndex(Ce),this.setAttribute("position",new Float32BufferAttribute$1(Ie,3)),this.setAttribute("normal",new Float32BufferAttribute$1(De,3)),this.setAttribute("uv",new Float32BufferAttribute$1(Be,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new PlaneGeometry(_.width,_.height,_.widthSegments,_.heightSegments)}}let _materialId$1=0,Material$1=class extends EventDispatcher$1{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_materialId$1++}),this.uuid=generateUUID$1(),this.name="",this.type="Material",this.blending=NormalBlending$1,this.side=FrontSide$1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor$1,this.blendDst=OneMinusSrcAlphaFactor$1,this.blendEquation=AddEquation$1,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Color$1(0,0,0),this.blendAlpha=0,this.depthFunc=LessEqualDepth$1,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc$1,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp$1,this.stencilZFail=KeepStencilOp$1,this.stencilZPass=KeepStencilOp$1,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(_){this._alphaTest>0!=_>0&&this.version++,this._alphaTest=_}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(_){if(_!==void 0)for(const b in _){const $=_[b];if($===void 0){console.warn(`THREE.Material: parameter '${b}' has value of undefined.`);continue}const ee=this[b];if(ee===void 0){console.warn(`THREE.Material: '${b}' is not a property of THREE.${this.type}.`);continue}ee&&ee.isColor?ee.set($):ee&&ee.isVector3&&$&&$.isVector3?ee.copy($):this[b]=$}}toJSON(_){const b=_===void 0||typeof _=="string";b&&(_={textures:{},images:{}});const $={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};$.uuid=this.uuid,$.type=this.type,this.name!==""&&($.name=this.name),this.color&&this.color.isColor&&($.color=this.color.getHex()),this.roughness!==void 0&&($.roughness=this.roughness),this.metalness!==void 0&&($.metalness=this.metalness),this.sheen!==void 0&&($.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&($.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&($.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&($.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&($.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&($.specular=this.specular.getHex()),this.specularIntensity!==void 0&&($.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&($.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&($.shininess=this.shininess),this.clearcoat!==void 0&&($.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&($.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&($.clearcoatMap=this.clearcoatMap.toJSON(_).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&($.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(_).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&($.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(_).uuid,$.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&($.dispersion=this.dispersion),this.iridescence!==void 0&&($.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&($.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&($.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&($.iridescenceMap=this.iridescenceMap.toJSON(_).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&($.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(_).uuid),this.anisotropy!==void 0&&($.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&($.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&($.anisotropyMap=this.anisotropyMap.toJSON(_).uuid),this.map&&this.map.isTexture&&($.map=this.map.toJSON(_).uuid),this.matcap&&this.matcap.isTexture&&($.matcap=this.matcap.toJSON(_).uuid),this.alphaMap&&this.alphaMap.isTexture&&($.alphaMap=this.alphaMap.toJSON(_).uuid),this.lightMap&&this.lightMap.isTexture&&($.lightMap=this.lightMap.toJSON(_).uuid,$.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&($.aoMap=this.aoMap.toJSON(_).uuid,$.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&($.bumpMap=this.bumpMap.toJSON(_).uuid,$.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&($.normalMap=this.normalMap.toJSON(_).uuid,$.normalMapType=this.normalMapType,$.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&($.displacementMap=this.displacementMap.toJSON(_).uuid,$.displacementScale=this.displacementScale,$.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&($.roughnessMap=this.roughnessMap.toJSON(_).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&($.metalnessMap=this.metalnessMap.toJSON(_).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&($.emissiveMap=this.emissiveMap.toJSON(_).uuid),this.specularMap&&this.specularMap.isTexture&&($.specularMap=this.specularMap.toJSON(_).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&($.specularIntensityMap=this.specularIntensityMap.toJSON(_).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&($.specularColorMap=this.specularColorMap.toJSON(_).uuid),this.envMap&&this.envMap.isTexture&&($.envMap=this.envMap.toJSON(_).uuid,this.combine!==void 0&&($.combine=this.combine)),this.envMapRotation!==void 0&&($.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&($.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&($.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&($.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&($.gradientMap=this.gradientMap.toJSON(_).uuid),this.transmission!==void 0&&($.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&($.transmissionMap=this.transmissionMap.toJSON(_).uuid),this.thickness!==void 0&&($.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&($.thicknessMap=this.thicknessMap.toJSON(_).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&($.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&($.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&($.size=this.size),this.shadowSide!==null&&($.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&($.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending$1&&($.blending=this.blending),this.side!==FrontSide$1&&($.side=this.side),this.vertexColors===!0&&($.vertexColors=!0),this.opacity<1&&($.opacity=this.opacity),this.transparent===!0&&($.transparent=!0),this.blendSrc!==SrcAlphaFactor$1&&($.blendSrc=this.blendSrc),this.blendDst!==OneMinusSrcAlphaFactor$1&&($.blendDst=this.blendDst),this.blendEquation!==AddEquation$1&&($.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&($.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&($.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&($.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&($.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&($.blendAlpha=this.blendAlpha),this.depthFunc!==LessEqualDepth$1&&($.depthFunc=this.depthFunc),this.depthTest===!1&&($.depthTest=this.depthTest),this.depthWrite===!1&&($.depthWrite=this.depthWrite),this.colorWrite===!1&&($.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&($.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AlwaysStencilFunc$1&&($.stencilFunc=this.stencilFunc),this.stencilRef!==0&&($.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&($.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==KeepStencilOp$1&&($.stencilFail=this.stencilFail),this.stencilZFail!==KeepStencilOp$1&&($.stencilZFail=this.stencilZFail),this.stencilZPass!==KeepStencilOp$1&&($.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&($.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&($.rotation=this.rotation),this.polygonOffset===!0&&($.polygonOffset=!0),this.polygonOffsetFactor!==0&&($.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&($.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&($.linewidth=this.linewidth),this.dashSize!==void 0&&($.dashSize=this.dashSize),this.gapSize!==void 0&&($.gapSize=this.gapSize),this.scale!==void 0&&($.scale=this.scale),this.dithering===!0&&($.dithering=!0),this.alphaTest>0&&($.alphaTest=this.alphaTest),this.alphaHash===!0&&($.alphaHash=!0),this.alphaToCoverage===!0&&($.alphaToCoverage=!0),this.premultipliedAlpha===!0&&($.premultipliedAlpha=!0),this.forceSinglePass===!0&&($.forceSinglePass=!0),this.wireframe===!0&&($.wireframe=!0),this.wireframeLinewidth>1&&($.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&($.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&($.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&($.flatShading=!0),this.visible===!1&&($.visible=!1),this.toneMapped===!1&&($.toneMapped=!1),this.fog===!1&&($.fog=!1),Object.keys(this.userData).length>0&&($.userData=this.userData);function ee(re){const ae=[];for(const xe in re){const le=re[xe];delete le.metadata,ae.push(le)}return ae}if(b){const re=ee(_.textures),ae=ee(_.images);re.length>0&&($.textures=re),ae.length>0&&($.images=ae)}return $}clone(){return new this.constructor().copy(this)}copy(_){this.name=_.name,this.blending=_.blending,this.side=_.side,this.vertexColors=_.vertexColors,this.opacity=_.opacity,this.transparent=_.transparent,this.blendSrc=_.blendSrc,this.blendDst=_.blendDst,this.blendEquation=_.blendEquation,this.blendSrcAlpha=_.blendSrcAlpha,this.blendDstAlpha=_.blendDstAlpha,this.blendEquationAlpha=_.blendEquationAlpha,this.blendColor.copy(_.blendColor),this.blendAlpha=_.blendAlpha,this.depthFunc=_.depthFunc,this.depthTest=_.depthTest,this.depthWrite=_.depthWrite,this.stencilWriteMask=_.stencilWriteMask,this.stencilFunc=_.stencilFunc,this.stencilRef=_.stencilRef,this.stencilFuncMask=_.stencilFuncMask,this.stencilFail=_.stencilFail,this.stencilZFail=_.stencilZFail,this.stencilZPass=_.stencilZPass,this.stencilWrite=_.stencilWrite;const b=_.clippingPlanes;let $=null;if(b!==null){const ee=b.length;$=new Array(ee);for(let re=0;re!==ee;++re)$[re]=b[re].clone()}return this.clippingPlanes=$,this.clipIntersection=_.clipIntersection,this.clipShadows=_.clipShadows,this.shadowSide=_.shadowSide,this.colorWrite=_.colorWrite,this.precision=_.precision,this.polygonOffset=_.polygonOffset,this.polygonOffsetFactor=_.polygonOffsetFactor,this.polygonOffsetUnits=_.polygonOffsetUnits,this.dithering=_.dithering,this.alphaTest=_.alphaTest,this.alphaHash=_.alphaHash,this.alphaToCoverage=_.alphaToCoverage,this.premultipliedAlpha=_.premultipliedAlpha,this.forceSinglePass=_.forceSinglePass,this.visible=_.visible,this.toneMapped=_.toneMapped,this.userData=JSON.parse(JSON.stringify(_.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_){_===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}};function cloneUniforms(H){const _={};for(const b in H){_[b]={};for(const $ in H[b]){const ee=H[b][$];ee&&(ee.isColor||ee.isMatrix3||ee.isMatrix4||ee.isVector2||ee.isVector3||ee.isVector4||ee.isTexture||ee.isQuaternion)?ee.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),_[b][$]=null):_[b][$]=ee.clone():Array.isArray(ee)?_[b][$]=ee.slice():_[b][$]=ee}}return _}function mergeUniforms(H){const _={};for(let b=0;b<H.length;b++){const $=cloneUniforms(H[b]);for(const ee in $)_[ee]=$[ee]}return _}function cloneUniformsGroups(H){const _=[];for(let b=0;b<H.length;b++)_.push(H[b].clone());return _}function getUnlitUniformColorSpace(H){const _=H.getRenderTarget();return _===null?H.outputColorSpace:_.isXRRenderTarget===!0?_.texture.colorSpace:ColorManagement$1.workingColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms},default_vertex=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,default_fragment=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`;class ShaderMaterial extends Material$1{constructor(_){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,_!==void 0&&this.setValues(_)}copy(_){return super.copy(_),this.fragmentShader=_.fragmentShader,this.vertexShader=_.vertexShader,this.uniforms=cloneUniforms(_.uniforms),this.uniformsGroups=cloneUniformsGroups(_.uniformsGroups),this.defines=Object.assign({},_.defines),this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.fog=_.fog,this.lights=_.lights,this.clipping=_.clipping,this.extensions=Object.assign({},_.extensions),this.glslVersion=_.glslVersion,this}toJSON(_){const b=super.toJSON(_);b.glslVersion=this.glslVersion,b.uniforms={};for(const ee in this.uniforms){const ae=this.uniforms[ee].value;ae&&ae.isTexture?b.uniforms[ee]={type:"t",value:ae.toJSON(_).uuid}:ae&&ae.isColor?b.uniforms[ee]={type:"c",value:ae.getHex()}:ae&&ae.isVector2?b.uniforms[ee]={type:"v2",value:ae.toArray()}:ae&&ae.isVector3?b.uniforms[ee]={type:"v3",value:ae.toArray()}:ae&&ae.isVector4?b.uniforms[ee]={type:"v4",value:ae.toArray()}:ae&&ae.isMatrix3?b.uniforms[ee]={type:"m3",value:ae.toArray()}:ae&&ae.isMatrix4?b.uniforms[ee]={type:"m4",value:ae.toArray()}:b.uniforms[ee]={value:ae}}Object.keys(this.defines).length>0&&(b.defines=this.defines),b.vertexShader=this.vertexShader,b.fragmentShader=this.fragmentShader,b.lights=this.lights,b.clipping=this.clipping;const $={};for(const ee in this.extensions)this.extensions[ee]===!0&&($[ee]=!0);return Object.keys($).length>0&&(b.extensions=$),b}}const _vector=new Vector3$1,_segCenter$1=new Vector3$1,_segDir$1=new Vector3$1,_diff$1=new Vector3$1,_edge1$1=new Vector3$1,_edge2$1=new Vector3$1,_normal=new Vector3$1;let Ray$1=class{constructor(_=new Vector3$1,b=new Vector3$1(0,0,-1)){this.origin=_,this.direction=b}set(_,b){return this.origin.copy(_),this.direction.copy(b),this}copy(_){return this.origin.copy(_.origin),this.direction.copy(_.direction),this}at(_,b){return b.copy(this.origin).addScaledVector(this.direction,_)}lookAt(_){return this.direction.copy(_).sub(this.origin).normalize(),this}recast(_){return this.origin.copy(this.at(_,_vector)),this}closestPointToPoint(_,b){b.subVectors(_,this.origin);const $=b.dot(this.direction);return $<0?b.copy(this.origin):b.copy(this.origin).addScaledVector(this.direction,$)}distanceToPoint(_){return Math.sqrt(this.distanceSqToPoint(_))}distanceSqToPoint(_){const b=_vector.subVectors(_,this.origin).dot(this.direction);return b<0?this.origin.distanceToSquared(_):(_vector.copy(this.origin).addScaledVector(this.direction,b),_vector.distanceToSquared(_))}distanceSqToSegment(_,b,$,ee){_segCenter$1.copy(_).add(b).multiplyScalar(.5),_segDir$1.copy(b).sub(_).normalize(),_diff$1.copy(this.origin).sub(_segCenter$1);const re=_.distanceTo(b)*.5,ae=-this.direction.dot(_segDir$1),xe=_diff$1.dot(this.direction),le=-_diff$1.dot(_segDir$1),fe=_diff$1.lengthSq(),ve=Math.abs(1-ae*ae);let Se,Ee,Ce,Ie;if(ve>0)if(Se=ae*le-xe,Ee=ae*xe-le,Ie=re*ve,Se>=0)if(Ee>=-Ie)if(Ee<=Ie){const De=1/ve;Se*=De,Ee*=De,Ce=Se*(Se+ae*Ee+2*xe)+Ee*(ae*Se+Ee+2*le)+fe}else Ee=re,Se=Math.max(0,-(ae*Ee+xe)),Ce=-Se*Se+Ee*(Ee+2*le)+fe;else Ee=-re,Se=Math.max(0,-(ae*Ee+xe)),Ce=-Se*Se+Ee*(Ee+2*le)+fe;else Ee<=-Ie?(Se=Math.max(0,-(-ae*re+xe)),Ee=Se>0?-re:Math.min(Math.max(-re,-le),re),Ce=-Se*Se+Ee*(Ee+2*le)+fe):Ee<=Ie?(Se=0,Ee=Math.min(Math.max(-re,-le),re),Ce=Ee*(Ee+2*le)+fe):(Se=Math.max(0,-(ae*re+xe)),Ee=Se>0?re:Math.min(Math.max(-re,-le),re),Ce=-Se*Se+Ee*(Ee+2*le)+fe);else Ee=ae>0?-re:re,Se=Math.max(0,-(ae*Ee+xe)),Ce=-Se*Se+Ee*(Ee+2*le)+fe;return $&&$.copy(this.origin).addScaledVector(this.direction,Se),ee&&ee.copy(_segCenter$1).addScaledVector(_segDir$1,Ee),Ce}intersectSphere(_,b){_vector.subVectors(_.center,this.origin);const $=_vector.dot(this.direction),ee=_vector.dot(_vector)-$*$,re=_.radius*_.radius;if(ee>re)return null;const ae=Math.sqrt(re-ee),xe=$-ae,le=$+ae;return le<0?null:xe<0?this.at(le,b):this.at(xe,b)}intersectsSphere(_){return this.distanceSqToPoint(_.center)<=_.radius*_.radius}distanceToPlane(_){const b=_.normal.dot(this.direction);if(b===0)return _.distanceToPoint(this.origin)===0?0:null;const $=-(this.origin.dot(_.normal)+_.constant)/b;return $>=0?$:null}intersectPlane(_,b){const $=this.distanceToPlane(_);return $===null?null:this.at($,b)}intersectsPlane(_){const b=_.distanceToPoint(this.origin);return b===0||_.normal.dot(this.direction)*b<0}intersectBox(_,b){let $,ee,re,ae,xe,le;const fe=1/this.direction.x,ve=1/this.direction.y,Se=1/this.direction.z,Ee=this.origin;return fe>=0?($=(_.min.x-Ee.x)*fe,ee=(_.max.x-Ee.x)*fe):($=(_.max.x-Ee.x)*fe,ee=(_.min.x-Ee.x)*fe),ve>=0?(re=(_.min.y-Ee.y)*ve,ae=(_.max.y-Ee.y)*ve):(re=(_.max.y-Ee.y)*ve,ae=(_.min.y-Ee.y)*ve),$>ae||re>ee||((re>$||isNaN($))&&($=re),(ae<ee||isNaN(ee))&&(ee=ae),Se>=0?(xe=(_.min.z-Ee.z)*Se,le=(_.max.z-Ee.z)*Se):(xe=(_.max.z-Ee.z)*Se,le=(_.min.z-Ee.z)*Se),$>le||xe>ee)||((xe>$||$!==$)&&($=xe),(le<ee||ee!==ee)&&(ee=le),ee<0)?null:this.at($>=0?$:ee,b)}intersectsBox(_){return this.intersectBox(_,_vector)!==null}intersectTriangle(_,b,$,ee,re){_edge1$1.subVectors(b,_),_edge2$1.subVectors($,_),_normal.crossVectors(_edge1$1,_edge2$1);let ae=this.direction.dot(_normal),xe;if(ae>0){if(ee)return null;xe=1}else if(ae<0)xe=-1,ae=-ae;else return null;_diff$1.subVectors(this.origin,_);const le=xe*this.direction.dot(_edge2$1.crossVectors(_diff$1,_edge2$1));if(le<0)return null;const fe=xe*this.direction.dot(_edge1$1.cross(_diff$1));if(fe<0||le+fe>ae)return null;const ve=-xe*_diff$1.dot(_normal);return ve<0?null:this.at(ve/ae,re)}applyMatrix4(_){return this.origin.applyMatrix4(_),this.direction.transformDirection(_),this}equals(_){return _.origin.equals(this.origin)&&_.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};const _v0$1=new Vector3$1,_v1=new Vector3$1,_v2=new Vector3$1,_v3$3=new Vector3$1,_vab$1=new Vector3$1,_vac$1=new Vector3$1,_vbc$1=new Vector3$1,_vap$1=new Vector3$1,_vbp$1=new Vector3$1,_vcp$1=new Vector3$1;let Triangle$1=class hl{constructor(_=new Vector3$1,b=new Vector3$1,$=new Vector3$1){this.a=_,this.b=b,this.c=$}static getNormal(_,b,$,ee){ee.subVectors($,b),_v0$1.subVectors(_,b),ee.cross(_v0$1);const re=ee.lengthSq();return re>0?ee.multiplyScalar(1/Math.sqrt(re)):ee.set(0,0,0)}static getBarycoord(_,b,$,ee,re){_v0$1.subVectors(ee,b),_v1.subVectors($,b),_v2.subVectors(_,b);const ae=_v0$1.dot(_v0$1),xe=_v0$1.dot(_v1),le=_v0$1.dot(_v2),fe=_v1.dot(_v1),ve=_v1.dot(_v2),Se=ae*fe-xe*xe;if(Se===0)return re.set(0,0,0),null;const Ee=1/Se,Ce=(fe*le-xe*ve)*Ee,Ie=(ae*ve-xe*le)*Ee;return re.set(1-Ce-Ie,Ie,Ce)}static containsPoint(_,b,$,ee){return this.getBarycoord(_,b,$,ee,_v3$3)===null?!1:_v3$3.x>=0&&_v3$3.y>=0&&_v3$3.x+_v3$3.y<=1}static getInterpolation(_,b,$,ee,re,ae,xe,le){return this.getBarycoord(_,b,$,ee,_v3$3)===null?(le.x=0,le.y=0,"z"in le&&(le.z=0),"w"in le&&(le.w=0),null):(le.setScalar(0),le.addScaledVector(re,_v3$3.x),le.addScaledVector(ae,_v3$3.y),le.addScaledVector(xe,_v3$3.z),le)}static isFrontFacing(_,b,$,ee){return _v0$1.subVectors($,b),_v1.subVectors(_,b),_v0$1.cross(_v1).dot(ee)<0}set(_,b,$){return this.a.copy(_),this.b.copy(b),this.c.copy($),this}setFromPointsAndIndices(_,b,$,ee){return this.a.copy(_[b]),this.b.copy(_[$]),this.c.copy(_[ee]),this}setFromAttributeAndIndices(_,b,$,ee){return this.a.fromBufferAttribute(_,b),this.b.fromBufferAttribute(_,$),this.c.fromBufferAttribute(_,ee),this}clone(){return new this.constructor().copy(this)}copy(_){return this.a.copy(_.a),this.b.copy(_.b),this.c.copy(_.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1.subVectors(this.a,this.b),_v0$1.cross(_v1).length()*.5}getMidpoint(_){return _.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(_){return hl.getNormal(this.a,this.b,this.c,_)}getPlane(_){return _.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(_,b){return hl.getBarycoord(_,this.a,this.b,this.c,b)}getInterpolation(_,b,$,ee,re){return hl.getInterpolation(_,this.a,this.b,this.c,b,$,ee,re)}containsPoint(_){return hl.containsPoint(_,this.a,this.b,this.c)}isFrontFacing(_){return hl.isFrontFacing(this.a,this.b,this.c,_)}intersectsBox(_){return _.intersectsTriangle(this)}closestPointToPoint(_,b){const $=this.a,ee=this.b,re=this.c;let ae,xe;_vab$1.subVectors(ee,$),_vac$1.subVectors(re,$),_vap$1.subVectors(_,$);const le=_vab$1.dot(_vap$1),fe=_vac$1.dot(_vap$1);if(le<=0&&fe<=0)return b.copy($);_vbp$1.subVectors(_,ee);const ve=_vab$1.dot(_vbp$1),Se=_vac$1.dot(_vbp$1);if(ve>=0&&Se<=ve)return b.copy(ee);const Ee=le*Se-ve*fe;if(Ee<=0&&le>=0&&ve<=0)return ae=le/(le-ve),b.copy($).addScaledVector(_vab$1,ae);_vcp$1.subVectors(_,re);const Ce=_vab$1.dot(_vcp$1),Ie=_vac$1.dot(_vcp$1);if(Ie>=0&&Ce<=Ie)return b.copy(re);const De=Ce*fe-le*Ie;if(De<=0&&fe>=0&&Ie<=0)return xe=fe/(fe-Ie),b.copy($).addScaledVector(_vac$1,xe);const Be=ve*Ie-Ce*Se;if(Be<=0&&Se-ve>=0&&Ce-Ie>=0)return _vbc$1.subVectors(re,ee),xe=(Se-ve)/(Se-ve+(Ce-Ie)),b.copy(ee).addScaledVector(_vbc$1,xe);const Ne=1/(Be+De+Ee);return ae=De*Ne,xe=Ee*Ne,b.copy($).addScaledVector(_vab$1,ae).addScaledVector(_vac$1,xe)}equals(_){return _.a.equals(this.a)&&_.b.equals(this.b)&&_.c.equals(this.c)}},MeshBasicMaterial$1=class extends Material$1{constructor(_){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color$1(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler$1,this.combine=MultiplyOperation$1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.fog=_.fog,this}};const _inverseMatrix$4=new Matrix4$1,_ray$4=new Ray$1,_sphere$2=new Sphere$1,_sphereHitAt$1=new Vector3$1,_vA=new Vector3$1,_vB=new Vector3$1,_vC=new Vector3$1,_tempA$1=new Vector3$1,_morphA$1=new Vector3$1,_uvA=new Vector2$1,_uvB=new Vector2$1,_uvC=new Vector2$1,_normalA$1=new Vector3$1,_normalB$1=new Vector3$1,_normalC$1=new Vector3$1,_intersectionPoint$1=new Vector3$1,_intersectionPointWorld$1=new Vector3$1;let Mesh$1=class extends Object3D$1{constructor(_=new BufferGeometry$1,b=new MeshBasicMaterial$1){super(),this.isMesh=!0,this.type="Mesh",this.geometry=_,this.material=b,this.updateMorphTargets()}copy(_,b){return super.copy(_,b),_.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=_.morphTargetInfluences.slice()),_.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},_.morphTargetDictionary)),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}updateMorphTargets(){const b=this.geometry.morphAttributes,$=Object.keys(b);if($.length>0){const ee=b[$[0]];if(ee!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let re=0,ae=ee.length;re<ae;re++){const xe=ee[re].name||String(re);this.morphTargetInfluences.push(0),this.morphTargetDictionary[xe]=re}}}}getVertexPosition(_,b){const $=this.geometry,ee=$.attributes.position,re=$.morphAttributes.position,ae=$.morphTargetsRelative;b.fromBufferAttribute(ee,_);const xe=this.morphTargetInfluences;if(re&&xe){_morphA$1.set(0,0,0);for(let le=0,fe=re.length;le<fe;le++){const ve=xe[le],Se=re[le];ve!==0&&(_tempA$1.fromBufferAttribute(Se,_),ae?_morphA$1.addScaledVector(_tempA$1,ve):_morphA$1.addScaledVector(_tempA$1.sub(b),ve))}b.add(_morphA$1)}return b}raycast(_,b){const $=this.geometry,ee=this.material,re=this.matrixWorld;ee!==void 0&&($.boundingSphere===null&&$.computeBoundingSphere(),_sphere$2.copy($.boundingSphere),_sphere$2.applyMatrix4(re),_ray$4.copy(_.ray).recast(_.near),!(_sphere$2.containsPoint(_ray$4.origin)===!1&&(_ray$4.intersectSphere(_sphere$2,_sphereHitAt$1)===null||_ray$4.origin.distanceToSquared(_sphereHitAt$1)>(_.far-_.near)**2))&&(_inverseMatrix$4.copy(re).invert(),_ray$4.copy(_.ray).applyMatrix4(_inverseMatrix$4),!($.boundingBox!==null&&_ray$4.intersectsBox($.boundingBox)===!1)&&this._computeIntersections(_,b,_ray$4)))}_computeIntersections(_,b,$){let ee;const re=this.geometry,ae=this.material,xe=re.index,le=re.attributes.position,fe=re.attributes.uv,ve=re.attributes.uv1,Se=re.attributes.normal,Ee=re.groups,Ce=re.drawRange;if(xe!==null)if(Array.isArray(ae))for(let Ie=0,De=Ee.length;Ie<De;Ie++){const Be=Ee[Ie],Ne=ae[Be.materialIndex],qe=Math.max(Be.start,Ce.start),Xe=Math.min(xe.count,Math.min(Be.start+Be.count,Ce.start+Ce.count));for(let Ye=qe,Qe=Xe;Ye<Qe;Ye+=3){const rt=xe.getX(Ye),ot=xe.getX(Ye+1),ct=xe.getX(Ye+2);ee=checkGeometryIntersection$1(this,Ne,_,$,fe,ve,Se,rt,ot,ct),ee&&(ee.faceIndex=Math.floor(Ye/3),ee.face.materialIndex=Be.materialIndex,b.push(ee))}}else{const Ie=Math.max(0,Ce.start),De=Math.min(xe.count,Ce.start+Ce.count);for(let Be=Ie,Ne=De;Be<Ne;Be+=3){const qe=xe.getX(Be),Xe=xe.getX(Be+1),Ye=xe.getX(Be+2);ee=checkGeometryIntersection$1(this,ae,_,$,fe,ve,Se,qe,Xe,Ye),ee&&(ee.faceIndex=Math.floor(Be/3),b.push(ee))}}else if(le!==void 0)if(Array.isArray(ae))for(let Ie=0,De=Ee.length;Ie<De;Ie++){const Be=Ee[Ie],Ne=ae[Be.materialIndex],qe=Math.max(Be.start,Ce.start),Xe=Math.min(le.count,Math.min(Be.start+Be.count,Ce.start+Ce.count));for(let Ye=qe,Qe=Xe;Ye<Qe;Ye+=3){const rt=Ye,ot=Ye+1,ct=Ye+2;ee=checkGeometryIntersection$1(this,Ne,_,$,fe,ve,Se,rt,ot,ct),ee&&(ee.faceIndex=Math.floor(Ye/3),ee.face.materialIndex=Be.materialIndex,b.push(ee))}}else{const Ie=Math.max(0,Ce.start),De=Math.min(le.count,Ce.start+Ce.count);for(let Be=Ie,Ne=De;Be<Ne;Be+=3){const qe=Be,Xe=Be+1,Ye=Be+2;ee=checkGeometryIntersection$1(this,ae,_,$,fe,ve,Se,qe,Xe,Ye),ee&&(ee.faceIndex=Math.floor(Be/3),b.push(ee))}}}};function checkIntersection$2(H,_,b,$,ee,re,ae,xe){let le;if(_.side===BackSide$1?le=$.intersectTriangle(ae,re,ee,!0,xe):le=$.intersectTriangle(ee,re,ae,_.side===FrontSide$1,xe),le===null)return null;_intersectionPointWorld$1.copy(xe),_intersectionPointWorld$1.applyMatrix4(H.matrixWorld);const fe=b.ray.origin.distanceTo(_intersectionPointWorld$1);return fe<b.near||fe>b.far?null:{distance:fe,point:_intersectionPointWorld$1.clone(),object:H}}function checkGeometryIntersection$1(H,_,b,$,ee,re,ae,xe,le,fe){H.getVertexPosition(xe,_vA),H.getVertexPosition(le,_vB),H.getVertexPosition(fe,_vC);const ve=checkIntersection$2(H,_,b,$,_vA,_vB,_vC,_intersectionPoint$1);if(ve){ee&&(_uvA.fromBufferAttribute(ee,xe),_uvB.fromBufferAttribute(ee,le),_uvC.fromBufferAttribute(ee,fe),ve.uv=Triangle$1.getInterpolation(_intersectionPoint$1,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2$1)),re&&(_uvA.fromBufferAttribute(re,xe),_uvB.fromBufferAttribute(re,le),_uvC.fromBufferAttribute(re,fe),ve.uv1=Triangle$1.getInterpolation(_intersectionPoint$1,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2$1)),ae&&(_normalA$1.fromBufferAttribute(ae,xe),_normalB$1.fromBufferAttribute(ae,le),_normalC$1.fromBufferAttribute(ae,fe),ve.normal=Triangle$1.getInterpolation(_intersectionPoint$1,_vA,_vB,_vC,_normalA$1,_normalB$1,_normalC$1,new Vector3$1),ve.normal.dot($.direction)>0&&ve.normal.multiplyScalar(-1));const Se={a:xe,b:le,c:fe,normal:new Vector3$1,materialIndex:0};Triangle$1.getNormal(_vA,_vB,_vC,Se.normal),ve.face=Se}return ve}const alphahash_fragment=`
#ifdef USE_ALPHAHASH

	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;

#endif
`,alphahash_pars_fragment=`
#ifdef USE_ALPHAHASH

	/**
	 * See: https://casual-effects.com/research/Wyman2017Hashed/index.html
	 */

	const float ALPHA_HASH_SCALE = 0.05; // Derived from trials only, and may be changed.

	float hash2D( vec2 value ) {

		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );

	}

	float hash3D( vec3 value ) {

		return hash2D( vec2( hash2D( value.xy ), value.z ) );

	}

	float getAlphaHashThreshold( vec3 position ) {

		// Find the discretized derivatives of our coordinates
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );

		// Find two nearest log-discretized noise scales
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);

		// Compute alpha thresholds at our two noise scales
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);

		// Factor to interpolate lerp with
		float lerpFactor = fract( log2( pixScale ) );

		// Interpolate alpha threshold from noise at two scales
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;

		// Pass into CDF to compute uniformly distrib threshold
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);

		// Find our final, uniformly distributed alpha threshold ()
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;

		// Avoids  == 0. Could also do  =1-
		return clamp( threshold , 1.0e-6, 1.0 );

	}

#endif
`,alphamap_fragment=`
#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;

#endif
`,alphamap_pars_fragment=`
#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`,alphatest_fragment=`
#ifdef USE_ALPHATEST

	#ifdef ALPHA_TO_COVERAGE

	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;

	#else

	if ( diffuseColor.a < alphaTest ) discard;

	#endif

#endif
`,alphatest_pars_fragment=`
#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif
`,aomap_fragment=`
#ifdef USE_AOMAP

	// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;

	reflectedLight.indirectDiffuse *= ambientOcclusion;

	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif

	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif

	#if defined( USE_ENVMAP ) && defined( STANDARD )

		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );

		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );

	#endif

#endif
`,aomap_pars_fragment=`
#ifdef USE_AOMAP

	uniform sampler2D aoMap;
	uniform float aoMapIntensity;

#endif
`,batching_pars_vertex=`
#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif

	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {

		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );

	}

	float getIndirectIndex( const in int i ) {

		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );

	}

#endif

#ifdef USE_BATCHING_COLOR

	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {

		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;

	}

#endif
`,batching_vertex=`
#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif
`,begin_vertex=`
vec3 transformed = vec3( position );

#ifdef USE_ALPHAHASH

	vPosition = vec3( position );

#endif
`,beginnormal_vertex=`
vec3 objectNormal = vec3( normal );

#ifdef USE_TANGENT

	vec3 objectTangent = vec3( tangent.xyz );

#endif
`,bsdfs=`

float G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {

	// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)
	return 0.25;

}

float D_BlinnPhong( const in float shininess, const in float dotNH ) {

	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );

}

vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( specularColor, 1.0, dotVH );

	float G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );

	float D = D_BlinnPhong( shininess, dotNH );

	return F * ( G * D );

} // validated

`,iridescence_fragment=`

#ifdef USE_IRIDESCENCE

	// XYZ to linear-sRGB color space
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);

	// Assume air interface for top
	// Note: We don't handle the case fresnel0 == 1
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {

		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );

	}

	// Conversion FO/IOR
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {

		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );

	}

	// ior is a value between 1.0 and 3.0. 1.0 is air interface
	float IorToFresnel0( float transmittedIor, float incidentIor ) {

		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));

	}

	// Fresnel equations for dielectric/dielectric interfaces.
	// Ref: https://belcour.github.io/blog/research/2017/05/01/brdf-thin-film.html
	// Evaluation XYZ sensitivity curves in Fourier space
	vec3 evalSensitivity( float OPD, vec3 shift ) {

		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );

		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;

		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;

	}

	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {

		vec3 I;

		// Force iridescenceIOR -> outsideIOR when thinFilmThickness -> 0.0
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		// Evaluate the cosTheta on the base layer (Snell law)
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );

		// Handle TIR:
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {

			return vec3( 1.0 );

		}

		float cosTheta2 = sqrt( cosTheta2Sq );

		// First interface
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;

		// Second interface
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) ); // guard against 1.0
		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;

		// Phase shift
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;

		// Compound terms
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );

		// Reflectance term for m = 0 (DC term amplitude)
		vec3 C0 = R12 + Rs;
		I = C0;

		// Reflectance term for m > 0 (pairs of diracs)
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {

			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;

		}

		// Since out of gamut colors might be produced, negative color values are clamped to 0.
		return max( I, vec3( 0.0 ) );

	}

#endif

`,bumpmap_pars_fragment=`
#ifdef USE_BUMPMAP

	uniform sampler2D bumpMap;
	uniform float bumpScale;

	// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen
	// https://mmikk.github.io/papers3d/mm_sfgrad_bump.pdf

	// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)

	vec2 dHdxy_fwd() {

		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );

		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;

		return vec2( dBx, dBy );

	}

	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {

		// normalize is done to ensure that the bump map looks the same regardless of the texture's scale
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm; // normalized

		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );

		float fDet = dot( vSigmaX, R1 ) * faceDirection;

		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );

	}

#endif
`,clipping_planes_fragment=`
#if NUM_CLIPPING_PLANES > 0

	vec4 plane;

	#ifdef ALPHA_TO_COVERAGE

		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;

		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {

			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );

			if ( clipOpacity == 0.0 ) discard;

		}
		#pragma unroll_loop_end

		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES

			float unionClipOpacity = 1.0;

			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {

				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );

			}
			#pragma unroll_loop_end

			clipOpacity *= 1.0 - unionClipOpacity;

		#endif

		diffuseColor.a *= clipOpacity;

		if ( diffuseColor.a == 0.0 ) discard;

	#else

		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {

			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;

		}
		#pragma unroll_loop_end

		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES

			bool clipped = true;

			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {

				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;

			}
			#pragma unroll_loop_end

			if ( clipped ) discard;

		#endif

	#endif

#endif
`,clipping_planes_pars_fragment=`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];

#endif
`,clipping_planes_pars_vertex=`
#if NUM_CLIPPING_PLANES > 0

	varying vec3 vClipPosition;

#endif
`,clipping_planes_vertex=`
#if NUM_CLIPPING_PLANES > 0

	vClipPosition = - mvPosition.xyz;

#endif
`,color_fragment=`
#if defined( USE_COLOR_ALPHA )

	diffuseColor *= vColor;

#elif defined( USE_COLOR )

	diffuseColor.rgb *= vColor;

#endif
`,color_pars_fragment=`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR )

	varying vec3 vColor;

#endif
`,color_pars_vertex=`
#if defined( USE_COLOR_ALPHA )

	varying vec4 vColor;

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )

	varying vec3 vColor;

#endif
`,color_vertex=`
#if defined( USE_COLOR_ALPHA )

	vColor = vec4( 1.0 );

#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )

	vColor = vec3( 1.0 );

#endif

#ifdef USE_COLOR

	vColor *= color;

#endif

#ifdef USE_INSTANCING_COLOR

	vColor.xyz *= instanceColor.xyz;

#endif

#ifdef USE_BATCHING_COLOR

	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );

	vColor.xyz *= batchingColor.xyz;

#endif
`,common=`
#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6

#ifndef saturate
// <tonemapping_pars_fragment> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )

float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }

// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.
// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand( const in vec2 uv ) {

	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );

	return fract( sin( sn ) * c );

}

#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif

struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};

struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};

#ifdef USE_ALPHAHASH

	varying vec3 vPosition;

#endif

vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

}

vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {

	// dir can be either a direction vector or a normal vector
	// upper-left 3x3 of matrix is assumed to be orthogonal

	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );

}

mat3 transposeMat3( const in mat3 m ) {

	mat3 tmp;

	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );

	return tmp;

}

bool isPerspectiveMatrix( mat4 m ) {

	return m[ 2 ][ 3 ] == - 1.0;

}

vec2 equirectUv( in vec3 dir ) {

	// dir is assumed to be unit length

	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;

	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;

	return vec2( u, v );

}

vec3 BRDF_Lambert( const in vec3 diffuseColor ) {

	return RECIPROCAL_PI * diffuseColor;

} // validated

vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated

float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {

	// Original approximation by Christophe Schlick '94
	// float fresnel = pow( 1.0 - dotVH, 5.0 );

	// Optimized variant (presented by Epic at SIGGRAPH '13)
	// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );

	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );

} // validated
`,cube_uv_reflection_fragment=`
#ifdef ENVMAP_TYPE_CUBE_UV

	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0

	// These shader functions convert between the UV coordinates of a single face of
	// a cubemap, the 0-5 integer index of a cube face, and the direction vector for
	// sampling a textureCube (not generally normalized ).

	float getFace( vec3 direction ) {

		vec3 absDirection = abs( direction );

		float face = - 1.0;

		if ( absDirection.x > absDirection.z ) {

			if ( absDirection.x > absDirection.y )

				face = direction.x > 0.0 ? 0.0 : 3.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		} else {

			if ( absDirection.z > absDirection.y )

				face = direction.z > 0.0 ? 2.0 : 5.0;

			else

				face = direction.y > 0.0 ? 1.0 : 4.0;

		}

		return face;

	}

	// RH coordinate system; PMREM face-indexing convention
	vec2 getUV( vec3 direction, float face ) {

		vec2 uv;

		if ( face == 0.0 ) {

			uv = vec2( direction.z, direction.y ) / abs( direction.x ); // pos x

		} else if ( face == 1.0 ) {

			uv = vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y

		} else if ( face == 2.0 ) {

			uv = vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z

		} else if ( face == 3.0 ) {

			uv = vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x

		} else if ( face == 4.0 ) {

			uv = vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y

		} else {

			uv = vec2( direction.x, direction.y ) / abs( direction.z ); // neg z

		}

		return 0.5 * ( uv + 1.0 );

	}

	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {

		float face = getFace( direction );

		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );

		mipInt = max( mipInt, cubeUV_minMipLevel );

		float faceSize = exp2( mipInt );

		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0; // #25071

		if ( face > 2.0 ) {

			uv.y += faceSize;

			face -= 3.0;

		}

		uv.x += face * faceSize;

		uv.x += filterInt * 3.0 * cubeUV_minTileSize;

		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );

		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;

		#ifdef texture2DGradEXT

			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb; // disable anisotropic filtering

		#else

			return texture2D( envMap, uv ).rgb;

		#endif

	}

	// These defines must match with PMREMGenerator

	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0

	float roughnessToMip( float roughness ) {

		float mip = 0.0;

		if ( roughness >= cubeUV_r1 ) {

			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;

		} else if ( roughness >= cubeUV_r4 ) {

			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;

		} else if ( roughness >= cubeUV_r5 ) {

			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;

		} else if ( roughness >= cubeUV_r6 ) {

			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;

		} else {

			mip = - 2.0 * log2( 1.16 * roughness ); // 1.16 = 1.79^0.25
		}

		return mip;

	}

	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {

		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );

		float mipF = fract( mip );

		float mipInt = floor( mip );

		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );

		if ( mipF == 0.0 ) {

			return vec4( color0, 1.0 );

		} else {

			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );

			return vec4( mix( color0, color1, mipF ), 1.0 );

		}

	}

#endif
`,defaultnormal_vertex=`

vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT

	vec3 transformedTangent = objectTangent;

#endif

#ifdef USE_BATCHING

	// this is in lieu of a per-instance normal-matrix
	// shear transforms in the instance matrix are not supported

	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;

	#ifdef USE_TANGENT

		transformedTangent = bm * transformedTangent;

	#endif

#endif

#ifdef USE_INSTANCING

	// this is in lieu of a per-instance normal-matrix
	// shear transforms in the instance matrix are not supported

	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;

	#ifdef USE_TANGENT

		transformedTangent = im * transformedTangent;

	#endif

#endif

transformedNormal = normalMatrix * transformedNormal;

#ifdef FLIP_SIDED

	transformedNormal = - transformedNormal;

#endif

#ifdef USE_TANGENT

	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;

	#ifdef FLIP_SIDED

		transformedTangent = - transformedTangent;

	#endif

#endif
`,displacementmap_pars_vertex=`
#ifdef USE_DISPLACEMENTMAP

	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;

#endif
`,displacementmap_vertex=`
#ifdef USE_DISPLACEMENTMAP

	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );

#endif
`,emissivemap_fragment=`
#ifdef USE_EMISSIVEMAP

	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );

	totalEmissiveRadiance *= emissiveColor.rgb;

#endif
`,emissivemap_pars_fragment=`
#ifdef USE_EMISSIVEMAP

	uniform sampler2D emissiveMap;

#endif
`,colorspace_fragment=`
gl_FragColor = linearToOutputTexel( gl_FragColor );
`,colorspace_pars_fragment=`

// http://www.russellcottrell.com/photo/matrixCalculator.htm

// Linear sRGB => XYZ => Linear Display P3
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);

// Linear Display P3 => XYZ => Linear sRGB
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);

vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}

vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}

vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}

vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}

`,envmap_fragment=`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vec3 cameraToFrag;

		if ( isOrthographic ) {

			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToFrag = normalize( vWorldPosition - cameraPosition );

		}

		// Transforming Normal Vectors with the Inverse Transformation
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vec3 reflectVec = reflect( cameraToFrag, worldNormal );

		#else

			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );

		#endif

	#else

		vec3 reflectVec = vReflect;

	#endif

	#ifdef ENVMAP_TYPE_CUBE

		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );

	#else

		vec4 envColor = vec4( 0.0 );

	#endif

	#ifdef ENVMAP_BLENDING_MULTIPLY

		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_MIX )

		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );

	#elif defined( ENVMAP_BLENDING_ADD )

		outgoingLight += envColor.xyz * specularStrength * reflectivity;

	#endif

#endif
`,envmap_common_pars_fragment=`
#ifdef USE_ENVMAP

	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;

	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif
`,envmap_pars_fragment=`
#ifdef USE_ENVMAP

	uniform float reflectivity;

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS

		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif

#endif
`,envmap_pars_vertex=`
#ifdef USE_ENVMAP

	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )

		#define ENV_WORLDPOS

	#endif

	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;

	#else

		varying vec3 vReflect;
		uniform float refractionRatio;

	#endif

#endif
`,envmap_vertex=`
#ifdef USE_ENVMAP

	#ifdef ENV_WORLDPOS

		vWorldPosition = worldPosition.xyz;

	#else

		vec3 cameraToVertex;

		if ( isOrthographic ) {

			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );

		} else {

			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );

		}

		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );

		#ifdef ENVMAP_MODE_REFLECTION

			vReflect = reflect( cameraToVertex, worldNormal );

		#else

			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );

		#endif

	#endif

#endif
`,fog_vertex=`
#ifdef USE_FOG

	vFogDepth = - mvPosition.z;

#endif
`,fog_pars_vertex=`
#ifdef USE_FOG

	varying float vFogDepth;

#endif
`,fog_fragment=`
#ifdef USE_FOG

	#ifdef FOG_EXP2

		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );

	#else

		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );

	#endif

	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );

#endif
`,fog_pars_fragment=`
#ifdef USE_FOG

	uniform vec3 fogColor;
	varying float vFogDepth;

	#ifdef FOG_EXP2

		uniform float fogDensity;

	#else

		uniform float fogNear;
		uniform float fogFar;

	#endif

#endif
`,gradientmap_pars_fragment=`

#ifdef USE_GRADIENTMAP

	uniform sampler2D gradientMap;

#endif

vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {

	// dotNL will be from -1.0 to 1.0
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );

	#ifdef USE_GRADIENTMAP

		return vec3( texture2D( gradientMap, coord ).r );

	#else

		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );

	#endif

}
`,lightmap_pars_fragment=`
#ifdef USE_LIGHTMAP

	uniform sampler2D lightMap;
	uniform float lightMapIntensity;

#endif
`,lights_lambert_fragment=`
LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;
`,lights_lambert_pars_fragment=`
varying vec3 vViewPosition;

struct LambertMaterial {

	vec3 diffuseColor;
	float specularStrength;

};

void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert
`,lights_pars_begin=`
uniform bool receiveShadow;
uniform vec3 ambientLightColor;

#if defined( USE_LIGHT_PROBES )

	uniform vec3 lightProbe[ 9 ];

#endif

// get the irradiance (radiance convolved with cosine lobe) at the point 'normal' on the unit sphere
// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {

	// normal is assumed to have unit length

	float x = normal.x, y = normal.y, z = normal.z;

	// band 0
	vec3 result = shCoefficients[ 0 ] * 0.886227;

	// band 1
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;

	// band 2
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );

	return result;

}

vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {

	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );

	return irradiance;

}

vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {

	vec3 irradiance = ambientLightColor;

	return irradiance;

}

float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {

	// based upon Frostbite 3 Moving to Physically-based Rendering
	// page 32, equation 26: E[window1]
	// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );

	if ( cutoffDistance > 0.0 ) {

		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );

	}

	return distanceFalloff;

}

float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {

	return smoothstep( coneCosine, penumbraCosine, angleCosine );

}

#if NUM_DIR_LIGHTS > 0

	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};

	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];

	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {

		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;

	}

#endif


#if NUM_POINT_LIGHTS > 0

	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};

	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {

		vec3 lVector = pointLight.position - geometryPosition;

		light.direction = normalize( lVector );

		float lightDistance = length( lVector );

		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );

	}

#endif


#if NUM_SPOT_LIGHTS > 0

	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};

	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];

	// light is an out parameter as having it as a return value caused compiler errors on some devices
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {

		vec3 lVector = spotLight.position - geometryPosition;

		light.direction = normalize( lVector );

		float angleCos = dot( light.direction, spotLight.direction );

		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );

		if ( spotAttenuation > 0.0 ) {

			float lightDistance = length( lVector );

			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );

		} else {

			light.color = vec3( 0.0 );
			light.visible = false;

		}

	}

#endif


#if NUM_RECT_AREA_LIGHTS > 0

	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};

	// Pre-computed values of LinearTransformedCosine approximation of BRDF
	// BRDF approximation Texture is 64x64
	uniform sampler2D ltc_1; // RGBA Float
	uniform sampler2D ltc_2; // RGBA Float

	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];

#endif


#if NUM_HEMI_LIGHTS > 0

	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};

	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];

	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {

		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;

		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );

		return irradiance;

	}

#endif
`,envmap_physical_pars_fragment=`
#ifdef USE_ENVMAP

	vec3 getIBLIrradiance( const in vec3 normal ) {

		#ifdef ENVMAP_TYPE_CUBE_UV

			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );

			return PI * envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {

		#ifdef ENVMAP_TYPE_CUBE_UV

			vec3 reflectVec = reflect( - viewDir, normal );

			// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );

			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );

			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );

			return envMapColor.rgb * envMapIntensity;

		#else

			return vec3( 0.0 );

		#endif

	}

	#ifdef USE_ANISOTROPY

		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {

			#ifdef ENVMAP_TYPE_CUBE_UV

			  // https://google.github.io/filament/Filament.md.html#lighting/imagebasedlights/anisotropy
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );

				return getIBLRadiance( viewDir, bentNormal, roughness );

			#else

				return vec3( 0.0 );

			#endif

		}

	#endif

#endif
`,lights_toon_fragment=`
ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
`,lights_toon_pars_fragment=`
varying vec3 vViewPosition;

struct ToonMaterial {

	vec3 diffuseColor;

};

void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
`,lights_phong_fragment=`
BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;
`,lights_phong_pars_fragment=`
varying vec3 vViewPosition;

struct BlinnPhongMaterial {

	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;

};

void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;

}

void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
`,lights_physical_fragment=`
PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );

vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );

material.roughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );

#ifdef IOR

	material.ior = ior;

	#ifdef USE_SPECULAR

		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;

		#ifdef USE_SPECULAR_COLORMAP

			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;

		#endif

		#ifdef USE_SPECULAR_INTENSITYMAP

			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;

		#endif

		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );

	#else

		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;

	#endif

	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );

#else

	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;

#endif

#ifdef USE_CLEARCOAT

	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;

	#ifdef USE_CLEARCOATMAP

		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;

	#endif

	#ifdef USE_CLEARCOAT_ROUGHNESSMAP

		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;

	#endif

	material.clearcoat = saturate( material.clearcoat ); // Burley clearcoat model
	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );

#endif

#ifdef USE_DISPERSION

	material.dispersion = dispersion;

#endif

#ifdef USE_IRIDESCENCE

	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;

	#ifdef USE_IRIDESCENCEMAP

		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;

	#endif

	#ifdef USE_IRIDESCENCE_THICKNESSMAP

		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;

	#else

		material.iridescenceThickness = iridescenceThicknessMaximum;

	#endif

#endif

#ifdef USE_SHEEN

	material.sheenColor = sheenColor;

	#ifdef USE_SHEEN_COLORMAP

		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;

	#endif

	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );

	#ifdef USE_SHEEN_ROUGHNESSMAP

		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;

	#endif

#endif

#ifdef USE_ANISOTROPY

	#ifdef USE_ANISOTROPYMAP

		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;

	#else

		vec2 anisotropyV = anisotropyVector;

	#endif

	material.anisotropy = length( anisotropyV );

	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}

	// Roughness along the anisotropy bitangent is the material roughness, while the tangent roughness increases with anisotropy.
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );

	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;

#endif
`,lights_physical_pars_fragment=`

struct PhysicalMaterial {

	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;

	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif

	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif

	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif

	#ifdef IOR
		float ior;
	#endif

	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif

	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif

};

// temporary
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );

vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );

    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}

// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2
// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {

	float a2 = pow2( alpha );

	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );

	return 0.5 / max( gv + gl, EPSILON );

}

// Microfacet Models for Refraction through Rough Surfaces - equation (33)
// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html
// alpha is "roughness squared" in Disneys reparameterization
float D_GGX( const in float alpha, const in float dotNH ) {

	float a2 = pow2( alpha );

	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1

	return RECIPROCAL_PI * a2 / pow2( denom );

}

// https://google.github.io/filament/Filament.md.html#materialsystem/anisotropicmodel/anisotropicspecularbrdf
#ifdef USE_ANISOTROPY

	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {

		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );

		return saturate(v);

	}

	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {

		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;

		return RECIPROCAL_PI * a2 * pow2 ( w2 );

	}

#endif

#ifdef USE_CLEARCOAT

	// GGX Distribution, Schlick Fresnel, GGX_SmithCorrelated Visibility
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {

		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;

		float alpha = pow2( roughness ); // UE4's roughness

		vec3 halfDir = normalize( lightDir + viewDir );

		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );

		vec3 F = F_Schlick( f0, f90, dotVH );

		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

		float D = D_GGX( alpha, dotNH );

		return F * ( V * D );

	}

#endif

vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {

	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;

	float alpha = pow2( roughness ); // UE4's roughness

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );

	vec3 F = F_Schlick( f0, f90, dotVH );

	#ifdef USE_IRIDESCENCE

		F = mix( F, material.iridescenceFresnel, material.iridescence );

	#endif

	#ifdef USE_ANISOTROPY

		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );

		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );

		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );

	#else

		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );

		float D = D_GGX( alpha, dotNH );

	#endif

	return F * ( V * D );

}

// Rect Area Light

// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines
// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt
// code: https://github.com/selfshadow/ltc_code/

vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	float dotNV = saturate( dot( N, V ) );

	// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );

	uv = uv * LUT_SCALE + LUT_BIAS;

	return uv;

}

float LTC_ClippedSphereFormFactor( const in vec3 f ) {

	// Real-Time Area Lighting: a Journey from Research to Production (p.102)
	// An approximation of the form factor of a horizon-clipped rectangle.

	float l = length( f );

	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );

}

vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {

	float x = dot( v1, v2 );

	float y = abs( x );

	// rational polynomial approximation to theta / sin( theta ) / 2PI
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;

	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;

	return cross( v1, v2 ) * theta_sintheta;

}

vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {

	// bail if point is on back side of plane of light
	// assumes ccw winding order of light vertices
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );

	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );

	// construct orthonormal basis around N
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system

	// compute transform
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );

	// transform rect
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );

	// project rect onto sphere
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );

	// calculate vector form factor
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );

	// adjust for horizon clipping
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );

/*
	// alternate method of adjusting for horizon clipping (see referece)
	// refactoring required
	float len = length( vectorFormFactor );
	float z = vectorFormFactor.z / len;

	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;

	// tabulated horizon-clipped sphere, apparently...
	vec2 uv = vec2( z * 0.5 + 0.5, len );
	uv = uv * LUT_SCALE + LUT_BIAS;

	float scale = texture2D( ltc_2, uv ).w;

	float result = len * scale;
*/

	return vec3( result );

}

// End Rect Area Light

#if defined( USE_SHEEN )

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float D_Charlie( float roughness, float dotNH ) {

	float alpha = pow2( roughness );

	// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF"
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16

	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );

}

// https://github.com/google/filament/blob/master/shaders/src/brdf.fs
float V_Neubelt( float dotNV, float dotNL ) {

	// Neubelt and Pettineo 2013, "Crafting a Next-gen Material Pipeline for The Order: 1886"
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );

}

vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );

	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );

	return sheenColor * ( D * V );

}

#endif

// This is a curve-fit approxmation to the "Charlie sheen" BRDF integrated over the hemisphere from 
// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF". The analysis can be found
// in the Sheen section of https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	float r2 = roughness * roughness;

	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;

	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;

	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );

	return saturate( DG * RECIPROCAL_PI );

}

// Analytical approximation of the DFG LUT, one half of the
// split-sum approximation used in indirect specular lighting.
// via 'environmentBRDF' from "Physically Based Shading on Mobile"
// https://www.unrealengine.com/blog/physically-based-shading-on-mobile
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {

	float dotNV = saturate( dot( normal, viewDir ) );

	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );

	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );

	vec4 r = roughness * c0 + c1;

	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;

	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;

	return fab;

}

vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	return specularColor * fab.x + specularF90 * fab.y;

}

// Fdez-Agera's "Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting"
// Approximates multiscattering in order to preserve energy.
// http://www.jcgt.org/published/0008/01/03/
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif

	vec2 fab = DFGApprox( normal, viewDir, roughness );

	#ifdef USE_IRIDESCENCE

		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );

	#else

		vec3 Fr = specularColor;

	#endif

	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;

	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;

	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619; // 1/21
	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );

	singleScatter += FssEss;
	multiScatter += Fms * Ems;

}

#if NUM_RECT_AREA_LIGHTS > 0

	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;

		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction
		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;

		vec2 uv = LTC_Uv( normal, viewDir, roughness );

		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );

		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);

		// LTC Fresnel Approximation by Stephen Hill
		// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );

		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );

		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );

	}

#endif

void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );

	vec3 irradiance = dotNL * directLight.color;

	#ifdef USE_CLEARCOAT

		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );

		vec3 ccIrradiance = dotNLcc * directLight.color;

		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );

	#endif

	#ifdef USE_SHEEN

		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );

	#endif

	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}

void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {

	#ifdef USE_CLEARCOAT

		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );

	#endif

	#ifdef USE_SHEEN

		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );

	#endif

	// Both indirect specular and indirect diffuse light accumulate here

	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;

	#ifdef USE_IRIDESCENCE

		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );

	#else

		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );

	#endif

	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );

	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;

	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;

}

#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical

// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {

	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );

}
`,lights_fragment_begin=`
/**
 * This is a template that can be used to light a material, it uses pluggable
 * RenderEquations (RE)for specific lighting scenarios.
 *
 * Instructions for use:
 * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined
 * - Create a material parameter that is to be passed as the third parameter to your lighting functions.
 *
 * TODO:
 * - Add area light support.
 * - Add sphere light support.
 * - Add diffuse light probe (irradiance cubemap) support.
 */

vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );

vec3 geometryClearcoatNormal = vec3( 0.0 );

#ifdef USE_CLEARCOAT

	geometryClearcoatNormal = clearcoatNormal;

#endif

#ifdef USE_IRIDESCENCE

	float dotNVi = saturate( dot( normal, geometryViewDir ) );

	if ( material.iridescenceThickness == 0.0 ) {

		material.iridescence = 0.0;

	} else {

		material.iridescence = saturate( material.iridescence );

	}

	if ( material.iridescence > 0.0 ) {

		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );

		// Iridescence F0 approximation
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );

	}

#endif

IncidentLight directLight;

#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )

	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		pointLight = pointLights[ i ];

		getPointLightInfo( pointLight, geometryPosition, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif

		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )

	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;

	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		spotLight = spotLights[ i ];

		getSpotLightInfo( spotLight, geometryPosition, directLight );

		// spot lights are ordered [shadows with maps, shadows without maps, maps without shadows, none]
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif

		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif

		#undef SPOT_LIGHT_MAP_INDEX

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )

	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];

		getDirectionalLightInfo( directionalLight, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )

	RectAreaLight rectAreaLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {

		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if defined( RE_IndirectDiffuse )

	vec3 iblIrradiance = vec3( 0.0 );

	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );

	#if defined( USE_LIGHT_PROBES )

		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );

	#endif

	#if ( NUM_HEMI_LIGHTS > 0 )

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );

		}
		#pragma unroll_loop_end

	#endif

#endif

#if defined( RE_IndirectSpecular )

	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );

#endif
`,lights_fragment_maps=`
#if defined( RE_IndirectDiffuse )

	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;

		irradiance += lightMapIrradiance;

	#endif

	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )

		iblIrradiance += getIBLIrradiance( geometryNormal );

	#endif

#endif

#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )

	#ifdef USE_ANISOTROPY

		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );

	#else

		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );

	#endif

	#ifdef USE_CLEARCOAT

		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );

	#endif

#endif
`,lights_fragment_end=`
#if defined( RE_IndirectDiffuse )

	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

#endif

#if defined( RE_IndirectSpecular )

	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

#endif
`,logdepthbuf_fragment=`
#if defined( USE_LOGDEPTHBUF )

	// Doing a strict comparison with == 1.0 can cause noise artifacts
	// on some platforms. See issue #17623.
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;

#endif
`,logdepthbuf_pars_fragment=`
#if defined( USE_LOGDEPTHBUF )

	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;

#endif
`,logdepthbuf_pars_vertex=`
#ifdef USE_LOGDEPTHBUF

	varying float vFragDepth;
	varying float vIsPerspective;

#endif
`,logdepthbuf_vertex=`
#ifdef USE_LOGDEPTHBUF

	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );

#endif
`,map_fragment=`
#ifdef USE_MAP

	vec4 sampledDiffuseColor = texture2D( map, vMapUv );

	#ifdef DECODE_VIDEO_TEXTURE

		// use inline sRGB decode until browsers properly support SRGB8_ALPHA8 with video textures (#26516)

		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif

	diffuseColor *= sampledDiffuseColor;

#endif
`,map_pars_fragment=`
#ifdef USE_MAP

	uniform sampler2D map;

#endif
`,map_particle_fragment=`
#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

	#if defined( USE_POINTS_UV )

		vec2 uv = vUv;

	#else

		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;

	#endif

#endif

#ifdef USE_MAP

	diffuseColor *= texture2D( map, uv );

#endif

#ifdef USE_ALPHAMAP

	diffuseColor.a *= texture2D( alphaMap, uv ).g;

#endif
`,map_particle_pars_fragment=`
#if defined( USE_POINTS_UV )

	varying vec2 vUv;

#else

	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )

		uniform mat3 uvTransform;

	#endif

#endif

#ifdef USE_MAP

	uniform sampler2D map;

#endif

#ifdef USE_ALPHAMAP

	uniform sampler2D alphaMap;

#endif
`,metalnessmap_fragment=`
float metalnessFactor = metalness;

#ifdef USE_METALNESSMAP

	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );

	// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	metalnessFactor *= texelMetalness.b;

#endif
`,metalnessmap_pars_fragment=`
#ifdef USE_METALNESSMAP

	uniform sampler2D metalnessMap;

#endif
`,morphinstance_vertex=`
#ifdef USE_INSTANCING_MORPH

	float morphTargetInfluences[ MORPHTARGETS_COUNT ];

	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;

	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;

	}
#endif
`,morphcolor_vertex=`
#if defined( USE_MORPHCOLORS )

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	vColor *= morphTargetBaseInfluence;

	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

		#if defined( USE_COLOR_ALPHA )

			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];

		#elif defined( USE_COLOR )

			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];

		#endif

	}

#endif
`,morphnormal_vertex=`
#ifdef USE_MORPHNORMALS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	objectNormal *= morphTargetBaseInfluence;

	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];

	}

#endif
`,morphtarget_pars_vertex=`
#ifdef USE_MORPHTARGETS

	#ifndef USE_INSTANCING_MORPH

		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];

	#endif

	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;

	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {

		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;

		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );

	}

#endif
`,morphtarget_vertex=`
#ifdef USE_MORPHTARGETS

	// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:
	// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in position = sum((target - base) * influence)
	// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting
	transformed *= morphTargetBaseInfluence;

	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {

		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];

	}

#endif
`,normal_fragment_begin=`
float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;

#ifdef FLAT_SHADED

	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );

#else

	vec3 normal = normalize( vNormal );

	#ifdef DOUBLE_SIDED

		normal *= faceDirection;

	#endif

#endif

#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )

	#ifdef USE_TANGENT

		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );

	#else

		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);

	#endif

	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )

		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;

	#endif

#endif

#ifdef USE_CLEARCOAT_NORMALMAP

	#ifdef USE_TANGENT

		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );

	#else

		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );

	#endif

	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )

		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;

	#endif

#endif

// non perturbed normal for clearcoat among others

vec3 nonPerturbedNormal = normal;

`,normal_fragment_maps=`

#ifdef USE_NORMALMAP_OBJECTSPACE

	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals

	#ifdef FLIP_SIDED

		normal = - normal;

	#endif

	#ifdef DOUBLE_SIDED

		normal = normal * faceDirection;

	#endif

	normal = normalize( normalMatrix * normal );

#elif defined( USE_NORMALMAP_TANGENTSPACE )

	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;

	normal = normalize( tbn * mapN );

#elif defined( USE_BUMPMAP )

	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );

#endif
`,normal_pars_fragment=`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`,normal_pars_vertex=`
#ifndef FLAT_SHADED

	varying vec3 vNormal;

	#ifdef USE_TANGENT

		varying vec3 vTangent;
		varying vec3 vBitangent;

	#endif

#endif
`,normal_vertex=`
#ifndef FLAT_SHADED // normal is computed with derivatives when FLAT_SHADED

	vNormal = normalize( transformedNormal );

	#ifdef USE_TANGENT

		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );

	#endif

#endif
`,normalmap_pars_fragment=`
#ifdef USE_NORMALMAP

	uniform sampler2D normalMap;
	uniform vec2 normalScale;

#endif

#ifdef USE_NORMALMAP_OBJECTSPACE

	uniform mat3 normalMatrix;

#endif

#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )

	// Normal Mapping Without Precomputed Tangents
	// http://www.thetenthplanet.de/archives/1180

	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {

		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );

		vec3 N = surf_norm; // normalized

		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );

		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;

		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );

		return mat3( T * scale, B * scale, N );

	}

#endif
`,clearcoat_normal_fragment_begin=`
#ifdef USE_CLEARCOAT

	vec3 clearcoatNormal = nonPerturbedNormal;

#endif
`,clearcoat_normal_fragment_maps=`
#ifdef USE_CLEARCOAT_NORMALMAP

	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;

	clearcoatNormal = normalize( tbn2 * clearcoatMapN );

#endif
`,clearcoat_pars_fragment=`

#ifdef USE_CLEARCOATMAP

	uniform sampler2D clearcoatMap;

#endif

#ifdef USE_CLEARCOAT_NORMALMAP

	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;

#endif

#ifdef USE_CLEARCOAT_ROUGHNESSMAP

	uniform sampler2D clearcoatRoughnessMap;

#endif
`,iridescence_pars_fragment=`

#ifdef USE_IRIDESCENCEMAP

	uniform sampler2D iridescenceMap;

#endif

#ifdef USE_IRIDESCENCE_THICKNESSMAP

	uniform sampler2D iridescenceThicknessMap;

#endif
`,opaque_fragment=`
#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif

#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif

gl_FragColor = vec4( outgoingLight, diffuseColor.a );
`,packing=`
vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}

vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}

const float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)
const float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)
const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;

const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );

const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );

vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}

vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	// the 0.9999 tweak is unimportant, very tiny empirical improvement
	// return vec3( vuf * Inv255, gf * PackUpscale, bf * 0.9999 );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}

vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}

float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}

float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}

float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}

vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}

vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}

// NOTE: viewZ, the z-coordinate in camera space, is negative for points in front of the camera

float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	// -near maps to 0; -far maps to 1
	return ( viewZ + near ) / ( near - far );
}

float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	// maps orthographic depth in [ 0, 1 ] to viewZ
	return depth * ( near - far ) - near;
}

// NOTE: https://twitter.com/gonnavis/status/1377183786949959682

float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	// -near maps to 0; -far maps to 1
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}

float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	// maps perspective depth in [ 0, 1 ] to viewZ
	return ( near * far ) / ( ( far - near ) * depth - far );
}
`,premultiplied_alpha_fragment=`
#ifdef PREMULTIPLIED_ALPHA

	// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.
	gl_FragColor.rgb *= gl_FragColor.a;

#endif
`,project_vertex=`
vec4 mvPosition = vec4( transformed, 1.0 );

#ifdef USE_BATCHING

	mvPosition = batchingMatrix * mvPosition;

#endif

#ifdef USE_INSTANCING

	mvPosition = instanceMatrix * mvPosition;

#endif

mvPosition = modelViewMatrix * mvPosition;

gl_Position = projectionMatrix * mvPosition;
`,dithering_fragment=`
#ifdef DITHERING

	gl_FragColor.rgb = dithering( gl_FragColor.rgb );

#endif
`,dithering_pars_fragment=`
#ifdef DITHERING

	// based on https://www.shadertoy.com/view/MslGR8
	vec3 dithering( vec3 color ) {
		//Calculate grid position
		float grid_position = rand( gl_FragCoord.xy );

		//Shift the individual colors differently, thus making it even harder to see the dithering pattern
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );

		//modify shift according to grid position.
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );

		//shift the color by dither_shift
		return color + dither_shift_RGB;
	}

#endif
`,roughnessmap_fragment=`
float roughnessFactor = roughness;

#ifdef USE_ROUGHNESSMAP

	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );

	// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture
	roughnessFactor *= texelRoughness.g;

#endif
`,roughnessmap_pars_fragment=`
#ifdef USE_ROUGHNESSMAP

	uniform sampler2D roughnessMap;

#endif
`,shadowmap_pars_fragment=`
#if NUM_SPOT_LIGHT_COORDS > 0

	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];

#endif

#if NUM_SPOT_LIGHT_MAPS > 0

	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];

#endif

#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];

		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): create uniforms for area light shadows

	#endif
	*/

	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

	}

	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

		return unpackRGBATo2Half( texture2D( shadow, uv ) );

	}

	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

		float occlusion = 1.0;

		vec2 distribution = texture2DDistribution( shadow, uv );

		float hard_shadow = step( compare , distribution.x ); // Hard Shadow

		if (hard_shadow != 1.0 ) {

			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

		}
		return occlusion;

	}

	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

		float shadow = 1.0;

		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;

		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;

		if ( frustumTest ) {

		#if defined( SHADOWMAP_TYPE_PCF )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;

			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;

			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );

		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )

			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;

			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;

			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );

		#elif defined( SHADOWMAP_TYPE_VSM )

			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

		#else // no percentage-closer filtering:

			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

		#endif

		}

		return mix( 1.0, shadow, shadowIntensity );

	}

	// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
	// vector suitable for 2D texture mapping. This code uses the following layout for the
	// 2D texture:
	//
	// xzXZ
	//  y Y
	//
	// Y - Positive y direction
	// y - Negative y direction
	// X - Positive x direction
	// x - Negative x direction
	// Z - Positive z direction
	// z - Negative z direction
	//
	// Source and test bed:
	// https://gist.github.com/tschw/da10c43c467ce8afd0c4

	vec2 cubeToUV( vec3 v, float texelSizeY ) {

		// Number of texels to avoid at the edge of each square

		vec3 absV = abs( v );

		// Intersect unit cube

		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;

		// Apply scale to avoid seams

		// two texels less per square (one texel will do for NEAREST)
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

		// Unwrap

		// space: -1 ... 1 range for each square
		//
		// #X##		dim    := ( 4 , 2 )
		//  # #		center := ( 1 , 1 )

		vec2 planar = v.xy;

		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;

		if ( absV.z >= almostOne ) {

			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;

		} else if ( absV.x >= almostOne ) {

			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;

		} else if ( absV.y >= almostOne ) {

			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;

		}

		// Transform to UV space

		// scale := 0.5 / dim
		// translate := ( center + 0.5 ) / dim
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

	}

	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

		float shadow = 1.0;

		// for point lights, the uniform @vShadowCoord is re-purposed to hold
		// the vector from the light to the world-space position of the fragment.
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );

		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {

			// dp = normalized distance from light to fragment position
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
			dp += shadowBias;

			// bd3D = base direction 3D
			vec3 bd3D = normalize( lightToPosition );

			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )

				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;

				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );

			#else // no percentage-closer filtering

				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );

			#endif

		}

		return mix( 1.0, shadow, shadowIntensity );

	}

#endif
`,shadowmap_pars_vertex=`

#if NUM_SPOT_LIGHT_COORDS > 0

	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];

#endif

#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};

		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};

		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): uniforms for area light shadows

	#endif
	*/

#endif
`,shadowmap_vertex=`

#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )

	// Offsetting the position used for querying occlusion along the world normal can be used to reduce shadow acne.
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;

#endif

#if defined( USE_SHADOWMAP )

	#if NUM_DIR_LIGHT_SHADOWS > 0

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;

		}
		#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;

		}
		#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update vAreaShadowCoord with area light info

	#endif
	*/

#endif

// spot lights can be evaluated without active shadow mapping (when SpotLight.map is used)

#if NUM_SPOT_LIGHT_COORDS > 0

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {

		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;

	}
	#pragma unroll_loop_end

#endif


`,shadowmask_pars_fragment=`
float getShadowMask() {

	float shadow = 1.0;

	#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0

	DirectionalLightShadow directionalLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {

		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_SPOT_LIGHT_SHADOWS > 0

	SpotLightShadow spotLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {

		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	#if NUM_POINT_LIGHT_SHADOWS > 0

	PointLightShadow pointLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {

		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;

	}
	#pragma unroll_loop_end

	#endif

	/*
	#if NUM_RECT_AREA_LIGHTS > 0

		// TODO (abelnation): update shadow for Area light

	#endif
	*/

	#endif

	return shadow;

}
`,skinbase_vertex=`
#ifdef USE_SKINNING

	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );

#endif
`,skinning_pars_vertex=`
#ifdef USE_SKINNING

	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;

	uniform highp sampler2D boneTexture;

	mat4 getBoneMatrix( const in float i ) {

		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );

		return mat4( v1, v2, v3, v4 );

	}

#endif
`,skinning_vertex=`
#ifdef USE_SKINNING

	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );

	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;

	transformed = ( bindMatrixInverse * skinned ).xyz;

#endif
`,skinnormal_vertex=`
#ifdef USE_SKINNING

	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;

	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;

	#ifdef USE_TANGENT

		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;

	#endif

#endif
`,specularmap_fragment=`
float specularStrength;

#ifdef USE_SPECULARMAP

	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;

#else

	specularStrength = 1.0;

#endif
`,specularmap_pars_fragment=`
#ifdef USE_SPECULARMAP

	uniform sampler2D specularMap;

#endif
`,tonemapping_fragment=`
#if defined( TONE_MAPPING )

	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );

#endif
`,tonemapping_pars_fragment=`
#ifndef saturate
// <common> may have defined saturate() already
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif

uniform float toneMappingExposure;

// exposure only
vec3 LinearToneMapping( vec3 color ) {

	return saturate( toneMappingExposure * color );

}

// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf
vec3 ReinhardToneMapping( vec3 color ) {

	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );

}

// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/
vec3 CineonToneMapping( vec3 color ) {

	// filmic operator by Jim Hejl and Richard Burgess-Dawson
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );

}

// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs
vec3 RRTAndODTFit( vec3 v ) {

	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;

}

// this implementation of ACES is modified to accommodate a brighter viewing environment.
// the scale factor of 1/0.6 is subjective. see discussion in #19621.

vec3 ACESFilmicToneMapping( vec3 color ) {

	// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ), // transposed from source
		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);

	// ODT_SAT => XYZ => D60_2_D65 => sRGB
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ), // transposed from source
		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);

	color *= toneMappingExposure / 0.6;

	color = ACESInputMat * color;

	// Apply RRT and ODT
	color = RRTAndODTFit( color );

	color = ACESOutputMat * color;

	// Clamp to [0, 1]
	return saturate( color );

}

// Matrices for rec 2020 <> rec 709 color space conversion
// matrix provided in row-major order so it has been transposed
// https://www.itu.int/pub/R-REP-BT.2407-2017
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);

const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);

// https://iolite-engine.com/blog_posts/minimal_agx_implementation
// Mean error^2: 3.6705141e-06
vec3 agxDefaultContrastApprox( vec3 x ) {

	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;

	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;

}

// AgX Tone Mapping implementation based on Filament, which in turn is based
// on Blender's implementation using rec 2020 primaries
// https://github.com/google/filament/pull/7236
// Inputs and outputs are encoded as Linear-sRGB.

vec3 AgXToneMapping( vec3 color ) {

	// AgX constants
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);

	// explicit AgXOutsetMatrix generated from Filaments AgXOutsetMatrixInv
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);

	// LOG2_MIN      = -10.0
	// LOG2_MAX      =  +6.5
	// MIDDLE_GRAY   =  0.18
	const float AgxMinEv = - 12.47393;  // log2( pow( 2, LOG2_MIN ) * MIDDLE_GRAY )
	const float AgxMaxEv = 4.026069;    // log2( pow( 2, LOG2_MAX ) * MIDDLE_GRAY )

	color *= toneMappingExposure;

	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;

	color = AgXInsetMatrix * color;

	// Log2 encoding
	color = max( color, 1e-10 ); // avoid 0 or negative numbers for log2
	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );

	color = clamp( color, 0.0, 1.0 );

	// Apply sigmoid
	color = agxDefaultContrastApprox( color );

	// Apply AgX look
	// v = agxLook(v, look);

	color = AgXOutsetMatrix * color;

	// Linearize
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );

	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;

	// Gamut mapping. Simple clamp for now.
	color = clamp( color, 0.0, 1.0 );

	return color;

}

// https://modelviewer.dev/examples/tone-mapping

vec3 NeutralToneMapping( vec3 color ) {

	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;

	color *= toneMappingExposure;

	float x = min( color.r, min( color.g, color.b ) );

	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;

	color -= offset;

	float peak = max( color.r, max( color.g, color.b ) );

	if ( peak < StartCompression ) return color;

	float d = 1. - StartCompression;

	float newPeak = 1. - d * d / ( peak + d - StartCompression );

	color *= newPeak / peak;

	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );

	return mix( color, vec3( newPeak ), g );

}

vec3 CustomToneMapping( vec3 color ) { return color; }
`,transmission_fragment=`
#ifdef USE_TRANSMISSION

	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;

	#ifdef USE_TRANSMISSIONMAP

		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;

	#endif

	#ifdef USE_THICKNESSMAP

		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;

	#endif

	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );

	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );

	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );

	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );

#endif
`,transmission_pars_fragment=`
#ifdef USE_TRANSMISSION

	// Transmission code is based on glTF-Sampler-Viewer
	// https://github.com/KhronosGroup/glTF-Sample-Viewer

	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;

	#ifdef USE_TRANSMISSIONMAP

		uniform sampler2D transmissionMap;

	#endif

	#ifdef USE_THICKNESSMAP

		uniform sampler2D thicknessMap;

	#endif

	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;

	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;

	varying vec3 vWorldPosition;

	// Mipped Bicubic Texture Filtering by N8
	// https://www.shadertoy.com/view/Dl2SDW

	float w0( float a ) {

		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );

	}

	float w1( float a ) {

		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );

	}

	float w2( float a ){

		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );

	}

	float w3( float a ) {

		return ( 1.0 / 6.0 ) * ( a * a * a );

	}

	// g0 and g1 are the two amplitude functions
	float g0( float a ) {

		return w0( a ) + w1( a );

	}

	float g1( float a ) {

		return w2( a ) + w3( a );

	}

	// h0 and h1 are the two offset functions
	float h0( float a ) {

		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );

	}

	float h1( float a ) {

		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );

	}

	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {

		uv = uv * texelSize.zw + 0.5;

		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );

		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );

		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;

		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );

	}

	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {

		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );

	}

	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {

		// Direction of refracted light.
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );

		// Compute rotation-independant scaling of the model matrix.
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		// The thickness is specified in local space.
		return normalize( refractionVector ) * thickness * modelScale;

	}

	float applyIorToRoughness( const in float roughness, const in float ior ) {

		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );

	}

	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {

		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );

	}

	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {

		if ( isinf( attenuationDistance ) ) {

			// Attenuation distance is +, i.e. the transmitted color is not attenuated at all.
			return vec3( 1.0 );

		} else {

			// Compute light attenuation using Beer's law.
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law
			return transmittance;

		}

	}

	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {

		vec4 transmittedLight;
		vec3 transmittance;

		#ifdef USE_DISPERSION

			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );

			for ( int i = 0; i < 3; i ++ ) {

				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				// Sample framebuffer to get pixel the refracted ray hits.
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;

				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];

			}

			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;

			// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;

			// Sample framebuffer to get pixel the refracted ray hits.
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif

		vec3 attenuatedColor = transmittance * transmittedLight.rgb;

		// Get the specular component.
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );

		// As less light is transmitted, the opacity should be increased. This simple approximation does a decent job 
		// of modulating a CSS background, and has no effect when the buffer is opaque, due to a solid object or clear color.
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;

		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );

	}
#endif
`,uv_pars_fragment=`
#if defined( USE_UV ) || defined( USE_ANISOTROPY )

	varying vec2 vUv;

#endif
#ifdef USE_MAP

	varying vec2 vMapUv;

#endif
#ifdef USE_ALPHAMAP

	varying vec2 vAlphaMapUv;

#endif
#ifdef USE_LIGHTMAP

	varying vec2 vLightMapUv;

#endif
#ifdef USE_AOMAP

	varying vec2 vAoMapUv;

#endif
#ifdef USE_BUMPMAP

	varying vec2 vBumpMapUv;

#endif
#ifdef USE_NORMALMAP

	varying vec2 vNormalMapUv;

#endif
#ifdef USE_EMISSIVEMAP

	varying vec2 vEmissiveMapUv;

#endif
#ifdef USE_METALNESSMAP

	varying vec2 vMetalnessMapUv;

#endif
#ifdef USE_ROUGHNESSMAP

	varying vec2 vRoughnessMapUv;

#endif
#ifdef USE_ANISOTROPYMAP

	varying vec2 vAnisotropyMapUv;

#endif
#ifdef USE_CLEARCOATMAP

	varying vec2 vClearcoatMapUv;

#endif
#ifdef USE_CLEARCOAT_NORMALMAP

	varying vec2 vClearcoatNormalMapUv;

#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP

	varying vec2 vClearcoatRoughnessMapUv;

#endif
#ifdef USE_IRIDESCENCEMAP

	varying vec2 vIridescenceMapUv;

#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP

	varying vec2 vIridescenceThicknessMapUv;

#endif
#ifdef USE_SHEEN_COLORMAP

	varying vec2 vSheenColorMapUv;

#endif
#ifdef USE_SHEEN_ROUGHNESSMAP

	varying vec2 vSheenRoughnessMapUv;

#endif
#ifdef USE_SPECULARMAP

	varying vec2 vSpecularMapUv;

#endif
#ifdef USE_SPECULAR_COLORMAP

	varying vec2 vSpecularColorMapUv;

#endif
#ifdef USE_SPECULAR_INTENSITYMAP

	varying vec2 vSpecularIntensityMapUv;

#endif
#ifdef USE_TRANSMISSIONMAP

	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;

#endif
#ifdef USE_THICKNESSMAP

	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;

#endif
`,uv_pars_vertex=`
#if defined( USE_UV ) || defined( USE_ANISOTROPY )

	varying vec2 vUv;

#endif
#ifdef USE_MAP

	uniform mat3 mapTransform;
	varying vec2 vMapUv;

#endif
#ifdef USE_ALPHAMAP

	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;

#endif
#ifdef USE_LIGHTMAP

	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;

#endif
#ifdef USE_AOMAP

	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;

#endif
#ifdef USE_BUMPMAP

	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;

#endif
#ifdef USE_NORMALMAP

	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;

#endif
#ifdef USE_DISPLACEMENTMAP

	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;

#endif
#ifdef USE_EMISSIVEMAP

	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;

#endif
#ifdef USE_METALNESSMAP

	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;

#endif
#ifdef USE_ROUGHNESSMAP

	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;

#endif
#ifdef USE_ANISOTROPYMAP

	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;

#endif
#ifdef USE_CLEARCOATMAP

	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;

#endif
#ifdef USE_CLEARCOAT_NORMALMAP

	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;

#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP

	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;

#endif
#ifdef USE_SHEEN_COLORMAP

	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;

#endif
#ifdef USE_SHEEN_ROUGHNESSMAP

	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;

#endif
#ifdef USE_IRIDESCENCEMAP

	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;

#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP

	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;

#endif
#ifdef USE_SPECULARMAP

	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;

#endif
#ifdef USE_SPECULAR_COLORMAP

	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;

#endif
#ifdef USE_SPECULAR_INTENSITYMAP

	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;

#endif
#ifdef USE_TRANSMISSIONMAP

	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;

#endif
#ifdef USE_THICKNESSMAP

	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;

#endif
`,uv_vertex=`
#if defined( USE_UV ) || defined( USE_ANISOTROPY )

	vUv = vec3( uv, 1 ).xy;

#endif
#ifdef USE_MAP

	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;

#endif
#ifdef USE_ALPHAMAP

	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_LIGHTMAP

	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_AOMAP

	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_BUMPMAP

	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_NORMALMAP

	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_DISPLACEMENTMAP

	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_EMISSIVEMAP

	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_METALNESSMAP

	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_ROUGHNESSMAP

	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_ANISOTROPYMAP

	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_CLEARCOATMAP

	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_CLEARCOAT_NORMALMAP

	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP

	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_IRIDESCENCEMAP

	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP

	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_SHEEN_COLORMAP

	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_SHEEN_ROUGHNESSMAP

	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_SPECULARMAP

	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_SPECULAR_COLORMAP

	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_SPECULAR_INTENSITYMAP

	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_TRANSMISSIONMAP

	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;

#endif
#ifdef USE_THICKNESSMAP

	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;

#endif
`,worldpos_vertex=`
#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0

	vec4 worldPosition = vec4( transformed, 1.0 );

	#ifdef USE_BATCHING

		worldPosition = batchingMatrix * worldPosition;

	#endif

	#ifdef USE_INSTANCING

		worldPosition = instanceMatrix * worldPosition;

	#endif

	worldPosition = modelMatrix * worldPosition;

#endif
`,vertex$h=`
varying vec2 vUv;
uniform mat3 uvTransform;

void main() {

	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

	gl_Position = vec4( position.xy, 1.0, 1.0 );

}
`,fragment$h=`
uniform sampler2D t2D;
uniform float backgroundIntensity;

varying vec2 vUv;

void main() {

	vec4 texColor = texture2D( t2D, vUv );

	#ifdef DECODE_VIDEO_TEXTURE

		// use inline sRGB decode until browsers properly support SRGB8_APLHA8 with video textures

		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );

	#endif

	texColor.rgb *= backgroundIntensity;

	gl_FragColor = texColor;

	#include <tonemapping_fragment>
	#include <colorspace_fragment>

}
`,vertex$g=`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,fragment$g=`

#ifdef ENVMAP_TYPE_CUBE

	uniform samplerCube envMap;

#elif defined( ENVMAP_TYPE_CUBE_UV )

	uniform sampler2D envMap;

#endif

uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;

varying vec3 vWorldDirection;

#include <cube_uv_reflection_fragment>

void main() {

	#ifdef ENVMAP_TYPE_CUBE

		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );

	#elif defined( ENVMAP_TYPE_CUBE_UV )

		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );

	#else

		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );

	#endif

	texColor.rgb *= backgroundIntensity;

	gl_FragColor = texColor;

	#include <tonemapping_fragment>
	#include <colorspace_fragment>

}
`,vertex$f=`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

	gl_Position.z = gl_Position.w; // set z to camera.far

}
`,fragment$f=`
uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;

varying vec3 vWorldDirection;

void main() {

	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );

	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;

	#include <tonemapping_fragment>
	#include <colorspace_fragment>

}
`,vertex$e=`
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.
// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for
// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.
varying vec2 vHighPrecisionZW;

void main() {

	#include <uv_vertex>

	#include <batching_vertex>
	#include <skinbase_vertex>

	#include <morphinstance_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vHighPrecisionZW = gl_Position.zw;

}
`,fragment$e=`
#if DEPTH_PACKING == 3200

	uniform float opacity;

#endif

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

varying vec2 vHighPrecisionZW;

void main() {

	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>

	#if DEPTH_PACKING == 3200

		diffuseColor.a = opacity;

	#endif

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>

	#include <logdepthbuf_fragment>

	// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;

	#if DEPTH_PACKING == 3200

		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );

	#elif DEPTH_PACKING == 3201

		gl_FragColor = packDepthToRGBA( fragCoordZ );

	#elif DEPTH_PACKING == 3202

		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );

	#elif DEPTH_PACKING == 3203

		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );

	#endif

}
`,vertex$d=`
#define DISTANCE

varying vec3 vWorldPosition;

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	#include <batching_vertex>
	#include <skinbase_vertex>

	#include <morphinstance_vertex>

	#ifdef USE_DISPLACEMENTMAP

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>

	vWorldPosition = worldPosition.xyz;

}
`,fragment$d=`
#define DISTANCE

uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;

#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>

void main () {

	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>

	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>

	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist ); // clamp to [ 0, 1 ]

	gl_FragColor = packDepthToRGBA( dist );

}
`,vertex$c=`
varying vec3 vWorldDirection;

#include <common>

void main() {

	vWorldDirection = transformDirection( position, modelMatrix );

	#include <begin_vertex>
	#include <project_vertex>

}
`,fragment$c=`
uniform sampler2D tEquirect;

varying vec3 vWorldDirection;

#include <common>

void main() {

	vec3 direction = normalize( vWorldDirection );

	vec2 sampleUV = equirectUv( direction );

	gl_FragColor = texture2D( tEquirect, sampleUV );

	#include <tonemapping_fragment>
	#include <colorspace_fragment>

}
`,vertex$b=`
uniform float scale;
attribute float lineDistance;

varying float vLineDistance;

#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	vLineDistance = scale * lineDistance;

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,fragment$b=`
uniform vec3 diffuse;
uniform float opacity;

uniform float dashSize;
uniform float totalSize;

varying float vLineDistance;

#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>

	if ( mod( vLineDistance, totalSize ) > dashSize ) {

		discard;

	}

	vec3 outgoingLight = vec3( 0.0 );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>

	outgoingLight = diffuseColor.rgb; // simple shader

	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`,vertex$a=`
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>

	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )

		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>

	#endif

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>

}
`,fragment$a=`
uniform vec3 diffuse;
uniform float opacity;

#ifndef FLAT_SHADED

	varying vec3 vNormal;

#endif

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );

	// accumulation (baked indirect lighting only)
	#ifdef USE_LIGHTMAP

		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;

	#else

		reflectedLight.indirectDiffuse += vec3( 1.0 );

	#endif

	// modulation
	#include <aomap_fragment>

	reflectedLight.indirectDiffuse *= diffuseColor.rgb;

	vec3 outgoingLight = reflectedLight.indirectDiffuse;

	#include <envmap_fragment>

	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,vertex$9=`
#define LAMBERT

varying vec3 vViewPosition;

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,fragment$9=`
#define LAMBERT

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,vertex$8=`
#define MATCAP

varying vec3 vViewPosition;

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>

#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

	vViewPosition = - mvPosition.xyz;

}
`,fragment$8=`
#define MATCAP

uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;

varying vec3 vViewPosition;

#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks

	#ifdef USE_MATCAP

		vec4 matcapColor = texture2D( matcap, uv );

	#else

		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 ); // default if matcap is missing

	#endif

	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;

	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,vertex$7=`
#define NORMAL

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )

	varying vec3 vViewPosition;

#endif

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <batching_vertex>

	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )

	vViewPosition = - mvPosition.xyz;

#endif

}
`,fragment$7=`
#define NORMAL

uniform float opacity;

#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )

	varying vec3 vViewPosition;

#endif

#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );

	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>

	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );

	#ifdef OPAQUE

		gl_FragColor.a = 1.0;

	#endif

}
`,vertex$6=`
#define PHONG

varying vec3 vViewPosition;

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>

	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,fragment$6=`
#define PHONG

uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;

	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,vertex$5=`
#define STANDARD

varying vec3 vViewPosition;

#ifdef USE_TRANSMISSION

	varying vec3 vWorldPosition;

#endif

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

#ifdef USE_TRANSMISSION

	vWorldPosition = worldPosition.xyz;

#endif
}
`,fragment$5=`
#define STANDARD

#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;

#ifdef IOR
	uniform float ior;
#endif

#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;

	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif

	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif

#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif

#ifdef USE_DISPERSION
	uniform float dispersion;
#endif

#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif

#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;

	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif

	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif

#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;

	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif

varying vec3 vViewPosition;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;

	#include <transmission_fragment>

	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;

	#ifdef USE_SHEEN

		// Sheen energy compensation approximation calculation can be found at the end of
		// https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );

		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;

	#endif

	#ifdef USE_CLEARCOAT

		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );

		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );

		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;

	#endif

	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,vertex$4=`
#define TOON

varying vec3 vViewPosition;

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>

	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>

	vViewPosition = - mvPosition.xyz;

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,fragment$4=`
#define TOON

uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>

	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>

	// accumulation
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>

	// modulation
	#include <aomap_fragment>

	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;

	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>

}
`,vertex$3=`
uniform float size;
uniform float scale;

#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

#ifdef USE_POINTS_UV

	varying vec2 vUv;
	uniform mat3 uvTransform;

#endif

void main() {

	#ifdef USE_POINTS_UV

		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;

	#endif

	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>

	gl_PointSize = size;

	#ifdef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );

	#endif

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>

}
`,fragment$3=`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );

	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>

}
`,vertex$2=`
#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>

void main() {

	#include <batching_vertex>

	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>

	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>

	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>

}
`,fragment$2=`
uniform vec3 color;
uniform float opacity;

#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>

void main() {

	#include <logdepthbuf_fragment>

	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );

	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>

}
`,vertex$1=`
uniform float rotation;
uniform vec2 center;

#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>

void main() {

	#include <uv_vertex>

	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );

	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

	#ifndef USE_SIZEATTENUATION

		bool isPerspective = isPerspectiveMatrix( projectionMatrix );

		if ( isPerspective ) scale *= - mvPosition.z;

	#endif

	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;

	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;

	mvPosition.xy += rotatedPosition;

	gl_Position = projectionMatrix * mvPosition;

	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>

}
`,fragment$1=`
uniform vec3 diffuse;
uniform float opacity;

#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {

	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>

	vec3 outgoingLight = vec3( 0.0 );

	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>

	outgoingLight = diffuseColor.rgb;

	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>

}
`,ShaderChunk={alphahash_fragment,alphahash_pars_fragment,alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,batching_pars_vertex,batching_vertex,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,colorspace_fragment,colorspace_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphinstance_vertex,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,opaque_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3$1},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3$1},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3$1}},envmap:{envMap:{value:null},envMapRotation:{value:new Matrix3$1},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3$1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3$1}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3$1},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3$1},normalScale:{value:new Vector2$1(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3$1},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3$1}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3$1}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3$1}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color$1(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3$1},alphaTest:{value:0},uvTransform:{value:new Matrix3$1}},sprite:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},center:{value:new Vector2$1(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3$1},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3$1},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)},specular:{value:new Color$1(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3$1},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Matrix3$1}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3$1},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color$1(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3$1},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3$1},clearcoatNormalScale:{value:new Vector2$1(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3$1},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3$1},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3$1},sheen:{value:0},sheenColor:{value:new Color$1(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3$1},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3$1},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3$1},transmissionSamplerSize:{value:new Vector2$1},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3$1},attenuationDistance:{value:0},attenuationColor:{value:new Color$1(0)},specularColor:{value:new Color$1(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3$1},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3$1},anisotropyVector:{value:new Vector2$1},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Matrix3$1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0},_e1$1=new Euler$1,_m1$1=new Matrix4$1;function WebGLBackground(H,_,b,$,ee,re,ae){const xe=new Color$1(0);let le=re===!0?0:1,fe,ve,Se=null,Ee=0,Ce=null;function Ie(qe){let Xe=qe.isScene===!0?qe.background:null;return Xe&&Xe.isTexture&&(Xe=(qe.backgroundBlurriness>0?b:_).get(Xe)),Xe}function De(qe){let Xe=!1;const Ye=Ie(qe);Ye===null?Ne(xe,le):Ye&&Ye.isColor&&(Ne(Ye,1),Xe=!0);const Qe=H.xr.getEnvironmentBlendMode();Qe==="additive"?$.buffers.color.setClear(0,0,0,1,ae):Qe==="alpha-blend"&&$.buffers.color.setClear(0,0,0,0,ae),(H.autoClear||Xe)&&($.buffers.depth.setTest(!0),$.buffers.depth.setMask(!0),$.buffers.color.setMask(!0),H.clear(H.autoClearColor,H.autoClearDepth,H.autoClearStencil))}function Be(qe,Xe){const Ye=Ie(Xe);Ye&&(Ye.isCubeTexture||Ye.mapping===CubeUVReflectionMapping)?(ve===void 0&&(ve=new Mesh$1(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide$1,depthTest:!1,depthWrite:!1,fog:!1})),ve.geometry.deleteAttribute("normal"),ve.geometry.deleteAttribute("uv"),ve.onBeforeRender=function(Qe,rt,ot){this.matrixWorld.copyPosition(ot.matrixWorld)},Object.defineProperty(ve.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),ee.update(ve)),_e1$1.copy(Xe.backgroundRotation),_e1$1.x*=-1,_e1$1.y*=-1,_e1$1.z*=-1,Ye.isCubeTexture&&Ye.isRenderTargetTexture===!1&&(_e1$1.y*=-1,_e1$1.z*=-1),ve.material.uniforms.envMap.value=Ye,ve.material.uniforms.flipEnvMap.value=Ye.isCubeTexture&&Ye.isRenderTargetTexture===!1?-1:1,ve.material.uniforms.backgroundBlurriness.value=Xe.backgroundBlurriness,ve.material.uniforms.backgroundIntensity.value=Xe.backgroundIntensity,ve.material.uniforms.backgroundRotation.value.setFromMatrix4(_m1$1.makeRotationFromEuler(_e1$1)),ve.material.toneMapped=ColorManagement$1.getTransfer(Ye.colorSpace)!==SRGBTransfer$1,(Se!==Ye||Ee!==Ye.version||Ce!==H.toneMapping)&&(ve.material.needsUpdate=!0,Se=Ye,Ee=Ye.version,Ce=H.toneMapping),ve.layers.enableAll(),qe.unshift(ve,ve.geometry,ve.material,0,0,null)):Ye&&Ye.isTexture&&(fe===void 0&&(fe=new Mesh$1(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide$1,depthTest:!1,depthWrite:!1,fog:!1})),fe.geometry.deleteAttribute("normal"),Object.defineProperty(fe.material,"map",{get:function(){return this.uniforms.t2D.value}}),ee.update(fe)),fe.material.uniforms.t2D.value=Ye,fe.material.uniforms.backgroundIntensity.value=Xe.backgroundIntensity,fe.material.toneMapped=ColorManagement$1.getTransfer(Ye.colorSpace)!==SRGBTransfer$1,Ye.matrixAutoUpdate===!0&&Ye.updateMatrix(),fe.material.uniforms.uvTransform.value.copy(Ye.matrix),(Se!==Ye||Ee!==Ye.version||Ce!==H.toneMapping)&&(fe.material.needsUpdate=!0,Se=Ye,Ee=Ye.version,Ce=H.toneMapping),fe.layers.enableAll(),qe.unshift(fe,fe.geometry,fe.material,0,0,null))}function Ne(qe,Xe){qe.getRGB(_rgb,getUnlitUniformColorSpace(H)),$.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,Xe,ae)}return{getClearColor:function(){return xe},setClearColor:function(qe,Xe=1){xe.set(qe),le=Xe,Ne(xe,le)},getClearAlpha:function(){return le},setClearAlpha:function(qe){le=qe,Ne(xe,le)},render:De,addToRenderList:Be}}function WebGLBindingStates(H,_){const b=H.getParameter(H.MAX_VERTEX_ATTRIBS),$={},ee=Ee(null);let re=ee,ae=!1;function xe(_t,Lt,Vt,Gt,$t){let Qt=!1;const vt=Se(Gt,Vt,Lt);re!==vt&&(re=vt,fe(re.object)),Qt=Ce(_t,Gt,Vt,$t),Qt&&Ie(_t,Gt,Vt,$t),$t!==null&&_.update($t,H.ELEMENT_ARRAY_BUFFER),(Qt||ae)&&(ae=!1,Ye(_t,Lt,Vt,Gt),$t!==null&&H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,_.get($t).buffer))}function le(){return H.createVertexArray()}function fe(_t){return H.bindVertexArray(_t)}function ve(_t){return H.deleteVertexArray(_t)}function Se(_t,Lt,Vt){const Gt=Vt.wireframe===!0;let $t=$[_t.id];$t===void 0&&($t={},$[_t.id]=$t);let Qt=$t[Lt.id];Qt===void 0&&(Qt={},$t[Lt.id]=Qt);let vt=Qt[Gt];return vt===void 0&&(vt=Ee(le()),Qt[Gt]=vt),vt}function Ee(_t){const Lt=[],Vt=[],Gt=[];for(let $t=0;$t<b;$t++)Lt[$t]=0,Vt[$t]=0,Gt[$t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Lt,enabledAttributes:Vt,attributeDivisors:Gt,object:_t,attributes:{},index:null}}function Ce(_t,Lt,Vt,Gt){const $t=re.attributes,Qt=Lt.attributes;let vt=0;const It=Vt.getAttributes();for(const gt in It)if(It[gt].location>=0){const Ct=$t[gt];let Ft=Qt[gt];if(Ft===void 0&&(gt==="instanceMatrix"&&_t.instanceMatrix&&(Ft=_t.instanceMatrix),gt==="instanceColor"&&_t.instanceColor&&(Ft=_t.instanceColor)),Ct===void 0||Ct.attribute!==Ft||Ft&&Ct.data!==Ft.data)return!0;vt++}return re.attributesNum!==vt||re.index!==Gt}function Ie(_t,Lt,Vt,Gt){const $t={},Qt=Lt.attributes;let vt=0;const It=Vt.getAttributes();for(const gt in It)if(It[gt].location>=0){let Ct=Qt[gt];Ct===void 0&&(gt==="instanceMatrix"&&_t.instanceMatrix&&(Ct=_t.instanceMatrix),gt==="instanceColor"&&_t.instanceColor&&(Ct=_t.instanceColor));const Ft={};Ft.attribute=Ct,Ct&&Ct.data&&(Ft.data=Ct.data),$t[gt]=Ft,vt++}re.attributes=$t,re.attributesNum=vt,re.index=Gt}function De(){const _t=re.newAttributes;for(let Lt=0,Vt=_t.length;Lt<Vt;Lt++)_t[Lt]=0}function Be(_t){Ne(_t,0)}function Ne(_t,Lt){const Vt=re.newAttributes,Gt=re.enabledAttributes,$t=re.attributeDivisors;Vt[_t]=1,Gt[_t]===0&&(H.enableVertexAttribArray(_t),Gt[_t]=1),$t[_t]!==Lt&&(H.vertexAttribDivisor(_t,Lt),$t[_t]=Lt)}function qe(){const _t=re.newAttributes,Lt=re.enabledAttributes;for(let Vt=0,Gt=Lt.length;Vt<Gt;Vt++)Lt[Vt]!==_t[Vt]&&(H.disableVertexAttribArray(Vt),Lt[Vt]=0)}function Xe(_t,Lt,Vt,Gt,$t,Qt,vt){vt===!0?H.vertexAttribIPointer(_t,Lt,Vt,$t,Qt):H.vertexAttribPointer(_t,Lt,Vt,Gt,$t,Qt)}function Ye(_t,Lt,Vt,Gt){De();const $t=Gt.attributes,Qt=Vt.getAttributes(),vt=Lt.defaultAttributeValues;for(const It in Qt){const gt=Qt[It];if(gt.location>=0){let Tt=$t[It];if(Tt===void 0&&(It==="instanceMatrix"&&_t.instanceMatrix&&(Tt=_t.instanceMatrix),It==="instanceColor"&&_t.instanceColor&&(Tt=_t.instanceColor)),Tt!==void 0){const Ct=Tt.normalized,Ft=Tt.itemSize,sn=_.get(Tt);if(sn===void 0)continue;const cn=sn.buffer,en=sn.type,yn=sn.bytesPerElement,Pn=en===H.INT||en===H.UNSIGNED_INT||Tt.gpuType===IntType;if(Tt.isInterleavedBufferAttribute){const tr=Tt.data,nr=tr.stride,Fr=Tt.offset;if(tr.isInstancedInterleavedBuffer){for(let Ur=0;Ur<gt.locationSize;Ur++)Ne(gt.location+Ur,tr.meshPerAttribute);_t.isInstancedMesh!==!0&&Gt._maxInstanceCount===void 0&&(Gt._maxInstanceCount=tr.meshPerAttribute*tr.count)}else for(let Ur=0;Ur<gt.locationSize;Ur++)Be(gt.location+Ur);H.bindBuffer(H.ARRAY_BUFFER,cn);for(let Ur=0;Ur<gt.locationSize;Ur++)Xe(gt.location+Ur,Ft/gt.locationSize,en,Ct,nr*yn,(Fr+Ft/gt.locationSize*Ur)*yn,Pn)}else{if(Tt.isInstancedBufferAttribute){for(let tr=0;tr<gt.locationSize;tr++)Ne(gt.location+tr,Tt.meshPerAttribute);_t.isInstancedMesh!==!0&&Gt._maxInstanceCount===void 0&&(Gt._maxInstanceCount=Tt.meshPerAttribute*Tt.count)}else for(let tr=0;tr<gt.locationSize;tr++)Be(gt.location+tr);H.bindBuffer(H.ARRAY_BUFFER,cn);for(let tr=0;tr<gt.locationSize;tr++)Xe(gt.location+tr,Ft/gt.locationSize,en,Ct,Ft*yn,Ft/gt.locationSize*tr*yn,Pn)}}else if(vt!==void 0){const Ct=vt[It];if(Ct!==void 0)switch(Ct.length){case 2:H.vertexAttrib2fv(gt.location,Ct);break;case 3:H.vertexAttrib3fv(gt.location,Ct);break;case 4:H.vertexAttrib4fv(gt.location,Ct);break;default:H.vertexAttrib1fv(gt.location,Ct)}}}}qe()}function Qe(){ct();for(const _t in $){const Lt=$[_t];for(const Vt in Lt){const Gt=Lt[Vt];for(const $t in Gt)ve(Gt[$t].object),delete Gt[$t];delete Lt[Vt]}delete $[_t]}}function rt(_t){if($[_t.id]===void 0)return;const Lt=$[_t.id];for(const Vt in Lt){const Gt=Lt[Vt];for(const $t in Gt)ve(Gt[$t].object),delete Gt[$t];delete Lt[Vt]}delete $[_t.id]}function ot(_t){for(const Lt in $){const Vt=$[Lt];if(Vt[_t.id]===void 0)continue;const Gt=Vt[_t.id];for(const $t in Gt)ve(Gt[$t].object),delete Gt[$t];delete Vt[_t.id]}}function ct(){mt(),ae=!0,re!==ee&&(re=ee,fe(re.object))}function mt(){ee.geometry=null,ee.program=null,ee.wireframe=!1}return{setup:xe,reset:ct,resetDefaultState:mt,dispose:Qe,releaseStatesOfGeometry:rt,releaseStatesOfProgram:ot,initAttributes:De,enableAttribute:Be,disableUnusedAttributes:qe}}function WebGLBufferRenderer(H,_,b){let $;function ee(fe){$=fe}function re(fe,ve){H.drawArrays($,fe,ve),b.update(ve,$,1)}function ae(fe,ve,Se){Se!==0&&(H.drawArraysInstanced($,fe,ve,Se),b.update(ve,$,Se))}function xe(fe,ve,Se){if(Se===0)return;_.get("WEBGL_multi_draw").multiDrawArraysWEBGL($,fe,0,ve,0,Se);let Ce=0;for(let Ie=0;Ie<Se;Ie++)Ce+=ve[Ie];b.update(Ce,$,1)}function le(fe,ve,Se,Ee){if(Se===0)return;const Ce=_.get("WEBGL_multi_draw");if(Ce===null)for(let Ie=0;Ie<fe.length;Ie++)ae(fe[Ie],ve[Ie],Ee[Ie]);else{Ce.multiDrawArraysInstancedWEBGL($,fe,0,ve,0,Ee,0,Se);let Ie=0;for(let De=0;De<Se;De++)Ie+=ve[De];for(let De=0;De<Ee.length;De++)b.update(Ie,$,Ee[De])}}this.setMode=ee,this.render=re,this.renderInstances=ae,this.renderMultiDraw=xe,this.renderMultiDrawInstances=le}function WebGLCapabilities(H,_,b,$){let ee;function re(){if(ee!==void 0)return ee;if(_.has("EXT_texture_filter_anisotropic")===!0){const rt=_.get("EXT_texture_filter_anisotropic");ee=H.getParameter(rt.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else ee=0;return ee}function ae(rt){return!(rt!==RGBAFormat$1&&$.convert(rt)!==H.getParameter(H.IMPLEMENTATION_COLOR_READ_FORMAT))}function xe(rt){const ot=rt===HalfFloatType$1&&(_.has("EXT_color_buffer_half_float")||_.has("EXT_color_buffer_float"));return!(rt!==UnsignedByteType$1&&$.convert(rt)!==H.getParameter(H.IMPLEMENTATION_COLOR_READ_TYPE)&&rt!==FloatType$1&&!ot)}function le(rt){if(rt==="highp"){if(H.getShaderPrecisionFormat(H.VERTEX_SHADER,H.HIGH_FLOAT).precision>0&&H.getShaderPrecisionFormat(H.FRAGMENT_SHADER,H.HIGH_FLOAT).precision>0)return"highp";rt="mediump"}return rt==="mediump"&&H.getShaderPrecisionFormat(H.VERTEX_SHADER,H.MEDIUM_FLOAT).precision>0&&H.getShaderPrecisionFormat(H.FRAGMENT_SHADER,H.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let fe=b.precision!==void 0?b.precision:"highp";const ve=le(fe);ve!==fe&&(console.warn("THREE.WebGLRenderer:",fe,"not supported, using",ve,"instead."),fe=ve);const Se=b.logarithmicDepthBuffer===!0,Ee=H.getParameter(H.MAX_TEXTURE_IMAGE_UNITS),Ce=H.getParameter(H.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Ie=H.getParameter(H.MAX_TEXTURE_SIZE),De=H.getParameter(H.MAX_CUBE_MAP_TEXTURE_SIZE),Be=H.getParameter(H.MAX_VERTEX_ATTRIBS),Ne=H.getParameter(H.MAX_VERTEX_UNIFORM_VECTORS),qe=H.getParameter(H.MAX_VARYING_VECTORS),Xe=H.getParameter(H.MAX_FRAGMENT_UNIFORM_VECTORS),Ye=Ce>0,Qe=H.getParameter(H.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:re,getMaxPrecision:le,textureFormatReadable:ae,textureTypeReadable:xe,precision:fe,logarithmicDepthBuffer:Se,maxTextures:Ee,maxVertexTextures:Ce,maxTextureSize:Ie,maxCubemapSize:De,maxAttributes:Be,maxVertexUniforms:Ne,maxVaryings:qe,maxFragmentUniforms:Xe,vertexTextures:Ye,maxSamples:Qe}}function WebGLClipping(H){const _=this;let b=null,$=0,ee=!1,re=!1;const ae=new Plane$1,xe=new Matrix3$1,le={value:null,needsUpdate:!1};this.uniform=le,this.numPlanes=0,this.numIntersection=0,this.init=function(Se,Ee){const Ce=Se.length!==0||Ee||$!==0||ee;return ee=Ee,$=Se.length,Ce},this.beginShadows=function(){re=!0,ve(null)},this.endShadows=function(){re=!1},this.setGlobalState=function(Se,Ee){b=ve(Se,Ee,0)},this.setState=function(Se,Ee,Ce){const Ie=Se.clippingPlanes,De=Se.clipIntersection,Be=Se.clipShadows,Ne=H.get(Se);if(!ee||Ie===null||Ie.length===0||re&&!Be)re?ve(null):fe();else{const qe=re?0:$,Xe=qe*4;let Ye=Ne.clippingState||null;le.value=Ye,Ye=ve(Ie,Ee,Xe,Ce);for(let Qe=0;Qe!==Xe;++Qe)Ye[Qe]=b[Qe];Ne.clippingState=Ye,this.numIntersection=De?this.numPlanes:0,this.numPlanes+=qe}};function fe(){le.value!==b&&(le.value=b,le.needsUpdate=$>0),_.numPlanes=$,_.numIntersection=0}function ve(Se,Ee,Ce,Ie){const De=Se!==null?Se.length:0;let Be=null;if(De!==0){if(Be=le.value,Ie!==!0||Be===null){const Ne=Ce+De*4,qe=Ee.matrixWorldInverse;xe.getNormalMatrix(qe),(Be===null||Be.length<Ne)&&(Be=new Float32Array(Ne));for(let Xe=0,Ye=Ce;Xe!==De;++Xe,Ye+=4)ae.copy(Se[Xe]).applyMatrix4(qe,xe),ae.normal.toArray(Be,Ye),Be[Ye+3]=ae.constant}le.value=Be,le.needsUpdate=!0}return _.numPlanes=De,_.numIntersection=0,Be}}let _canvas$1,ImageUtils$1=class{static getDataURL(_){if(/^data:/i.test(_.src)||typeof HTMLCanvasElement>"u")return _.src;let b;if(_ instanceof HTMLCanvasElement)b=_;else{_canvas$1===void 0&&(_canvas$1=createElementNS$1("canvas")),_canvas$1.width=_.width,_canvas$1.height=_.height;const $=_canvas$1.getContext("2d");_ instanceof ImageData?$.putImageData(_,0,0):$.drawImage(_,0,0,_.width,_.height),b=_canvas$1}return b.width>2048||b.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",_),b.toDataURL("image/jpeg",.6)):b.toDataURL("image/png")}static sRGBToLinear(_){if(typeof HTMLImageElement<"u"&&_ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_ instanceof ImageBitmap){const b=createElementNS$1("canvas");b.width=_.width,b.height=_.height;const $=b.getContext("2d");$.drawImage(_,0,0,_.width,_.height);const ee=$.getImageData(0,0,_.width,_.height),re=ee.data;for(let ae=0;ae<re.length;ae++)re[ae]=SRGBToLinear$1(re[ae]/255)*255;return $.putImageData(ee,0,0),b}else if(_.data){const b=_.data.slice(0);for(let $=0;$<b.length;$++)b instanceof Uint8Array||b instanceof Uint8ClampedArray?b[$]=Math.floor(SRGBToLinear$1(b[$]/255)*255):b[$]=SRGBToLinear$1(b[$]);return{data:b,width:_.width,height:_.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),_}},_sourceId$1=0,Source$1=class{constructor(_=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_sourceId$1++}),this.uuid=generateUUID$1(),this.data=_,this.dataReady=!0,this.version=0}set needsUpdate(_){_===!0&&this.version++}toJSON(_){const b=_===void 0||typeof _=="string";if(!b&&_.images[this.uuid]!==void 0)return _.images[this.uuid];const $={uuid:this.uuid,url:""},ee=this.data;if(ee!==null){let re;if(Array.isArray(ee)){re=[];for(let ae=0,xe=ee.length;ae<xe;ae++)ee[ae].isDataTexture?re.push(serializeImage$1(ee[ae].image)):re.push(serializeImage$1(ee[ae]))}else re=serializeImage$1(ee);$.url=re}return b||(_.images[this.uuid]=$),$}};function serializeImage$1(H){return typeof HTMLImageElement<"u"&&H instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&H instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&H instanceof ImageBitmap?ImageUtils$1.getDataURL(H):H.data?{data:Array.from(H.data),width:H.width,height:H.height,type:H.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _textureId$1=0,Texture$1=class J2 extends EventDispatcher$1{constructor(_=J2.DEFAULT_IMAGE,b=J2.DEFAULT_MAPPING,$=ClampToEdgeWrapping$1,ee=ClampToEdgeWrapping$1,re=LinearFilter$1,ae=LinearMipmapLinearFilter$1,xe=RGBAFormat$1,le=UnsignedByteType$1,fe=J2.DEFAULT_ANISOTROPY,ve=NoColorSpace$1){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_textureId$1++}),this.uuid=generateUUID$1(),this.name="",this.source=new Source$1(_),this.mipmaps=[],this.mapping=b,this.channel=0,this.wrapS=$,this.wrapT=ee,this.magFilter=re,this.minFilter=ae,this.anisotropy=fe,this.format=xe,this.internalFormat=null,this.type=le,this.offset=new Vector2$1(0,0),this.repeat=new Vector2$1(1,1),this.center=new Vector2$1(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3$1,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=ve,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(_=null){this.source.data=_}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(_){return this.name=_.name,this.source=_.source,this.mipmaps=_.mipmaps.slice(0),this.mapping=_.mapping,this.channel=_.channel,this.wrapS=_.wrapS,this.wrapT=_.wrapT,this.magFilter=_.magFilter,this.minFilter=_.minFilter,this.anisotropy=_.anisotropy,this.format=_.format,this.internalFormat=_.internalFormat,this.type=_.type,this.offset.copy(_.offset),this.repeat.copy(_.repeat),this.center.copy(_.center),this.rotation=_.rotation,this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrix.copy(_.matrix),this.generateMipmaps=_.generateMipmaps,this.premultiplyAlpha=_.premultiplyAlpha,this.flipY=_.flipY,this.unpackAlignment=_.unpackAlignment,this.colorSpace=_.colorSpace,this.userData=JSON.parse(JSON.stringify(_.userData)),this.needsUpdate=!0,this}toJSON(_){const b=_===void 0||typeof _=="string";if(!b&&_.textures[this.uuid]!==void 0)return _.textures[this.uuid];const $={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(_).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&($.userData=this.userData),b||(_.textures[this.uuid]=$),$}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(_){if(this.mapping!==UVMapping$1)return _;if(_.applyMatrix3(this.matrix),_.x<0||_.x>1)switch(this.wrapS){case RepeatWrapping$1:_.x=_.x-Math.floor(_.x);break;case ClampToEdgeWrapping$1:_.x=_.x<0?0:1;break;case MirroredRepeatWrapping$1:Math.abs(Math.floor(_.x)%2)===1?_.x=Math.ceil(_.x)-_.x:_.x=_.x-Math.floor(_.x);break}if(_.y<0||_.y>1)switch(this.wrapT){case RepeatWrapping$1:_.y=_.y-Math.floor(_.y);break;case ClampToEdgeWrapping$1:_.y=_.y<0?0:1;break;case MirroredRepeatWrapping$1:Math.abs(Math.floor(_.y)%2)===1?_.y=Math.ceil(_.y)-_.y:_.y=_.y-Math.floor(_.y);break}return this.flipY&&(_.y=1-_.y),_}set needsUpdate(_){_===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(_){_===!0&&this.pmremVersion++}};Texture$1.DEFAULT_IMAGE=null;Texture$1.DEFAULT_MAPPING=UVMapping$1;Texture$1.DEFAULT_ANISOTROPY=1;class RenderTarget extends EventDispatcher$1{constructor(_=1,b=1,$={}){super(),this.isRenderTarget=!0,this.width=_,this.height=b,this.depth=1,this.scissor=new Vector4$1(0,0,_,b),this.scissorTest=!1,this.viewport=new Vector4$1(0,0,_,b);const ee={width:_,height:b,depth:1};$=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:LinearFilter$1,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},$);const re=new Texture$1(ee,$.mapping,$.wrapS,$.wrapT,$.magFilter,$.minFilter,$.format,$.type,$.anisotropy,$.colorSpace);re.flipY=!1,re.generateMipmaps=$.generateMipmaps,re.internalFormat=$.internalFormat,this.textures=[];const ae=$.count;for(let xe=0;xe<ae;xe++)this.textures[xe]=re.clone(),this.textures[xe].isRenderTargetTexture=!0;this.depthBuffer=$.depthBuffer,this.stencilBuffer=$.stencilBuffer,this.resolveDepthBuffer=$.resolveDepthBuffer,this.resolveStencilBuffer=$.resolveStencilBuffer,this.depthTexture=$.depthTexture,this.samples=$.samples}get texture(){return this.textures[0]}set texture(_){this.textures[0]=_}setSize(_,b,$=1){if(this.width!==_||this.height!==b||this.depth!==$){this.width=_,this.height=b,this.depth=$;for(let ee=0,re=this.textures.length;ee<re;ee++)this.textures[ee].image.width=_,this.textures[ee].image.height=b,this.textures[ee].image.depth=$;this.dispose()}this.viewport.set(0,0,_,b),this.scissor.set(0,0,_,b)}clone(){return new this.constructor().copy(this)}copy(_){this.width=_.width,this.height=_.height,this.depth=_.depth,this.scissor.copy(_.scissor),this.scissorTest=_.scissorTest,this.viewport.copy(_.viewport),this.textures.length=0;for(let $=0,ee=_.textures.length;$<ee;$++)this.textures[$]=_.textures[$].clone(),this.textures[$].isRenderTargetTexture=!0;const b=Object.assign({},_.texture.image);return this.texture.source=new Source$1(b),this.depthBuffer=_.depthBuffer,this.stencilBuffer=_.stencilBuffer,this.resolveDepthBuffer=_.resolveDepthBuffer,this.resolveStencilBuffer=_.resolveStencilBuffer,_.depthTexture!==null&&(this.depthTexture=_.depthTexture.clone()),this.samples=_.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class WebGLRenderTarget extends RenderTarget{constructor(_=1,b=1,$={}){super(_,b,$),this.isWebGLRenderTarget=!0}}let Camera$1=class extends Object3D$1{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4$1,this.projectionMatrix=new Matrix4$1,this.projectionMatrixInverse=new Matrix4$1,this.coordinateSystem=WebGLCoordinateSystem$1}copy(_,b){return super.copy(_,b),this.matrixWorldInverse.copy(_.matrixWorldInverse),this.projectionMatrix.copy(_.projectionMatrix),this.projectionMatrixInverse.copy(_.projectionMatrixInverse),this.coordinateSystem=_.coordinateSystem,this}getWorldDirection(_){return super.getWorldDirection(_).negate()}updateMatrixWorld(_){super.updateMatrixWorld(_),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(_,b){super.updateWorldMatrix(_,b),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const _v3=new Vector3$1,_minTarget$1=new Vector2$1,_maxTarget$1=new Vector2$1;let PerspectiveCamera$1=class extends Camera$1{constructor(_=50,b=1,$=.1,ee=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=_,this.zoom=1,this.near=$,this.far=ee,this.focus=10,this.aspect=b,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(_,b){return super.copy(_,b),this.fov=_.fov,this.zoom=_.zoom,this.near=_.near,this.far=_.far,this.focus=_.focus,this.aspect=_.aspect,this.view=_.view===null?null:Object.assign({},_.view),this.filmGauge=_.filmGauge,this.filmOffset=_.filmOffset,this}setFocalLength(_){const b=.5*this.getFilmHeight()/_;this.fov=RAD2DEG$1*2*Math.atan(b),this.updateProjectionMatrix()}getFocalLength(){const _=Math.tan(DEG2RAD$1*.5*this.fov);return .5*this.getFilmHeight()/_}getEffectiveFOV(){return RAD2DEG$1*2*Math.atan(Math.tan(DEG2RAD$1*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(_,b,$){_v3.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),b.set(_v3.x,_v3.y).multiplyScalar(-_/_v3.z),_v3.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),$.set(_v3.x,_v3.y).multiplyScalar(-_/_v3.z)}getViewSize(_,b){return this.getViewBounds(_,_minTarget$1,_maxTarget$1),b.subVectors(_maxTarget$1,_minTarget$1)}setViewOffset(_,b,$,ee,re,ae){this.aspect=_/b,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=b,this.view.offsetX=$,this.view.offsetY=ee,this.view.width=re,this.view.height=ae,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=this.near;let b=_*Math.tan(DEG2RAD$1*.5*this.fov)/this.zoom,$=2*b,ee=this.aspect*$,re=-.5*ee;const ae=this.view;if(this.view!==null&&this.view.enabled){const le=ae.fullWidth,fe=ae.fullHeight;re+=ae.offsetX*ee/le,b-=ae.offsetY*$/fe,ee*=ae.width/le,$*=ae.height/fe}const xe=this.filmOffset;xe!==0&&(re+=_*xe/this.getFilmWidth()),this.projectionMatrix.makePerspective(re,re+ee,b,b-$,_,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const b=super.toJSON(_);return b.object.fov=this.fov,b.object.zoom=this.zoom,b.object.near=this.near,b.object.far=this.far,b.object.focus=this.focus,b.object.aspect=this.aspect,this.view!==null&&(b.object.view=Object.assign({},this.view)),b.object.filmGauge=this.filmGauge,b.object.filmOffset=this.filmOffset,b}};const fov=-90,aspect=1;class CubeCamera extends Object3D$1{constructor(_,b,$){super(),this.type="CubeCamera",this.renderTarget=$,this.coordinateSystem=null,this.activeMipmapLevel=0;const ee=new PerspectiveCamera$1(fov,aspect,_,b);ee.layers=this.layers,this.add(ee);const re=new PerspectiveCamera$1(fov,aspect,_,b);re.layers=this.layers,this.add(re);const ae=new PerspectiveCamera$1(fov,aspect,_,b);ae.layers=this.layers,this.add(ae);const xe=new PerspectiveCamera$1(fov,aspect,_,b);xe.layers=this.layers,this.add(xe);const le=new PerspectiveCamera$1(fov,aspect,_,b);le.layers=this.layers,this.add(le);const fe=new PerspectiveCamera$1(fov,aspect,_,b);fe.layers=this.layers,this.add(fe)}updateCoordinateSystem(){const _=this.coordinateSystem,b=this.children.concat(),[$,ee,re,ae,xe,le]=b;for(const fe of b)this.remove(fe);if(_===WebGLCoordinateSystem$1)$.up.set(0,1,0),$.lookAt(1,0,0),ee.up.set(0,1,0),ee.lookAt(-1,0,0),re.up.set(0,0,-1),re.lookAt(0,1,0),ae.up.set(0,0,1),ae.lookAt(0,-1,0),xe.up.set(0,1,0),xe.lookAt(0,0,1),le.up.set(0,1,0),le.lookAt(0,0,-1);else if(_===WebGPUCoordinateSystem$1)$.up.set(0,-1,0),$.lookAt(-1,0,0),ee.up.set(0,-1,0),ee.lookAt(1,0,0),re.up.set(0,0,1),re.lookAt(0,1,0),ae.up.set(0,0,-1),ae.lookAt(0,-1,0),xe.up.set(0,-1,0),xe.lookAt(0,0,1),le.up.set(0,-1,0),le.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+_);for(const fe of b)this.add(fe),fe.updateMatrixWorld()}update(_,b){this.parent===null&&this.updateMatrixWorld();const{renderTarget:$,activeMipmapLevel:ee}=this;this.coordinateSystem!==_.coordinateSystem&&(this.coordinateSystem=_.coordinateSystem,this.updateCoordinateSystem());const[re,ae,xe,le,fe,ve]=this.children,Se=_.getRenderTarget(),Ee=_.getActiveCubeFace(),Ce=_.getActiveMipmapLevel(),Ie=_.xr.enabled;_.xr.enabled=!1;const De=$.texture.generateMipmaps;$.texture.generateMipmaps=!1,_.setRenderTarget($,0,ee),_.render(b,re),_.setRenderTarget($,1,ee),_.render(b,ae),_.setRenderTarget($,2,ee),_.render(b,xe),_.setRenderTarget($,3,ee),_.render(b,le),_.setRenderTarget($,4,ee),_.render(b,fe),$.texture.generateMipmaps=De,_.setRenderTarget($,5,ee),_.render(b,ve),_.setRenderTarget(Se,Ee,Ce),_.xr.enabled=Ie,$.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture$1{constructor(_,b,$,ee,re,ae,xe,le,fe,ve){_=_!==void 0?_:[],b=b!==void 0?b:CubeReflectionMapping,super(_,b,$,ee,re,ae,xe,le,fe,ve),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(_){this.image=_}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(_=1,b={}){super(_,_,b),this.isWebGLCubeRenderTarget=!0;const $={width:_,height:_,depth:1},ee=[$,$,$,$,$,$];this.texture=new CubeTexture(ee,b.mapping,b.wrapS,b.wrapT,b.magFilter,b.minFilter,b.format,b.type,b.anisotropy,b.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=b.generateMipmaps!==void 0?b.generateMipmaps:!1,this.texture.minFilter=b.minFilter!==void 0?b.minFilter:LinearFilter$1}fromEquirectangularTexture(_,b){this.texture.type=b.type,this.texture.colorSpace=b.colorSpace,this.texture.generateMipmaps=b.generateMipmaps,this.texture.minFilter=b.minFilter,this.texture.magFilter=b.magFilter;const $={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},ee=new BoxGeometry(5,5,5),re=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms($.uniforms),vertexShader:$.vertexShader,fragmentShader:$.fragmentShader,side:BackSide$1,blending:NoBlending});re.uniforms.tEquirect.value=b;const ae=new Mesh$1(ee,re),xe=b.minFilter;return b.minFilter===LinearMipmapLinearFilter$1&&(b.minFilter=LinearFilter$1),new CubeCamera(1,10,this).update(_,ae),b.minFilter=xe,ae.geometry.dispose(),ae.material.dispose(),this}clear(_,b,$,ee){const re=_.getRenderTarget();for(let ae=0;ae<6;ae++)_.setRenderTarget(this,ae),_.clear(b,$,ee);_.setRenderTarget(re)}}function WebGLCubeMaps(H){let _=new WeakMap;function b(ae,xe){return xe===EquirectangularReflectionMapping$1?ae.mapping=CubeReflectionMapping:xe===EquirectangularRefractionMapping&&(ae.mapping=CubeRefractionMapping),ae}function $(ae){if(ae&&ae.isTexture){const xe=ae.mapping;if(xe===EquirectangularReflectionMapping$1||xe===EquirectangularRefractionMapping)if(_.has(ae)){const le=_.get(ae).texture;return b(le,ae.mapping)}else{const le=ae.image;if(le&&le.height>0){const fe=new WebGLCubeRenderTarget(le.height);return fe.fromEquirectangularTexture(H,ae),_.set(ae,fe),ae.addEventListener("dispose",ee),b(fe.texture,ae.mapping)}else return null}}return ae}function ee(ae){const xe=ae.target;xe.removeEventListener("dispose",ee);const le=_.get(xe);le!==void 0&&(_.delete(xe),le.dispose())}function re(){_=new WeakMap}return{get:$,dispose:re}}let OrthographicCamera$1=class extends Camera$1{constructor(_=-1,b=1,$=1,ee=-1,re=.1,ae=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_,this.right=b,this.top=$,this.bottom=ee,this.near=re,this.far=ae,this.updateProjectionMatrix()}copy(_,b){return super.copy(_,b),this.left=_.left,this.right=_.right,this.top=_.top,this.bottom=_.bottom,this.near=_.near,this.far=_.far,this.zoom=_.zoom,this.view=_.view===null?null:Object.assign({},_.view),this}setViewOffset(_,b,$,ee,re,ae){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=b,this.view.offsetX=$,this.view.offsetY=ee,this.view.width=re,this.view.height=ae,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),$=(this.right+this.left)/2,ee=(this.top+this.bottom)/2;let re=$-_,ae=$+_,xe=ee+b,le=ee-b;if(this.view!==null&&this.view.enabled){const fe=(this.right-this.left)/this.view.fullWidth/this.zoom,ve=(this.top-this.bottom)/this.view.fullHeight/this.zoom;re+=fe*this.view.offsetX,ae=re+fe*this.view.width,xe-=ve*this.view.offsetY,le=xe-ve*this.view.height}this.projectionMatrix.makeOrthographic(re,ae,xe,le,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const b=super.toJSON(_);return b.object.zoom=this.zoom,b.object.left=this.left,b.object.right=this.right,b.object.top=this.top,b.object.bottom=this.bottom,b.object.near=this.near,b.object.far=this.far,this.view!==null&&(b.object.view=Object.assign({},this.view)),b}};const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera$1,_clearColor=new Color$1;let _oldTarget=null,_oldActiveCubeFace=0,_oldActiveMipmapLevel=0,_oldXrEnabled=!1;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3$1(-PHI,INV_PHI,0),new Vector3$1(PHI,INV_PHI,0),new Vector3$1(-INV_PHI,0,PHI),new Vector3$1(INV_PHI,0,PHI),new Vector3$1(0,PHI,-INV_PHI),new Vector3$1(0,PHI,INV_PHI),new Vector3$1(-1,1,-1),new Vector3$1(1,1,-1),new Vector3$1(-1,1,1),new Vector3$1(1,1,1)];class PMREMGenerator{constructor(_){this._renderer=_,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(_,b=0,$=.1,ee=100){_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const re=this._allocateTargets();return re.depthBuffer=!0,this._sceneToCubeUV(_,$,ee,re),b>0&&this._blur(re,0,0,b),this._applyPMREM(re),this._cleanup(re),re}fromEquirectangular(_,b=null){return this._fromTexture(_,b)}fromCubemap(_,b=null){return this._fromTexture(_,b)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(_){this._lodMax=Math.floor(Math.log2(_)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let _=0;_<this._lodPlanes.length;_++)this._lodPlanes[_].dispose()}_cleanup(_){this._renderer.setRenderTarget(_oldTarget,_oldActiveCubeFace,_oldActiveMipmapLevel),this._renderer.xr.enabled=_oldXrEnabled,_.scissorTest=!1,_setViewport(_,0,0,_.width,_.height)}_fromTexture(_,b){_.mapping===CubeReflectionMapping||_.mapping===CubeRefractionMapping?this._setSize(_.image.length===0?16:_.image[0].width||_.image[0].image.width):this._setSize(_.image.width/4),_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const $=b||this._allocateTargets();return this._textureToCubeUV(_,$),this._applyPMREM($),this._cleanup($),$}_allocateTargets(){const _=3*Math.max(this._cubeSize,112),b=4*this._cubeSize,$={magFilter:LinearFilter$1,minFilter:LinearFilter$1,generateMipmaps:!1,type:HalfFloatType$1,format:RGBAFormat$1,colorSpace:LinearSRGBColorSpace$1,depthBuffer:!1},ee=_createRenderTarget(_,b,$);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==_||this._pingPongRenderTarget.height!==b){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(_,b,$);const{_lodMax:re}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(re)),this._blurMaterial=_getBlurShader(re,_,b)}return ee}_compileMaterial(_){const b=new Mesh$1(this._lodPlanes[0],_);this._renderer.compile(b,_flatCamera)}_sceneToCubeUV(_,b,$,ee){const xe=new PerspectiveCamera$1(90,1,b,$),le=[1,-1,1,1,1,1],fe=[1,1,1,-1,-1,-1],ve=this._renderer,Se=ve.autoClear,Ee=ve.toneMapping;ve.getClearColor(_clearColor),ve.toneMapping=NoToneMapping,ve.autoClear=!1;const Ce=new MeshBasicMaterial$1({name:"PMREM.Background",side:BackSide$1,depthWrite:!1,depthTest:!1}),Ie=new Mesh$1(new BoxGeometry,Ce);let De=!1;const Be=_.background;Be?Be.isColor&&(Ce.color.copy(Be),_.background=null,De=!0):(Ce.color.copy(_clearColor),De=!0);for(let Ne=0;Ne<6;Ne++){const qe=Ne%3;qe===0?(xe.up.set(0,le[Ne],0),xe.lookAt(fe[Ne],0,0)):qe===1?(xe.up.set(0,0,le[Ne]),xe.lookAt(0,fe[Ne],0)):(xe.up.set(0,le[Ne],0),xe.lookAt(0,0,fe[Ne]));const Xe=this._cubeSize;_setViewport(ee,qe*Xe,Ne>2?Xe:0,Xe,Xe),ve.setRenderTarget(ee),De&&ve.render(Ie,xe),ve.render(_,xe)}Ie.geometry.dispose(),Ie.material.dispose(),ve.toneMapping=Ee,ve.autoClear=Se,_.background=Be}_textureToCubeUV(_,b){const $=this._renderer,ee=_.mapping===CubeReflectionMapping||_.mapping===CubeRefractionMapping;ee?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=_.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const re=ee?this._cubemapMaterial:this._equirectMaterial,ae=new Mesh$1(this._lodPlanes[0],re),xe=re.uniforms;xe.envMap.value=_;const le=this._cubeSize;_setViewport(b,0,0,3*le,2*le),$.setRenderTarget(b),$.render(ae,_flatCamera)}_applyPMREM(_){const b=this._renderer,$=b.autoClear;b.autoClear=!1;const ee=this._lodPlanes.length;for(let re=1;re<ee;re++){const ae=Math.sqrt(this._sigmas[re]*this._sigmas[re]-this._sigmas[re-1]*this._sigmas[re-1]),xe=_axisDirections[(ee-re-1)%_axisDirections.length];this._blur(_,re-1,re,ae,xe)}b.autoClear=$}_blur(_,b,$,ee,re){const ae=this._pingPongRenderTarget;this._halfBlur(_,ae,b,$,ee,"latitudinal",re),this._halfBlur(ae,_,$,$,ee,"longitudinal",re)}_halfBlur(_,b,$,ee,re,ae,xe){const le=this._renderer,fe=this._blurMaterial;ae!=="latitudinal"&&ae!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const ve=3,Se=new Mesh$1(this._lodPlanes[ee],fe),Ee=fe.uniforms,Ce=this._sizeLods[$]-1,Ie=isFinite(re)?Math.PI/(2*Ce):2*Math.PI/(2*MAX_SAMPLES-1),De=re/Ie,Be=isFinite(re)?1+Math.floor(ve*De):MAX_SAMPLES;Be>MAX_SAMPLES&&console.warn(`sigmaRadians, ${re}, is too large and will clip, as it requested ${Be} samples when the maximum is set to ${MAX_SAMPLES}`);const Ne=[];let qe=0;for(let ot=0;ot<MAX_SAMPLES;++ot){const ct=ot/De,mt=Math.exp(-ct*ct/2);Ne.push(mt),ot===0?qe+=mt:ot<Be&&(qe+=2*mt)}for(let ot=0;ot<Ne.length;ot++)Ne[ot]=Ne[ot]/qe;Ee.envMap.value=_.texture,Ee.samples.value=Be,Ee.weights.value=Ne,Ee.latitudinal.value=ae==="latitudinal",xe&&(Ee.poleAxis.value=xe);const{_lodMax:Xe}=this;Ee.dTheta.value=Ie,Ee.mipInt.value=Xe-$;const Ye=this._sizeLods[ee],Qe=3*Ye*(ee>Xe-LOD_MIN?ee-Xe+LOD_MIN:0),rt=4*(this._cubeSize-Ye);_setViewport(b,Qe,rt,3*Ye,2*Ye),le.setRenderTarget(b),le.render(Se,_flatCamera)}}function _createPlanes(H){const _=[],b=[],$=[];let ee=H;const re=H-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let ae=0;ae<re;ae++){const xe=Math.pow(2,ee);b.push(xe);let le=1/xe;ae>H-LOD_MIN?le=EXTRA_LOD_SIGMA[ae-H+LOD_MIN-1]:ae===0&&(le=0),$.push(le);const fe=1/(xe-2),ve=-fe,Se=1+fe,Ee=[ve,ve,Se,ve,Se,Se,ve,ve,Se,Se,ve,Se],Ce=6,Ie=6,De=3,Be=2,Ne=1,qe=new Float32Array(De*Ie*Ce),Xe=new Float32Array(Be*Ie*Ce),Ye=new Float32Array(Ne*Ie*Ce);for(let rt=0;rt<Ce;rt++){const ot=rt%3*2/3-1,ct=rt>2?0:-1,mt=[ot,ct,0,ot+2/3,ct,0,ot+2/3,ct+1,0,ot,ct,0,ot+2/3,ct+1,0,ot,ct+1,0];qe.set(mt,De*Ie*rt),Xe.set(Ee,Be*Ie*rt);const _t=[rt,rt,rt,rt,rt,rt];Ye.set(_t,Ne*Ie*rt)}const Qe=new BufferGeometry$1;Qe.setAttribute("position",new BufferAttribute$1(qe,De)),Qe.setAttribute("uv",new BufferAttribute$1(Xe,Be)),Qe.setAttribute("faceIndex",new BufferAttribute$1(Ye,Ne)),_.push(Qe),ee>LOD_MIN&&ee--}return{lodPlanes:_,sizeLods:b,sigmas:$}}function _createRenderTarget(H,_,b){const $=new WebGLRenderTarget(H,_,b);return $.texture.mapping=CubeUVReflectionMapping,$.texture.name="PMREM.cubeUv",$.scissorTest=!0,$}function _setViewport(H,_,b,$,ee){H.viewport.set(_,b,$,ee),H.scissor.set(_,b,$,ee)}function _getBlurShader(H,_,b){const $=new Float32Array(MAX_SAMPLES),ee=new Vector3$1(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES,CUBEUV_TEXEL_WIDTH:1/_,CUBEUV_TEXEL_HEIGHT:1/b,CUBEUV_MAX_MIP:`${H}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:$},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:ee}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(H){let _=new WeakMap,b=null;function $(xe){if(xe&&xe.isTexture){const le=xe.mapping,fe=le===EquirectangularReflectionMapping$1||le===EquirectangularRefractionMapping,ve=le===CubeReflectionMapping||le===CubeRefractionMapping;if(fe||ve){let Se=_.get(xe);const Ee=Se!==void 0?Se.texture.pmremVersion:0;if(xe.isRenderTargetTexture&&xe.pmremVersion!==Ee)return b===null&&(b=new PMREMGenerator(H)),Se=fe?b.fromEquirectangular(xe,Se):b.fromCubemap(xe,Se),Se.texture.pmremVersion=xe.pmremVersion,_.set(xe,Se),Se.texture;if(Se!==void 0)return Se.texture;{const Ce=xe.image;return fe&&Ce&&Ce.height>0||ve&&Ce&&ee(Ce)?(b===null&&(b=new PMREMGenerator(H)),Se=fe?b.fromEquirectangular(xe):b.fromCubemap(xe),Se.texture.pmremVersion=xe.pmremVersion,_.set(xe,Se),xe.addEventListener("dispose",re),Se.texture):null}}}return xe}function ee(xe){let le=0;const fe=6;for(let ve=0;ve<fe;ve++)xe[ve]!==void 0&&le++;return le===fe}function re(xe){const le=xe.target;le.removeEventListener("dispose",re);const fe=_.get(le);fe!==void 0&&(_.delete(le),fe.dispose())}function ae(){_=new WeakMap,b!==null&&(b.dispose(),b=null)}return{get:$,dispose:ae}}function WebGLExtensions(H){const _={};function b($){if(_[$]!==void 0)return _[$];let ee;switch($){case"WEBGL_depth_texture":ee=H.getExtension("WEBGL_depth_texture")||H.getExtension("MOZ_WEBGL_depth_texture")||H.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":ee=H.getExtension("EXT_texture_filter_anisotropic")||H.getExtension("MOZ_EXT_texture_filter_anisotropic")||H.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":ee=H.getExtension("WEBGL_compressed_texture_s3tc")||H.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||H.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":ee=H.getExtension("WEBGL_compressed_texture_pvrtc")||H.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:ee=H.getExtension($)}return _[$]=ee,ee}return{has:function($){return b($)!==null},init:function(){b("EXT_color_buffer_float"),b("WEBGL_clip_cull_distance"),b("OES_texture_float_linear"),b("EXT_color_buffer_half_float"),b("WEBGL_multisampled_render_to_texture"),b("WEBGL_render_shared_exponent")},get:function($){const ee=b($);return ee===null&&warnOnce$1("THREE.WebGLRenderer: "+$+" extension not supported."),ee}}}function WebGLGeometries(H,_,b,$){const ee={},re=new WeakMap;function ae(Se){const Ee=Se.target;Ee.index!==null&&_.remove(Ee.index);for(const Ie in Ee.attributes)_.remove(Ee.attributes[Ie]);for(const Ie in Ee.morphAttributes){const De=Ee.morphAttributes[Ie];for(let Be=0,Ne=De.length;Be<Ne;Be++)_.remove(De[Be])}Ee.removeEventListener("dispose",ae),delete ee[Ee.id];const Ce=re.get(Ee);Ce&&(_.remove(Ce),re.delete(Ee)),$.releaseStatesOfGeometry(Ee),Ee.isInstancedBufferGeometry===!0&&delete Ee._maxInstanceCount,b.memory.geometries--}function xe(Se,Ee){return ee[Ee.id]===!0||(Ee.addEventListener("dispose",ae),ee[Ee.id]=!0,b.memory.geometries++),Ee}function le(Se){const Ee=Se.attributes;for(const Ie in Ee)_.update(Ee[Ie],H.ARRAY_BUFFER);const Ce=Se.morphAttributes;for(const Ie in Ce){const De=Ce[Ie];for(let Be=0,Ne=De.length;Be<Ne;Be++)_.update(De[Be],H.ARRAY_BUFFER)}}function fe(Se){const Ee=[],Ce=Se.index,Ie=Se.attributes.position;let De=0;if(Ce!==null){const qe=Ce.array;De=Ce.version;for(let Xe=0,Ye=qe.length;Xe<Ye;Xe+=3){const Qe=qe[Xe+0],rt=qe[Xe+1],ot=qe[Xe+2];Ee.push(Qe,rt,rt,ot,ot,Qe)}}else if(Ie!==void 0){const qe=Ie.array;De=Ie.version;for(let Xe=0,Ye=qe.length/3-1;Xe<Ye;Xe+=3){const Qe=Xe+0,rt=Xe+1,ot=Xe+2;Ee.push(Qe,rt,rt,ot,ot,Qe)}}else return;const Be=new(arrayNeedsUint32$1(Ee)?Uint32BufferAttribute$1:Uint16BufferAttribute$1)(Ee,1);Be.version=De;const Ne=re.get(Se);Ne&&_.remove(Ne),re.set(Se,Be)}function ve(Se){const Ee=re.get(Se);if(Ee){const Ce=Se.index;Ce!==null&&Ee.version<Ce.version&&fe(Se)}else fe(Se);return re.get(Se)}return{get:xe,update:le,getWireframeAttribute:ve}}function WebGLIndexedBufferRenderer(H,_,b){let $;function ee(Ee){$=Ee}let re,ae;function xe(Ee){re=Ee.type,ae=Ee.bytesPerElement}function le(Ee,Ce){H.drawElements($,Ce,re,Ee*ae),b.update(Ce,$,1)}function fe(Ee,Ce,Ie){Ie!==0&&(H.drawElementsInstanced($,Ce,re,Ee*ae,Ie),b.update(Ce,$,Ie))}function ve(Ee,Ce,Ie){if(Ie===0)return;_.get("WEBGL_multi_draw").multiDrawElementsWEBGL($,Ce,0,re,Ee,0,Ie);let Be=0;for(let Ne=0;Ne<Ie;Ne++)Be+=Ce[Ne];b.update(Be,$,1)}function Se(Ee,Ce,Ie,De){if(Ie===0)return;const Be=_.get("WEBGL_multi_draw");if(Be===null)for(let Ne=0;Ne<Ee.length;Ne++)fe(Ee[Ne]/ae,Ce[Ne],De[Ne]);else{Be.multiDrawElementsInstancedWEBGL($,Ce,0,re,Ee,0,De,0,Ie);let Ne=0;for(let qe=0;qe<Ie;qe++)Ne+=Ce[qe];for(let qe=0;qe<De.length;qe++)b.update(Ne,$,De[qe])}}this.setMode=ee,this.setIndex=xe,this.render=le,this.renderInstances=fe,this.renderMultiDraw=ve,this.renderMultiDrawInstances=Se}function WebGLInfo(H){const _={geometries:0,textures:0},b={frame:0,calls:0,triangles:0,points:0,lines:0};function $(re,ae,xe){switch(b.calls++,ae){case H.TRIANGLES:b.triangles+=xe*(re/3);break;case H.LINES:b.lines+=xe*(re/2);break;case H.LINE_STRIP:b.lines+=xe*(re-1);break;case H.LINE_LOOP:b.lines+=xe*re;break;case H.POINTS:b.points+=xe*re;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",ae);break}}function ee(){b.calls=0,b.triangles=0,b.points=0,b.lines=0}return{memory:_,render:b,programs:null,autoReset:!0,reset:ee,update:$}}class DataArrayTexture extends Texture$1{constructor(_=null,b=1,$=1,ee=1){super(null),this.isDataArrayTexture=!0,this.image={data:_,width:b,height:$,depth:ee},this.magFilter=NearestFilter$1,this.minFilter=NearestFilter$1,this.wrapR=ClampToEdgeWrapping$1,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(_){this.layerUpdates.add(_)}clearLayerUpdates(){this.layerUpdates.clear()}}function WebGLMorphtargets(H,_,b){const $=new WeakMap,ee=new Vector4$1;function re(ae,xe,le){const fe=ae.morphTargetInfluences,ve=xe.morphAttributes.position||xe.morphAttributes.normal||xe.morphAttributes.color,Se=ve!==void 0?ve.length:0;let Ee=$.get(xe);if(Ee===void 0||Ee.count!==Se){let mt=function(){ot.dispose(),$.delete(xe),xe.removeEventListener("dispose",mt)};Ee!==void 0&&Ee.texture.dispose();const Ce=xe.morphAttributes.position!==void 0,Ie=xe.morphAttributes.normal!==void 0,De=xe.morphAttributes.color!==void 0,Be=xe.morphAttributes.position||[],Ne=xe.morphAttributes.normal||[],qe=xe.morphAttributes.color||[];let Xe=0;Ce===!0&&(Xe=1),Ie===!0&&(Xe=2),De===!0&&(Xe=3);let Ye=xe.attributes.position.count*Xe,Qe=1;Ye>_.maxTextureSize&&(Qe=Math.ceil(Ye/_.maxTextureSize),Ye=_.maxTextureSize);const rt=new Float32Array(Ye*Qe*4*Se),ot=new DataArrayTexture(rt,Ye,Qe,Se);ot.type=FloatType$1,ot.needsUpdate=!0;const ct=Xe*4;for(let _t=0;_t<Se;_t++){const Lt=Be[_t],Vt=Ne[_t],Gt=qe[_t],$t=Ye*Qe*4*_t;for(let Qt=0;Qt<Lt.count;Qt++){const vt=Qt*ct;Ce===!0&&(ee.fromBufferAttribute(Lt,Qt),rt[$t+vt+0]=ee.x,rt[$t+vt+1]=ee.y,rt[$t+vt+2]=ee.z,rt[$t+vt+3]=0),Ie===!0&&(ee.fromBufferAttribute(Vt,Qt),rt[$t+vt+4]=ee.x,rt[$t+vt+5]=ee.y,rt[$t+vt+6]=ee.z,rt[$t+vt+7]=0),De===!0&&(ee.fromBufferAttribute(Gt,Qt),rt[$t+vt+8]=ee.x,rt[$t+vt+9]=ee.y,rt[$t+vt+10]=ee.z,rt[$t+vt+11]=Gt.itemSize===4?ee.w:1)}}Ee={count:Se,texture:ot,size:new Vector2$1(Ye,Qe)},$.set(xe,Ee),xe.addEventListener("dispose",mt)}if(ae.isInstancedMesh===!0&&ae.morphTexture!==null)le.getUniforms().setValue(H,"morphTexture",ae.morphTexture,b);else{let Ce=0;for(let De=0;De<fe.length;De++)Ce+=fe[De];const Ie=xe.morphTargetsRelative?1:1-Ce;le.getUniforms().setValue(H,"morphTargetBaseInfluence",Ie),le.getUniforms().setValue(H,"morphTargetInfluences",fe)}le.getUniforms().setValue(H,"morphTargetsTexture",Ee.texture,b),le.getUniforms().setValue(H,"morphTargetsTextureSize",Ee.size)}return{update:re}}function WebGLObjects(H,_,b,$){let ee=new WeakMap;function re(le){const fe=$.render.frame,ve=le.geometry,Se=_.get(le,ve);if(ee.get(Se)!==fe&&(_.update(Se),ee.set(Se,fe)),le.isInstancedMesh&&(le.hasEventListener("dispose",xe)===!1&&le.addEventListener("dispose",xe),ee.get(le)!==fe&&(b.update(le.instanceMatrix,H.ARRAY_BUFFER),le.instanceColor!==null&&b.update(le.instanceColor,H.ARRAY_BUFFER),ee.set(le,fe))),le.isSkinnedMesh){const Ee=le.skeleton;ee.get(Ee)!==fe&&(Ee.update(),ee.set(Ee,fe))}return Se}function ae(){ee=new WeakMap}function xe(le){const fe=le.target;fe.removeEventListener("dispose",xe),b.remove(fe.instanceMatrix),fe.instanceColor!==null&&b.remove(fe.instanceColor)}return{update:re,dispose:ae}}class Data3DTexture extends Texture$1{constructor(_=null,b=1,$=1,ee=1){super(null),this.isData3DTexture=!0,this.image={data:_,width:b,height:$,depth:ee},this.magFilter=NearestFilter$1,this.minFilter=NearestFilter$1,this.wrapR=ClampToEdgeWrapping$1,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class DepthTexture extends Texture$1{constructor(_,b,$,ee,re,ae,xe,le,fe,ve=DepthFormat){if(ve!==DepthFormat&&ve!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");$===void 0&&ve===DepthFormat&&($=UnsignedIntType),$===void 0&&ve===DepthStencilFormat&&($=UnsignedInt248Type),super(null,ee,re,ae,xe,le,ve,$,fe),this.isDepthTexture=!0,this.image={width:_,height:b},this.magFilter=xe!==void 0?xe:NearestFilter$1,this.minFilter=le!==void 0?le:NearestFilter$1,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(_){return super.copy(_),this.compareFunction=_.compareFunction,this}toJSON(_){const b=super.toJSON(_);return this.compareFunction!==null&&(b.compareFunction=this.compareFunction),b}}const emptyTexture=new Texture$1,emptyShadowTexture=new DepthTexture(1,1),emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten(H,_,b){const $=H[0];if($<=0||$>0)return H;const ee=_*b;let re=arrayCacheF32[ee];if(re===void 0&&(re=new Float32Array(ee),arrayCacheF32[ee]=re),_!==0){$.toArray(re,0);for(let ae=1,xe=0;ae!==_;++ae)xe+=b,H[ae].toArray(re,xe)}return re}function arraysEqual(H,_){if(H.length!==_.length)return!1;for(let b=0,$=H.length;b<$;b++)if(H[b]!==_[b])return!1;return!0}function copyArray(H,_){for(let b=0,$=_.length;b<$;b++)H[b]=_[b]}function allocTexUnits(H,_){let b=arrayCacheI32[_];b===void 0&&(b=new Int32Array(_),arrayCacheI32[_]=b);for(let $=0;$!==_;++$)b[$]=H.allocateTextureUnit();return b}function setValueV1f(H,_){const b=this.cache;b[0]!==_&&(H.uniform1f(this.addr,_),b[0]=_)}function setValueV2f(H,_){const b=this.cache;if(_.x!==void 0)(b[0]!==_.x||b[1]!==_.y)&&(H.uniform2f(this.addr,_.x,_.y),b[0]=_.x,b[1]=_.y);else{if(arraysEqual(b,_))return;H.uniform2fv(this.addr,_),copyArray(b,_)}}function setValueV3f(H,_){const b=this.cache;if(_.x!==void 0)(b[0]!==_.x||b[1]!==_.y||b[2]!==_.z)&&(H.uniform3f(this.addr,_.x,_.y,_.z),b[0]=_.x,b[1]=_.y,b[2]=_.z);else if(_.r!==void 0)(b[0]!==_.r||b[1]!==_.g||b[2]!==_.b)&&(H.uniform3f(this.addr,_.r,_.g,_.b),b[0]=_.r,b[1]=_.g,b[2]=_.b);else{if(arraysEqual(b,_))return;H.uniform3fv(this.addr,_),copyArray(b,_)}}function setValueV4f(H,_){const b=this.cache;if(_.x!==void 0)(b[0]!==_.x||b[1]!==_.y||b[2]!==_.z||b[3]!==_.w)&&(H.uniform4f(this.addr,_.x,_.y,_.z,_.w),b[0]=_.x,b[1]=_.y,b[2]=_.z,b[3]=_.w);else{if(arraysEqual(b,_))return;H.uniform4fv(this.addr,_),copyArray(b,_)}}function setValueM2(H,_){const b=this.cache,$=_.elements;if($===void 0){if(arraysEqual(b,_))return;H.uniformMatrix2fv(this.addr,!1,_),copyArray(b,_)}else{if(arraysEqual(b,$))return;mat2array.set($),H.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(b,$)}}function setValueM3(H,_){const b=this.cache,$=_.elements;if($===void 0){if(arraysEqual(b,_))return;H.uniformMatrix3fv(this.addr,!1,_),copyArray(b,_)}else{if(arraysEqual(b,$))return;mat3array.set($),H.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(b,$)}}function setValueM4(H,_){const b=this.cache,$=_.elements;if($===void 0){if(arraysEqual(b,_))return;H.uniformMatrix4fv(this.addr,!1,_),copyArray(b,_)}else{if(arraysEqual(b,$))return;mat4array.set($),H.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(b,$)}}function setValueV1i(H,_){const b=this.cache;b[0]!==_&&(H.uniform1i(this.addr,_),b[0]=_)}function setValueV2i(H,_){const b=this.cache;if(_.x!==void 0)(b[0]!==_.x||b[1]!==_.y)&&(H.uniform2i(this.addr,_.x,_.y),b[0]=_.x,b[1]=_.y);else{if(arraysEqual(b,_))return;H.uniform2iv(this.addr,_),copyArray(b,_)}}function setValueV3i(H,_){const b=this.cache;if(_.x!==void 0)(b[0]!==_.x||b[1]!==_.y||b[2]!==_.z)&&(H.uniform3i(this.addr,_.x,_.y,_.z),b[0]=_.x,b[1]=_.y,b[2]=_.z);else{if(arraysEqual(b,_))return;H.uniform3iv(this.addr,_),copyArray(b,_)}}function setValueV4i(H,_){const b=this.cache;if(_.x!==void 0)(b[0]!==_.x||b[1]!==_.y||b[2]!==_.z||b[3]!==_.w)&&(H.uniform4i(this.addr,_.x,_.y,_.z,_.w),b[0]=_.x,b[1]=_.y,b[2]=_.z,b[3]=_.w);else{if(arraysEqual(b,_))return;H.uniform4iv(this.addr,_),copyArray(b,_)}}function setValueV1ui(H,_){const b=this.cache;b[0]!==_&&(H.uniform1ui(this.addr,_),b[0]=_)}function setValueV2ui(H,_){const b=this.cache;if(_.x!==void 0)(b[0]!==_.x||b[1]!==_.y)&&(H.uniform2ui(this.addr,_.x,_.y),b[0]=_.x,b[1]=_.y);else{if(arraysEqual(b,_))return;H.uniform2uiv(this.addr,_),copyArray(b,_)}}function setValueV3ui(H,_){const b=this.cache;if(_.x!==void 0)(b[0]!==_.x||b[1]!==_.y||b[2]!==_.z)&&(H.uniform3ui(this.addr,_.x,_.y,_.z),b[0]=_.x,b[1]=_.y,b[2]=_.z);else{if(arraysEqual(b,_))return;H.uniform3uiv(this.addr,_),copyArray(b,_)}}function setValueV4ui(H,_){const b=this.cache;if(_.x!==void 0)(b[0]!==_.x||b[1]!==_.y||b[2]!==_.z||b[3]!==_.w)&&(H.uniform4ui(this.addr,_.x,_.y,_.z,_.w),b[0]=_.x,b[1]=_.y,b[2]=_.z,b[3]=_.w);else{if(arraysEqual(b,_))return;H.uniform4uiv(this.addr,_),copyArray(b,_)}}function setValueT1(H,_,b){const $=this.cache,ee=b.allocateTextureUnit();$[0]!==ee&&(H.uniform1i(this.addr,ee),$[0]=ee);let re;this.type===H.SAMPLER_2D_SHADOW?(emptyShadowTexture.compareFunction=LessEqualCompare,re=emptyShadowTexture):re=emptyTexture,b.setTexture2D(_||re,ee)}function setValueT3D1(H,_,b){const $=this.cache,ee=b.allocateTextureUnit();$[0]!==ee&&(H.uniform1i(this.addr,ee),$[0]=ee),b.setTexture3D(_||empty3dTexture,ee)}function setValueT6(H,_,b){const $=this.cache,ee=b.allocateTextureUnit();$[0]!==ee&&(H.uniform1i(this.addr,ee),$[0]=ee),b.setTextureCube(_||emptyCubeTexture,ee)}function setValueT2DArray1(H,_,b){const $=this.cache,ee=b.allocateTextureUnit();$[0]!==ee&&(H.uniform1i(this.addr,ee),$[0]=ee),b.setTexture2DArray(_||emptyArrayTexture,ee)}function getSingularSetter(H){switch(H){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(H,_){H.uniform1fv(this.addr,_)}function setValueV2fArray(H,_){const b=flatten(_,this.size,2);H.uniform2fv(this.addr,b)}function setValueV3fArray(H,_){const b=flatten(_,this.size,3);H.uniform3fv(this.addr,b)}function setValueV4fArray(H,_){const b=flatten(_,this.size,4);H.uniform4fv(this.addr,b)}function setValueM2Array(H,_){const b=flatten(_,this.size,4);H.uniformMatrix2fv(this.addr,!1,b)}function setValueM3Array(H,_){const b=flatten(_,this.size,9);H.uniformMatrix3fv(this.addr,!1,b)}function setValueM4Array(H,_){const b=flatten(_,this.size,16);H.uniformMatrix4fv(this.addr,!1,b)}function setValueV1iArray(H,_){H.uniform1iv(this.addr,_)}function setValueV2iArray(H,_){H.uniform2iv(this.addr,_)}function setValueV3iArray(H,_){H.uniform3iv(this.addr,_)}function setValueV4iArray(H,_){H.uniform4iv(this.addr,_)}function setValueV1uiArray(H,_){H.uniform1uiv(this.addr,_)}function setValueV2uiArray(H,_){H.uniform2uiv(this.addr,_)}function setValueV3uiArray(H,_){H.uniform3uiv(this.addr,_)}function setValueV4uiArray(H,_){H.uniform4uiv(this.addr,_)}function setValueT1Array(H,_,b){const $=this.cache,ee=_.length,re=allocTexUnits(b,ee);arraysEqual($,re)||(H.uniform1iv(this.addr,re),copyArray($,re));for(let ae=0;ae!==ee;++ae)b.setTexture2D(_[ae]||emptyTexture,re[ae])}function setValueT3DArray(H,_,b){const $=this.cache,ee=_.length,re=allocTexUnits(b,ee);arraysEqual($,re)||(H.uniform1iv(this.addr,re),copyArray($,re));for(let ae=0;ae!==ee;++ae)b.setTexture3D(_[ae]||empty3dTexture,re[ae])}function setValueT6Array(H,_,b){const $=this.cache,ee=_.length,re=allocTexUnits(b,ee);arraysEqual($,re)||(H.uniform1iv(this.addr,re),copyArray($,re));for(let ae=0;ae!==ee;++ae)b.setTextureCube(_[ae]||emptyCubeTexture,re[ae])}function setValueT2DArrayArray(H,_,b){const $=this.cache,ee=_.length,re=allocTexUnits(b,ee);arraysEqual($,re)||(H.uniform1iv(this.addr,re),copyArray($,re));for(let ae=0;ae!==ee;++ae)b.setTexture2DArray(_[ae]||emptyArrayTexture,re[ae])}function getPureArraySetter(H){switch(H){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(_,b,$){this.id=_,this.addr=$,this.cache=[],this.type=b.type,this.setValue=getSingularSetter(b.type)}}class PureArrayUniform{constructor(_,b,$){this.id=_,this.addr=$,this.cache=[],this.type=b.type,this.size=b.size,this.setValue=getPureArraySetter(b.type)}}class StructuredUniform{constructor(_){this.id=_,this.seq=[],this.map={}}setValue(_,b,$){const ee=this.seq;for(let re=0,ae=ee.length;re!==ae;++re){const xe=ee[re];xe.setValue(_,b[xe.id],$)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(H,_){H.seq.push(_),H.map[_.id]=_}function parseUniform(H,_,b){const $=H.name,ee=$.length;for(RePathPart.lastIndex=0;;){const re=RePathPart.exec($),ae=RePathPart.lastIndex;let xe=re[1];const le=re[2]==="]",fe=re[3];if(le&&(xe=xe|0),fe===void 0||fe==="["&&ae+2===ee){addUniform(b,fe===void 0?new SingleUniform(xe,H,_):new PureArrayUniform(xe,H,_));break}else{let Se=b.map[xe];Se===void 0&&(Se=new StructuredUniform(xe),addUniform(b,Se)),b=Se}}}class WebGLUniforms{constructor(_,b){this.seq=[],this.map={};const $=_.getProgramParameter(b,_.ACTIVE_UNIFORMS);for(let ee=0;ee<$;++ee){const re=_.getActiveUniform(b,ee),ae=_.getUniformLocation(b,re.name);parseUniform(re,ae,this)}}setValue(_,b,$,ee){const re=this.map[b];re!==void 0&&re.setValue(_,$,ee)}setOptional(_,b,$){const ee=b[$];ee!==void 0&&this.setValue(_,$,ee)}static upload(_,b,$,ee){for(let re=0,ae=b.length;re!==ae;++re){const xe=b[re],le=$[xe.id];le.needsUpdate!==!1&&xe.setValue(_,le.value,ee)}}static seqWithValue(_,b){const $=[];for(let ee=0,re=_.length;ee!==re;++ee){const ae=_[ee];ae.id in b&&$.push(ae)}return $}}function WebGLShader(H,_,b){const $=H.createShader(_);return H.shaderSource($,b),H.compileShader($),$}const COMPLETION_STATUS_KHR=37297;let programIdCount=0;function handleSource(H,_){const b=H.split(`
`),$=[],ee=Math.max(_-6,0),re=Math.min(_+6,b.length);for(let ae=ee;ae<re;ae++){const xe=ae+1;$.push(`${xe===_?">":" "} ${xe}: ${b[ae]}`)}return $.join(`
`)}function getEncodingComponents(H){const _=ColorManagement$1.getPrimaries(ColorManagement$1.workingColorSpace),b=ColorManagement$1.getPrimaries(H);let $;switch(_===b?$="":_===P3Primaries$1&&b===Rec709Primaries$1?$="LinearDisplayP3ToLinearSRGB":_===Rec709Primaries$1&&b===P3Primaries$1&&($="LinearSRGBToLinearDisplayP3"),H){case LinearSRGBColorSpace$1:case LinearDisplayP3ColorSpace$1:return[$,"LinearTransferOETF"];case SRGBColorSpace$1:case DisplayP3ColorSpace$1:return[$,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",H),[$,"LinearTransferOETF"]}}function getShaderErrors(H,_,b){const $=H.getShaderParameter(_,H.COMPILE_STATUS),ee=H.getShaderInfoLog(_).trim();if($&&ee==="")return"";const re=/ERROR: 0:(\d+)/.exec(ee);if(re){const ae=parseInt(re[1]);return b.toUpperCase()+`

`+ee+`

`+handleSource(H.getShaderSource(_),ae)}else return ee}function getTexelEncodingFunction(H,_){const b=getEncodingComponents(_);return`vec4 ${H}( vec4 value ) { return ${b[0]}( ${b[1]}( value ) ); }`}function getToneMappingFunction(H,_){let b;switch(_){case LinearToneMapping:b="Linear";break;case ReinhardToneMapping:b="Reinhard";break;case CineonToneMapping:b="Cineon";break;case ACESFilmicToneMapping:b="ACESFilmic";break;case AgXToneMapping:b="AgX";break;case NeutralToneMapping:b="Neutral";break;case CustomToneMapping:b="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",_),b="Linear"}return"vec3 "+H+"( vec3 color ) { return "+b+"ToneMapping( color ); }"}const _v0=new Vector3$1;function getLuminanceFunction(){ColorManagement$1.getLuminanceCoefficients(_v0);const H=_v0.x.toFixed(4),_=_v0.y.toFixed(4),b=_v0.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${H}, ${_}, ${b} );`,"	return dot( weights, rgb );","}"].join(`
`)}function generateVertexExtensions(H){return[H.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",H.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(filterEmptyLine).join(`
`)}function generateDefines(H){const _=[];for(const b in H){const $=H[b];$!==!1&&_.push("#define "+b+" "+$)}return _.join(`
`)}function fetchAttributeLocations(H,_){const b={},$=H.getProgramParameter(_,H.ACTIVE_ATTRIBUTES);for(let ee=0;ee<$;ee++){const re=H.getActiveAttrib(_,ee),ae=re.name;let xe=1;re.type===H.FLOAT_MAT2&&(xe=2),re.type===H.FLOAT_MAT3&&(xe=3),re.type===H.FLOAT_MAT4&&(xe=4),b[ae]={type:re.type,location:H.getAttribLocation(_,ae),locationSize:xe}}return b}function filterEmptyLine(H){return H!==""}function replaceLightNums(H,_){const b=_.numSpotLightShadows+_.numSpotLightMaps-_.numSpotLightShadowsWithMaps;return H.replace(/NUM_DIR_LIGHTS/g,_.numDirLights).replace(/NUM_SPOT_LIGHTS/g,_.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,_.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,b).replace(/NUM_RECT_AREA_LIGHTS/g,_.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,_.numPointLights).replace(/NUM_HEMI_LIGHTS/g,_.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,_.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,_.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,_.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,_.numPointLightShadows)}function replaceClippingPlaneNums(H,_){return H.replace(/NUM_CLIPPING_PLANES/g,_.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,_.numClippingPlanes-_.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(H){return H.replace(includePattern,includeReplacer)}const shaderChunkMap=new Map;function includeReplacer(H,_){let b=ShaderChunk[_];if(b===void 0){const $=shaderChunkMap.get(_);if($!==void 0)b=ShaderChunk[$],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',_,$);else throw new Error("Can not resolve #include <"+_+">")}return resolveIncludes(b)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(H){return H.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(H,_,b,$){let ee="";for(let re=parseInt(_);re<parseInt(b);re++)ee+=$.replace(/\[\s*i\s*\]/g,"[ "+re+" ]").replace(/UNROLLED_LOOP_INDEX/g,re);return ee}function generatePrecision(H){let _=`precision ${H.precision} float;
	precision ${H.precision} int;
	precision ${H.precision} sampler2D;
	precision ${H.precision} samplerCube;
	precision ${H.precision} sampler3D;
	precision ${H.precision} sampler2DArray;
	precision ${H.precision} sampler2DShadow;
	precision ${H.precision} samplerCubeShadow;
	precision ${H.precision} sampler2DArrayShadow;
	precision ${H.precision} isampler2D;
	precision ${H.precision} isampler3D;
	precision ${H.precision} isamplerCube;
	precision ${H.precision} isampler2DArray;
	precision ${H.precision} usampler2D;
	precision ${H.precision} usampler3D;
	precision ${H.precision} usamplerCube;
	precision ${H.precision} usampler2DArray;
	`;return H.precision==="highp"?_+=`
#define HIGH_PRECISION`:H.precision==="mediump"?_+=`
#define MEDIUM_PRECISION`:H.precision==="lowp"&&(_+=`
#define LOW_PRECISION`),_}function generateShadowMapTypeDefine(H){let _="SHADOWMAP_TYPE_BASIC";return H.shadowMapType===PCFShadowMap?_="SHADOWMAP_TYPE_PCF":H.shadowMapType===PCFSoftShadowMap?_="SHADOWMAP_TYPE_PCF_SOFT":H.shadowMapType===VSMShadowMap&&(_="SHADOWMAP_TYPE_VSM"),_}function generateEnvMapTypeDefine(H){let _="ENVMAP_TYPE_CUBE";if(H.envMap)switch(H.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:_="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:_="ENVMAP_TYPE_CUBE_UV";break}return _}function generateEnvMapModeDefine(H){let _="ENVMAP_MODE_REFLECTION";if(H.envMap)switch(H.envMapMode){case CubeRefractionMapping:_="ENVMAP_MODE_REFRACTION";break}return _}function generateEnvMapBlendingDefine(H){let _="ENVMAP_BLENDING_NONE";if(H.envMap)switch(H.combine){case MultiplyOperation$1:_="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:_="ENVMAP_BLENDING_MIX";break;case AddOperation:_="ENVMAP_BLENDING_ADD";break}return _}function generateCubeUVSize(H){const _=H.envMapCubeUVHeight;if(_===null)return null;const b=Math.log2(_)-2,$=1/_;return{texelWidth:1/(3*Math.max(Math.pow(2,b),7*16)),texelHeight:$,maxMip:b}}function WebGLProgram(H,_,b,$){const ee=H.getContext(),re=b.defines;let ae=b.vertexShader,xe=b.fragmentShader;const le=generateShadowMapTypeDefine(b),fe=generateEnvMapTypeDefine(b),ve=generateEnvMapModeDefine(b),Se=generateEnvMapBlendingDefine(b),Ee=generateCubeUVSize(b),Ce=generateVertexExtensions(b),Ie=generateDefines(re),De=ee.createProgram();let Be,Ne,qe=b.glslVersion?"#version "+b.glslVersion+`
`:"";b.isRawShaderMaterial?(Be=["#define SHADER_TYPE "+b.shaderType,"#define SHADER_NAME "+b.shaderName,Ie].filter(filterEmptyLine).join(`
`),Be.length>0&&(Be+=`
`),Ne=["#define SHADER_TYPE "+b.shaderType,"#define SHADER_NAME "+b.shaderName,Ie].filter(filterEmptyLine).join(`
`),Ne.length>0&&(Ne+=`
`)):(Be=[generatePrecision(b),"#define SHADER_TYPE "+b.shaderType,"#define SHADER_NAME "+b.shaderName,Ie,b.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",b.batching?"#define USE_BATCHING":"",b.batchingColor?"#define USE_BATCHING_COLOR":"",b.instancing?"#define USE_INSTANCING":"",b.instancingColor?"#define USE_INSTANCING_COLOR":"",b.instancingMorph?"#define USE_INSTANCING_MORPH":"",b.useFog&&b.fog?"#define USE_FOG":"",b.useFog&&b.fogExp2?"#define FOG_EXP2":"",b.map?"#define USE_MAP":"",b.envMap?"#define USE_ENVMAP":"",b.envMap?"#define "+ve:"",b.lightMap?"#define USE_LIGHTMAP":"",b.aoMap?"#define USE_AOMAP":"",b.bumpMap?"#define USE_BUMPMAP":"",b.normalMap?"#define USE_NORMALMAP":"",b.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",b.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",b.displacementMap?"#define USE_DISPLACEMENTMAP":"",b.emissiveMap?"#define USE_EMISSIVEMAP":"",b.anisotropy?"#define USE_ANISOTROPY":"",b.anisotropyMap?"#define USE_ANISOTROPYMAP":"",b.clearcoatMap?"#define USE_CLEARCOATMAP":"",b.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",b.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",b.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",b.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",b.specularMap?"#define USE_SPECULARMAP":"",b.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",b.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",b.roughnessMap?"#define USE_ROUGHNESSMAP":"",b.metalnessMap?"#define USE_METALNESSMAP":"",b.alphaMap?"#define USE_ALPHAMAP":"",b.alphaHash?"#define USE_ALPHAHASH":"",b.transmission?"#define USE_TRANSMISSION":"",b.transmissionMap?"#define USE_TRANSMISSIONMAP":"",b.thicknessMap?"#define USE_THICKNESSMAP":"",b.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",b.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",b.mapUv?"#define MAP_UV "+b.mapUv:"",b.alphaMapUv?"#define ALPHAMAP_UV "+b.alphaMapUv:"",b.lightMapUv?"#define LIGHTMAP_UV "+b.lightMapUv:"",b.aoMapUv?"#define AOMAP_UV "+b.aoMapUv:"",b.emissiveMapUv?"#define EMISSIVEMAP_UV "+b.emissiveMapUv:"",b.bumpMapUv?"#define BUMPMAP_UV "+b.bumpMapUv:"",b.normalMapUv?"#define NORMALMAP_UV "+b.normalMapUv:"",b.displacementMapUv?"#define DISPLACEMENTMAP_UV "+b.displacementMapUv:"",b.metalnessMapUv?"#define METALNESSMAP_UV "+b.metalnessMapUv:"",b.roughnessMapUv?"#define ROUGHNESSMAP_UV "+b.roughnessMapUv:"",b.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+b.anisotropyMapUv:"",b.clearcoatMapUv?"#define CLEARCOATMAP_UV "+b.clearcoatMapUv:"",b.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+b.clearcoatNormalMapUv:"",b.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+b.clearcoatRoughnessMapUv:"",b.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+b.iridescenceMapUv:"",b.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+b.iridescenceThicknessMapUv:"",b.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+b.sheenColorMapUv:"",b.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+b.sheenRoughnessMapUv:"",b.specularMapUv?"#define SPECULARMAP_UV "+b.specularMapUv:"",b.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+b.specularColorMapUv:"",b.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+b.specularIntensityMapUv:"",b.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+b.transmissionMapUv:"",b.thicknessMapUv?"#define THICKNESSMAP_UV "+b.thicknessMapUv:"",b.vertexTangents&&b.flatShading===!1?"#define USE_TANGENT":"",b.vertexColors?"#define USE_COLOR":"",b.vertexAlphas?"#define USE_COLOR_ALPHA":"",b.vertexUv1s?"#define USE_UV1":"",b.vertexUv2s?"#define USE_UV2":"",b.vertexUv3s?"#define USE_UV3":"",b.pointsUvs?"#define USE_POINTS_UV":"",b.flatShading?"#define FLAT_SHADED":"",b.skinning?"#define USE_SKINNING":"",b.morphTargets?"#define USE_MORPHTARGETS":"",b.morphNormals&&b.flatShading===!1?"#define USE_MORPHNORMALS":"",b.morphColors?"#define USE_MORPHCOLORS":"",b.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+b.morphTextureStride:"",b.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+b.morphTargetsCount:"",b.doubleSided?"#define DOUBLE_SIDED":"",b.flipSided?"#define FLIP_SIDED":"",b.shadowMapEnabled?"#define USE_SHADOWMAP":"",b.shadowMapEnabled?"#define "+le:"",b.sizeAttenuation?"#define USE_SIZEATTENUATION":"",b.numLightProbes>0?"#define USE_LIGHT_PROBES":"",b.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),Ne=[generatePrecision(b),"#define SHADER_TYPE "+b.shaderType,"#define SHADER_NAME "+b.shaderName,Ie,b.useFog&&b.fog?"#define USE_FOG":"",b.useFog&&b.fogExp2?"#define FOG_EXP2":"",b.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",b.map?"#define USE_MAP":"",b.matcap?"#define USE_MATCAP":"",b.envMap?"#define USE_ENVMAP":"",b.envMap?"#define "+fe:"",b.envMap?"#define "+ve:"",b.envMap?"#define "+Se:"",Ee?"#define CUBEUV_TEXEL_WIDTH "+Ee.texelWidth:"",Ee?"#define CUBEUV_TEXEL_HEIGHT "+Ee.texelHeight:"",Ee?"#define CUBEUV_MAX_MIP "+Ee.maxMip+".0":"",b.lightMap?"#define USE_LIGHTMAP":"",b.aoMap?"#define USE_AOMAP":"",b.bumpMap?"#define USE_BUMPMAP":"",b.normalMap?"#define USE_NORMALMAP":"",b.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",b.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",b.emissiveMap?"#define USE_EMISSIVEMAP":"",b.anisotropy?"#define USE_ANISOTROPY":"",b.anisotropyMap?"#define USE_ANISOTROPYMAP":"",b.clearcoat?"#define USE_CLEARCOAT":"",b.clearcoatMap?"#define USE_CLEARCOATMAP":"",b.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",b.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",b.dispersion?"#define USE_DISPERSION":"",b.iridescence?"#define USE_IRIDESCENCE":"",b.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",b.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",b.specularMap?"#define USE_SPECULARMAP":"",b.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",b.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",b.roughnessMap?"#define USE_ROUGHNESSMAP":"",b.metalnessMap?"#define USE_METALNESSMAP":"",b.alphaMap?"#define USE_ALPHAMAP":"",b.alphaTest?"#define USE_ALPHATEST":"",b.alphaHash?"#define USE_ALPHAHASH":"",b.sheen?"#define USE_SHEEN":"",b.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",b.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",b.transmission?"#define USE_TRANSMISSION":"",b.transmissionMap?"#define USE_TRANSMISSIONMAP":"",b.thicknessMap?"#define USE_THICKNESSMAP":"",b.vertexTangents&&b.flatShading===!1?"#define USE_TANGENT":"",b.vertexColors||b.instancingColor||b.batchingColor?"#define USE_COLOR":"",b.vertexAlphas?"#define USE_COLOR_ALPHA":"",b.vertexUv1s?"#define USE_UV1":"",b.vertexUv2s?"#define USE_UV2":"",b.vertexUv3s?"#define USE_UV3":"",b.pointsUvs?"#define USE_POINTS_UV":"",b.gradientMap?"#define USE_GRADIENTMAP":"",b.flatShading?"#define FLAT_SHADED":"",b.doubleSided?"#define DOUBLE_SIDED":"",b.flipSided?"#define FLIP_SIDED":"",b.shadowMapEnabled?"#define USE_SHADOWMAP":"",b.shadowMapEnabled?"#define "+le:"",b.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",b.numLightProbes>0?"#define USE_LIGHT_PROBES":"",b.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",b.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",b.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",b.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",b.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",b.toneMapping):"",b.dithering?"#define DITHERING":"",b.opaque?"#define OPAQUE":"",ShaderChunk.colorspace_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",b.outputColorSpace),getLuminanceFunction(),b.useDepthPacking?"#define DEPTH_PACKING "+b.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),ae=resolveIncludes(ae),ae=replaceLightNums(ae,b),ae=replaceClippingPlaneNums(ae,b),xe=resolveIncludes(xe),xe=replaceLightNums(xe,b),xe=replaceClippingPlaneNums(xe,b),ae=unrollLoops(ae),xe=unrollLoops(xe),b.isRawShaderMaterial!==!0&&(qe=`#version 300 es
`,Be=[Ce,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+Be,Ne=["#define varying in",b.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",b.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+Ne);const Xe=qe+Be+ae,Ye=qe+Ne+xe,Qe=WebGLShader(ee,ee.VERTEX_SHADER,Xe),rt=WebGLShader(ee,ee.FRAGMENT_SHADER,Ye);ee.attachShader(De,Qe),ee.attachShader(De,rt),b.index0AttributeName!==void 0?ee.bindAttribLocation(De,0,b.index0AttributeName):b.morphTargets===!0&&ee.bindAttribLocation(De,0,"position"),ee.linkProgram(De);function ot(Lt){if(H.debug.checkShaderErrors){const Vt=ee.getProgramInfoLog(De).trim(),Gt=ee.getShaderInfoLog(Qe).trim(),$t=ee.getShaderInfoLog(rt).trim();let Qt=!0,vt=!0;if(ee.getProgramParameter(De,ee.LINK_STATUS)===!1)if(Qt=!1,typeof H.debug.onShaderError=="function")H.debug.onShaderError(ee,De,Qe,rt);else{const It=getShaderErrors(ee,Qe,"vertex"),gt=getShaderErrors(ee,rt,"fragment");console.error("THREE.WebGLProgram: Shader Error "+ee.getError()+" - VALIDATE_STATUS "+ee.getProgramParameter(De,ee.VALIDATE_STATUS)+`

Material Name: `+Lt.name+`
Material Type: `+Lt.type+`

Program Info Log: `+Vt+`
`+It+`
`+gt)}else Vt!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Vt):(Gt===""||$t==="")&&(vt=!1);vt&&(Lt.diagnostics={runnable:Qt,programLog:Vt,vertexShader:{log:Gt,prefix:Be},fragmentShader:{log:$t,prefix:Ne}})}ee.deleteShader(Qe),ee.deleteShader(rt),ct=new WebGLUniforms(ee,De),mt=fetchAttributeLocations(ee,De)}let ct;this.getUniforms=function(){return ct===void 0&&ot(this),ct};let mt;this.getAttributes=function(){return mt===void 0&&ot(this),mt};let _t=b.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return _t===!1&&(_t=ee.getProgramParameter(De,COMPLETION_STATUS_KHR)),_t},this.destroy=function(){$.releaseStatesOfProgram(this),ee.deleteProgram(De),this.program=void 0},this.type=b.shaderType,this.name=b.shaderName,this.id=programIdCount++,this.cacheKey=_,this.usedTimes=1,this.program=De,this.vertexShader=Qe,this.fragmentShader=rt,this}let _id=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(_){const b=_.vertexShader,$=_.fragmentShader,ee=this._getShaderStage(b),re=this._getShaderStage($),ae=this._getShaderCacheForMaterial(_);return ae.has(ee)===!1&&(ae.add(ee),ee.usedTimes++),ae.has(re)===!1&&(ae.add(re),re.usedTimes++),this}remove(_){const b=this.materialCache.get(_);for(const $ of b)$.usedTimes--,$.usedTimes===0&&this.shaderCache.delete($.code);return this.materialCache.delete(_),this}getVertexShaderID(_){return this._getShaderStage(_.vertexShader).id}getFragmentShaderID(_){return this._getShaderStage(_.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(_){const b=this.materialCache;let $=b.get(_);return $===void 0&&($=new Set,b.set(_,$)),$}_getShaderStage(_){const b=this.shaderCache;let $=b.get(_);return $===void 0&&($=new WebGLShaderStage(_),b.set(_,$)),$}}class WebGLShaderStage{constructor(_){this.id=_id++,this.code=_,this.usedTimes=0}}function WebGLPrograms(H,_,b,$,ee,re,ae){const xe=new Layers$1,le=new WebGLShaderCache,fe=new Set,ve=[],Se=ee.logarithmicDepthBuffer,Ee=ee.vertexTextures;let Ce=ee.precision;const Ie={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function De(mt){return fe.add(mt),mt===0?"uv":`uv${mt}`}function Be(mt,_t,Lt,Vt,Gt){const $t=Vt.fog,Qt=Gt.geometry,vt=mt.isMeshStandardMaterial?Vt.environment:null,It=(mt.isMeshStandardMaterial?b:_).get(mt.envMap||vt),gt=It&&It.mapping===CubeUVReflectionMapping?It.image.height:null,Tt=Ie[mt.type];mt.precision!==null&&(Ce=ee.getMaxPrecision(mt.precision),Ce!==mt.precision&&console.warn("THREE.WebGLProgram.getParameters:",mt.precision,"not supported, using",Ce,"instead."));const Ct=Qt.morphAttributes.position||Qt.morphAttributes.normal||Qt.morphAttributes.color,Ft=Ct!==void 0?Ct.length:0;let sn=0;Qt.morphAttributes.position!==void 0&&(sn=1),Qt.morphAttributes.normal!==void 0&&(sn=2),Qt.morphAttributes.color!==void 0&&(sn=3);let cn,en,yn,Pn;if(Tt){const bi=ShaderLib[Tt];cn=bi.vertexShader,en=bi.fragmentShader}else cn=mt.vertexShader,en=mt.fragmentShader,le.update(mt),yn=le.getVertexShaderID(mt),Pn=le.getFragmentShaderID(mt);const tr=H.getRenderTarget(),nr=Gt.isInstancedMesh===!0,Fr=Gt.isBatchedMesh===!0,Ur=!!mt.map,Kr=!!mt.matcap,on=!!It,qr=!!mt.aoMap,rr=!!mt.lightMap,Qr=!!mt.bumpMap,Ir=!!mt.normalMap,ai=!!mt.displacementMap,Hr=!!mt.emissiveMap,Vr=!!mt.metalnessMap,xn=!!mt.roughnessMap,Ht=mt.anisotropy>0,In=mt.clearcoat>0,er=mt.dispersion>0,Hn=mt.iridescence>0,Zn=mt.sheen>0,Dr=mt.transmission>0,zn=Ht&&!!mt.anisotropyMap,Nr=In&&!!mt.clearcoatMap,vr=In&&!!mt.clearcoatNormalMap,Sr=In&&!!mt.clearcoatRoughnessMap,zr=Hn&&!!mt.iridescenceMap,gi=Hn&&!!mt.iridescenceThicknessMap,oi=Zn&&!!mt.sheenColorMap,Gr=Zn&&!!mt.sheenRoughnessMap,ri=!!mt.specularMap,yi=!!mt.specularColorMap,Ci=!!mt.specularIntensityMap,wn=Dr&&!!mt.transmissionMap,Pr=Dr&&!!mt.thicknessMap,xr=!!mt.gradientMap,gr=!!mt.alphaMap,Mr=mt.alphaTest>0,ci=!!mt.alphaHash,fi=!!mt.extensions;let Ui=NoToneMapping;mt.toneMapped&&(tr===null||tr.isXRRenderTarget===!0)&&(Ui=H.toneMapping);const Vi={shaderID:Tt,shaderType:mt.type,shaderName:mt.name,vertexShader:cn,fragmentShader:en,defines:mt.defines,customVertexShaderID:yn,customFragmentShaderID:Pn,isRawShaderMaterial:mt.isRawShaderMaterial===!0,glslVersion:mt.glslVersion,precision:Ce,batching:Fr,batchingColor:Fr&&Gt._colorsTexture!==null,instancing:nr,instancingColor:nr&&Gt.instanceColor!==null,instancingMorph:nr&&Gt.morphTexture!==null,supportsVertexTextures:Ee,outputColorSpace:tr===null?H.outputColorSpace:tr.isXRRenderTarget===!0?tr.texture.colorSpace:LinearSRGBColorSpace$1,alphaToCoverage:!!mt.alphaToCoverage,map:Ur,matcap:Kr,envMap:on,envMapMode:on&&It.mapping,envMapCubeUVHeight:gt,aoMap:qr,lightMap:rr,bumpMap:Qr,normalMap:Ir,displacementMap:Ee&&ai,emissiveMap:Hr,normalMapObjectSpace:Ir&&mt.normalMapType===ObjectSpaceNormalMap,normalMapTangentSpace:Ir&&mt.normalMapType===TangentSpaceNormalMap$1,metalnessMap:Vr,roughnessMap:xn,anisotropy:Ht,anisotropyMap:zn,clearcoat:In,clearcoatMap:Nr,clearcoatNormalMap:vr,clearcoatRoughnessMap:Sr,dispersion:er,iridescence:Hn,iridescenceMap:zr,iridescenceThicknessMap:gi,sheen:Zn,sheenColorMap:oi,sheenRoughnessMap:Gr,specularMap:ri,specularColorMap:yi,specularIntensityMap:Ci,transmission:Dr,transmissionMap:wn,thicknessMap:Pr,gradientMap:xr,opaque:mt.transparent===!1&&mt.blending===NormalBlending$1&&mt.alphaToCoverage===!1,alphaMap:gr,alphaTest:Mr,alphaHash:ci,combine:mt.combine,mapUv:Ur&&De(mt.map.channel),aoMapUv:qr&&De(mt.aoMap.channel),lightMapUv:rr&&De(mt.lightMap.channel),bumpMapUv:Qr&&De(mt.bumpMap.channel),normalMapUv:Ir&&De(mt.normalMap.channel),displacementMapUv:ai&&De(mt.displacementMap.channel),emissiveMapUv:Hr&&De(mt.emissiveMap.channel),metalnessMapUv:Vr&&De(mt.metalnessMap.channel),roughnessMapUv:xn&&De(mt.roughnessMap.channel),anisotropyMapUv:zn&&De(mt.anisotropyMap.channel),clearcoatMapUv:Nr&&De(mt.clearcoatMap.channel),clearcoatNormalMapUv:vr&&De(mt.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Sr&&De(mt.clearcoatRoughnessMap.channel),iridescenceMapUv:zr&&De(mt.iridescenceMap.channel),iridescenceThicknessMapUv:gi&&De(mt.iridescenceThicknessMap.channel),sheenColorMapUv:oi&&De(mt.sheenColorMap.channel),sheenRoughnessMapUv:Gr&&De(mt.sheenRoughnessMap.channel),specularMapUv:ri&&De(mt.specularMap.channel),specularColorMapUv:yi&&De(mt.specularColorMap.channel),specularIntensityMapUv:Ci&&De(mt.specularIntensityMap.channel),transmissionMapUv:wn&&De(mt.transmissionMap.channel),thicknessMapUv:Pr&&De(mt.thicknessMap.channel),alphaMapUv:gr&&De(mt.alphaMap.channel),vertexTangents:!!Qt.attributes.tangent&&(Ir||Ht),vertexColors:mt.vertexColors,vertexAlphas:mt.vertexColors===!0&&!!Qt.attributes.color&&Qt.attributes.color.itemSize===4,pointsUvs:Gt.isPoints===!0&&!!Qt.attributes.uv&&(Ur||gr),fog:!!$t,useFog:mt.fog===!0,fogExp2:!!$t&&$t.isFogExp2,flatShading:mt.flatShading===!0,sizeAttenuation:mt.sizeAttenuation===!0,logarithmicDepthBuffer:Se,skinning:Gt.isSkinnedMesh===!0,morphTargets:Qt.morphAttributes.position!==void 0,morphNormals:Qt.morphAttributes.normal!==void 0,morphColors:Qt.morphAttributes.color!==void 0,morphTargetsCount:Ft,morphTextureStride:sn,numDirLights:_t.directional.length,numPointLights:_t.point.length,numSpotLights:_t.spot.length,numSpotLightMaps:_t.spotLightMap.length,numRectAreaLights:_t.rectArea.length,numHemiLights:_t.hemi.length,numDirLightShadows:_t.directionalShadowMap.length,numPointLightShadows:_t.pointShadowMap.length,numSpotLightShadows:_t.spotShadowMap.length,numSpotLightShadowsWithMaps:_t.numSpotLightShadowsWithMaps,numLightProbes:_t.numLightProbes,numClippingPlanes:ae.numPlanes,numClipIntersection:ae.numIntersection,dithering:mt.dithering,shadowMapEnabled:H.shadowMap.enabled&&Lt.length>0,shadowMapType:H.shadowMap.type,toneMapping:Ui,decodeVideoTexture:Ur&&mt.map.isVideoTexture===!0&&ColorManagement$1.getTransfer(mt.map.colorSpace)===SRGBTransfer$1,premultipliedAlpha:mt.premultipliedAlpha,doubleSided:mt.side===DoubleSide$1,flipSided:mt.side===BackSide$1,useDepthPacking:mt.depthPacking>=0,depthPacking:mt.depthPacking||0,index0AttributeName:mt.index0AttributeName,extensionClipCullDistance:fi&&mt.extensions.clipCullDistance===!0&&$.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(fi&&mt.extensions.multiDraw===!0||Fr)&&$.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:$.has("KHR_parallel_shader_compile"),customProgramCacheKey:mt.customProgramCacheKey()};return Vi.vertexUv1s=fe.has(1),Vi.vertexUv2s=fe.has(2),Vi.vertexUv3s=fe.has(3),fe.clear(),Vi}function Ne(mt){const _t=[];if(mt.shaderID?_t.push(mt.shaderID):(_t.push(mt.customVertexShaderID),_t.push(mt.customFragmentShaderID)),mt.defines!==void 0)for(const Lt in mt.defines)_t.push(Lt),_t.push(mt.defines[Lt]);return mt.isRawShaderMaterial===!1&&(qe(_t,mt),Xe(_t,mt),_t.push(H.outputColorSpace)),_t.push(mt.customProgramCacheKey),_t.join()}function qe(mt,_t){mt.push(_t.precision),mt.push(_t.outputColorSpace),mt.push(_t.envMapMode),mt.push(_t.envMapCubeUVHeight),mt.push(_t.mapUv),mt.push(_t.alphaMapUv),mt.push(_t.lightMapUv),mt.push(_t.aoMapUv),mt.push(_t.bumpMapUv),mt.push(_t.normalMapUv),mt.push(_t.displacementMapUv),mt.push(_t.emissiveMapUv),mt.push(_t.metalnessMapUv),mt.push(_t.roughnessMapUv),mt.push(_t.anisotropyMapUv),mt.push(_t.clearcoatMapUv),mt.push(_t.clearcoatNormalMapUv),mt.push(_t.clearcoatRoughnessMapUv),mt.push(_t.iridescenceMapUv),mt.push(_t.iridescenceThicknessMapUv),mt.push(_t.sheenColorMapUv),mt.push(_t.sheenRoughnessMapUv),mt.push(_t.specularMapUv),mt.push(_t.specularColorMapUv),mt.push(_t.specularIntensityMapUv),mt.push(_t.transmissionMapUv),mt.push(_t.thicknessMapUv),mt.push(_t.combine),mt.push(_t.fogExp2),mt.push(_t.sizeAttenuation),mt.push(_t.morphTargetsCount),mt.push(_t.morphAttributeCount),mt.push(_t.numDirLights),mt.push(_t.numPointLights),mt.push(_t.numSpotLights),mt.push(_t.numSpotLightMaps),mt.push(_t.numHemiLights),mt.push(_t.numRectAreaLights),mt.push(_t.numDirLightShadows),mt.push(_t.numPointLightShadows),mt.push(_t.numSpotLightShadows),mt.push(_t.numSpotLightShadowsWithMaps),mt.push(_t.numLightProbes),mt.push(_t.shadowMapType),mt.push(_t.toneMapping),mt.push(_t.numClippingPlanes),mt.push(_t.numClipIntersection),mt.push(_t.depthPacking)}function Xe(mt,_t){xe.disableAll(),_t.supportsVertexTextures&&xe.enable(0),_t.instancing&&xe.enable(1),_t.instancingColor&&xe.enable(2),_t.instancingMorph&&xe.enable(3),_t.matcap&&xe.enable(4),_t.envMap&&xe.enable(5),_t.normalMapObjectSpace&&xe.enable(6),_t.normalMapTangentSpace&&xe.enable(7),_t.clearcoat&&xe.enable(8),_t.iridescence&&xe.enable(9),_t.alphaTest&&xe.enable(10),_t.vertexColors&&xe.enable(11),_t.vertexAlphas&&xe.enable(12),_t.vertexUv1s&&xe.enable(13),_t.vertexUv2s&&xe.enable(14),_t.vertexUv3s&&xe.enable(15),_t.vertexTangents&&xe.enable(16),_t.anisotropy&&xe.enable(17),_t.alphaHash&&xe.enable(18),_t.batching&&xe.enable(19),_t.dispersion&&xe.enable(20),_t.batchingColor&&xe.enable(21),mt.push(xe.mask),xe.disableAll(),_t.fog&&xe.enable(0),_t.useFog&&xe.enable(1),_t.flatShading&&xe.enable(2),_t.logarithmicDepthBuffer&&xe.enable(3),_t.skinning&&xe.enable(4),_t.morphTargets&&xe.enable(5),_t.morphNormals&&xe.enable(6),_t.morphColors&&xe.enable(7),_t.premultipliedAlpha&&xe.enable(8),_t.shadowMapEnabled&&xe.enable(9),_t.doubleSided&&xe.enable(10),_t.flipSided&&xe.enable(11),_t.useDepthPacking&&xe.enable(12),_t.dithering&&xe.enable(13),_t.transmission&&xe.enable(14),_t.sheen&&xe.enable(15),_t.opaque&&xe.enable(16),_t.pointsUvs&&xe.enable(17),_t.decodeVideoTexture&&xe.enable(18),_t.alphaToCoverage&&xe.enable(19),mt.push(xe.mask)}function Ye(mt){const _t=Ie[mt.type];let Lt;if(_t){const Vt=ShaderLib[_t];Lt=UniformsUtils.clone(Vt.uniforms)}else Lt=mt.uniforms;return Lt}function Qe(mt,_t){let Lt;for(let Vt=0,Gt=ve.length;Vt<Gt;Vt++){const $t=ve[Vt];if($t.cacheKey===_t){Lt=$t,++Lt.usedTimes;break}}return Lt===void 0&&(Lt=new WebGLProgram(H,_t,mt,re),ve.push(Lt)),Lt}function rt(mt){if(--mt.usedTimes===0){const _t=ve.indexOf(mt);ve[_t]=ve[ve.length-1],ve.pop(),mt.destroy()}}function ot(mt){le.remove(mt)}function ct(){le.dispose()}return{getParameters:Be,getProgramCacheKey:Ne,getUniforms:Ye,acquireProgram:Qe,releaseProgram:rt,releaseShaderCache:ot,programs:ve,dispose:ct}}function WebGLProperties(){let H=new WeakMap;function _(ae){return H.has(ae)}function b(ae){let xe=H.get(ae);return xe===void 0&&(xe={},H.set(ae,xe)),xe}function $(ae){H.delete(ae)}function ee(ae,xe,le){H.get(ae)[xe]=le}function re(){H=new WeakMap}return{has:_,get:b,remove:$,update:ee,dispose:re}}function painterSortStable(H,_){return H.groupOrder!==_.groupOrder?H.groupOrder-_.groupOrder:H.renderOrder!==_.renderOrder?H.renderOrder-_.renderOrder:H.material.id!==_.material.id?H.material.id-_.material.id:H.z!==_.z?H.z-_.z:H.id-_.id}function reversePainterSortStable(H,_){return H.groupOrder!==_.groupOrder?H.groupOrder-_.groupOrder:H.renderOrder!==_.renderOrder?H.renderOrder-_.renderOrder:H.z!==_.z?_.z-H.z:H.id-_.id}function WebGLRenderList(){const H=[];let _=0;const b=[],$=[],ee=[];function re(){_=0,b.length=0,$.length=0,ee.length=0}function ae(Se,Ee,Ce,Ie,De,Be){let Ne=H[_];return Ne===void 0?(Ne={id:Se.id,object:Se,geometry:Ee,material:Ce,groupOrder:Ie,renderOrder:Se.renderOrder,z:De,group:Be},H[_]=Ne):(Ne.id=Se.id,Ne.object=Se,Ne.geometry=Ee,Ne.material=Ce,Ne.groupOrder=Ie,Ne.renderOrder=Se.renderOrder,Ne.z=De,Ne.group=Be),_++,Ne}function xe(Se,Ee,Ce,Ie,De,Be){const Ne=ae(Se,Ee,Ce,Ie,De,Be);Ce.transmission>0?$.push(Ne):Ce.transparent===!0?ee.push(Ne):b.push(Ne)}function le(Se,Ee,Ce,Ie,De,Be){const Ne=ae(Se,Ee,Ce,Ie,De,Be);Ce.transmission>0?$.unshift(Ne):Ce.transparent===!0?ee.unshift(Ne):b.unshift(Ne)}function fe(Se,Ee){b.length>1&&b.sort(Se||painterSortStable),$.length>1&&$.sort(Ee||reversePainterSortStable),ee.length>1&&ee.sort(Ee||reversePainterSortStable)}function ve(){for(let Se=_,Ee=H.length;Se<Ee;Se++){const Ce=H[Se];if(Ce.id===null)break;Ce.id=null,Ce.object=null,Ce.geometry=null,Ce.material=null,Ce.group=null}}return{opaque:b,transmissive:$,transparent:ee,init:re,push:xe,unshift:le,finish:ve,sort:fe}}function WebGLRenderLists(){let H=new WeakMap;function _($,ee){const re=H.get($);let ae;return re===void 0?(ae=new WebGLRenderList,H.set($,[ae])):ee>=re.length?(ae=new WebGLRenderList,re.push(ae)):ae=re[ee],ae}function b(){H=new WeakMap}return{get:_,dispose:b}}function UniformsCache(){const H={};return{get:function(_){if(H[_.id]!==void 0)return H[_.id];let b;switch(_.type){case"DirectionalLight":b={direction:new Vector3$1,color:new Color$1};break;case"SpotLight":b={position:new Vector3$1,direction:new Vector3$1,color:new Color$1,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":b={position:new Vector3$1,color:new Color$1,distance:0,decay:0};break;case"HemisphereLight":b={direction:new Vector3$1,skyColor:new Color$1,groundColor:new Color$1};break;case"RectAreaLight":b={color:new Color$1,position:new Vector3$1,halfWidth:new Vector3$1,halfHeight:new Vector3$1};break}return H[_.id]=b,b}}}function ShadowUniformsCache(){const H={};return{get:function(_){if(H[_.id]!==void 0)return H[_.id];let b;switch(_.type){case"DirectionalLight":b={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2$1};break;case"SpotLight":b={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2$1};break;case"PointLight":b={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2$1,shadowCameraNear:1,shadowCameraFar:1e3};break}return H[_.id]=b,b}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(H,_){return(_.castShadow?2:0)-(H.castShadow?2:0)+(_.map?1:0)-(H.map?1:0)}function WebGLLights(H){const _=new UniformsCache,b=ShadowUniformsCache(),$={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let fe=0;fe<9;fe++)$.probe.push(new Vector3$1);const ee=new Vector3$1,re=new Matrix4$1,ae=new Matrix4$1;function xe(fe){let ve=0,Se=0,Ee=0;for(let mt=0;mt<9;mt++)$.probe[mt].set(0,0,0);let Ce=0,Ie=0,De=0,Be=0,Ne=0,qe=0,Xe=0,Ye=0,Qe=0,rt=0,ot=0;fe.sort(shadowCastingAndTexturingLightsFirst);for(let mt=0,_t=fe.length;mt<_t;mt++){const Lt=fe[mt],Vt=Lt.color,Gt=Lt.intensity,$t=Lt.distance,Qt=Lt.shadow&&Lt.shadow.map?Lt.shadow.map.texture:null;if(Lt.isAmbientLight)ve+=Vt.r*Gt,Se+=Vt.g*Gt,Ee+=Vt.b*Gt;else if(Lt.isLightProbe){for(let vt=0;vt<9;vt++)$.probe[vt].addScaledVector(Lt.sh.coefficients[vt],Gt);ot++}else if(Lt.isDirectionalLight){const vt=_.get(Lt);if(vt.color.copy(Lt.color).multiplyScalar(Lt.intensity),Lt.castShadow){const It=Lt.shadow,gt=b.get(Lt);gt.shadowIntensity=It.intensity,gt.shadowBias=It.bias,gt.shadowNormalBias=It.normalBias,gt.shadowRadius=It.radius,gt.shadowMapSize=It.mapSize,$.directionalShadow[Ce]=gt,$.directionalShadowMap[Ce]=Qt,$.directionalShadowMatrix[Ce]=Lt.shadow.matrix,qe++}$.directional[Ce]=vt,Ce++}else if(Lt.isSpotLight){const vt=_.get(Lt);vt.position.setFromMatrixPosition(Lt.matrixWorld),vt.color.copy(Vt).multiplyScalar(Gt),vt.distance=$t,vt.coneCos=Math.cos(Lt.angle),vt.penumbraCos=Math.cos(Lt.angle*(1-Lt.penumbra)),vt.decay=Lt.decay,$.spot[De]=vt;const It=Lt.shadow;if(Lt.map&&($.spotLightMap[Qe]=Lt.map,Qe++,It.updateMatrices(Lt),Lt.castShadow&&rt++),$.spotLightMatrix[De]=It.matrix,Lt.castShadow){const gt=b.get(Lt);gt.shadowIntensity=It.intensity,gt.shadowBias=It.bias,gt.shadowNormalBias=It.normalBias,gt.shadowRadius=It.radius,gt.shadowMapSize=It.mapSize,$.spotShadow[De]=gt,$.spotShadowMap[De]=Qt,Ye++}De++}else if(Lt.isRectAreaLight){const vt=_.get(Lt);vt.color.copy(Vt).multiplyScalar(Gt),vt.halfWidth.set(Lt.width*.5,0,0),vt.halfHeight.set(0,Lt.height*.5,0),$.rectArea[Be]=vt,Be++}else if(Lt.isPointLight){const vt=_.get(Lt);if(vt.color.copy(Lt.color).multiplyScalar(Lt.intensity),vt.distance=Lt.distance,vt.decay=Lt.decay,Lt.castShadow){const It=Lt.shadow,gt=b.get(Lt);gt.shadowIntensity=It.intensity,gt.shadowBias=It.bias,gt.shadowNormalBias=It.normalBias,gt.shadowRadius=It.radius,gt.shadowMapSize=It.mapSize,gt.shadowCameraNear=It.camera.near,gt.shadowCameraFar=It.camera.far,$.pointShadow[Ie]=gt,$.pointShadowMap[Ie]=Qt,$.pointShadowMatrix[Ie]=Lt.shadow.matrix,Xe++}$.point[Ie]=vt,Ie++}else if(Lt.isHemisphereLight){const vt=_.get(Lt);vt.skyColor.copy(Lt.color).multiplyScalar(Gt),vt.groundColor.copy(Lt.groundColor).multiplyScalar(Gt),$.hemi[Ne]=vt,Ne++}}Be>0&&(H.has("OES_texture_float_linear")===!0?($.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,$.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):($.rectAreaLTC1=UniformsLib.LTC_HALF_1,$.rectAreaLTC2=UniformsLib.LTC_HALF_2)),$.ambient[0]=ve,$.ambient[1]=Se,$.ambient[2]=Ee;const ct=$.hash;(ct.directionalLength!==Ce||ct.pointLength!==Ie||ct.spotLength!==De||ct.rectAreaLength!==Be||ct.hemiLength!==Ne||ct.numDirectionalShadows!==qe||ct.numPointShadows!==Xe||ct.numSpotShadows!==Ye||ct.numSpotMaps!==Qe||ct.numLightProbes!==ot)&&($.directional.length=Ce,$.spot.length=De,$.rectArea.length=Be,$.point.length=Ie,$.hemi.length=Ne,$.directionalShadow.length=qe,$.directionalShadowMap.length=qe,$.pointShadow.length=Xe,$.pointShadowMap.length=Xe,$.spotShadow.length=Ye,$.spotShadowMap.length=Ye,$.directionalShadowMatrix.length=qe,$.pointShadowMatrix.length=Xe,$.spotLightMatrix.length=Ye+Qe-rt,$.spotLightMap.length=Qe,$.numSpotLightShadowsWithMaps=rt,$.numLightProbes=ot,ct.directionalLength=Ce,ct.pointLength=Ie,ct.spotLength=De,ct.rectAreaLength=Be,ct.hemiLength=Ne,ct.numDirectionalShadows=qe,ct.numPointShadows=Xe,ct.numSpotShadows=Ye,ct.numSpotMaps=Qe,ct.numLightProbes=ot,$.version=nextVersion++)}function le(fe,ve){let Se=0,Ee=0,Ce=0,Ie=0,De=0;const Be=ve.matrixWorldInverse;for(let Ne=0,qe=fe.length;Ne<qe;Ne++){const Xe=fe[Ne];if(Xe.isDirectionalLight){const Ye=$.directional[Se];Ye.direction.setFromMatrixPosition(Xe.matrixWorld),ee.setFromMatrixPosition(Xe.target.matrixWorld),Ye.direction.sub(ee),Ye.direction.transformDirection(Be),Se++}else if(Xe.isSpotLight){const Ye=$.spot[Ce];Ye.position.setFromMatrixPosition(Xe.matrixWorld),Ye.position.applyMatrix4(Be),Ye.direction.setFromMatrixPosition(Xe.matrixWorld),ee.setFromMatrixPosition(Xe.target.matrixWorld),Ye.direction.sub(ee),Ye.direction.transformDirection(Be),Ce++}else if(Xe.isRectAreaLight){const Ye=$.rectArea[Ie];Ye.position.setFromMatrixPosition(Xe.matrixWorld),Ye.position.applyMatrix4(Be),ae.identity(),re.copy(Xe.matrixWorld),re.premultiply(Be),ae.extractRotation(re),Ye.halfWidth.set(Xe.width*.5,0,0),Ye.halfHeight.set(0,Xe.height*.5,0),Ye.halfWidth.applyMatrix4(ae),Ye.halfHeight.applyMatrix4(ae),Ie++}else if(Xe.isPointLight){const Ye=$.point[Ee];Ye.position.setFromMatrixPosition(Xe.matrixWorld),Ye.position.applyMatrix4(Be),Ee++}else if(Xe.isHemisphereLight){const Ye=$.hemi[De];Ye.direction.setFromMatrixPosition(Xe.matrixWorld),Ye.direction.transformDirection(Be),De++}}}return{setup:xe,setupView:le,state:$}}function WebGLRenderState(H){const _=new WebGLLights(H),b=[],$=[];function ee(ve){fe.camera=ve,b.length=0,$.length=0}function re(ve){b.push(ve)}function ae(ve){$.push(ve)}function xe(){_.setup(b)}function le(ve){_.setupView(b,ve)}const fe={lightsArray:b,shadowsArray:$,camera:null,lights:_,transmissionRenderTarget:{}};return{init:ee,state:fe,setupLights:xe,setupLightsView:le,pushLight:re,pushShadow:ae}}function WebGLRenderStates(H){let _=new WeakMap;function b(ee,re=0){const ae=_.get(ee);let xe;return ae===void 0?(xe=new WebGLRenderState(H),_.set(ee,[xe])):re>=ae.length?(xe=new WebGLRenderState(H),ae.push(xe)):xe=ae[re],xe}function $(){_=new WeakMap}return{get:b,dispose:$}}class MeshDepthMaterial extends Material$1{constructor(_){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(_)}copy(_){return super.copy(_),this.depthPacking=_.depthPacking,this.map=_.map,this.alphaMap=_.alphaMap,this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material$1{constructor(_){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(_)}copy(_){return super.copy(_),this.map=_.map,this.alphaMap=_.alphaMap,this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this}}const vertex=`
void main() {

	gl_Position = vec4( position, 1.0 );

}
`,fragment=`
uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;

#include <packing>

void main() {

	const float samples = float( VSM_SAMPLES );

	float mean = 0.0;
	float squared_mean = 0.0;

	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {

		float uvOffset = uvStart + i * uvStride;

		#ifdef HORIZONTAL_PASS

			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;

		#else

			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;

		#endif

	}

	mean = mean / samples;
	squared_mean = squared_mean / samples;

	float std_dev = sqrt( squared_mean - mean * mean );

	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );

}
`;function WebGLShadowMap(H,_,b){let $=new Frustum$1;const ee=new Vector2$1,re=new Vector2$1,ae=new Vector4$1,xe=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),le=new MeshDistanceMaterial,fe={},ve=b.maxTextureSize,Se={[FrontSide$1]:BackSide$1,[BackSide$1]:FrontSide$1,[DoubleSide$1]:DoubleSide$1},Ee=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2$1},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment}),Ce=Ee.clone();Ce.defines.HORIZONTAL_PASS=1;const Ie=new BufferGeometry$1;Ie.setAttribute("position",new BufferAttribute$1(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const De=new Mesh$1(Ie,Ee),Be=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap;let Ne=this.type;this.render=function(rt,ot,ct){if(Be.enabled===!1||Be.autoUpdate===!1&&Be.needsUpdate===!1||rt.length===0)return;const mt=H.getRenderTarget(),_t=H.getActiveCubeFace(),Lt=H.getActiveMipmapLevel(),Vt=H.state;Vt.setBlending(NoBlending),Vt.buffers.color.setClear(1,1,1,1),Vt.buffers.depth.setTest(!0),Vt.setScissorTest(!1);const Gt=Ne!==VSMShadowMap&&this.type===VSMShadowMap,$t=Ne===VSMShadowMap&&this.type!==VSMShadowMap;for(let Qt=0,vt=rt.length;Qt<vt;Qt++){const It=rt[Qt],gt=It.shadow;if(gt===void 0){console.warn("THREE.WebGLShadowMap:",It,"has no shadow.");continue}if(gt.autoUpdate===!1&&gt.needsUpdate===!1)continue;ee.copy(gt.mapSize);const Tt=gt.getFrameExtents();if(ee.multiply(Tt),re.copy(gt.mapSize),(ee.x>ve||ee.y>ve)&&(ee.x>ve&&(re.x=Math.floor(ve/Tt.x),ee.x=re.x*Tt.x,gt.mapSize.x=re.x),ee.y>ve&&(re.y=Math.floor(ve/Tt.y),ee.y=re.y*Tt.y,gt.mapSize.y=re.y)),gt.map===null||Gt===!0||$t===!0){const Ft=this.type!==VSMShadowMap?{minFilter:NearestFilter$1,magFilter:NearestFilter$1}:{};gt.map!==null&&gt.map.dispose(),gt.map=new WebGLRenderTarget(ee.x,ee.y,Ft),gt.map.texture.name=It.name+".shadowMap",gt.camera.updateProjectionMatrix()}H.setRenderTarget(gt.map),H.clear();const Ct=gt.getViewportCount();for(let Ft=0;Ft<Ct;Ft++){const sn=gt.getViewport(Ft);ae.set(re.x*sn.x,re.y*sn.y,re.x*sn.z,re.y*sn.w),Vt.viewport(ae),gt.updateMatrices(It,Ft),$=gt.getFrustum(),Ye(ot,ct,gt.camera,It,this.type)}gt.isPointLightShadow!==!0&&this.type===VSMShadowMap&&qe(gt,ct),gt.needsUpdate=!1}Ne=this.type,Be.needsUpdate=!1,H.setRenderTarget(mt,_t,Lt)};function qe(rt,ot){const ct=_.update(De);Ee.defines.VSM_SAMPLES!==rt.blurSamples&&(Ee.defines.VSM_SAMPLES=rt.blurSamples,Ce.defines.VSM_SAMPLES=rt.blurSamples,Ee.needsUpdate=!0,Ce.needsUpdate=!0),rt.mapPass===null&&(rt.mapPass=new WebGLRenderTarget(ee.x,ee.y)),Ee.uniforms.shadow_pass.value=rt.map.texture,Ee.uniforms.resolution.value=rt.mapSize,Ee.uniforms.radius.value=rt.radius,H.setRenderTarget(rt.mapPass),H.clear(),H.renderBufferDirect(ot,null,ct,Ee,De,null),Ce.uniforms.shadow_pass.value=rt.mapPass.texture,Ce.uniforms.resolution.value=rt.mapSize,Ce.uniforms.radius.value=rt.radius,H.setRenderTarget(rt.map),H.clear(),H.renderBufferDirect(ot,null,ct,Ce,De,null)}function Xe(rt,ot,ct,mt){let _t=null;const Lt=ct.isPointLight===!0?rt.customDistanceMaterial:rt.customDepthMaterial;if(Lt!==void 0)_t=Lt;else if(_t=ct.isPointLight===!0?le:xe,H.localClippingEnabled&&ot.clipShadows===!0&&Array.isArray(ot.clippingPlanes)&&ot.clippingPlanes.length!==0||ot.displacementMap&&ot.displacementScale!==0||ot.alphaMap&&ot.alphaTest>0||ot.map&&ot.alphaTest>0){const Vt=_t.uuid,Gt=ot.uuid;let $t=fe[Vt];$t===void 0&&($t={},fe[Vt]=$t);let Qt=$t[Gt];Qt===void 0&&(Qt=_t.clone(),$t[Gt]=Qt,ot.addEventListener("dispose",Qe)),_t=Qt}if(_t.visible=ot.visible,_t.wireframe=ot.wireframe,mt===VSMShadowMap?_t.side=ot.shadowSide!==null?ot.shadowSide:ot.side:_t.side=ot.shadowSide!==null?ot.shadowSide:Se[ot.side],_t.alphaMap=ot.alphaMap,_t.alphaTest=ot.alphaTest,_t.map=ot.map,_t.clipShadows=ot.clipShadows,_t.clippingPlanes=ot.clippingPlanes,_t.clipIntersection=ot.clipIntersection,_t.displacementMap=ot.displacementMap,_t.displacementScale=ot.displacementScale,_t.displacementBias=ot.displacementBias,_t.wireframeLinewidth=ot.wireframeLinewidth,_t.linewidth=ot.linewidth,ct.isPointLight===!0&&_t.isMeshDistanceMaterial===!0){const Vt=H.properties.get(_t);Vt.light=ct}return _t}function Ye(rt,ot,ct,mt,_t){if(rt.visible===!1)return;if(rt.layers.test(ot.layers)&&(rt.isMesh||rt.isLine||rt.isPoints)&&(rt.castShadow||rt.receiveShadow&&_t===VSMShadowMap)&&(!rt.frustumCulled||$.intersectsObject(rt))){rt.modelViewMatrix.multiplyMatrices(ct.matrixWorldInverse,rt.matrixWorld);const Gt=_.update(rt),$t=rt.material;if(Array.isArray($t)){const Qt=Gt.groups;for(let vt=0,It=Qt.length;vt<It;vt++){const gt=Qt[vt],Tt=$t[gt.materialIndex];if(Tt&&Tt.visible){const Ct=Xe(rt,Tt,mt,_t);rt.onBeforeShadow(H,rt,ot,ct,Gt,Ct,gt),H.renderBufferDirect(ct,null,Gt,Ct,rt,gt),rt.onAfterShadow(H,rt,ot,ct,Gt,Ct,gt)}}}else if($t.visible){const Qt=Xe(rt,$t,mt,_t);rt.onBeforeShadow(H,rt,ot,ct,Gt,Qt,null),H.renderBufferDirect(ct,null,Gt,Qt,rt,null),rt.onAfterShadow(H,rt,ot,ct,Gt,Qt,null)}}const Vt=rt.children;for(let Gt=0,$t=Vt.length;Gt<$t;Gt++)Ye(Vt[Gt],ot,ct,mt,_t)}function Qe(rt){rt.target.removeEventListener("dispose",Qe);for(const ct in fe){const mt=fe[ct],_t=rt.target.uuid;_t in mt&&(mt[_t].dispose(),delete mt[_t])}}}function WebGLState(H){function _(){let wn=!1;const Pr=new Vector4$1;let xr=null;const gr=new Vector4$1(0,0,0,0);return{setMask:function(Mr){xr!==Mr&&!wn&&(H.colorMask(Mr,Mr,Mr,Mr),xr=Mr)},setLocked:function(Mr){wn=Mr},setClear:function(Mr,ci,fi,Ui,Vi){Vi===!0&&(Mr*=Ui,ci*=Ui,fi*=Ui),Pr.set(Mr,ci,fi,Ui),gr.equals(Pr)===!1&&(H.clearColor(Mr,ci,fi,Ui),gr.copy(Pr))},reset:function(){wn=!1,xr=null,gr.set(-1,0,0,0)}}}function b(){let wn=!1,Pr=null,xr=null,gr=null;return{setTest:function(Mr){Mr?Pn(H.DEPTH_TEST):tr(H.DEPTH_TEST)},setMask:function(Mr){Pr!==Mr&&!wn&&(H.depthMask(Mr),Pr=Mr)},setFunc:function(Mr){if(xr!==Mr){switch(Mr){case NeverDepth:H.depthFunc(H.NEVER);break;case AlwaysDepth:H.depthFunc(H.ALWAYS);break;case LessDepth:H.depthFunc(H.LESS);break;case LessEqualDepth$1:H.depthFunc(H.LEQUAL);break;case EqualDepth:H.depthFunc(H.EQUAL);break;case GreaterEqualDepth:H.depthFunc(H.GEQUAL);break;case GreaterDepth:H.depthFunc(H.GREATER);break;case NotEqualDepth:H.depthFunc(H.NOTEQUAL);break;default:H.depthFunc(H.LEQUAL)}xr=Mr}},setLocked:function(Mr){wn=Mr},setClear:function(Mr){gr!==Mr&&(H.clearDepth(Mr),gr=Mr)},reset:function(){wn=!1,Pr=null,xr=null,gr=null}}}function $(){let wn=!1,Pr=null,xr=null,gr=null,Mr=null,ci=null,fi=null,Ui=null,Vi=null;return{setTest:function(bi){wn||(bi?Pn(H.STENCIL_TEST):tr(H.STENCIL_TEST))},setMask:function(bi){Pr!==bi&&!wn&&(H.stencilMask(bi),Pr=bi)},setFunc:function(bi,Ga,Ra){(xr!==bi||gr!==Ga||Mr!==Ra)&&(H.stencilFunc(bi,Ga,Ra),xr=bi,gr=Ga,Mr=Ra)},setOp:function(bi,Ga,Ra){(ci!==bi||fi!==Ga||Ui!==Ra)&&(H.stencilOp(bi,Ga,Ra),ci=bi,fi=Ga,Ui=Ra)},setLocked:function(bi){wn=bi},setClear:function(bi){Vi!==bi&&(H.clearStencil(bi),Vi=bi)},reset:function(){wn=!1,Pr=null,xr=null,gr=null,Mr=null,ci=null,fi=null,Ui=null,Vi=null}}}const ee=new _,re=new b,ae=new $,xe=new WeakMap,le=new WeakMap;let fe={},ve={},Se=new WeakMap,Ee=[],Ce=null,Ie=!1,De=null,Be=null,Ne=null,qe=null,Xe=null,Ye=null,Qe=null,rt=new Color$1(0,0,0),ot=0,ct=!1,mt=null,_t=null,Lt=null,Vt=null,Gt=null;const $t=H.getParameter(H.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Qt=!1,vt=0;const It=H.getParameter(H.VERSION);It.indexOf("WebGL")!==-1?(vt=parseFloat(/^WebGL (\d)/.exec(It)[1]),Qt=vt>=1):It.indexOf("OpenGL ES")!==-1&&(vt=parseFloat(/^OpenGL ES (\d)/.exec(It)[1]),Qt=vt>=2);let gt=null,Tt={};const Ct=H.getParameter(H.SCISSOR_BOX),Ft=H.getParameter(H.VIEWPORT),sn=new Vector4$1().fromArray(Ct),cn=new Vector4$1().fromArray(Ft);function en(wn,Pr,xr,gr){const Mr=new Uint8Array(4),ci=H.createTexture();H.bindTexture(wn,ci),H.texParameteri(wn,H.TEXTURE_MIN_FILTER,H.NEAREST),H.texParameteri(wn,H.TEXTURE_MAG_FILTER,H.NEAREST);for(let fi=0;fi<xr;fi++)wn===H.TEXTURE_3D||wn===H.TEXTURE_2D_ARRAY?H.texImage3D(Pr,0,H.RGBA,1,1,gr,0,H.RGBA,H.UNSIGNED_BYTE,Mr):H.texImage2D(Pr+fi,0,H.RGBA,1,1,0,H.RGBA,H.UNSIGNED_BYTE,Mr);return ci}const yn={};yn[H.TEXTURE_2D]=en(H.TEXTURE_2D,H.TEXTURE_2D,1),yn[H.TEXTURE_CUBE_MAP]=en(H.TEXTURE_CUBE_MAP,H.TEXTURE_CUBE_MAP_POSITIVE_X,6),yn[H.TEXTURE_2D_ARRAY]=en(H.TEXTURE_2D_ARRAY,H.TEXTURE_2D_ARRAY,1,1),yn[H.TEXTURE_3D]=en(H.TEXTURE_3D,H.TEXTURE_3D,1,1),ee.setClear(0,0,0,1),re.setClear(1),ae.setClear(0),Pn(H.DEPTH_TEST),re.setFunc(LessEqualDepth$1),Qr(!1),Ir(CullFaceBack),Pn(H.CULL_FACE),qr(NoBlending);function Pn(wn){fe[wn]!==!0&&(H.enable(wn),fe[wn]=!0)}function tr(wn){fe[wn]!==!1&&(H.disable(wn),fe[wn]=!1)}function nr(wn,Pr){return ve[wn]!==Pr?(H.bindFramebuffer(wn,Pr),ve[wn]=Pr,wn===H.DRAW_FRAMEBUFFER&&(ve[H.FRAMEBUFFER]=Pr),wn===H.FRAMEBUFFER&&(ve[H.DRAW_FRAMEBUFFER]=Pr),!0):!1}function Fr(wn,Pr){let xr=Ee,gr=!1;if(wn){xr=Se.get(Pr),xr===void 0&&(xr=[],Se.set(Pr,xr));const Mr=wn.textures;if(xr.length!==Mr.length||xr[0]!==H.COLOR_ATTACHMENT0){for(let ci=0,fi=Mr.length;ci<fi;ci++)xr[ci]=H.COLOR_ATTACHMENT0+ci;xr.length=Mr.length,gr=!0}}else xr[0]!==H.BACK&&(xr[0]=H.BACK,gr=!0);gr&&H.drawBuffers(xr)}function Ur(wn){return Ce!==wn?(H.useProgram(wn),Ce=wn,!0):!1}const Kr={[AddEquation$1]:H.FUNC_ADD,[SubtractEquation]:H.FUNC_SUBTRACT,[ReverseSubtractEquation]:H.FUNC_REVERSE_SUBTRACT};Kr[MinEquation]=H.MIN,Kr[MaxEquation]=H.MAX;const on={[ZeroFactor]:H.ZERO,[OneFactor]:H.ONE,[SrcColorFactor]:H.SRC_COLOR,[SrcAlphaFactor$1]:H.SRC_ALPHA,[SrcAlphaSaturateFactor]:H.SRC_ALPHA_SATURATE,[DstColorFactor]:H.DST_COLOR,[DstAlphaFactor]:H.DST_ALPHA,[OneMinusSrcColorFactor]:H.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor$1]:H.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor]:H.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor]:H.ONE_MINUS_DST_ALPHA,[ConstantColorFactor]:H.CONSTANT_COLOR,[OneMinusConstantColorFactor]:H.ONE_MINUS_CONSTANT_COLOR,[ConstantAlphaFactor]:H.CONSTANT_ALPHA,[OneMinusConstantAlphaFactor]:H.ONE_MINUS_CONSTANT_ALPHA};function qr(wn,Pr,xr,gr,Mr,ci,fi,Ui,Vi,bi){if(wn===NoBlending){Ie===!0&&(tr(H.BLEND),Ie=!1);return}if(Ie===!1&&(Pn(H.BLEND),Ie=!0),wn!==CustomBlending){if(wn!==De||bi!==ct){if((Be!==AddEquation$1||Xe!==AddEquation$1)&&(H.blendEquation(H.FUNC_ADD),Be=AddEquation$1,Xe=AddEquation$1),bi)switch(wn){case NormalBlending$1:H.blendFuncSeparate(H.ONE,H.ONE_MINUS_SRC_ALPHA,H.ONE,H.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:H.blendFunc(H.ONE,H.ONE);break;case SubtractiveBlending:H.blendFuncSeparate(H.ZERO,H.ONE_MINUS_SRC_COLOR,H.ZERO,H.ONE);break;case MultiplyBlending:H.blendFuncSeparate(H.ZERO,H.SRC_COLOR,H.ZERO,H.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",wn);break}else switch(wn){case NormalBlending$1:H.blendFuncSeparate(H.SRC_ALPHA,H.ONE_MINUS_SRC_ALPHA,H.ONE,H.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:H.blendFunc(H.SRC_ALPHA,H.ONE);break;case SubtractiveBlending:H.blendFuncSeparate(H.ZERO,H.ONE_MINUS_SRC_COLOR,H.ZERO,H.ONE);break;case MultiplyBlending:H.blendFunc(H.ZERO,H.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",wn);break}Ne=null,qe=null,Ye=null,Qe=null,rt.set(0,0,0),ot=0,De=wn,ct=bi}return}Mr=Mr||Pr,ci=ci||xr,fi=fi||gr,(Pr!==Be||Mr!==Xe)&&(H.blendEquationSeparate(Kr[Pr],Kr[Mr]),Be=Pr,Xe=Mr),(xr!==Ne||gr!==qe||ci!==Ye||fi!==Qe)&&(H.blendFuncSeparate(on[xr],on[gr],on[ci],on[fi]),Ne=xr,qe=gr,Ye=ci,Qe=fi),(Ui.equals(rt)===!1||Vi!==ot)&&(H.blendColor(Ui.r,Ui.g,Ui.b,Vi),rt.copy(Ui),ot=Vi),De=wn,ct=!1}function rr(wn,Pr){wn.side===DoubleSide$1?tr(H.CULL_FACE):Pn(H.CULL_FACE);let xr=wn.side===BackSide$1;Pr&&(xr=!xr),Qr(xr),wn.blending===NormalBlending$1&&wn.transparent===!1?qr(NoBlending):qr(wn.blending,wn.blendEquation,wn.blendSrc,wn.blendDst,wn.blendEquationAlpha,wn.blendSrcAlpha,wn.blendDstAlpha,wn.blendColor,wn.blendAlpha,wn.premultipliedAlpha),re.setFunc(wn.depthFunc),re.setTest(wn.depthTest),re.setMask(wn.depthWrite),ee.setMask(wn.colorWrite);const gr=wn.stencilWrite;ae.setTest(gr),gr&&(ae.setMask(wn.stencilWriteMask),ae.setFunc(wn.stencilFunc,wn.stencilRef,wn.stencilFuncMask),ae.setOp(wn.stencilFail,wn.stencilZFail,wn.stencilZPass)),Hr(wn.polygonOffset,wn.polygonOffsetFactor,wn.polygonOffsetUnits),wn.alphaToCoverage===!0?Pn(H.SAMPLE_ALPHA_TO_COVERAGE):tr(H.SAMPLE_ALPHA_TO_COVERAGE)}function Qr(wn){mt!==wn&&(wn?H.frontFace(H.CW):H.frontFace(H.CCW),mt=wn)}function Ir(wn){wn!==CullFaceNone?(Pn(H.CULL_FACE),wn!==_t&&(wn===CullFaceBack?H.cullFace(H.BACK):wn===CullFaceFront?H.cullFace(H.FRONT):H.cullFace(H.FRONT_AND_BACK))):tr(H.CULL_FACE),_t=wn}function ai(wn){wn!==Lt&&(Qt&&H.lineWidth(wn),Lt=wn)}function Hr(wn,Pr,xr){wn?(Pn(H.POLYGON_OFFSET_FILL),(Vt!==Pr||Gt!==xr)&&(H.polygonOffset(Pr,xr),Vt=Pr,Gt=xr)):tr(H.POLYGON_OFFSET_FILL)}function Vr(wn){wn?Pn(H.SCISSOR_TEST):tr(H.SCISSOR_TEST)}function xn(wn){wn===void 0&&(wn=H.TEXTURE0+$t-1),gt!==wn&&(H.activeTexture(wn),gt=wn)}function Ht(wn,Pr,xr){xr===void 0&&(gt===null?xr=H.TEXTURE0+$t-1:xr=gt);let gr=Tt[xr];gr===void 0&&(gr={type:void 0,texture:void 0},Tt[xr]=gr),(gr.type!==wn||gr.texture!==Pr)&&(gt!==xr&&(H.activeTexture(xr),gt=xr),H.bindTexture(wn,Pr||yn[wn]),gr.type=wn,gr.texture=Pr)}function In(){const wn=Tt[gt];wn!==void 0&&wn.type!==void 0&&(H.bindTexture(wn.type,null),wn.type=void 0,wn.texture=void 0)}function er(){try{H.compressedTexImage2D.apply(H,arguments)}catch(wn){console.error("THREE.WebGLState:",wn)}}function Hn(){try{H.compressedTexImage3D.apply(H,arguments)}catch(wn){console.error("THREE.WebGLState:",wn)}}function Zn(){try{H.texSubImage2D.apply(H,arguments)}catch(wn){console.error("THREE.WebGLState:",wn)}}function Dr(){try{H.texSubImage3D.apply(H,arguments)}catch(wn){console.error("THREE.WebGLState:",wn)}}function zn(){try{H.compressedTexSubImage2D.apply(H,arguments)}catch(wn){console.error("THREE.WebGLState:",wn)}}function Nr(){try{H.compressedTexSubImage3D.apply(H,arguments)}catch(wn){console.error("THREE.WebGLState:",wn)}}function vr(){try{H.texStorage2D.apply(H,arguments)}catch(wn){console.error("THREE.WebGLState:",wn)}}function Sr(){try{H.texStorage3D.apply(H,arguments)}catch(wn){console.error("THREE.WebGLState:",wn)}}function zr(){try{H.texImage2D.apply(H,arguments)}catch(wn){console.error("THREE.WebGLState:",wn)}}function gi(){try{H.texImage3D.apply(H,arguments)}catch(wn){console.error("THREE.WebGLState:",wn)}}function oi(wn){sn.equals(wn)===!1&&(H.scissor(wn.x,wn.y,wn.z,wn.w),sn.copy(wn))}function Gr(wn){cn.equals(wn)===!1&&(H.viewport(wn.x,wn.y,wn.z,wn.w),cn.copy(wn))}function ri(wn,Pr){let xr=le.get(Pr);xr===void 0&&(xr=new WeakMap,le.set(Pr,xr));let gr=xr.get(wn);gr===void 0&&(gr=H.getUniformBlockIndex(Pr,wn.name),xr.set(wn,gr))}function yi(wn,Pr){const gr=le.get(Pr).get(wn);xe.get(Pr)!==gr&&(H.uniformBlockBinding(Pr,gr,wn.__bindingPointIndex),xe.set(Pr,gr))}function Ci(){H.disable(H.BLEND),H.disable(H.CULL_FACE),H.disable(H.DEPTH_TEST),H.disable(H.POLYGON_OFFSET_FILL),H.disable(H.SCISSOR_TEST),H.disable(H.STENCIL_TEST),H.disable(H.SAMPLE_ALPHA_TO_COVERAGE),H.blendEquation(H.FUNC_ADD),H.blendFunc(H.ONE,H.ZERO),H.blendFuncSeparate(H.ONE,H.ZERO,H.ONE,H.ZERO),H.blendColor(0,0,0,0),H.colorMask(!0,!0,!0,!0),H.clearColor(0,0,0,0),H.depthMask(!0),H.depthFunc(H.LESS),H.clearDepth(1),H.stencilMask(4294967295),H.stencilFunc(H.ALWAYS,0,4294967295),H.stencilOp(H.KEEP,H.KEEP,H.KEEP),H.clearStencil(0),H.cullFace(H.BACK),H.frontFace(H.CCW),H.polygonOffset(0,0),H.activeTexture(H.TEXTURE0),H.bindFramebuffer(H.FRAMEBUFFER,null),H.bindFramebuffer(H.DRAW_FRAMEBUFFER,null),H.bindFramebuffer(H.READ_FRAMEBUFFER,null),H.useProgram(null),H.lineWidth(1),H.scissor(0,0,H.canvas.width,H.canvas.height),H.viewport(0,0,H.canvas.width,H.canvas.height),fe={},gt=null,Tt={},ve={},Se=new WeakMap,Ee=[],Ce=null,Ie=!1,De=null,Be=null,Ne=null,qe=null,Xe=null,Ye=null,Qe=null,rt=new Color$1(0,0,0),ot=0,ct=!1,mt=null,_t=null,Lt=null,Vt=null,Gt=null,sn.set(0,0,H.canvas.width,H.canvas.height),cn.set(0,0,H.canvas.width,H.canvas.height),ee.reset(),re.reset(),ae.reset()}return{buffers:{color:ee,depth:re,stencil:ae},enable:Pn,disable:tr,bindFramebuffer:nr,drawBuffers:Fr,useProgram:Ur,setBlending:qr,setMaterial:rr,setFlipSided:Qr,setCullFace:Ir,setLineWidth:ai,setPolygonOffset:Hr,setScissorTest:Vr,activeTexture:xn,bindTexture:Ht,unbindTexture:In,compressedTexImage2D:er,compressedTexImage3D:Hn,texImage2D:zr,texImage3D:gi,updateUBOMapping:ri,uniformBlockBinding:yi,texStorage2D:vr,texStorage3D:Sr,texSubImage2D:Zn,texSubImage3D:Dr,compressedTexSubImage2D:zn,compressedTexSubImage3D:Nr,scissor:oi,viewport:Gr,reset:Ci}}function getByteLength(H,_,b,$){const ee=getTextureTypeByteLength($);switch(b){case AlphaFormat:return H*_;case LuminanceFormat:return H*_;case LuminanceAlphaFormat:return H*_*2;case RedFormat$1:return H*_/ee.components*ee.byteLength;case RedIntegerFormat:return H*_/ee.components*ee.byteLength;case RGFormat:return H*_*2/ee.components*ee.byteLength;case RGIntegerFormat:return H*_*2/ee.components*ee.byteLength;case RGBFormat:return H*_*3/ee.components*ee.byteLength;case RGBAFormat$1:return H*_*4/ee.components*ee.byteLength;case RGBAIntegerFormat:return H*_*4/ee.components*ee.byteLength;case RGB_S3TC_DXT1_Format:case RGBA_S3TC_DXT1_Format:return Math.floor((H+3)/4)*Math.floor((_+3)/4)*8;case RGBA_S3TC_DXT3_Format:case RGBA_S3TC_DXT5_Format:return Math.floor((H+3)/4)*Math.floor((_+3)/4)*16;case RGB_PVRTC_2BPPV1_Format:case RGBA_PVRTC_2BPPV1_Format:return Math.max(H,16)*Math.max(_,8)/4;case RGB_PVRTC_4BPPV1_Format:case RGBA_PVRTC_4BPPV1_Format:return Math.max(H,8)*Math.max(_,8)/2;case RGB_ETC1_Format:case RGB_ETC2_Format:return Math.floor((H+3)/4)*Math.floor((_+3)/4)*8;case RGBA_ETC2_EAC_Format:return Math.floor((H+3)/4)*Math.floor((_+3)/4)*16;case RGBA_ASTC_4x4_Format:return Math.floor((H+3)/4)*Math.floor((_+3)/4)*16;case RGBA_ASTC_5x4_Format:return Math.floor((H+4)/5)*Math.floor((_+3)/4)*16;case RGBA_ASTC_5x5_Format:return Math.floor((H+4)/5)*Math.floor((_+4)/5)*16;case RGBA_ASTC_6x5_Format:return Math.floor((H+5)/6)*Math.floor((_+4)/5)*16;case RGBA_ASTC_6x6_Format:return Math.floor((H+5)/6)*Math.floor((_+5)/6)*16;case RGBA_ASTC_8x5_Format:return Math.floor((H+7)/8)*Math.floor((_+4)/5)*16;case RGBA_ASTC_8x6_Format:return Math.floor((H+7)/8)*Math.floor((_+5)/6)*16;case RGBA_ASTC_8x8_Format:return Math.floor((H+7)/8)*Math.floor((_+7)/8)*16;case RGBA_ASTC_10x5_Format:return Math.floor((H+9)/10)*Math.floor((_+4)/5)*16;case RGBA_ASTC_10x6_Format:return Math.floor((H+9)/10)*Math.floor((_+5)/6)*16;case RGBA_ASTC_10x8_Format:return Math.floor((H+9)/10)*Math.floor((_+7)/8)*16;case RGBA_ASTC_10x10_Format:return Math.floor((H+9)/10)*Math.floor((_+9)/10)*16;case RGBA_ASTC_12x10_Format:return Math.floor((H+11)/12)*Math.floor((_+9)/10)*16;case RGBA_ASTC_12x12_Format:return Math.floor((H+11)/12)*Math.floor((_+11)/12)*16;case RGBA_BPTC_Format:case RGB_BPTC_SIGNED_Format:case RGB_BPTC_UNSIGNED_Format:return Math.ceil(H/4)*Math.ceil(_/4)*16;case RED_RGTC1_Format:case SIGNED_RED_RGTC1_Format:return Math.ceil(H/4)*Math.ceil(_/4)*8;case RED_GREEN_RGTC2_Format:case SIGNED_RED_GREEN_RGTC2_Format:return Math.ceil(H/4)*Math.ceil(_/4)*16}throw new Error(`Unable to determine texture byte length for ${b} format.`)}function getTextureTypeByteLength(H){switch(H){case UnsignedByteType$1:case ByteType:return{byteLength:1,components:1};case UnsignedShortType:case ShortType:case HalfFloatType$1:return{byteLength:2,components:1};case UnsignedShort4444Type:case UnsignedShort5551Type:return{byteLength:2,components:4};case UnsignedIntType:case IntType:case FloatType$1:return{byteLength:4,components:1};case UnsignedInt5999Type:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${H}.`)}function WebGLTextures(H,_,b,$,ee,re,ae){const xe=_.has("WEBGL_multisampled_render_to_texture")?_.get("WEBGL_multisampled_render_to_texture"):null,le=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),fe=new Vector2$1,ve=new WeakMap;let Se;const Ee=new WeakMap;let Ce=!1;try{Ce=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function Ie(xn,Ht){return Ce?new OffscreenCanvas(xn,Ht):createElementNS$1("canvas")}function De(xn,Ht,In){let er=1;const Hn=Vr(xn);if((Hn.width>In||Hn.height>In)&&(er=In/Math.max(Hn.width,Hn.height)),er<1)if(typeof HTMLImageElement<"u"&&xn instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&xn instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&xn instanceof ImageBitmap||typeof VideoFrame<"u"&&xn instanceof VideoFrame){const Zn=Math.floor(er*Hn.width),Dr=Math.floor(er*Hn.height);Se===void 0&&(Se=Ie(Zn,Dr));const zn=Ht?Ie(Zn,Dr):Se;return zn.width=Zn,zn.height=Dr,zn.getContext("2d").drawImage(xn,0,0,Zn,Dr),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Hn.width+"x"+Hn.height+") to ("+Zn+"x"+Dr+")."),zn}else return"data"in xn&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Hn.width+"x"+Hn.height+")."),xn;return xn}function Be(xn){return xn.generateMipmaps&&xn.minFilter!==NearestFilter$1&&xn.minFilter!==LinearFilter$1}function Ne(xn){H.generateMipmap(xn)}function qe(xn,Ht,In,er,Hn=!1){if(xn!==null){if(H[xn]!==void 0)return H[xn];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+xn+"'")}let Zn=Ht;if(Ht===H.RED&&(In===H.FLOAT&&(Zn=H.R32F),In===H.HALF_FLOAT&&(Zn=H.R16F),In===H.UNSIGNED_BYTE&&(Zn=H.R8)),Ht===H.RED_INTEGER&&(In===H.UNSIGNED_BYTE&&(Zn=H.R8UI),In===H.UNSIGNED_SHORT&&(Zn=H.R16UI),In===H.UNSIGNED_INT&&(Zn=H.R32UI),In===H.BYTE&&(Zn=H.R8I),In===H.SHORT&&(Zn=H.R16I),In===H.INT&&(Zn=H.R32I)),Ht===H.RG&&(In===H.FLOAT&&(Zn=H.RG32F),In===H.HALF_FLOAT&&(Zn=H.RG16F),In===H.UNSIGNED_BYTE&&(Zn=H.RG8)),Ht===H.RG_INTEGER&&(In===H.UNSIGNED_BYTE&&(Zn=H.RG8UI),In===H.UNSIGNED_SHORT&&(Zn=H.RG16UI),In===H.UNSIGNED_INT&&(Zn=H.RG32UI),In===H.BYTE&&(Zn=H.RG8I),In===H.SHORT&&(Zn=H.RG16I),In===H.INT&&(Zn=H.RG32I)),Ht===H.RGB&&In===H.UNSIGNED_INT_5_9_9_9_REV&&(Zn=H.RGB9_E5),Ht===H.RGBA){const Dr=Hn?LinearTransfer$1:ColorManagement$1.getTransfer(er);In===H.FLOAT&&(Zn=H.RGBA32F),In===H.HALF_FLOAT&&(Zn=H.RGBA16F),In===H.UNSIGNED_BYTE&&(Zn=Dr===SRGBTransfer$1?H.SRGB8_ALPHA8:H.RGBA8),In===H.UNSIGNED_SHORT_4_4_4_4&&(Zn=H.RGBA4),In===H.UNSIGNED_SHORT_5_5_5_1&&(Zn=H.RGB5_A1)}return(Zn===H.R16F||Zn===H.R32F||Zn===H.RG16F||Zn===H.RG32F||Zn===H.RGBA16F||Zn===H.RGBA32F)&&_.get("EXT_color_buffer_float"),Zn}function Xe(xn,Ht){let In;return xn?Ht===null||Ht===UnsignedIntType||Ht===UnsignedInt248Type?In=H.DEPTH24_STENCIL8:Ht===FloatType$1?In=H.DEPTH32F_STENCIL8:Ht===UnsignedShortType&&(In=H.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):Ht===null||Ht===UnsignedIntType||Ht===UnsignedInt248Type?In=H.DEPTH_COMPONENT24:Ht===FloatType$1?In=H.DEPTH_COMPONENT32F:Ht===UnsignedShortType&&(In=H.DEPTH_COMPONENT16),In}function Ye(xn,Ht){return Be(xn)===!0||xn.isFramebufferTexture&&xn.minFilter!==NearestFilter$1&&xn.minFilter!==LinearFilter$1?Math.log2(Math.max(Ht.width,Ht.height))+1:xn.mipmaps!==void 0&&xn.mipmaps.length>0?xn.mipmaps.length:xn.isCompressedTexture&&Array.isArray(xn.image)?Ht.mipmaps.length:1}function Qe(xn){const Ht=xn.target;Ht.removeEventListener("dispose",Qe),ot(Ht),Ht.isVideoTexture&&ve.delete(Ht)}function rt(xn){const Ht=xn.target;Ht.removeEventListener("dispose",rt),mt(Ht)}function ot(xn){const Ht=$.get(xn);if(Ht.__webglInit===void 0)return;const In=xn.source,er=Ee.get(In);if(er){const Hn=er[Ht.__cacheKey];Hn.usedTimes--,Hn.usedTimes===0&&ct(xn),Object.keys(er).length===0&&Ee.delete(In)}$.remove(xn)}function ct(xn){const Ht=$.get(xn);H.deleteTexture(Ht.__webglTexture);const In=xn.source,er=Ee.get(In);delete er[Ht.__cacheKey],ae.memory.textures--}function mt(xn){const Ht=$.get(xn);if(xn.depthTexture&&xn.depthTexture.dispose(),xn.isWebGLCubeRenderTarget)for(let er=0;er<6;er++){if(Array.isArray(Ht.__webglFramebuffer[er]))for(let Hn=0;Hn<Ht.__webglFramebuffer[er].length;Hn++)H.deleteFramebuffer(Ht.__webglFramebuffer[er][Hn]);else H.deleteFramebuffer(Ht.__webglFramebuffer[er]);Ht.__webglDepthbuffer&&H.deleteRenderbuffer(Ht.__webglDepthbuffer[er])}else{if(Array.isArray(Ht.__webglFramebuffer))for(let er=0;er<Ht.__webglFramebuffer.length;er++)H.deleteFramebuffer(Ht.__webglFramebuffer[er]);else H.deleteFramebuffer(Ht.__webglFramebuffer);if(Ht.__webglDepthbuffer&&H.deleteRenderbuffer(Ht.__webglDepthbuffer),Ht.__webglMultisampledFramebuffer&&H.deleteFramebuffer(Ht.__webglMultisampledFramebuffer),Ht.__webglColorRenderbuffer)for(let er=0;er<Ht.__webglColorRenderbuffer.length;er++)Ht.__webglColorRenderbuffer[er]&&H.deleteRenderbuffer(Ht.__webglColorRenderbuffer[er]);Ht.__webglDepthRenderbuffer&&H.deleteRenderbuffer(Ht.__webglDepthRenderbuffer)}const In=xn.textures;for(let er=0,Hn=In.length;er<Hn;er++){const Zn=$.get(In[er]);Zn.__webglTexture&&(H.deleteTexture(Zn.__webglTexture),ae.memory.textures--),$.remove(In[er])}$.remove(xn)}let _t=0;function Lt(){_t=0}function Vt(){const xn=_t;return xn>=ee.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+xn+" texture units while this GPU supports only "+ee.maxTextures),_t+=1,xn}function Gt(xn){const Ht=[];return Ht.push(xn.wrapS),Ht.push(xn.wrapT),Ht.push(xn.wrapR||0),Ht.push(xn.magFilter),Ht.push(xn.minFilter),Ht.push(xn.anisotropy),Ht.push(xn.internalFormat),Ht.push(xn.format),Ht.push(xn.type),Ht.push(xn.generateMipmaps),Ht.push(xn.premultiplyAlpha),Ht.push(xn.flipY),Ht.push(xn.unpackAlignment),Ht.push(xn.colorSpace),Ht.join()}function $t(xn,Ht){const In=$.get(xn);if(xn.isVideoTexture&&ai(xn),xn.isRenderTargetTexture===!1&&xn.version>0&&In.__version!==xn.version){const er=xn.image;if(er===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(er.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{cn(In,xn,Ht);return}}b.bindTexture(H.TEXTURE_2D,In.__webglTexture,H.TEXTURE0+Ht)}function Qt(xn,Ht){const In=$.get(xn);if(xn.version>0&&In.__version!==xn.version){cn(In,xn,Ht);return}b.bindTexture(H.TEXTURE_2D_ARRAY,In.__webglTexture,H.TEXTURE0+Ht)}function vt(xn,Ht){const In=$.get(xn);if(xn.version>0&&In.__version!==xn.version){cn(In,xn,Ht);return}b.bindTexture(H.TEXTURE_3D,In.__webglTexture,H.TEXTURE0+Ht)}function It(xn,Ht){const In=$.get(xn);if(xn.version>0&&In.__version!==xn.version){en(In,xn,Ht);return}b.bindTexture(H.TEXTURE_CUBE_MAP,In.__webglTexture,H.TEXTURE0+Ht)}const gt={[RepeatWrapping$1]:H.REPEAT,[ClampToEdgeWrapping$1]:H.CLAMP_TO_EDGE,[MirroredRepeatWrapping$1]:H.MIRRORED_REPEAT},Tt={[NearestFilter$1]:H.NEAREST,[NearestMipmapNearestFilter$1]:H.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter$1]:H.NEAREST_MIPMAP_LINEAR,[LinearFilter$1]:H.LINEAR,[LinearMipmapNearestFilter$1]:H.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter$1]:H.LINEAR_MIPMAP_LINEAR},Ct={[NeverCompare]:H.NEVER,[AlwaysCompare]:H.ALWAYS,[LessCompare]:H.LESS,[LessEqualCompare]:H.LEQUAL,[EqualCompare]:H.EQUAL,[GreaterEqualCompare]:H.GEQUAL,[GreaterCompare]:H.GREATER,[NotEqualCompare]:H.NOTEQUAL};function Ft(xn,Ht){if(Ht.type===FloatType$1&&_.has("OES_texture_float_linear")===!1&&(Ht.magFilter===LinearFilter$1||Ht.magFilter===LinearMipmapNearestFilter$1||Ht.magFilter===NearestMipmapLinearFilter$1||Ht.magFilter===LinearMipmapLinearFilter$1||Ht.minFilter===LinearFilter$1||Ht.minFilter===LinearMipmapNearestFilter$1||Ht.minFilter===NearestMipmapLinearFilter$1||Ht.minFilter===LinearMipmapLinearFilter$1)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),H.texParameteri(xn,H.TEXTURE_WRAP_S,gt[Ht.wrapS]),H.texParameteri(xn,H.TEXTURE_WRAP_T,gt[Ht.wrapT]),(xn===H.TEXTURE_3D||xn===H.TEXTURE_2D_ARRAY)&&H.texParameteri(xn,H.TEXTURE_WRAP_R,gt[Ht.wrapR]),H.texParameteri(xn,H.TEXTURE_MAG_FILTER,Tt[Ht.magFilter]),H.texParameteri(xn,H.TEXTURE_MIN_FILTER,Tt[Ht.minFilter]),Ht.compareFunction&&(H.texParameteri(xn,H.TEXTURE_COMPARE_MODE,H.COMPARE_REF_TO_TEXTURE),H.texParameteri(xn,H.TEXTURE_COMPARE_FUNC,Ct[Ht.compareFunction])),_.has("EXT_texture_filter_anisotropic")===!0){if(Ht.magFilter===NearestFilter$1||Ht.minFilter!==NearestMipmapLinearFilter$1&&Ht.minFilter!==LinearMipmapLinearFilter$1||Ht.type===FloatType$1&&_.has("OES_texture_float_linear")===!1)return;if(Ht.anisotropy>1||$.get(Ht).__currentAnisotropy){const In=_.get("EXT_texture_filter_anisotropic");H.texParameterf(xn,In.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ht.anisotropy,ee.getMaxAnisotropy())),$.get(Ht).__currentAnisotropy=Ht.anisotropy}}}function sn(xn,Ht){let In=!1;xn.__webglInit===void 0&&(xn.__webglInit=!0,Ht.addEventListener("dispose",Qe));const er=Ht.source;let Hn=Ee.get(er);Hn===void 0&&(Hn={},Ee.set(er,Hn));const Zn=Gt(Ht);if(Zn!==xn.__cacheKey){Hn[Zn]===void 0&&(Hn[Zn]={texture:H.createTexture(),usedTimes:0},ae.memory.textures++,In=!0),Hn[Zn].usedTimes++;const Dr=Hn[xn.__cacheKey];Dr!==void 0&&(Hn[xn.__cacheKey].usedTimes--,Dr.usedTimes===0&&ct(Ht)),xn.__cacheKey=Zn,xn.__webglTexture=Hn[Zn].texture}return In}function cn(xn,Ht,In){let er=H.TEXTURE_2D;(Ht.isDataArrayTexture||Ht.isCompressedArrayTexture)&&(er=H.TEXTURE_2D_ARRAY),Ht.isData3DTexture&&(er=H.TEXTURE_3D);const Hn=sn(xn,Ht),Zn=Ht.source;b.bindTexture(er,xn.__webglTexture,H.TEXTURE0+In);const Dr=$.get(Zn);if(Zn.version!==Dr.__version||Hn===!0){b.activeTexture(H.TEXTURE0+In);const zn=ColorManagement$1.getPrimaries(ColorManagement$1.workingColorSpace),Nr=Ht.colorSpace===NoColorSpace$1?null:ColorManagement$1.getPrimaries(Ht.colorSpace),vr=Ht.colorSpace===NoColorSpace$1||zn===Nr?H.NONE:H.BROWSER_DEFAULT_WEBGL;H.pixelStorei(H.UNPACK_FLIP_Y_WEBGL,Ht.flipY),H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ht.premultiplyAlpha),H.pixelStorei(H.UNPACK_ALIGNMENT,Ht.unpackAlignment),H.pixelStorei(H.UNPACK_COLORSPACE_CONVERSION_WEBGL,vr);let Sr=De(Ht.image,!1,ee.maxTextureSize);Sr=Hr(Ht,Sr);const zr=re.convert(Ht.format,Ht.colorSpace),gi=re.convert(Ht.type);let oi=qe(Ht.internalFormat,zr,gi,Ht.colorSpace,Ht.isVideoTexture);Ft(er,Ht);let Gr;const ri=Ht.mipmaps,yi=Ht.isVideoTexture!==!0,Ci=Dr.__version===void 0||Hn===!0,wn=Zn.dataReady,Pr=Ye(Ht,Sr);if(Ht.isDepthTexture)oi=Xe(Ht.format===DepthStencilFormat,Ht.type),Ci&&(yi?b.texStorage2D(H.TEXTURE_2D,1,oi,Sr.width,Sr.height):b.texImage2D(H.TEXTURE_2D,0,oi,Sr.width,Sr.height,0,zr,gi,null));else if(Ht.isDataTexture)if(ri.length>0){yi&&Ci&&b.texStorage2D(H.TEXTURE_2D,Pr,oi,ri[0].width,ri[0].height);for(let xr=0,gr=ri.length;xr<gr;xr++)Gr=ri[xr],yi?wn&&b.texSubImage2D(H.TEXTURE_2D,xr,0,0,Gr.width,Gr.height,zr,gi,Gr.data):b.texImage2D(H.TEXTURE_2D,xr,oi,Gr.width,Gr.height,0,zr,gi,Gr.data);Ht.generateMipmaps=!1}else yi?(Ci&&b.texStorage2D(H.TEXTURE_2D,Pr,oi,Sr.width,Sr.height),wn&&b.texSubImage2D(H.TEXTURE_2D,0,0,0,Sr.width,Sr.height,zr,gi,Sr.data)):b.texImage2D(H.TEXTURE_2D,0,oi,Sr.width,Sr.height,0,zr,gi,Sr.data);else if(Ht.isCompressedTexture)if(Ht.isCompressedArrayTexture){yi&&Ci&&b.texStorage3D(H.TEXTURE_2D_ARRAY,Pr,oi,ri[0].width,ri[0].height,Sr.depth);for(let xr=0,gr=ri.length;xr<gr;xr++)if(Gr=ri[xr],Ht.format!==RGBAFormat$1)if(zr!==null)if(yi){if(wn)if(Ht.layerUpdates.size>0){const Mr=getByteLength(Gr.width,Gr.height,Ht.format,Ht.type);for(const ci of Ht.layerUpdates){const fi=Gr.data.subarray(ci*Mr/Gr.data.BYTES_PER_ELEMENT,(ci+1)*Mr/Gr.data.BYTES_PER_ELEMENT);b.compressedTexSubImage3D(H.TEXTURE_2D_ARRAY,xr,0,0,ci,Gr.width,Gr.height,1,zr,fi,0,0)}Ht.clearLayerUpdates()}else b.compressedTexSubImage3D(H.TEXTURE_2D_ARRAY,xr,0,0,0,Gr.width,Gr.height,Sr.depth,zr,Gr.data,0,0)}else b.compressedTexImage3D(H.TEXTURE_2D_ARRAY,xr,oi,Gr.width,Gr.height,Sr.depth,0,Gr.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else yi?wn&&b.texSubImage3D(H.TEXTURE_2D_ARRAY,xr,0,0,0,Gr.width,Gr.height,Sr.depth,zr,gi,Gr.data):b.texImage3D(H.TEXTURE_2D_ARRAY,xr,oi,Gr.width,Gr.height,Sr.depth,0,zr,gi,Gr.data)}else{yi&&Ci&&b.texStorage2D(H.TEXTURE_2D,Pr,oi,ri[0].width,ri[0].height);for(let xr=0,gr=ri.length;xr<gr;xr++)Gr=ri[xr],Ht.format!==RGBAFormat$1?zr!==null?yi?wn&&b.compressedTexSubImage2D(H.TEXTURE_2D,xr,0,0,Gr.width,Gr.height,zr,Gr.data):b.compressedTexImage2D(H.TEXTURE_2D,xr,oi,Gr.width,Gr.height,0,Gr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):yi?wn&&b.texSubImage2D(H.TEXTURE_2D,xr,0,0,Gr.width,Gr.height,zr,gi,Gr.data):b.texImage2D(H.TEXTURE_2D,xr,oi,Gr.width,Gr.height,0,zr,gi,Gr.data)}else if(Ht.isDataArrayTexture)if(yi){if(Ci&&b.texStorage3D(H.TEXTURE_2D_ARRAY,Pr,oi,Sr.width,Sr.height,Sr.depth),wn)if(Ht.layerUpdates.size>0){const xr=getByteLength(Sr.width,Sr.height,Ht.format,Ht.type);for(const gr of Ht.layerUpdates){const Mr=Sr.data.subarray(gr*xr/Sr.data.BYTES_PER_ELEMENT,(gr+1)*xr/Sr.data.BYTES_PER_ELEMENT);b.texSubImage3D(H.TEXTURE_2D_ARRAY,0,0,0,gr,Sr.width,Sr.height,1,zr,gi,Mr)}Ht.clearLayerUpdates()}else b.texSubImage3D(H.TEXTURE_2D_ARRAY,0,0,0,0,Sr.width,Sr.height,Sr.depth,zr,gi,Sr.data)}else b.texImage3D(H.TEXTURE_2D_ARRAY,0,oi,Sr.width,Sr.height,Sr.depth,0,zr,gi,Sr.data);else if(Ht.isData3DTexture)yi?(Ci&&b.texStorage3D(H.TEXTURE_3D,Pr,oi,Sr.width,Sr.height,Sr.depth),wn&&b.texSubImage3D(H.TEXTURE_3D,0,0,0,0,Sr.width,Sr.height,Sr.depth,zr,gi,Sr.data)):b.texImage3D(H.TEXTURE_3D,0,oi,Sr.width,Sr.height,Sr.depth,0,zr,gi,Sr.data);else if(Ht.isFramebufferTexture){if(Ci)if(yi)b.texStorage2D(H.TEXTURE_2D,Pr,oi,Sr.width,Sr.height);else{let xr=Sr.width,gr=Sr.height;for(let Mr=0;Mr<Pr;Mr++)b.texImage2D(H.TEXTURE_2D,Mr,oi,xr,gr,0,zr,gi,null),xr>>=1,gr>>=1}}else if(ri.length>0){if(yi&&Ci){const xr=Vr(ri[0]);b.texStorage2D(H.TEXTURE_2D,Pr,oi,xr.width,xr.height)}for(let xr=0,gr=ri.length;xr<gr;xr++)Gr=ri[xr],yi?wn&&b.texSubImage2D(H.TEXTURE_2D,xr,0,0,zr,gi,Gr):b.texImage2D(H.TEXTURE_2D,xr,oi,zr,gi,Gr);Ht.generateMipmaps=!1}else if(yi){if(Ci){const xr=Vr(Sr);b.texStorage2D(H.TEXTURE_2D,Pr,oi,xr.width,xr.height)}wn&&b.texSubImage2D(H.TEXTURE_2D,0,0,0,zr,gi,Sr)}else b.texImage2D(H.TEXTURE_2D,0,oi,zr,gi,Sr);Be(Ht)&&Ne(er),Dr.__version=Zn.version,Ht.onUpdate&&Ht.onUpdate(Ht)}xn.__version=Ht.version}function en(xn,Ht,In){if(Ht.image.length!==6)return;const er=sn(xn,Ht),Hn=Ht.source;b.bindTexture(H.TEXTURE_CUBE_MAP,xn.__webglTexture,H.TEXTURE0+In);const Zn=$.get(Hn);if(Hn.version!==Zn.__version||er===!0){b.activeTexture(H.TEXTURE0+In);const Dr=ColorManagement$1.getPrimaries(ColorManagement$1.workingColorSpace),zn=Ht.colorSpace===NoColorSpace$1?null:ColorManagement$1.getPrimaries(Ht.colorSpace),Nr=Ht.colorSpace===NoColorSpace$1||Dr===zn?H.NONE:H.BROWSER_DEFAULT_WEBGL;H.pixelStorei(H.UNPACK_FLIP_Y_WEBGL,Ht.flipY),H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ht.premultiplyAlpha),H.pixelStorei(H.UNPACK_ALIGNMENT,Ht.unpackAlignment),H.pixelStorei(H.UNPACK_COLORSPACE_CONVERSION_WEBGL,Nr);const vr=Ht.isCompressedTexture||Ht.image[0].isCompressedTexture,Sr=Ht.image[0]&&Ht.image[0].isDataTexture,zr=[];for(let gr=0;gr<6;gr++)!vr&&!Sr?zr[gr]=De(Ht.image[gr],!0,ee.maxCubemapSize):zr[gr]=Sr?Ht.image[gr].image:Ht.image[gr],zr[gr]=Hr(Ht,zr[gr]);const gi=zr[0],oi=re.convert(Ht.format,Ht.colorSpace),Gr=re.convert(Ht.type),ri=qe(Ht.internalFormat,oi,Gr,Ht.colorSpace),yi=Ht.isVideoTexture!==!0,Ci=Zn.__version===void 0||er===!0,wn=Hn.dataReady;let Pr=Ye(Ht,gi);Ft(H.TEXTURE_CUBE_MAP,Ht);let xr;if(vr){yi&&Ci&&b.texStorage2D(H.TEXTURE_CUBE_MAP,Pr,ri,gi.width,gi.height);for(let gr=0;gr<6;gr++){xr=zr[gr].mipmaps;for(let Mr=0;Mr<xr.length;Mr++){const ci=xr[Mr];Ht.format!==RGBAFormat$1?oi!==null?yi?wn&&b.compressedTexSubImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+gr,Mr,0,0,ci.width,ci.height,oi,ci.data):b.compressedTexImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+gr,Mr,ri,ci.width,ci.height,0,ci.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):yi?wn&&b.texSubImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+gr,Mr,0,0,ci.width,ci.height,oi,Gr,ci.data):b.texImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+gr,Mr,ri,ci.width,ci.height,0,oi,Gr,ci.data)}}}else{if(xr=Ht.mipmaps,yi&&Ci){xr.length>0&&Pr++;const gr=Vr(zr[0]);b.texStorage2D(H.TEXTURE_CUBE_MAP,Pr,ri,gr.width,gr.height)}for(let gr=0;gr<6;gr++)if(Sr){yi?wn&&b.texSubImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+gr,0,0,0,zr[gr].width,zr[gr].height,oi,Gr,zr[gr].data):b.texImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+gr,0,ri,zr[gr].width,zr[gr].height,0,oi,Gr,zr[gr].data);for(let Mr=0;Mr<xr.length;Mr++){const fi=xr[Mr].image[gr].image;yi?wn&&b.texSubImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+gr,Mr+1,0,0,fi.width,fi.height,oi,Gr,fi.data):b.texImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+gr,Mr+1,ri,fi.width,fi.height,0,oi,Gr,fi.data)}}else{yi?wn&&b.texSubImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+gr,0,0,0,oi,Gr,zr[gr]):b.texImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+gr,0,ri,oi,Gr,zr[gr]);for(let Mr=0;Mr<xr.length;Mr++){const ci=xr[Mr];yi?wn&&b.texSubImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+gr,Mr+1,0,0,oi,Gr,ci.image[gr]):b.texImage2D(H.TEXTURE_CUBE_MAP_POSITIVE_X+gr,Mr+1,ri,oi,Gr,ci.image[gr])}}}Be(Ht)&&Ne(H.TEXTURE_CUBE_MAP),Zn.__version=Hn.version,Ht.onUpdate&&Ht.onUpdate(Ht)}xn.__version=Ht.version}function yn(xn,Ht,In,er,Hn,Zn){const Dr=re.convert(In.format,In.colorSpace),zn=re.convert(In.type),Nr=qe(In.internalFormat,Dr,zn,In.colorSpace);if(!$.get(Ht).__hasExternalTextures){const Sr=Math.max(1,Ht.width>>Zn),zr=Math.max(1,Ht.height>>Zn);Hn===H.TEXTURE_3D||Hn===H.TEXTURE_2D_ARRAY?b.texImage3D(Hn,Zn,Nr,Sr,zr,Ht.depth,0,Dr,zn,null):b.texImage2D(Hn,Zn,Nr,Sr,zr,0,Dr,zn,null)}b.bindFramebuffer(H.FRAMEBUFFER,xn),Ir(Ht)?xe.framebufferTexture2DMultisampleEXT(H.FRAMEBUFFER,er,Hn,$.get(In).__webglTexture,0,Qr(Ht)):(Hn===H.TEXTURE_2D||Hn>=H.TEXTURE_CUBE_MAP_POSITIVE_X&&Hn<=H.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&H.framebufferTexture2D(H.FRAMEBUFFER,er,Hn,$.get(In).__webglTexture,Zn),b.bindFramebuffer(H.FRAMEBUFFER,null)}function Pn(xn,Ht,In){if(H.bindRenderbuffer(H.RENDERBUFFER,xn),Ht.depthBuffer){const er=Ht.depthTexture,Hn=er&&er.isDepthTexture?er.type:null,Zn=Xe(Ht.stencilBuffer,Hn),Dr=Ht.stencilBuffer?H.DEPTH_STENCIL_ATTACHMENT:H.DEPTH_ATTACHMENT,zn=Qr(Ht);Ir(Ht)?xe.renderbufferStorageMultisampleEXT(H.RENDERBUFFER,zn,Zn,Ht.width,Ht.height):In?H.renderbufferStorageMultisample(H.RENDERBUFFER,zn,Zn,Ht.width,Ht.height):H.renderbufferStorage(H.RENDERBUFFER,Zn,Ht.width,Ht.height),H.framebufferRenderbuffer(H.FRAMEBUFFER,Dr,H.RENDERBUFFER,xn)}else{const er=Ht.textures;for(let Hn=0;Hn<er.length;Hn++){const Zn=er[Hn],Dr=re.convert(Zn.format,Zn.colorSpace),zn=re.convert(Zn.type),Nr=qe(Zn.internalFormat,Dr,zn,Zn.colorSpace),vr=Qr(Ht);In&&Ir(Ht)===!1?H.renderbufferStorageMultisample(H.RENDERBUFFER,vr,Nr,Ht.width,Ht.height):Ir(Ht)?xe.renderbufferStorageMultisampleEXT(H.RENDERBUFFER,vr,Nr,Ht.width,Ht.height):H.renderbufferStorage(H.RENDERBUFFER,Nr,Ht.width,Ht.height)}}H.bindRenderbuffer(H.RENDERBUFFER,null)}function tr(xn,Ht){if(Ht&&Ht.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(b.bindFramebuffer(H.FRAMEBUFFER,xn),!(Ht.depthTexture&&Ht.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!$.get(Ht.depthTexture).__webglTexture||Ht.depthTexture.image.width!==Ht.width||Ht.depthTexture.image.height!==Ht.height)&&(Ht.depthTexture.image.width=Ht.width,Ht.depthTexture.image.height=Ht.height,Ht.depthTexture.needsUpdate=!0),$t(Ht.depthTexture,0);const er=$.get(Ht.depthTexture).__webglTexture,Hn=Qr(Ht);if(Ht.depthTexture.format===DepthFormat)Ir(Ht)?xe.framebufferTexture2DMultisampleEXT(H.FRAMEBUFFER,H.DEPTH_ATTACHMENT,H.TEXTURE_2D,er,0,Hn):H.framebufferTexture2D(H.FRAMEBUFFER,H.DEPTH_ATTACHMENT,H.TEXTURE_2D,er,0);else if(Ht.depthTexture.format===DepthStencilFormat)Ir(Ht)?xe.framebufferTexture2DMultisampleEXT(H.FRAMEBUFFER,H.DEPTH_STENCIL_ATTACHMENT,H.TEXTURE_2D,er,0,Hn):H.framebufferTexture2D(H.FRAMEBUFFER,H.DEPTH_STENCIL_ATTACHMENT,H.TEXTURE_2D,er,0);else throw new Error("Unknown depthTexture format")}function nr(xn){const Ht=$.get(xn),In=xn.isWebGLCubeRenderTarget===!0;if(Ht.__boundDepthTexture!==xn.depthTexture){const er=xn.depthTexture;if(Ht.__depthDisposeCallback&&Ht.__depthDisposeCallback(),er){const Hn=()=>{delete Ht.__boundDepthTexture,delete Ht.__depthDisposeCallback,er.removeEventListener("dispose",Hn)};er.addEventListener("dispose",Hn),Ht.__depthDisposeCallback=Hn}Ht.__boundDepthTexture=er}if(xn.depthTexture&&!Ht.__autoAllocateDepthBuffer){if(In)throw new Error("target.depthTexture not supported in Cube render targets");tr(Ht.__webglFramebuffer,xn)}else if(In){Ht.__webglDepthbuffer=[];for(let er=0;er<6;er++)if(b.bindFramebuffer(H.FRAMEBUFFER,Ht.__webglFramebuffer[er]),Ht.__webglDepthbuffer[er]===void 0)Ht.__webglDepthbuffer[er]=H.createRenderbuffer(),Pn(Ht.__webglDepthbuffer[er],xn,!1);else{const Hn=xn.stencilBuffer?H.DEPTH_STENCIL_ATTACHMENT:H.DEPTH_ATTACHMENT,Zn=Ht.__webglDepthbuffer[er];H.bindRenderbuffer(H.RENDERBUFFER,Zn),H.framebufferRenderbuffer(H.FRAMEBUFFER,Hn,H.RENDERBUFFER,Zn)}}else if(b.bindFramebuffer(H.FRAMEBUFFER,Ht.__webglFramebuffer),Ht.__webglDepthbuffer===void 0)Ht.__webglDepthbuffer=H.createRenderbuffer(),Pn(Ht.__webglDepthbuffer,xn,!1);else{const er=xn.stencilBuffer?H.DEPTH_STENCIL_ATTACHMENT:H.DEPTH_ATTACHMENT,Hn=Ht.__webglDepthbuffer;H.bindRenderbuffer(H.RENDERBUFFER,Hn),H.framebufferRenderbuffer(H.FRAMEBUFFER,er,H.RENDERBUFFER,Hn)}b.bindFramebuffer(H.FRAMEBUFFER,null)}function Fr(xn,Ht,In){const er=$.get(xn);Ht!==void 0&&yn(er.__webglFramebuffer,xn,xn.texture,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,0),In!==void 0&&nr(xn)}function Ur(xn){const Ht=xn.texture,In=$.get(xn),er=$.get(Ht);xn.addEventListener("dispose",rt);const Hn=xn.textures,Zn=xn.isWebGLCubeRenderTarget===!0,Dr=Hn.length>1;if(Dr||(er.__webglTexture===void 0&&(er.__webglTexture=H.createTexture()),er.__version=Ht.version,ae.memory.textures++),Zn){In.__webglFramebuffer=[];for(let zn=0;zn<6;zn++)if(Ht.mipmaps&&Ht.mipmaps.length>0){In.__webglFramebuffer[zn]=[];for(let Nr=0;Nr<Ht.mipmaps.length;Nr++)In.__webglFramebuffer[zn][Nr]=H.createFramebuffer()}else In.__webglFramebuffer[zn]=H.createFramebuffer()}else{if(Ht.mipmaps&&Ht.mipmaps.length>0){In.__webglFramebuffer=[];for(let zn=0;zn<Ht.mipmaps.length;zn++)In.__webglFramebuffer[zn]=H.createFramebuffer()}else In.__webglFramebuffer=H.createFramebuffer();if(Dr)for(let zn=0,Nr=Hn.length;zn<Nr;zn++){const vr=$.get(Hn[zn]);vr.__webglTexture===void 0&&(vr.__webglTexture=H.createTexture(),ae.memory.textures++)}if(xn.samples>0&&Ir(xn)===!1){In.__webglMultisampledFramebuffer=H.createFramebuffer(),In.__webglColorRenderbuffer=[],b.bindFramebuffer(H.FRAMEBUFFER,In.__webglMultisampledFramebuffer);for(let zn=0;zn<Hn.length;zn++){const Nr=Hn[zn];In.__webglColorRenderbuffer[zn]=H.createRenderbuffer(),H.bindRenderbuffer(H.RENDERBUFFER,In.__webglColorRenderbuffer[zn]);const vr=re.convert(Nr.format,Nr.colorSpace),Sr=re.convert(Nr.type),zr=qe(Nr.internalFormat,vr,Sr,Nr.colorSpace,xn.isXRRenderTarget===!0),gi=Qr(xn);H.renderbufferStorageMultisample(H.RENDERBUFFER,gi,zr,xn.width,xn.height),H.framebufferRenderbuffer(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0+zn,H.RENDERBUFFER,In.__webglColorRenderbuffer[zn])}H.bindRenderbuffer(H.RENDERBUFFER,null),xn.depthBuffer&&(In.__webglDepthRenderbuffer=H.createRenderbuffer(),Pn(In.__webglDepthRenderbuffer,xn,!0)),b.bindFramebuffer(H.FRAMEBUFFER,null)}}if(Zn){b.bindTexture(H.TEXTURE_CUBE_MAP,er.__webglTexture),Ft(H.TEXTURE_CUBE_MAP,Ht);for(let zn=0;zn<6;zn++)if(Ht.mipmaps&&Ht.mipmaps.length>0)for(let Nr=0;Nr<Ht.mipmaps.length;Nr++)yn(In.__webglFramebuffer[zn][Nr],xn,Ht,H.COLOR_ATTACHMENT0,H.TEXTURE_CUBE_MAP_POSITIVE_X+zn,Nr);else yn(In.__webglFramebuffer[zn],xn,Ht,H.COLOR_ATTACHMENT0,H.TEXTURE_CUBE_MAP_POSITIVE_X+zn,0);Be(Ht)&&Ne(H.TEXTURE_CUBE_MAP),b.unbindTexture()}else if(Dr){for(let zn=0,Nr=Hn.length;zn<Nr;zn++){const vr=Hn[zn],Sr=$.get(vr);b.bindTexture(H.TEXTURE_2D,Sr.__webglTexture),Ft(H.TEXTURE_2D,vr),yn(In.__webglFramebuffer,xn,vr,H.COLOR_ATTACHMENT0+zn,H.TEXTURE_2D,0),Be(vr)&&Ne(H.TEXTURE_2D)}b.unbindTexture()}else{let zn=H.TEXTURE_2D;if((xn.isWebGL3DRenderTarget||xn.isWebGLArrayRenderTarget)&&(zn=xn.isWebGL3DRenderTarget?H.TEXTURE_3D:H.TEXTURE_2D_ARRAY),b.bindTexture(zn,er.__webglTexture),Ft(zn,Ht),Ht.mipmaps&&Ht.mipmaps.length>0)for(let Nr=0;Nr<Ht.mipmaps.length;Nr++)yn(In.__webglFramebuffer[Nr],xn,Ht,H.COLOR_ATTACHMENT0,zn,Nr);else yn(In.__webglFramebuffer,xn,Ht,H.COLOR_ATTACHMENT0,zn,0);Be(Ht)&&Ne(zn),b.unbindTexture()}xn.depthBuffer&&nr(xn)}function Kr(xn){const Ht=xn.textures;for(let In=0,er=Ht.length;In<er;In++){const Hn=Ht[In];if(Be(Hn)){const Zn=xn.isWebGLCubeRenderTarget?H.TEXTURE_CUBE_MAP:H.TEXTURE_2D,Dr=$.get(Hn).__webglTexture;b.bindTexture(Zn,Dr),Ne(Zn),b.unbindTexture()}}}const on=[],qr=[];function rr(xn){if(xn.samples>0){if(Ir(xn)===!1){const Ht=xn.textures,In=xn.width,er=xn.height;let Hn=H.COLOR_BUFFER_BIT;const Zn=xn.stencilBuffer?H.DEPTH_STENCIL_ATTACHMENT:H.DEPTH_ATTACHMENT,Dr=$.get(xn),zn=Ht.length>1;if(zn)for(let Nr=0;Nr<Ht.length;Nr++)b.bindFramebuffer(H.FRAMEBUFFER,Dr.__webglMultisampledFramebuffer),H.framebufferRenderbuffer(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0+Nr,H.RENDERBUFFER,null),b.bindFramebuffer(H.FRAMEBUFFER,Dr.__webglFramebuffer),H.framebufferTexture2D(H.DRAW_FRAMEBUFFER,H.COLOR_ATTACHMENT0+Nr,H.TEXTURE_2D,null,0);b.bindFramebuffer(H.READ_FRAMEBUFFER,Dr.__webglMultisampledFramebuffer),b.bindFramebuffer(H.DRAW_FRAMEBUFFER,Dr.__webglFramebuffer);for(let Nr=0;Nr<Ht.length;Nr++){if(xn.resolveDepthBuffer&&(xn.depthBuffer&&(Hn|=H.DEPTH_BUFFER_BIT),xn.stencilBuffer&&xn.resolveStencilBuffer&&(Hn|=H.STENCIL_BUFFER_BIT)),zn){H.framebufferRenderbuffer(H.READ_FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.RENDERBUFFER,Dr.__webglColorRenderbuffer[Nr]);const vr=$.get(Ht[Nr]).__webglTexture;H.framebufferTexture2D(H.DRAW_FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,vr,0)}H.blitFramebuffer(0,0,In,er,0,0,In,er,Hn,H.NEAREST),le===!0&&(on.length=0,qr.length=0,on.push(H.COLOR_ATTACHMENT0+Nr),xn.depthBuffer&&xn.resolveDepthBuffer===!1&&(on.push(Zn),qr.push(Zn),H.invalidateFramebuffer(H.DRAW_FRAMEBUFFER,qr)),H.invalidateFramebuffer(H.READ_FRAMEBUFFER,on))}if(b.bindFramebuffer(H.READ_FRAMEBUFFER,null),b.bindFramebuffer(H.DRAW_FRAMEBUFFER,null),zn)for(let Nr=0;Nr<Ht.length;Nr++){b.bindFramebuffer(H.FRAMEBUFFER,Dr.__webglMultisampledFramebuffer),H.framebufferRenderbuffer(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0+Nr,H.RENDERBUFFER,Dr.__webglColorRenderbuffer[Nr]);const vr=$.get(Ht[Nr]).__webglTexture;b.bindFramebuffer(H.FRAMEBUFFER,Dr.__webglFramebuffer),H.framebufferTexture2D(H.DRAW_FRAMEBUFFER,H.COLOR_ATTACHMENT0+Nr,H.TEXTURE_2D,vr,0)}b.bindFramebuffer(H.DRAW_FRAMEBUFFER,Dr.__webglMultisampledFramebuffer)}else if(xn.depthBuffer&&xn.resolveDepthBuffer===!1&&le){const Ht=xn.stencilBuffer?H.DEPTH_STENCIL_ATTACHMENT:H.DEPTH_ATTACHMENT;H.invalidateFramebuffer(H.DRAW_FRAMEBUFFER,[Ht])}}}function Qr(xn){return Math.min(ee.maxSamples,xn.samples)}function Ir(xn){const Ht=$.get(xn);return xn.samples>0&&_.has("WEBGL_multisampled_render_to_texture")===!0&&Ht.__useRenderToTexture!==!1}function ai(xn){const Ht=ae.render.frame;ve.get(xn)!==Ht&&(ve.set(xn,Ht),xn.update())}function Hr(xn,Ht){const In=xn.colorSpace,er=xn.format,Hn=xn.type;return xn.isCompressedTexture===!0||xn.isVideoTexture===!0||In!==LinearSRGBColorSpace$1&&In!==NoColorSpace$1&&(ColorManagement$1.getTransfer(In)===SRGBTransfer$1?(er!==RGBAFormat$1||Hn!==UnsignedByteType$1)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",In)),Ht}function Vr(xn){return typeof HTMLImageElement<"u"&&xn instanceof HTMLImageElement?(fe.width=xn.naturalWidth||xn.width,fe.height=xn.naturalHeight||xn.height):typeof VideoFrame<"u"&&xn instanceof VideoFrame?(fe.width=xn.displayWidth,fe.height=xn.displayHeight):(fe.width=xn.width,fe.height=xn.height),fe}this.allocateTextureUnit=Vt,this.resetTextureUnits=Lt,this.setTexture2D=$t,this.setTexture2DArray=Qt,this.setTexture3D=vt,this.setTextureCube=It,this.rebindTextures=Fr,this.setupRenderTarget=Ur,this.updateRenderTargetMipmap=Kr,this.updateMultisampleRenderTarget=rr,this.setupDepthRenderbuffer=nr,this.setupFrameBufferTexture=yn,this.useMultisampledRTT=Ir}function WebGLUtils(H,_){function b($,ee=NoColorSpace$1){let re;const ae=ColorManagement$1.getTransfer(ee);if($===UnsignedByteType$1)return H.UNSIGNED_BYTE;if($===UnsignedShort4444Type)return H.UNSIGNED_SHORT_4_4_4_4;if($===UnsignedShort5551Type)return H.UNSIGNED_SHORT_5_5_5_1;if($===UnsignedInt5999Type)return H.UNSIGNED_INT_5_9_9_9_REV;if($===ByteType)return H.BYTE;if($===ShortType)return H.SHORT;if($===UnsignedShortType)return H.UNSIGNED_SHORT;if($===IntType)return H.INT;if($===UnsignedIntType)return H.UNSIGNED_INT;if($===FloatType$1)return H.FLOAT;if($===HalfFloatType$1)return H.HALF_FLOAT;if($===AlphaFormat)return H.ALPHA;if($===RGBFormat)return H.RGB;if($===RGBAFormat$1)return H.RGBA;if($===LuminanceFormat)return H.LUMINANCE;if($===LuminanceAlphaFormat)return H.LUMINANCE_ALPHA;if($===DepthFormat)return H.DEPTH_COMPONENT;if($===DepthStencilFormat)return H.DEPTH_STENCIL;if($===RedFormat$1)return H.RED;if($===RedIntegerFormat)return H.RED_INTEGER;if($===RGFormat)return H.RG;if($===RGIntegerFormat)return H.RG_INTEGER;if($===RGBAIntegerFormat)return H.RGBA_INTEGER;if($===RGB_S3TC_DXT1_Format||$===RGBA_S3TC_DXT1_Format||$===RGBA_S3TC_DXT3_Format||$===RGBA_S3TC_DXT5_Format)if(ae===SRGBTransfer$1)if(re=_.get("WEBGL_compressed_texture_s3tc_srgb"),re!==null){if($===RGB_S3TC_DXT1_Format)return re.COMPRESSED_SRGB_S3TC_DXT1_EXT;if($===RGBA_S3TC_DXT1_Format)return re.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if($===RGBA_S3TC_DXT3_Format)return re.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if($===RGBA_S3TC_DXT5_Format)return re.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(re=_.get("WEBGL_compressed_texture_s3tc"),re!==null){if($===RGB_S3TC_DXT1_Format)return re.COMPRESSED_RGB_S3TC_DXT1_EXT;if($===RGBA_S3TC_DXT1_Format)return re.COMPRESSED_RGBA_S3TC_DXT1_EXT;if($===RGBA_S3TC_DXT3_Format)return re.COMPRESSED_RGBA_S3TC_DXT3_EXT;if($===RGBA_S3TC_DXT5_Format)return re.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if($===RGB_PVRTC_4BPPV1_Format||$===RGB_PVRTC_2BPPV1_Format||$===RGBA_PVRTC_4BPPV1_Format||$===RGBA_PVRTC_2BPPV1_Format)if(re=_.get("WEBGL_compressed_texture_pvrtc"),re!==null){if($===RGB_PVRTC_4BPPV1_Format)return re.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if($===RGB_PVRTC_2BPPV1_Format)return re.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if($===RGBA_PVRTC_4BPPV1_Format)return re.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if($===RGBA_PVRTC_2BPPV1_Format)return re.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if($===RGB_ETC1_Format||$===RGB_ETC2_Format||$===RGBA_ETC2_EAC_Format)if(re=_.get("WEBGL_compressed_texture_etc"),re!==null){if($===RGB_ETC1_Format||$===RGB_ETC2_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ETC2:re.COMPRESSED_RGB8_ETC2;if($===RGBA_ETC2_EAC_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:re.COMPRESSED_RGBA8_ETC2_EAC}else return null;if($===RGBA_ASTC_4x4_Format||$===RGBA_ASTC_5x4_Format||$===RGBA_ASTC_5x5_Format||$===RGBA_ASTC_6x5_Format||$===RGBA_ASTC_6x6_Format||$===RGBA_ASTC_8x5_Format||$===RGBA_ASTC_8x6_Format||$===RGBA_ASTC_8x8_Format||$===RGBA_ASTC_10x5_Format||$===RGBA_ASTC_10x6_Format||$===RGBA_ASTC_10x8_Format||$===RGBA_ASTC_10x10_Format||$===RGBA_ASTC_12x10_Format||$===RGBA_ASTC_12x12_Format)if(re=_.get("WEBGL_compressed_texture_astc"),re!==null){if($===RGBA_ASTC_4x4_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:re.COMPRESSED_RGBA_ASTC_4x4_KHR;if($===RGBA_ASTC_5x4_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:re.COMPRESSED_RGBA_ASTC_5x4_KHR;if($===RGBA_ASTC_5x5_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:re.COMPRESSED_RGBA_ASTC_5x5_KHR;if($===RGBA_ASTC_6x5_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:re.COMPRESSED_RGBA_ASTC_6x5_KHR;if($===RGBA_ASTC_6x6_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:re.COMPRESSED_RGBA_ASTC_6x6_KHR;if($===RGBA_ASTC_8x5_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:re.COMPRESSED_RGBA_ASTC_8x5_KHR;if($===RGBA_ASTC_8x6_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:re.COMPRESSED_RGBA_ASTC_8x6_KHR;if($===RGBA_ASTC_8x8_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:re.COMPRESSED_RGBA_ASTC_8x8_KHR;if($===RGBA_ASTC_10x5_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:re.COMPRESSED_RGBA_ASTC_10x5_KHR;if($===RGBA_ASTC_10x6_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:re.COMPRESSED_RGBA_ASTC_10x6_KHR;if($===RGBA_ASTC_10x8_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:re.COMPRESSED_RGBA_ASTC_10x8_KHR;if($===RGBA_ASTC_10x10_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:re.COMPRESSED_RGBA_ASTC_10x10_KHR;if($===RGBA_ASTC_12x10_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:re.COMPRESSED_RGBA_ASTC_12x10_KHR;if($===RGBA_ASTC_12x12_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:re.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if($===RGBA_BPTC_Format||$===RGB_BPTC_SIGNED_Format||$===RGB_BPTC_UNSIGNED_Format)if(re=_.get("EXT_texture_compression_bptc"),re!==null){if($===RGBA_BPTC_Format)return ae===SRGBTransfer$1?re.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:re.COMPRESSED_RGBA_BPTC_UNORM_EXT;if($===RGB_BPTC_SIGNED_Format)return re.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if($===RGB_BPTC_UNSIGNED_Format)return re.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if($===RED_RGTC1_Format||$===SIGNED_RED_RGTC1_Format||$===RED_GREEN_RGTC2_Format||$===SIGNED_RED_GREEN_RGTC2_Format)if(re=_.get("EXT_texture_compression_rgtc"),re!==null){if($===RGBA_BPTC_Format)return re.COMPRESSED_RED_RGTC1_EXT;if($===SIGNED_RED_RGTC1_Format)return re.COMPRESSED_SIGNED_RED_RGTC1_EXT;if($===RED_GREEN_RGTC2_Format)return re.COMPRESSED_RED_GREEN_RGTC2_EXT;if($===SIGNED_RED_GREEN_RGTC2_Format)return re.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return $===UnsignedInt248Type?H.UNSIGNED_INT_24_8:H[$]!==void 0?H[$]:null}return{convert:b}}class ArrayCamera extends PerspectiveCamera$1{constructor(_=[]){super(),this.isArrayCamera=!0,this.cameras=_}}let Group$1=class extends Object3D$1{constructor(){super(),this.isGroup=!0,this.type="Group"}};const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group$1,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group$1,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3$1,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3$1),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group$1,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3$1,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3$1),this._grip}dispatchEvent(_){return this._targetRay!==null&&this._targetRay.dispatchEvent(_),this._grip!==null&&this._grip.dispatchEvent(_),this._hand!==null&&this._hand.dispatchEvent(_),this}connect(_){if(_&&_.hand){const b=this._hand;if(b)for(const $ of _.hand.values())this._getHandJoint(b,$)}return this.dispatchEvent({type:"connected",data:_}),this}disconnect(_){return this.dispatchEvent({type:"disconnected",data:_}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(_,b,$){let ee=null,re=null,ae=null;const xe=this._targetRay,le=this._grip,fe=this._hand;if(_&&b.session.visibilityState!=="visible-blurred"){if(fe&&_.hand){ae=!0;for(const De of _.hand.values()){const Be=b.getJointPose(De,$),Ne=this._getHandJoint(fe,De);Be!==null&&(Ne.matrix.fromArray(Be.transform.matrix),Ne.matrix.decompose(Ne.position,Ne.rotation,Ne.scale),Ne.matrixWorldNeedsUpdate=!0,Ne.jointRadius=Be.radius),Ne.visible=Be!==null}const ve=fe.joints["index-finger-tip"],Se=fe.joints["thumb-tip"],Ee=ve.position.distanceTo(Se.position),Ce=.02,Ie=.005;fe.inputState.pinching&&Ee>Ce+Ie?(fe.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:_.handedness,target:this})):!fe.inputState.pinching&&Ee<=Ce-Ie&&(fe.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:_.handedness,target:this}))}else le!==null&&_.gripSpace&&(re=b.getPose(_.gripSpace,$),re!==null&&(le.matrix.fromArray(re.transform.matrix),le.matrix.decompose(le.position,le.rotation,le.scale),le.matrixWorldNeedsUpdate=!0,re.linearVelocity?(le.hasLinearVelocity=!0,le.linearVelocity.copy(re.linearVelocity)):le.hasLinearVelocity=!1,re.angularVelocity?(le.hasAngularVelocity=!0,le.angularVelocity.copy(re.angularVelocity)):le.hasAngularVelocity=!1));xe!==null&&(ee=b.getPose(_.targetRaySpace,$),ee===null&&re!==null&&(ee=re),ee!==null&&(xe.matrix.fromArray(ee.transform.matrix),xe.matrix.decompose(xe.position,xe.rotation,xe.scale),xe.matrixWorldNeedsUpdate=!0,ee.linearVelocity?(xe.hasLinearVelocity=!0,xe.linearVelocity.copy(ee.linearVelocity)):xe.hasLinearVelocity=!1,ee.angularVelocity?(xe.hasAngularVelocity=!0,xe.angularVelocity.copy(ee.angularVelocity)):xe.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return xe!==null&&(xe.visible=ee!==null),le!==null&&(le.visible=re!==null),fe!==null&&(fe.visible=ae!==null),this}_getHandJoint(_,b){if(_.joints[b.jointName]===void 0){const $=new Group$1;$.matrixAutoUpdate=!1,$.visible=!1,_.joints[b.jointName]=$,_.add($)}return _.joints[b.jointName]}}const _occlusion_vertex=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_occlusion_fragment=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class WebXRDepthSensing{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(_,b,$){if(this.texture===null){const ee=new Texture$1,re=_.properties.get(ee);re.__webglTexture=b.texture,(b.depthNear!=$.depthNear||b.depthFar!=$.depthFar)&&(this.depthNear=b.depthNear,this.depthFar=b.depthFar),this.texture=ee}}getMesh(_){if(this.texture!==null&&this.mesh===null){const b=_.cameras[0].viewport,$=new ShaderMaterial({vertexShader:_occlusion_vertex,fragmentShader:_occlusion_fragment,uniforms:{depthColor:{value:this.texture},depthWidth:{value:b.z},depthHeight:{value:b.w}}});this.mesh=new Mesh$1(new PlaneGeometry(20,20),$)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class WebXRManager extends EventDispatcher$1{constructor(_,b){super();const $=this;let ee=null,re=1,ae=null,xe="local-floor",le=1,fe=null,ve=null,Se=null,Ee=null,Ce=null,Ie=null;const De=new WebXRDepthSensing,Be=b.getContextAttributes();let Ne=null,qe=null;const Xe=[],Ye=[],Qe=new Vector2$1;let rt=null;const ot=new PerspectiveCamera$1;ot.layers.enable(1),ot.viewport=new Vector4$1;const ct=new PerspectiveCamera$1;ct.layers.enable(2),ct.viewport=new Vector4$1;const mt=[ot,ct],_t=new ArrayCamera;_t.layers.enable(1),_t.layers.enable(2);let Lt=null,Vt=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(en){let yn=Xe[en];return yn===void 0&&(yn=new WebXRController,Xe[en]=yn),yn.getTargetRaySpace()},this.getControllerGrip=function(en){let yn=Xe[en];return yn===void 0&&(yn=new WebXRController,Xe[en]=yn),yn.getGripSpace()},this.getHand=function(en){let yn=Xe[en];return yn===void 0&&(yn=new WebXRController,Xe[en]=yn),yn.getHandSpace()};function Gt(en){const yn=Ye.indexOf(en.inputSource);if(yn===-1)return;const Pn=Xe[yn];Pn!==void 0&&(Pn.update(en.inputSource,en.frame,fe||ae),Pn.dispatchEvent({type:en.type,data:en.inputSource}))}function $t(){ee.removeEventListener("select",Gt),ee.removeEventListener("selectstart",Gt),ee.removeEventListener("selectend",Gt),ee.removeEventListener("squeeze",Gt),ee.removeEventListener("squeezestart",Gt),ee.removeEventListener("squeezeend",Gt),ee.removeEventListener("end",$t),ee.removeEventListener("inputsourceschange",Qt);for(let en=0;en<Xe.length;en++){const yn=Ye[en];yn!==null&&(Ye[en]=null,Xe[en].disconnect(yn))}Lt=null,Vt=null,De.reset(),_.setRenderTarget(Ne),Ce=null,Ee=null,Se=null,ee=null,qe=null,cn.stop(),$.isPresenting=!1,_.setPixelRatio(rt),_.setSize(Qe.width,Qe.height,!1),$.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(en){re=en,$.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(en){xe=en,$.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return fe||ae},this.setReferenceSpace=function(en){fe=en},this.getBaseLayer=function(){return Ee!==null?Ee:Ce},this.getBinding=function(){return Se},this.getFrame=function(){return Ie},this.getSession=function(){return ee},this.setSession=async function(en){if(ee=en,ee!==null){if(Ne=_.getRenderTarget(),ee.addEventListener("select",Gt),ee.addEventListener("selectstart",Gt),ee.addEventListener("selectend",Gt),ee.addEventListener("squeeze",Gt),ee.addEventListener("squeezestart",Gt),ee.addEventListener("squeezeend",Gt),ee.addEventListener("end",$t),ee.addEventListener("inputsourceschange",Qt),Be.xrCompatible!==!0&&await b.makeXRCompatible(),rt=_.getPixelRatio(),_.getSize(Qe),ee.renderState.layers===void 0){const yn={antialias:Be.antialias,alpha:!0,depth:Be.depth,stencil:Be.stencil,framebufferScaleFactor:re};Ce=new XRWebGLLayer(ee,b,yn),ee.updateRenderState({baseLayer:Ce}),_.setPixelRatio(1),_.setSize(Ce.framebufferWidth,Ce.framebufferHeight,!1),qe=new WebGLRenderTarget(Ce.framebufferWidth,Ce.framebufferHeight,{format:RGBAFormat$1,type:UnsignedByteType$1,colorSpace:_.outputColorSpace,stencilBuffer:Be.stencil})}else{let yn=null,Pn=null,tr=null;Be.depth&&(tr=Be.stencil?b.DEPTH24_STENCIL8:b.DEPTH_COMPONENT24,yn=Be.stencil?DepthStencilFormat:DepthFormat,Pn=Be.stencil?UnsignedInt248Type:UnsignedIntType);const nr={colorFormat:b.RGBA8,depthFormat:tr,scaleFactor:re};Se=new XRWebGLBinding(ee,b),Ee=Se.createProjectionLayer(nr),ee.updateRenderState({layers:[Ee]}),_.setPixelRatio(1),_.setSize(Ee.textureWidth,Ee.textureHeight,!1),qe=new WebGLRenderTarget(Ee.textureWidth,Ee.textureHeight,{format:RGBAFormat$1,type:UnsignedByteType$1,depthTexture:new DepthTexture(Ee.textureWidth,Ee.textureHeight,Pn,void 0,void 0,void 0,void 0,void 0,void 0,yn),stencilBuffer:Be.stencil,colorSpace:_.outputColorSpace,samples:Be.antialias?4:0,resolveDepthBuffer:Ee.ignoreDepthValues===!1})}qe.isXRRenderTarget=!0,this.setFoveation(le),fe=null,ae=await ee.requestReferenceSpace(xe),cn.setContext(ee),cn.start(),$.isPresenting=!0,$.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(ee!==null)return ee.environmentBlendMode},this.getDepthTexture=function(){return De.getDepthTexture()};function Qt(en){for(let yn=0;yn<en.removed.length;yn++){const Pn=en.removed[yn],tr=Ye.indexOf(Pn);tr>=0&&(Ye[tr]=null,Xe[tr].disconnect(Pn))}for(let yn=0;yn<en.added.length;yn++){const Pn=en.added[yn];let tr=Ye.indexOf(Pn);if(tr===-1){for(let Fr=0;Fr<Xe.length;Fr++)if(Fr>=Ye.length){Ye.push(Pn),tr=Fr;break}else if(Ye[Fr]===null){Ye[Fr]=Pn,tr=Fr;break}if(tr===-1)break}const nr=Xe[tr];nr&&nr.connect(Pn)}}const vt=new Vector3$1,It=new Vector3$1;function gt(en,yn,Pn){vt.setFromMatrixPosition(yn.matrixWorld),It.setFromMatrixPosition(Pn.matrixWorld);const tr=vt.distanceTo(It),nr=yn.projectionMatrix.elements,Fr=Pn.projectionMatrix.elements,Ur=nr[14]/(nr[10]-1),Kr=nr[14]/(nr[10]+1),on=(nr[9]+1)/nr[5],qr=(nr[9]-1)/nr[5],rr=(nr[8]-1)/nr[0],Qr=(Fr[8]+1)/Fr[0],Ir=Ur*rr,ai=Ur*Qr,Hr=tr/(-rr+Qr),Vr=Hr*-rr;if(yn.matrixWorld.decompose(en.position,en.quaternion,en.scale),en.translateX(Vr),en.translateZ(Hr),en.matrixWorld.compose(en.position,en.quaternion,en.scale),en.matrixWorldInverse.copy(en.matrixWorld).invert(),nr[10]===-1)en.projectionMatrix.copy(yn.projectionMatrix),en.projectionMatrixInverse.copy(yn.projectionMatrixInverse);else{const xn=Ur+Hr,Ht=Kr+Hr,In=Ir-Vr,er=ai+(tr-Vr),Hn=on*Kr/Ht*xn,Zn=qr*Kr/Ht*xn;en.projectionMatrix.makePerspective(In,er,Hn,Zn,xn,Ht),en.projectionMatrixInverse.copy(en.projectionMatrix).invert()}}function Tt(en,yn){yn===null?en.matrixWorld.copy(en.matrix):en.matrixWorld.multiplyMatrices(yn.matrixWorld,en.matrix),en.matrixWorldInverse.copy(en.matrixWorld).invert()}this.updateCamera=function(en){if(ee===null)return;let yn=en.near,Pn=en.far;De.texture!==null&&(De.depthNear>0&&(yn=De.depthNear),De.depthFar>0&&(Pn=De.depthFar)),_t.near=ct.near=ot.near=yn,_t.far=ct.far=ot.far=Pn,(Lt!==_t.near||Vt!==_t.far)&&(ee.updateRenderState({depthNear:_t.near,depthFar:_t.far}),Lt=_t.near,Vt=_t.far);const tr=en.parent,nr=_t.cameras;Tt(_t,tr);for(let Fr=0;Fr<nr.length;Fr++)Tt(nr[Fr],tr);nr.length===2?gt(_t,ot,ct):_t.projectionMatrix.copy(ot.projectionMatrix),Ct(en,_t,tr)};function Ct(en,yn,Pn){Pn===null?en.matrix.copy(yn.matrixWorld):(en.matrix.copy(Pn.matrixWorld),en.matrix.invert(),en.matrix.multiply(yn.matrixWorld)),en.matrix.decompose(en.position,en.quaternion,en.scale),en.updateMatrixWorld(!0),en.projectionMatrix.copy(yn.projectionMatrix),en.projectionMatrixInverse.copy(yn.projectionMatrixInverse),en.isPerspectiveCamera&&(en.fov=RAD2DEG$1*2*Math.atan(1/en.projectionMatrix.elements[5]),en.zoom=1)}this.getCamera=function(){return _t},this.getFoveation=function(){if(!(Ee===null&&Ce===null))return le},this.setFoveation=function(en){le=en,Ee!==null&&(Ee.fixedFoveation=en),Ce!==null&&Ce.fixedFoveation!==void 0&&(Ce.fixedFoveation=en)},this.hasDepthSensing=function(){return De.texture!==null},this.getDepthSensingMesh=function(){return De.getMesh(_t)};let Ft=null;function sn(en,yn){if(ve=yn.getViewerPose(fe||ae),Ie=yn,ve!==null){const Pn=ve.views;Ce!==null&&(_.setRenderTargetFramebuffer(qe,Ce.framebuffer),_.setRenderTarget(qe));let tr=!1;Pn.length!==_t.cameras.length&&(_t.cameras.length=0,tr=!0);for(let Fr=0;Fr<Pn.length;Fr++){const Ur=Pn[Fr];let Kr=null;if(Ce!==null)Kr=Ce.getViewport(Ur);else{const qr=Se.getViewSubImage(Ee,Ur);Kr=qr.viewport,Fr===0&&(_.setRenderTargetTextures(qe,qr.colorTexture,Ee.ignoreDepthValues?void 0:qr.depthStencilTexture),_.setRenderTarget(qe))}let on=mt[Fr];on===void 0&&(on=new PerspectiveCamera$1,on.layers.enable(Fr),on.viewport=new Vector4$1,mt[Fr]=on),on.matrix.fromArray(Ur.transform.matrix),on.matrix.decompose(on.position,on.quaternion,on.scale),on.projectionMatrix.fromArray(Ur.projectionMatrix),on.projectionMatrixInverse.copy(on.projectionMatrix).invert(),on.viewport.set(Kr.x,Kr.y,Kr.width,Kr.height),Fr===0&&(_t.matrix.copy(on.matrix),_t.matrix.decompose(_t.position,_t.quaternion,_t.scale)),tr===!0&&_t.cameras.push(on)}const nr=ee.enabledFeatures;if(nr&&nr.includes("depth-sensing")){const Fr=Se.getDepthInformation(Pn[0]);Fr&&Fr.isValid&&Fr.texture&&De.init(_,Fr,ee.renderState)}}for(let Pn=0;Pn<Xe.length;Pn++){const tr=Ye[Pn],nr=Xe[Pn];tr!==null&&nr!==void 0&&nr.update(tr,yn,fe||ae)}Ft&&Ft(en,yn),yn.detectedPlanes&&$.dispatchEvent({type:"planesdetected",data:yn}),Ie=null}const cn=new WebGLAnimation;cn.setAnimationLoop(sn),this.setAnimationLoop=function(en){Ft=en},this.dispose=function(){}}}const _e1=new Euler$1,_m1=new Matrix4$1;function WebGLMaterials(H,_){function b(Be,Ne){Be.matrixAutoUpdate===!0&&Be.updateMatrix(),Ne.value.copy(Be.matrix)}function $(Be,Ne){Ne.color.getRGB(Be.fogColor.value,getUnlitUniformColorSpace(H)),Ne.isFog?(Be.fogNear.value=Ne.near,Be.fogFar.value=Ne.far):Ne.isFogExp2&&(Be.fogDensity.value=Ne.density)}function ee(Be,Ne,qe,Xe,Ye){Ne.isMeshBasicMaterial||Ne.isMeshLambertMaterial?re(Be,Ne):Ne.isMeshToonMaterial?(re(Be,Ne),Se(Be,Ne)):Ne.isMeshPhongMaterial?(re(Be,Ne),ve(Be,Ne)):Ne.isMeshStandardMaterial?(re(Be,Ne),Ee(Be,Ne),Ne.isMeshPhysicalMaterial&&Ce(Be,Ne,Ye)):Ne.isMeshMatcapMaterial?(re(Be,Ne),Ie(Be,Ne)):Ne.isMeshDepthMaterial?re(Be,Ne):Ne.isMeshDistanceMaterial?(re(Be,Ne),De(Be,Ne)):Ne.isMeshNormalMaterial?re(Be,Ne):Ne.isLineBasicMaterial?(ae(Be,Ne),Ne.isLineDashedMaterial&&xe(Be,Ne)):Ne.isPointsMaterial?le(Be,Ne,qe,Xe):Ne.isSpriteMaterial?fe(Be,Ne):Ne.isShadowMaterial?(Be.color.value.copy(Ne.color),Be.opacity.value=Ne.opacity):Ne.isShaderMaterial&&(Ne.uniformsNeedUpdate=!1)}function re(Be,Ne){Be.opacity.value=Ne.opacity,Ne.color&&Be.diffuse.value.copy(Ne.color),Ne.emissive&&Be.emissive.value.copy(Ne.emissive).multiplyScalar(Ne.emissiveIntensity),Ne.map&&(Be.map.value=Ne.map,b(Ne.map,Be.mapTransform)),Ne.alphaMap&&(Be.alphaMap.value=Ne.alphaMap,b(Ne.alphaMap,Be.alphaMapTransform)),Ne.bumpMap&&(Be.bumpMap.value=Ne.bumpMap,b(Ne.bumpMap,Be.bumpMapTransform),Be.bumpScale.value=Ne.bumpScale,Ne.side===BackSide$1&&(Be.bumpScale.value*=-1)),Ne.normalMap&&(Be.normalMap.value=Ne.normalMap,b(Ne.normalMap,Be.normalMapTransform),Be.normalScale.value.copy(Ne.normalScale),Ne.side===BackSide$1&&Be.normalScale.value.negate()),Ne.displacementMap&&(Be.displacementMap.value=Ne.displacementMap,b(Ne.displacementMap,Be.displacementMapTransform),Be.displacementScale.value=Ne.displacementScale,Be.displacementBias.value=Ne.displacementBias),Ne.emissiveMap&&(Be.emissiveMap.value=Ne.emissiveMap,b(Ne.emissiveMap,Be.emissiveMapTransform)),Ne.specularMap&&(Be.specularMap.value=Ne.specularMap,b(Ne.specularMap,Be.specularMapTransform)),Ne.alphaTest>0&&(Be.alphaTest.value=Ne.alphaTest);const qe=_.get(Ne),Xe=qe.envMap,Ye=qe.envMapRotation;Xe&&(Be.envMap.value=Xe,_e1.copy(Ye),_e1.x*=-1,_e1.y*=-1,_e1.z*=-1,Xe.isCubeTexture&&Xe.isRenderTargetTexture===!1&&(_e1.y*=-1,_e1.z*=-1),Be.envMapRotation.value.setFromMatrix4(_m1.makeRotationFromEuler(_e1)),Be.flipEnvMap.value=Xe.isCubeTexture&&Xe.isRenderTargetTexture===!1?-1:1,Be.reflectivity.value=Ne.reflectivity,Be.ior.value=Ne.ior,Be.refractionRatio.value=Ne.refractionRatio),Ne.lightMap&&(Be.lightMap.value=Ne.lightMap,Be.lightMapIntensity.value=Ne.lightMapIntensity,b(Ne.lightMap,Be.lightMapTransform)),Ne.aoMap&&(Be.aoMap.value=Ne.aoMap,Be.aoMapIntensity.value=Ne.aoMapIntensity,b(Ne.aoMap,Be.aoMapTransform))}function ae(Be,Ne){Be.diffuse.value.copy(Ne.color),Be.opacity.value=Ne.opacity,Ne.map&&(Be.map.value=Ne.map,b(Ne.map,Be.mapTransform))}function xe(Be,Ne){Be.dashSize.value=Ne.dashSize,Be.totalSize.value=Ne.dashSize+Ne.gapSize,Be.scale.value=Ne.scale}function le(Be,Ne,qe,Xe){Be.diffuse.value.copy(Ne.color),Be.opacity.value=Ne.opacity,Be.size.value=Ne.size*qe,Be.scale.value=Xe*.5,Ne.map&&(Be.map.value=Ne.map,b(Ne.map,Be.uvTransform)),Ne.alphaMap&&(Be.alphaMap.value=Ne.alphaMap,b(Ne.alphaMap,Be.alphaMapTransform)),Ne.alphaTest>0&&(Be.alphaTest.value=Ne.alphaTest)}function fe(Be,Ne){Be.diffuse.value.copy(Ne.color),Be.opacity.value=Ne.opacity,Be.rotation.value=Ne.rotation,Ne.map&&(Be.map.value=Ne.map,b(Ne.map,Be.mapTransform)),Ne.alphaMap&&(Be.alphaMap.value=Ne.alphaMap,b(Ne.alphaMap,Be.alphaMapTransform)),Ne.alphaTest>0&&(Be.alphaTest.value=Ne.alphaTest)}function ve(Be,Ne){Be.specular.value.copy(Ne.specular),Be.shininess.value=Math.max(Ne.shininess,1e-4)}function Se(Be,Ne){Ne.gradientMap&&(Be.gradientMap.value=Ne.gradientMap)}function Ee(Be,Ne){Be.metalness.value=Ne.metalness,Ne.metalnessMap&&(Be.metalnessMap.value=Ne.metalnessMap,b(Ne.metalnessMap,Be.metalnessMapTransform)),Be.roughness.value=Ne.roughness,Ne.roughnessMap&&(Be.roughnessMap.value=Ne.roughnessMap,b(Ne.roughnessMap,Be.roughnessMapTransform)),Ne.envMap&&(Be.envMapIntensity.value=Ne.envMapIntensity)}function Ce(Be,Ne,qe){Be.ior.value=Ne.ior,Ne.sheen>0&&(Be.sheenColor.value.copy(Ne.sheenColor).multiplyScalar(Ne.sheen),Be.sheenRoughness.value=Ne.sheenRoughness,Ne.sheenColorMap&&(Be.sheenColorMap.value=Ne.sheenColorMap,b(Ne.sheenColorMap,Be.sheenColorMapTransform)),Ne.sheenRoughnessMap&&(Be.sheenRoughnessMap.value=Ne.sheenRoughnessMap,b(Ne.sheenRoughnessMap,Be.sheenRoughnessMapTransform))),Ne.clearcoat>0&&(Be.clearcoat.value=Ne.clearcoat,Be.clearcoatRoughness.value=Ne.clearcoatRoughness,Ne.clearcoatMap&&(Be.clearcoatMap.value=Ne.clearcoatMap,b(Ne.clearcoatMap,Be.clearcoatMapTransform)),Ne.clearcoatRoughnessMap&&(Be.clearcoatRoughnessMap.value=Ne.clearcoatRoughnessMap,b(Ne.clearcoatRoughnessMap,Be.clearcoatRoughnessMapTransform)),Ne.clearcoatNormalMap&&(Be.clearcoatNormalMap.value=Ne.clearcoatNormalMap,b(Ne.clearcoatNormalMap,Be.clearcoatNormalMapTransform),Be.clearcoatNormalScale.value.copy(Ne.clearcoatNormalScale),Ne.side===BackSide$1&&Be.clearcoatNormalScale.value.negate())),Ne.dispersion>0&&(Be.dispersion.value=Ne.dispersion),Ne.iridescence>0&&(Be.iridescence.value=Ne.iridescence,Be.iridescenceIOR.value=Ne.iridescenceIOR,Be.iridescenceThicknessMinimum.value=Ne.iridescenceThicknessRange[0],Be.iridescenceThicknessMaximum.value=Ne.iridescenceThicknessRange[1],Ne.iridescenceMap&&(Be.iridescenceMap.value=Ne.iridescenceMap,b(Ne.iridescenceMap,Be.iridescenceMapTransform)),Ne.iridescenceThicknessMap&&(Be.iridescenceThicknessMap.value=Ne.iridescenceThicknessMap,b(Ne.iridescenceThicknessMap,Be.iridescenceThicknessMapTransform))),Ne.transmission>0&&(Be.transmission.value=Ne.transmission,Be.transmissionSamplerMap.value=qe.texture,Be.transmissionSamplerSize.value.set(qe.width,qe.height),Ne.transmissionMap&&(Be.transmissionMap.value=Ne.transmissionMap,b(Ne.transmissionMap,Be.transmissionMapTransform)),Be.thickness.value=Ne.thickness,Ne.thicknessMap&&(Be.thicknessMap.value=Ne.thicknessMap,b(Ne.thicknessMap,Be.thicknessMapTransform)),Be.attenuationDistance.value=Ne.attenuationDistance,Be.attenuationColor.value.copy(Ne.attenuationColor)),Ne.anisotropy>0&&(Be.anisotropyVector.value.set(Ne.anisotropy*Math.cos(Ne.anisotropyRotation),Ne.anisotropy*Math.sin(Ne.anisotropyRotation)),Ne.anisotropyMap&&(Be.anisotropyMap.value=Ne.anisotropyMap,b(Ne.anisotropyMap,Be.anisotropyMapTransform))),Be.specularIntensity.value=Ne.specularIntensity,Be.specularColor.value.copy(Ne.specularColor),Ne.specularColorMap&&(Be.specularColorMap.value=Ne.specularColorMap,b(Ne.specularColorMap,Be.specularColorMapTransform)),Ne.specularIntensityMap&&(Be.specularIntensityMap.value=Ne.specularIntensityMap,b(Ne.specularIntensityMap,Be.specularIntensityMapTransform))}function Ie(Be,Ne){Ne.matcap&&(Be.matcap.value=Ne.matcap)}function De(Be,Ne){const qe=_.get(Ne).light;Be.referencePosition.value.setFromMatrixPosition(qe.matrixWorld),Be.nearDistance.value=qe.shadow.camera.near,Be.farDistance.value=qe.shadow.camera.far}return{refreshFogUniforms:$,refreshMaterialUniforms:ee}}function WebGLUniformsGroups(H,_,b,$){let ee={},re={},ae=[];const xe=H.getParameter(H.MAX_UNIFORM_BUFFER_BINDINGS);function le(qe,Xe){const Ye=Xe.program;$.uniformBlockBinding(qe,Ye)}function fe(qe,Xe){let Ye=ee[qe.id];Ye===void 0&&(Ie(qe),Ye=ve(qe),ee[qe.id]=Ye,qe.addEventListener("dispose",Be));const Qe=Xe.program;$.updateUBOMapping(qe,Qe);const rt=_.render.frame;re[qe.id]!==rt&&(Ee(qe),re[qe.id]=rt)}function ve(qe){const Xe=Se();qe.__bindingPointIndex=Xe;const Ye=H.createBuffer(),Qe=qe.__size,rt=qe.usage;return H.bindBuffer(H.UNIFORM_BUFFER,Ye),H.bufferData(H.UNIFORM_BUFFER,Qe,rt),H.bindBuffer(H.UNIFORM_BUFFER,null),H.bindBufferBase(H.UNIFORM_BUFFER,Xe,Ye),Ye}function Se(){for(let qe=0;qe<xe;qe++)if(ae.indexOf(qe)===-1)return ae.push(qe),qe;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function Ee(qe){const Xe=ee[qe.id],Ye=qe.uniforms,Qe=qe.__cache;H.bindBuffer(H.UNIFORM_BUFFER,Xe);for(let rt=0,ot=Ye.length;rt<ot;rt++){const ct=Array.isArray(Ye[rt])?Ye[rt]:[Ye[rt]];for(let mt=0,_t=ct.length;mt<_t;mt++){const Lt=ct[mt];if(Ce(Lt,rt,mt,Qe)===!0){const Vt=Lt.__offset,Gt=Array.isArray(Lt.value)?Lt.value:[Lt.value];let $t=0;for(let Qt=0;Qt<Gt.length;Qt++){const vt=Gt[Qt],It=De(vt);typeof vt=="number"||typeof vt=="boolean"?(Lt.__data[0]=vt,H.bufferSubData(H.UNIFORM_BUFFER,Vt+$t,Lt.__data)):vt.isMatrix3?(Lt.__data[0]=vt.elements[0],Lt.__data[1]=vt.elements[1],Lt.__data[2]=vt.elements[2],Lt.__data[3]=0,Lt.__data[4]=vt.elements[3],Lt.__data[5]=vt.elements[4],Lt.__data[6]=vt.elements[5],Lt.__data[7]=0,Lt.__data[8]=vt.elements[6],Lt.__data[9]=vt.elements[7],Lt.__data[10]=vt.elements[8],Lt.__data[11]=0):(vt.toArray(Lt.__data,$t),$t+=It.storage/Float32Array.BYTES_PER_ELEMENT)}H.bufferSubData(H.UNIFORM_BUFFER,Vt,Lt.__data)}}}H.bindBuffer(H.UNIFORM_BUFFER,null)}function Ce(qe,Xe,Ye,Qe){const rt=qe.value,ot=Xe+"_"+Ye;if(Qe[ot]===void 0)return typeof rt=="number"||typeof rt=="boolean"?Qe[ot]=rt:Qe[ot]=rt.clone(),!0;{const ct=Qe[ot];if(typeof rt=="number"||typeof rt=="boolean"){if(ct!==rt)return Qe[ot]=rt,!0}else if(ct.equals(rt)===!1)return ct.copy(rt),!0}return!1}function Ie(qe){const Xe=qe.uniforms;let Ye=0;const Qe=16;for(let ot=0,ct=Xe.length;ot<ct;ot++){const mt=Array.isArray(Xe[ot])?Xe[ot]:[Xe[ot]];for(let _t=0,Lt=mt.length;_t<Lt;_t++){const Vt=mt[_t],Gt=Array.isArray(Vt.value)?Vt.value:[Vt.value];for(let $t=0,Qt=Gt.length;$t<Qt;$t++){const vt=Gt[$t],It=De(vt),gt=Ye%Qe,Tt=gt%It.boundary,Ct=gt+Tt;Ye+=Tt,Ct!==0&&Qe-Ct<It.storage&&(Ye+=Qe-Ct),Vt.__data=new Float32Array(It.storage/Float32Array.BYTES_PER_ELEMENT),Vt.__offset=Ye,Ye+=It.storage}}}const rt=Ye%Qe;return rt>0&&(Ye+=Qe-rt),qe.__size=Ye,qe.__cache={},this}function De(qe){const Xe={boundary:0,storage:0};return typeof qe=="number"||typeof qe=="boolean"?(Xe.boundary=4,Xe.storage=4):qe.isVector2?(Xe.boundary=8,Xe.storage=8):qe.isVector3||qe.isColor?(Xe.boundary=16,Xe.storage=12):qe.isVector4?(Xe.boundary=16,Xe.storage=16):qe.isMatrix3?(Xe.boundary=48,Xe.storage=48):qe.isMatrix4?(Xe.boundary=64,Xe.storage=64):qe.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",qe),Xe}function Be(qe){const Xe=qe.target;Xe.removeEventListener("dispose",Be);const Ye=ae.indexOf(Xe.__bindingPointIndex);ae.splice(Ye,1),H.deleteBuffer(ee[Xe.id]),delete ee[Xe.id],delete re[Xe.id]}function Ne(){for(const qe in ee)H.deleteBuffer(ee[qe]);ae=[],ee={},re={}}return{bind:le,update:fe,dispose:Ne}}class WebGLRenderer{constructor(_={}){const{canvas:b=createCanvasElement(),context:$=null,depth:ee=!0,stencil:re=!1,alpha:ae=!1,antialias:xe=!1,premultipliedAlpha:le=!0,preserveDrawingBuffer:fe=!1,powerPreference:ve="default",failIfMajorPerformanceCaveat:Se=!1}=_;this.isWebGLRenderer=!0;let Ee;if($!==null){if(typeof WebGLRenderingContext<"u"&&$ instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");Ee=$.getContextAttributes().alpha}else Ee=ae;const Ce=new Uint32Array(4),Ie=new Int32Array(4);let De=null,Be=null;const Ne=[],qe=[];this.domElement=b,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=SRGBColorSpace$1,this.toneMapping=NoToneMapping,this.toneMappingExposure=1;const Xe=this;let Ye=!1,Qe=0,rt=0,ot=null,ct=-1,mt=null;const _t=new Vector4$1,Lt=new Vector4$1;let Vt=null;const Gt=new Color$1(0);let $t=0,Qt=b.width,vt=b.height,It=1,gt=null,Tt=null;const Ct=new Vector4$1(0,0,Qt,vt),Ft=new Vector4$1(0,0,Qt,vt);let sn=!1;const cn=new Frustum$1;let en=!1,yn=!1;const Pn=new Matrix4$1,tr=new Vector3$1,nr=new Vector4$1,Fr={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Ur=!1;function Kr(){return ot===null?It:1}let on=$;function qr(Jt,vn){return b.getContext(Jt,vn)}try{const Jt={alpha:!0,depth:ee,stencil:re,antialias:xe,premultipliedAlpha:le,preserveDrawingBuffer:fe,powerPreference:ve,failIfMajorPerformanceCaveat:Se};if("setAttribute"in b&&b.setAttribute("data-engine",`three.js r${REVISION$1}`),b.addEventListener("webglcontextlost",xr,!1),b.addEventListener("webglcontextrestored",gr,!1),b.addEventListener("webglcontextcreationerror",Mr,!1),on===null){const vn="webgl2";if(on=qr(vn,Jt),on===null)throw qr(vn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Jt){throw console.error("THREE.WebGLRenderer: "+Jt.message),Jt}let rr,Qr,Ir,ai,Hr,Vr,xn,Ht,In,er,Hn,Zn,Dr,zn,Nr,vr,Sr,zr,gi,oi,Gr,ri,yi,Ci;function wn(){rr=new WebGLExtensions(on),rr.init(),ri=new WebGLUtils(on,rr),Qr=new WebGLCapabilities(on,rr,_,ri),Ir=new WebGLState(on),ai=new WebGLInfo(on),Hr=new WebGLProperties,Vr=new WebGLTextures(on,rr,Ir,Hr,Qr,ri,ai),xn=new WebGLCubeMaps(Xe),Ht=new WebGLCubeUVMaps(Xe),In=new WebGLAttributes(on),yi=new WebGLBindingStates(on,In),er=new WebGLGeometries(on,In,ai,yi),Hn=new WebGLObjects(on,er,In,ai),gi=new WebGLMorphtargets(on,Qr,Vr),vr=new WebGLClipping(Hr),Zn=new WebGLPrograms(Xe,xn,Ht,rr,Qr,yi,vr),Dr=new WebGLMaterials(Xe,Hr),zn=new WebGLRenderLists,Nr=new WebGLRenderStates(rr),zr=new WebGLBackground(Xe,xn,Ht,Ir,Hn,Ee,le),Sr=new WebGLShadowMap(Xe,Hn,Qr),Ci=new WebGLUniformsGroups(on,ai,Qr,Ir),oi=new WebGLBufferRenderer(on,rr,ai),Gr=new WebGLIndexedBufferRenderer(on,rr,ai),ai.programs=Zn.programs,Xe.capabilities=Qr,Xe.extensions=rr,Xe.properties=Hr,Xe.renderLists=zn,Xe.shadowMap=Sr,Xe.state=Ir,Xe.info=ai}wn();const Pr=new WebXRManager(Xe,on);this.xr=Pr,this.getContext=function(){return on},this.getContextAttributes=function(){return on.getContextAttributes()},this.forceContextLoss=function(){const Jt=rr.get("WEBGL_lose_context");Jt&&Jt.loseContext()},this.forceContextRestore=function(){const Jt=rr.get("WEBGL_lose_context");Jt&&Jt.restoreContext()},this.getPixelRatio=function(){return It},this.setPixelRatio=function(Jt){Jt!==void 0&&(It=Jt,this.setSize(Qt,vt,!1))},this.getSize=function(Jt){return Jt.set(Qt,vt)},this.setSize=function(Jt,vn,$n=!0){if(Pr.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Qt=Jt,vt=vn,b.width=Math.floor(Jt*It),b.height=Math.floor(vn*It),$n===!0&&(b.style.width=Jt+"px",b.style.height=vn+"px"),this.setViewport(0,0,Jt,vn)},this.getDrawingBufferSize=function(Jt){return Jt.set(Qt*It,vt*It).floor()},this.setDrawingBufferSize=function(Jt,vn,$n){Qt=Jt,vt=vn,It=$n,b.width=Math.floor(Jt*$n),b.height=Math.floor(vn*$n),this.setViewport(0,0,Jt,vn)},this.getCurrentViewport=function(Jt){return Jt.copy(_t)},this.getViewport=function(Jt){return Jt.copy(Ct)},this.setViewport=function(Jt,vn,$n,Wn){Jt.isVector4?Ct.set(Jt.x,Jt.y,Jt.z,Jt.w):Ct.set(Jt,vn,$n,Wn),Ir.viewport(_t.copy(Ct).multiplyScalar(It).round())},this.getScissor=function(Jt){return Jt.copy(Ft)},this.setScissor=function(Jt,vn,$n,Wn){Jt.isVector4?Ft.set(Jt.x,Jt.y,Jt.z,Jt.w):Ft.set(Jt,vn,$n,Wn),Ir.scissor(Lt.copy(Ft).multiplyScalar(It).round())},this.getScissorTest=function(){return sn},this.setScissorTest=function(Jt){Ir.setScissorTest(sn=Jt)},this.setOpaqueSort=function(Jt){gt=Jt},this.setTransparentSort=function(Jt){Tt=Jt},this.getClearColor=function(Jt){return Jt.copy(zr.getClearColor())},this.setClearColor=function(){zr.setClearColor.apply(zr,arguments)},this.getClearAlpha=function(){return zr.getClearAlpha()},this.setClearAlpha=function(){zr.setClearAlpha.apply(zr,arguments)},this.clear=function(Jt=!0,vn=!0,$n=!0){let Wn=0;if(Jt){let An=!1;if(ot!==null){const Cr=ot.texture.format;An=Cr===RGBAIntegerFormat||Cr===RGIntegerFormat||Cr===RedIntegerFormat}if(An){const Cr=ot.texture.type,$r=Cr===UnsignedByteType$1||Cr===UnsignedIntType||Cr===UnsignedShortType||Cr===UnsignedInt248Type||Cr===UnsignedShort4444Type||Cr===UnsignedShort5551Type,Xr=zr.getClearColor(),Yr=zr.getClearAlpha(),ui=Xr.r,ii=Xr.g,jr=Xr.b;$r?(Ce[0]=ui,Ce[1]=ii,Ce[2]=jr,Ce[3]=Yr,on.clearBufferuiv(on.COLOR,0,Ce)):(Ie[0]=ui,Ie[1]=ii,Ie[2]=jr,Ie[3]=Yr,on.clearBufferiv(on.COLOR,0,Ie))}else Wn|=on.COLOR_BUFFER_BIT}vn&&(Wn|=on.DEPTH_BUFFER_BIT),$n&&(Wn|=on.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),on.clear(Wn)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){b.removeEventListener("webglcontextlost",xr,!1),b.removeEventListener("webglcontextrestored",gr,!1),b.removeEventListener("webglcontextcreationerror",Mr,!1),zn.dispose(),Nr.dispose(),Hr.dispose(),xn.dispose(),Ht.dispose(),Hn.dispose(),yi.dispose(),Ci.dispose(),Zn.dispose(),Pr.dispose(),Pr.removeEventListener("sessionstart",Ra),Pr.removeEventListener("sessionend",sa),$i.stop()};function xr(Jt){Jt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Ye=!0}function gr(){console.log("THREE.WebGLRenderer: Context Restored."),Ye=!1;const Jt=ai.autoReset,vn=Sr.enabled,$n=Sr.autoUpdate,Wn=Sr.needsUpdate,An=Sr.type;wn(),ai.autoReset=Jt,Sr.enabled=vn,Sr.autoUpdate=$n,Sr.needsUpdate=Wn,Sr.type=An}function Mr(Jt){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Jt.statusMessage)}function ci(Jt){const vn=Jt.target;vn.removeEventListener("dispose",ci),fi(vn)}function fi(Jt){Ui(Jt),Hr.remove(Jt)}function Ui(Jt){const vn=Hr.get(Jt).programs;vn!==void 0&&(vn.forEach(function($n){Zn.releaseProgram($n)}),Jt.isShaderMaterial&&Zn.releaseShaderCache(Jt))}this.renderBufferDirect=function(Jt,vn,$n,Wn,An,Cr){vn===null&&(vn=Fr);const $r=An.isMesh&&An.matrixWorld.determinant()<0,Xr=Qs(Jt,vn,$n,Wn,An);Ir.setMaterial(Wn,$r);let Yr=$n.index,ui=1;if(Wn.wireframe===!0){if(Yr=er.getWireframeAttribute($n),Yr===void 0)return;ui=2}const ii=$n.drawRange,jr=$n.attributes.position;let di=ii.start*ui,Pi=(ii.start+ii.count)*ui;Cr!==null&&(di=Math.max(di,Cr.start*ui),Pi=Math.min(Pi,(Cr.start+Cr.count)*ui)),Yr!==null?(di=Math.max(di,0),Pi=Math.min(Pi,Yr.count)):jr!=null&&(di=Math.max(di,0),Pi=Math.min(Pi,jr.count));const Ai=Pi-di;if(Ai<0||Ai===1/0)return;yi.setup(An,Wn,Xr,$n,Yr);let xa,Mi=oi;if(Yr!==null&&(xa=In.get(Yr),Mi=Gr,Mi.setIndex(xa)),An.isMesh)Wn.wireframe===!0?(Ir.setLineWidth(Wn.wireframeLinewidth*Kr()),Mi.setMode(on.LINES)):Mi.setMode(on.TRIANGLES);else if(An.isLine){let Jr=Wn.linewidth;Jr===void 0&&(Jr=1),Ir.setLineWidth(Jr*Kr()),An.isLineSegments?Mi.setMode(on.LINES):An.isLineLoop?Mi.setMode(on.LINE_LOOP):Mi.setMode(on.LINE_STRIP)}else An.isPoints?Mi.setMode(on.POINTS):An.isSprite&&Mi.setMode(on.TRIANGLES);if(An.isBatchedMesh)if(An._multiDrawInstances!==null)Mi.renderMultiDrawInstances(An._multiDrawStarts,An._multiDrawCounts,An._multiDrawCount,An._multiDrawInstances);else if(rr.get("WEBGL_multi_draw"))Mi.renderMultiDraw(An._multiDrawStarts,An._multiDrawCounts,An._multiDrawCount);else{const Jr=An._multiDrawStarts,Zi=An._multiDrawCounts,Ri=An._multiDrawCount,zi=Yr?In.get(Yr).bytesPerElement:1,Ws=Hr.get(Wn).currentProgram.getUniforms();for(let Da=0;Da<Ri;Da++)Ws.setValue(on,"_gl_DrawID",Da),Mi.render(Jr[Da]/zi,Zi[Da])}else if(An.isInstancedMesh)Mi.renderInstances(di,Ai,An.count);else if($n.isInstancedBufferGeometry){const Jr=$n._maxInstanceCount!==void 0?$n._maxInstanceCount:1/0,Zi=Math.min($n.instanceCount,Jr);Mi.renderInstances(di,Ai,Zi)}else Mi.render(di,Ai)};function Vi(Jt,vn,$n){Jt.transparent===!0&&Jt.side===DoubleSide$1&&Jt.forceSinglePass===!1?(Jt.side=BackSide$1,Jt.needsUpdate=!0,Hs(Jt,vn,$n),Jt.side=FrontSide$1,Jt.needsUpdate=!0,Hs(Jt,vn,$n),Jt.side=DoubleSide$1):Hs(Jt,vn,$n)}this.compile=function(Jt,vn,$n=null){$n===null&&($n=Jt),Be=Nr.get($n),Be.init(vn),qe.push(Be),$n.traverseVisible(function(An){An.isLight&&An.layers.test(vn.layers)&&(Be.pushLight(An),An.castShadow&&Be.pushShadow(An))}),Jt!==$n&&Jt.traverseVisible(function(An){An.isLight&&An.layers.test(vn.layers)&&(Be.pushLight(An),An.castShadow&&Be.pushShadow(An))}),Be.setupLights();const Wn=new Set;return Jt.traverse(function(An){const Cr=An.material;if(Cr)if(Array.isArray(Cr))for(let $r=0;$r<Cr.length;$r++){const Xr=Cr[$r];Vi(Xr,$n,An),Wn.add(Xr)}else Vi(Cr,$n,An),Wn.add(Cr)}),qe.pop(),Be=null,Wn},this.compileAsync=function(Jt,vn,$n=null){const Wn=this.compile(Jt,vn,$n);return new Promise(An=>{function Cr(){if(Wn.forEach(function($r){Hr.get($r).currentProgram.isReady()&&Wn.delete($r)}),Wn.size===0){An(Jt);return}setTimeout(Cr,10)}rr.get("KHR_parallel_shader_compile")!==null?Cr():setTimeout(Cr,10)})};let bi=null;function Ga(Jt){bi&&bi(Jt)}function Ra(){$i.stop()}function sa(){$i.start()}const $i=new WebGLAnimation;$i.setAnimationLoop(Ga),typeof self<"u"&&$i.setContext(self),this.setAnimationLoop=function(Jt){bi=Jt,Pr.setAnimationLoop(Jt),Jt===null?$i.stop():$i.start()},Pr.addEventListener("sessionstart",Ra),Pr.addEventListener("sessionend",sa),this.render=function(Jt,vn){if(vn!==void 0&&vn.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(Ye===!0)return;if(Jt.matrixWorldAutoUpdate===!0&&Jt.updateMatrixWorld(),vn.parent===null&&vn.matrixWorldAutoUpdate===!0&&vn.updateMatrixWorld(),Pr.enabled===!0&&Pr.isPresenting===!0&&(Pr.cameraAutoUpdate===!0&&Pr.updateCamera(vn),vn=Pr.getCamera()),Jt.isScene===!0&&Jt.onBeforeRender(Xe,Jt,vn,ot),Be=Nr.get(Jt,qe.length),Be.init(vn),qe.push(Be),Pn.multiplyMatrices(vn.projectionMatrix,vn.matrixWorldInverse),cn.setFromProjectionMatrix(Pn),yn=this.localClippingEnabled,en=vr.init(this.clippingPlanes,yn),De=zn.get(Jt,Ne.length),De.init(),Ne.push(De),Pr.enabled===!0&&Pr.isPresenting===!0){const Cr=Xe.xr.getDepthSensingMesh();Cr!==null&&Fi(Cr,vn,-1/0,Xe.sortObjects)}Fi(Jt,vn,0,Xe.sortObjects),De.finish(),Xe.sortObjects===!0&&De.sort(gt,Tt),Ur=Pr.enabled===!1||Pr.isPresenting===!1||Pr.hasDepthSensing()===!1,Ur&&zr.addToRenderList(De,Jt),this.info.render.frame++,en===!0&&vr.beginShadows();const $n=Be.state.shadowsArray;Sr.render($n,Jt,vn),en===!0&&vr.endShadows(),this.info.autoReset===!0&&this.info.reset();const Wn=De.opaque,An=De.transmissive;if(Be.setupLights(),vn.isArrayCamera){const Cr=vn.cameras;if(An.length>0)for(let $r=0,Xr=Cr.length;$r<Xr;$r++){const Yr=Cr[$r];ta(Wn,An,Jt,Yr)}Ur&&zr.render(Jt);for(let $r=0,Xr=Cr.length;$r<Xr;$r++){const Yr=Cr[$r];Ss(De,Jt,Yr,Yr.viewport)}}else An.length>0&&ta(Wn,An,Jt,vn),Ur&&zr.render(Jt),Ss(De,Jt,vn);ot!==null&&(Vr.updateMultisampleRenderTarget(ot),Vr.updateRenderTargetMipmap(ot)),Jt.isScene===!0&&Jt.onAfterRender(Xe,Jt,vn),yi.resetDefaultState(),ct=-1,mt=null,qe.pop(),qe.length>0?(Be=qe[qe.length-1],en===!0&&vr.setGlobalState(Xe.clippingPlanes,Be.state.camera)):Be=null,Ne.pop(),Ne.length>0?De=Ne[Ne.length-1]:De=null};function Fi(Jt,vn,$n,Wn){if(Jt.visible===!1)return;if(Jt.layers.test(vn.layers)){if(Jt.isGroup)$n=Jt.renderOrder;else if(Jt.isLOD)Jt.autoUpdate===!0&&Jt.update(vn);else if(Jt.isLight)Be.pushLight(Jt),Jt.castShadow&&Be.pushShadow(Jt);else if(Jt.isSprite){if(!Jt.frustumCulled||cn.intersectsSprite(Jt)){Wn&&nr.setFromMatrixPosition(Jt.matrixWorld).applyMatrix4(Pn);const $r=Hn.update(Jt),Xr=Jt.material;Xr.visible&&De.push(Jt,$r,Xr,$n,nr.z,null)}}else if((Jt.isMesh||Jt.isLine||Jt.isPoints)&&(!Jt.frustumCulled||cn.intersectsObject(Jt))){const $r=Hn.update(Jt),Xr=Jt.material;if(Wn&&(Jt.boundingSphere!==void 0?(Jt.boundingSphere===null&&Jt.computeBoundingSphere(),nr.copy(Jt.boundingSphere.center)):($r.boundingSphere===null&&$r.computeBoundingSphere(),nr.copy($r.boundingSphere.center)),nr.applyMatrix4(Jt.matrixWorld).applyMatrix4(Pn)),Array.isArray(Xr)){const Yr=$r.groups;for(let ui=0,ii=Yr.length;ui<ii;ui++){const jr=Yr[ui],di=Xr[jr.materialIndex];di&&di.visible&&De.push(Jt,$r,di,$n,nr.z,jr)}}else Xr.visible&&De.push(Jt,$r,Xr,$n,nr.z,null)}}const Cr=Jt.children;for(let $r=0,Xr=Cr.length;$r<Xr;$r++)Fi(Cr[$r],vn,$n,Wn)}function Ss(Jt,vn,$n,Wn){const An=Jt.opaque,Cr=Jt.transmissive,$r=Jt.transparent;Be.setupLightsView($n),en===!0&&vr.setGlobalState(Xe.clippingPlanes,$n),Wn&&Ir.viewport(_t.copy(Wn)),An.length>0&&Na(An,vn,$n),Cr.length>0&&Na(Cr,vn,$n),$r.length>0&&Na($r,vn,$n),Ir.buffers.depth.setTest(!0),Ir.buffers.depth.setMask(!0),Ir.buffers.color.setMask(!0),Ir.setPolygonOffset(!1)}function ta(Jt,vn,$n,Wn){if(($n.isScene===!0?$n.overrideMaterial:null)!==null)return;Be.state.transmissionRenderTarget[Wn.id]===void 0&&(Be.state.transmissionRenderTarget[Wn.id]=new WebGLRenderTarget(1,1,{generateMipmaps:!0,type:rr.has("EXT_color_buffer_half_float")||rr.has("EXT_color_buffer_float")?HalfFloatType$1:UnsignedByteType$1,minFilter:LinearMipmapLinearFilter$1,samples:4,stencilBuffer:re,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:ColorManagement$1.workingColorSpace}));const Cr=Be.state.transmissionRenderTarget[Wn.id],$r=Wn.viewport||_t;Cr.setSize($r.z,$r.w);const Xr=Xe.getRenderTarget();Xe.setRenderTarget(Cr),Xe.getClearColor(Gt),$t=Xe.getClearAlpha(),$t<1&&Xe.setClearColor(16777215,.5),Xe.clear(),Ur&&zr.render($n);const Yr=Xe.toneMapping;Xe.toneMapping=NoToneMapping;const ui=Wn.viewport;if(Wn.viewport!==void 0&&(Wn.viewport=void 0),Be.setupLightsView(Wn),en===!0&&vr.setGlobalState(Xe.clippingPlanes,Wn),Na(Jt,$n,Wn),Vr.updateMultisampleRenderTarget(Cr),Vr.updateRenderTargetMipmap(Cr),rr.has("WEBGL_multisampled_render_to_texture")===!1){let ii=!1;for(let jr=0,di=vn.length;jr<di;jr++){const Pi=vn[jr],Ai=Pi.object,xa=Pi.geometry,Mi=Pi.material,Jr=Pi.group;if(Mi.side===DoubleSide$1&&Ai.layers.test(Wn.layers)){const Zi=Mi.side;Mi.side=BackSide$1,Mi.needsUpdate=!0,is(Ai,$n,Wn,xa,Mi,Jr),Mi.side=Zi,Mi.needsUpdate=!0,ii=!0}}ii===!0&&(Vr.updateMultisampleRenderTarget(Cr),Vr.updateRenderTargetMipmap(Cr))}Xe.setRenderTarget(Xr),Xe.setClearColor(Gt,$t),ui!==void 0&&(Wn.viewport=ui),Xe.toneMapping=Yr}function Na(Jt,vn,$n){const Wn=vn.isScene===!0?vn.overrideMaterial:null;for(let An=0,Cr=Jt.length;An<Cr;An++){const $r=Jt[An],Xr=$r.object,Yr=$r.geometry,ui=Wn===null?$r.material:Wn,ii=$r.group;Xr.layers.test($n.layers)&&is(Xr,vn,$n,Yr,ui,ii)}}function is(Jt,vn,$n,Wn,An,Cr){Jt.onBeforeRender(Xe,vn,$n,Wn,An,Cr),Jt.modelViewMatrix.multiplyMatrices($n.matrixWorldInverse,Jt.matrixWorld),Jt.normalMatrix.getNormalMatrix(Jt.modelViewMatrix),An.onBeforeRender(Xe,vn,$n,Wn,Jt,Cr),An.transparent===!0&&An.side===DoubleSide$1&&An.forceSinglePass===!1?(An.side=BackSide$1,An.needsUpdate=!0,Xe.renderBufferDirect($n,vn,Wn,An,Jt,Cr),An.side=FrontSide$1,An.needsUpdate=!0,Xe.renderBufferDirect($n,vn,Wn,An,Jt,Cr),An.side=DoubleSide$1):Xe.renderBufferDirect($n,vn,Wn,An,Jt,Cr),Jt.onAfterRender(Xe,vn,$n,Wn,An,Cr)}function Hs(Jt,vn,$n){vn.isScene!==!0&&(vn=Fr);const Wn=Hr.get(Jt),An=Be.state.lights,Cr=Be.state.shadowsArray,$r=An.state.version,Xr=Zn.getParameters(Jt,An.state,Cr,vn,$n),Yr=Zn.getProgramCacheKey(Xr);let ui=Wn.programs;Wn.environment=Jt.isMeshStandardMaterial?vn.environment:null,Wn.fog=vn.fog,Wn.envMap=(Jt.isMeshStandardMaterial?Ht:xn).get(Jt.envMap||Wn.environment),Wn.envMapRotation=Wn.environment!==null&&Jt.envMap===null?vn.environmentRotation:Jt.envMapRotation,ui===void 0&&(Jt.addEventListener("dispose",ci),ui=new Map,Wn.programs=ui);let ii=ui.get(Yr);if(ii!==void 0){if(Wn.currentProgram===ii&&Wn.lightsStateVersion===$r)return v0(Jt,Xr),ii}else Xr.uniforms=Zn.getUniforms(Jt),Jt.onBeforeCompile(Xr,Xe),ii=Zn.acquireProgram(Xr,Yr),ui.set(Yr,ii),Wn.uniforms=Xr.uniforms;const jr=Wn.uniforms;return(!Jt.isShaderMaterial&&!Jt.isRawShaderMaterial||Jt.clipping===!0)&&(jr.clippingPlanes=vr.uniform),v0(Jt,Xr),Wn.needsLights=as(Jt),Wn.lightsStateVersion=$r,Wn.needsLights&&(jr.ambientLightColor.value=An.state.ambient,jr.lightProbe.value=An.state.probe,jr.directionalLights.value=An.state.directional,jr.directionalLightShadows.value=An.state.directionalShadow,jr.spotLights.value=An.state.spot,jr.spotLightShadows.value=An.state.spotShadow,jr.rectAreaLights.value=An.state.rectArea,jr.ltc_1.value=An.state.rectAreaLTC1,jr.ltc_2.value=An.state.rectAreaLTC2,jr.pointLights.value=An.state.point,jr.pointLightShadows.value=An.state.pointShadow,jr.hemisphereLights.value=An.state.hemi,jr.directionalShadowMap.value=An.state.directionalShadowMap,jr.directionalShadowMatrix.value=An.state.directionalShadowMatrix,jr.spotShadowMap.value=An.state.spotShadowMap,jr.spotLightMatrix.value=An.state.spotLightMatrix,jr.spotLightMap.value=An.state.spotLightMap,jr.pointShadowMap.value=An.state.pointShadowMap,jr.pointShadowMatrix.value=An.state.pointShadowMatrix),Wn.currentProgram=ii,Wn.uniformsList=null,ii}function $s(Jt){if(Jt.uniformsList===null){const vn=Jt.currentProgram.getUniforms();Jt.uniformsList=WebGLUniforms.seqWithValue(vn.seq,Jt.uniforms)}return Jt.uniformsList}function v0(Jt,vn){const $n=Hr.get(Jt);$n.outputColorSpace=vn.outputColorSpace,$n.batching=vn.batching,$n.batchingColor=vn.batchingColor,$n.instancing=vn.instancing,$n.instancingColor=vn.instancingColor,$n.instancingMorph=vn.instancingMorph,$n.skinning=vn.skinning,$n.morphTargets=vn.morphTargets,$n.morphNormals=vn.morphNormals,$n.morphColors=vn.morphColors,$n.morphTargetsCount=vn.morphTargetsCount,$n.numClippingPlanes=vn.numClippingPlanes,$n.numIntersection=vn.numClipIntersection,$n.vertexAlphas=vn.vertexAlphas,$n.vertexTangents=vn.vertexTangents,$n.toneMapping=vn.toneMapping}function Qs(Jt,vn,$n,Wn,An){vn.isScene!==!0&&(vn=Fr),Vr.resetTextureUnits();const Cr=vn.fog,$r=Wn.isMeshStandardMaterial?vn.environment:null,Xr=ot===null?Xe.outputColorSpace:ot.isXRRenderTarget===!0?ot.texture.colorSpace:LinearSRGBColorSpace$1,Yr=(Wn.isMeshStandardMaterial?Ht:xn).get(Wn.envMap||$r),ui=Wn.vertexColors===!0&&!!$n.attributes.color&&$n.attributes.color.itemSize===4,ii=!!$n.attributes.tangent&&(!!Wn.normalMap||Wn.anisotropy>0),jr=!!$n.morphAttributes.position,di=!!$n.morphAttributes.normal,Pi=!!$n.morphAttributes.color;let Ai=NoToneMapping;Wn.toneMapped&&(ot===null||ot.isXRRenderTarget===!0)&&(Ai=Xe.toneMapping);const xa=$n.morphAttributes.position||$n.morphAttributes.normal||$n.morphAttributes.color,Mi=xa!==void 0?xa.length:0,Jr=Hr.get(Wn),Zi=Be.state.lights;if(en===!0&&(yn===!0||Jt!==mt)){const Di=Jt===mt&&Wn.id===ct;vr.setState(Wn,Jt,Di)}let Ri=!1;Wn.version===Jr.__version?(Jr.needsLights&&Jr.lightsStateVersion!==Zi.state.version||Jr.outputColorSpace!==Xr||An.isBatchedMesh&&Jr.batching===!1||!An.isBatchedMesh&&Jr.batching===!0||An.isBatchedMesh&&Jr.batchingColor===!0&&An.colorTexture===null||An.isBatchedMesh&&Jr.batchingColor===!1&&An.colorTexture!==null||An.isInstancedMesh&&Jr.instancing===!1||!An.isInstancedMesh&&Jr.instancing===!0||An.isSkinnedMesh&&Jr.skinning===!1||!An.isSkinnedMesh&&Jr.skinning===!0||An.isInstancedMesh&&Jr.instancingColor===!0&&An.instanceColor===null||An.isInstancedMesh&&Jr.instancingColor===!1&&An.instanceColor!==null||An.isInstancedMesh&&Jr.instancingMorph===!0&&An.morphTexture===null||An.isInstancedMesh&&Jr.instancingMorph===!1&&An.morphTexture!==null||Jr.envMap!==Yr||Wn.fog===!0&&Jr.fog!==Cr||Jr.numClippingPlanes!==void 0&&(Jr.numClippingPlanes!==vr.numPlanes||Jr.numIntersection!==vr.numIntersection)||Jr.vertexAlphas!==ui||Jr.vertexTangents!==ii||Jr.morphTargets!==jr||Jr.morphNormals!==di||Jr.morphColors!==Pi||Jr.toneMapping!==Ai||Jr.morphTargetsCount!==Mi)&&(Ri=!0):(Ri=!0,Jr.__version=Wn.version);let zi=Jr.currentProgram;Ri===!0&&(zi=Hs(Wn,vn,An));let Ws=!1,Da=!1,Js=!1;const Ji=zi.getUniforms(),ss=Jr.uniforms;if(Ir.useProgram(zi.program)&&(Ws=!0,Da=!0,Js=!0),Wn.id!==ct&&(ct=Wn.id,Da=!0),Ws||mt!==Jt){Ji.setValue(on,"projectionMatrix",Jt.projectionMatrix),Ji.setValue(on,"viewMatrix",Jt.matrixWorldInverse);const Di=Ji.map.cameraPosition;Di!==void 0&&Di.setValue(on,tr.setFromMatrixPosition(Jt.matrixWorld)),Qr.logarithmicDepthBuffer&&Ji.setValue(on,"logDepthBufFC",2/(Math.log(Jt.far+1)/Math.LN2)),(Wn.isMeshPhongMaterial||Wn.isMeshToonMaterial||Wn.isMeshLambertMaterial||Wn.isMeshBasicMaterial||Wn.isMeshStandardMaterial||Wn.isShaderMaterial)&&Ji.setValue(on,"isOrthographic",Jt.isOrthographicCamera===!0),mt!==Jt&&(mt=Jt,Da=!0,Js=!0)}if(An.isSkinnedMesh){Ji.setOptional(on,An,"bindMatrix"),Ji.setOptional(on,An,"bindMatrixInverse");const Di=An.skeleton;Di&&(Di.boneTexture===null&&Di.computeBoneTexture(),Ji.setValue(on,"boneTexture",Di.boneTexture,Vr))}An.isBatchedMesh&&(Ji.setOptional(on,An,"batchingTexture"),Ji.setValue(on,"batchingTexture",An._matricesTexture,Vr),Ji.setOptional(on,An,"batchingIdTexture"),Ji.setValue(on,"batchingIdTexture",An._indirectTexture,Vr),Ji.setOptional(on,An,"batchingColorTexture"),An._colorsTexture!==null&&Ji.setValue(on,"batchingColorTexture",An._colorsTexture,Vr));const qs=$n.morphAttributes;if((qs.position!==void 0||qs.normal!==void 0||qs.color!==void 0)&&gi.update(An,$n,zi),(Da||Jr.receiveShadow!==An.receiveShadow)&&(Jr.receiveShadow=An.receiveShadow,Ji.setValue(on,"receiveShadow",An.receiveShadow)),Wn.isMeshGouraudMaterial&&Wn.envMap!==null&&(ss.envMap.value=Yr,ss.flipEnvMap.value=Yr.isCubeTexture&&Yr.isRenderTargetTexture===!1?-1:1),Wn.isMeshStandardMaterial&&Wn.envMap===null&&vn.environment!==null&&(ss.envMapIntensity.value=vn.environmentIntensity),Da&&(Ji.setValue(on,"toneMappingExposure",Xe.toneMappingExposure),Jr.needsLights&&Zs(ss,Js),Cr&&Wn.fog===!0&&Dr.refreshFogUniforms(ss,Cr),Dr.refreshMaterialUniforms(ss,Wn,It,vt,Be.state.transmissionRenderTarget[Jt.id]),WebGLUniforms.upload(on,$s(Jr),ss,Vr)),Wn.isShaderMaterial&&Wn.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(on,$s(Jr),ss,Vr),Wn.uniformsNeedUpdate=!1),Wn.isSpriteMaterial&&Ji.setValue(on,"center",An.center),Ji.setValue(on,"modelViewMatrix",An.modelViewMatrix),Ji.setValue(on,"normalMatrix",An.normalMatrix),Ji.setValue(on,"modelMatrix",An.matrixWorld),Wn.isShaderMaterial||Wn.isRawShaderMaterial){const Di=Wn.uniformsGroups;for(let Ts=0,Pa=Di.length;Ts<Pa;Ts++){const js=Di[Ts];Ci.update(js,zi),Ci.bind(js,zi)}}return zi}function Zs(Jt,vn){Jt.ambientLightColor.needsUpdate=vn,Jt.lightProbe.needsUpdate=vn,Jt.directionalLights.needsUpdate=vn,Jt.directionalLightShadows.needsUpdate=vn,Jt.pointLights.needsUpdate=vn,Jt.pointLightShadows.needsUpdate=vn,Jt.spotLights.needsUpdate=vn,Jt.spotLightShadows.needsUpdate=vn,Jt.rectAreaLights.needsUpdate=vn,Jt.hemisphereLights.needsUpdate=vn}function as(Jt){return Jt.isMeshLambertMaterial||Jt.isMeshToonMaterial||Jt.isMeshPhongMaterial||Jt.isMeshStandardMaterial||Jt.isShadowMaterial||Jt.isShaderMaterial&&Jt.lights===!0}this.getActiveCubeFace=function(){return Qe},this.getActiveMipmapLevel=function(){return rt},this.getRenderTarget=function(){return ot},this.setRenderTargetTextures=function(Jt,vn,$n){Hr.get(Jt.texture).__webglTexture=vn,Hr.get(Jt.depthTexture).__webglTexture=$n;const Wn=Hr.get(Jt);Wn.__hasExternalTextures=!0,Wn.__autoAllocateDepthBuffer=$n===void 0,Wn.__autoAllocateDepthBuffer||rr.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Wn.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(Jt,vn){const $n=Hr.get(Jt);$n.__webglFramebuffer=vn,$n.__useDefaultFramebuffer=vn===void 0},this.setRenderTarget=function(Jt,vn=0,$n=0){ot=Jt,Qe=vn,rt=$n;let Wn=!0,An=null,Cr=!1,$r=!1;if(Jt){const Yr=Hr.get(Jt);if(Yr.__useDefaultFramebuffer!==void 0)Ir.bindFramebuffer(on.FRAMEBUFFER,null),Wn=!1;else if(Yr.__webglFramebuffer===void 0)Vr.setupRenderTarget(Jt);else if(Yr.__hasExternalTextures)Vr.rebindTextures(Jt,Hr.get(Jt.texture).__webglTexture,Hr.get(Jt.depthTexture).__webglTexture);else if(Jt.depthBuffer){const jr=Jt.depthTexture;if(Yr.__boundDepthTexture!==jr){if(jr!==null&&Hr.has(jr)&&(Jt.width!==jr.image.width||Jt.height!==jr.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Vr.setupDepthRenderbuffer(Jt)}}const ui=Jt.texture;(ui.isData3DTexture||ui.isDataArrayTexture||ui.isCompressedArrayTexture)&&($r=!0);const ii=Hr.get(Jt).__webglFramebuffer;Jt.isWebGLCubeRenderTarget?(Array.isArray(ii[vn])?An=ii[vn][$n]:An=ii[vn],Cr=!0):Jt.samples>0&&Vr.useMultisampledRTT(Jt)===!1?An=Hr.get(Jt).__webglMultisampledFramebuffer:Array.isArray(ii)?An=ii[$n]:An=ii,_t.copy(Jt.viewport),Lt.copy(Jt.scissor),Vt=Jt.scissorTest}else _t.copy(Ct).multiplyScalar(It).floor(),Lt.copy(Ft).multiplyScalar(It).floor(),Vt=sn;if(Ir.bindFramebuffer(on.FRAMEBUFFER,An)&&Wn&&Ir.drawBuffers(Jt,An),Ir.viewport(_t),Ir.scissor(Lt),Ir.setScissorTest(Vt),Cr){const Yr=Hr.get(Jt.texture);on.framebufferTexture2D(on.FRAMEBUFFER,on.COLOR_ATTACHMENT0,on.TEXTURE_CUBE_MAP_POSITIVE_X+vn,Yr.__webglTexture,$n)}else if($r){const Yr=Hr.get(Jt.texture),ui=vn||0;on.framebufferTextureLayer(on.FRAMEBUFFER,on.COLOR_ATTACHMENT0,Yr.__webglTexture,$n||0,ui)}ct=-1},this.readRenderTargetPixels=function(Jt,vn,$n,Wn,An,Cr,$r){if(!(Jt&&Jt.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Xr=Hr.get(Jt).__webglFramebuffer;if(Jt.isWebGLCubeRenderTarget&&$r!==void 0&&(Xr=Xr[$r]),Xr){Ir.bindFramebuffer(on.FRAMEBUFFER,Xr);try{const Yr=Jt.texture,ui=Yr.format,ii=Yr.type;if(!Qr.textureFormatReadable(ui)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Qr.textureTypeReadable(ii)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}vn>=0&&vn<=Jt.width-Wn&&$n>=0&&$n<=Jt.height-An&&on.readPixels(vn,$n,Wn,An,ri.convert(ui),ri.convert(ii),Cr)}finally{const Yr=ot!==null?Hr.get(ot).__webglFramebuffer:null;Ir.bindFramebuffer(on.FRAMEBUFFER,Yr)}}},this.readRenderTargetPixelsAsync=async function(Jt,vn,$n,Wn,An,Cr,$r){if(!(Jt&&Jt.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Xr=Hr.get(Jt).__webglFramebuffer;if(Jt.isWebGLCubeRenderTarget&&$r!==void 0&&(Xr=Xr[$r]),Xr){Ir.bindFramebuffer(on.FRAMEBUFFER,Xr);try{const Yr=Jt.texture,ui=Yr.format,ii=Yr.type;if(!Qr.textureFormatReadable(ui))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Qr.textureTypeReadable(ii))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(vn>=0&&vn<=Jt.width-Wn&&$n>=0&&$n<=Jt.height-An){const jr=on.createBuffer();on.bindBuffer(on.PIXEL_PACK_BUFFER,jr),on.bufferData(on.PIXEL_PACK_BUFFER,Cr.byteLength,on.STREAM_READ),on.readPixels(vn,$n,Wn,An,ri.convert(ui),ri.convert(ii),0),on.flush();const di=on.fenceSync(on.SYNC_GPU_COMMANDS_COMPLETE,0);await probeAsync(on,di,4);try{on.bindBuffer(on.PIXEL_PACK_BUFFER,jr),on.getBufferSubData(on.PIXEL_PACK_BUFFER,0,Cr)}finally{on.deleteBuffer(jr),on.deleteSync(di)}return Cr}}finally{const Yr=ot!==null?Hr.get(ot).__webglFramebuffer:null;Ir.bindFramebuffer(on.FRAMEBUFFER,Yr)}}},this.copyFramebufferToTexture=function(Jt,vn=null,$n=0){Jt.isTexture!==!0&&(warnOnce$1("WebGLRenderer: copyFramebufferToTexture function signature has changed."),vn=arguments[0]||null,Jt=arguments[1]);const Wn=Math.pow(2,-$n),An=Math.floor(Jt.image.width*Wn),Cr=Math.floor(Jt.image.height*Wn),$r=vn!==null?vn.x:0,Xr=vn!==null?vn.y:0;Vr.setTexture2D(Jt,0),on.copyTexSubImage2D(on.TEXTURE_2D,$n,0,0,$r,Xr,An,Cr),Ir.unbindTexture()},this.copyTextureToTexture=function(Jt,vn,$n=null,Wn=null,An=0){Jt.isTexture!==!0&&(warnOnce$1("WebGLRenderer: copyTextureToTexture function signature has changed."),Wn=arguments[0]||null,Jt=arguments[1],vn=arguments[2],An=arguments[3]||0,$n=null);let Cr,$r,Xr,Yr,ui,ii;$n!==null?(Cr=$n.max.x-$n.min.x,$r=$n.max.y-$n.min.y,Xr=$n.min.x,Yr=$n.min.y):(Cr=Jt.image.width,$r=Jt.image.height,Xr=0,Yr=0),Wn!==null?(ui=Wn.x,ii=Wn.y):(ui=0,ii=0);const jr=ri.convert(vn.format),di=ri.convert(vn.type);Vr.setTexture2D(vn,0),on.pixelStorei(on.UNPACK_FLIP_Y_WEBGL,vn.flipY),on.pixelStorei(on.UNPACK_PREMULTIPLY_ALPHA_WEBGL,vn.premultiplyAlpha),on.pixelStorei(on.UNPACK_ALIGNMENT,vn.unpackAlignment);const Pi=on.getParameter(on.UNPACK_ROW_LENGTH),Ai=on.getParameter(on.UNPACK_IMAGE_HEIGHT),xa=on.getParameter(on.UNPACK_SKIP_PIXELS),Mi=on.getParameter(on.UNPACK_SKIP_ROWS),Jr=on.getParameter(on.UNPACK_SKIP_IMAGES),Zi=Jt.isCompressedTexture?Jt.mipmaps[An]:Jt.image;on.pixelStorei(on.UNPACK_ROW_LENGTH,Zi.width),on.pixelStorei(on.UNPACK_IMAGE_HEIGHT,Zi.height),on.pixelStorei(on.UNPACK_SKIP_PIXELS,Xr),on.pixelStorei(on.UNPACK_SKIP_ROWS,Yr),Jt.isDataTexture?on.texSubImage2D(on.TEXTURE_2D,An,ui,ii,Cr,$r,jr,di,Zi.data):Jt.isCompressedTexture?on.compressedTexSubImage2D(on.TEXTURE_2D,An,ui,ii,Zi.width,Zi.height,jr,Zi.data):on.texSubImage2D(on.TEXTURE_2D,An,ui,ii,Cr,$r,jr,di,Zi),on.pixelStorei(on.UNPACK_ROW_LENGTH,Pi),on.pixelStorei(on.UNPACK_IMAGE_HEIGHT,Ai),on.pixelStorei(on.UNPACK_SKIP_PIXELS,xa),on.pixelStorei(on.UNPACK_SKIP_ROWS,Mi),on.pixelStorei(on.UNPACK_SKIP_IMAGES,Jr),An===0&&vn.generateMipmaps&&on.generateMipmap(on.TEXTURE_2D),Ir.unbindTexture()},this.copyTextureToTexture3D=function(Jt,vn,$n=null,Wn=null,An=0){Jt.isTexture!==!0&&(warnOnce$1("WebGLRenderer: copyTextureToTexture3D function signature has changed."),$n=arguments[0]||null,Wn=arguments[1]||null,Jt=arguments[2],vn=arguments[3],An=arguments[4]||0);let Cr,$r,Xr,Yr,ui,ii,jr,di,Pi;const Ai=Jt.isCompressedTexture?Jt.mipmaps[An]:Jt.image;$n!==null?(Cr=$n.max.x-$n.min.x,$r=$n.max.y-$n.min.y,Xr=$n.max.z-$n.min.z,Yr=$n.min.x,ui=$n.min.y,ii=$n.min.z):(Cr=Ai.width,$r=Ai.height,Xr=Ai.depth,Yr=0,ui=0,ii=0),Wn!==null?(jr=Wn.x,di=Wn.y,Pi=Wn.z):(jr=0,di=0,Pi=0);const xa=ri.convert(vn.format),Mi=ri.convert(vn.type);let Jr;if(vn.isData3DTexture)Vr.setTexture3D(vn,0),Jr=on.TEXTURE_3D;else if(vn.isDataArrayTexture||vn.isCompressedArrayTexture)Vr.setTexture2DArray(vn,0),Jr=on.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}on.pixelStorei(on.UNPACK_FLIP_Y_WEBGL,vn.flipY),on.pixelStorei(on.UNPACK_PREMULTIPLY_ALPHA_WEBGL,vn.premultiplyAlpha),on.pixelStorei(on.UNPACK_ALIGNMENT,vn.unpackAlignment);const Zi=on.getParameter(on.UNPACK_ROW_LENGTH),Ri=on.getParameter(on.UNPACK_IMAGE_HEIGHT),zi=on.getParameter(on.UNPACK_SKIP_PIXELS),Ws=on.getParameter(on.UNPACK_SKIP_ROWS),Da=on.getParameter(on.UNPACK_SKIP_IMAGES);on.pixelStorei(on.UNPACK_ROW_LENGTH,Ai.width),on.pixelStorei(on.UNPACK_IMAGE_HEIGHT,Ai.height),on.pixelStorei(on.UNPACK_SKIP_PIXELS,Yr),on.pixelStorei(on.UNPACK_SKIP_ROWS,ui),on.pixelStorei(on.UNPACK_SKIP_IMAGES,ii),Jt.isDataTexture||Jt.isData3DTexture?on.texSubImage3D(Jr,An,jr,di,Pi,Cr,$r,Xr,xa,Mi,Ai.data):vn.isCompressedArrayTexture?on.compressedTexSubImage3D(Jr,An,jr,di,Pi,Cr,$r,Xr,xa,Ai.data):on.texSubImage3D(Jr,An,jr,di,Pi,Cr,$r,Xr,xa,Mi,Ai),on.pixelStorei(on.UNPACK_ROW_LENGTH,Zi),on.pixelStorei(on.UNPACK_IMAGE_HEIGHT,Ri),on.pixelStorei(on.UNPACK_SKIP_PIXELS,zi),on.pixelStorei(on.UNPACK_SKIP_ROWS,Ws),on.pixelStorei(on.UNPACK_SKIP_IMAGES,Da),An===0&&vn.generateMipmaps&&on.generateMipmap(Jr),Ir.unbindTexture()},this.initRenderTarget=function(Jt){Hr.get(Jt).__webglFramebuffer===void 0&&Vr.setupRenderTarget(Jt)},this.initTexture=function(Jt){Jt.isCubeTexture?Vr.setTextureCube(Jt,0):Jt.isData3DTexture?Vr.setTexture3D(Jt,0):Jt.isDataArrayTexture||Jt.isCompressedArrayTexture?Vr.setTexture2DArray(Jt,0):Vr.setTexture2D(Jt,0),Ir.unbindTexture()},this.resetState=function(){Qe=0,rt=0,ot=null,Ir.reset(),yi.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WebGLCoordinateSystem$1}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(_){this._outputColorSpace=_;const b=this.getContext();b.drawingBufferColorSpace=_===DisplayP3ColorSpace$1?"display-p3":"srgb",b.unpackColorSpace=ColorManagement$1.workingColorSpace===LinearDisplayP3ColorSpace$1?"display-p3":"srgb"}}class Scene extends Object3D$1{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Euler$1,this.environmentIntensity=1,this.environmentRotation=new Euler$1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(_,b){return super.copy(_,b),_.background!==null&&(this.background=_.background.clone()),_.environment!==null&&(this.environment=_.environment.clone()),_.fog!==null&&(this.fog=_.fog.clone()),this.backgroundBlurriness=_.backgroundBlurriness,this.backgroundIntensity=_.backgroundIntensity,this.backgroundRotation.copy(_.backgroundRotation),this.environmentIntensity=_.environmentIntensity,this.environmentRotation.copy(_.environmentRotation),_.overrideMaterial!==null&&(this.overrideMaterial=_.overrideMaterial.clone()),this.matrixAutoUpdate=_.matrixAutoUpdate,this}toJSON(_){const b=super.toJSON(_);return this.fog!==null&&(b.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(b.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(b.object.backgroundIntensity=this.backgroundIntensity),b.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(b.object.environmentIntensity=this.environmentIntensity),b.object.environmentRotation=this.environmentRotation.toArray(),b}}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="168",FrontSide=0,BackSide=1,DoubleSide=2,NormalBlending=1,AddEquation=100,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,LessEqualDepth=3,MultiplyOperation=0,AttachedBindMode="attached",DetachedBindMode="detached",UVMapping=300,EquirectangularReflectionMapping=303,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipmapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipmapLinearFilter=1008,UnsignedByteType=1009,FloatType=1015,HalfFloatType=1016,RGBAFormat=1023,RedFormat=1028,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,TangentSpaceNormalMap=0,NoColorSpace="",SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DisplayP3ColorSpace="display-p3",LinearDisplayP3ColorSpace="display-p3-linear",LinearTransfer="linear",SRGBTransfer="srgb",Rec709Primaries="rec709",P3Primaries="p3",KeepStencilOp=7680,AlwaysStencilFunc=519,StaticDrawUsage=35044,WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001;class EventDispatcher{addEventListener(_,b){this._listeners===void 0&&(this._listeners={});const $=this._listeners;$[_]===void 0&&($[_]=[]),$[_].indexOf(b)===-1&&$[_].push(b)}hasEventListener(_,b){if(this._listeners===void 0)return!1;const $=this._listeners;return $[_]!==void 0&&$[_].indexOf(b)!==-1}removeEventListener(_,b){if(this._listeners===void 0)return;const ee=this._listeners[_];if(ee!==void 0){const re=ee.indexOf(b);re!==-1&&ee.splice(re,1)}}dispatchEvent(_){if(this._listeners===void 0)return;const $=this._listeners[_.type];if($!==void 0){_.target=this;const ee=$.slice(0);for(let re=0,ae=ee.length;re<ae;re++)ee[re].call(this,_);_.target=null}}}const _lut=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID(){const H=Math.random()*4294967295|0,_=Math.random()*4294967295|0,b=Math.random()*4294967295|0,$=Math.random()*4294967295|0;return(_lut[H&255]+_lut[H>>8&255]+_lut[H>>16&255]+_lut[H>>24&255]+"-"+_lut[_&255]+_lut[_>>8&255]+"-"+_lut[_>>16&15|64]+_lut[_>>24&255]+"-"+_lut[b&63|128]+_lut[b>>8&255]+"-"+_lut[b>>16&255]+_lut[b>>24&255]+_lut[$&255]+_lut[$>>8&255]+_lut[$>>16&255]+_lut[$>>24&255]).toLowerCase()}function clamp(H,_,b){return Math.max(_,Math.min(b,H))}function euclideanModulo(H,_){return(H%_+_)%_}function mapLinear(H,_,b,$,ee){return $+(H-_)*(ee-$)/(b-_)}function inverseLerp(H,_,b){return H!==_?(b-H)/(_-H):0}function lerp(H,_,b){return(1-b)*H+b*_}function damp(H,_,b,$){return lerp(H,_,1-Math.exp(-b*$))}function pingpong(H,_=1){return _-Math.abs(euclideanModulo(H,_*2)-_)}function smoothstep(H,_,b){return H<=_?0:H>=b?1:(H=(H-_)/(b-_),H*H*(3-2*H))}function smootherstep(H,_,b){return H<=_?0:H>=b?1:(H=(H-_)/(b-_),H*H*H*(H*(H*6-15)+10))}function randInt(H,_){return H+Math.floor(Math.random()*(_-H+1))}function randFloat(H,_){return H+Math.random()*(_-H)}function randFloatSpread(H){return H*(.5-Math.random())}function seededRandom(H){H!==void 0&&(_seed=H);let _=_seed+=1831565813;return _=Math.imul(_^_>>>15,_|1),_^=_+Math.imul(_^_>>>7,_|61),((_^_>>>14)>>>0)/4294967296}function degToRad(H){return H*DEG2RAD}function radToDeg(H){return H*RAD2DEG}function isPowerOfTwo(H){return(H&H-1)===0&&H!==0}function ceilPowerOfTwo(H){return Math.pow(2,Math.ceil(Math.log(H)/Math.LN2))}function floorPowerOfTwo(H){return Math.pow(2,Math.floor(Math.log(H)/Math.LN2))}function setQuaternionFromProperEuler(H,_,b,$,ee){const re=Math.cos,ae=Math.sin,xe=re(b/2),le=ae(b/2),fe=re((_+$)/2),ve=ae((_+$)/2),Se=re((_-$)/2),Ee=ae((_-$)/2),Ce=re(($-_)/2),Ie=ae(($-_)/2);switch(ee){case"XYX":H.set(xe*ve,le*Se,le*Ee,xe*fe);break;case"YZY":H.set(le*Ee,xe*ve,le*Se,xe*fe);break;case"ZXZ":H.set(le*Se,le*Ee,xe*ve,xe*fe);break;case"XZX":H.set(xe*ve,le*Ie,le*Ce,xe*fe);break;case"YXY":H.set(le*Ce,xe*ve,le*Ie,xe*fe);break;case"ZYZ":H.set(le*Ie,le*Ce,xe*ve,xe*fe);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+ee)}}function denormalize(H,_){switch(_.constructor){case Float32Array:return H;case Uint32Array:return H/4294967295;case Uint16Array:return H/65535;case Uint8Array:return H/255;case Int32Array:return Math.max(H/2147483647,-1);case Int16Array:return Math.max(H/32767,-1);case Int8Array:return Math.max(H/127,-1);default:throw new Error("Invalid component type.")}}function normalize(H,_){switch(_.constructor){case Float32Array:return H;case Uint32Array:return Math.round(H*4294967295);case Uint16Array:return Math.round(H*65535);case Uint8Array:return Math.round(H*255);case Int32Array:return Math.round(H*2147483647);case Int16Array:return Math.round(H*32767);case Int8Array:return Math.round(H*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID,clamp,euclideanModulo,mapLinear,inverseLerp,lerp,damp,pingpong,smoothstep,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize,denormalize};class Vector2{constructor(_=0,b=0){Vector2.prototype.isVector2=!0,this.x=_,this.y=b}get width(){return this.x}set width(_){this.x=_}get height(){return this.y}set height(_){this.y=_}set(_,b){return this.x=_,this.y=b,this}setScalar(_){return this.x=_,this.y=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setComponent(_,b){switch(_){case 0:this.x=b;break;case 1:this.y=b;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y)}copy(_){return this.x=_.x,this.y=_.y,this}add(_){return this.x+=_.x,this.y+=_.y,this}addScalar(_){return this.x+=_,this.y+=_,this}addVectors(_,b){return this.x=_.x+b.x,this.y=_.y+b.y,this}addScaledVector(_,b){return this.x+=_.x*b,this.y+=_.y*b,this}sub(_){return this.x-=_.x,this.y-=_.y,this}subScalar(_){return this.x-=_,this.y-=_,this}subVectors(_,b){return this.x=_.x-b.x,this.y=_.y-b.y,this}multiply(_){return this.x*=_.x,this.y*=_.y,this}multiplyScalar(_){return this.x*=_,this.y*=_,this}divide(_){return this.x/=_.x,this.y/=_.y,this}divideScalar(_){return this.multiplyScalar(1/_)}applyMatrix3(_){const b=this.x,$=this.y,ee=_.elements;return this.x=ee[0]*b+ee[3]*$+ee[6],this.y=ee[1]*b+ee[4]*$+ee[7],this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this}clamp(_,b){return this.x=Math.max(_.x,Math.min(b.x,this.x)),this.y=Math.max(_.y,Math.min(b.y,this.y)),this}clampScalar(_,b){return this.x=Math.max(_,Math.min(b,this.x)),this.y=Math.max(_,Math.min(b,this.y)),this}clampLength(_,b){const $=this.length();return this.divideScalar($||1).multiplyScalar(Math.max(_,Math.min(b,$)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(_){return this.x*_.x+this.y*_.y}cross(_){return this.x*_.y-this.y*_.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(_){const b=Math.sqrt(this.lengthSq()*_.lengthSq());if(b===0)return Math.PI/2;const $=this.dot(_)/b;return Math.acos(clamp($,-1,1))}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const b=this.x-_.x,$=this.y-_.y;return b*b+$*$}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,b){return this.x+=(_.x-this.x)*b,this.y+=(_.y-this.y)*b,this}lerpVectors(_,b,$){return this.x=_.x+(b.x-_.x)*$,this.y=_.y+(b.y-_.y)*$,this}equals(_){return _.x===this.x&&_.y===this.y}fromArray(_,b=0){return this.x=_[b],this.y=_[b+1],this}toArray(_=[],b=0){return _[b]=this.x,_[b+1]=this.y,_}fromBufferAttribute(_,b){return this.x=_.getX(b),this.y=_.getY(b),this}rotateAround(_,b){const $=Math.cos(b),ee=Math.sin(b),re=this.x-_.x,ae=this.y-_.y;return this.x=re*$-ae*ee+_.x,this.y=re*ee+ae*$+_.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(_,b,$,ee,re,ae,xe,le,fe){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],_!==void 0&&this.set(_,b,$,ee,re,ae,xe,le,fe)}set(_,b,$,ee,re,ae,xe,le,fe){const ve=this.elements;return ve[0]=_,ve[1]=ee,ve[2]=xe,ve[3]=b,ve[4]=re,ve[5]=le,ve[6]=$,ve[7]=ae,ve[8]=fe,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_){const b=this.elements,$=_.elements;return b[0]=$[0],b[1]=$[1],b[2]=$[2],b[3]=$[3],b[4]=$[4],b[5]=$[5],b[6]=$[6],b[7]=$[7],b[8]=$[8],this}extractBasis(_,b,$){return _.setFromMatrix3Column(this,0),b.setFromMatrix3Column(this,1),$.setFromMatrix3Column(this,2),this}setFromMatrix4(_){const b=_.elements;return this.set(b[0],b[4],b[8],b[1],b[5],b[9],b[2],b[6],b[10]),this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,b){const $=_.elements,ee=b.elements,re=this.elements,ae=$[0],xe=$[3],le=$[6],fe=$[1],ve=$[4],Se=$[7],Ee=$[2],Ce=$[5],Ie=$[8],De=ee[0],Be=ee[3],Ne=ee[6],qe=ee[1],Xe=ee[4],Ye=ee[7],Qe=ee[2],rt=ee[5],ot=ee[8];return re[0]=ae*De+xe*qe+le*Qe,re[3]=ae*Be+xe*Xe+le*rt,re[6]=ae*Ne+xe*Ye+le*ot,re[1]=fe*De+ve*qe+Se*Qe,re[4]=fe*Be+ve*Xe+Se*rt,re[7]=fe*Ne+ve*Ye+Se*ot,re[2]=Ee*De+Ce*qe+Ie*Qe,re[5]=Ee*Be+Ce*Xe+Ie*rt,re[8]=Ee*Ne+Ce*Ye+Ie*ot,this}multiplyScalar(_){const b=this.elements;return b[0]*=_,b[3]*=_,b[6]*=_,b[1]*=_,b[4]*=_,b[7]*=_,b[2]*=_,b[5]*=_,b[8]*=_,this}determinant(){const _=this.elements,b=_[0],$=_[1],ee=_[2],re=_[3],ae=_[4],xe=_[5],le=_[6],fe=_[7],ve=_[8];return b*ae*ve-b*xe*fe-$*re*ve+$*xe*le+ee*re*fe-ee*ae*le}invert(){const _=this.elements,b=_[0],$=_[1],ee=_[2],re=_[3],ae=_[4],xe=_[5],le=_[6],fe=_[7],ve=_[8],Se=ve*ae-xe*fe,Ee=xe*le-ve*re,Ce=fe*re-ae*le,Ie=b*Se+$*Ee+ee*Ce;if(Ie===0)return this.set(0,0,0,0,0,0,0,0,0);const De=1/Ie;return _[0]=Se*De,_[1]=(ee*fe-ve*$)*De,_[2]=(xe*$-ee*ae)*De,_[3]=Ee*De,_[4]=(ve*b-ee*le)*De,_[5]=(ee*re-xe*b)*De,_[6]=Ce*De,_[7]=($*le-fe*b)*De,_[8]=(ae*b-$*re)*De,this}transpose(){let _;const b=this.elements;return _=b[1],b[1]=b[3],b[3]=_,_=b[2],b[2]=b[6],b[6]=_,_=b[5],b[5]=b[7],b[7]=_,this}getNormalMatrix(_){return this.setFromMatrix4(_).invert().transpose()}transposeIntoArray(_){const b=this.elements;return _[0]=b[0],_[1]=b[3],_[2]=b[6],_[3]=b[1],_[4]=b[4],_[5]=b[7],_[6]=b[2],_[7]=b[5],_[8]=b[8],this}setUvTransform(_,b,$,ee,re,ae,xe){const le=Math.cos(re),fe=Math.sin(re);return this.set($*le,$*fe,-$*(le*ae+fe*xe)+ae+_,-ee*fe,ee*le,-ee*(-fe*ae+le*xe)+xe+b,0,0,1),this}scale(_,b){return this.premultiply(_m3.makeScale(_,b)),this}rotate(_){return this.premultiply(_m3.makeRotation(-_)),this}translate(_,b){return this.premultiply(_m3.makeTranslation(_,b)),this}makeTranslation(_,b){return _.isVector2?this.set(1,0,_.x,0,1,_.y,0,0,1):this.set(1,0,_,0,1,b,0,0,1),this}makeRotation(_){const b=Math.cos(_),$=Math.sin(_);return this.set(b,-$,0,$,b,0,0,0,1),this}makeScale(_,b){return this.set(_,0,0,0,b,0,0,0,1),this}equals(_){const b=this.elements,$=_.elements;for(let ee=0;ee<9;ee++)if(b[ee]!==$[ee])return!1;return!0}fromArray(_,b=0){for(let $=0;$<9;$++)this.elements[$]=_[$+b];return this}toArray(_=[],b=0){const $=this.elements;return _[b]=$[0],_[b+1]=$[1],_[b+2]=$[2],_[b+3]=$[3],_[b+4]=$[4],_[b+5]=$[5],_[b+6]=$[6],_[b+7]=$[7],_[b+8]=$[8],_}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(H){for(let _=H.length-1;_>=0;--_)if(H[_]>=65535)return!0;return!1}function createElementNS(H){return document.createElementNS("http://www.w3.org/1999/xhtml",H)}const _cache={};function warnOnce(H){H in _cache||(_cache[H]=!0,console.warn(H))}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),COLOR_SPACES={[LinearSRGBColorSpace]:{transfer:LinearTransfer,primaries:Rec709Primaries,luminanceCoefficients:[.2126,.7152,.0722],toReference:H=>H,fromReference:H=>H},[SRGBColorSpace]:{transfer:SRGBTransfer,primaries:Rec709Primaries,luminanceCoefficients:[.2126,.7152,.0722],toReference:H=>H.convertSRGBToLinear(),fromReference:H=>H.convertLinearToSRGB()},[LinearDisplayP3ColorSpace]:{transfer:LinearTransfer,primaries:P3Primaries,luminanceCoefficients:[.2289,.6917,.0793],toReference:H=>H.applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:H=>H.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3)},[DisplayP3ColorSpace]:{transfer:SRGBTransfer,primaries:P3Primaries,luminanceCoefficients:[.2289,.6917,.0793],toReference:H=>H.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:H=>H.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3).convertLinearToSRGB()}},SUPPORTED_WORKING_COLOR_SPACES=new Set([LinearSRGBColorSpace,LinearDisplayP3ColorSpace]),ColorManagement={enabled:!0,_workingColorSpace:LinearSRGBColorSpace,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(H){if(!SUPPORTED_WORKING_COLOR_SPACES.has(H))throw new Error(`Unsupported working color space, "${H}".`);this._workingColorSpace=H},convert:function(H,_,b){if(this.enabled===!1||_===b||!_||!b)return H;const $=COLOR_SPACES[_].toReference,ee=COLOR_SPACES[b].fromReference;return ee($(H))},fromWorkingColorSpace:function(H,_){return this.convert(H,this._workingColorSpace,_)},toWorkingColorSpace:function(H,_){return this.convert(H,_,this._workingColorSpace)},getPrimaries:function(H){return COLOR_SPACES[H].primaries},getTransfer:function(H){return H===NoColorSpace?LinearTransfer:COLOR_SPACES[H].transfer},getLuminanceCoefficients:function(H,_=this._workingColorSpace){return H.fromArray(COLOR_SPACES[_].luminanceCoefficients)}};function SRGBToLinear(H){return H<.04045?H*.0773993808:Math.pow(H*.9478672986+.0521327014,2.4)}function LinearToSRGB(H){return H<.0031308?H*12.92:1.055*Math.pow(H,.41666)-.055}let _canvas;class ImageUtils{static getDataURL(_){if(/^data:/i.test(_.src)||typeof HTMLCanvasElement>"u")return _.src;let b;if(_ instanceof HTMLCanvasElement)b=_;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=_.width,_canvas.height=_.height;const $=_canvas.getContext("2d");_ instanceof ImageData?$.putImageData(_,0,0):$.drawImage(_,0,0,_.width,_.height),b=_canvas}return b.width>2048||b.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",_),b.toDataURL("image/jpeg",.6)):b.toDataURL("image/png")}static sRGBToLinear(_){if(typeof HTMLImageElement<"u"&&_ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_ instanceof ImageBitmap){const b=createElementNS("canvas");b.width=_.width,b.height=_.height;const $=b.getContext("2d");$.drawImage(_,0,0,_.width,_.height);const ee=$.getImageData(0,0,_.width,_.height),re=ee.data;for(let ae=0;ae<re.length;ae++)re[ae]=SRGBToLinear(re[ae]/255)*255;return $.putImageData(ee,0,0),b}else if(_.data){const b=_.data.slice(0);for(let $=0;$<b.length;$++)b instanceof Uint8Array||b instanceof Uint8ClampedArray?b[$]=Math.floor(SRGBToLinear(b[$]/255)*255):b[$]=SRGBToLinear(b[$]);return{data:b,width:_.width,height:_.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),_}}let _sourceId=0;class Source{constructor(_=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_sourceId++}),this.uuid=generateUUID(),this.data=_,this.dataReady=!0,this.version=0}set needsUpdate(_){_===!0&&this.version++}toJSON(_){const b=_===void 0||typeof _=="string";if(!b&&_.images[this.uuid]!==void 0)return _.images[this.uuid];const $={uuid:this.uuid,url:""},ee=this.data;if(ee!==null){let re;if(Array.isArray(ee)){re=[];for(let ae=0,xe=ee.length;ae<xe;ae++)ee[ae].isDataTexture?re.push(serializeImage(ee[ae].image)):re.push(serializeImage(ee[ae]))}else re=serializeImage(ee);$.url=re}return b||(_.images[this.uuid]=$),$}}function serializeImage(H){return typeof HTMLImageElement<"u"&&H instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&H instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&H instanceof ImageBitmap?ImageUtils.getDataURL(H):H.data?{data:Array.from(H.data),width:H.width,height:H.height,type:H.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _textureId=0;class Texture extends EventDispatcher{constructor(_=Texture.DEFAULT_IMAGE,b=Texture.DEFAULT_MAPPING,$=ClampToEdgeWrapping,ee=ClampToEdgeWrapping,re=LinearFilter,ae=LinearMipmapLinearFilter,xe=RGBAFormat,le=UnsignedByteType,fe=Texture.DEFAULT_ANISOTROPY,ve=NoColorSpace){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_textureId++}),this.uuid=generateUUID(),this.name="",this.source=new Source(_),this.mipmaps=[],this.mapping=b,this.channel=0,this.wrapS=$,this.wrapT=ee,this.magFilter=re,this.minFilter=ae,this.anisotropy=fe,this.format=xe,this.internalFormat=null,this.type=le,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=ve,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(_=null){this.source.data=_}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(_){return this.name=_.name,this.source=_.source,this.mipmaps=_.mipmaps.slice(0),this.mapping=_.mapping,this.channel=_.channel,this.wrapS=_.wrapS,this.wrapT=_.wrapT,this.magFilter=_.magFilter,this.minFilter=_.minFilter,this.anisotropy=_.anisotropy,this.format=_.format,this.internalFormat=_.internalFormat,this.type=_.type,this.offset.copy(_.offset),this.repeat.copy(_.repeat),this.center.copy(_.center),this.rotation=_.rotation,this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrix.copy(_.matrix),this.generateMipmaps=_.generateMipmaps,this.premultiplyAlpha=_.premultiplyAlpha,this.flipY=_.flipY,this.unpackAlignment=_.unpackAlignment,this.colorSpace=_.colorSpace,this.userData=JSON.parse(JSON.stringify(_.userData)),this.needsUpdate=!0,this}toJSON(_){const b=_===void 0||typeof _=="string";if(!b&&_.textures[this.uuid]!==void 0)return _.textures[this.uuid];const $={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(_).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&($.userData=this.userData),b||(_.textures[this.uuid]=$),$}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(_){if(this.mapping!==UVMapping)return _;if(_.applyMatrix3(this.matrix),_.x<0||_.x>1)switch(this.wrapS){case RepeatWrapping:_.x=_.x-Math.floor(_.x);break;case ClampToEdgeWrapping:_.x=_.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_.x)%2)===1?_.x=Math.ceil(_.x)-_.x:_.x=_.x-Math.floor(_.x);break}if(_.y<0||_.y>1)switch(this.wrapT){case RepeatWrapping:_.y=_.y-Math.floor(_.y);break;case ClampToEdgeWrapping:_.y=_.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_.y)%2)===1?_.y=Math.ceil(_.y)-_.y:_.y=_.y-Math.floor(_.y);break}return this.flipY&&(_.y=1-_.y),_}set needsUpdate(_){_===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(_){_===!0&&this.pmremVersion++}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=UVMapping;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(_=0,b=0,$=0,ee=1){Vector4.prototype.isVector4=!0,this.x=_,this.y=b,this.z=$,this.w=ee}get width(){return this.z}set width(_){this.z=_}get height(){return this.w}set height(_){this.w=_}set(_,b,$,ee){return this.x=_,this.y=b,this.z=$,this.w=ee,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this.w=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setW(_){return this.w=_,this}setComponent(_,b){switch(_){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this.w=_.w!==void 0?_.w:1,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this.w+=_.w,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this.w+=_,this}addVectors(_,b){return this.x=_.x+b.x,this.y=_.y+b.y,this.z=_.z+b.z,this.w=_.w+b.w,this}addScaledVector(_,b){return this.x+=_.x*b,this.y+=_.y*b,this.z+=_.z*b,this.w+=_.w*b,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this.w-=_.w,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this.w-=_,this}subVectors(_,b){return this.x=_.x-b.x,this.y=_.y-b.y,this.z=_.z-b.z,this.w=_.w-b.w,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this.w*=_.w,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this.w*=_,this}applyMatrix4(_){const b=this.x,$=this.y,ee=this.z,re=this.w,ae=_.elements;return this.x=ae[0]*b+ae[4]*$+ae[8]*ee+ae[12]*re,this.y=ae[1]*b+ae[5]*$+ae[9]*ee+ae[13]*re,this.z=ae[2]*b+ae[6]*$+ae[10]*ee+ae[14]*re,this.w=ae[3]*b+ae[7]*$+ae[11]*ee+ae[15]*re,this}divideScalar(_){return this.multiplyScalar(1/_)}setAxisAngleFromQuaternion(_){this.w=2*Math.acos(_.w);const b=Math.sqrt(1-_.w*_.w);return b<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=_.x/b,this.y=_.y/b,this.z=_.z/b),this}setAxisAngleFromRotationMatrix(_){let b,$,ee,re;const le=_.elements,fe=le[0],ve=le[4],Se=le[8],Ee=le[1],Ce=le[5],Ie=le[9],De=le[2],Be=le[6],Ne=le[10];if(Math.abs(ve-Ee)<.01&&Math.abs(Se-De)<.01&&Math.abs(Ie-Be)<.01){if(Math.abs(ve+Ee)<.1&&Math.abs(Se+De)<.1&&Math.abs(Ie+Be)<.1&&Math.abs(fe+Ce+Ne-3)<.1)return this.set(1,0,0,0),this;b=Math.PI;const Xe=(fe+1)/2,Ye=(Ce+1)/2,Qe=(Ne+1)/2,rt=(ve+Ee)/4,ot=(Se+De)/4,ct=(Ie+Be)/4;return Xe>Ye&&Xe>Qe?Xe<.01?($=0,ee=.707106781,re=.707106781):($=Math.sqrt(Xe),ee=rt/$,re=ot/$):Ye>Qe?Ye<.01?($=.707106781,ee=0,re=.707106781):(ee=Math.sqrt(Ye),$=rt/ee,re=ct/ee):Qe<.01?($=.707106781,ee=.707106781,re=0):(re=Math.sqrt(Qe),$=ot/re,ee=ct/re),this.set($,ee,re,b),this}let qe=Math.sqrt((Be-Ie)*(Be-Ie)+(Se-De)*(Se-De)+(Ee-ve)*(Ee-ve));return Math.abs(qe)<.001&&(qe=1),this.x=(Be-Ie)/qe,this.y=(Se-De)/qe,this.z=(Ee-ve)/qe,this.w=Math.acos((fe+Ce+Ne-1)/2),this}setFromMatrixPosition(_){const b=_.elements;return this.x=b[12],this.y=b[13],this.z=b[14],this.w=b[15],this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this.w=Math.min(this.w,_.w),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this.w=Math.max(this.w,_.w),this}clamp(_,b){return this.x=Math.max(_.x,Math.min(b.x,this.x)),this.y=Math.max(_.y,Math.min(b.y,this.y)),this.z=Math.max(_.z,Math.min(b.z,this.z)),this.w=Math.max(_.w,Math.min(b.w,this.w)),this}clampScalar(_,b){return this.x=Math.max(_,Math.min(b,this.x)),this.y=Math.max(_,Math.min(b,this.y)),this.z=Math.max(_,Math.min(b,this.z)),this.w=Math.max(_,Math.min(b,this.w)),this}clampLength(_,b){const $=this.length();return this.divideScalar($||1).multiplyScalar(Math.max(_,Math.min(b,$)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z+this.w*_.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,b){return this.x+=(_.x-this.x)*b,this.y+=(_.y-this.y)*b,this.z+=(_.z-this.z)*b,this.w+=(_.w-this.w)*b,this}lerpVectors(_,b,$){return this.x=_.x+(b.x-_.x)*$,this.y=_.y+(b.y-_.y)*$,this.z=_.z+(b.z-_.z)*$,this.w=_.w+(b.w-_.w)*$,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z&&_.w===this.w}fromArray(_,b=0){return this.x=_[b],this.y=_[b+1],this.z=_[b+2],this.w=_[b+3],this}toArray(_=[],b=0){return _[b]=this.x,_[b+1]=this.y,_[b+2]=this.z,_[b+3]=this.w,_}fromBufferAttribute(_,b){return this.x=_.getX(b),this.y=_.getY(b),this.z=_.getZ(b),this.w=_.getW(b),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Quaternion{constructor(_=0,b=0,$=0,ee=1){this.isQuaternion=!0,this._x=_,this._y=b,this._z=$,this._w=ee}static slerpFlat(_,b,$,ee,re,ae,xe){let le=$[ee+0],fe=$[ee+1],ve=$[ee+2],Se=$[ee+3];const Ee=re[ae+0],Ce=re[ae+1],Ie=re[ae+2],De=re[ae+3];if(xe===0){_[b+0]=le,_[b+1]=fe,_[b+2]=ve,_[b+3]=Se;return}if(xe===1){_[b+0]=Ee,_[b+1]=Ce,_[b+2]=Ie,_[b+3]=De;return}if(Se!==De||le!==Ee||fe!==Ce||ve!==Ie){let Be=1-xe;const Ne=le*Ee+fe*Ce+ve*Ie+Se*De,qe=Ne>=0?1:-1,Xe=1-Ne*Ne;if(Xe>Number.EPSILON){const Qe=Math.sqrt(Xe),rt=Math.atan2(Qe,Ne*qe);Be=Math.sin(Be*rt)/Qe,xe=Math.sin(xe*rt)/Qe}const Ye=xe*qe;if(le=le*Be+Ee*Ye,fe=fe*Be+Ce*Ye,ve=ve*Be+Ie*Ye,Se=Se*Be+De*Ye,Be===1-xe){const Qe=1/Math.sqrt(le*le+fe*fe+ve*ve+Se*Se);le*=Qe,fe*=Qe,ve*=Qe,Se*=Qe}}_[b]=le,_[b+1]=fe,_[b+2]=ve,_[b+3]=Se}static multiplyQuaternionsFlat(_,b,$,ee,re,ae){const xe=$[ee],le=$[ee+1],fe=$[ee+2],ve=$[ee+3],Se=re[ae],Ee=re[ae+1],Ce=re[ae+2],Ie=re[ae+3];return _[b]=xe*Ie+ve*Se+le*Ce-fe*Ee,_[b+1]=le*Ie+ve*Ee+fe*Se-xe*Ce,_[b+2]=fe*Ie+ve*Ce+xe*Ee-le*Se,_[b+3]=ve*Ie-xe*Se-le*Ee-fe*Ce,_}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get w(){return this._w}set w(_){this._w=_,this._onChangeCallback()}set(_,b,$,ee){return this._x=_,this._y=b,this._z=$,this._w=ee,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(_){return this._x=_.x,this._y=_.y,this._z=_.z,this._w=_.w,this._onChangeCallback(),this}setFromEuler(_,b=!0){const $=_._x,ee=_._y,re=_._z,ae=_._order,xe=Math.cos,le=Math.sin,fe=xe($/2),ve=xe(ee/2),Se=xe(re/2),Ee=le($/2),Ce=le(ee/2),Ie=le(re/2);switch(ae){case"XYZ":this._x=Ee*ve*Se+fe*Ce*Ie,this._y=fe*Ce*Se-Ee*ve*Ie,this._z=fe*ve*Ie+Ee*Ce*Se,this._w=fe*ve*Se-Ee*Ce*Ie;break;case"YXZ":this._x=Ee*ve*Se+fe*Ce*Ie,this._y=fe*Ce*Se-Ee*ve*Ie,this._z=fe*ve*Ie-Ee*Ce*Se,this._w=fe*ve*Se+Ee*Ce*Ie;break;case"ZXY":this._x=Ee*ve*Se-fe*Ce*Ie,this._y=fe*Ce*Se+Ee*ve*Ie,this._z=fe*ve*Ie+Ee*Ce*Se,this._w=fe*ve*Se-Ee*Ce*Ie;break;case"ZYX":this._x=Ee*ve*Se-fe*Ce*Ie,this._y=fe*Ce*Se+Ee*ve*Ie,this._z=fe*ve*Ie-Ee*Ce*Se,this._w=fe*ve*Se+Ee*Ce*Ie;break;case"YZX":this._x=Ee*ve*Se+fe*Ce*Ie,this._y=fe*Ce*Se+Ee*ve*Ie,this._z=fe*ve*Ie-Ee*Ce*Se,this._w=fe*ve*Se-Ee*Ce*Ie;break;case"XZY":this._x=Ee*ve*Se-fe*Ce*Ie,this._y=fe*Ce*Se-Ee*ve*Ie,this._z=fe*ve*Ie+Ee*Ce*Se,this._w=fe*ve*Se+Ee*Ce*Ie;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+ae)}return b===!0&&this._onChangeCallback(),this}setFromAxisAngle(_,b){const $=b/2,ee=Math.sin($);return this._x=_.x*ee,this._y=_.y*ee,this._z=_.z*ee,this._w=Math.cos($),this._onChangeCallback(),this}setFromRotationMatrix(_){const b=_.elements,$=b[0],ee=b[4],re=b[8],ae=b[1],xe=b[5],le=b[9],fe=b[2],ve=b[6],Se=b[10],Ee=$+xe+Se;if(Ee>0){const Ce=.5/Math.sqrt(Ee+1);this._w=.25/Ce,this._x=(ve-le)*Ce,this._y=(re-fe)*Ce,this._z=(ae-ee)*Ce}else if($>xe&&$>Se){const Ce=2*Math.sqrt(1+$-xe-Se);this._w=(ve-le)/Ce,this._x=.25*Ce,this._y=(ee+ae)/Ce,this._z=(re+fe)/Ce}else if(xe>Se){const Ce=2*Math.sqrt(1+xe-$-Se);this._w=(re-fe)/Ce,this._x=(ee+ae)/Ce,this._y=.25*Ce,this._z=(le+ve)/Ce}else{const Ce=2*Math.sqrt(1+Se-$-xe);this._w=(ae-ee)/Ce,this._x=(re+fe)/Ce,this._y=(le+ve)/Ce,this._z=.25*Ce}return this._onChangeCallback(),this}setFromUnitVectors(_,b){let $=_.dot(b)+1;return $<Number.EPSILON?($=0,Math.abs(_.x)>Math.abs(_.z)?(this._x=-_.y,this._y=_.x,this._z=0,this._w=$):(this._x=0,this._y=-_.z,this._z=_.y,this._w=$)):(this._x=_.y*b.z-_.z*b.y,this._y=_.z*b.x-_.x*b.z,this._z=_.x*b.y-_.y*b.x,this._w=$),this.normalize()}angleTo(_){return 2*Math.acos(Math.abs(clamp(this.dot(_),-1,1)))}rotateTowards(_,b){const $=this.angleTo(_);if($===0)return this;const ee=Math.min(1,b/$);return this.slerp(_,ee),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(_){return this._x*_._x+this._y*_._y+this._z*_._z+this._w*_._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let _=this.length();return _===0?(this._x=0,this._y=0,this._z=0,this._w=1):(_=1/_,this._x=this._x*_,this._y=this._y*_,this._z=this._z*_,this._w=this._w*_),this._onChangeCallback(),this}multiply(_){return this.multiplyQuaternions(this,_)}premultiply(_){return this.multiplyQuaternions(_,this)}multiplyQuaternions(_,b){const $=_._x,ee=_._y,re=_._z,ae=_._w,xe=b._x,le=b._y,fe=b._z,ve=b._w;return this._x=$*ve+ae*xe+ee*fe-re*le,this._y=ee*ve+ae*le+re*xe-$*fe,this._z=re*ve+ae*fe+$*le-ee*xe,this._w=ae*ve-$*xe-ee*le-re*fe,this._onChangeCallback(),this}slerp(_,b){if(b===0)return this;if(b===1)return this.copy(_);const $=this._x,ee=this._y,re=this._z,ae=this._w;let xe=ae*_._w+$*_._x+ee*_._y+re*_._z;if(xe<0?(this._w=-_._w,this._x=-_._x,this._y=-_._y,this._z=-_._z,xe=-xe):this.copy(_),xe>=1)return this._w=ae,this._x=$,this._y=ee,this._z=re,this;const le=1-xe*xe;if(le<=Number.EPSILON){const Ce=1-b;return this._w=Ce*ae+b*this._w,this._x=Ce*$+b*this._x,this._y=Ce*ee+b*this._y,this._z=Ce*re+b*this._z,this.normalize(),this}const fe=Math.sqrt(le),ve=Math.atan2(fe,xe),Se=Math.sin((1-b)*ve)/fe,Ee=Math.sin(b*ve)/fe;return this._w=ae*Se+this._w*Ee,this._x=$*Se+this._x*Ee,this._y=ee*Se+this._y*Ee,this._z=re*Se+this._z*Ee,this._onChangeCallback(),this}slerpQuaternions(_,b,$){return this.copy(_).slerp(b,$)}random(){const _=2*Math.PI*Math.random(),b=2*Math.PI*Math.random(),$=Math.random(),ee=Math.sqrt(1-$),re=Math.sqrt($);return this.set(ee*Math.sin(_),ee*Math.cos(_),re*Math.sin(b),re*Math.cos(b))}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._w===this._w}fromArray(_,b=0){return this._x=_[b],this._y=_[b+1],this._z=_[b+2],this._w=_[b+3],this._onChangeCallback(),this}toArray(_=[],b=0){return _[b]=this._x,_[b+1]=this._y,_[b+2]=this._z,_[b+3]=this._w,_}fromBufferAttribute(_,b){return this._x=_.getX(b),this._y=_.getY(b),this._z=_.getZ(b),this._w=_.getW(b),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(_=0,b=0,$=0){Vector3.prototype.isVector3=!0,this.x=_,this.y=b,this.z=$}set(_,b,$){return $===void 0&&($=this.z),this.x=_,this.y=b,this.z=$,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setComponent(_,b){switch(_){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this}addVectors(_,b){return this.x=_.x+b.x,this.y=_.y+b.y,this.z=_.z+b.z,this}addScaledVector(_,b){return this.x+=_.x*b,this.y+=_.y*b,this.z+=_.z*b,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this}subVectors(_,b){return this.x=_.x-b.x,this.y=_.y-b.y,this.z=_.z-b.z,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this}multiplyVectors(_,b){return this.x=_.x*b.x,this.y=_.y*b.y,this.z=_.z*b.z,this}applyEuler(_){return this.applyQuaternion(_quaternion$4.setFromEuler(_))}applyAxisAngle(_,b){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(_,b))}applyMatrix3(_){const b=this.x,$=this.y,ee=this.z,re=_.elements;return this.x=re[0]*b+re[3]*$+re[6]*ee,this.y=re[1]*b+re[4]*$+re[7]*ee,this.z=re[2]*b+re[5]*$+re[8]*ee,this}applyNormalMatrix(_){return this.applyMatrix3(_).normalize()}applyMatrix4(_){const b=this.x,$=this.y,ee=this.z,re=_.elements,ae=1/(re[3]*b+re[7]*$+re[11]*ee+re[15]);return this.x=(re[0]*b+re[4]*$+re[8]*ee+re[12])*ae,this.y=(re[1]*b+re[5]*$+re[9]*ee+re[13])*ae,this.z=(re[2]*b+re[6]*$+re[10]*ee+re[14])*ae,this}applyQuaternion(_){const b=this.x,$=this.y,ee=this.z,re=_.x,ae=_.y,xe=_.z,le=_.w,fe=2*(ae*ee-xe*$),ve=2*(xe*b-re*ee),Se=2*(re*$-ae*b);return this.x=b+le*fe+ae*Se-xe*ve,this.y=$+le*ve+xe*fe-re*Se,this.z=ee+le*Se+re*ve-ae*fe,this}project(_){return this.applyMatrix4(_.matrixWorldInverse).applyMatrix4(_.projectionMatrix)}unproject(_){return this.applyMatrix4(_.projectionMatrixInverse).applyMatrix4(_.matrixWorld)}transformDirection(_){const b=this.x,$=this.y,ee=this.z,re=_.elements;return this.x=re[0]*b+re[4]*$+re[8]*ee,this.y=re[1]*b+re[5]*$+re[9]*ee,this.z=re[2]*b+re[6]*$+re[10]*ee,this.normalize()}divide(_){return this.x/=_.x,this.y/=_.y,this.z/=_.z,this}divideScalar(_){return this.multiplyScalar(1/_)}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this}clamp(_,b){return this.x=Math.max(_.x,Math.min(b.x,this.x)),this.y=Math.max(_.y,Math.min(b.y,this.y)),this.z=Math.max(_.z,Math.min(b.z,this.z)),this}clampScalar(_,b){return this.x=Math.max(_,Math.min(b,this.x)),this.y=Math.max(_,Math.min(b,this.y)),this.z=Math.max(_,Math.min(b,this.z)),this}clampLength(_,b){const $=this.length();return this.divideScalar($||1).multiplyScalar(Math.max(_,Math.min(b,$)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,b){return this.x+=(_.x-this.x)*b,this.y+=(_.y-this.y)*b,this.z+=(_.z-this.z)*b,this}lerpVectors(_,b,$){return this.x=_.x+(b.x-_.x)*$,this.y=_.y+(b.y-_.y)*$,this.z=_.z+(b.z-_.z)*$,this}cross(_){return this.crossVectors(this,_)}crossVectors(_,b){const $=_.x,ee=_.y,re=_.z,ae=b.x,xe=b.y,le=b.z;return this.x=ee*le-re*xe,this.y=re*ae-$*le,this.z=$*xe-ee*ae,this}projectOnVector(_){const b=_.lengthSq();if(b===0)return this.set(0,0,0);const $=_.dot(this)/b;return this.copy(_).multiplyScalar($)}projectOnPlane(_){return _vector$c.copy(this).projectOnVector(_),this.sub(_vector$c)}reflect(_){return this.sub(_vector$c.copy(_).multiplyScalar(2*this.dot(_)))}angleTo(_){const b=Math.sqrt(this.lengthSq()*_.lengthSq());if(b===0)return Math.PI/2;const $=this.dot(_)/b;return Math.acos(clamp($,-1,1))}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const b=this.x-_.x,$=this.y-_.y,ee=this.z-_.z;return b*b+$*$+ee*ee}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)+Math.abs(this.z-_.z)}setFromSpherical(_){return this.setFromSphericalCoords(_.radius,_.phi,_.theta)}setFromSphericalCoords(_,b,$){const ee=Math.sin(b)*_;return this.x=ee*Math.sin($),this.y=Math.cos(b)*_,this.z=ee*Math.cos($),this}setFromCylindrical(_){return this.setFromCylindricalCoords(_.radius,_.theta,_.y)}setFromCylindricalCoords(_,b,$){return this.x=_*Math.sin(b),this.y=$,this.z=_*Math.cos(b),this}setFromMatrixPosition(_){const b=_.elements;return this.x=b[12],this.y=b[13],this.z=b[14],this}setFromMatrixScale(_){const b=this.setFromMatrixColumn(_,0).length(),$=this.setFromMatrixColumn(_,1).length(),ee=this.setFromMatrixColumn(_,2).length();return this.x=b,this.y=$,this.z=ee,this}setFromMatrixColumn(_,b){return this.fromArray(_.elements,b*4)}setFromMatrix3Column(_,b){return this.fromArray(_.elements,b*3)}setFromEuler(_){return this.x=_._x,this.y=_._y,this.z=_._z,this}setFromColor(_){return this.x=_.r,this.y=_.g,this.z=_.b,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z}fromArray(_,b=0){return this.x=_[b],this.y=_[b+1],this.z=_[b+2],this}toArray(_=[],b=0){return _[b]=this.x,_[b+1]=this.y,_[b+2]=this.z,_}fromBufferAttribute(_,b){return this.x=_.getX(b),this.y=_.getY(b),this.z=_.getZ(b),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const _=Math.random()*Math.PI*2,b=Math.random()*2-1,$=Math.sqrt(1-b*b);return this.x=$*Math.cos(_),this.y=b,this.z=$*Math.sin(_),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$c=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(_=new Vector3(1/0,1/0,1/0),b=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=_,this.max=b}set(_,b){return this.min.copy(_),this.max.copy(b),this}setFromArray(_){this.makeEmpty();for(let b=0,$=_.length;b<$;b+=3)this.expandByPoint(_vector$b.fromArray(_,b));return this}setFromBufferAttribute(_){this.makeEmpty();for(let b=0,$=_.count;b<$;b++)this.expandByPoint(_vector$b.fromBufferAttribute(_,b));return this}setFromPoints(_){this.makeEmpty();for(let b=0,$=_.length;b<$;b++)this.expandByPoint(_[b]);return this}setFromCenterAndSize(_,b){const $=_vector$b.copy(b).multiplyScalar(.5);return this.min.copy(_).sub($),this.max.copy(_).add($),this}setFromObject(_,b=!1){return this.makeEmpty(),this.expandByObject(_,b)}clone(){return new this.constructor().copy(this)}copy(_){return this.min.copy(_.min),this.max.copy(_.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(_){return this.isEmpty()?_.set(0,0,0):_.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_){return this.isEmpty()?_.set(0,0,0):_.subVectors(this.max,this.min)}expandByPoint(_){return this.min.min(_),this.max.max(_),this}expandByVector(_){return this.min.sub(_),this.max.add(_),this}expandByScalar(_){return this.min.addScalar(-_),this.max.addScalar(_),this}expandByObject(_,b=!1){_.updateWorldMatrix(!1,!1);const $=_.geometry;if($!==void 0){const re=$.getAttribute("position");if(b===!0&&re!==void 0&&_.isInstancedMesh!==!0)for(let ae=0,xe=re.count;ae<xe;ae++)_.isMesh===!0?_.getVertexPosition(ae,_vector$b):_vector$b.fromBufferAttribute(re,ae),_vector$b.applyMatrix4(_.matrixWorld),this.expandByPoint(_vector$b);else _.boundingBox!==void 0?(_.boundingBox===null&&_.computeBoundingBox(),_box$4.copy(_.boundingBox)):($.boundingBox===null&&$.computeBoundingBox(),_box$4.copy($.boundingBox)),_box$4.applyMatrix4(_.matrixWorld),this.union(_box$4)}const ee=_.children;for(let re=0,ae=ee.length;re<ae;re++)this.expandByObject(ee[re],b);return this}containsPoint(_){return _.x>=this.min.x&&_.x<=this.max.x&&_.y>=this.min.y&&_.y<=this.max.y&&_.z>=this.min.z&&_.z<=this.max.z}containsBox(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y&&this.min.z<=_.min.z&&_.max.z<=this.max.z}getParameter(_,b){return b.set((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y),(_.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(_){return _.max.x>=this.min.x&&_.min.x<=this.max.x&&_.max.y>=this.min.y&&_.min.y<=this.max.y&&_.max.z>=this.min.z&&_.min.z<=this.max.z}intersectsSphere(_){return this.clampPoint(_.center,_vector$b),_vector$b.distanceToSquared(_.center)<=_.radius*_.radius}intersectsPlane(_){let b,$;return _.normal.x>0?(b=_.normal.x*this.min.x,$=_.normal.x*this.max.x):(b=_.normal.x*this.max.x,$=_.normal.x*this.min.x),_.normal.y>0?(b+=_.normal.y*this.min.y,$+=_.normal.y*this.max.y):(b+=_.normal.y*this.max.y,$+=_.normal.y*this.min.y),_.normal.z>0?(b+=_.normal.z*this.min.z,$+=_.normal.z*this.max.z):(b+=_.normal.z*this.max.z,$+=_.normal.z*this.min.z),b<=-_.constant&&$>=-_.constant}intersectsTriangle(_){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$3.subVectors(_.a,_center),_v1$7.subVectors(_.b,_center),_v2$4.subVectors(_.c,_center),_f0.subVectors(_v1$7,_v0$3),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$3,_v2$4);let b=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(b,_v0$3,_v1$7,_v2$4,_extents)||(b=[1,0,0,0,1,0,0,0,1],!satForAxes(b,_v0$3,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),b=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(b,_v0$3,_v1$7,_v2$4,_extents))}clampPoint(_,b){return b.copy(_).clamp(this.min,this.max)}distanceToPoint(_){return this.clampPoint(_,_vector$b).distanceTo(_)}getBoundingSphere(_){return this.isEmpty()?_.makeEmpty():(this.getCenter(_.center),_.radius=this.getSize(_vector$b).length()*.5),_}intersect(_){return this.min.max(_.min),this.max.min(_.max),this.isEmpty()&&this.makeEmpty(),this}union(_){return this.min.min(_.min),this.max.max(_.max),this}applyMatrix4(_){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(_),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(_),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(_),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(_),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(_),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(_),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(_),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(_),this.setFromPoints(_points),this)}translate(_){return this.min.add(_),this.max.add(_),this}equals(_){return _.min.equals(this.min)&&_.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$b=new Vector3,_box$4=new Box3,_v0$3=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(H,_,b,$,ee){for(let re=0,ae=H.length-3;re<=ae;re+=3){_testAxis.fromArray(H,re);const xe=ee.x*Math.abs(_testAxis.x)+ee.y*Math.abs(_testAxis.y)+ee.z*Math.abs(_testAxis.z),le=_.dot(_testAxis),fe=b.dot(_testAxis),ve=$.dot(_testAxis);if(Math.max(-Math.max(le,fe,ve),Math.min(le,fe,ve))>xe)return!1}return!0}const _box$3=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(_=new Vector3,b=-1){this.isSphere=!0,this.center=_,this.radius=b}set(_,b){return this.center.copy(_),this.radius=b,this}setFromPoints(_,b){const $=this.center;b!==void 0?$.copy(b):_box$3.setFromPoints(_).getCenter($);let ee=0;for(let re=0,ae=_.length;re<ae;re++)ee=Math.max(ee,$.distanceToSquared(_[re]));return this.radius=Math.sqrt(ee),this}copy(_){return this.center.copy(_.center),this.radius=_.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(_){return _.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(_){return _.distanceTo(this.center)-this.radius}intersectsSphere(_){const b=this.radius+_.radius;return _.center.distanceToSquared(this.center)<=b*b}intersectsBox(_){return _.intersectsSphere(this)}intersectsPlane(_){return Math.abs(_.distanceToPoint(this.center))<=this.radius}clampPoint(_,b){const $=this.center.distanceToSquared(_);return b.copy(_),$>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center)),b}getBoundingBox(_){return this.isEmpty()?(_.makeEmpty(),_):(_.set(this.center,this.center),_.expandByScalar(this.radius),_)}applyMatrix4(_){return this.center.applyMatrix4(_),this.radius=this.radius*_.getMaxScaleOnAxis(),this}translate(_){return this.center.add(_),this}expandByPoint(_){if(this.isEmpty())return this.center.copy(_),this.radius=0,this;_v1$6.subVectors(_,this.center);const b=_v1$6.lengthSq();if(b>this.radius*this.radius){const $=Math.sqrt(b),ee=($-this.radius)*.5;this.center.addScaledVector(_v1$6,ee/$),this.radius+=ee}return this}union(_){return _.isEmpty()?this:this.isEmpty()?(this.copy(_),this):(this.center.equals(_.center)===!0?this.radius=Math.max(this.radius,_.radius):(_v2$3.subVectors(_.center,this.center).setLength(_.radius),this.expandByPoint(_v1$6.copy(_.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(_.center).sub(_v2$3))),this)}equals(_){return _.center.equals(this.center)&&_.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$a=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;class Ray{constructor(_=new Vector3,b=new Vector3(0,0,-1)){this.origin=_,this.direction=b}set(_,b){return this.origin.copy(_),this.direction.copy(b),this}copy(_){return this.origin.copy(_.origin),this.direction.copy(_.direction),this}at(_,b){return b.copy(this.origin).addScaledVector(this.direction,_)}lookAt(_){return this.direction.copy(_).sub(this.origin).normalize(),this}recast(_){return this.origin.copy(this.at(_,_vector$a)),this}closestPointToPoint(_,b){b.subVectors(_,this.origin);const $=b.dot(this.direction);return $<0?b.copy(this.origin):b.copy(this.origin).addScaledVector(this.direction,$)}distanceToPoint(_){return Math.sqrt(this.distanceSqToPoint(_))}distanceSqToPoint(_){const b=_vector$a.subVectors(_,this.origin).dot(this.direction);return b<0?this.origin.distanceToSquared(_):(_vector$a.copy(this.origin).addScaledVector(this.direction,b),_vector$a.distanceToSquared(_))}distanceSqToSegment(_,b,$,ee){_segCenter.copy(_).add(b).multiplyScalar(.5),_segDir.copy(b).sub(_).normalize(),_diff.copy(this.origin).sub(_segCenter);const re=_.distanceTo(b)*.5,ae=-this.direction.dot(_segDir),xe=_diff.dot(this.direction),le=-_diff.dot(_segDir),fe=_diff.lengthSq(),ve=Math.abs(1-ae*ae);let Se,Ee,Ce,Ie;if(ve>0)if(Se=ae*le-xe,Ee=ae*xe-le,Ie=re*ve,Se>=0)if(Ee>=-Ie)if(Ee<=Ie){const De=1/ve;Se*=De,Ee*=De,Ce=Se*(Se+ae*Ee+2*xe)+Ee*(ae*Se+Ee+2*le)+fe}else Ee=re,Se=Math.max(0,-(ae*Ee+xe)),Ce=-Se*Se+Ee*(Ee+2*le)+fe;else Ee=-re,Se=Math.max(0,-(ae*Ee+xe)),Ce=-Se*Se+Ee*(Ee+2*le)+fe;else Ee<=-Ie?(Se=Math.max(0,-(-ae*re+xe)),Ee=Se>0?-re:Math.min(Math.max(-re,-le),re),Ce=-Se*Se+Ee*(Ee+2*le)+fe):Ee<=Ie?(Se=0,Ee=Math.min(Math.max(-re,-le),re),Ce=Ee*(Ee+2*le)+fe):(Se=Math.max(0,-(ae*re+xe)),Ee=Se>0?re:Math.min(Math.max(-re,-le),re),Ce=-Se*Se+Ee*(Ee+2*le)+fe);else Ee=ae>0?-re:re,Se=Math.max(0,-(ae*Ee+xe)),Ce=-Se*Se+Ee*(Ee+2*le)+fe;return $&&$.copy(this.origin).addScaledVector(this.direction,Se),ee&&ee.copy(_segCenter).addScaledVector(_segDir,Ee),Ce}intersectSphere(_,b){_vector$a.subVectors(_.center,this.origin);const $=_vector$a.dot(this.direction),ee=_vector$a.dot(_vector$a)-$*$,re=_.radius*_.radius;if(ee>re)return null;const ae=Math.sqrt(re-ee),xe=$-ae,le=$+ae;return le<0?null:xe<0?this.at(le,b):this.at(xe,b)}intersectsSphere(_){return this.distanceSqToPoint(_.center)<=_.radius*_.radius}distanceToPlane(_){const b=_.normal.dot(this.direction);if(b===0)return _.distanceToPoint(this.origin)===0?0:null;const $=-(this.origin.dot(_.normal)+_.constant)/b;return $>=0?$:null}intersectPlane(_,b){const $=this.distanceToPlane(_);return $===null?null:this.at($,b)}intersectsPlane(_){const b=_.distanceToPoint(this.origin);return b===0||_.normal.dot(this.direction)*b<0}intersectBox(_,b){let $,ee,re,ae,xe,le;const fe=1/this.direction.x,ve=1/this.direction.y,Se=1/this.direction.z,Ee=this.origin;return fe>=0?($=(_.min.x-Ee.x)*fe,ee=(_.max.x-Ee.x)*fe):($=(_.max.x-Ee.x)*fe,ee=(_.min.x-Ee.x)*fe),ve>=0?(re=(_.min.y-Ee.y)*ve,ae=(_.max.y-Ee.y)*ve):(re=(_.max.y-Ee.y)*ve,ae=(_.min.y-Ee.y)*ve),$>ae||re>ee||((re>$||isNaN($))&&($=re),(ae<ee||isNaN(ee))&&(ee=ae),Se>=0?(xe=(_.min.z-Ee.z)*Se,le=(_.max.z-Ee.z)*Se):(xe=(_.max.z-Ee.z)*Se,le=(_.min.z-Ee.z)*Se),$>le||xe>ee)||((xe>$||$!==$)&&($=xe),(le<ee||ee!==ee)&&(ee=le),ee<0)?null:this.at($>=0?$:ee,b)}intersectsBox(_){return this.intersectBox(_,_vector$a)!==null}intersectTriangle(_,b,$,ee,re){_edge1.subVectors(b,_),_edge2.subVectors($,_),_normal$1.crossVectors(_edge1,_edge2);let ae=this.direction.dot(_normal$1),xe;if(ae>0){if(ee)return null;xe=1}else if(ae<0)xe=-1,ae=-ae;else return null;_diff.subVectors(this.origin,_);const le=xe*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(le<0)return null;const fe=xe*this.direction.dot(_edge1.cross(_diff));if(fe<0||le+fe>ae)return null;const ve=-xe*_diff.dot(_normal$1);return ve<0?null:this.at(ve/ae,re)}applyMatrix4(_){return this.origin.applyMatrix4(_),this.direction.transformDirection(_),this}equals(_){return _.origin.equals(this.origin)&&_.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(_,b,$,ee,re,ae,xe,le,fe,ve,Se,Ee,Ce,Ie,De,Be){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_!==void 0&&this.set(_,b,$,ee,re,ae,xe,le,fe,ve,Se,Ee,Ce,Ie,De,Be)}set(_,b,$,ee,re,ae,xe,le,fe,ve,Se,Ee,Ce,Ie,De,Be){const Ne=this.elements;return Ne[0]=_,Ne[4]=b,Ne[8]=$,Ne[12]=ee,Ne[1]=re,Ne[5]=ae,Ne[9]=xe,Ne[13]=le,Ne[2]=fe,Ne[6]=ve,Ne[10]=Se,Ne[14]=Ee,Ne[3]=Ce,Ne[7]=Ie,Ne[11]=De,Ne[15]=Be,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(_){const b=this.elements,$=_.elements;return b[0]=$[0],b[1]=$[1],b[2]=$[2],b[3]=$[3],b[4]=$[4],b[5]=$[5],b[6]=$[6],b[7]=$[7],b[8]=$[8],b[9]=$[9],b[10]=$[10],b[11]=$[11],b[12]=$[12],b[13]=$[13],b[14]=$[14],b[15]=$[15],this}copyPosition(_){const b=this.elements,$=_.elements;return b[12]=$[12],b[13]=$[13],b[14]=$[14],this}setFromMatrix3(_){const b=_.elements;return this.set(b[0],b[3],b[6],0,b[1],b[4],b[7],0,b[2],b[5],b[8],0,0,0,0,1),this}extractBasis(_,b,$){return _.setFromMatrixColumn(this,0),b.setFromMatrixColumn(this,1),$.setFromMatrixColumn(this,2),this}makeBasis(_,b,$){return this.set(_.x,b.x,$.x,0,_.y,b.y,$.y,0,_.z,b.z,$.z,0,0,0,0,1),this}extractRotation(_){const b=this.elements,$=_.elements,ee=1/_v1$5.setFromMatrixColumn(_,0).length(),re=1/_v1$5.setFromMatrixColumn(_,1).length(),ae=1/_v1$5.setFromMatrixColumn(_,2).length();return b[0]=$[0]*ee,b[1]=$[1]*ee,b[2]=$[2]*ee,b[3]=0,b[4]=$[4]*re,b[5]=$[5]*re,b[6]=$[6]*re,b[7]=0,b[8]=$[8]*ae,b[9]=$[9]*ae,b[10]=$[10]*ae,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this}makeRotationFromEuler(_){const b=this.elements,$=_.x,ee=_.y,re=_.z,ae=Math.cos($),xe=Math.sin($),le=Math.cos(ee),fe=Math.sin(ee),ve=Math.cos(re),Se=Math.sin(re);if(_.order==="XYZ"){const Ee=ae*ve,Ce=ae*Se,Ie=xe*ve,De=xe*Se;b[0]=le*ve,b[4]=-le*Se,b[8]=fe,b[1]=Ce+Ie*fe,b[5]=Ee-De*fe,b[9]=-xe*le,b[2]=De-Ee*fe,b[6]=Ie+Ce*fe,b[10]=ae*le}else if(_.order==="YXZ"){const Ee=le*ve,Ce=le*Se,Ie=fe*ve,De=fe*Se;b[0]=Ee+De*xe,b[4]=Ie*xe-Ce,b[8]=ae*fe,b[1]=ae*Se,b[5]=ae*ve,b[9]=-xe,b[2]=Ce*xe-Ie,b[6]=De+Ee*xe,b[10]=ae*le}else if(_.order==="ZXY"){const Ee=le*ve,Ce=le*Se,Ie=fe*ve,De=fe*Se;b[0]=Ee-De*xe,b[4]=-ae*Se,b[8]=Ie+Ce*xe,b[1]=Ce+Ie*xe,b[5]=ae*ve,b[9]=De-Ee*xe,b[2]=-ae*fe,b[6]=xe,b[10]=ae*le}else if(_.order==="ZYX"){const Ee=ae*ve,Ce=ae*Se,Ie=xe*ve,De=xe*Se;b[0]=le*ve,b[4]=Ie*fe-Ce,b[8]=Ee*fe+De,b[1]=le*Se,b[5]=De*fe+Ee,b[9]=Ce*fe-Ie,b[2]=-fe,b[6]=xe*le,b[10]=ae*le}else if(_.order==="YZX"){const Ee=ae*le,Ce=ae*fe,Ie=xe*le,De=xe*fe;b[0]=le*ve,b[4]=De-Ee*Se,b[8]=Ie*Se+Ce,b[1]=Se,b[5]=ae*ve,b[9]=-xe*ve,b[2]=-fe*ve,b[6]=Ce*Se+Ie,b[10]=Ee-De*Se}else if(_.order==="XZY"){const Ee=ae*le,Ce=ae*fe,Ie=xe*le,De=xe*fe;b[0]=le*ve,b[4]=-Se,b[8]=fe*ve,b[1]=Ee*Se+De,b[5]=ae*ve,b[9]=Ce*Se-Ie,b[2]=Ie*Se-Ce,b[6]=xe*ve,b[10]=De*Se+Ee}return b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this}makeRotationFromQuaternion(_){return this.compose(_zero,_,_one)}lookAt(_,b,$){const ee=this.elements;return _z.subVectors(_,b),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors($,_z),_x.lengthSq()===0&&(Math.abs($.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors($,_z)),_x.normalize(),_y.crossVectors(_z,_x),ee[0]=_x.x,ee[4]=_y.x,ee[8]=_z.x,ee[1]=_x.y,ee[5]=_y.y,ee[9]=_z.y,ee[2]=_x.z,ee[6]=_y.z,ee[10]=_z.z,this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,b){const $=_.elements,ee=b.elements,re=this.elements,ae=$[0],xe=$[4],le=$[8],fe=$[12],ve=$[1],Se=$[5],Ee=$[9],Ce=$[13],Ie=$[2],De=$[6],Be=$[10],Ne=$[14],qe=$[3],Xe=$[7],Ye=$[11],Qe=$[15],rt=ee[0],ot=ee[4],ct=ee[8],mt=ee[12],_t=ee[1],Lt=ee[5],Vt=ee[9],Gt=ee[13],$t=ee[2],Qt=ee[6],vt=ee[10],It=ee[14],gt=ee[3],Tt=ee[7],Ct=ee[11],Ft=ee[15];return re[0]=ae*rt+xe*_t+le*$t+fe*gt,re[4]=ae*ot+xe*Lt+le*Qt+fe*Tt,re[8]=ae*ct+xe*Vt+le*vt+fe*Ct,re[12]=ae*mt+xe*Gt+le*It+fe*Ft,re[1]=ve*rt+Se*_t+Ee*$t+Ce*gt,re[5]=ve*ot+Se*Lt+Ee*Qt+Ce*Tt,re[9]=ve*ct+Se*Vt+Ee*vt+Ce*Ct,re[13]=ve*mt+Se*Gt+Ee*It+Ce*Ft,re[2]=Ie*rt+De*_t+Be*$t+Ne*gt,re[6]=Ie*ot+De*Lt+Be*Qt+Ne*Tt,re[10]=Ie*ct+De*Vt+Be*vt+Ne*Ct,re[14]=Ie*mt+De*Gt+Be*It+Ne*Ft,re[3]=qe*rt+Xe*_t+Ye*$t+Qe*gt,re[7]=qe*ot+Xe*Lt+Ye*Qt+Qe*Tt,re[11]=qe*ct+Xe*Vt+Ye*vt+Qe*Ct,re[15]=qe*mt+Xe*Gt+Ye*It+Qe*Ft,this}multiplyScalar(_){const b=this.elements;return b[0]*=_,b[4]*=_,b[8]*=_,b[12]*=_,b[1]*=_,b[5]*=_,b[9]*=_,b[13]*=_,b[2]*=_,b[6]*=_,b[10]*=_,b[14]*=_,b[3]*=_,b[7]*=_,b[11]*=_,b[15]*=_,this}determinant(){const _=this.elements,b=_[0],$=_[4],ee=_[8],re=_[12],ae=_[1],xe=_[5],le=_[9],fe=_[13],ve=_[2],Se=_[6],Ee=_[10],Ce=_[14],Ie=_[3],De=_[7],Be=_[11],Ne=_[15];return Ie*(+re*le*Se-ee*fe*Se-re*xe*Ee+$*fe*Ee+ee*xe*Ce-$*le*Ce)+De*(+b*le*Ce-b*fe*Ee+re*ae*Ee-ee*ae*Ce+ee*fe*ve-re*le*ve)+Be*(+b*fe*Se-b*xe*Ce-re*ae*Se+$*ae*Ce+re*xe*ve-$*fe*ve)+Ne*(-ee*xe*ve-b*le*Se+b*xe*Ee+ee*ae*Se-$*ae*Ee+$*le*ve)}transpose(){const _=this.elements;let b;return b=_[1],_[1]=_[4],_[4]=b,b=_[2],_[2]=_[8],_[8]=b,b=_[6],_[6]=_[9],_[9]=b,b=_[3],_[3]=_[12],_[12]=b,b=_[7],_[7]=_[13],_[13]=b,b=_[11],_[11]=_[14],_[14]=b,this}setPosition(_,b,$){const ee=this.elements;return _.isVector3?(ee[12]=_.x,ee[13]=_.y,ee[14]=_.z):(ee[12]=_,ee[13]=b,ee[14]=$),this}invert(){const _=this.elements,b=_[0],$=_[1],ee=_[2],re=_[3],ae=_[4],xe=_[5],le=_[6],fe=_[7],ve=_[8],Se=_[9],Ee=_[10],Ce=_[11],Ie=_[12],De=_[13],Be=_[14],Ne=_[15],qe=Se*Be*fe-De*Ee*fe+De*le*Ce-xe*Be*Ce-Se*le*Ne+xe*Ee*Ne,Xe=Ie*Ee*fe-ve*Be*fe-Ie*le*Ce+ae*Be*Ce+ve*le*Ne-ae*Ee*Ne,Ye=ve*De*fe-Ie*Se*fe+Ie*xe*Ce-ae*De*Ce-ve*xe*Ne+ae*Se*Ne,Qe=Ie*Se*le-ve*De*le-Ie*xe*Ee+ae*De*Ee+ve*xe*Be-ae*Se*Be,rt=b*qe+$*Xe+ee*Ye+re*Qe;if(rt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ot=1/rt;return _[0]=qe*ot,_[1]=(De*Ee*re-Se*Be*re-De*ee*Ce+$*Be*Ce+Se*ee*Ne-$*Ee*Ne)*ot,_[2]=(xe*Be*re-De*le*re+De*ee*fe-$*Be*fe-xe*ee*Ne+$*le*Ne)*ot,_[3]=(Se*le*re-xe*Ee*re-Se*ee*fe+$*Ee*fe+xe*ee*Ce-$*le*Ce)*ot,_[4]=Xe*ot,_[5]=(ve*Be*re-Ie*Ee*re+Ie*ee*Ce-b*Be*Ce-ve*ee*Ne+b*Ee*Ne)*ot,_[6]=(Ie*le*re-ae*Be*re-Ie*ee*fe+b*Be*fe+ae*ee*Ne-b*le*Ne)*ot,_[7]=(ae*Ee*re-ve*le*re+ve*ee*fe-b*Ee*fe-ae*ee*Ce+b*le*Ce)*ot,_[8]=Ye*ot,_[9]=(Ie*Se*re-ve*De*re-Ie*$*Ce+b*De*Ce+ve*$*Ne-b*Se*Ne)*ot,_[10]=(ae*De*re-Ie*xe*re+Ie*$*fe-b*De*fe-ae*$*Ne+b*xe*Ne)*ot,_[11]=(ve*xe*re-ae*Se*re-ve*$*fe+b*Se*fe+ae*$*Ce-b*xe*Ce)*ot,_[12]=Qe*ot,_[13]=(ve*De*ee-Ie*Se*ee+Ie*$*Ee-b*De*Ee-ve*$*Be+b*Se*Be)*ot,_[14]=(Ie*xe*ee-ae*De*ee-Ie*$*le+b*De*le+ae*$*Be-b*xe*Be)*ot,_[15]=(ae*Se*ee-ve*xe*ee+ve*$*le-b*Se*le-ae*$*Ee+b*xe*Ee)*ot,this}scale(_){const b=this.elements,$=_.x,ee=_.y,re=_.z;return b[0]*=$,b[4]*=ee,b[8]*=re,b[1]*=$,b[5]*=ee,b[9]*=re,b[2]*=$,b[6]*=ee,b[10]*=re,b[3]*=$,b[7]*=ee,b[11]*=re,this}getMaxScaleOnAxis(){const _=this.elements,b=_[0]*_[0]+_[1]*_[1]+_[2]*_[2],$=_[4]*_[4]+_[5]*_[5]+_[6]*_[6],ee=_[8]*_[8]+_[9]*_[9]+_[10]*_[10];return Math.sqrt(Math.max(b,$,ee))}makeTranslation(_,b,$){return _.isVector3?this.set(1,0,0,_.x,0,1,0,_.y,0,0,1,_.z,0,0,0,1):this.set(1,0,0,_,0,1,0,b,0,0,1,$,0,0,0,1),this}makeRotationX(_){const b=Math.cos(_),$=Math.sin(_);return this.set(1,0,0,0,0,b,-$,0,0,$,b,0,0,0,0,1),this}makeRotationY(_){const b=Math.cos(_),$=Math.sin(_);return this.set(b,0,$,0,0,1,0,0,-$,0,b,0,0,0,0,1),this}makeRotationZ(_){const b=Math.cos(_),$=Math.sin(_);return this.set(b,-$,0,0,$,b,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(_,b){const $=Math.cos(b),ee=Math.sin(b),re=1-$,ae=_.x,xe=_.y,le=_.z,fe=re*ae,ve=re*xe;return this.set(fe*ae+$,fe*xe-ee*le,fe*le+ee*xe,0,fe*xe+ee*le,ve*xe+$,ve*le-ee*ae,0,fe*le-ee*xe,ve*le+ee*ae,re*le*le+$,0,0,0,0,1),this}makeScale(_,b,$){return this.set(_,0,0,0,0,b,0,0,0,0,$,0,0,0,0,1),this}makeShear(_,b,$,ee,re,ae){return this.set(1,$,re,0,_,1,ae,0,b,ee,1,0,0,0,0,1),this}compose(_,b,$){const ee=this.elements,re=b._x,ae=b._y,xe=b._z,le=b._w,fe=re+re,ve=ae+ae,Se=xe+xe,Ee=re*fe,Ce=re*ve,Ie=re*Se,De=ae*ve,Be=ae*Se,Ne=xe*Se,qe=le*fe,Xe=le*ve,Ye=le*Se,Qe=$.x,rt=$.y,ot=$.z;return ee[0]=(1-(De+Ne))*Qe,ee[1]=(Ce+Ye)*Qe,ee[2]=(Ie-Xe)*Qe,ee[3]=0,ee[4]=(Ce-Ye)*rt,ee[5]=(1-(Ee+Ne))*rt,ee[6]=(Be+qe)*rt,ee[7]=0,ee[8]=(Ie+Xe)*ot,ee[9]=(Be-qe)*ot,ee[10]=(1-(Ee+De))*ot,ee[11]=0,ee[12]=_.x,ee[13]=_.y,ee[14]=_.z,ee[15]=1,this}decompose(_,b,$){const ee=this.elements;let re=_v1$5.set(ee[0],ee[1],ee[2]).length();const ae=_v1$5.set(ee[4],ee[5],ee[6]).length(),xe=_v1$5.set(ee[8],ee[9],ee[10]).length();this.determinant()<0&&(re=-re),_.x=ee[12],_.y=ee[13],_.z=ee[14],_m1$4.copy(this);const fe=1/re,ve=1/ae,Se=1/xe;return _m1$4.elements[0]*=fe,_m1$4.elements[1]*=fe,_m1$4.elements[2]*=fe,_m1$4.elements[4]*=ve,_m1$4.elements[5]*=ve,_m1$4.elements[6]*=ve,_m1$4.elements[8]*=Se,_m1$4.elements[9]*=Se,_m1$4.elements[10]*=Se,b.setFromRotationMatrix(_m1$4),$.x=re,$.y=ae,$.z=xe,this}makePerspective(_,b,$,ee,re,ae,xe=WebGLCoordinateSystem){const le=this.elements,fe=2*re/(b-_),ve=2*re/($-ee),Se=(b+_)/(b-_),Ee=($+ee)/($-ee);let Ce,Ie;if(xe===WebGLCoordinateSystem)Ce=-(ae+re)/(ae-re),Ie=-2*ae*re/(ae-re);else if(xe===WebGPUCoordinateSystem)Ce=-ae/(ae-re),Ie=-ae*re/(ae-re);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+xe);return le[0]=fe,le[4]=0,le[8]=Se,le[12]=0,le[1]=0,le[5]=ve,le[9]=Ee,le[13]=0,le[2]=0,le[6]=0,le[10]=Ce,le[14]=Ie,le[3]=0,le[7]=0,le[11]=-1,le[15]=0,this}makeOrthographic(_,b,$,ee,re,ae,xe=WebGLCoordinateSystem){const le=this.elements,fe=1/(b-_),ve=1/($-ee),Se=1/(ae-re),Ee=(b+_)*fe,Ce=($+ee)*ve;let Ie,De;if(xe===WebGLCoordinateSystem)Ie=(ae+re)*Se,De=-2*Se;else if(xe===WebGPUCoordinateSystem)Ie=re*Se,De=-1*Se;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+xe);return le[0]=2*fe,le[4]=0,le[8]=0,le[12]=-Ee,le[1]=0,le[5]=2*ve,le[9]=0,le[13]=-Ce,le[2]=0,le[6]=0,le[10]=De,le[14]=-Ie,le[3]=0,le[7]=0,le[11]=0,le[15]=1,this}equals(_){const b=this.elements,$=_.elements;for(let ee=0;ee<16;ee++)if(b[ee]!==$[ee])return!1;return!0}fromArray(_,b=0){for(let $=0;$<16;$++)this.elements[$]=_[$+b];return this}toArray(_=[],b=0){const $=this.elements;return _[b]=$[0],_[b+1]=$[1],_[b+2]=$[2],_[b+3]=$[3],_[b+4]=$[4],_[b+5]=$[5],_[b+6]=$[6],_[b+7]=$[7],_[b+8]=$[8],_[b+9]=$[9],_[b+10]=$[10],_[b+11]=$[11],_[b+12]=$[12],_[b+13]=$[13],_[b+14]=$[14],_[b+15]=$[15],_}}const _v1$5=new Vector3,_m1$4=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix$2=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(_=0,b=0,$=0,ee=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=_,this._y=b,this._z=$,this._order=ee}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get order(){return this._order}set order(_){this._order=_,this._onChangeCallback()}set(_,b,$,ee=this._order){return this._x=_,this._y=b,this._z=$,this._order=ee,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(_){return this._x=_._x,this._y=_._y,this._z=_._z,this._order=_._order,this._onChangeCallback(),this}setFromRotationMatrix(_,b=this._order,$=!0){const ee=_.elements,re=ee[0],ae=ee[4],xe=ee[8],le=ee[1],fe=ee[5],ve=ee[9],Se=ee[2],Ee=ee[6],Ce=ee[10];switch(b){case"XYZ":this._y=Math.asin(clamp(xe,-1,1)),Math.abs(xe)<.9999999?(this._x=Math.atan2(-ve,Ce),this._z=Math.atan2(-ae,re)):(this._x=Math.atan2(Ee,fe),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp(ve,-1,1)),Math.abs(ve)<.9999999?(this._y=Math.atan2(xe,Ce),this._z=Math.atan2(le,fe)):(this._y=Math.atan2(-Se,re),this._z=0);break;case"ZXY":this._x=Math.asin(clamp(Ee,-1,1)),Math.abs(Ee)<.9999999?(this._y=Math.atan2(-Se,Ce),this._z=Math.atan2(-ae,fe)):(this._y=0,this._z=Math.atan2(le,re));break;case"ZYX":this._y=Math.asin(-clamp(Se,-1,1)),Math.abs(Se)<.9999999?(this._x=Math.atan2(Ee,Ce),this._z=Math.atan2(le,re)):(this._x=0,this._z=Math.atan2(-ae,fe));break;case"YZX":this._z=Math.asin(clamp(le,-1,1)),Math.abs(le)<.9999999?(this._x=Math.atan2(-ve,fe),this._y=Math.atan2(-Se,re)):(this._x=0,this._y=Math.atan2(xe,Ce));break;case"XZY":this._z=Math.asin(-clamp(ae,-1,1)),Math.abs(ae)<.9999999?(this._x=Math.atan2(Ee,fe),this._y=Math.atan2(xe,re)):(this._x=Math.atan2(-ve,Ce),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+b)}return this._order=b,$===!0&&this._onChangeCallback(),this}setFromQuaternion(_,b,$){return _matrix$2.makeRotationFromQuaternion(_),this.setFromRotationMatrix(_matrix$2,b,$)}setFromVector3(_,b=this._order){return this.set(_.x,_.y,_.z,b)}reorder(_){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,_)}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._order===this._order}fromArray(_){return this._x=_[0],this._y=_[1],this._z=_[2],_[3]!==void 0&&(this._order=_[3]),this._onChangeCallback(),this}toArray(_=[],b=0){return _[b]=this._x,_[b+1]=this._y,_[b+2]=this._z,_[b+3]=this._order,_}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(_){this.mask=(1<<_|0)>>>0}enable(_){this.mask|=1<<_|0}enableAll(){this.mask=-1}toggle(_){this.mask^=1<<_|0}disable(_){this.mask&=~(1<<_|0)}disableAll(){this.mask=0}test(_){return(this.mask&_.mask)!==0}isEnabled(_){return(this.mask&(1<<_|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$3=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"},_childaddedEvent={type:"childadded",child:null},_childremovedEvent={type:"childremoved",child:null};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const _=new Vector3,b=new Euler,$=new Quaternion,ee=new Vector3(1,1,1);function re(){$.setFromEuler(b,!1)}function ae(){b.setFromQuaternion($,void 0,!1)}b._onChange(re),$._onChange(ae),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:_},rotation:{configurable:!0,enumerable:!0,value:b},quaternion:{configurable:!0,enumerable:!0,value:$},scale:{configurable:!0,enumerable:!0,value:ee},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(_){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(_),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(_){return this.quaternion.premultiply(_),this}setRotationFromAxisAngle(_,b){this.quaternion.setFromAxisAngle(_,b)}setRotationFromEuler(_){this.quaternion.setFromEuler(_,!0)}setRotationFromMatrix(_){this.quaternion.setFromRotationMatrix(_)}setRotationFromQuaternion(_){this.quaternion.copy(_)}rotateOnAxis(_,b){return _q1.setFromAxisAngle(_,b),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(_,b){return _q1.setFromAxisAngle(_,b),this.quaternion.premultiply(_q1),this}rotateX(_){return this.rotateOnAxis(_xAxis,_)}rotateY(_){return this.rotateOnAxis(_yAxis,_)}rotateZ(_){return this.rotateOnAxis(_zAxis,_)}translateOnAxis(_,b){return _v1$4.copy(_).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(b)),this}translateX(_){return this.translateOnAxis(_xAxis,_)}translateY(_){return this.translateOnAxis(_yAxis,_)}translateZ(_){return this.translateOnAxis(_zAxis,_)}localToWorld(_){return this.updateWorldMatrix(!0,!1),_.applyMatrix4(this.matrixWorld)}worldToLocal(_){return this.updateWorldMatrix(!0,!1),_.applyMatrix4(_m1$3.copy(this.matrixWorld).invert())}lookAt(_,b,$){_.isVector3?_target.copy(_):_target.set(_,b,$);const ee=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$3.lookAt(_position$3,_target,this.up):_m1$3.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$3),ee&&(_m1$3.extractRotation(ee.matrixWorld),_q1.setFromRotationMatrix(_m1$3),this.quaternion.premultiply(_q1.invert()))}add(_){if(arguments.length>1){for(let b=0;b<arguments.length;b++)this.add(arguments[b]);return this}return _===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_),this):(_&&_.isObject3D?(_.removeFromParent(),_.parent=this,this.children.push(_),_.dispatchEvent(_addedEvent),_childaddedEvent.child=_,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_),this)}remove(_){if(arguments.length>1){for(let $=0;$<arguments.length;$++)this.remove(arguments[$]);return this}const b=this.children.indexOf(_);return b!==-1&&(_.parent=null,this.children.splice(b,1),_.dispatchEvent(_removedEvent),_childremovedEvent.child=_,this.dispatchEvent(_childremovedEvent),_childremovedEvent.child=null),this}removeFromParent(){const _=this.parent;return _!==null&&_.remove(this),this}clear(){return this.remove(...this.children)}attach(_){return this.updateWorldMatrix(!0,!1),_m1$3.copy(this.matrixWorld).invert(),_.parent!==null&&(_.parent.updateWorldMatrix(!0,!1),_m1$3.multiply(_.parent.matrixWorld)),_.applyMatrix4(_m1$3),_.removeFromParent(),_.parent=this,this.children.push(_),_.updateWorldMatrix(!1,!0),_.dispatchEvent(_addedEvent),_childaddedEvent.child=_,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null,this}getObjectById(_){return this.getObjectByProperty("id",_)}getObjectByName(_){return this.getObjectByProperty("name",_)}getObjectByProperty(_,b){if(this[_]===b)return this;for(let $=0,ee=this.children.length;$<ee;$++){const ae=this.children[$].getObjectByProperty(_,b);if(ae!==void 0)return ae}}getObjectsByProperty(_,b,$=[]){this[_]===b&&$.push(this);const ee=this.children;for(let re=0,ae=ee.length;re<ae;re++)ee[re].getObjectsByProperty(_,b,$);return $}getWorldPosition(_){return this.updateWorldMatrix(!0,!1),_.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_,_scale$2),_}getWorldScale(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,_),_}getWorldDirection(_){this.updateWorldMatrix(!0,!1);const b=this.matrixWorld.elements;return _.set(b[8],b[9],b[10]).normalize()}raycast(){}traverse(_){_(this);const b=this.children;for(let $=0,ee=b.length;$<ee;$++)b[$].traverse(_)}traverseVisible(_){if(this.visible===!1)return;_(this);const b=this.children;for(let $=0,ee=b.length;$<ee;$++)b[$].traverseVisible(_)}traverseAncestors(_){const b=this.parent;b!==null&&(_(b),b.traverseAncestors(_))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,_=!0);const b=this.children;for(let $=0,ee=b.length;$<ee;$++)b[$].updateMatrixWorld(_)}updateWorldMatrix(_,b){const $=this.parent;if(_===!0&&$!==null&&$.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),b===!0){const ee=this.children;for(let re=0,ae=ee.length;re<ae;re++)ee[re].updateWorldMatrix(!1,!0)}}toJSON(_){const b=_===void 0||typeof _=="string",$={};b&&(_={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},$.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const ee={};ee.uuid=this.uuid,ee.type=this.type,this.name!==""&&(ee.name=this.name),this.castShadow===!0&&(ee.castShadow=!0),this.receiveShadow===!0&&(ee.receiveShadow=!0),this.visible===!1&&(ee.visible=!1),this.frustumCulled===!1&&(ee.frustumCulled=!1),this.renderOrder!==0&&(ee.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(ee.userData=this.userData),ee.layers=this.layers.mask,ee.matrix=this.matrix.toArray(),ee.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(ee.matrixAutoUpdate=!1),this.isInstancedMesh&&(ee.type="InstancedMesh",ee.count=this.count,ee.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(ee.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(ee.type="BatchedMesh",ee.perObjectFrustumCulled=this.perObjectFrustumCulled,ee.sortObjects=this.sortObjects,ee.drawRanges=this._drawRanges,ee.reservedRanges=this._reservedRanges,ee.visibility=this._visibility,ee.active=this._active,ee.bounds=this._bounds.map(xe=>({boxInitialized:xe.boxInitialized,boxMin:xe.box.min.toArray(),boxMax:xe.box.max.toArray(),sphereInitialized:xe.sphereInitialized,sphereRadius:xe.sphere.radius,sphereCenter:xe.sphere.center.toArray()})),ee.maxInstanceCount=this._maxInstanceCount,ee.maxVertexCount=this._maxVertexCount,ee.maxIndexCount=this._maxIndexCount,ee.geometryInitialized=this._geometryInitialized,ee.geometryCount=this._geometryCount,ee.matricesTexture=this._matricesTexture.toJSON(_),this._colorsTexture!==null&&(ee.colorsTexture=this._colorsTexture.toJSON(_)),this.boundingSphere!==null&&(ee.boundingSphere={center:ee.boundingSphere.center.toArray(),radius:ee.boundingSphere.radius}),this.boundingBox!==null&&(ee.boundingBox={min:ee.boundingBox.min.toArray(),max:ee.boundingBox.max.toArray()}));function re(xe,le){return xe[le.uuid]===void 0&&(xe[le.uuid]=le.toJSON(_)),le.uuid}if(this.isScene)this.background&&(this.background.isColor?ee.background=this.background.toJSON():this.background.isTexture&&(ee.background=this.background.toJSON(_).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(ee.environment=this.environment.toJSON(_).uuid);else if(this.isMesh||this.isLine||this.isPoints){ee.geometry=re(_.geometries,this.geometry);const xe=this.geometry.parameters;if(xe!==void 0&&xe.shapes!==void 0){const le=xe.shapes;if(Array.isArray(le))for(let fe=0,ve=le.length;fe<ve;fe++){const Se=le[fe];re(_.shapes,Se)}else re(_.shapes,le)}}if(this.isSkinnedMesh&&(ee.bindMode=this.bindMode,ee.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(re(_.skeletons,this.skeleton),ee.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const xe=[];for(let le=0,fe=this.material.length;le<fe;le++)xe.push(re(_.materials,this.material[le]));ee.material=xe}else ee.material=re(_.materials,this.material);if(this.children.length>0){ee.children=[];for(let xe=0;xe<this.children.length;xe++)ee.children.push(this.children[xe].toJSON(_).object)}if(this.animations.length>0){ee.animations=[];for(let xe=0;xe<this.animations.length;xe++){const le=this.animations[xe];ee.animations.push(re(_.animations,le))}}if(b){const xe=ae(_.geometries),le=ae(_.materials),fe=ae(_.textures),ve=ae(_.images),Se=ae(_.shapes),Ee=ae(_.skeletons),Ce=ae(_.animations),Ie=ae(_.nodes);xe.length>0&&($.geometries=xe),le.length>0&&($.materials=le),fe.length>0&&($.textures=fe),ve.length>0&&($.images=ve),Se.length>0&&($.shapes=Se),Ee.length>0&&($.skeletons=Ee),Ce.length>0&&($.animations=Ce),Ie.length>0&&($.nodes=Ie)}return $.object=ee,$;function ae(xe){const le=[];for(const fe in xe){const ve=xe[fe];delete ve.metadata,le.push(ve)}return le}}clone(_){return new this.constructor().copy(this,_)}copy(_,b=!0){if(this.name=_.name,this.up.copy(_.up),this.position.copy(_.position),this.rotation.order=_.rotation.order,this.quaternion.copy(_.quaternion),this.scale.copy(_.scale),this.matrix.copy(_.matrix),this.matrixWorld.copy(_.matrixWorld),this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrixWorldAutoUpdate=_.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=_.matrixWorldNeedsUpdate,this.layers.mask=_.layers.mask,this.visible=_.visible,this.castShadow=_.castShadow,this.receiveShadow=_.receiveShadow,this.frustumCulled=_.frustumCulled,this.renderOrder=_.renderOrder,this.animations=_.animations.slice(),this.userData=JSON.parse(JSON.stringify(_.userData)),b===!0)for(let $=0;$<_.children.length;$++){const ee=_.children[$];this.add(ee.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$2=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$2=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;class Triangle{constructor(_=new Vector3,b=new Vector3,$=new Vector3){this.a=_,this.b=b,this.c=$}static getNormal(_,b,$,ee){ee.subVectors($,b),_v0$2.subVectors(_,b),ee.cross(_v0$2);const re=ee.lengthSq();return re>0?ee.multiplyScalar(1/Math.sqrt(re)):ee.set(0,0,0)}static getBarycoord(_,b,$,ee,re){_v0$2.subVectors(ee,b),_v1$3.subVectors($,b),_v2$2.subVectors(_,b);const ae=_v0$2.dot(_v0$2),xe=_v0$2.dot(_v1$3),le=_v0$2.dot(_v2$2),fe=_v1$3.dot(_v1$3),ve=_v1$3.dot(_v2$2),Se=ae*fe-xe*xe;if(Se===0)return re.set(0,0,0),null;const Ee=1/Se,Ce=(fe*le-xe*ve)*Ee,Ie=(ae*ve-xe*le)*Ee;return re.set(1-Ce-Ie,Ie,Ce)}static containsPoint(_,b,$,ee){return this.getBarycoord(_,b,$,ee,_v3$2)===null?!1:_v3$2.x>=0&&_v3$2.y>=0&&_v3$2.x+_v3$2.y<=1}static getInterpolation(_,b,$,ee,re,ae,xe,le){return this.getBarycoord(_,b,$,ee,_v3$2)===null?(le.x=0,le.y=0,"z"in le&&(le.z=0),"w"in le&&(le.w=0),null):(le.setScalar(0),le.addScaledVector(re,_v3$2.x),le.addScaledVector(ae,_v3$2.y),le.addScaledVector(xe,_v3$2.z),le)}static isFrontFacing(_,b,$,ee){return _v0$2.subVectors($,b),_v1$3.subVectors(_,b),_v0$2.cross(_v1$3).dot(ee)<0}set(_,b,$){return this.a.copy(_),this.b.copy(b),this.c.copy($),this}setFromPointsAndIndices(_,b,$,ee){return this.a.copy(_[b]),this.b.copy(_[$]),this.c.copy(_[ee]),this}setFromAttributeAndIndices(_,b,$,ee){return this.a.fromBufferAttribute(_,b),this.b.fromBufferAttribute(_,$),this.c.fromBufferAttribute(_,ee),this}clone(){return new this.constructor().copy(this)}copy(_){return this.a.copy(_.a),this.b.copy(_.b),this.c.copy(_.c),this}getArea(){return _v0$2.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$2.cross(_v1$3).length()*.5}getMidpoint(_){return _.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(_){return Triangle.getNormal(this.a,this.b,this.c,_)}getPlane(_){return _.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(_,b){return Triangle.getBarycoord(_,this.a,this.b,this.c,b)}getInterpolation(_,b,$,ee,re){return Triangle.getInterpolation(_,this.a,this.b,this.c,b,$,ee,re)}containsPoint(_){return Triangle.containsPoint(_,this.a,this.b,this.c)}isFrontFacing(_){return Triangle.isFrontFacing(this.a,this.b,this.c,_)}intersectsBox(_){return _.intersectsTriangle(this)}closestPointToPoint(_,b){const $=this.a,ee=this.b,re=this.c;let ae,xe;_vab.subVectors(ee,$),_vac.subVectors(re,$),_vap.subVectors(_,$);const le=_vab.dot(_vap),fe=_vac.dot(_vap);if(le<=0&&fe<=0)return b.copy($);_vbp.subVectors(_,ee);const ve=_vab.dot(_vbp),Se=_vac.dot(_vbp);if(ve>=0&&Se<=ve)return b.copy(ee);const Ee=le*Se-ve*fe;if(Ee<=0&&le>=0&&ve<=0)return ae=le/(le-ve),b.copy($).addScaledVector(_vab,ae);_vcp.subVectors(_,re);const Ce=_vab.dot(_vcp),Ie=_vac.dot(_vcp);if(Ie>=0&&Ce<=Ie)return b.copy(re);const De=Ce*fe-le*Ie;if(De<=0&&fe>=0&&Ie<=0)return xe=fe/(fe-Ie),b.copy($).addScaledVector(_vac,xe);const Be=ve*Ie-Ce*Se;if(Be<=0&&Se-ve>=0&&Ce-Ie>=0)return _vbc.subVectors(re,ee),xe=(Se-ve)/(Se-ve+(Ce-Ie)),b.copy(ee).addScaledVector(_vbc,xe);const Ne=1/(Be+De+Ee);return ae=De*Ne,xe=Ee*Ne,b.copy($).addScaledVector(_vab,ae).addScaledVector(_vac,xe)}equals(_){return _.a.equals(this.a)&&_.b.equals(this.b)&&_.c.equals(this.c)}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(H,_,b){return b<0&&(b+=1),b>1&&(b-=1),b<1/6?H+(_-H)*6*b:b<1/2?_:b<2/3?H+(_-H)*6*(2/3-b):H}class Color{constructor(_,b,$){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(_,b,$)}set(_,b,$){if(b===void 0&&$===void 0){const ee=_;ee&&ee.isColor?this.copy(ee):typeof ee=="number"?this.setHex(ee):typeof ee=="string"&&this.setStyle(ee)}else this.setRGB(_,b,$);return this}setScalar(_){return this.r=_,this.g=_,this.b=_,this}setHex(_,b=SRGBColorSpace){return _=Math.floor(_),this.r=(_>>16&255)/255,this.g=(_>>8&255)/255,this.b=(_&255)/255,ColorManagement.toWorkingColorSpace(this,b),this}setRGB(_,b,$,ee=ColorManagement.workingColorSpace){return this.r=_,this.g=b,this.b=$,ColorManagement.toWorkingColorSpace(this,ee),this}setHSL(_,b,$,ee=ColorManagement.workingColorSpace){if(_=euclideanModulo(_,1),b=clamp(b,0,1),$=clamp($,0,1),b===0)this.r=this.g=this.b=$;else{const re=$<=.5?$*(1+b):$+b-$*b,ae=2*$-re;this.r=hue2rgb(ae,re,_+1/3),this.g=hue2rgb(ae,re,_),this.b=hue2rgb(ae,re,_-1/3)}return ColorManagement.toWorkingColorSpace(this,ee),this}setStyle(_,b=SRGBColorSpace){function $(re){re!==void 0&&parseFloat(re)<1&&console.warn("THREE.Color: Alpha component of "+_+" will be ignored.")}let ee;if(ee=/^(\w+)\(([^\)]*)\)/.exec(_)){let re;const ae=ee[1],xe=ee[2];switch(ae){case"rgb":case"rgba":if(re=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(xe))return $(re[4]),this.setRGB(Math.min(255,parseInt(re[1],10))/255,Math.min(255,parseInt(re[2],10))/255,Math.min(255,parseInt(re[3],10))/255,b);if(re=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(xe))return $(re[4]),this.setRGB(Math.min(100,parseInt(re[1],10))/100,Math.min(100,parseInt(re[2],10))/100,Math.min(100,parseInt(re[3],10))/100,b);break;case"hsl":case"hsla":if(re=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(xe))return $(re[4]),this.setHSL(parseFloat(re[1])/360,parseFloat(re[2])/100,parseFloat(re[3])/100,b);break;default:console.warn("THREE.Color: Unknown color model "+_)}}else if(ee=/^\#([A-Fa-f\d]+)$/.exec(_)){const re=ee[1],ae=re.length;if(ae===3)return this.setRGB(parseInt(re.charAt(0),16)/15,parseInt(re.charAt(1),16)/15,parseInt(re.charAt(2),16)/15,b);if(ae===6)return this.setHex(parseInt(re,16),b);console.warn("THREE.Color: Invalid hex color "+_)}else if(_&&_.length>0)return this.setColorName(_,b);return this}setColorName(_,b=SRGBColorSpace){const $=_colorKeywords[_.toLowerCase()];return $!==void 0?this.setHex($,b):console.warn("THREE.Color: Unknown color "+_),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(_){return this.r=_.r,this.g=_.g,this.b=_.b,this}copySRGBToLinear(_){return this.r=SRGBToLinear(_.r),this.g=SRGBToLinear(_.g),this.b=SRGBToLinear(_.b),this}copyLinearToSRGB(_){return this.r=LinearToSRGB(_.r),this.g=LinearToSRGB(_.g),this.b=LinearToSRGB(_.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(_=SRGBColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),_),Math.round(clamp(_color.r*255,0,255))*65536+Math.round(clamp(_color.g*255,0,255))*256+Math.round(clamp(_color.b*255,0,255))}getHexString(_=SRGBColorSpace){return("000000"+this.getHex(_).toString(16)).slice(-6)}getHSL(_,b=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),b);const $=_color.r,ee=_color.g,re=_color.b,ae=Math.max($,ee,re),xe=Math.min($,ee,re);let le,fe;const ve=(xe+ae)/2;if(xe===ae)le=0,fe=0;else{const Se=ae-xe;switch(fe=ve<=.5?Se/(ae+xe):Se/(2-ae-xe),ae){case $:le=(ee-re)/Se+(ee<re?6:0);break;case ee:le=(re-$)/Se+2;break;case re:le=($-ee)/Se+4;break}le/=6}return _.h=le,_.s=fe,_.l=ve,_}getRGB(_,b=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),b),_.r=_color.r,_.g=_color.g,_.b=_color.b,_}getStyle(_=SRGBColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),_);const b=_color.r,$=_color.g,ee=_color.b;return _!==SRGBColorSpace?`color(${_} ${b.toFixed(3)} ${$.toFixed(3)} ${ee.toFixed(3)})`:`rgb(${Math.round(b*255)},${Math.round($*255)},${Math.round(ee*255)})`}offsetHSL(_,b,$){return this.getHSL(_hslA),this.setHSL(_hslA.h+_,_hslA.s+b,_hslA.l+$)}add(_){return this.r+=_.r,this.g+=_.g,this.b+=_.b,this}addColors(_,b){return this.r=_.r+b.r,this.g=_.g+b.g,this.b=_.b+b.b,this}addScalar(_){return this.r+=_,this.g+=_,this.b+=_,this}sub(_){return this.r=Math.max(0,this.r-_.r),this.g=Math.max(0,this.g-_.g),this.b=Math.max(0,this.b-_.b),this}multiply(_){return this.r*=_.r,this.g*=_.g,this.b*=_.b,this}multiplyScalar(_){return this.r*=_,this.g*=_,this.b*=_,this}lerp(_,b){return this.r+=(_.r-this.r)*b,this.g+=(_.g-this.g)*b,this.b+=(_.b-this.b)*b,this}lerpColors(_,b,$){return this.r=_.r+(b.r-_.r)*$,this.g=_.g+(b.g-_.g)*$,this.b=_.b+(b.b-_.b)*$,this}lerpHSL(_,b){this.getHSL(_hslA),_.getHSL(_hslB);const $=lerp(_hslA.h,_hslB.h,b),ee=lerp(_hslA.s,_hslB.s,b),re=lerp(_hslA.l,_hslB.l,b);return this.setHSL($,ee,re),this}setFromVector3(_){return this.r=_.x,this.g=_.y,this.b=_.z,this}applyMatrix3(_){const b=this.r,$=this.g,ee=this.b,re=_.elements;return this.r=re[0]*b+re[3]*$+re[6]*ee,this.g=re[1]*b+re[4]*$+re[7]*ee,this.b=re[2]*b+re[5]*$+re[8]*ee,this}equals(_){return _.r===this.r&&_.g===this.g&&_.b===this.b}fromArray(_,b=0){return this.r=_[b],this.g=_[b+1],this.b=_[b+2],this}toArray(_=[],b=0){return _[b]=this.r,_[b+1]=this.g,_[b+2]=this.b,_}fromBufferAttribute(_,b){return this.r=_.getX(b),this.g=_.getY(b),this.b=_.getZ(b),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const _color=new Color;Color.NAMES=_colorKeywords;let _materialId=0;class Material extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_materialId++}),this.uuid=generateUUID(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Color(0,0,0),this.blendAlpha=0,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(_){this._alphaTest>0!=_>0&&this.version++,this._alphaTest=_}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(_){if(_!==void 0)for(const b in _){const $=_[b];if($===void 0){console.warn(`THREE.Material: parameter '${b}' has value of undefined.`);continue}const ee=this[b];if(ee===void 0){console.warn(`THREE.Material: '${b}' is not a property of THREE.${this.type}.`);continue}ee&&ee.isColor?ee.set($):ee&&ee.isVector3&&$&&$.isVector3?ee.copy($):this[b]=$}}toJSON(_){const b=_===void 0||typeof _=="string";b&&(_={textures:{},images:{}});const $={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};$.uuid=this.uuid,$.type=this.type,this.name!==""&&($.name=this.name),this.color&&this.color.isColor&&($.color=this.color.getHex()),this.roughness!==void 0&&($.roughness=this.roughness),this.metalness!==void 0&&($.metalness=this.metalness),this.sheen!==void 0&&($.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&($.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&($.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&($.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&($.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&($.specular=this.specular.getHex()),this.specularIntensity!==void 0&&($.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&($.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&($.shininess=this.shininess),this.clearcoat!==void 0&&($.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&($.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&($.clearcoatMap=this.clearcoatMap.toJSON(_).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&($.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(_).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&($.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(_).uuid,$.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&($.dispersion=this.dispersion),this.iridescence!==void 0&&($.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&($.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&($.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&($.iridescenceMap=this.iridescenceMap.toJSON(_).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&($.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(_).uuid),this.anisotropy!==void 0&&($.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&($.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&($.anisotropyMap=this.anisotropyMap.toJSON(_).uuid),this.map&&this.map.isTexture&&($.map=this.map.toJSON(_).uuid),this.matcap&&this.matcap.isTexture&&($.matcap=this.matcap.toJSON(_).uuid),this.alphaMap&&this.alphaMap.isTexture&&($.alphaMap=this.alphaMap.toJSON(_).uuid),this.lightMap&&this.lightMap.isTexture&&($.lightMap=this.lightMap.toJSON(_).uuid,$.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&($.aoMap=this.aoMap.toJSON(_).uuid,$.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&($.bumpMap=this.bumpMap.toJSON(_).uuid,$.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&($.normalMap=this.normalMap.toJSON(_).uuid,$.normalMapType=this.normalMapType,$.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&($.displacementMap=this.displacementMap.toJSON(_).uuid,$.displacementScale=this.displacementScale,$.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&($.roughnessMap=this.roughnessMap.toJSON(_).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&($.metalnessMap=this.metalnessMap.toJSON(_).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&($.emissiveMap=this.emissiveMap.toJSON(_).uuid),this.specularMap&&this.specularMap.isTexture&&($.specularMap=this.specularMap.toJSON(_).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&($.specularIntensityMap=this.specularIntensityMap.toJSON(_).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&($.specularColorMap=this.specularColorMap.toJSON(_).uuid),this.envMap&&this.envMap.isTexture&&($.envMap=this.envMap.toJSON(_).uuid,this.combine!==void 0&&($.combine=this.combine)),this.envMapRotation!==void 0&&($.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&($.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&($.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&($.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&($.gradientMap=this.gradientMap.toJSON(_).uuid),this.transmission!==void 0&&($.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&($.transmissionMap=this.transmissionMap.toJSON(_).uuid),this.thickness!==void 0&&($.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&($.thicknessMap=this.thicknessMap.toJSON(_).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&($.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&($.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&($.size=this.size),this.shadowSide!==null&&($.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&($.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&($.blending=this.blending),this.side!==FrontSide&&($.side=this.side),this.vertexColors===!0&&($.vertexColors=!0),this.opacity<1&&($.opacity=this.opacity),this.transparent===!0&&($.transparent=!0),this.blendSrc!==SrcAlphaFactor&&($.blendSrc=this.blendSrc),this.blendDst!==OneMinusSrcAlphaFactor&&($.blendDst=this.blendDst),this.blendEquation!==AddEquation&&($.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&($.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&($.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&($.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&($.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&($.blendAlpha=this.blendAlpha),this.depthFunc!==LessEqualDepth&&($.depthFunc=this.depthFunc),this.depthTest===!1&&($.depthTest=this.depthTest),this.depthWrite===!1&&($.depthWrite=this.depthWrite),this.colorWrite===!1&&($.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&($.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AlwaysStencilFunc&&($.stencilFunc=this.stencilFunc),this.stencilRef!==0&&($.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&($.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==KeepStencilOp&&($.stencilFail=this.stencilFail),this.stencilZFail!==KeepStencilOp&&($.stencilZFail=this.stencilZFail),this.stencilZPass!==KeepStencilOp&&($.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&($.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&($.rotation=this.rotation),this.polygonOffset===!0&&($.polygonOffset=!0),this.polygonOffsetFactor!==0&&($.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&($.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&($.linewidth=this.linewidth),this.dashSize!==void 0&&($.dashSize=this.dashSize),this.gapSize!==void 0&&($.gapSize=this.gapSize),this.scale!==void 0&&($.scale=this.scale),this.dithering===!0&&($.dithering=!0),this.alphaTest>0&&($.alphaTest=this.alphaTest),this.alphaHash===!0&&($.alphaHash=!0),this.alphaToCoverage===!0&&($.alphaToCoverage=!0),this.premultipliedAlpha===!0&&($.premultipliedAlpha=!0),this.forceSinglePass===!0&&($.forceSinglePass=!0),this.wireframe===!0&&($.wireframe=!0),this.wireframeLinewidth>1&&($.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&($.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&($.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&($.flatShading=!0),this.visible===!1&&($.visible=!1),this.toneMapped===!1&&($.toneMapped=!1),this.fog===!1&&($.fog=!1),Object.keys(this.userData).length>0&&($.userData=this.userData);function ee(re){const ae=[];for(const xe in re){const le=re[xe];delete le.metadata,ae.push(le)}return ae}if(b){const re=ee(_.textures),ae=ee(_.images);re.length>0&&($.textures=re),ae.length>0&&($.images=ae)}return $}clone(){return new this.constructor().copy(this)}copy(_){this.name=_.name,this.blending=_.blending,this.side=_.side,this.vertexColors=_.vertexColors,this.opacity=_.opacity,this.transparent=_.transparent,this.blendSrc=_.blendSrc,this.blendDst=_.blendDst,this.blendEquation=_.blendEquation,this.blendSrcAlpha=_.blendSrcAlpha,this.blendDstAlpha=_.blendDstAlpha,this.blendEquationAlpha=_.blendEquationAlpha,this.blendColor.copy(_.blendColor),this.blendAlpha=_.blendAlpha,this.depthFunc=_.depthFunc,this.depthTest=_.depthTest,this.depthWrite=_.depthWrite,this.stencilWriteMask=_.stencilWriteMask,this.stencilFunc=_.stencilFunc,this.stencilRef=_.stencilRef,this.stencilFuncMask=_.stencilFuncMask,this.stencilFail=_.stencilFail,this.stencilZFail=_.stencilZFail,this.stencilZPass=_.stencilZPass,this.stencilWrite=_.stencilWrite;const b=_.clippingPlanes;let $=null;if(b!==null){const ee=b.length;$=new Array(ee);for(let re=0;re!==ee;++re)$[re]=b[re].clone()}return this.clippingPlanes=$,this.clipIntersection=_.clipIntersection,this.clipShadows=_.clipShadows,this.shadowSide=_.shadowSide,this.colorWrite=_.colorWrite,this.precision=_.precision,this.polygonOffset=_.polygonOffset,this.polygonOffsetFactor=_.polygonOffsetFactor,this.polygonOffsetUnits=_.polygonOffsetUnits,this.dithering=_.dithering,this.alphaTest=_.alphaTest,this.alphaHash=_.alphaHash,this.alphaToCoverage=_.alphaToCoverage,this.premultipliedAlpha=_.premultipliedAlpha,this.forceSinglePass=_.forceSinglePass,this.visible=_.visible,this.toneMapped=_.toneMapped,this.userData=JSON.parse(JSON.stringify(_.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_){_===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class MeshBasicMaterial extends Material{constructor(_){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.fog=_.fog,this}}const _tables=_generateTables();function _generateTables(){const H=new ArrayBuffer(4),_=new Float32Array(H),b=new Uint32Array(H),$=new Uint32Array(512),ee=new Uint32Array(512);for(let le=0;le<256;++le){const fe=le-127;fe<-27?($[le]=0,$[le|256]=32768,ee[le]=24,ee[le|256]=24):fe<-14?($[le]=1024>>-fe-14,$[le|256]=1024>>-fe-14|32768,ee[le]=-fe-1,ee[le|256]=-fe-1):fe<=15?($[le]=fe+15<<10,$[le|256]=fe+15<<10|32768,ee[le]=13,ee[le|256]=13):fe<128?($[le]=31744,$[le|256]=64512,ee[le]=24,ee[le|256]=24):($[le]=31744,$[le|256]=64512,ee[le]=13,ee[le|256]=13)}const re=new Uint32Array(2048),ae=new Uint32Array(64),xe=new Uint32Array(64);for(let le=1;le<1024;++le){let fe=le<<13,ve=0;for(;(fe&8388608)===0;)fe<<=1,ve-=8388608;fe&=-8388609,ve+=947912704,re[le]=fe|ve}for(let le=1024;le<2048;++le)re[le]=939524096+(le-1024<<13);for(let le=1;le<31;++le)ae[le]=le<<23;ae[31]=1199570944,ae[32]=2147483648;for(let le=33;le<63;++le)ae[le]=2147483648+(le-32<<23);ae[63]=3347054592;for(let le=1;le<64;++le)le!==32&&(xe[le]=1024);return{floatView:_,uint32View:b,baseTable:$,shiftTable:ee,mantissaTable:re,exponentTable:ae,offsetTable:xe}}function toHalfFloat(H){Math.abs(H)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),H=clamp(H,-65504,65504),_tables.floatView[0]=H;const _=_tables.uint32View[0],b=_>>23&511;return _tables.baseTable[b]+((_&8388607)>>_tables.shiftTable[b])}function fromHalfFloat(H){const _=H>>10;return _tables.uint32View[0]=_tables.mantissaTable[_tables.offsetTable[_]+(H&1023)]+_tables.exponentTable[_],_tables.floatView[0]}const DataUtils={toHalfFloat,fromHalfFloat},_vector$9=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(_,b,$=!1){if(Array.isArray(_))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=_,this.itemSize=b,this.count=_!==void 0?_.length/b:0,this.normalized=$,this.usage=StaticDrawUsage,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}get updateRange(){return warnOnce("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(_){return this.usage=_,this}addUpdateRange(_,b){this.updateRanges.push({start:_,count:b})}clearUpdateRanges(){this.updateRanges.length=0}copy(_){return this.name=_.name,this.array=new _.array.constructor(_.array),this.itemSize=_.itemSize,this.count=_.count,this.normalized=_.normalized,this.usage=_.usage,this.gpuType=_.gpuType,this}copyAt(_,b,$){_*=this.itemSize,$*=b.itemSize;for(let ee=0,re=this.itemSize;ee<re;ee++)this.array[_+ee]=b.array[$+ee];return this}copyArray(_){return this.array.set(_),this}applyMatrix3(_){if(this.itemSize===2)for(let b=0,$=this.count;b<$;b++)_vector2$1.fromBufferAttribute(this,b),_vector2$1.applyMatrix3(_),this.setXY(b,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let b=0,$=this.count;b<$;b++)_vector$9.fromBufferAttribute(this,b),_vector$9.applyMatrix3(_),this.setXYZ(b,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyMatrix4(_){for(let b=0,$=this.count;b<$;b++)_vector$9.fromBufferAttribute(this,b),_vector$9.applyMatrix4(_),this.setXYZ(b,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyNormalMatrix(_){for(let b=0,$=this.count;b<$;b++)_vector$9.fromBufferAttribute(this,b),_vector$9.applyNormalMatrix(_),this.setXYZ(b,_vector$9.x,_vector$9.y,_vector$9.z);return this}transformDirection(_){for(let b=0,$=this.count;b<$;b++)_vector$9.fromBufferAttribute(this,b),_vector$9.transformDirection(_),this.setXYZ(b,_vector$9.x,_vector$9.y,_vector$9.z);return this}set(_,b=0){return this.array.set(_,b),this}getComponent(_,b){let $=this.array[_*this.itemSize+b];return this.normalized&&($=denormalize($,this.array)),$}setComponent(_,b,$){return this.normalized&&($=normalize($,this.array)),this.array[_*this.itemSize+b]=$,this}getX(_){let b=this.array[_*this.itemSize];return this.normalized&&(b=denormalize(b,this.array)),b}setX(_,b){return this.normalized&&(b=normalize(b,this.array)),this.array[_*this.itemSize]=b,this}getY(_){let b=this.array[_*this.itemSize+1];return this.normalized&&(b=denormalize(b,this.array)),b}setY(_,b){return this.normalized&&(b=normalize(b,this.array)),this.array[_*this.itemSize+1]=b,this}getZ(_){let b=this.array[_*this.itemSize+2];return this.normalized&&(b=denormalize(b,this.array)),b}setZ(_,b){return this.normalized&&(b=normalize(b,this.array)),this.array[_*this.itemSize+2]=b,this}getW(_){let b=this.array[_*this.itemSize+3];return this.normalized&&(b=denormalize(b,this.array)),b}setW(_,b){return this.normalized&&(b=normalize(b,this.array)),this.array[_*this.itemSize+3]=b,this}setXY(_,b,$){return _*=this.itemSize,this.normalized&&(b=normalize(b,this.array),$=normalize($,this.array)),this.array[_+0]=b,this.array[_+1]=$,this}setXYZ(_,b,$,ee){return _*=this.itemSize,this.normalized&&(b=normalize(b,this.array),$=normalize($,this.array),ee=normalize(ee,this.array)),this.array[_+0]=b,this.array[_+1]=$,this.array[_+2]=ee,this}setXYZW(_,b,$,ee,re){return _*=this.itemSize,this.normalized&&(b=normalize(b,this.array),$=normalize($,this.array),ee=normalize(ee,this.array),re=normalize(re,this.array)),this.array[_+0]=b,this.array[_+1]=$,this.array[_+2]=ee,this.array[_+3]=re,this}onUpload(_){return this.onUploadCallback=_,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const _={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(_.name=this.name),this.usage!==StaticDrawUsage&&(_.usage=this.usage),_}}class Uint16BufferAttribute extends BufferAttribute{constructor(_,b,$){super(new Uint16Array(_),b,$)}}class Uint32BufferAttribute extends BufferAttribute{constructor(_,b,$){super(new Uint32Array(_),b,$)}}class Float32BufferAttribute extends BufferAttribute{constructor(_,b,$){super(new Float32Array(_),b,$)}}let _id$2=0;const _m1$2=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$8=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$2++}),this.uuid=generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(_){return Array.isArray(_)?this.index=new(arrayNeedsUint32(_)?Uint32BufferAttribute:Uint16BufferAttribute)(_,1):this.index=_,this}getAttribute(_){return this.attributes[_]}setAttribute(_,b){return this.attributes[_]=b,this}deleteAttribute(_){return delete this.attributes[_],this}hasAttribute(_){return this.attributes[_]!==void 0}addGroup(_,b,$=0){this.groups.push({start:_,count:b,materialIndex:$})}clearGroups(){this.groups=[]}setDrawRange(_,b){this.drawRange.start=_,this.drawRange.count=b}applyMatrix4(_){const b=this.attributes.position;b!==void 0&&(b.applyMatrix4(_),b.needsUpdate=!0);const $=this.attributes.normal;if($!==void 0){const re=new Matrix3().getNormalMatrix(_);$.applyNormalMatrix(re),$.needsUpdate=!0}const ee=this.attributes.tangent;return ee!==void 0&&(ee.transformDirection(_),ee.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(_){return _m1$2.makeRotationFromQuaternion(_),this.applyMatrix4(_m1$2),this}rotateX(_){return _m1$2.makeRotationX(_),this.applyMatrix4(_m1$2),this}rotateY(_){return _m1$2.makeRotationY(_),this.applyMatrix4(_m1$2),this}rotateZ(_){return _m1$2.makeRotationZ(_),this.applyMatrix4(_m1$2),this}translate(_,b,$){return _m1$2.makeTranslation(_,b,$),this.applyMatrix4(_m1$2),this}scale(_,b,$){return _m1$2.makeScale(_,b,$),this.applyMatrix4(_m1$2),this}lookAt(_){return _obj.lookAt(_),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(_){const b=[];for(let $=0,ee=_.length;$<ee;$++){const re=_[$];b.push(re.x,re.y,re.z||0)}return this.setAttribute("position",new Float32BufferAttribute(b,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _=this.attributes.position,b=this.morphAttributes.position;if(_&&_.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(_!==void 0){if(this.boundingBox.setFromBufferAttribute(_),b)for(let $=0,ee=b.length;$<ee;$++){const re=b[$];_box$2.setFromBufferAttribute(re),this.morphTargetsRelative?(_vector$8.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$8),_vector$8.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$8)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const _=this.attributes.position,b=this.morphAttributes.position;if(_&&_.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Vector3,1/0);return}if(_){const $=this.boundingSphere.center;if(_box$2.setFromBufferAttribute(_),b)for(let re=0,ae=b.length;re<ae;re++){const xe=b[re];_boxMorphTargets.setFromBufferAttribute(xe),this.morphTargetsRelative?(_vector$8.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$8),_vector$8.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$8)):(_box$2.expandByPoint(_boxMorphTargets.min),_box$2.expandByPoint(_boxMorphTargets.max))}_box$2.getCenter($);let ee=0;for(let re=0,ae=_.count;re<ae;re++)_vector$8.fromBufferAttribute(_,re),ee=Math.max(ee,$.distanceToSquared(_vector$8));if(b)for(let re=0,ae=b.length;re<ae;re++){const xe=b[re],le=this.morphTargetsRelative;for(let fe=0,ve=xe.count;fe<ve;fe++)_vector$8.fromBufferAttribute(xe,fe),le&&(_offset.fromBufferAttribute(_,fe),_vector$8.add(_offset)),ee=Math.max(ee,$.distanceToSquared(_vector$8))}this.boundingSphere.radius=Math.sqrt(ee),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const _=this.index,b=this.attributes;if(_===null||b.position===void 0||b.normal===void 0||b.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const $=b.position,ee=b.normal,re=b.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*$.count),4));const ae=this.getAttribute("tangent"),xe=[],le=[];for(let ct=0;ct<$.count;ct++)xe[ct]=new Vector3,le[ct]=new Vector3;const fe=new Vector3,ve=new Vector3,Se=new Vector3,Ee=new Vector2,Ce=new Vector2,Ie=new Vector2,De=new Vector3,Be=new Vector3;function Ne(ct,mt,_t){fe.fromBufferAttribute($,ct),ve.fromBufferAttribute($,mt),Se.fromBufferAttribute($,_t),Ee.fromBufferAttribute(re,ct),Ce.fromBufferAttribute(re,mt),Ie.fromBufferAttribute(re,_t),ve.sub(fe),Se.sub(fe),Ce.sub(Ee),Ie.sub(Ee);const Lt=1/(Ce.x*Ie.y-Ie.x*Ce.y);isFinite(Lt)&&(De.copy(ve).multiplyScalar(Ie.y).addScaledVector(Se,-Ce.y).multiplyScalar(Lt),Be.copy(Se).multiplyScalar(Ce.x).addScaledVector(ve,-Ie.x).multiplyScalar(Lt),xe[ct].add(De),xe[mt].add(De),xe[_t].add(De),le[ct].add(Be),le[mt].add(Be),le[_t].add(Be))}let qe=this.groups;qe.length===0&&(qe=[{start:0,count:_.count}]);for(let ct=0,mt=qe.length;ct<mt;++ct){const _t=qe[ct],Lt=_t.start,Vt=_t.count;for(let Gt=Lt,$t=Lt+Vt;Gt<$t;Gt+=3)Ne(_.getX(Gt+0),_.getX(Gt+1),_.getX(Gt+2))}const Xe=new Vector3,Ye=new Vector3,Qe=new Vector3,rt=new Vector3;function ot(ct){Qe.fromBufferAttribute(ee,ct),rt.copy(Qe);const mt=xe[ct];Xe.copy(mt),Xe.sub(Qe.multiplyScalar(Qe.dot(mt))).normalize(),Ye.crossVectors(rt,mt);const Lt=Ye.dot(le[ct])<0?-1:1;ae.setXYZW(ct,Xe.x,Xe.y,Xe.z,Lt)}for(let ct=0,mt=qe.length;ct<mt;++ct){const _t=qe[ct],Lt=_t.start,Vt=_t.count;for(let Gt=Lt,$t=Lt+Vt;Gt<$t;Gt+=3)ot(_.getX(Gt+0)),ot(_.getX(Gt+1)),ot(_.getX(Gt+2))}}computeVertexNormals(){const _=this.index,b=this.getAttribute("position");if(b!==void 0){let $=this.getAttribute("normal");if($===void 0)$=new BufferAttribute(new Float32Array(b.count*3),3),this.setAttribute("normal",$);else for(let Ee=0,Ce=$.count;Ee<Ce;Ee++)$.setXYZ(Ee,0,0,0);const ee=new Vector3,re=new Vector3,ae=new Vector3,xe=new Vector3,le=new Vector3,fe=new Vector3,ve=new Vector3,Se=new Vector3;if(_)for(let Ee=0,Ce=_.count;Ee<Ce;Ee+=3){const Ie=_.getX(Ee+0),De=_.getX(Ee+1),Be=_.getX(Ee+2);ee.fromBufferAttribute(b,Ie),re.fromBufferAttribute(b,De),ae.fromBufferAttribute(b,Be),ve.subVectors(ae,re),Se.subVectors(ee,re),ve.cross(Se),xe.fromBufferAttribute($,Ie),le.fromBufferAttribute($,De),fe.fromBufferAttribute($,Be),xe.add(ve),le.add(ve),fe.add(ve),$.setXYZ(Ie,xe.x,xe.y,xe.z),$.setXYZ(De,le.x,le.y,le.z),$.setXYZ(Be,fe.x,fe.y,fe.z)}else for(let Ee=0,Ce=b.count;Ee<Ce;Ee+=3)ee.fromBufferAttribute(b,Ee+0),re.fromBufferAttribute(b,Ee+1),ae.fromBufferAttribute(b,Ee+2),ve.subVectors(ae,re),Se.subVectors(ee,re),ve.cross(Se),$.setXYZ(Ee+0,ve.x,ve.y,ve.z),$.setXYZ(Ee+1,ve.x,ve.y,ve.z),$.setXYZ(Ee+2,ve.x,ve.y,ve.z);this.normalizeNormals(),$.needsUpdate=!0}}normalizeNormals(){const _=this.attributes.normal;for(let b=0,$=_.count;b<$;b++)_vector$8.fromBufferAttribute(_,b),_vector$8.normalize(),_.setXYZ(b,_vector$8.x,_vector$8.y,_vector$8.z)}toNonIndexed(){function _(xe,le){const fe=xe.array,ve=xe.itemSize,Se=xe.normalized,Ee=new fe.constructor(le.length*ve);let Ce=0,Ie=0;for(let De=0,Be=le.length;De<Be;De++){xe.isInterleavedBufferAttribute?Ce=le[De]*xe.data.stride+xe.offset:Ce=le[De]*ve;for(let Ne=0;Ne<ve;Ne++)Ee[Ie++]=fe[Ce++]}return new BufferAttribute(Ee,ve,Se)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const b=new BufferGeometry,$=this.index.array,ee=this.attributes;for(const xe in ee){const le=ee[xe],fe=_(le,$);b.setAttribute(xe,fe)}const re=this.morphAttributes;for(const xe in re){const le=[],fe=re[xe];for(let ve=0,Se=fe.length;ve<Se;ve++){const Ee=fe[ve],Ce=_(Ee,$);le.push(Ce)}b.morphAttributes[xe]=le}b.morphTargetsRelative=this.morphTargetsRelative;const ae=this.groups;for(let xe=0,le=ae.length;xe<le;xe++){const fe=ae[xe];b.addGroup(fe.start,fe.count,fe.materialIndex)}return b}toJSON(){const _={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_.uuid=this.uuid,_.type=this.type,this.name!==""&&(_.name=this.name),Object.keys(this.userData).length>0&&(_.userData=this.userData),this.parameters!==void 0){const le=this.parameters;for(const fe in le)le[fe]!==void 0&&(_[fe]=le[fe]);return _}_.data={attributes:{}};const b=this.index;b!==null&&(_.data.index={type:b.array.constructor.name,array:Array.prototype.slice.call(b.array)});const $=this.attributes;for(const le in $){const fe=$[le];_.data.attributes[le]=fe.toJSON(_.data)}const ee={};let re=!1;for(const le in this.morphAttributes){const fe=this.morphAttributes[le],ve=[];for(let Se=0,Ee=fe.length;Se<Ee;Se++){const Ce=fe[Se];ve.push(Ce.toJSON(_.data))}ve.length>0&&(ee[le]=ve,re=!0)}re&&(_.data.morphAttributes=ee,_.data.morphTargetsRelative=this.morphTargetsRelative);const ae=this.groups;ae.length>0&&(_.data.groups=JSON.parse(JSON.stringify(ae)));const xe=this.boundingSphere;return xe!==null&&(_.data.boundingSphere={center:xe.center.toArray(),radius:xe.radius}),_}clone(){return new this.constructor().copy(this)}copy(_){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const b={};this.name=_.name;const $=_.index;$!==null&&this.setIndex($.clone(b));const ee=_.attributes;for(const fe in ee){const ve=ee[fe];this.setAttribute(fe,ve.clone(b))}const re=_.morphAttributes;for(const fe in re){const ve=[],Se=re[fe];for(let Ee=0,Ce=Se.length;Ee<Ce;Ee++)ve.push(Se[Ee].clone(b));this.morphAttributes[fe]=ve}this.morphTargetsRelative=_.morphTargetsRelative;const ae=_.groups;for(let fe=0,ve=ae.length;fe<ve;fe++){const Se=ae[fe];this.addGroup(Se.start,Se.count,Se.materialIndex)}const xe=_.boundingBox;xe!==null&&(this.boundingBox=xe.clone());const le=_.boundingSphere;return le!==null&&(this.boundingSphere=le.clone()),this.drawRange.start=_.drawRange.start,this.drawRange.count=_.drawRange.count,this.userData=_.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray,_sphere$6=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2,_normalA=new Vector3,_normalB=new Vector3,_normalC=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(_=new BufferGeometry,b=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=_,this.material=b,this.updateMorphTargets()}copy(_,b){return super.copy(_,b),_.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=_.morphTargetInfluences.slice()),_.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},_.morphTargetDictionary)),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}updateMorphTargets(){const b=this.geometry.morphAttributes,$=Object.keys(b);if($.length>0){const ee=b[$[0]];if(ee!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let re=0,ae=ee.length;re<ae;re++){const xe=ee[re].name||String(re);this.morphTargetInfluences.push(0),this.morphTargetDictionary[xe]=re}}}}getVertexPosition(_,b){const $=this.geometry,ee=$.attributes.position,re=$.morphAttributes.position,ae=$.morphTargetsRelative;b.fromBufferAttribute(ee,_);const xe=this.morphTargetInfluences;if(re&&xe){_morphA.set(0,0,0);for(let le=0,fe=re.length;le<fe;le++){const ve=xe[le],Se=re[le];ve!==0&&(_tempA.fromBufferAttribute(Se,_),ae?_morphA.addScaledVector(_tempA,ve):_morphA.addScaledVector(_tempA.sub(b),ve))}b.add(_morphA)}return b}raycast(_,b){const $=this.geometry,ee=this.material,re=this.matrixWorld;ee!==void 0&&($.boundingSphere===null&&$.computeBoundingSphere(),_sphere$6.copy($.boundingSphere),_sphere$6.applyMatrix4(re),_ray$3.copy(_.ray).recast(_.near),!(_sphere$6.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$6,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(_.far-_.near)**2))&&(_inverseMatrix$3.copy(re).invert(),_ray$3.copy(_.ray).applyMatrix4(_inverseMatrix$3),!($.boundingBox!==null&&_ray$3.intersectsBox($.boundingBox)===!1)&&this._computeIntersections(_,b,_ray$3)))}_computeIntersections(_,b,$){let ee;const re=this.geometry,ae=this.material,xe=re.index,le=re.attributes.position,fe=re.attributes.uv,ve=re.attributes.uv1,Se=re.attributes.normal,Ee=re.groups,Ce=re.drawRange;if(xe!==null)if(Array.isArray(ae))for(let Ie=0,De=Ee.length;Ie<De;Ie++){const Be=Ee[Ie],Ne=ae[Be.materialIndex],qe=Math.max(Be.start,Ce.start),Xe=Math.min(xe.count,Math.min(Be.start+Be.count,Ce.start+Ce.count));for(let Ye=qe,Qe=Xe;Ye<Qe;Ye+=3){const rt=xe.getX(Ye),ot=xe.getX(Ye+1),ct=xe.getX(Ye+2);ee=checkGeometryIntersection(this,Ne,_,$,fe,ve,Se,rt,ot,ct),ee&&(ee.faceIndex=Math.floor(Ye/3),ee.face.materialIndex=Be.materialIndex,b.push(ee))}}else{const Ie=Math.max(0,Ce.start),De=Math.min(xe.count,Ce.start+Ce.count);for(let Be=Ie,Ne=De;Be<Ne;Be+=3){const qe=xe.getX(Be),Xe=xe.getX(Be+1),Ye=xe.getX(Be+2);ee=checkGeometryIntersection(this,ae,_,$,fe,ve,Se,qe,Xe,Ye),ee&&(ee.faceIndex=Math.floor(Be/3),b.push(ee))}}else if(le!==void 0)if(Array.isArray(ae))for(let Ie=0,De=Ee.length;Ie<De;Ie++){const Be=Ee[Ie],Ne=ae[Be.materialIndex],qe=Math.max(Be.start,Ce.start),Xe=Math.min(le.count,Math.min(Be.start+Be.count,Ce.start+Ce.count));for(let Ye=qe,Qe=Xe;Ye<Qe;Ye+=3){const rt=Ye,ot=Ye+1,ct=Ye+2;ee=checkGeometryIntersection(this,Ne,_,$,fe,ve,Se,rt,ot,ct),ee&&(ee.faceIndex=Math.floor(Ye/3),ee.face.materialIndex=Be.materialIndex,b.push(ee))}}else{const Ie=Math.max(0,Ce.start),De=Math.min(le.count,Ce.start+Ce.count);for(let Be=Ie,Ne=De;Be<Ne;Be+=3){const qe=Be,Xe=Be+1,Ye=Be+2;ee=checkGeometryIntersection(this,ae,_,$,fe,ve,Se,qe,Xe,Ye),ee&&(ee.faceIndex=Math.floor(Be/3),b.push(ee))}}}}function checkIntersection$1(H,_,b,$,ee,re,ae,xe){let le;if(_.side===BackSide?le=$.intersectTriangle(ae,re,ee,!0,xe):le=$.intersectTriangle(ee,re,ae,_.side===FrontSide,xe),le===null)return null;_intersectionPointWorld.copy(xe),_intersectionPointWorld.applyMatrix4(H.matrixWorld);const fe=b.ray.origin.distanceTo(_intersectionPointWorld);return fe<b.near||fe>b.far?null:{distance:fe,point:_intersectionPointWorld.clone(),object:H}}function checkGeometryIntersection(H,_,b,$,ee,re,ae,xe,le,fe){H.getVertexPosition(xe,_vA$1),H.getVertexPosition(le,_vB$1),H.getVertexPosition(fe,_vC$1);const ve=checkIntersection$1(H,_,b,$,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(ve){ee&&(_uvA$1.fromBufferAttribute(ee,xe),_uvB$1.fromBufferAttribute(ee,le),_uvC$1.fromBufferAttribute(ee,fe),ve.uv=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),re&&(_uvA$1.fromBufferAttribute(re,xe),_uvB$1.fromBufferAttribute(re,le),_uvC$1.fromBufferAttribute(re,fe),ve.uv1=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),ae&&(_normalA.fromBufferAttribute(ae,xe),_normalB.fromBufferAttribute(ae,le),_normalC.fromBufferAttribute(ae,fe),ve.normal=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_normalA,_normalB,_normalC,new Vector3),ve.normal.dot($.direction)>0&&ve.normal.multiplyScalar(-1));const Se={a:xe,b:le,c:fe,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,Se.normal),ve.face=Se}return ve}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(_,b){return super.copy(_,b),this.matrixWorldInverse.copy(_.matrixWorldInverse),this.projectionMatrix.copy(_.projectionMatrix),this.projectionMatrixInverse.copy(_.projectionMatrixInverse),this.coordinateSystem=_.coordinateSystem,this}getWorldDirection(_){return super.getWorldDirection(_).negate()}updateMatrixWorld(_){super.updateMatrixWorld(_),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(_,b){super.updateWorldMatrix(_,b),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const _v3$1=new Vector3,_minTarget=new Vector2,_maxTarget=new Vector2;class PerspectiveCamera extends Camera{constructor(_=50,b=1,$=.1,ee=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=_,this.zoom=1,this.near=$,this.far=ee,this.focus=10,this.aspect=b,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(_,b){return super.copy(_,b),this.fov=_.fov,this.zoom=_.zoom,this.near=_.near,this.far=_.far,this.focus=_.focus,this.aspect=_.aspect,this.view=_.view===null?null:Object.assign({},_.view),this.filmGauge=_.filmGauge,this.filmOffset=_.filmOffset,this}setFocalLength(_){const b=.5*this.getFilmHeight()/_;this.fov=RAD2DEG*2*Math.atan(b),this.updateProjectionMatrix()}getFocalLength(){const _=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/_}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(_,b,$){_v3$1.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),b.set(_v3$1.x,_v3$1.y).multiplyScalar(-_/_v3$1.z),_v3$1.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),$.set(_v3$1.x,_v3$1.y).multiplyScalar(-_/_v3$1.z)}getViewSize(_,b){return this.getViewBounds(_,_minTarget,_maxTarget),b.subVectors(_maxTarget,_minTarget)}setViewOffset(_,b,$,ee,re,ae){this.aspect=_/b,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=b,this.view.offsetX=$,this.view.offsetY=ee,this.view.width=re,this.view.height=ae,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=this.near;let b=_*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,$=2*b,ee=this.aspect*$,re=-.5*ee;const ae=this.view;if(this.view!==null&&this.view.enabled){const le=ae.fullWidth,fe=ae.fullHeight;re+=ae.offsetX*ee/le,b-=ae.offsetY*$/fe,ee*=ae.width/le,$*=ae.height/fe}const xe=this.filmOffset;xe!==0&&(re+=_*xe/this.getFilmWidth()),this.projectionMatrix.makePerspective(re,re+ee,b,b-$,_,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const b=super.toJSON(_);return b.object.fov=this.fov,b.object.zoom=this.zoom,b.object.near=this.near,b.object.far=this.far,b.object.focus=this.focus,b.object.aspect=this.aspect,this.view!==null&&(b.object.view=Object.assign({},this.view)),b.object.filmGauge=this.filmGauge,b.object.filmOffset=this.filmOffset,b}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(_=new Vector3(1,0,0),b=0){this.isPlane=!0,this.normal=_,this.constant=b}set(_,b){return this.normal.copy(_),this.constant=b,this}setComponents(_,b,$,ee){return this.normal.set(_,b,$),this.constant=ee,this}setFromNormalAndCoplanarPoint(_,b){return this.normal.copy(_),this.constant=-b.dot(this.normal),this}setFromCoplanarPoints(_,b,$){const ee=_vector1.subVectors($,b).cross(_vector2.subVectors(_,b)).normalize();return this.setFromNormalAndCoplanarPoint(ee,_),this}copy(_){return this.normal.copy(_.normal),this.constant=_.constant,this}normalize(){const _=1/this.normal.length();return this.normal.multiplyScalar(_),this.constant*=_,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(_){return this.normal.dot(_)+this.constant}distanceToSphere(_){return this.distanceToPoint(_.center)-_.radius}projectPoint(_,b){return b.copy(_).addScaledVector(this.normal,-this.distanceToPoint(_))}intersectLine(_,b){const $=_.delta(_vector1),ee=this.normal.dot($);if(ee===0)return this.distanceToPoint(_.start)===0?b.copy(_.start):null;const re=-(_.start.dot(this.normal)+this.constant)/ee;return re<0||re>1?null:b.copy(_.start).addScaledVector($,re)}intersectsLine(_){const b=this.distanceToPoint(_.start),$=this.distanceToPoint(_.end);return b<0&&$>0||$<0&&b>0}intersectsBox(_){return _.intersectsPlane(this)}intersectsSphere(_){return _.intersectsPlane(this)}coplanarPoint(_){return _.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(_,b){const $=b||_normalMatrix.getNormalMatrix(_),ee=this.coplanarPoint(_vector1).applyMatrix4(_),re=this.normal.applyMatrix3($).normalize();return this.constant=-ee.dot(re),this}translate(_){return this.constant-=_.dot(this.normal),this}equals(_){return _.normal.equals(this.normal)&&_.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$5=new Sphere,_vector$7=new Vector3;class Frustum{constructor(_=new Plane,b=new Plane,$=new Plane,ee=new Plane,re=new Plane,ae=new Plane){this.planes=[_,b,$,ee,re,ae]}set(_,b,$,ee,re,ae){const xe=this.planes;return xe[0].copy(_),xe[1].copy(b),xe[2].copy($),xe[3].copy(ee),xe[4].copy(re),xe[5].copy(ae),this}copy(_){const b=this.planes;for(let $=0;$<6;$++)b[$].copy(_.planes[$]);return this}setFromProjectionMatrix(_,b=WebGLCoordinateSystem){const $=this.planes,ee=_.elements,re=ee[0],ae=ee[1],xe=ee[2],le=ee[3],fe=ee[4],ve=ee[5],Se=ee[6],Ee=ee[7],Ce=ee[8],Ie=ee[9],De=ee[10],Be=ee[11],Ne=ee[12],qe=ee[13],Xe=ee[14],Ye=ee[15];if($[0].setComponents(le-re,Ee-fe,Be-Ce,Ye-Ne).normalize(),$[1].setComponents(le+re,Ee+fe,Be+Ce,Ye+Ne).normalize(),$[2].setComponents(le+ae,Ee+ve,Be+Ie,Ye+qe).normalize(),$[3].setComponents(le-ae,Ee-ve,Be-Ie,Ye-qe).normalize(),$[4].setComponents(le-xe,Ee-Se,Be-De,Ye-Xe).normalize(),b===WebGLCoordinateSystem)$[5].setComponents(le+xe,Ee+Se,Be+De,Ye+Xe).normalize();else if(b===WebGPUCoordinateSystem)$[5].setComponents(xe,Se,De,Xe).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+b);return this}intersectsObject(_){if(_.boundingSphere!==void 0)_.boundingSphere===null&&_.computeBoundingSphere(),_sphere$5.copy(_.boundingSphere).applyMatrix4(_.matrixWorld);else{const b=_.geometry;b.boundingSphere===null&&b.computeBoundingSphere(),_sphere$5.copy(b.boundingSphere).applyMatrix4(_.matrixWorld)}return this.intersectsSphere(_sphere$5)}intersectsSprite(_){return _sphere$5.center.set(0,0,0),_sphere$5.radius=.7071067811865476,_sphere$5.applyMatrix4(_.matrixWorld),this.intersectsSphere(_sphere$5)}intersectsSphere(_){const b=this.planes,$=_.center,ee=-_.radius;for(let re=0;re<6;re++)if(b[re].distanceToPoint($)<ee)return!1;return!0}intersectsBox(_){const b=this.planes;for(let $=0;$<6;$++){const ee=b[$];if(_vector$7.x=ee.normal.x>0?_.max.x:_.min.x,_vector$7.y=ee.normal.y>0?_.max.y:_.min.y,_vector$7.z=ee.normal.z>0?_.max.z:_.min.z,ee.distanceToPoint(_vector$7)<0)return!1}return!0}containsPoint(_){const b=this.planes;for(let $=0;$<6;$++)if(b[$].distanceToPoint(_)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class OrthographicCamera extends Camera{constructor(_=-1,b=1,$=1,ee=-1,re=.1,ae=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_,this.right=b,this.top=$,this.bottom=ee,this.near=re,this.far=ae,this.updateProjectionMatrix()}copy(_,b){return super.copy(_,b),this.left=_.left,this.right=_.right,this.top=_.top,this.bottom=_.bottom,this.near=_.near,this.far=_.far,this.zoom=_.zoom,this.view=_.view===null?null:Object.assign({},_.view),this}setViewOffset(_,b,$,ee,re,ae){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=b,this.view.offsetX=$,this.view.offsetY=ee,this.view.width=re,this.view.height=ae,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),$=(this.right+this.left)/2,ee=(this.top+this.bottom)/2;let re=$-_,ae=$+_,xe=ee+b,le=ee-b;if(this.view!==null&&this.view.enabled){const fe=(this.right-this.left)/this.view.fullWidth/this.zoom,ve=(this.top-this.bottom)/this.view.fullHeight/this.zoom;re+=fe*this.view.offsetX,ae=re+fe*this.view.width,xe-=ve*this.view.offsetY,le=xe-ve*this.view.height}this.projectionMatrix.makeOrthographic(re,ae,xe,le,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const b=super.toJSON(_);return b.object.zoom=this.zoom,b.object.left=this.left,b.object.right=this.right,b.object.top=this.top,b.object.bottom=this.bottom,b.object.near=this.near,b.object.far=this.far,this.view!==null&&(b.object.view=Object.assign({},this.view)),b}}class Group extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}}class InterleavedBuffer{constructor(_,b){this.isInterleavedBuffer=!0,this.array=_,this.stride=b,this.count=_!==void 0?_.length/b:0,this.usage=StaticDrawUsage,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=generateUUID()}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}get updateRange(){return warnOnce("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(_){return this.usage=_,this}addUpdateRange(_,b){this.updateRanges.push({start:_,count:b})}clearUpdateRanges(){this.updateRanges.length=0}copy(_){return this.array=new _.array.constructor(_.array),this.count=_.count,this.stride=_.stride,this.usage=_.usage,this}copyAt(_,b,$){_*=this.stride,$*=b.stride;for(let ee=0,re=this.stride;ee<re;ee++)this.array[_+ee]=b.array[$+ee];return this}set(_,b=0){return this.array.set(_,b),this}clone(_){_.arrayBuffers===void 0&&(_.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),_.arrayBuffers[this.array.buffer._uuid]===void 0&&(_.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const b=new this.array.constructor(_.arrayBuffers[this.array.buffer._uuid]),$=new this.constructor(b,this.stride);return $.setUsage(this.usage),$}onUpload(_){return this.onUploadCallback=_,this}toJSON(_){return _.arrayBuffers===void 0&&(_.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),_.arrayBuffers[this.array.buffer._uuid]===void 0&&(_.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _vector$6=new Vector3;class InterleavedBufferAttribute{constructor(_,b,$,ee=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=_,this.itemSize=b,this.offset=$,this.normalized=ee}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(_){this.data.needsUpdate=_}applyMatrix4(_){for(let b=0,$=this.data.count;b<$;b++)_vector$6.fromBufferAttribute(this,b),_vector$6.applyMatrix4(_),this.setXYZ(b,_vector$6.x,_vector$6.y,_vector$6.z);return this}applyNormalMatrix(_){for(let b=0,$=this.count;b<$;b++)_vector$6.fromBufferAttribute(this,b),_vector$6.applyNormalMatrix(_),this.setXYZ(b,_vector$6.x,_vector$6.y,_vector$6.z);return this}transformDirection(_){for(let b=0,$=this.count;b<$;b++)_vector$6.fromBufferAttribute(this,b),_vector$6.transformDirection(_),this.setXYZ(b,_vector$6.x,_vector$6.y,_vector$6.z);return this}getComponent(_,b){let $=this.array[_*this.data.stride+this.offset+b];return this.normalized&&($=denormalize($,this.array)),$}setComponent(_,b,$){return this.normalized&&($=normalize($,this.array)),this.data.array[_*this.data.stride+this.offset+b]=$,this}setX(_,b){return this.normalized&&(b=normalize(b,this.array)),this.data.array[_*this.data.stride+this.offset]=b,this}setY(_,b){return this.normalized&&(b=normalize(b,this.array)),this.data.array[_*this.data.stride+this.offset+1]=b,this}setZ(_,b){return this.normalized&&(b=normalize(b,this.array)),this.data.array[_*this.data.stride+this.offset+2]=b,this}setW(_,b){return this.normalized&&(b=normalize(b,this.array)),this.data.array[_*this.data.stride+this.offset+3]=b,this}getX(_){let b=this.data.array[_*this.data.stride+this.offset];return this.normalized&&(b=denormalize(b,this.array)),b}getY(_){let b=this.data.array[_*this.data.stride+this.offset+1];return this.normalized&&(b=denormalize(b,this.array)),b}getZ(_){let b=this.data.array[_*this.data.stride+this.offset+2];return this.normalized&&(b=denormalize(b,this.array)),b}getW(_){let b=this.data.array[_*this.data.stride+this.offset+3];return this.normalized&&(b=denormalize(b,this.array)),b}setXY(_,b,$){return _=_*this.data.stride+this.offset,this.normalized&&(b=normalize(b,this.array),$=normalize($,this.array)),this.data.array[_+0]=b,this.data.array[_+1]=$,this}setXYZ(_,b,$,ee){return _=_*this.data.stride+this.offset,this.normalized&&(b=normalize(b,this.array),$=normalize($,this.array),ee=normalize(ee,this.array)),this.data.array[_+0]=b,this.data.array[_+1]=$,this.data.array[_+2]=ee,this}setXYZW(_,b,$,ee,re){return _=_*this.data.stride+this.offset,this.normalized&&(b=normalize(b,this.array),$=normalize($,this.array),ee=normalize(ee,this.array),re=normalize(re,this.array)),this.data.array[_+0]=b,this.data.array[_+1]=$,this.data.array[_+2]=ee,this.data.array[_+3]=re,this}clone(_){if(_===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const b=[];for(let $=0;$<this.count;$++){const ee=$*this.data.stride+this.offset;for(let re=0;re<this.itemSize;re++)b.push(this.data.array[ee+re])}return new BufferAttribute(new this.array.constructor(b),this.itemSize,this.normalized)}else return _.interleavedBuffers===void 0&&(_.interleavedBuffers={}),_.interleavedBuffers[this.data.uuid]===void 0&&(_.interleavedBuffers[this.data.uuid]=this.data.clone(_)),new InterleavedBufferAttribute(_.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(_){if(_===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const b=[];for(let $=0;$<this.count;$++){const ee=$*this.data.stride+this.offset;for(let re=0;re<this.itemSize;re++)b.push(this.data.array[ee+re])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:b,normalized:this.normalized}}else return _.interleavedBuffers===void 0&&(_.interleavedBuffers={}),_.interleavedBuffers[this.data.uuid]===void 0&&(_.interleavedBuffers[this.data.uuid]=this.data.toJSON(_)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const _basePosition=new Vector3,_skinIndex=new Vector4,_skinWeight=new Vector4,_vector3=new Vector3,_matrix4=new Matrix4,_vertex=new Vector3,_sphere$4=new Sphere,_inverseMatrix$2=new Matrix4,_ray$2=new Ray;class SkinnedMesh extends Mesh{constructor(_,b){super(_,b),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=AttachedBindMode,this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const _=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.makeEmpty();const b=_.getAttribute("position");for(let $=0;$<b.count;$++)this.getVertexPosition($,_vertex),this.boundingBox.expandByPoint(_vertex)}computeBoundingSphere(){const _=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingSphere.makeEmpty();const b=_.getAttribute("position");for(let $=0;$<b.count;$++)this.getVertexPosition($,_vertex),this.boundingSphere.expandByPoint(_vertex)}copy(_,b){return super.copy(_,b),this.bindMode=_.bindMode,this.bindMatrix.copy(_.bindMatrix),this.bindMatrixInverse.copy(_.bindMatrixInverse),this.skeleton=_.skeleton,_.boundingBox!==null&&(this.boundingBox=_.boundingBox.clone()),_.boundingSphere!==null&&(this.boundingSphere=_.boundingSphere.clone()),this}raycast(_,b){const $=this.material,ee=this.matrixWorld;$!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$4.copy(this.boundingSphere),_sphere$4.applyMatrix4(ee),_.ray.intersectsSphere(_sphere$4)!==!1&&(_inverseMatrix$2.copy(ee).invert(),_ray$2.copy(_.ray).applyMatrix4(_inverseMatrix$2),!(this.boundingBox!==null&&_ray$2.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(_,b,_ray$2)))}getVertexPosition(_,b){return super.getVertexPosition(_,b),this.applyBoneTransform(_,b),b}bind(_,b){this.skeleton=_,b===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),b=this.matrixWorld),this.bindMatrix.copy(b),this.bindMatrixInverse.copy(b).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const _=new Vector4,b=this.geometry.attributes.skinWeight;for(let $=0,ee=b.count;$<ee;$++){_.fromBufferAttribute(b,$);const re=1/_.manhattanLength();re!==1/0?_.multiplyScalar(re):_.set(1,0,0,0),b.setXYZW($,_.x,_.y,_.z,_.w)}}updateMatrixWorld(_){super.updateMatrixWorld(_),this.bindMode===AttachedBindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===DetachedBindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(_,b){const $=this.skeleton,ee=this.geometry;_skinIndex.fromBufferAttribute(ee.attributes.skinIndex,_),_skinWeight.fromBufferAttribute(ee.attributes.skinWeight,_),_basePosition.copy(b).applyMatrix4(this.bindMatrix),b.set(0,0,0);for(let re=0;re<4;re++){const ae=_skinWeight.getComponent(re);if(ae!==0){const xe=_skinIndex.getComponent(re);_matrix4.multiplyMatrices($.bones[xe].matrixWorld,$.boneInverses[xe]),b.addScaledVector(_vector3.copy(_basePosition).applyMatrix4(_matrix4),ae)}}return b.applyMatrix4(this.bindMatrixInverse)}}class Bone extends Object3D{constructor(){super(),this.isBone=!0,this.type="Bone"}}class DataTexture extends Texture{constructor(_=null,b=1,$=1,ee,re,ae,xe,le,fe=NearestFilter,ve=NearestFilter,Se,Ee){super(null,ae,xe,le,fe,ve,ee,re,Se,Ee),this.isDataTexture=!0,this.image={data:_,width:b,height:$},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _offsetMatrix=new Matrix4,_identityMatrix$1=new Matrix4;class Skeleton{constructor(_=[],b=[]){this.uuid=generateUUID(),this.bones=_.slice(0),this.boneInverses=b,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const _=this.bones,b=this.boneInverses;if(this.boneMatrices=new Float32Array(_.length*16),b.length===0)this.calculateInverses();else if(_.length!==b.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let $=0,ee=this.bones.length;$<ee;$++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let _=0,b=this.bones.length;_<b;_++){const $=new Matrix4;this.bones[_]&&$.copy(this.bones[_].matrixWorld).invert(),this.boneInverses.push($)}}pose(){for(let _=0,b=this.bones.length;_<b;_++){const $=this.bones[_];$&&$.matrixWorld.copy(this.boneInverses[_]).invert()}for(let _=0,b=this.bones.length;_<b;_++){const $=this.bones[_];$&&($.parent&&$.parent.isBone?($.matrix.copy($.parent.matrixWorld).invert(),$.matrix.multiply($.matrixWorld)):$.matrix.copy($.matrixWorld),$.matrix.decompose($.position,$.quaternion,$.scale))}}update(){const _=this.bones,b=this.boneInverses,$=this.boneMatrices,ee=this.boneTexture;for(let re=0,ae=_.length;re<ae;re++){const xe=_[re]?_[re].matrixWorld:_identityMatrix$1;_offsetMatrix.multiplyMatrices(xe,b[re]),_offsetMatrix.toArray($,re*16)}ee!==null&&(ee.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let _=Math.sqrt(this.bones.length*4);_=Math.ceil(_/4)*4,_=Math.max(_,4);const b=new Float32Array(_*_*4);b.set(this.boneMatrices);const $=new DataTexture(b,_,_,RGBAFormat,FloatType);return $.needsUpdate=!0,this.boneMatrices=b,this.boneTexture=$,this}getBoneByName(_){for(let b=0,$=this.bones.length;b<$;b++){const ee=this.bones[b];if(ee.name===_)return ee}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(_,b){this.uuid=_.uuid;for(let $=0,ee=_.bones.length;$<ee;$++){const re=_.bones[$];let ae=b[re];ae===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",re),ae=new Bone),this.bones.push(ae),this.boneInverses.push(new Matrix4().fromArray(_.boneInverses[$]))}return this.init(),this}toJSON(){const _={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};_.uuid=this.uuid;const b=this.bones,$=this.boneInverses;for(let ee=0,re=b.length;ee<re;ee++){const ae=b[ee];_.bones.push(ae.uuid);const xe=$[ee];_.boneInverses.push(xe.toArray())}return _}}class InstancedBufferAttribute extends BufferAttribute{constructor(_,b,$,ee=1){super(_,b,$),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=ee}copy(_){return super.copy(_),this.meshPerAttribute=_.meshPerAttribute,this}toJSON(){const _=super.toJSON();return _.meshPerAttribute=this.meshPerAttribute,_.isInstancedBufferAttribute=!0,_}}const _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_box3=new Box3,_identity=new Matrix4,_mesh$1=new Mesh,_sphere$3=new Sphere;class InstancedMesh extends Mesh{constructor(_,b,$){super(_,b),this.isInstancedMesh=!0,this.instanceMatrix=new InstancedBufferAttribute(new Float32Array($*16),16),this.instanceColor=null,this.morphTexture=null,this.count=$,this.boundingBox=null,this.boundingSphere=null;for(let ee=0;ee<$;ee++)this.setMatrixAt(ee,_identity)}computeBoundingBox(){const _=this.geometry,b=this.count;this.boundingBox===null&&(this.boundingBox=new Box3),_.boundingBox===null&&_.computeBoundingBox(),this.boundingBox.makeEmpty();for(let $=0;$<b;$++)this.getMatrixAt($,_instanceLocalMatrix),_box3.copy(_.boundingBox).applyMatrix4(_instanceLocalMatrix),this.boundingBox.union(_box3)}computeBoundingSphere(){const _=this.geometry,b=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sphere),_.boundingSphere===null&&_.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let $=0;$<b;$++)this.getMatrixAt($,_instanceLocalMatrix),_sphere$3.copy(_.boundingSphere).applyMatrix4(_instanceLocalMatrix),this.boundingSphere.union(_sphere$3)}copy(_,b){return super.copy(_,b),this.instanceMatrix.copy(_.instanceMatrix),_.morphTexture!==null&&(this.morphTexture=_.morphTexture.clone()),_.instanceColor!==null&&(this.instanceColor=_.instanceColor.clone()),this.count=_.count,_.boundingBox!==null&&(this.boundingBox=_.boundingBox.clone()),_.boundingSphere!==null&&(this.boundingSphere=_.boundingSphere.clone()),this}getColorAt(_,b){b.fromArray(this.instanceColor.array,_*3)}getMatrixAt(_,b){b.fromArray(this.instanceMatrix.array,_*16)}getMorphAt(_,b){const $=b.morphTargetInfluences,ee=this.morphTexture.source.data.data,re=$.length+1,ae=_*re+1;for(let xe=0;xe<$.length;xe++)$[xe]=ee[ae+xe]}raycast(_,b){const $=this.matrixWorld,ee=this.count;if(_mesh$1.geometry=this.geometry,_mesh$1.material=this.material,_mesh$1.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$3.copy(this.boundingSphere),_sphere$3.applyMatrix4($),_.ray.intersectsSphere(_sphere$3)!==!1))for(let re=0;re<ee;re++){this.getMatrixAt(re,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices($,_instanceLocalMatrix),_mesh$1.matrixWorld=_instanceWorldMatrix,_mesh$1.raycast(_,_instanceIntersects);for(let ae=0,xe=_instanceIntersects.length;ae<xe;ae++){const le=_instanceIntersects[ae];le.instanceId=re,le.object=this,b.push(le)}_instanceIntersects.length=0}}setColorAt(_,b){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),b.toArray(this.instanceColor.array,_*3)}setMatrixAt(_,b){b.toArray(this.instanceMatrix.array,_*16)}setMorphAt(_,b){const $=b.morphTargetInfluences,ee=$.length+1;this.morphTexture===null&&(this.morphTexture=new DataTexture(new Float32Array(ee*this.count),ee,this.count,RedFormat,FloatType));const re=this.morphTexture.source.data.data;let ae=0;for(let fe=0;fe<$.length;fe++)ae+=$[fe];const xe=this.geometry.morphTargetsRelative?1:1-ae,le=ee*_;re[le]=xe,re.set($,le+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}class LineBasicMaterial extends Material{constructor(_){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.linewidth=_.linewidth,this.linecap=_.linecap,this.linejoin=_.linejoin,this.fog=_.fog,this}}const _vStart=new Vector3,_vEnd=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1=new Ray,_sphere$1=new Sphere,_intersectPointOnRay=new Vector3,_intersectPointOnSegment=new Vector3;class Line extends Object3D{constructor(_=new BufferGeometry,b=new LineBasicMaterial){super(),this.isLine=!0,this.type="Line",this.geometry=_,this.material=b,this.updateMorphTargets()}copy(_,b){return super.copy(_,b),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}computeLineDistances(){const _=this.geometry;if(_.index===null){const b=_.attributes.position,$=[0];for(let ee=1,re=b.count;ee<re;ee++)_vStart.fromBufferAttribute(b,ee-1),_vEnd.fromBufferAttribute(b,ee),$[ee]=$[ee-1],$[ee]+=_vStart.distanceTo(_vEnd);_.setAttribute("lineDistance",new Float32BufferAttribute($,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(_,b){const $=this.geometry,ee=this.matrixWorld,re=_.params.Line.threshold,ae=$.drawRange;if($.boundingSphere===null&&$.computeBoundingSphere(),_sphere$1.copy($.boundingSphere),_sphere$1.applyMatrix4(ee),_sphere$1.radius+=re,_.ray.intersectsSphere(_sphere$1)===!1)return;_inverseMatrix$1.copy(ee).invert(),_ray$1.copy(_.ray).applyMatrix4(_inverseMatrix$1);const xe=re/((this.scale.x+this.scale.y+this.scale.z)/3),le=xe*xe,fe=this.isLineSegments?2:1,ve=$.index,Ee=$.attributes.position;if(ve!==null){const Ce=Math.max(0,ae.start),Ie=Math.min(ve.count,ae.start+ae.count);for(let De=Ce,Be=Ie-1;De<Be;De+=fe){const Ne=ve.getX(De),qe=ve.getX(De+1),Xe=checkIntersection(this,_,_ray$1,le,Ne,qe);Xe&&b.push(Xe)}if(this.isLineLoop){const De=ve.getX(Ie-1),Be=ve.getX(Ce),Ne=checkIntersection(this,_,_ray$1,le,De,Be);Ne&&b.push(Ne)}}else{const Ce=Math.max(0,ae.start),Ie=Math.min(Ee.count,ae.start+ae.count);for(let De=Ce,Be=Ie-1;De<Be;De+=fe){const Ne=checkIntersection(this,_,_ray$1,le,De,De+1);Ne&&b.push(Ne)}if(this.isLineLoop){const De=checkIntersection(this,_,_ray$1,le,Ie-1,Ce);De&&b.push(De)}}}updateMorphTargets(){const b=this.geometry.morphAttributes,$=Object.keys(b);if($.length>0){const ee=b[$[0]];if(ee!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let re=0,ae=ee.length;re<ae;re++){const xe=ee[re].name||String(re);this.morphTargetInfluences.push(0),this.morphTargetDictionary[xe]=re}}}}}function checkIntersection(H,_,b,$,ee,re){const ae=H.geometry.attributes.position;if(_vStart.fromBufferAttribute(ae,ee),_vEnd.fromBufferAttribute(ae,re),b.distanceSqToSegment(_vStart,_vEnd,_intersectPointOnRay,_intersectPointOnSegment)>$)return;_intersectPointOnRay.applyMatrix4(H.matrixWorld);const le=_.ray.origin.distanceTo(_intersectPointOnRay);if(!(le<_.near||le>_.far))return{distance:le,point:_intersectPointOnSegment.clone().applyMatrix4(H.matrixWorld),index:ee,face:null,faceIndex:null,object:H}}const _start=new Vector3,_end=new Vector3;class LineSegments extends Line{constructor(_,b){super(_,b),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const _=this.geometry;if(_.index===null){const b=_.attributes.position,$=[];for(let ee=0,re=b.count;ee<re;ee+=2)_start.fromBufferAttribute(b,ee),_end.fromBufferAttribute(b,ee+1),$[ee]=ee===0?0:$[ee-1],$[ee+1]=$[ee]+_start.distanceTo(_end);_.setAttribute("lineDistance",new Float32BufferAttribute($,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line{constructor(_,b){super(_,b),this.isLineLoop=!0,this.type="LineLoop"}}class PointsMaterial extends Material{constructor(_){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.alphaMap=_.alphaMap,this.size=_.size,this.sizeAttenuation=_.sizeAttenuation,this.fog=_.fog,this}}const _inverseMatrix=new Matrix4,_ray=new Ray,_sphere=new Sphere,_position$2=new Vector3;class Points extends Object3D{constructor(_=new BufferGeometry,b=new PointsMaterial){super(),this.isPoints=!0,this.type="Points",this.geometry=_,this.material=b,this.updateMorphTargets()}copy(_,b){return super.copy(_,b),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}raycast(_,b){const $=this.geometry,ee=this.matrixWorld,re=_.params.Points.threshold,ae=$.drawRange;if($.boundingSphere===null&&$.computeBoundingSphere(),_sphere.copy($.boundingSphere),_sphere.applyMatrix4(ee),_sphere.radius+=re,_.ray.intersectsSphere(_sphere)===!1)return;_inverseMatrix.copy(ee).invert(),_ray.copy(_.ray).applyMatrix4(_inverseMatrix);const xe=re/((this.scale.x+this.scale.y+this.scale.z)/3),le=xe*xe,fe=$.index,Se=$.attributes.position;if(fe!==null){const Ee=Math.max(0,ae.start),Ce=Math.min(fe.count,ae.start+ae.count);for(let Ie=Ee,De=Ce;Ie<De;Ie++){const Be=fe.getX(Ie);_position$2.fromBufferAttribute(Se,Be),testPoint(_position$2,Be,le,ee,_,b,this)}}else{const Ee=Math.max(0,ae.start),Ce=Math.min(Se.count,ae.start+ae.count);for(let Ie=Ee,De=Ce;Ie<De;Ie++)_position$2.fromBufferAttribute(Se,Ie),testPoint(_position$2,Ie,le,ee,_,b,this)}}updateMorphTargets(){const b=this.geometry.morphAttributes,$=Object.keys(b);if($.length>0){const ee=b[$[0]];if(ee!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let re=0,ae=ee.length;re<ae;re++){const xe=ee[re].name||String(re);this.morphTargetInfluences.push(0),this.morphTargetDictionary[xe]=re}}}}}function testPoint(H,_,b,$,ee,re,ae){const xe=_ray.distanceSqToPoint(H);if(xe<b){const le=new Vector3;_ray.closestPointToPoint(H,le),le.applyMatrix4($);const fe=ee.ray.origin.distanceTo(le);if(fe<ee.near||fe>ee.far)return;re.push({distance:fe,distanceToRay:Math.sqrt(xe),point:le,index:_,face:null,object:ae})}}class MeshStandardMaterial extends Material{constructor(_){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.defines={STANDARD:""},this.color.copy(_.color),this.roughness=_.roughness,this.metalness=_.metalness,this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.roughnessMap=_.roughnessMap,this.metalnessMap=_.metalnessMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.envMapIntensity=_.envMapIntensity,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(_){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(b){this.ior=(1+.4*b)/(1-.4*b)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(_)}get anisotropy(){return this._anisotropy}set anisotropy(_){this._anisotropy>0!=_>0&&this.version++,this._anisotropy=_}get clearcoat(){return this._clearcoat}set clearcoat(_){this._clearcoat>0!=_>0&&this.version++,this._clearcoat=_}get iridescence(){return this._iridescence}set iridescence(_){this._iridescence>0!=_>0&&this.version++,this._iridescence=_}get dispersion(){return this._dispersion}set dispersion(_){this._dispersion>0!=_>0&&this.version++,this._dispersion=_}get sheen(){return this._sheen}set sheen(_){this._sheen>0!=_>0&&this.version++,this._sheen=_}get transmission(){return this._transmission}set transmission(_){this._transmission>0!=_>0&&this.version++,this._transmission=_}copy(_){return super.copy(_),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=_.anisotropy,this.anisotropyRotation=_.anisotropyRotation,this.anisotropyMap=_.anisotropyMap,this.clearcoat=_.clearcoat,this.clearcoatMap=_.clearcoatMap,this.clearcoatRoughness=_.clearcoatRoughness,this.clearcoatRoughnessMap=_.clearcoatRoughnessMap,this.clearcoatNormalMap=_.clearcoatNormalMap,this.clearcoatNormalScale.copy(_.clearcoatNormalScale),this.dispersion=_.dispersion,this.ior=_.ior,this.iridescence=_.iridescence,this.iridescenceMap=_.iridescenceMap,this.iridescenceIOR=_.iridescenceIOR,this.iridescenceThicknessRange=[..._.iridescenceThicknessRange],this.iridescenceThicknessMap=_.iridescenceThicknessMap,this.sheen=_.sheen,this.sheenColor.copy(_.sheenColor),this.sheenColorMap=_.sheenColorMap,this.sheenRoughness=_.sheenRoughness,this.sheenRoughnessMap=_.sheenRoughnessMap,this.transmission=_.transmission,this.transmissionMap=_.transmissionMap,this.thickness=_.thickness,this.thicknessMap=_.thicknessMap,this.attenuationDistance=_.attenuationDistance,this.attenuationColor.copy(_.attenuationColor),this.specularIntensity=_.specularIntensity,this.specularIntensityMap=_.specularIntensityMap,this.specularColor.copy(_.specularColor),this.specularColorMap=_.specularColorMap,this}}function convertArray(H,_,b){return!H||!b&&H.constructor===_?H:typeof _.BYTES_PER_ELEMENT=="number"?new _(H):Array.prototype.slice.call(H)}function isTypedArray(H){return ArrayBuffer.isView(H)&&!(H instanceof DataView)}function getKeyframeOrder(H){function _(ee,re){return H[ee]-H[re]}const b=H.length,$=new Array(b);for(let ee=0;ee!==b;++ee)$[ee]=ee;return $.sort(_),$}function sortedArray(H,_,b){const $=H.length,ee=new H.constructor($);for(let re=0,ae=0;ae!==$;++re){const xe=b[re]*_;for(let le=0;le!==_;++le)ee[ae++]=H[xe+le]}return ee}function flattenJSON(H,_,b,$){let ee=1,re=H[0];for(;re!==void 0&&re[$]===void 0;)re=H[ee++];if(re===void 0)return;let ae=re[$];if(ae!==void 0)if(Array.isArray(ae))do ae=re[$],ae!==void 0&&(_.push(re.time),b.push.apply(b,ae)),re=H[ee++];while(re!==void 0);else if(ae.toArray!==void 0)do ae=re[$],ae!==void 0&&(_.push(re.time),ae.toArray(b,b.length)),re=H[ee++];while(re!==void 0);else do ae=re[$],ae!==void 0&&(_.push(re.time),b.push(ae)),re=H[ee++];while(re!==void 0)}class Interpolant{constructor(_,b,$,ee){this.parameterPositions=_,this._cachedIndex=0,this.resultBuffer=ee!==void 0?ee:new b.constructor($),this.sampleValues=b,this.valueSize=$,this.settings=null,this.DefaultSettings_={}}evaluate(_){const b=this.parameterPositions;let $=this._cachedIndex,ee=b[$],re=b[$-1];e:{t:{let ae;n:{r:if(!(_<ee)){for(let xe=$+2;;){if(ee===void 0){if(_<re)break r;return $=b.length,this._cachedIndex=$,this.copySampleValue_($-1)}if($===xe)break;if(re=ee,ee=b[++$],_<ee)break t}ae=b.length;break n}if(!(_>=re)){const xe=b[1];_<xe&&($=2,re=xe);for(let le=$-2;;){if(re===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if($===le)break;if(ee=re,re=b[--$-1],_>=re)break t}ae=$,$=0;break n}break e}for(;$<ae;){const xe=$+ae>>>1;_<b[xe]?ae=xe:$=xe+1}if(ee=b[$],re=b[$-1],re===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(ee===void 0)return $=b.length,this._cachedIndex=$,this.copySampleValue_($-1)}this._cachedIndex=$,this.intervalChanged_($,re,ee)}return this.interpolate_($,re,_,ee)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(_){const b=this.resultBuffer,$=this.sampleValues,ee=this.valueSize,re=_*ee;for(let ae=0;ae!==ee;++ae)b[ae]=$[re+ae];return b}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(_,b,$,ee){super(_,b,$,ee),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(_,b,$){const ee=this.parameterPositions;let re=_-2,ae=_+1,xe=ee[re],le=ee[ae];if(xe===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:re=_,xe=2*b-$;break;case WrapAroundEnding:re=ee.length-2,xe=b+ee[re]-ee[re+1];break;default:re=_,xe=$}if(le===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:ae=_,le=2*$-b;break;case WrapAroundEnding:ae=1,le=$+ee[1]-ee[0];break;default:ae=_-1,le=b}const fe=($-b)*.5,ve=this.valueSize;this._weightPrev=fe/(b-xe),this._weightNext=fe/(le-$),this._offsetPrev=re*ve,this._offsetNext=ae*ve}interpolate_(_,b,$,ee){const re=this.resultBuffer,ae=this.sampleValues,xe=this.valueSize,le=_*xe,fe=le-xe,ve=this._offsetPrev,Se=this._offsetNext,Ee=this._weightPrev,Ce=this._weightNext,Ie=($-b)/(ee-b),De=Ie*Ie,Be=De*Ie,Ne=-Ee*Be+2*Ee*De-Ee*Ie,qe=(1+Ee)*Be+(-1.5-2*Ee)*De+(-.5+Ee)*Ie+1,Xe=(-1-Ce)*Be+(1.5+Ce)*De+.5*Ie,Ye=Ce*Be-Ce*De;for(let Qe=0;Qe!==xe;++Qe)re[Qe]=Ne*ae[ve+Qe]+qe*ae[fe+Qe]+Xe*ae[le+Qe]+Ye*ae[Se+Qe];return re}}class LinearInterpolant extends Interpolant{constructor(_,b,$,ee){super(_,b,$,ee)}interpolate_(_,b,$,ee){const re=this.resultBuffer,ae=this.sampleValues,xe=this.valueSize,le=_*xe,fe=le-xe,ve=($-b)/(ee-b),Se=1-ve;for(let Ee=0;Ee!==xe;++Ee)re[Ee]=ae[fe+Ee]*Se+ae[le+Ee]*ve;return re}}class DiscreteInterpolant extends Interpolant{constructor(_,b,$,ee){super(_,b,$,ee)}interpolate_(_){return this.copySampleValue_(_-1)}}class KeyframeTrack{constructor(_,b,$,ee){if(_===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(b===void 0||b.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+_);this.name=_,this.times=convertArray(b,this.TimeBufferType),this.values=convertArray($,this.ValueBufferType),this.setInterpolation(ee||this.DefaultInterpolation)}static toJSON(_){const b=_.constructor;let $;if(b.toJSON!==this.toJSON)$=b.toJSON(_);else{$={name:_.name,times:convertArray(_.times,Array),values:convertArray(_.values,Array)};const ee=_.getInterpolation();ee!==_.DefaultInterpolation&&($.interpolation=ee)}return $.type=_.ValueTypeName,$}InterpolantFactoryMethodDiscrete(_){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),_)}InterpolantFactoryMethodLinear(_){return new LinearInterpolant(this.times,this.values,this.getValueSize(),_)}InterpolantFactoryMethodSmooth(_){return new CubicInterpolant(this.times,this.values,this.getValueSize(),_)}setInterpolation(_){let b;switch(_){case InterpolateDiscrete:b=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:b=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:b=this.InterpolantFactoryMethodSmooth;break}if(b===void 0){const $="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(_!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error($);return console.warn("THREE.KeyframeTrack:",$),this}return this.createInterpolant=b,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(_){if(_!==0){const b=this.times;for(let $=0,ee=b.length;$!==ee;++$)b[$]+=_}return this}scale(_){if(_!==1){const b=this.times;for(let $=0,ee=b.length;$!==ee;++$)b[$]*=_}return this}trim(_,b){const $=this.times,ee=$.length;let re=0,ae=ee-1;for(;re!==ee&&$[re]<_;)++re;for(;ae!==-1&&$[ae]>b;)--ae;if(++ae,re!==0||ae!==ee){re>=ae&&(ae=Math.max(ae,1),re=ae-1);const xe=this.getValueSize();this.times=$.slice(re,ae),this.values=this.values.slice(re*xe,ae*xe)}return this}validate(){let _=!0;const b=this.getValueSize();b-Math.floor(b)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),_=!1);const $=this.times,ee=this.values,re=$.length;re===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),_=!1);let ae=null;for(let xe=0;xe!==re;xe++){const le=$[xe];if(typeof le=="number"&&isNaN(le)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,xe,le),_=!1;break}if(ae!==null&&ae>le){console.error("THREE.KeyframeTrack: Out of order keys.",this,xe,le,ae),_=!1;break}ae=le}if(ee!==void 0&&isTypedArray(ee))for(let xe=0,le=ee.length;xe!==le;++xe){const fe=ee[xe];if(isNaN(fe)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,xe,fe),_=!1;break}}return _}optimize(){const _=this.times.slice(),b=this.values.slice(),$=this.getValueSize(),ee=this.getInterpolation()===InterpolateSmooth,re=_.length-1;let ae=1;for(let xe=1;xe<re;++xe){let le=!1;const fe=_[xe],ve=_[xe+1];if(fe!==ve&&(xe!==1||fe!==_[0]))if(ee)le=!0;else{const Se=xe*$,Ee=Se-$,Ce=Se+$;for(let Ie=0;Ie!==$;++Ie){const De=b[Se+Ie];if(De!==b[Ee+Ie]||De!==b[Ce+Ie]){le=!0;break}}}if(le){if(xe!==ae){_[ae]=_[xe];const Se=xe*$,Ee=ae*$;for(let Ce=0;Ce!==$;++Ce)b[Ee+Ce]=b[Se+Ce]}++ae}}if(re>0){_[ae]=_[re];for(let xe=re*$,le=ae*$,fe=0;fe!==$;++fe)b[le+fe]=b[xe+fe];++ae}return ae!==_.length?(this.times=_.slice(0,ae),this.values=b.slice(0,ae*$)):(this.times=_,this.values=b),this}clone(){const _=this.times.slice(),b=this.values.slice(),$=this.constructor,ee=new $(this.name,_,b);return ee.createInterpolant=this.createInterpolant,ee}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{constructor(_,b,$){super(_,b,$)}}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(_,b,$,ee){super(_,b,$,ee)}interpolate_(_,b,$,ee){const re=this.resultBuffer,ae=this.sampleValues,xe=this.valueSize,le=($-b)/(ee-b);let fe=_*xe;for(let ve=fe+xe;fe!==ve;fe+=4)Quaternion.slerpFlat(re,0,ae,fe-xe,ae,fe,le);return re}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(_){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),_)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{constructor(_,b,$){super(_,b,$)}}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(_="",b=-1,$=[],ee=NormalAnimationBlendMode){this.name=_,this.tracks=$,this.duration=b,this.blendMode=ee,this.uuid=generateUUID(),this.duration<0&&this.resetDuration()}static parse(_){const b=[],$=_.tracks,ee=1/(_.fps||1);for(let ae=0,xe=$.length;ae!==xe;++ae)b.push(parseKeyframeTrack($[ae]).scale(ee));const re=new this(_.name,_.duration,b,_.blendMode);return re.uuid=_.uuid,re}static toJSON(_){const b=[],$=_.tracks,ee={name:_.name,duration:_.duration,tracks:b,uuid:_.uuid,blendMode:_.blendMode};for(let re=0,ae=$.length;re!==ae;++re)b.push(KeyframeTrack.toJSON($[re]));return ee}static CreateFromMorphTargetSequence(_,b,$,ee){const re=b.length,ae=[];for(let xe=0;xe<re;xe++){let le=[],fe=[];le.push((xe+re-1)%re,xe,(xe+1)%re),fe.push(0,1,0);const ve=getKeyframeOrder(le);le=sortedArray(le,1,ve),fe=sortedArray(fe,1,ve),!ee&&le[0]===0&&(le.push(re),fe.push(fe[0])),ae.push(new NumberKeyframeTrack(".morphTargetInfluences["+b[xe].name+"]",le,fe).scale(1/$))}return new this(_,-1,ae)}static findByName(_,b){let $=_;if(!Array.isArray(_)){const ee=_;$=ee.geometry&&ee.geometry.animations||ee.animations}for(let ee=0;ee<$.length;ee++)if($[ee].name===b)return $[ee];return null}static CreateClipsFromMorphTargetSequences(_,b,$){const ee={},re=/^([\w-]*?)([\d]+)$/;for(let xe=0,le=_.length;xe<le;xe++){const fe=_[xe],ve=fe.name.match(re);if(ve&&ve.length>1){const Se=ve[1];let Ee=ee[Se];Ee||(ee[Se]=Ee=[]),Ee.push(fe)}}const ae=[];for(const xe in ee)ae.push(this.CreateFromMorphTargetSequence(xe,ee[xe],b,$));return ae}static parseAnimation(_,b){if(!_)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const $=function(Se,Ee,Ce,Ie,De){if(Ce.length!==0){const Be=[],Ne=[];flattenJSON(Ce,Be,Ne,Ie),Be.length!==0&&De.push(new Se(Ee,Be,Ne))}},ee=[],re=_.name||"default",ae=_.fps||30,xe=_.blendMode;let le=_.length||-1;const fe=_.hierarchy||[];for(let Se=0;Se<fe.length;Se++){const Ee=fe[Se].keys;if(!(!Ee||Ee.length===0))if(Ee[0].morphTargets){const Ce={};let Ie;for(Ie=0;Ie<Ee.length;Ie++)if(Ee[Ie].morphTargets)for(let De=0;De<Ee[Ie].morphTargets.length;De++)Ce[Ee[Ie].morphTargets[De]]=-1;for(const De in Ce){const Be=[],Ne=[];for(let qe=0;qe!==Ee[Ie].morphTargets.length;++qe){const Xe=Ee[Ie];Be.push(Xe.time),Ne.push(Xe.morphTarget===De?1:0)}ee.push(new NumberKeyframeTrack(".morphTargetInfluence["+De+"]",Be,Ne))}le=Ce.length*ae}else{const Ce=".bones["+b[Se].name+"]";$(VectorKeyframeTrack,Ce+".position",Ee,"pos",ee),$(QuaternionKeyframeTrack,Ce+".quaternion",Ee,"rot",ee),$(VectorKeyframeTrack,Ce+".scale",Ee,"scl",ee)}}return ee.length===0?null:new this(re,le,ee,xe)}resetDuration(){const _=this.tracks;let b=0;for(let $=0,ee=_.length;$!==ee;++$){const re=this.tracks[$];b=Math.max(b,re.times[re.times.length-1])}return this.duration=b,this}trim(){for(let _=0;_<this.tracks.length;_++)this.tracks[_].trim(0,this.duration);return this}validate(){let _=!0;for(let b=0;b<this.tracks.length;b++)_=_&&this.tracks[b].validate();return _}optimize(){for(let _=0;_<this.tracks.length;_++)this.tracks[_].optimize();return this}clone(){const _=[];for(let b=0;b<this.tracks.length;b++)_.push(this.tracks[b].clone());return new this.constructor(this.name,this.duration,_,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(H){switch(H.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+H)}function parseKeyframeTrack(H){if(H.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const _=getTrackTypeForValueTypeName(H.type);if(H.times===void 0){const b=[],$=[];flattenJSON(H.keys,b,$,"value"),H.times=b,H.values=$}return _.parse!==void 0?_.parse(H):new _(H.name,H.times,H.values,H.interpolation)}const Cache={enabled:!1,files:{},add:function(H,_){this.enabled!==!1&&(this.files[H]=_)},get:function(H){if(this.enabled!==!1)return this.files[H]},remove:function(H){delete this.files[H]},clear:function(){this.files={}}};class LoadingManager{constructor(_,b,$){const ee=this;let re=!1,ae=0,xe=0,le;const fe=[];this.onStart=void 0,this.onLoad=_,this.onProgress=b,this.onError=$,this.itemStart=function(ve){xe++,re===!1&&ee.onStart!==void 0&&ee.onStart(ve,ae,xe),re=!0},this.itemEnd=function(ve){ae++,ee.onProgress!==void 0&&ee.onProgress(ve,ae,xe),ae===xe&&(re=!1,ee.onLoad!==void 0&&ee.onLoad())},this.itemError=function(ve){ee.onError!==void 0&&ee.onError(ve)},this.resolveURL=function(ve){return le?le(ve):ve},this.setURLModifier=function(ve){return le=ve,this},this.addHandler=function(ve,Se){return fe.push(ve,Se),this},this.removeHandler=function(ve){const Se=fe.indexOf(ve);return Se!==-1&&fe.splice(Se,2),this},this.getHandler=function(ve){for(let Se=0,Ee=fe.length;Se<Ee;Se+=2){const Ce=fe[Se],Ie=fe[Se+1];if(Ce.global&&(Ce.lastIndex=0),Ce.test(ve))return Ie}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(_){this.manager=_!==void 0?_:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(_,b){const $=this;return new Promise(function(ee,re){$.load(_,ee,b,re)})}parse(){}setCrossOrigin(_){return this.crossOrigin=_,this}setWithCredentials(_){return this.withCredentials=_,this}setPath(_){return this.path=_,this}setResourcePath(_){return this.resourcePath=_,this}setRequestHeader(_){return this.requestHeader=_,this}}Loader.DEFAULT_MATERIAL_NAME="__DEFAULT";const loading={};class HttpError extends Error{constructor(_,b){super(_),this.response=b}}class FileLoader extends Loader{constructor(_){super(_)}load(_,b,$,ee){_===void 0&&(_=""),this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const re=Cache.get(_);if(re!==void 0)return this.manager.itemStart(_),setTimeout(()=>{b&&b(re),this.manager.itemEnd(_)},0),re;if(loading[_]!==void 0){loading[_].push({onLoad:b,onProgress:$,onError:ee});return}loading[_]=[],loading[_].push({onLoad:b,onProgress:$,onError:ee});const ae=new Request(_,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),xe=this.mimeType,le=this.responseType;fetch(ae).then(fe=>{if(fe.status===200||fe.status===0){if(fe.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||fe.body===void 0||fe.body.getReader===void 0)return fe;const ve=loading[_],Se=fe.body.getReader(),Ee=fe.headers.get("X-File-Size")||fe.headers.get("Content-Length"),Ce=Ee?parseInt(Ee):0,Ie=Ce!==0;let De=0;const Be=new ReadableStream({start(Ne){qe();function qe(){Se.read().then(({done:Xe,value:Ye})=>{if(Xe)Ne.close();else{De+=Ye.byteLength;const Qe=new ProgressEvent("progress",{lengthComputable:Ie,loaded:De,total:Ce});for(let rt=0,ot=ve.length;rt<ot;rt++){const ct=ve[rt];ct.onProgress&&ct.onProgress(Qe)}Ne.enqueue(Ye),qe()}},Xe=>{Ne.error(Xe)})}}});return new Response(Be)}else throw new HttpError(`fetch for "${fe.url}" responded with ${fe.status}: ${fe.statusText}`,fe)}).then(fe=>{switch(le){case"arraybuffer":return fe.arrayBuffer();case"blob":return fe.blob();case"document":return fe.text().then(ve=>new DOMParser().parseFromString(ve,xe));case"json":return fe.json();default:if(xe===void 0)return fe.text();{const Se=/charset="?([^;"\s]*)"?/i.exec(xe),Ee=Se&&Se[1]?Se[1].toLowerCase():void 0,Ce=new TextDecoder(Ee);return fe.arrayBuffer().then(Ie=>Ce.decode(Ie))}}}).then(fe=>{Cache.add(_,fe);const ve=loading[_];delete loading[_];for(let Se=0,Ee=ve.length;Se<Ee;Se++){const Ce=ve[Se];Ce.onLoad&&Ce.onLoad(fe)}}).catch(fe=>{const ve=loading[_];if(ve===void 0)throw this.manager.itemError(_),fe;delete loading[_];for(let Se=0,Ee=ve.length;Se<Ee;Se++){const Ce=ve[Se];Ce.onError&&Ce.onError(fe)}this.manager.itemError(_)}).finally(()=>{this.manager.itemEnd(_)}),this.manager.itemStart(_)}setResponseType(_){return this.responseType=_,this}setMimeType(_){return this.mimeType=_,this}}class ImageLoader extends Loader{constructor(_){super(_)}load(_,b,$,ee){this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const re=this,ae=Cache.get(_);if(ae!==void 0)return re.manager.itemStart(_),setTimeout(function(){b&&b(ae),re.manager.itemEnd(_)},0),ae;const xe=createElementNS("img");function le(){ve(),Cache.add(_,this),b&&b(this),re.manager.itemEnd(_)}function fe(Se){ve(),ee&&ee(Se),re.manager.itemError(_),re.manager.itemEnd(_)}function ve(){xe.removeEventListener("load",le,!1),xe.removeEventListener("error",fe,!1)}return xe.addEventListener("load",le,!1),xe.addEventListener("error",fe,!1),_.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(xe.crossOrigin=this.crossOrigin),re.manager.itemStart(_),xe.src=_,xe}}class DataTextureLoader extends Loader{constructor(_){super(_)}load(_,b,$,ee){const re=this,ae=new DataTexture,xe=new FileLoader(this.manager);return xe.setResponseType("arraybuffer"),xe.setRequestHeader(this.requestHeader),xe.setPath(this.path),xe.setWithCredentials(re.withCredentials),xe.load(_,function(le){let fe;try{fe=re.parse(le)}catch(ve){if(ee!==void 0)ee(ve);else{console.error(ve);return}}fe.image!==void 0?ae.image=fe.image:fe.data!==void 0&&(ae.image.width=fe.width,ae.image.height=fe.height,ae.image.data=fe.data),ae.wrapS=fe.wrapS!==void 0?fe.wrapS:ClampToEdgeWrapping,ae.wrapT=fe.wrapT!==void 0?fe.wrapT:ClampToEdgeWrapping,ae.magFilter=fe.magFilter!==void 0?fe.magFilter:LinearFilter,ae.minFilter=fe.minFilter!==void 0?fe.minFilter:LinearFilter,ae.anisotropy=fe.anisotropy!==void 0?fe.anisotropy:1,fe.colorSpace!==void 0&&(ae.colorSpace=fe.colorSpace),fe.flipY!==void 0&&(ae.flipY=fe.flipY),fe.format!==void 0&&(ae.format=fe.format),fe.type!==void 0&&(ae.type=fe.type),fe.mipmaps!==void 0&&(ae.mipmaps=fe.mipmaps,ae.minFilter=LinearMipmapLinearFilter),fe.mipmapCount===1&&(ae.minFilter=LinearFilter),fe.generateMipmaps!==void 0&&(ae.generateMipmaps=fe.generateMipmaps),ae.needsUpdate=!0,b&&b(ae,fe)},$,ee),ae}}class TextureLoader extends Loader{constructor(_){super(_)}load(_,b,$,ee){const re=new Texture,ae=new ImageLoader(this.manager);return ae.setCrossOrigin(this.crossOrigin),ae.setPath(this.path),ae.load(_,function(xe){re.image=xe,re.needsUpdate=!0,b!==void 0&&b(re)},$,ee),re}}class Light extends Object3D{constructor(_,b=1){super(),this.isLight=!0,this.type="Light",this.color=new Color(_),this.intensity=b}dispose(){}copy(_,b){return super.copy(_,b),this.color.copy(_.color),this.intensity=_.intensity,this}toJSON(_){const b=super.toJSON(_);return b.object.color=this.color.getHex(),b.object.intensity=this.intensity,this.groundColor!==void 0&&(b.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(b.object.distance=this.distance),this.angle!==void 0&&(b.object.angle=this.angle),this.decay!==void 0&&(b.object.decay=this.decay),this.penumbra!==void 0&&(b.object.penumbra=this.penumbra),this.shadow!==void 0&&(b.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(b.object.target=this.target.uuid),b}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(_){this.camera=_,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(_){const b=this.camera,$=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(_.matrixWorld),b.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(_.target.matrixWorld),b.lookAt(_lookTarget$1),b.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),$.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),$.multiply(_projScreenMatrix$1)}getViewport(_){return this._viewports[_]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(_){return this.camera=_.camera.clone(),this.intensity=_.intensity,this.bias=_.bias,this.radius=_.radius,this.mapSize.copy(_.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const _={};return this.intensity!==1&&(_.intensity=this.intensity),this.bias!==0&&(_.bias=this.bias),this.normalBias!==0&&(_.normalBias=this.normalBias),this.radius!==1&&(_.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(_.mapSize=this.mapSize.toArray()),_.camera=this.camera.toJSON(!1).object,delete _.camera.matrix,_}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(_){const b=this.camera,$=RAD2DEG*2*_.angle*this.focus,ee=this.mapSize.width/this.mapSize.height,re=_.distance||b.far;($!==b.fov||ee!==b.aspect||re!==b.far)&&(b.fov=$,b.aspect=ee,b.far=re,b.updateProjectionMatrix()),super.updateMatrices(_)}copy(_){return super.copy(_),this.focus=_.focus,this}}class SpotLight extends Light{constructor(_,b,$=0,ee=Math.PI/3,re=0,ae=2){super(_,b),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=$,this.angle=ee,this.penumbra=re,this.decay=ae,this.map=null,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(_){this.intensity=_/Math.PI}dispose(){this.shadow.dispose()}copy(_,b){return super.copy(_,b),this.distance=_.distance,this.angle=_.angle,this.penumbra=_.penumbra,this.decay=_.decay,this.target=_.target.clone(),this.shadow=_.shadow.clone(),this}}const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(_,b=0){const $=this.camera,ee=this.matrix,re=_.distance||$.far;re!==$.far&&($.far=re,$.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(_.matrixWorld),$.position.copy(_lightPositionWorld),_lookTarget.copy($.position),_lookTarget.add(this._cubeDirections[b]),$.up.copy(this._cubeUps[b]),$.lookAt(_lookTarget),$.updateMatrixWorld(),ee.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices($.projectionMatrix,$.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}class PointLight extends Light{constructor(_,b,$=0,ee=2){super(_,b),this.isPointLight=!0,this.type="PointLight",this.distance=$,this.decay=ee,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(_){this.intensity=_/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(_,b){return super.copy(_,b),this.distance=_.distance,this.decay=_.decay,this.shadow=_.shadow.clone(),this}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(_,b){super(_,b),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(_){return super.copy(_),this.target=_.target.clone(),this.shadow=_.shadow.clone(),this}}class AmbientLight extends Light{constructor(_,b){super(_,b),this.isAmbientLight=!0,this.type="AmbientLight"}}class LoaderUtils{static decodeText(_){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(_);let b="";for(let $=0,ee=_.length;$<ee;$++)b+=String.fromCharCode(_[$]);try{return decodeURIComponent(escape(b))}catch{return b}}static extractUrlBase(_){const b=_.lastIndexOf("/");return b===-1?"./":_.slice(0,b+1)}static resolveURL(_,b){return typeof _!="string"||_===""?"":(/^https?:\/\//i.test(b)&&/^\//.test(_)&&(b=b.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(_)||/^data:.*,.*$/i.test(_)||/^blob:.*$/i.test(_)?_:b+_)}}class ImageBitmapLoader extends Loader{constructor(_){super(_),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(_){return this.options=_,this}load(_,b,$,ee){_===void 0&&(_=""),this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const re=this,ae=Cache.get(_);if(ae!==void 0){if(re.manager.itemStart(_),ae.then){ae.then(fe=>{b&&b(fe),re.manager.itemEnd(_)}).catch(fe=>{ee&&ee(fe)});return}return setTimeout(function(){b&&b(ae),re.manager.itemEnd(_)},0),ae}const xe={};xe.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",xe.headers=this.requestHeader;const le=fetch(_,xe).then(function(fe){return fe.blob()}).then(function(fe){return createImageBitmap(fe,Object.assign(re.options,{colorSpaceConversion:"none"}))}).then(function(fe){return Cache.add(_,fe),b&&b(fe),re.manager.itemEnd(_),fe}).catch(function(fe){ee&&ee(fe),Cache.remove(_),re.manager.itemError(_),re.manager.itemEnd(_)});Cache.add(_,le),re.manager.itemStart(_)}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(_,b,$){const ee=$||PropertyBinding.parseTrackName(b);this._targetGroup=_,this._bindings=_.subscribe_(b,ee)}getValue(_,b){this.bind();const $=this._targetGroup.nCachedObjects_,ee=this._bindings[$];ee!==void 0&&ee.getValue(_,b)}setValue(_,b){const $=this._bindings;for(let ee=this._targetGroup.nCachedObjects_,re=$.length;ee!==re;++ee)$[ee].setValue(_,b)}bind(){const _=this._bindings;for(let b=this._targetGroup.nCachedObjects_,$=_.length;b!==$;++b)_[b].bind()}unbind(){const _=this._bindings;for(let b=this._targetGroup.nCachedObjects_,$=_.length;b!==$;++b)_[b].unbind()}}class PropertyBinding{constructor(_,b,$){this.path=b,this.parsedPath=$||PropertyBinding.parseTrackName(b),this.node=PropertyBinding.findNode(_,this.parsedPath.nodeName),this.rootNode=_,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(_,b,$){return _&&_.isAnimationObjectGroup?new PropertyBinding.Composite(_,b,$):new PropertyBinding(_,b,$)}static sanitizeNodeName(_){return _.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(_){const b=_trackRe.exec(_);if(b===null)throw new Error("PropertyBinding: Cannot parse trackName: "+_);const $={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],propertyIndex:b[6]},ee=$.nodeName&&$.nodeName.lastIndexOf(".");if(ee!==void 0&&ee!==-1){const re=$.nodeName.substring(ee+1);_supportedObjectNames.indexOf(re)!==-1&&($.nodeName=$.nodeName.substring(0,ee),$.objectName=re)}if($.propertyName===null||$.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+_);return $}static findNode(_,b){if(b===void 0||b===""||b==="."||b===-1||b===_.name||b===_.uuid)return _;if(_.skeleton){const $=_.skeleton.getBoneByName(b);if($!==void 0)return $}if(_.children){const $=function(re){for(let ae=0;ae<re.length;ae++){const xe=re[ae];if(xe.name===b||xe.uuid===b)return xe;const le=$(xe.children);if(le)return le}return null},ee=$(_.children);if(ee)return ee}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(_,b){_[b]=this.targetObject[this.propertyName]}_getValue_array(_,b){const $=this.resolvedProperty;for(let ee=0,re=$.length;ee!==re;++ee)_[b++]=$[ee]}_getValue_arrayElement(_,b){_[b]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(_,b){this.resolvedProperty.toArray(_,b)}_setValue_direct(_,b){this.targetObject[this.propertyName]=_[b]}_setValue_direct_setNeedsUpdate(_,b){this.targetObject[this.propertyName]=_[b],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(_,b){this.targetObject[this.propertyName]=_[b],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(_,b){const $=this.resolvedProperty;for(let ee=0,re=$.length;ee!==re;++ee)$[ee]=_[b++]}_setValue_array_setNeedsUpdate(_,b){const $=this.resolvedProperty;for(let ee=0,re=$.length;ee!==re;++ee)$[ee]=_[b++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(_,b){const $=this.resolvedProperty;for(let ee=0,re=$.length;ee!==re;++ee)$[ee]=_[b++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(_,b){this.resolvedProperty[this.propertyIndex]=_[b]}_setValue_arrayElement_setNeedsUpdate(_,b){this.resolvedProperty[this.propertyIndex]=_[b],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(_,b){this.resolvedProperty[this.propertyIndex]=_[b],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(_,b){this.resolvedProperty.fromArray(_,b)}_setValue_fromArray_setNeedsUpdate(_,b){this.resolvedProperty.fromArray(_,b),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(_,b){this.resolvedProperty.fromArray(_,b),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(_,b){this.bind(),this.getValue(_,b)}_setValue_unbound(_,b){this.bind(),this.setValue(_,b)}bind(){let _=this.node;const b=this.parsedPath,$=b.objectName,ee=b.propertyName;let re=b.propertyIndex;if(_||(_=PropertyBinding.findNode(this.rootNode,b.nodeName),this.node=_),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!_){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if($){let fe=b.objectIndex;switch($){case"materials":if(!_.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}_=_.material.materials;break;case"bones":if(!_.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}_=_.skeleton.bones;for(let ve=0;ve<_.length;ve++)if(_[ve].name===fe){fe=ve;break}break;case"map":if("map"in _){_=_.map;break}if(!_.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}_=_.material.map;break;default:if(_[$]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}_=_[$]}if(fe!==void 0){if(_[fe]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,_);return}_=_[fe]}}const ae=_[ee];if(ae===void 0){const fe=b.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+fe+"."+ee+" but it wasn't found.",_);return}let xe=this.Versioning.None;this.targetObject=_,_.needsUpdate!==void 0?xe=this.Versioning.NeedsUpdate:_.matrixWorldNeedsUpdate!==void 0&&(xe=this.Versioning.MatrixWorldNeedsUpdate);let le=this.BindingType.Direct;if(re!==void 0){if(ee==="morphTargetInfluences"){if(!_.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!_.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}_.morphTargetDictionary[re]!==void 0&&(re=_.morphTargetDictionary[re])}le=this.BindingType.ArrayElement,this.resolvedProperty=ae,this.propertyIndex=re}else ae.fromArray!==void 0&&ae.toArray!==void 0?(le=this.BindingType.HasFromToArray,this.resolvedProperty=ae):Array.isArray(ae)?(le=this.BindingType.EntireArray,this.resolvedProperty=ae):this.propertyName=ee;this.getValue=this.GetterByBindingType[le],this.setValue=this.SetterByBindingTypeAndVersioning[le][xe]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];const _startP=new Vector3,_startEnd=new Vector3;class Line3{constructor(_=new Vector3,b=new Vector3){this.start=_,this.end=b}set(_,b){return this.start.copy(_),this.end.copy(b),this}copy(_){return this.start.copy(_.start),this.end.copy(_.end),this}getCenter(_){return _.addVectors(this.start,this.end).multiplyScalar(.5)}delta(_){return _.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(_,b){return this.delta(b).multiplyScalar(_).add(this.start)}closestPointToPointParameter(_,b){_startP.subVectors(_,this.start),_startEnd.subVectors(this.end,this.start);const $=_startEnd.dot(_startEnd);let re=_startEnd.dot(_startP)/$;return b&&(re=clamp(re,0,1)),re}closestPointToPoint(_,b,$){const ee=this.closestPointToPointParameter(_,b);return this.delta($).multiplyScalar(ee).add(this.start)}applyMatrix4(_){return this.start.applyMatrix4(_),this.end.applyMatrix4(_),this}equals(_){return _.start.equals(this.start)&&_.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);var Ak=Object.defineProperty,AT=Object.getOwnPropertySymbols,AP=Object.prototype.hasOwnProperty,AE=Object.prototype.propertyIsEnumerable,AM=(H,_,b)=>_ in H?Ak(H,_,{enumerable:!0,configurable:!0,writable:!0,value:b}):H[_]=b,Ag=(H,_)=>{for(var b in _||(_={}))AP.call(_,b)&&AM(H,b,_[b]);if(AT)for(var b of AT(_))AE.call(_,b)&&AM(H,b,_[b]);return H};class AQ extends bn{constructor(_,b,$,ee){super({container:_,mode:b,layerCount:2,mirror:$});const re=this.canvas.layers[1];this.renderer=new WebGLRenderer(Ag({alpha:!0,preserveDrawingBuffer:!0,canvas:re},ee)),this.renderer.setClearColor(0,0),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(re.clientWidth,re.clientHeight),this.renderer.outputColorSpace=SRGBColorSpace$1,this.canvas.on("resize",()=>{this.renderer.setSize(re.clientWidth,re.clientHeight)}),this.scene=new Scene,this.scene.background=null,this.camera=new PerspectiveCamera$1(this.cameraAngle,1,.02,20)}updateScene(){this.scene&&this.renderer.render(this.scene,this.camera)}setupCamera(_,b){super.setupCamera(_,b),this.camera instanceof PerspectiveCamera$1&&(this.camera.aspect=this.cameraRatio,this.camera.fov=this.cameraAngle/Math.PI*180,this.camera.updateProjectionMatrix())}setupVideo(_,b){super.setupVideo(_,b),this.camera instanceof OrthographicCamera$1&&(this.camera.right=this.videoSize.width,this.camera.bottom=this.videoSize.height,this.camera.updateProjectionMatrix())}disposeObject(_){const b=($,ee)=>Array.isArray($)&&$.every(re=>re instanceof ee);_.removeFromParent(),_.traverse($=>{$ instanceof Mesh$1&&($.geometry instanceof BufferGeometry$1&&$.geometry.dispose(),$.material instanceof Material$1&&$.material.dispose(),b($.material,Material$1)&&$.material.forEach(ee=>{ee.dispose();for(const re in ee){const ae=ee[re];ae instanceof Texture$1&&ae.dispose()}}))})}}class AX extends bF{}class Ap extends AQ{}class Ab extends AX{}class Ao extends AQ{}class Ay extends AX{constructor(_,b=!1){super(),this.node=_,this.shapeScale=b}async update(_,b){var $;if(!this.loaded)return;const ee=($=_.faces[0])==null?void 0:$.transform;if(!ee)return this.node.visible=!1,super.update(_,b);const re=new Vector3(...ee.translation),ae=new Vector3().setScalar(ee.scale),xe=new Vector3(...ee.shapeScale).multiplyScalar(ee.scale),le=new Quaternion(...ee.rotation);return this.node.visible=!0,this.node.setRotationFromQuaternion(le),this.node.position.copy(re),this.node.scale.copy(this.shapeScale?xe:ae),super.update(_,b)}}class AB extends Ab{constructor(_,b={spineCurve:.5,neckAdjust:.01,headRatio:.32,shouldersD:[0,-.01,.005]}){super(),this.node=_,this.tune=b,this.avatarLength=1,this.alignScore=.9,this.alignVisibility=.9}async load(_){this.loaded||(await super.load(_),this.setNode(this.node))}unload(){this.loaded&&(delete this.node,delete this.skeletonNodes,delete this.skeleton,delete this.spineCurve,super.unload())}setNode(_){var b;if(delete this.skeletonNodes,delete this.skeleton,delete this.spineCurve,this.node=_,!this.loaded||!_)return;_.traverse(ot=>{!this.skeleton&&ot instanceof SkinnedMesh&&(this.skeleton=ot.skeleton)});const $=(b=this.skeleton)==null?void 0:b.bones;if(!$)return;const ee=ot=>$.find(ct=>ct.name.toLowerCase().endsWith(ot)),re={hips:ee("hips"),spine:ee("spine"),spine1:ee("spine1"),spine2:ee("spine2"),neck:ee("neck"),head:ee("head"),headEnd:ee("headtop_end"),shoulderL:ee("leftshoulder"),shoulderR:ee("rightshoulder"),armL:ee("leftarm"),armR:ee("rightarm"),forearmL:ee("leftforearm"),forearmR:ee("rightforearm"),handL:ee("lefthand"),handR:ee("righthand"),uplegL:ee("leftupleg"),uplegR:ee("rightupleg"),legL:ee("leftleg"),legR:ee("rightleg"),footL:ee("leftfoot"),footR:ee("rightfoot"),toeL:ee("lefttoebase"),toeR:ee("righttoebase")};this.skeletonNodes=re;const ae=re.hips.getWorldPosition(new Vector3),xe=re.armL.getWorldPosition(new Vector3),le=re.armR.getWorldPosition(new Vector3),fe=xe.clone().lerp(le,.5).sub(ae).length(),ve=xe.clone().sub(ae),Se=le.clone().sub(ae).clone().cross(ve).normalize(),Ee=re.spine.getWorldPosition(new Vector3).sub(ae),Ce=Ee.dot(Se),Ie=Ee.clone().sub(Se.clone().multiplyScalar(Ce)).length(),De=re.spine1.getWorldPosition(new Vector3).sub(ae),Be=De.dot(Se),Ne=De.clone().sub(Se.clone().multiplyScalar(Be)).length(),qe=re.spine2.getWorldPosition(new Vector3).sub(ae),Xe=qe.dot(Se),Ye=qe.clone().sub(Se.clone().multiplyScalar(Xe)).length(),Qe=re.head.getWorldPosition(new Vector3),rt=re.headEnd.getWorldPosition(new Vector3).clone().sub(Qe).length();this.avatarLength=fe,this.spineCurve={hips:[ae.x,ae.y],spine:[Ie/fe,Ce/fe],spine1:[Ne/fe,Be/fe],spine2:[Ye/fe,Xe/fe],head:[rt/fe,0]},_.traverse(ot=>{ot.frustumCulled=!1})}async update(_,b){var $,ee;const re=($=_.poses[0])==null?void 0:$.points,{node:ae,skeletonNodes:xe,spineCurve:le}=this;if(!ae)return super.update(_,b);if(!xe||!le||!re)return ae.visible=!1,super.update(_,b);const fe=this.estimateBones(re,le);return ae.visible=!0,(ee=this.skeleton)==null||ee.pose(),this.updateSpine(fe),this.updateHandL(fe,re),this.updateHandR(fe,re),this.updateLegL(fe,re),this.updateLegR(fe,re),super.update(_,b)}updateSpine(_){var b;const{skeletonNodes:$}=this;if(!$)return;this.alignBone(_.hips,$.hips,!1),this.alignBone(_.spine,$.spine),this.alignBone(_.spine1,$.spine1),this.alignBone(_.spine2,$.spine2),this.alignBone(_.neck,$.neck,!1),this.alignBone(_.head,$.head,!1);const ee=(b=this.skeleton)==null?void 0:b.bones.find(re=>re.name.endsWith("HeadEnd"));if(ee){const{head:re,headEnd:ae}=_,xe=ae.position.clone().sub(re.position).length();$.head.scale.setScalar(1.05*xe/ee.position.length())}this.alignBone(_.shoulderL,$.shoulderL,!1),this.alignBone(_.shoulderR,$.shoulderR,!1)}updateHandL(_,b){const{skeletonNodes:$}=this;if(!$)return;const{alignScore:ee,alignVisibility:re}=this;this.alignBone(_.armL,$.armL),!(b.elbowL.score<ee&&b.elbowL.visibility<re)&&(this.alignBone(_.forearmL,$.forearmL),this.alignBone(_.handL,$.handL),$.handL.scale.setScalar(.95))}updateHandR(_,b){const{skeletonNodes:$}=this;if(!$)return;const{alignScore:ee,alignVisibility:re}=this;this.alignBone(_.armR,$.armR),!(b.elbowR.score<ee&&b.elbowR.visibility<re)&&(this.alignBone(_.forearmR,$.forearmR),this.alignBone(_.handR,$.handR),$.handR.scale.setScalar(.95))}updateLegL(_,b){const{skeletonNodes:$}=this;if(!$)return;const{alignScore:ee,alignVisibility:re}=this;b.hipL.score<ee&&b.hipL.visibility<re||(this.alignBone(_.uplegL,$.uplegL,!1),!(b.kneeL.score<ee&&b.kneeL.visibility<re)&&(this.alignBone(_.legL,$.legL),!(b.ankleL.score<ee&&b.ankleL.visibility<re)&&(this.alignBone(_.footL,$.footL),this.alignBone(_.toeL,$.toeL))))}updateLegR(_,b){const{skeletonNodes:$}=this;if(!$)return;const{alignScore:ee,alignVisibility:re}=this;b.hipR.score<ee&&b.hipR.visibility<re||(this.alignBone(_.uplegR,$.uplegR,!1),!(b.kneeR.score<ee&&b.kneeR.visibility<re)&&(this.alignBone(_.legR,$.legR),!(b.ankleR.score<ee&&b.ankleR.visibility<re)&&(this.alignBone(_.footR,$.footR),this.alignBone(_.toeR,$.toeR))))}estimateBones(_,b){var $;const ee=new Vector3(..._.hipL.metric),re=new Vector3(..._.hipR.metric),ae=ee.clone().lerp(re,.5),xe=ee.clone().sub(re).normalize(),le=xe.clone().negate(),fe=new Vector3(..._.shoulderL.metric),ve=new Vector3(..._.shoulderR.metric),Se=new Vector3(..._.elbowL.metric),Ee=new Vector3(..._.elbowR.metric),Ce=fe.clone().lerp(ve,.5),Ie=fe.clone().sub(ve).normalize(),De=fe.clone().sub(ae),Be=ve.clone().sub(ae).clone().cross(De).normalize();if(this.tune.shouldersD){const ta=Ie.clone().multiplyScalar(this.tune.shouldersD[0]),Na=Ce.clone().sub(ae).normalize().multiplyScalar(this.tune.shouldersD[1]).add(Be.clone().multiplyScalar(($=this.tune)==null?void 0:$.shouldersD[2]));fe.add(Na).add(ta),ve.add(Na).add(ta.clone().negate())}const Ne=fe.clone().lerp(ve,.5),qe=Ne.clone().sub(ae).normalize(),Xe=Se.clone().sub(fe).normalize(),Ye=Ee.clone().sub(ve).normalize();let Qe;if(this.tune.neckAdjust){const ta=Math.abs(Ie.x);Qe=qe.clone().multiplyScalar(ta*(qe.dot(Xe)*-this.tune.neckAdjust+qe.dot(Ye)*-this.tune.neckAdjust)),Ne.add(Qe)}const rt=Ne.clone().sub(ae).length(),ot=this.tune.shoulderOffset||.2,ct=Ne.clone().lerp(fe,ot),mt=Ne.clone().lerp(ve,ot),_t=new Vector3(..._.earL.metric),Lt=new Vector3(..._.earR.metric),Vt=_t.clone().lerp(Lt,.5),Gt=new Vector3(..._.nose.metric),$t=Vt.clone().sub(Gt).normalize(),Qt=_t.clone().sub(Lt).normalize(),vt=Qt.clone().cross($t).add($t.clone().multiplyScalar(.05)).normalize(),It=this.tune.headRatio||.32,gt=b.head[0]*rt,Tt=Vt.clone().add(vt.clone().cross(Qt).multiplyScalar(.025)),Ct=Tt.clone().add(vt.clone().multiplyScalar(-It*gt)),Ft=Tt.clone().add(vt.clone().multiplyScalar((1-It)*gt)),sn=Ct.clone().lerp(Ft,2),cn=Ie.clone().lerp(Qt,.5),en=Qe?fe.clone().add(Qe):fe.clone(),yn=Qe?ve.clone().add(Qe):ve.clone(),Pn=ee.clone().lerp(en,b.spine[0]),tr=re.clone().lerp(yn,b.spine[0]),nr=Pn.clone().lerp(tr,.5),Fr=Pn.clone().sub(tr),Ur=ee.clone().lerp(en,b.spine1[0]),Kr=re.clone().lerp(yn,b.spine1[0]),on=Ur.clone().lerp(Kr,.5),qr=Ur.clone().sub(Kr),rr=ee.clone().lerp(en,b.spine2[0]),Qr=re.clone().lerp(yn,b.spine2[0]),Ir=rr.clone().lerp(Qr,.5),ai=Ur.clone().sub(Qr);if(this.tune.spineCurve){const ta=fe.clone().sub(ae),Na=ve.clone().sub(ae).clone().cross(ta).normalize(),is=this.tune.spineCurve*rt;nr.add(Na.clone().multiplyScalar(b.spine[1]*is)),on.add(Na.clone().multiplyScalar(b.spine1[1]*is)),Ir.add(Na.clone().multiplyScalar(b.spine2[1]*is))}const Hr=new Vector3(..._.wristL.metric),Vr=Hr.clone().sub(Se).normalize().clone().sub(Xe).negate(),xn=Be.clone(),Ht=Vr.clone().lerp(xn,.5),In=new Vector3(..._.indexL.metric),er=new Vector3(..._.pinkyL.metric),Hn=In.clone().lerp(er,.5),Zn=er.clone().sub(In),Dr=new Vector3(..._.wristR.metric),zn=Dr.clone().sub(Ee).normalize().clone().sub(Ye),Nr=Be.clone().negate(),vr=zn.clone().lerp(Nr,.5),Sr=new Vector3(..._.indexR.metric),zr=new Vector3(..._.pinkyR.metric),gi=Sr.clone().lerp(zr,.5),oi=Sr.clone().sub(zr),Gr=new Vector3(..._.kneeL.metric),ri=new Vector3(..._.ankleL.metric),yi=new Vector3(..._.footIndexL.metric),Ci=new Vector3(..._.heelL.metric),wn=ri.clone().sub(Gr).normalize(),Pr=yi.clone().sub(Ci).normalize(),xr=wn.clone().cross(Pr).normalize(),gr=Ci.clone().lerp(yi,.8),Mr=le.clone().lerp(xr,.2),ci=le.clone().lerp(xr,.6),fi=new Vector3(..._.kneeR.metric),Ui=new Vector3(..._.ankleR.metric),Vi=new Vector3(..._.footIndexR.metric),bi=new Vector3(..._.heelR.metric),Ga=Ui.clone().sub(fi).normalize(),Ra=Vi.clone().sub(bi).normalize(),sa=Ga.clone().cross(Ra).normalize(),$i=bi.clone().lerp(Vi,.8),Fi=le.clone().lerp(sa,.2),Ss=le.clone().lerp(sa,.6);return{hips:this.estimateBone(ae,nr,xe),spine:this.estimateBone(nr,on,Fr),spine1:this.estimateBone(on,Ir,qr),spine2:this.estimateBone(Ir,Ne,ai),neck:this.estimateBone(Ne,Ct,cn),head:this.estimateBone(Ct,Ft,Qt),headEnd:this.estimateBone(Ft,sn,Qt),shoulderL:this.estimateBone(ct,fe,xn),armL:this.estimateBone(fe,Se,Ht),forearmL:this.estimateBone(Se,Hr,Vr),handL:this.estimateBone(Hr,Hn,Zn),shoulderR:this.estimateBone(mt,ve,Nr),armR:this.estimateBone(ve,Ee,vr),forearmR:this.estimateBone(Ee,Dr,zn),handR:this.estimateBone(Dr,gi,oi),uplegL:this.estimateBone(ee,Gr,Mr),legL:this.estimateBone(Gr,ri,ci),footL:this.estimateBone(ri,gr,xr),toeL:this.estimateBone(gr,yi,xr),uplegR:this.estimateBone(re,fi,Fi),legR:this.estimateBone(fi,Ui,Ss),footR:this.estimateBone(Ui,$i,sa),toeR:this.estimateBone($i,Vi,sa)}}estimateBone(_,b,$){const ee=b.clone().sub(_).normalize(),re=$.clone().normalize().cross(ee).normalize(),ae=ee.clone().cross(re);return{position:_.clone(),rotation:new Quaternion().setFromRotationMatrix(new Matrix4().makeBasis(ae,ee,re))}}alignBone(_,b,$=!0){let ee=_.rotation.clone(),re=_.position.clone();b.parent&&(ee=b.parent.getWorldQuaternion(new Quaternion).invert().multiply(ee),re.applyMatrix4(b.parent.matrixWorld.clone().invert()),$&&b.parent instanceof Bone&&(b.parent.scale.setScalar(re.length()/b.position.length()),b.parent.updateWorldMatrix(!0,!0),re=_.position.clone().applyMatrix4(b.parent.matrixWorld.clone().invert()))),b.setRotationFromQuaternion(ee),b.position.copy(re),b.updateWorldMatrix(!0,!0)}}class Ax extends AB{constructor(_,b,$={spineCurve:.5,neckAdjust:.01,headRatio:.32,shouldersD:[0,-.01,.005]}){super(_,$),this.outfit=b}setNode(_){super.setNode(_);const{outfit:b,node:$}=this;!b||!$||$.traverse(ee=>{if(!(ee instanceof Mesh))return;const re=ae=>ae==null?void 0:ae.some(xe=>typeof xe=="string"?ee.name===xe:xe.test(ee.name));if(re(b.occluders)){ee.material.colorWrite=!1,ee.renderOrder=-1;return}if(re(b.hidden)){ee.visible=!1;return}})}setOutfit(_,b){this.outfit=b,this.setNode(_)}}var AY;(H=>{function _(fe,ve,Se){return{position:fe.clone(),rotation:$(ve.clone().sub(fe),Se)}}H.estimateBoneYZ=_;function b(fe,ve,Se){return{position:fe.clone(),rotation:ee(ve.clone().sub(fe),Se)}}H.estimateBoneYX=b;function $(fe,ve){const Se=fe.clone().normalize(),Ee=Se.clone().cross(ve).normalize(),Ce=Ee.clone().cross(Se).normalize();return new Quaternion$1().setFromRotationMatrix(new Matrix4$1().makeBasis(Ee,Se,Ce))}H.estimateRotationYZ=$;function ee(fe,ve){const Se=fe.clone().normalize(),Ee=ve.clone().cross(Se).normalize(),Ce=Se.clone().cross(Ee).normalize();return new Quaternion$1().setFromRotationMatrix(new Matrix4$1().makeBasis(Ce,Se,Ee))}H.estimateRotationYX=ee;function re(fe,ve){const Se=fe.clone().cross(ve);return new Quaternion$1(Se.x,Se.y,Se.z,Math.sqrt(1+fe.dot(ve))).normalize()}H.rotationBetween=re;function ae(fe,ve,Se=!0){let Ee=fe.position.clone(),Ce=fe.rotation.clone();ve.parent&&(Ce=ve.parent.getWorldQuaternion(new Quaternion$1).invert().multiply(Ce),Ee.applyMatrix4(ve.parent.matrixWorld.clone().invert()),Se&&(ve.parent.scale.setScalar(Ee.length()/ve.position.length()),ve.parent.updateWorldMatrix(!0,!0),Ee=fe.position.clone().applyMatrix4(ve.parent.matrixWorld.clone().invert()))),ve.setRotationFromQuaternion(Ce),ve.position.copy(Ee),ve.updateWorldMatrix(!0,!0)}H.alignBone=ae;function xe(fe,ve,Se=!0){let Ee=fe.clone();ve.parent&&(Ee.applyMatrix4(ve.parent.matrixWorld.clone().invert()),Se&&(ve.parent.scale.setScalar(Ee.length()/ve.position.length()),ve.parent.updateWorldMatrix(!0,!0),Ee=fe.clone().applyMatrix4(ve.parent.matrixWorld.clone().invert()))),ve.position.copy(Ee),ve.updateWorldMatrix(!0,!0)}H.positionBone=xe;function le(fe,ve){let Se=fe.clone();ve.parent&&(Se=ve.parent.getWorldQuaternion(new Quaternion$1).invert().multiply(Se)),ve.setRotationFromQuaternion(Se),ve.updateWorldMatrix(!0,!0)}H.rotateBone=le})(AY||(AY={}));class R7 extends AX{constructor(_,b=-1){super(),this.node=_,this.renderOrder=b}async load(_){if(!this.loaded)return this.node.traverse(b=>{b instanceof Mesh&&(b.material.colorWrite=!1),b.renderOrder=this.renderOrder}),super.load(_)}}const Rg=32;new Array(Rg).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}));class e5{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(_,b){let $=1/0,ee=-1/0;for(let re=0,ae=_.length;re<ae;re++){const xe=_[re][b];$=xe<$?xe:$,ee=xe>ee?xe:ee}this.min=$,this.max=ee}setFromPoints(_,b){let $=1/0,ee=-1/0;for(let re=0,ae=b.length;re<ae;re++){const xe=b[re],le=_.dot(xe);$=le<$?le:$,ee=le>ee?le:ee}this.min=$,this.max=ee}isSeparated(_){return this.min>_.max||_.min>this.max}}e5.prototype.setFromBox=function(){const H=new Vector3;return function(_,b){const $=b.min,ee=b.max;let re=1/0,ae=-1/0;for(let xe=0;xe<=1;xe++)for(let le=0;le<=1;le++)for(let fe=0;fe<=1;fe++){H.x=$.x*xe+ee.x*(1-xe),H.y=$.y*le+ee.y*(1-le),H.z=$.z*fe+ee.z*(1-fe);const ve=_.dot(H);re=Math.min(ve,re),ae=Math.max(ve,ae)}this.min=re,this.max=ae}}();const e6=function(){const H=new Vector3,_=new Vector3,b=new Vector3;return function($,ee,re){const ae=$.start,xe=H,le=ee.start,fe=_;b.subVectors(ae,le),H.subVectors($.end,$.start),_.subVectors(ee.end,ee.start);const ve=b.dot(fe),Se=fe.dot(xe),Ee=fe.dot(fe),Ce=b.dot(xe),Ie=xe.dot(xe)*Ee-Se*Se;let De,Be;Ie!==0?De=(ve*Se-Ce*Ee)/Ie:De=0,Be=(ve+De*Se)/Ee,re.x=De,re.y=Be}}(),e7=function(){const H=new Vector2,_=new Vector3,b=new Vector3;return function($,ee,re,ae){e6($,ee,H);let xe=H.x,le=H.y;if(xe>=0&&xe<=1&&le>=0&&le<=1){$.at(xe,re),ee.at(le,ae);return}else if(xe>=0&&xe<=1){le<0?ee.at(0,ae):ee.at(1,ae),$.closestPointToPoint(ae,!0,re);return}else if(le>=0&&le<=1){xe<0?$.at(0,re):$.at(1,re),ee.closestPointToPoint(re,!0,ae);return}else{let fe;xe<0?fe=$.start:fe=$.end;let ve;le<0?ve=ee.start:ve=ee.end;const Se=_,Ee=b;if($.closestPointToPoint(ve,!0,_),ee.closestPointToPoint(fe,!0,b),Se.distanceToSquared(ve)<=Ee.distanceToSquared(fe)){re.copy(Se),ae.copy(ve);return}else{re.copy(fe),ae.copy(Ee);return}}}}(),e8=function(){const H=new Vector3,_=new Vector3,b=new Plane,$=new Line3;return function(ee,re){const{radius:ae,center:xe}=ee,{a:le,b:fe,c:ve}=re;if($.start=le,$.end=fe,$.closestPointToPoint(xe,!0,H).distanceTo(xe)<=ae||($.start=le,$.end=ve,$.closestPointToPoint(xe,!0,H).distanceTo(xe)<=ae)||($.start=fe,$.end=ve,$.closestPointToPoint(xe,!0,H).distanceTo(xe)<=ae))return!0;const Se=re.getPlane(b);if(Math.abs(Se.distanceToPoint(xe))<=ae){const Ee=Se.projectPoint(xe,_);if(re.containsPoint(Ee))return!0}return!1}}(),e9=1e-15;function eA(H){return Math.abs(H)<e9}class eR extends Triangle{constructor(..._){super(..._),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new Vector3),this.satBounds=new Array(4).fill().map(()=>new e5),this.points=[this.a,this.b,this.c],this.sphere=new Sphere,this.plane=new Plane,this.needsUpdate=!0}intersectsSphere(_){return e8(_,this)}update(){const _=this.a,b=this.b,$=this.c,ee=this.points,re=this.satAxes,ae=this.satBounds,xe=re[0],le=ae[0];this.getNormal(xe),le.setFromPoints(xe,ee);const fe=re[1],ve=ae[1];fe.subVectors(_,b),ve.setFromPoints(fe,ee);const Se=re[2],Ee=ae[2];Se.subVectors(b,$),Ee.setFromPoints(Se,ee);const Ce=re[3],Ie=ae[3];Ce.subVectors($,_),Ie.setFromPoints(Ce,ee),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(xe,_),this.needsUpdate=!1}}eR.prototype.closestPointToSegment=function(){const H=new Vector3,_=new Vector3,b=new Line3;return function($,ee=null,re=null){const{start:ae,end:xe}=$,le=this.points;let fe,ve=1/0;for(let Se=0;Se<3;Se++){const Ee=(Se+1)%3;b.start.copy(le[Se]),b.end.copy(le[Ee]),e7(b,$,H,_),fe=H.distanceToSquared(_),fe<ve&&(ve=fe,ee&&ee.copy(H),re&&re.copy(_))}return this.closestPointToPoint(ae,H),fe=ae.distanceToSquared(H),fe<ve&&(ve=fe,ee&&ee.copy(H),re&&re.copy(ae)),this.closestPointToPoint(xe,H),fe=xe.distanceToSquared(H),fe<ve&&(ve=fe,ee&&ee.copy(H),re&&re.copy(xe)),Math.sqrt(ve)}}(),eR.prototype.intersectsTriangle=function(){const H=new eR,_=new Array(3),b=new Array(3),$=new e5,ee=new e5,re=new Vector3,ae=new Vector3,xe=new Vector3,le=new Vector3,fe=new Vector3,ve=new Line3,Se=new Line3,Ee=new Line3,Ce=new Vector3;function Ie(De,Be,Ne){const qe=De.points;let Xe=0,Ye=-1;for(let Qe=0;Qe<3;Qe++){const{start:rt,end:ot}=ve;rt.copy(qe[Qe]),ot.copy(qe[(Qe+1)%3]),ve.delta(ae);const ct=eA(Be.distanceToPoint(rt));if(eA(Be.normal.dot(ae))&&ct){Ne.copy(ve),Xe=2;break}const mt=Be.intersectLine(ve,Ce);if(!mt&&ct&&Ce.copy(rt),(mt||ct)&&!eA(Ce.distanceTo(ot))){if(Xe<=1)(Xe===1?Ne.start:Ne.end).copy(Ce),ct&&(Ye=Xe);else if(Xe>=2){(Ye===1?Ne.start:Ne.end).copy(Ce),Xe=2;break}if(Xe++,Xe===2&&Ye===-1)break}}return Xe}return function(De,Be=null,Ne=!1){this.needsUpdate&&this.update(),De.isExtendedTriangle?De.needsUpdate&&De.update():(H.copy(De),H.update(),De=H);const qe=this.plane,Xe=De.plane;if(Math.abs(qe.normal.dot(Xe.normal))>1-1e-10){const Ye=this.satBounds,Qe=this.satAxes;b[0]=De.a,b[1]=De.b,b[2]=De.c;for(let ct=0;ct<4;ct++){const mt=Ye[ct],_t=Qe[ct];if($.setFromPoints(_t,b),mt.isSeparated($))return!1}const rt=De.satBounds,ot=De.satAxes;_[0]=this.a,_[1]=this.b,_[2]=this.c;for(let ct=0;ct<4;ct++){const mt=rt[ct],_t=ot[ct];if($.setFromPoints(_t,_),mt.isSeparated($))return!1}for(let ct=0;ct<4;ct++){const mt=Qe[ct];for(let _t=0;_t<4;_t++){const Lt=ot[_t];if(re.crossVectors(mt,Lt),$.setFromPoints(re,_),ee.setFromPoints(re,b),$.isSeparated(ee))return!1}}return Be&&(Ne||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),Be.start.set(0,0,0),Be.end.set(0,0,0)),!0}else{const Ye=Ie(this,Xe,Se);if(Ye===1&&De.containsPoint(Se.end))return Be&&(Be.start.copy(Se.end),Be.end.copy(Se.end)),!0;if(Ye!==2)return!1;const Qe=Ie(De,qe,Ee);if(Qe===1&&this.containsPoint(Ee.end))return Be&&(Be.start.copy(Ee.end),Be.end.copy(Ee.end)),!0;if(Qe!==2)return!1;if(Se.delta(xe),Ee.delta(le),xe.dot(le)<0){let Vt=Ee.start;Ee.start=Ee.end,Ee.end=Vt}const rt=Se.start.dot(xe),ot=Se.end.dot(xe),ct=Ee.start.dot(xe),mt=Ee.end.dot(xe),_t=ot<ct,Lt=rt<mt;return rt!==mt&&ct!==ot&&_t===Lt?!1:(Be&&(fe.subVectors(Se.start,Ee.start),fe.dot(xe)>0?Be.start.copy(Se.start):Be.start.copy(Ee.start),fe.subVectors(Se.end,Ee.end),fe.dot(xe)<0?Be.end.copy(Se.end):Be.end.copy(Ee.end)),!0)}}}(),eR.prototype.distanceToPoint=function(){const H=new Vector3;return function(_){return this.closestPointToPoint(_,H),_.distanceTo(H)}}(),eR.prototype.distanceToTriangle=function(){const H=new Vector3,_=new Vector3,b=["a","b","c"],$=new Line3,ee=new Line3;return function(re,ae=null,xe=null){const le=ae||xe?$:null;if(this.intersectsTriangle(re,le))return(ae||xe)&&(ae&&le.getCenter(ae),xe&&le.getCenter(xe)),0;let fe=1/0;for(let ve=0;ve<3;ve++){let Se;const Ee=b[ve],Ce=re[Ee];this.closestPointToPoint(Ce,H),Se=Ce.distanceToSquared(H),Se<fe&&(fe=Se,ae&&ae.copy(H),xe&&xe.copy(Ce));const Ie=this[Ee];re.closestPointToPoint(Ie,H),Se=Ie.distanceToSquared(H),Se<fe&&(fe=Se,ae&&ae.copy(Ie),xe&&xe.copy(H))}for(let ve=0;ve<3;ve++){const Se=b[ve],Ee=b[(ve+1)%3];$.set(this[Se],this[Ee]);for(let Ce=0;Ce<3;Ce++){const Ie=b[Ce],De=b[(Ce+1)%3];ee.set(re[Ie],re[De]),e7($,ee,H,_);const Be=H.distanceToSquared(_);Be<fe&&(fe=Be,ae&&ae.copy(H),xe&&xe.copy(_))}}return Math.sqrt(fe)}}();class eI{constructor(_,b,$){this.isOrientedBox=!0,this.min=new Vector3,this.max=new Vector3,this.matrix=new Matrix4,this.invMatrix=new Matrix4,this.points=new Array(8).fill().map(()=>new Vector3),this.satAxes=new Array(3).fill().map(()=>new Vector3),this.satBounds=new Array(3).fill().map(()=>new e5),this.alignedSatBounds=new Array(3).fill().map(()=>new e5),this.needsUpdate=!1,_&&this.min.copy(_),b&&this.max.copy(b),$&&this.matrix.copy($)}set(_,b,$){this.min.copy(_),this.max.copy(b),this.matrix.copy($),this.needsUpdate=!0}copy(_){this.min.copy(_.min),this.max.copy(_.max),this.matrix.copy(_.matrix),this.needsUpdate=!0}}eI.prototype.update=function(){return function(){const H=this.matrix,_=this.min,b=this.max,$=this.points;for(let le=0;le<=1;le++)for(let fe=0;fe<=1;fe++)for(let ve=0;ve<=1;ve++){const Se=1*le|2*fe|4*ve,Ee=$[Se];Ee.x=le?b.x:_.x,Ee.y=fe?b.y:_.y,Ee.z=ve?b.z:_.z,Ee.applyMatrix4(H)}const ee=this.satBounds,re=this.satAxes,ae=$[0];for(let le=0;le<3;le++){const fe=re[le],ve=ee[le],Se=1<<le,Ee=$[Se];fe.subVectors(ae,Ee),ve.setFromPoints(fe,$)}const xe=this.alignedSatBounds;xe[0].setFromPointsField($,"x"),xe[1].setFromPointsField($,"y"),xe[2].setFromPointsField($,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}(),eI.prototype.intersectsBox=function(){const H=new e5;return function(_){this.needsUpdate&&this.update();const b=_.min,$=_.max,ee=this.satBounds,re=this.satAxes,ae=this.alignedSatBounds;if(H.min=b.x,H.max=$.x,ae[0].isSeparated(H)||(H.min=b.y,H.max=$.y,ae[1].isSeparated(H))||(H.min=b.z,H.max=$.z,ae[2].isSeparated(H)))return!1;for(let xe=0;xe<3;xe++){const le=re[xe],fe=ee[xe];if(H.setFromBox(le,_),fe.isSeparated(H))return!1}return!0}}(),eI.prototype.intersectsTriangle=function(){const H=new eR,_=new Array(3),b=new e5,$=new e5,ee=new Vector3;return function(re){this.needsUpdate&&this.update(),re.isExtendedTriangle?re.needsUpdate&&re.update():(H.copy(re),H.update(),re=H);const ae=this.satBounds,xe=this.satAxes;_[0]=re.a,_[1]=re.b,_[2]=re.c;for(let Se=0;Se<3;Se++){const Ee=ae[Se],Ce=xe[Se];if(b.setFromPoints(Ce,_),Ee.isSeparated(b))return!1}const le=re.satBounds,fe=re.satAxes,ve=this.points;for(let Se=0;Se<3;Se++){const Ee=le[Se],Ce=fe[Se];if(b.setFromPoints(Ce,ve),Ee.isSeparated(b))return!1}for(let Se=0;Se<3;Se++){const Ee=xe[Se];for(let Ce=0;Ce<4;Ce++){const Ie=fe[Ce];if(ee.crossVectors(Ee,Ie),b.setFromPoints(ee,_),$.setFromPoints(ee,ve),b.isSeparated($))return!1}}return!0}}(),eI.prototype.closestPointToPoint=function(){return function(H,_){return this.needsUpdate&&this.update(),_.copy(H).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),_}}(),eI.prototype.distanceToPoint=function(){const H=new Vector3;return function(_){return this.closestPointToPoint(_,H),_.distanceTo(H)}}(),eI.prototype.distanceToBox=function(){const H=["x","y","z"],_=new Array(12).fill().map(()=>new Line3),b=new Array(12).fill().map(()=>new Line3),$=new Vector3,ee=new Vector3;return function(re,ae=0,xe=null,le=null){if(this.needsUpdate&&this.update(),this.intersectsBox(re))return(xe||le)&&(re.getCenter(ee),this.closestPointToPoint(ee,$),re.closestPointToPoint($,ee),xe&&xe.copy($),le&&le.copy(ee)),0;const fe=ae*ae,ve=re.min,Se=re.max,Ee=this.points;let Ce=1/0;for(let De=0;De<8;De++){const Be=Ee[De];ee.copy(Be).clamp(ve,Se);const Ne=Be.distanceToSquared(ee);if(Ne<Ce&&(Ce=Ne,xe&&xe.copy(Be),le&&le.copy(ee),Ne<fe))return Math.sqrt(Ne)}let Ie=0;for(let De=0;De<3;De++)for(let Be=0;Be<=1;Be++)for(let Ne=0;Ne<=1;Ne++){const qe=(De+1)%3,Xe=(De+2)%3,Ye=Be<<qe|Ne<<Xe,Qe=1<<De|Be<<qe|Ne<<Xe,rt=Ee[Ye],ot=Ee[Qe];_[Ie].set(rt,ot);const ct=H[De],mt=H[qe],_t=H[Xe],Lt=b[Ie],Vt=Lt.start,Gt=Lt.end;Vt[ct]=ve[ct],Vt[mt]=Be?ve[mt]:Se[mt],Vt[_t]=Ne?ve[_t]:Se[mt],Gt[ct]=Se[ct],Gt[mt]=Be?ve[mt]:Se[mt],Gt[_t]=Ne?ve[_t]:Se[mt],Ie++}for(let De=0;De<=1;De++)for(let Be=0;Be<=1;Be++)for(let Ne=0;Ne<=1;Ne++){ee.x=De?Se.x:ve.x,ee.y=Be?Se.y:ve.y,ee.z=Ne?Se.z:ve.z,this.closestPointToPoint(ee,$);const qe=ee.distanceToSquared($);if(qe<Ce&&(Ce=qe,xe&&xe.copy($),le&&le.copy(ee),qe<fe))return Math.sqrt(qe)}for(let De=0;De<12;De++){const Be=_[De];for(let Ne=0;Ne<12;Ne++){const qe=b[Ne];e7(Be,qe,$,ee);const Xe=$.distanceToSquared(ee);if(Xe<Ce&&(Ce=Xe,xe&&xe.copy($),le&&le.copy(ee),Xe<fe))return Math.sqrt(Xe)}}return Math.sqrt(Ce)}}();class eZ{constructor(_){this._getNewPrimitive=_,this._primitives=[]}getPrimitive(){const _=this._primitives;return _.length===0?this._getNewPrimitive():_.pop()}releasePrimitive(_){this._primitives.push(_)}}class eU extends eZ{constructor(){super(()=>new eR)}}new eU;class ea{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const _=[];let b=null;this.setBuffer=$=>{b&&_.push(b),b=$,this.float32Array=new Float32Array($),this.uint16Array=new Uint16Array($),this.uint32Array=new Uint32Array($)},this.clearBuffer=()=>{b=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,_.length!==0&&this.setBuffer(_.pop())}}}const eJ=new ea;new Vector3;new Vector3;new Vector3;new Vector3;new Vector3;new Vector2;new Vector2;new Vector2;new Vector3;new Vector3;new Vector3;new Vector3;new Box3;new eR;new eR;new Matrix4;new eI;new eI;new Matrix4;new eI;new eI;new Vector3;new Vector3;new Vector3;new Vector3;new Box3;new eR;new eR;new Matrix4;new eI;new eI;new Matrix4;new eI;new eI;new Vector3;new Vector3;new Vector3;new Vector3;new eJ.constructor;new eJ.constructor;new Box3;new Box3;new Box3;new Box3;new eI;new Box3;function toTrianglesDrawMode(H,_){if(_===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),H;if(_===TriangleFanDrawMode||_===TriangleStripDrawMode){let b=H.getIndex();if(b===null){const ae=[],xe=H.getAttribute("position");if(xe!==void 0){for(let le=0;le<xe.count;le++)ae.push(le);H.setIndex(ae),b=H.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),H}const $=b.count-2,ee=[];if(_===TriangleFanDrawMode)for(let ae=1;ae<=$;ae++)ee.push(b.getX(0)),ee.push(b.getX(ae)),ee.push(b.getX(ae+1));else for(let ae=0;ae<$;ae++)ae%2===0?(ee.push(b.getX(ae)),ee.push(b.getX(ae+1)),ee.push(b.getX(ae+2))):(ee.push(b.getX(ae+2)),ee.push(b.getX(ae+1)),ee.push(b.getX(ae)));ee.length/3!==$&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const re=H.clone();return re.setIndex(ee),re.clearGroups(),re}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",_),H}class GLTFLoader extends Loader{constructor(_){super(_),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(b){return new GLTFMaterialsClearcoatExtension(b)}),this.register(function(b){return new GLTFMaterialsDispersionExtension(b)}),this.register(function(b){return new GLTFTextureBasisUExtension(b)}),this.register(function(b){return new GLTFTextureWebPExtension(b)}),this.register(function(b){return new GLTFTextureAVIFExtension(b)}),this.register(function(b){return new GLTFMaterialsSheenExtension(b)}),this.register(function(b){return new GLTFMaterialsTransmissionExtension(b)}),this.register(function(b){return new GLTFMaterialsVolumeExtension(b)}),this.register(function(b){return new GLTFMaterialsIorExtension(b)}),this.register(function(b){return new GLTFMaterialsEmissiveStrengthExtension(b)}),this.register(function(b){return new GLTFMaterialsSpecularExtension(b)}),this.register(function(b){return new GLTFMaterialsIridescenceExtension(b)}),this.register(function(b){return new GLTFMaterialsAnisotropyExtension(b)}),this.register(function(b){return new GLTFMaterialsBumpExtension(b)}),this.register(function(b){return new GLTFLightsExtension(b)}),this.register(function(b){return new GLTFMeshoptCompression(b)}),this.register(function(b){return new GLTFMeshGpuInstancing(b)})}load(_,b,$,ee){const re=this;let ae;if(this.resourcePath!=="")ae=this.resourcePath;else if(this.path!==""){const fe=LoaderUtils.extractUrlBase(_);ae=LoaderUtils.resolveURL(fe,this.path)}else ae=LoaderUtils.extractUrlBase(_);this.manager.itemStart(_);const xe=function(fe){ee?ee(fe):console.error(fe),re.manager.itemError(_),re.manager.itemEnd(_)},le=new FileLoader(this.manager);le.setPath(this.path),le.setResponseType("arraybuffer"),le.setRequestHeader(this.requestHeader),le.setWithCredentials(this.withCredentials),le.load(_,function(fe){try{re.parse(fe,ae,function(ve){b(ve),re.manager.itemEnd(_)},xe)}catch(ve){xe(ve)}},$,xe)}setDRACOLoader(_){return this.dracoLoader=_,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(_){return this.ktx2Loader=_,this}setMeshoptDecoder(_){return this.meshoptDecoder=_,this}register(_){return this.pluginCallbacks.indexOf(_)===-1&&this.pluginCallbacks.push(_),this}unregister(_){return this.pluginCallbacks.indexOf(_)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(_),1),this}parse(_,b,$,ee){let re;const ae={},xe={},le=new TextDecoder;if(typeof _=="string")re=JSON.parse(_);else if(_ instanceof ArrayBuffer)if(le.decode(new Uint8Array(_,0,4))===BINARY_EXTENSION_HEADER_MAGIC){try{ae[EXTENSIONS.KHR_BINARY_GLTF]=new GLTFBinaryExtension(_)}catch(Se){ee&&ee(Se);return}re=JSON.parse(ae[EXTENSIONS.KHR_BINARY_GLTF].content)}else re=JSON.parse(le.decode(_));else re=_;if(re.asset===void 0||re.asset.version[0]<2){ee&&ee(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const fe=new GLTFParser(re,{path:b||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});fe.fileLoader.setRequestHeader(this.requestHeader);for(let ve=0;ve<this.pluginCallbacks.length;ve++){const Se=this.pluginCallbacks[ve](fe);Se.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),xe[Se.name]=Se,ae[Se.name]=!0}if(re.extensionsUsed)for(let ve=0;ve<re.extensionsUsed.length;++ve){const Se=re.extensionsUsed[ve],Ee=re.extensionsRequired||[];switch(Se){case EXTENSIONS.KHR_MATERIALS_UNLIT:ae[Se]=new GLTFMaterialsUnlitExtension;break;case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:ae[Se]=new GLTFDracoMeshCompressionExtension(re,this.dracoLoader);break;case EXTENSIONS.KHR_TEXTURE_TRANSFORM:ae[Se]=new GLTFTextureTransformExtension;break;case EXTENSIONS.KHR_MESH_QUANTIZATION:ae[Se]=new GLTFMeshQuantizationExtension;break;default:Ee.indexOf(Se)>=0&&xe[Se]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+Se+'".')}}fe.setExtensions(ae),fe.setPlugins(xe),fe.parse($,ee)}parseAsync(_,b){const $=this;return new Promise(function(ee,re){$.parse(_,b,ee,re)})}}function GLTFRegistry(){let H={};return{get:function(_){return H[_]},add:function(_,b){H[_]=b},remove:function(_){delete H[_]},removeAll:function(){H={}}}}const EXTENSIONS={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const _=this.parser,b=this.parser.json.nodes||[];for(let $=0,ee=b.length;$<ee;$++){const re=b[$];re.extensions&&re.extensions[this.name]&&re.extensions[this.name].light!==void 0&&_._addNodeRef(this.cache,re.extensions[this.name].light)}}_loadLight(_){const b=this.parser,$="light:"+_;let ee=b.cache.get($);if(ee)return ee;const re=b.json,le=((re.extensions&&re.extensions[this.name]||{}).lights||[])[_];let fe;const ve=new Color(16777215);le.color!==void 0&&ve.setRGB(le.color[0],le.color[1],le.color[2],LinearSRGBColorSpace);const Se=le.range!==void 0?le.range:0;switch(le.type){case"directional":fe=new DirectionalLight(ve),fe.target.position.set(0,0,-1),fe.add(fe.target);break;case"point":fe=new PointLight(ve),fe.distance=Se;break;case"spot":fe=new SpotLight(ve),fe.distance=Se,le.spot=le.spot||{},le.spot.innerConeAngle=le.spot.innerConeAngle!==void 0?le.spot.innerConeAngle:0,le.spot.outerConeAngle=le.spot.outerConeAngle!==void 0?le.spot.outerConeAngle:Math.PI/4,fe.angle=le.spot.outerConeAngle,fe.penumbra=1-le.spot.innerConeAngle/le.spot.outerConeAngle,fe.target.position.set(0,0,-1),fe.add(fe.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+le.type)}return fe.position.set(0,0,0),fe.decay=2,assignExtrasToUserData(fe,le),le.intensity!==void 0&&(fe.intensity=le.intensity),fe.name=b.createUniqueName(le.name||"light_"+_),ee=Promise.resolve(fe),b.cache.add($,ee),ee}getDependency(_,b){if(_==="light")return this._loadLight(b)}createNodeAttachment(_){const b=this,$=this.parser,re=$.json.nodes[_],xe=(re.extensions&&re.extensions[this.name]||{}).light;return xe===void 0?null:this._loadLight(xe).then(function(le){return $._getNodeRef(b.cache,xe,le)})}}class GLTFMaterialsUnlitExtension{constructor(){this.name=EXTENSIONS.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial}extendParams(_,b,$){const ee=[];_.color=new Color(1,1,1),_.opacity=1;const re=b.pbrMetallicRoughness;if(re){if(Array.isArray(re.baseColorFactor)){const ae=re.baseColorFactor;_.color.setRGB(ae[0],ae[1],ae[2],LinearSRGBColorSpace),_.opacity=ae[3]}re.baseColorTexture!==void 0&&ee.push($.assignTexture(_,"map",re.baseColorTexture,SRGBColorSpace))}return Promise.all(ee)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(_,b){const ee=this.parser.json.materials[_];if(!ee.extensions||!ee.extensions[this.name])return Promise.resolve();const re=ee.extensions[this.name].emissiveStrength;return re!==void 0&&(b.emissiveIntensity=re),Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_CLEARCOAT}getMaterialType(_){const $=this.parser.json.materials[_];return!$.extensions||!$.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,b){const $=this.parser,ee=$.json.materials[_];if(!ee.extensions||!ee.extensions[this.name])return Promise.resolve();const re=[],ae=ee.extensions[this.name];if(ae.clearcoatFactor!==void 0&&(b.clearcoat=ae.clearcoatFactor),ae.clearcoatTexture!==void 0&&re.push($.assignTexture(b,"clearcoatMap",ae.clearcoatTexture)),ae.clearcoatRoughnessFactor!==void 0&&(b.clearcoatRoughness=ae.clearcoatRoughnessFactor),ae.clearcoatRoughnessTexture!==void 0&&re.push($.assignTexture(b,"clearcoatRoughnessMap",ae.clearcoatRoughnessTexture)),ae.clearcoatNormalTexture!==void 0&&(re.push($.assignTexture(b,"clearcoatNormalMap",ae.clearcoatNormalTexture)),ae.clearcoatNormalTexture.scale!==void 0)){const xe=ae.clearcoatNormalTexture.scale;b.clearcoatNormalScale=new Vector2(xe,xe)}return Promise.all(re)}}class GLTFMaterialsDispersionExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_DISPERSION}getMaterialType(_){const $=this.parser.json.materials[_];return!$.extensions||!$.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,b){const ee=this.parser.json.materials[_];if(!ee.extensions||!ee.extensions[this.name])return Promise.resolve();const re=ee.extensions[this.name];return b.dispersion=re.dispersion!==void 0?re.dispersion:0,Promise.resolve()}}class GLTFMaterialsIridescenceExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_IRIDESCENCE}getMaterialType(_){const $=this.parser.json.materials[_];return!$.extensions||!$.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,b){const $=this.parser,ee=$.json.materials[_];if(!ee.extensions||!ee.extensions[this.name])return Promise.resolve();const re=[],ae=ee.extensions[this.name];return ae.iridescenceFactor!==void 0&&(b.iridescence=ae.iridescenceFactor),ae.iridescenceTexture!==void 0&&re.push($.assignTexture(b,"iridescenceMap",ae.iridescenceTexture)),ae.iridescenceIor!==void 0&&(b.iridescenceIOR=ae.iridescenceIor),b.iridescenceThicknessRange===void 0&&(b.iridescenceThicknessRange=[100,400]),ae.iridescenceThicknessMinimum!==void 0&&(b.iridescenceThicknessRange[0]=ae.iridescenceThicknessMinimum),ae.iridescenceThicknessMaximum!==void 0&&(b.iridescenceThicknessRange[1]=ae.iridescenceThicknessMaximum),ae.iridescenceThicknessTexture!==void 0&&re.push($.assignTexture(b,"iridescenceThicknessMap",ae.iridescenceThicknessTexture)),Promise.all(re)}}class GLTFMaterialsSheenExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_SHEEN}getMaterialType(_){const $=this.parser.json.materials[_];return!$.extensions||!$.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,b){const $=this.parser,ee=$.json.materials[_];if(!ee.extensions||!ee.extensions[this.name])return Promise.resolve();const re=[];b.sheenColor=new Color(0,0,0),b.sheenRoughness=0,b.sheen=1;const ae=ee.extensions[this.name];if(ae.sheenColorFactor!==void 0){const xe=ae.sheenColorFactor;b.sheenColor.setRGB(xe[0],xe[1],xe[2],LinearSRGBColorSpace)}return ae.sheenRoughnessFactor!==void 0&&(b.sheenRoughness=ae.sheenRoughnessFactor),ae.sheenColorTexture!==void 0&&re.push($.assignTexture(b,"sheenColorMap",ae.sheenColorTexture,SRGBColorSpace)),ae.sheenRoughnessTexture!==void 0&&re.push($.assignTexture(b,"sheenRoughnessMap",ae.sheenRoughnessTexture)),Promise.all(re)}}class GLTFMaterialsTransmissionExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_TRANSMISSION}getMaterialType(_){const $=this.parser.json.materials[_];return!$.extensions||!$.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,b){const $=this.parser,ee=$.json.materials[_];if(!ee.extensions||!ee.extensions[this.name])return Promise.resolve();const re=[],ae=ee.extensions[this.name];return ae.transmissionFactor!==void 0&&(b.transmission=ae.transmissionFactor),ae.transmissionTexture!==void 0&&re.push($.assignTexture(b,"transmissionMap",ae.transmissionTexture)),Promise.all(re)}}class GLTFMaterialsVolumeExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_VOLUME}getMaterialType(_){const $=this.parser.json.materials[_];return!$.extensions||!$.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,b){const $=this.parser,ee=$.json.materials[_];if(!ee.extensions||!ee.extensions[this.name])return Promise.resolve();const re=[],ae=ee.extensions[this.name];b.thickness=ae.thicknessFactor!==void 0?ae.thicknessFactor:0,ae.thicknessTexture!==void 0&&re.push($.assignTexture(b,"thicknessMap",ae.thicknessTexture)),b.attenuationDistance=ae.attenuationDistance||1/0;const xe=ae.attenuationColor||[1,1,1];return b.attenuationColor=new Color().setRGB(xe[0],xe[1],xe[2],LinearSRGBColorSpace),Promise.all(re)}}class GLTFMaterialsIorExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_IOR}getMaterialType(_){const $=this.parser.json.materials[_];return!$.extensions||!$.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,b){const ee=this.parser.json.materials[_];if(!ee.extensions||!ee.extensions[this.name])return Promise.resolve();const re=ee.extensions[this.name];return b.ior=re.ior!==void 0?re.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_SPECULAR}getMaterialType(_){const $=this.parser.json.materials[_];return!$.extensions||!$.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,b){const $=this.parser,ee=$.json.materials[_];if(!ee.extensions||!ee.extensions[this.name])return Promise.resolve();const re=[],ae=ee.extensions[this.name];b.specularIntensity=ae.specularFactor!==void 0?ae.specularFactor:1,ae.specularTexture!==void 0&&re.push($.assignTexture(b,"specularIntensityMap",ae.specularTexture));const xe=ae.specularColorFactor||[1,1,1];return b.specularColor=new Color().setRGB(xe[0],xe[1],xe[2],LinearSRGBColorSpace),ae.specularColorTexture!==void 0&&re.push($.assignTexture(b,"specularColorMap",ae.specularColorTexture,SRGBColorSpace)),Promise.all(re)}}class GLTFMaterialsBumpExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.EXT_MATERIALS_BUMP}getMaterialType(_){const $=this.parser.json.materials[_];return!$.extensions||!$.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,b){const $=this.parser,ee=$.json.materials[_];if(!ee.extensions||!ee.extensions[this.name])return Promise.resolve();const re=[],ae=ee.extensions[this.name];return b.bumpScale=ae.bumpFactor!==void 0?ae.bumpFactor:1,ae.bumpTexture!==void 0&&re.push($.assignTexture(b,"bumpMap",ae.bumpTexture)),Promise.all(re)}}class GLTFMaterialsAnisotropyExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_ANISOTROPY}getMaterialType(_){const $=this.parser.json.materials[_];return!$.extensions||!$.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,b){const $=this.parser,ee=$.json.materials[_];if(!ee.extensions||!ee.extensions[this.name])return Promise.resolve();const re=[],ae=ee.extensions[this.name];return ae.anisotropyStrength!==void 0&&(b.anisotropy=ae.anisotropyStrength),ae.anisotropyRotation!==void 0&&(b.anisotropyRotation=ae.anisotropyRotation),ae.anisotropyTexture!==void 0&&re.push($.assignTexture(b,"anisotropyMap",ae.anisotropyTexture)),Promise.all(re)}}class GLTFTextureBasisUExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_TEXTURE_BASISU}loadTexture(_){const b=this.parser,$=b.json,ee=$.textures[_];if(!ee.extensions||!ee.extensions[this.name])return null;const re=ee.extensions[this.name],ae=b.options.ktx2Loader;if(!ae){if($.extensionsRequired&&$.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return b.loadTextureImage(_,re.source,ae)}}class GLTFTextureWebPExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(_){const b=this.name,$=this.parser,ee=$.json,re=ee.textures[_];if(!re.extensions||!re.extensions[b])return null;const ae=re.extensions[b],xe=ee.images[ae.source];let le=$.textureLoader;if(xe.uri){const fe=$.options.manager.getHandler(xe.uri);fe!==null&&(le=fe)}return this.detectSupport().then(function(fe){if(fe)return $.loadTextureImage(_,ae.source,le);if(ee.extensionsRequired&&ee.extensionsRequired.indexOf(b)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return $.loadTexture(_)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_){const b=new Image;b.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",b.onload=b.onerror=function(){_(b.height===1)}})),this.isSupported}}class GLTFTextureAVIFExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(_){const b=this.name,$=this.parser,ee=$.json,re=ee.textures[_];if(!re.extensions||!re.extensions[b])return null;const ae=re.extensions[b],xe=ee.images[ae.source];let le=$.textureLoader;if(xe.uri){const fe=$.options.manager.getHandler(xe.uri);fe!==null&&(le=fe)}return this.detectSupport().then(function(fe){if(fe)return $.loadTextureImage(_,ae.source,le);if(ee.extensionsRequired&&ee.extensionsRequired.indexOf(b)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return $.loadTexture(_)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_){const b=new Image;b.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",b.onload=b.onerror=function(){_(b.height===1)}})),this.isSupported}}class GLTFMeshoptCompression{constructor(_){this.name=EXTENSIONS.EXT_MESHOPT_COMPRESSION,this.parser=_}loadBufferView(_){const b=this.parser.json,$=b.bufferViews[_];if($.extensions&&$.extensions[this.name]){const ee=$.extensions[this.name],re=this.parser.getDependency("buffer",ee.buffer),ae=this.parser.options.meshoptDecoder;if(!ae||!ae.supported){if(b.extensionsRequired&&b.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return re.then(function(xe){const le=ee.byteOffset||0,fe=ee.byteLength||0,ve=ee.count,Se=ee.byteStride,Ee=new Uint8Array(xe,le,fe);return ae.decodeGltfBufferAsync?ae.decodeGltfBufferAsync(ve,Se,Ee,ee.mode,ee.filter).then(function(Ce){return Ce.buffer}):ae.ready.then(function(){const Ce=new ArrayBuffer(ve*Se);return ae.decodeGltfBuffer(new Uint8Array(Ce),ve,Se,Ee,ee.mode,ee.filter),Ce})})}else return null}}class GLTFMeshGpuInstancing{constructor(_){this.name=EXTENSIONS.EXT_MESH_GPU_INSTANCING,this.parser=_}createNodeMesh(_){const b=this.parser.json,$=b.nodes[_];if(!$.extensions||!$.extensions[this.name]||$.mesh===void 0)return null;const ee=b.meshes[$.mesh];for(const fe of ee.primitives)if(fe.mode!==WEBGL_CONSTANTS.TRIANGLES&&fe.mode!==WEBGL_CONSTANTS.TRIANGLE_STRIP&&fe.mode!==WEBGL_CONSTANTS.TRIANGLE_FAN&&fe.mode!==void 0)return null;const ae=$.extensions[this.name].attributes,xe=[],le={};for(const fe in ae)xe.push(this.parser.getDependency("accessor",ae[fe]).then(ve=>(le[fe]=ve,le[fe])));return xe.length<1?null:(xe.push(this.parser.createNodeMesh(_)),Promise.all(xe).then(fe=>{const ve=fe.pop(),Se=ve.isGroup?ve.children:[ve],Ee=fe[0].count,Ce=[];for(const Ie of Se){const De=new Matrix4,Be=new Vector3,Ne=new Quaternion,qe=new Vector3(1,1,1),Xe=new InstancedMesh(Ie.geometry,Ie.material,Ee);for(let Ye=0;Ye<Ee;Ye++)le.TRANSLATION&&Be.fromBufferAttribute(le.TRANSLATION,Ye),le.ROTATION&&Ne.fromBufferAttribute(le.ROTATION,Ye),le.SCALE&&qe.fromBufferAttribute(le.SCALE,Ye),Xe.setMatrixAt(Ye,De.compose(Be,Ne,qe));for(const Ye in le)if(Ye==="_COLOR_0"){const Qe=le[Ye];Xe.instanceColor=new InstancedBufferAttribute(Qe.array,Qe.itemSize,Qe.normalized)}else Ye!=="TRANSLATION"&&Ye!=="ROTATION"&&Ye!=="SCALE"&&Ie.geometry.setAttribute(Ye,le[Ye]);Object3D.prototype.copy.call(Xe,Ie),this.parser.assignFinalMaterial(Xe),Ce.push(Xe)}return ve.isGroup?(ve.clear(),ve.add(...Ce),ve):Ce[0]}))}}const BINARY_EXTENSION_HEADER_MAGIC="glTF",BINARY_EXTENSION_HEADER_LENGTH=12,BINARY_EXTENSION_CHUNK_TYPES={JSON:1313821514,BIN:5130562};class GLTFBinaryExtension{constructor(_){this.name=EXTENSIONS.KHR_BINARY_GLTF,this.content=null,this.body=null;const b=new DataView(_,0,BINARY_EXTENSION_HEADER_LENGTH),$=new TextDecoder;if(this.header={magic:$.decode(new Uint8Array(_.slice(0,4))),version:b.getUint32(4,!0),length:b.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const ee=this.header.length-BINARY_EXTENSION_HEADER_LENGTH,re=new DataView(_,BINARY_EXTENSION_HEADER_LENGTH);let ae=0;for(;ae<ee;){const xe=re.getUint32(ae,!0);ae+=4;const le=re.getUint32(ae,!0);if(ae+=4,le===BINARY_EXTENSION_CHUNK_TYPES.JSON){const fe=new Uint8Array(_,BINARY_EXTENSION_HEADER_LENGTH+ae,xe);this.content=$.decode(fe)}else if(le===BINARY_EXTENSION_CHUNK_TYPES.BIN){const fe=BINARY_EXTENSION_HEADER_LENGTH+ae;this.body=_.slice(fe,fe+xe)}ae+=xe}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(_,b){if(!b)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS.KHR_DRACO_MESH_COMPRESSION,this.json=_,this.dracoLoader=b,this.dracoLoader.preload()}decodePrimitive(_,b){const $=this.json,ee=this.dracoLoader,re=_.extensions[this.name].bufferView,ae=_.extensions[this.name].attributes,xe={},le={},fe={};for(const ve in ae){const Se=ATTRIBUTES[ve]||ve.toLowerCase();xe[Se]=ae[ve]}for(const ve in _.attributes){const Se=ATTRIBUTES[ve]||ve.toLowerCase();if(ae[ve]!==void 0){const Ee=$.accessors[_.attributes[ve]],Ce=WEBGL_COMPONENT_TYPES[Ee.componentType];fe[Se]=Ce.name,le[Se]=Ee.normalized===!0}}return b.getDependency("bufferView",re).then(function(ve){return new Promise(function(Se,Ee){ee.decodeDracoFile(ve,function(Ce){for(const Ie in Ce.attributes){const De=Ce.attributes[Ie],Be=le[Ie];Be!==void 0&&(De.normalized=Be)}Se(Ce)},xe,fe,LinearSRGBColorSpace,Ee)})})}}class GLTFTextureTransformExtension{constructor(){this.name=EXTENSIONS.KHR_TEXTURE_TRANSFORM}extendTexture(_,b){return(b.texCoord===void 0||b.texCoord===_.channel)&&b.offset===void 0&&b.rotation===void 0&&b.scale===void 0||(_=_.clone(),b.texCoord!==void 0&&(_.channel=b.texCoord),b.offset!==void 0&&_.offset.fromArray(b.offset),b.rotation!==void 0&&(_.rotation=b.rotation),b.scale!==void 0&&_.repeat.fromArray(b.scale),_.needsUpdate=!0),_}}class GLTFMeshQuantizationExtension{constructor(){this.name=EXTENSIONS.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends Interpolant{constructor(_,b,$,ee){super(_,b,$,ee)}copySampleValue_(_){const b=this.resultBuffer,$=this.sampleValues,ee=this.valueSize,re=_*ee*3+ee;for(let ae=0;ae!==ee;ae++)b[ae]=$[re+ae];return b}interpolate_(_,b,$,ee){const re=this.resultBuffer,ae=this.sampleValues,xe=this.valueSize,le=xe*2,fe=xe*3,ve=ee-b,Se=($-b)/ve,Ee=Se*Se,Ce=Ee*Se,Ie=_*fe,De=Ie-fe,Be=-2*Ce+3*Ee,Ne=Ce-Ee,qe=1-Be,Xe=Ne-Ee+Se;for(let Ye=0;Ye!==xe;Ye++){const Qe=ae[De+Ye+xe],rt=ae[De+Ye+le]*ve,ot=ae[Ie+Ye+xe],ct=ae[Ie+Ye]*ve;re[Ye]=qe*Qe+Xe*rt+Be*ot+Ne*ct}return re}}const _q=new Quaternion;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(_,b,$,ee){const re=super.interpolate_(_,b,$,ee);return _q.fromArray(re).normalize().toArray(re),re}}const WEBGL_CONSTANTS={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial(H){return H.DefaultMaterial===void 0&&(H.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),H.DefaultMaterial}function addUnknownExtensionsToUserData(H,_,b){for(const $ in b.extensions)H[$]===void 0&&(_.userData.gltfExtensions=_.userData.gltfExtensions||{},_.userData.gltfExtensions[$]=b.extensions[$])}function assignExtrasToUserData(H,_){_.extras!==void 0&&(typeof _.extras=="object"?Object.assign(H.userData,_.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+_.extras))}function addMorphTargets(H,_,b){let $=!1,ee=!1,re=!1;for(let fe=0,ve=_.length;fe<ve;fe++){const Se=_[fe];if(Se.POSITION!==void 0&&($=!0),Se.NORMAL!==void 0&&(ee=!0),Se.COLOR_0!==void 0&&(re=!0),$&&ee&&re)break}if(!$&&!ee&&!re)return Promise.resolve(H);const ae=[],xe=[],le=[];for(let fe=0,ve=_.length;fe<ve;fe++){const Se=_[fe];if($){const Ee=Se.POSITION!==void 0?b.getDependency("accessor",Se.POSITION):H.attributes.position;ae.push(Ee)}if(ee){const Ee=Se.NORMAL!==void 0?b.getDependency("accessor",Se.NORMAL):H.attributes.normal;xe.push(Ee)}if(re){const Ee=Se.COLOR_0!==void 0?b.getDependency("accessor",Se.COLOR_0):H.attributes.color;le.push(Ee)}}return Promise.all([Promise.all(ae),Promise.all(xe),Promise.all(le)]).then(function(fe){const ve=fe[0],Se=fe[1],Ee=fe[2];return $&&(H.morphAttributes.position=ve),ee&&(H.morphAttributes.normal=Se),re&&(H.morphAttributes.color=Ee),H.morphTargetsRelative=!0,H})}function updateMorphTargets(H,_){if(H.updateMorphTargets(),_.weights!==void 0)for(let b=0,$=_.weights.length;b<$;b++)H.morphTargetInfluences[b]=_.weights[b];if(_.extras&&Array.isArray(_.extras.targetNames)){const b=_.extras.targetNames;if(H.morphTargetInfluences.length===b.length){H.morphTargetDictionary={};for(let $=0,ee=b.length;$<ee;$++)H.morphTargetDictionary[b[$]]=$}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(H){let _;const b=H.extensions&&H.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];if(b?_="draco:"+b.bufferView+":"+b.indices+":"+createAttributesKey(b.attributes):_=H.indices+":"+createAttributesKey(H.attributes)+":"+H.mode,H.targets!==void 0)for(let $=0,ee=H.targets.length;$<ee;$++)_+=":"+createAttributesKey(H.targets[$]);return _}function createAttributesKey(H){let _="";const b=Object.keys(H).sort();for(let $=0,ee=b.length;$<ee;$++)_+=b[$]+":"+H[b[$]]+";";return _}function getNormalizedComponentScale(H){switch(H){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType(H){return H.search(/\.jpe?g($|\?)/i)>0||H.search(/^data\:image\/jpeg/)===0?"image/jpeg":H.search(/\.webp($|\?)/i)>0||H.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _identityMatrix=new Matrix4;class GLTFParser{constructor(_={},b={}){this.json=_,this.extensions={},this.plugins={},this.options=b,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let $=!1,ee=-1,re=!1,ae=-1;if(typeof navigator<"u"){const xe=navigator.userAgent;$=/^((?!chrome|android).)*safari/i.test(xe)===!0;const le=xe.match(/Version\/(\d+)/);ee=$&&le?parseInt(le[1],10):-1,re=xe.indexOf("Firefox")>-1,ae=re?xe.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||$&&ee<17||re&&ae<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(_){this.extensions=_}setPlugins(_){this.plugins=_}parse(_,b){const $=this,ee=this.json,re=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(ae){return ae._markDefs&&ae._markDefs()}),Promise.all(this._invokeAll(function(ae){return ae.beforeRoot&&ae.beforeRoot()})).then(function(){return Promise.all([$.getDependencies("scene"),$.getDependencies("animation"),$.getDependencies("camera")])}).then(function(ae){const xe={scene:ae[0][ee.scene||0],scenes:ae[0],animations:ae[1],cameras:ae[2],asset:ee.asset,parser:$,userData:{}};return addUnknownExtensionsToUserData(re,xe,ee),assignExtrasToUserData(xe,ee),Promise.all($._invokeAll(function(le){return le.afterRoot&&le.afterRoot(xe)})).then(function(){for(const le of xe.scenes)le.updateMatrixWorld();_(xe)})}).catch(b)}_markDefs(){const _=this.json.nodes||[],b=this.json.skins||[],$=this.json.meshes||[];for(let ee=0,re=b.length;ee<re;ee++){const ae=b[ee].joints;for(let xe=0,le=ae.length;xe<le;xe++)_[ae[xe]].isBone=!0}for(let ee=0,re=_.length;ee<re;ee++){const ae=_[ee];ae.mesh!==void 0&&(this._addNodeRef(this.meshCache,ae.mesh),ae.skin!==void 0&&($[ae.mesh].isSkinnedMesh=!0)),ae.camera!==void 0&&this._addNodeRef(this.cameraCache,ae.camera)}}_addNodeRef(_,b){b!==void 0&&(_.refs[b]===void 0&&(_.refs[b]=_.uses[b]=0),_.refs[b]++)}_getNodeRef(_,b,$){if(_.refs[b]<=1)return $;const ee=$.clone(),re=(ae,xe)=>{const le=this.associations.get(ae);le!=null&&this.associations.set(xe,le);for(const[fe,ve]of ae.children.entries())re(ve,xe.children[fe])};return re($,ee),ee.name+="_instance_"+_.uses[b]++,ee}_invokeOne(_){const b=Object.values(this.plugins);b.push(this);for(let $=0;$<b.length;$++){const ee=_(b[$]);if(ee)return ee}return null}_invokeAll(_){const b=Object.values(this.plugins);b.unshift(this);const $=[];for(let ee=0;ee<b.length;ee++){const re=_(b[ee]);re&&$.push(re)}return $}getDependency(_,b){const $=_+":"+b;let ee=this.cache.get($);if(!ee){switch(_){case"scene":ee=this.loadScene(b);break;case"node":ee=this._invokeOne(function(re){return re.loadNode&&re.loadNode(b)});break;case"mesh":ee=this._invokeOne(function(re){return re.loadMesh&&re.loadMesh(b)});break;case"accessor":ee=this.loadAccessor(b);break;case"bufferView":ee=this._invokeOne(function(re){return re.loadBufferView&&re.loadBufferView(b)});break;case"buffer":ee=this.loadBuffer(b);break;case"material":ee=this._invokeOne(function(re){return re.loadMaterial&&re.loadMaterial(b)});break;case"texture":ee=this._invokeOne(function(re){return re.loadTexture&&re.loadTexture(b)});break;case"skin":ee=this.loadSkin(b);break;case"animation":ee=this._invokeOne(function(re){return re.loadAnimation&&re.loadAnimation(b)});break;case"camera":ee=this.loadCamera(b);break;default:if(ee=this._invokeOne(function(re){return re!=this&&re.getDependency&&re.getDependency(_,b)}),!ee)throw new Error("Unknown type: "+_);break}this.cache.add($,ee)}return ee}getDependencies(_){let b=this.cache.get(_);if(!b){const $=this,ee=this.json[_+(_==="mesh"?"es":"s")]||[];b=Promise.all(ee.map(function(re,ae){return $.getDependency(_,ae)})),this.cache.add(_,b)}return b}loadBuffer(_){const b=this.json.buffers[_],$=this.fileLoader;if(b.type&&b.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+b.type+" buffer type is not supported.");if(b.uri===void 0&&_===0)return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);const ee=this.options;return new Promise(function(re,ae){$.load(LoaderUtils.resolveURL(b.uri,ee.path),re,void 0,function(){ae(new Error('THREE.GLTFLoader: Failed to load buffer "'+b.uri+'".'))})})}loadBufferView(_){const b=this.json.bufferViews[_];return this.getDependency("buffer",b.buffer).then(function($){const ee=b.byteLength||0,re=b.byteOffset||0;return $.slice(re,re+ee)})}loadAccessor(_){const b=this,$=this.json,ee=this.json.accessors[_];if(ee.bufferView===void 0&&ee.sparse===void 0){const ae=WEBGL_TYPE_SIZES[ee.type],xe=WEBGL_COMPONENT_TYPES[ee.componentType],le=ee.normalized===!0,fe=new xe(ee.count*ae);return Promise.resolve(new BufferAttribute(fe,ae,le))}const re=[];return ee.bufferView!==void 0?re.push(this.getDependency("bufferView",ee.bufferView)):re.push(null),ee.sparse!==void 0&&(re.push(this.getDependency("bufferView",ee.sparse.indices.bufferView)),re.push(this.getDependency("bufferView",ee.sparse.values.bufferView))),Promise.all(re).then(function(ae){const xe=ae[0],le=WEBGL_TYPE_SIZES[ee.type],fe=WEBGL_COMPONENT_TYPES[ee.componentType],ve=fe.BYTES_PER_ELEMENT,Se=ve*le,Ee=ee.byteOffset||0,Ce=ee.bufferView!==void 0?$.bufferViews[ee.bufferView].byteStride:void 0,Ie=ee.normalized===!0;let De,Be;if(Ce&&Ce!==Se){const Ne=Math.floor(Ee/Ce),qe="InterleavedBuffer:"+ee.bufferView+":"+ee.componentType+":"+Ne+":"+ee.count;let Xe=b.cache.get(qe);Xe||(De=new fe(xe,Ne*Ce,ee.count*Ce/ve),Xe=new InterleavedBuffer(De,Ce/ve),b.cache.add(qe,Xe)),Be=new InterleavedBufferAttribute(Xe,le,Ee%Ce/ve,Ie)}else xe===null?De=new fe(ee.count*le):De=new fe(xe,Ee,ee.count*le),Be=new BufferAttribute(De,le,Ie);if(ee.sparse!==void 0){const Ne=WEBGL_TYPE_SIZES.SCALAR,qe=WEBGL_COMPONENT_TYPES[ee.sparse.indices.componentType],Xe=ee.sparse.indices.byteOffset||0,Ye=ee.sparse.values.byteOffset||0,Qe=new qe(ae[1],Xe,ee.sparse.count*Ne),rt=new fe(ae[2],Ye,ee.sparse.count*le);xe!==null&&(Be=new BufferAttribute(Be.array.slice(),Be.itemSize,Be.normalized));for(let ot=0,ct=Qe.length;ot<ct;ot++){const mt=Qe[ot];if(Be.setX(mt,rt[ot*le]),le>=2&&Be.setY(mt,rt[ot*le+1]),le>=3&&Be.setZ(mt,rt[ot*le+2]),le>=4&&Be.setW(mt,rt[ot*le+3]),le>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return Be})}loadTexture(_){const b=this.json,$=this.options,re=b.textures[_].source,ae=b.images[re];let xe=this.textureLoader;if(ae.uri){const le=$.manager.getHandler(ae.uri);le!==null&&(xe=le)}return this.loadTextureImage(_,re,xe)}loadTextureImage(_,b,$){const ee=this,re=this.json,ae=re.textures[_],xe=re.images[b],le=(xe.uri||xe.bufferView)+":"+ae.sampler;if(this.textureCache[le])return this.textureCache[le];const fe=this.loadImageSource(b,$).then(function(ve){ve.flipY=!1,ve.name=ae.name||xe.name||"",ve.name===""&&typeof xe.uri=="string"&&xe.uri.startsWith("data:image/")===!1&&(ve.name=xe.uri);const Ee=(re.samplers||{})[ae.sampler]||{};return ve.magFilter=WEBGL_FILTERS[Ee.magFilter]||LinearFilter,ve.minFilter=WEBGL_FILTERS[Ee.minFilter]||LinearMipmapLinearFilter,ve.wrapS=WEBGL_WRAPPINGS[Ee.wrapS]||RepeatWrapping,ve.wrapT=WEBGL_WRAPPINGS[Ee.wrapT]||RepeatWrapping,ee.associations.set(ve,{textures:_}),ve}).catch(function(){return null});return this.textureCache[le]=fe,fe}loadImageSource(_,b){const $=this,ee=this.json,re=this.options;if(this.sourceCache[_]!==void 0)return this.sourceCache[_].then(Se=>Se.clone());const ae=ee.images[_],xe=self.URL||self.webkitURL;let le=ae.uri||"",fe=!1;if(ae.bufferView!==void 0)le=$.getDependency("bufferView",ae.bufferView).then(function(Se){fe=!0;const Ee=new Blob([Se],{type:ae.mimeType});return le=xe.createObjectURL(Ee),le});else if(ae.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+_+" is missing URI and bufferView");const ve=Promise.resolve(le).then(function(Se){return new Promise(function(Ee,Ce){let Ie=Ee;b.isImageBitmapLoader===!0&&(Ie=function(De){const Be=new Texture(De);Be.needsUpdate=!0,Ee(Be)}),b.load(LoaderUtils.resolveURL(Se,re.path),Ie,void 0,Ce)})}).then(function(Se){return fe===!0&&xe.revokeObjectURL(le),assignExtrasToUserData(Se,ae),Se.userData.mimeType=ae.mimeType||getImageURIMimeType(ae.uri),Se}).catch(function(Se){throw console.error("THREE.GLTFLoader: Couldn't load texture",le),Se});return this.sourceCache[_]=ve,ve}assignTexture(_,b,$,ee){const re=this;return this.getDependency("texture",$.index).then(function(ae){if(!ae)return null;if($.texCoord!==void 0&&$.texCoord>0&&(ae=ae.clone(),ae.channel=$.texCoord),re.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]){const xe=$.extensions!==void 0?$.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;if(xe){const le=re.associations.get(ae);ae=re.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(ae,xe),re.associations.set(ae,le)}}return ee!==void 0&&(ae.colorSpace=ee),_[b]=ae,ae})}assignFinalMaterial(_){const b=_.geometry;let $=_.material;const ee=b.attributes.tangent===void 0,re=b.attributes.color!==void 0,ae=b.attributes.normal===void 0;if(_.isPoints){const xe="PointsMaterial:"+$.uuid;let le=this.cache.get(xe);le||(le=new PointsMaterial,Material.prototype.copy.call(le,$),le.color.copy($.color),le.map=$.map,le.sizeAttenuation=!1,this.cache.add(xe,le)),$=le}else if(_.isLine){const xe="LineBasicMaterial:"+$.uuid;let le=this.cache.get(xe);le||(le=new LineBasicMaterial,Material.prototype.copy.call(le,$),le.color.copy($.color),le.map=$.map,this.cache.add(xe,le)),$=le}if(ee||re||ae){let xe="ClonedMaterial:"+$.uuid+":";ee&&(xe+="derivative-tangents:"),re&&(xe+="vertex-colors:"),ae&&(xe+="flat-shading:");let le=this.cache.get(xe);le||(le=$.clone(),re&&(le.vertexColors=!0),ae&&(le.flatShading=!0),ee&&(le.normalScale&&(le.normalScale.y*=-1),le.clearcoatNormalScale&&(le.clearcoatNormalScale.y*=-1)),this.cache.add(xe,le),this.associations.set(le,this.associations.get($))),$=le}_.material=$}getMaterialType(){return MeshStandardMaterial}loadMaterial(_){const b=this,$=this.json,ee=this.extensions,re=$.materials[_];let ae;const xe={},le=re.extensions||{},fe=[];if(le[EXTENSIONS.KHR_MATERIALS_UNLIT]){const Se=ee[EXTENSIONS.KHR_MATERIALS_UNLIT];ae=Se.getMaterialType(),fe.push(Se.extendParams(xe,re,b))}else{const Se=re.pbrMetallicRoughness||{};if(xe.color=new Color(1,1,1),xe.opacity=1,Array.isArray(Se.baseColorFactor)){const Ee=Se.baseColorFactor;xe.color.setRGB(Ee[0],Ee[1],Ee[2],LinearSRGBColorSpace),xe.opacity=Ee[3]}Se.baseColorTexture!==void 0&&fe.push(b.assignTexture(xe,"map",Se.baseColorTexture,SRGBColorSpace)),xe.metalness=Se.metallicFactor!==void 0?Se.metallicFactor:1,xe.roughness=Se.roughnessFactor!==void 0?Se.roughnessFactor:1,Se.metallicRoughnessTexture!==void 0&&(fe.push(b.assignTexture(xe,"metalnessMap",Se.metallicRoughnessTexture)),fe.push(b.assignTexture(xe,"roughnessMap",Se.metallicRoughnessTexture))),ae=this._invokeOne(function(Ee){return Ee.getMaterialType&&Ee.getMaterialType(_)}),fe.push(Promise.all(this._invokeAll(function(Ee){return Ee.extendMaterialParams&&Ee.extendMaterialParams(_,xe)})))}re.doubleSided===!0&&(xe.side=DoubleSide);const ve=re.alphaMode||ALPHA_MODES.OPAQUE;if(ve===ALPHA_MODES.BLEND?(xe.transparent=!0,xe.depthWrite=!1):(xe.transparent=!1,ve===ALPHA_MODES.MASK&&(xe.alphaTest=re.alphaCutoff!==void 0?re.alphaCutoff:.5)),re.normalTexture!==void 0&&ae!==MeshBasicMaterial&&(fe.push(b.assignTexture(xe,"normalMap",re.normalTexture)),xe.normalScale=new Vector2(1,1),re.normalTexture.scale!==void 0)){const Se=re.normalTexture.scale;xe.normalScale.set(Se,Se)}if(re.occlusionTexture!==void 0&&ae!==MeshBasicMaterial&&(fe.push(b.assignTexture(xe,"aoMap",re.occlusionTexture)),re.occlusionTexture.strength!==void 0&&(xe.aoMapIntensity=re.occlusionTexture.strength)),re.emissiveFactor!==void 0&&ae!==MeshBasicMaterial){const Se=re.emissiveFactor;xe.emissive=new Color().setRGB(Se[0],Se[1],Se[2],LinearSRGBColorSpace)}return re.emissiveTexture!==void 0&&ae!==MeshBasicMaterial&&fe.push(b.assignTexture(xe,"emissiveMap",re.emissiveTexture,SRGBColorSpace)),Promise.all(fe).then(function(){const Se=new ae(xe);return re.name&&(Se.name=re.name),assignExtrasToUserData(Se,re),b.associations.set(Se,{materials:_}),re.extensions&&addUnknownExtensionsToUserData(ee,Se,re),Se})}createUniqueName(_){const b=PropertyBinding.sanitizeNodeName(_||"");return b in this.nodeNamesUsed?b+"_"+ ++this.nodeNamesUsed[b]:(this.nodeNamesUsed[b]=0,b)}loadGeometries(_){const b=this,$=this.extensions,ee=this.primitiveCache;function re(xe){return $[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(xe,b).then(function(le){return addPrimitiveAttributes(le,xe,b)})}const ae=[];for(let xe=0,le=_.length;xe<le;xe++){const fe=_[xe],ve=createPrimitiveKey(fe),Se=ee[ve];if(Se)ae.push(Se.promise);else{let Ee;fe.extensions&&fe.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]?Ee=re(fe):Ee=addPrimitiveAttributes(new BufferGeometry,fe,b),ee[ve]={primitive:fe,promise:Ee},ae.push(Ee)}}return Promise.all(ae)}loadMesh(_){const b=this,$=this.json,ee=this.extensions,re=$.meshes[_],ae=re.primitives,xe=[];for(let le=0,fe=ae.length;le<fe;le++){const ve=ae[le].material===void 0?createDefaultMaterial(this.cache):this.getDependency("material",ae[le].material);xe.push(ve)}return xe.push(b.loadGeometries(ae)),Promise.all(xe).then(function(le){const fe=le.slice(0,le.length-1),ve=le[le.length-1],Se=[];for(let Ce=0,Ie=ve.length;Ce<Ie;Ce++){const De=ve[Ce],Be=ae[Ce];let Ne;const qe=fe[Ce];if(Be.mode===WEBGL_CONSTANTS.TRIANGLES||Be.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP||Be.mode===WEBGL_CONSTANTS.TRIANGLE_FAN||Be.mode===void 0)Ne=re.isSkinnedMesh===!0?new SkinnedMesh(De,qe):new Mesh(De,qe),Ne.isSkinnedMesh===!0&&Ne.normalizeSkinWeights(),Be.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP?Ne.geometry=toTrianglesDrawMode(Ne.geometry,TriangleStripDrawMode):Be.mode===WEBGL_CONSTANTS.TRIANGLE_FAN&&(Ne.geometry=toTrianglesDrawMode(Ne.geometry,TriangleFanDrawMode));else if(Be.mode===WEBGL_CONSTANTS.LINES)Ne=new LineSegments(De,qe);else if(Be.mode===WEBGL_CONSTANTS.LINE_STRIP)Ne=new Line(De,qe);else if(Be.mode===WEBGL_CONSTANTS.LINE_LOOP)Ne=new LineLoop(De,qe);else if(Be.mode===WEBGL_CONSTANTS.POINTS)Ne=new Points(De,qe);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Be.mode);Object.keys(Ne.geometry.morphAttributes).length>0&&updateMorphTargets(Ne,re),Ne.name=b.createUniqueName(re.name||"mesh_"+_),assignExtrasToUserData(Ne,re),Be.extensions&&addUnknownExtensionsToUserData(ee,Ne,Be),b.assignFinalMaterial(Ne),Se.push(Ne)}for(let Ce=0,Ie=Se.length;Ce<Ie;Ce++)b.associations.set(Se[Ce],{meshes:_,primitives:Ce});if(Se.length===1)return re.extensions&&addUnknownExtensionsToUserData(ee,Se[0],re),Se[0];const Ee=new Group;re.extensions&&addUnknownExtensionsToUserData(ee,Ee,re),b.associations.set(Ee,{meshes:_});for(let Ce=0,Ie=Se.length;Ce<Ie;Ce++)Ee.add(Se[Ce]);return Ee})}loadCamera(_){let b;const $=this.json.cameras[_],ee=$[$.type];if(!ee){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return $.type==="perspective"?b=new PerspectiveCamera(MathUtils.radToDeg(ee.yfov),ee.aspectRatio||1,ee.znear||1,ee.zfar||2e6):$.type==="orthographic"&&(b=new OrthographicCamera(-ee.xmag,ee.xmag,ee.ymag,-ee.ymag,ee.znear,ee.zfar)),$.name&&(b.name=this.createUniqueName($.name)),assignExtrasToUserData(b,$),Promise.resolve(b)}loadSkin(_){const b=this.json.skins[_],$=[];for(let ee=0,re=b.joints.length;ee<re;ee++)$.push(this._loadNodeShallow(b.joints[ee]));return b.inverseBindMatrices!==void 0?$.push(this.getDependency("accessor",b.inverseBindMatrices)):$.push(null),Promise.all($).then(function(ee){const re=ee.pop(),ae=ee,xe=[],le=[];for(let fe=0,ve=ae.length;fe<ve;fe++){const Se=ae[fe];if(Se){xe.push(Se);const Ee=new Matrix4;re!==null&&Ee.fromArray(re.array,fe*16),le.push(Ee)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',b.joints[fe])}return new Skeleton(xe,le)})}loadAnimation(_){const b=this.json,$=this,ee=b.animations[_],re=ee.name?ee.name:"animation_"+_,ae=[],xe=[],le=[],fe=[],ve=[];for(let Se=0,Ee=ee.channels.length;Se<Ee;Se++){const Ce=ee.channels[Se],Ie=ee.samplers[Ce.sampler],De=Ce.target,Be=De.node,Ne=ee.parameters!==void 0?ee.parameters[Ie.input]:Ie.input,qe=ee.parameters!==void 0?ee.parameters[Ie.output]:Ie.output;De.node!==void 0&&(ae.push(this.getDependency("node",Be)),xe.push(this.getDependency("accessor",Ne)),le.push(this.getDependency("accessor",qe)),fe.push(Ie),ve.push(De))}return Promise.all([Promise.all(ae),Promise.all(xe),Promise.all(le),Promise.all(fe),Promise.all(ve)]).then(function(Se){const Ee=Se[0],Ce=Se[1],Ie=Se[2],De=Se[3],Be=Se[4],Ne=[];for(let qe=0,Xe=Ee.length;qe<Xe;qe++){const Ye=Ee[qe],Qe=Ce[qe],rt=Ie[qe],ot=De[qe],ct=Be[qe];if(Ye===void 0)continue;Ye.updateMatrix&&Ye.updateMatrix();const mt=$._createAnimationTracks(Ye,Qe,rt,ot,ct);if(mt)for(let _t=0;_t<mt.length;_t++)Ne.push(mt[_t])}return new AnimationClip(re,void 0,Ne)})}createNodeMesh(_){const b=this.json,$=this,ee=b.nodes[_];return ee.mesh===void 0?null:$.getDependency("mesh",ee.mesh).then(function(re){const ae=$._getNodeRef($.meshCache,ee.mesh,re);return ee.weights!==void 0&&ae.traverse(function(xe){if(xe.isMesh)for(let le=0,fe=ee.weights.length;le<fe;le++)xe.morphTargetInfluences[le]=ee.weights[le]}),ae})}loadNode(_){const b=this.json,$=this,ee=b.nodes[_],re=$._loadNodeShallow(_),ae=[],xe=ee.children||[];for(let fe=0,ve=xe.length;fe<ve;fe++)ae.push($.getDependency("node",xe[fe]));const le=ee.skin===void 0?Promise.resolve(null):$.getDependency("skin",ee.skin);return Promise.all([re,Promise.all(ae),le]).then(function(fe){const ve=fe[0],Se=fe[1],Ee=fe[2];Ee!==null&&ve.traverse(function(Ce){Ce.isSkinnedMesh&&Ce.bind(Ee,_identityMatrix)});for(let Ce=0,Ie=Se.length;Ce<Ie;Ce++)ve.add(Se[Ce]);return ve})}_loadNodeShallow(_){const b=this.json,$=this.extensions,ee=this;if(this.nodeCache[_]!==void 0)return this.nodeCache[_];const re=b.nodes[_],ae=re.name?ee.createUniqueName(re.name):"",xe=[],le=ee._invokeOne(function(fe){return fe.createNodeMesh&&fe.createNodeMesh(_)});return le&&xe.push(le),re.camera!==void 0&&xe.push(ee.getDependency("camera",re.camera).then(function(fe){return ee._getNodeRef(ee.cameraCache,re.camera,fe)})),ee._invokeAll(function(fe){return fe.createNodeAttachment&&fe.createNodeAttachment(_)}).forEach(function(fe){xe.push(fe)}),this.nodeCache[_]=Promise.all(xe).then(function(fe){let ve;if(re.isBone===!0?ve=new Bone:fe.length>1?ve=new Group:fe.length===1?ve=fe[0]:ve=new Object3D,ve!==fe[0])for(let Se=0,Ee=fe.length;Se<Ee;Se++)ve.add(fe[Se]);if(re.name&&(ve.userData.name=re.name,ve.name=ae),assignExtrasToUserData(ve,re),re.extensions&&addUnknownExtensionsToUserData($,ve,re),re.matrix!==void 0){const Se=new Matrix4;Se.fromArray(re.matrix),ve.applyMatrix4(Se)}else re.translation!==void 0&&ve.position.fromArray(re.translation),re.rotation!==void 0&&ve.quaternion.fromArray(re.rotation),re.scale!==void 0&&ve.scale.fromArray(re.scale);return ee.associations.has(ve)||ee.associations.set(ve,{}),ee.associations.get(ve).nodes=_,ve}),this.nodeCache[_]}loadScene(_){const b=this.extensions,$=this.json.scenes[_],ee=this,re=new Group;$.name&&(re.name=ee.createUniqueName($.name)),assignExtrasToUserData(re,$),$.extensions&&addUnknownExtensionsToUserData(b,re,$);const ae=$.nodes||[],xe=[];for(let le=0,fe=ae.length;le<fe;le++)xe.push(ee.getDependency("node",ae[le]));return Promise.all(xe).then(function(le){for(let ve=0,Se=le.length;ve<Se;ve++)re.add(le[ve]);const fe=ve=>{const Se=new Map;for(const[Ee,Ce]of ee.associations)(Ee instanceof Material||Ee instanceof Texture)&&Se.set(Ee,Ce);return ve.traverse(Ee=>{const Ce=ee.associations.get(Ee);Ce!=null&&Se.set(Ee,Ce)}),Se};return ee.associations=fe(re),re})}_createAnimationTracks(_,b,$,ee,re){const ae=[],xe=_.name?_.name:_.uuid,le=[];PATH_PROPERTIES[re.path]===PATH_PROPERTIES.weights?_.traverse(function(Ee){Ee.morphTargetInfluences&&le.push(Ee.name?Ee.name:Ee.uuid)}):le.push(xe);let fe;switch(PATH_PROPERTIES[re.path]){case PATH_PROPERTIES.weights:fe=NumberKeyframeTrack;break;case PATH_PROPERTIES.rotation:fe=QuaternionKeyframeTrack;break;case PATH_PROPERTIES.position:case PATH_PROPERTIES.scale:fe=VectorKeyframeTrack;break;default:switch($.itemSize){case 1:fe=NumberKeyframeTrack;break;case 2:case 3:default:fe=VectorKeyframeTrack;break}break}const ve=ee.interpolation!==void 0?INTERPOLATION[ee.interpolation]:InterpolateLinear,Se=this._getArrayFromAccessor($);for(let Ee=0,Ce=le.length;Ee<Ce;Ee++){const Ie=new fe(le[Ee]+"."+PATH_PROPERTIES[re.path],b.array,Se,ve);ee.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(Ie),ae.push(Ie)}return ae}_getArrayFromAccessor(_){let b=_.array;if(_.normalized){const $=getNormalizedComponentScale(b.constructor),ee=new Float32Array(b.length);for(let re=0,ae=b.length;re<ae;re++)ee[re]=b[re]*$;b=ee}return b}_createCubicSplineTrackInterpolant(_){_.createInterpolant=function($){const ee=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new ee(this.times,this.values,this.getValueSize()/3,$)},_.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function computeBounds(H,_,b){const $=_.attributes,ee=new Box3;if($.POSITION!==void 0){const xe=b.json.accessors[$.POSITION],le=xe.min,fe=xe.max;if(le!==void 0&&fe!==void 0){if(ee.set(new Vector3(le[0],le[1],le[2]),new Vector3(fe[0],fe[1],fe[2])),xe.normalized){const ve=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[xe.componentType]);ee.min.multiplyScalar(ve),ee.max.multiplyScalar(ve)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const re=_.targets;if(re!==void 0){const xe=new Vector3,le=new Vector3;for(let fe=0,ve=re.length;fe<ve;fe++){const Se=re[fe];if(Se.POSITION!==void 0){const Ee=b.json.accessors[Se.POSITION],Ce=Ee.min,Ie=Ee.max;if(Ce!==void 0&&Ie!==void 0){if(le.setX(Math.max(Math.abs(Ce[0]),Math.abs(Ie[0]))),le.setY(Math.max(Math.abs(Ce[1]),Math.abs(Ie[1]))),le.setZ(Math.max(Math.abs(Ce[2]),Math.abs(Ie[2]))),Ee.normalized){const De=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[Ee.componentType]);le.multiplyScalar(De)}xe.max(le)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}ee.expandByVector(xe)}H.boundingBox=ee;const ae=new Sphere;ee.getCenter(ae.center),ae.radius=ee.min.distanceTo(ee.max)/2,H.boundingSphere=ae}function addPrimitiveAttributes(H,_,b){const $=_.attributes,ee=[];function re(ae,xe){return b.getDependency("accessor",ae).then(function(le){H.setAttribute(xe,le)})}for(const ae in $){const xe=ATTRIBUTES[ae]||ae.toLowerCase();xe in H.attributes||ee.push(re($[ae],xe))}if(_.indices!==void 0&&!H.index){const ae=b.getDependency("accessor",_.indices).then(function(xe){H.setIndex(xe)});ee.push(ae)}return ColorManagement.workingColorSpace!==LinearSRGBColorSpace&&"COLOR_0"in $&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${ColorManagement.workingColorSpace}" not supported.`),assignExtrasToUserData(H,_),computeBounds(H,_,b),Promise.all(ee).then(function(){return _.targets!==void 0?addMorphTargets(H,_.targets,b):H})}class RGBELoader extends DataTextureLoader{constructor(_){super(_),this.type=HalfFloatType}parse(_){const ae=function(ct,mt){switch(ct){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(mt||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(mt||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(mt||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(mt||""))}},ve=`
`,Se=function(ct,mt,_t){mt=mt||1024;let Vt=ct.pos,Gt=-1,$t=0,Qt="",vt=String.fromCharCode.apply(null,new Uint16Array(ct.subarray(Vt,Vt+128)));for(;0>(Gt=vt.indexOf(ve))&&$t<mt&&Vt<ct.byteLength;)Qt+=vt,$t+=vt.length,Vt+=128,vt+=String.fromCharCode.apply(null,new Uint16Array(ct.subarray(Vt,Vt+128)));return-1<Gt?(ct.pos+=$t+Gt+1,Qt+vt.slice(0,Gt)):!1},Ee=function(ct){const mt=/^#\?(\S+)/,_t=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,Lt=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,Vt=/^\s*FORMAT=(\S+)\s*$/,Gt=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,$t={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let Qt,vt;for((ct.pos>=ct.byteLength||!(Qt=Se(ct)))&&ae(1,"no header found"),(vt=Qt.match(mt))||ae(3,"bad initial token"),$t.valid|=1,$t.programtype=vt[1],$t.string+=Qt+`
`;Qt=Se(ct),Qt!==!1;){if($t.string+=Qt+`
`,Qt.charAt(0)==="#"){$t.comments+=Qt+`
`;continue}if((vt=Qt.match(_t))&&($t.gamma=parseFloat(vt[1])),(vt=Qt.match(Lt))&&($t.exposure=parseFloat(vt[1])),(vt=Qt.match(Vt))&&($t.valid|=2,$t.format=vt[1]),(vt=Qt.match(Gt))&&($t.valid|=4,$t.height=parseInt(vt[1],10),$t.width=parseInt(vt[2],10)),$t.valid&2&&$t.valid&4)break}return $t.valid&2||ae(3,"missing format specifier"),$t.valid&4||ae(3,"missing image size specifier"),$t},Ce=function(ct,mt,_t){const Lt=mt;if(Lt<8||Lt>32767||ct[0]!==2||ct[1]!==2||ct[2]&128)return new Uint8Array(ct);Lt!==(ct[2]<<8|ct[3])&&ae(3,"wrong scanline width");const Vt=new Uint8Array(4*mt*_t);Vt.length||ae(4,"unable to allocate buffer space");let Gt=0,$t=0;const Qt=4*Lt,vt=new Uint8Array(4),It=new Uint8Array(Qt);let gt=_t;for(;gt>0&&$t<ct.byteLength;){$t+4>ct.byteLength&&ae(1),vt[0]=ct[$t++],vt[1]=ct[$t++],vt[2]=ct[$t++],vt[3]=ct[$t++],(vt[0]!=2||vt[1]!=2||(vt[2]<<8|vt[3])!=Lt)&&ae(3,"bad rgbe scanline format");let Tt=0,Ct;for(;Tt<Qt&&$t<ct.byteLength;){Ct=ct[$t++];const sn=Ct>128;if(sn&&(Ct-=128),(Ct===0||Tt+Ct>Qt)&&ae(3,"bad scanline data"),sn){const cn=ct[$t++];for(let en=0;en<Ct;en++)It[Tt++]=cn}else It.set(ct.subarray($t,$t+Ct),Tt),Tt+=Ct,$t+=Ct}const Ft=Lt;for(let sn=0;sn<Ft;sn++){let cn=0;Vt[Gt]=It[sn+cn],cn+=Lt,Vt[Gt+1]=It[sn+cn],cn+=Lt,Vt[Gt+2]=It[sn+cn],cn+=Lt,Vt[Gt+3]=It[sn+cn],Gt+=4}gt--}return Vt},Ie=function(ct,mt,_t,Lt){const Vt=ct[mt+3],Gt=Math.pow(2,Vt-128)/255;_t[Lt+0]=ct[mt+0]*Gt,_t[Lt+1]=ct[mt+1]*Gt,_t[Lt+2]=ct[mt+2]*Gt,_t[Lt+3]=1},De=function(ct,mt,_t,Lt){const Vt=ct[mt+3],Gt=Math.pow(2,Vt-128)/255;_t[Lt+0]=DataUtils.toHalfFloat(Math.min(ct[mt+0]*Gt,65504)),_t[Lt+1]=DataUtils.toHalfFloat(Math.min(ct[mt+1]*Gt,65504)),_t[Lt+2]=DataUtils.toHalfFloat(Math.min(ct[mt+2]*Gt,65504)),_t[Lt+3]=DataUtils.toHalfFloat(1)},Be=new Uint8Array(_);Be.pos=0;const Ne=Ee(Be),qe=Ne.width,Xe=Ne.height,Ye=Ce(Be.subarray(Be.pos),qe,Xe);let Qe,rt,ot;switch(this.type){case FloatType:ot=Ye.length/4;const ct=new Float32Array(ot*4);for(let _t=0;_t<ot;_t++)Ie(Ye,_t*4,ct,_t*4);Qe=ct,rt=FloatType;break;case HalfFloatType:ot=Ye.length/4;const mt=new Uint16Array(ot*4);for(let _t=0;_t<ot;_t++)De(Ye,_t*4,mt,_t*4);Qe=mt,rt=HalfFloatType;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:qe,height:Xe,data:Qe,header:Ne.string,gamma:Ne.gamma,exposure:Ne.exposure,type:rt}}setDataType(_){return this.type=_,this}load(_,b,$,ee){function re(ae,xe){switch(ae.type){case FloatType:case HalfFloatType:ae.colorSpace=LinearSRGBColorSpace,ae.minFilter=LinearFilter,ae.magFilter=LinearFilter,ae.generateMipmaps=!1,ae.flipY=!0;break}b&&b(ae,xe)}return super.load(_,re,$,ee)}}class AvatarRenderer extends Ap{constructor(_,b,$,ee="onesie.glb",re){super(_,b,$),this.url=ee,this.outfit=re,this.lightInt=.75,this.ambientInt=1.25,this.handsUp=!1,this.plugin=new Ax(void 0,re),this.addPlugin(this.plugin)}async load(){if(!(this.loaded||!this.scene))return await this.setupScene(this.scene),super.load()}async setupScene(_){await this.setModel(this.url),this.light=new PointLight(16777215,this.lightInt),this.ambient=new AmbientLight(16777215,this.ambientInt),_.add(this.light),_.add(this.ambient);const b=await new RGBELoader().loadAsync("environment.hdr");b.mapping=EquirectangularReflectionMapping,_.environment=b}async setModel(_){return this.setOutfit(_,this.outfit)}async setOutfit(_,b){var ee;this.model&&this.disposeObject(this.model),delete this.model,this.url=_,this.outfit=b;const $=await new GLTFLoader().loadAsync(_);this.model=$.scene,(ee=this.scene)==null||ee.add(this.model),this.plugin.setOutfit(this.model,b)}async update(_,b){const $=_.poses[0];if(!$)return this.handsUp=!1,super.update(_,b);const{points:ee}=$,re=new Vector3(...ee.hipL.metric),ae=new Vector3(...ee.hipR.metric),xe=new Vector3(...ee.shoulderL.metric),le=new Vector3(...ee.shoulderR.metric),fe=new Vector3(...ee.elbowL.metric),ve=new Vector3(...ee.elbowR.metric),Se=new Vector3(...ee.wristL.metric),Ee=new Vector3(...ee.wristR.metric),Ce=xe.clone().sub(re).normalize(),Ie=le.clone().sub(ae).normalize(),De=fe.clone().sub(xe).normalize(),Be=ve.clone().sub(le).normalize(),Ne=Se.clone().sub(fe).normalize(),qe=Ee.clone().sub(ve).normalize(),Xe=Ce.dot(De),Ye=Ie.dot(Be),Qe=Ne.dot(De),rt=qe.dot(Be),ot=Math.min(Xe,Ye,Qe,rt);ot>.8&&(this.handsUp=!0),ot<.7&&(this.handsUp=!1);const{textModel:ct}=this;if(ct){const mt=Se.clone().lerp(Ee,.5);ct.position.copy(mt),ct.visible=this.handsUp}await super.update(_,b)}}const overlays="_overlays_g7d93_1",topLeft="_topLeft_g7d93_6",center="_center_g7d93_15",bottom="_bottom_g7d93_35",genSelect="_genSelect_g7d93_52",styles={overlays,topLeft,center,bottom,genSelect},male1=""+new URL("male1-BbWGIPEZ.png",import.meta.url).href,male2=""+new URL("male2-CsXxEztU.png",import.meta.url).href,male3=""+new URL("male3-BfVmNSF9.png",import.meta.url).href,male4=""+new URL("male4-qfsb-kog.png",import.meta.url).href,male5=""+new URL("male5-B3haZ7Cg.png",import.meta.url).href,female1=""+new URL("female1-DZ90cC4f.png",import.meta.url).href,female2=""+new URL("female2-CHtMJ4fZ.png",import.meta.url).href,female3=""+new URL("female3-BLCnYi3i.png",import.meta.url).href,female4=""+new URL("female4-DUlrGqHM.png",import.meta.url).href,female5=""+new URL("female5-OTXtyGeT.png",import.meta.url).href,glasses=""+new URL("glasses-RclWnkYi.png",import.meta.url).href,cap=""+new URL("cap-BHwYsadk.png",import.meta.url).href;class HatRenderer extends Ao{constructor(_,b){super(_,b),this.lightInt=1,this.ambientInt=3,this.mouthOpenness=0,this.mouthOpen=!1}async load(){this.loaded||!this.scene||(await this.setupScene(this.scene),await super.load())}async setupScene(_){const b=localStorage.getItem("accry")||"hat",$=await new GLTFLoader().loadAsync(`${b}.glb`);_.add($.scene),this.hat=_.getObjectByName("HeadTrack"),this.hat&&this.addPlugin(new Ay(this.hat,!0)),this.head=_.getObjectByName("HeadOccluder"),this.head&&this.addPlugin(new R7(this.head)),this.light=new PointLight(16777215,this.lightInt),this.ambient=new AmbientLight(16777215,this.ambientInt),this.camera.add(this.light),_.add(this.ambient),this.renderer.outputColorSpace=SRGBColorSpace;const ee=await new RGBELoader().loadAsync("environment.hdr");_.environment=ee}}function ARViewDebug({setCamImg:H,setCurrentState:_,retake:b=!1}){const[$,ee]=reactExports.useState(localStorage.getItem("genderSelect")),[re,ae]=reactExports.useState(b),xe=reactExports.useRef(null),le=reactExports.useRef(null),[fe,ve]=reactExports.useState(null),[Se,Ee]=reactExports.useState(!1),[Ce,Ie]=reactExports.useState({top:"",bottom:""}),De=location.hostname==="polite-salmiakki-1dc3f3.netlify.app"?"UMl-KTNDeZS-B38sk9J2cycGOm-2xlTK":"HiCltgzsHoEwIl02FxcrdhLy6wdabBmY",Be=location.hostname==="localhost"?"oRm1uD9WehOrYfpvyol489z9rXDHpukL":De;reactExports.useEffect(()=>{const mt=new Z;let _t=!1;async function Lt(){const Vt=document.getElementById("webarFace");if(!Vt)return;const Gt=new HatRenderer(Vt,"crop");Gt.setMirror(!0),xe.current=new bm(Gt),await Promise.all([mt.addRenderer(Gt),mt.init({token:Be,transform:!0,metric:!0})]),await mt.setup({size:{width:1920,height:1080},rear:_t}),await mt.start()}Se&&(document.getElementById("engeenee.canvas.layer0")&&(document.querySelectorAll('[id="engeenee.canvas.layer1"]').forEach(Gt=>Gt.remove()),document.querySelectorAll('[id="engeenee.canvas.layer0"]').forEach(Gt=>Gt.remove())),document.getElementById("webarFace").style.display="flex",Lt())},[Se]),reactExports.useEffect(()=>{const mt=new z;let _t=!1;const Lt={onesie:{file:"onesie.glb",avatar:!1,outfit:{occluders:[/Head$/,/Body/]}}};let Vt="onesie",Gt=!1;function $t(){const vt=document.createElement("div");vt.className="boxes",vt.id="spinner";for(let It=0;It<4;It++){const gt=document.createElement("div");gt.className="box";for(let Tt=0;Tt<4;Tt++)gt.appendChild(document.createElement("div"));vt.appendChild(gt)}return vt}async function Qt(){const vt=document.getElementById("webar");if(!vt)return;const It=new AvatarRenderer(vt,"crop",!0,Lt[Vt].file,Gt?void 0:Lt[Vt].outfit);le.current=It;const gt=document.getElementsByName("model");gt.forEach(Ct=>{Ct.onchange=async()=>{if(Ct.checked&&Lt[Ct.value]){gt.forEach(sn=>{sn.disabled=!0});const Ft=$t();document.body.appendChild(Ft),Vt=Ct.value,Gt=Lt[Vt].avatar,await It.setOutfit(Lt[Vt].file,Gt?void 0:Lt[Vt].outfit),document.body.removeChild(Ft),gt.forEach(sn=>{sn.disabled=!1})}}}),await Promise.all([mt.addRenderer(It),mt.init({token:Be})]),await mt.setup({size:{width:1920,height:1080},rear:_t}),await mt.start(),xe.current=new bm(It);const Tt=document.getElementById("loadui");Tt&&Tt.remove()}return Se||Qt(),()=>{document.getElementById("engeenee.canvas.layer0")&&(document.querySelectorAll('[id="engeenee.canvas.layer1"]').forEach(It=>It.remove()),document.querySelectorAll('[id="engeenee.canvas.layer0"]').forEach(It=>It.remove()))}},[Se]);const Ne=async()=>{const mt=await xe.current.snapshot();if(mt){const _t=window.innerWidth,Lt=window.innerHeight,Vt=_t/Lt,Gt=mt.width,$t=mt.height,Qt=Gt/$t;let vt,It;Qt>Vt?(It=$t,vt=It*Vt):(vt=Gt,It=vt/Vt);const gt=(Gt-vt)/2,Tt=($t-It)/2,Ct=document.createElement("canvas");Ct.width=vt,Ct.height=It;const Ft=Ct.getContext("2d"),sn=document.createElement("canvas");sn.width=Gt,sn.height=$t,sn.getContext("2d").putImageData(mt,0,0),Ft.drawImage(sn,gt,Tt,vt,It,0,0,vt,It);const en=document.createElement("canvas");en.width=_t,en.height=Lt;const yn=en.getContext("2d");yn.translate(_t,0),yn.scale(-1,1),yn.drawImage(Ct,0,0,vt,It,0,0,_t,Lt);const Pn=en.toDataURL("image/png");H(Pn),_(2)}};reactExports.useEffect(()=>{if($!==null){const mt=document.getElementById("engeenee.canvas.layer1");mt&&(mt.style.visibility="hidden")}},[]);const qe=(mt=!0,_t=5e3,Lt=!0)=>{setTimeout(()=>{const Vt=document.getElementById("engeenee.canvas.layer1");Vt&&(Vt.style.visibility=mt===!0?"visible":"hidden"),Lt&&ae(mt)},_t)},Xe=()=>{const{top:mt,bottom:_t}=Ce;if(!mt.length&&!_t.length)return"";if(!mt)return`${_t}.glb`;if(!_t)return`${mt}.glb`;if(mt.length&&_t.length)switch(`${mt} ${_t}`){case"Jacket Jeans":return"JacketJeans.glb";case"Jacket Trouser":return"JacketTrouser.glb";case"BlueTshirt Jeans":return"BlueTshirtJeans.glb";case"BlueTshirt Trouser":return"BlueTshirtTrouser.glb";case"RedTshirt Jeans":return"RedTshirtJeans.glb";case"RedTshirt Trouser":return"RedTshirtTrouser.glb";case"waistcoat BlueJeans":return"waistcoatBlueJeans.glb";case"waistcoat GreyPant":return"waistcoatGreyPant.glb";case"coat BlueJeans":return"coatBlueJeans.glb";case"coat GreyPant":return"coatGreyPant.glb";case"Blazer BlueJeans":return"BlazerBlueJeans.glb";case"Blazer GreyPant":return"BlazerGreyPant.glb";default:return"onesie.glb"}};reactExports.useEffect(()=>{Ce.top.length||Ce.bottom.length?(async()=>{const _t=Xe();_t&&(qe(!0),await le.current.setOutfit(_t,{occluders:[/Head$/,/Body/]}))})():document.getElementById("engeenee.canvas.layer1")&&document.querySelectorAll('[id="engeenee.canvas.layer1"]').forEach(_t=>_t.style.visibility="hidden")},[Ce.top,Ce.bottom]);const rt=$==="male"?[{icon:male1,file:"onesie.glb",name:"Jacket",modelName:"Jacket",type:"top"},{icon:male3,file:"onesie.glb",name:"Tee",modelName:"BlueTshirt",type:"top"},{icon:male4,file:"onesie.glb",name:"Tee",modelName:"RedTshirt",type:"top"},{icon:male2,file:"jacket.glb",name:"Jeans",modelName:"Jeans",type:"bottom"},{icon:male5,file:"onesie.glb",name:"Trouser",modelName:"Trouser",type:"bottom"}]:[{icon:female1,file:"onesie.glb",name:"Waistcoat",modelName:"waistcoat",type:"top"},{icon:female2,file:"jacket.glb",name:"Blazer",modelName:"coat",type:"top"},{icon:female5,file:"onesie.glb",name:"Coat",modelName:"Blazer",type:"top"},{icon:female3,file:"onesie.glb",name:"Jeans",modelName:"BlueJeans",type:"bottom"},{icon:female4,file:"onesie.glb",name:"Trouser",modelName:"GreyPant",type:"bottom"}],ot=(mt,_t)=>{localStorage.removeItem("accry"),document.getElementById("webarFace").style.display="none",document.getElementById("engeenee.canvas.layer0")&&Se&&(document.querySelectorAll('[id="engeenee.canvas.layer1"]').forEach(Gt=>Gt.remove()),document.querySelectorAll('[id="engeenee.canvas.layer0"]').forEach(Gt=>Gt.remove())),Ee("");const Vt=Ce[mt]===_t;Ie(Vt?{...Ce,[mt]:""}:{...Ce,[mt]:_t})},ct=!Se&&!Ce.top&&!Ce.bottom;return React.createElement(React.Fragment,null,React.createElement("div",{className:styles.overlays,style:{padding:pixelsToVH(40)}},fe>0?React.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:pixelsToVH(200),color:"#fff",filter:"drop-shadow(2px 4px 6px black)"}},fe):null,React.createElement("div",{className:styles.topLeft,style:{width:pixelsToVW(290),right:pixelsToVH(40)}},React.createElement("img",{src:yts,alt:"ytShopping"})),re?null:React.createElement("div",{className:styles.center,id:"infoBox",style:{width:pixelsToVW(566),zIndex:2,padding:`${pixelsToVH(30)} ${pixelsToVW(30)}`}},React.createElement("img",{src:bagRight,alt:"bag",style:{width:pixelsToVW(100),aspectRatio:1,top:pixelsToVH(-8)}}),$?null:React.createElement("div",{style:{fontSize:pixelsToVH(42),fontWeight:"bold",textTransform:"uppercase",margin:`${pixelsToVH(20)} 0`}},"Youre On Screen!"),React.createElement("div",{style:{fontSize:pixelsToVH(27),margin:pixelsToVH($?20:0),textAlign:"center"}},$?"Stand straight and align yourself within the foot marker for best fit.":"Use the panel below to select your look.")),re?React.createElement("div",{style:{display:"flex",alignItems:"center",position:"absolute",width:`calc(100% - ${pixelsToVH(80)})`,justifyContent:"space-between",bottom:pixelsToVH(150)}},React.createElement("div",{className:styles.backBtn,onClick:()=>{setTimeout(()=>{let mt=document.getElementById("genselect");mt&&(mt.style.display="flex"),document.getElementById("engeenee.canvas.layer1")&&document.querySelectorAll('[id="engeenee.canvas.layer1"]').forEach(Lt=>Lt.style.visibility="hidden"),ee(""),Ie({top:"",bottom:""}),ae(!1)},0)},style:{width:pixelsToVW(170)}},React.createElement("img",{src:back,alt:"back",style:{height:"100%",width:"100%",objectFit:"contain"}})),React.createElement("div",{className:styles.captureBtn,onClick:()=>{ve(3);const mt=setInterval(()=>{ve(_t=>_t===1?(clearInterval(mt),Ne(),null):_t-1)},1e3)},style:{width:pixelsToVW(254),opacity:ct?.5:1}},React.createElement("img",{src:capture,alt:"capture",style:{height:"100%",width:"100%",objectFit:"contain"}})),React.createElement("div",{style:{width:pixelsToVW(170),visibility:"hidden"}})):React.createElement("div",{id:"genselect",className:styles.bottom,style:{height:pixelsToVH(244.9638671875),width:pixelsToVW(608.64453125),borderRadius:pixelsToVH(20),fontSize:pixelsToVH(42)}},"Select a gender",React.createElement("div",{className:styles.genSelect},React.createElement("button",{onClick:()=>{ee("male"),localStorage.setItem("genderSelect","male"),setTimeout(()=>{let mt=document.getElementById("genselect");mt&&(mt.style.display="none"),setTimeout(()=>{ae(!0)},5e3)},0)},style:{borderRadius:pixelsToVH(51),width:pixelsToVW(245),height:pixelsToVH(76),fontSize:pixelsToVH(31.4),background:$==="male"?"#FD0100":"#fff",color:$!=="male"?"#FD0100":"#fff"}},"Male"),React.createElement("button",{onClick:()=>{ee("female"),localStorage.setItem("genderSelect","female"),setTimeout(()=>{var mt=document.getElementById("genselect");mt&&(mt.style.display="none"),setTimeout(()=>{ae(!0)},5e3)},0)},style:{borderRadius:pixelsToVH(51),width:pixelsToVW(245),height:pixelsToVH(76),fontSize:pixelsToVH(31.4),background:$==="female"?"#FD0100":"#fff",color:$!=="female"?"#FD0100":"#fff"}},"Female"))),React.createElement("div",{className:"carousel",style:{visibility:re?"visible":"hidden",left:pixelsToVW(40)},id:"courosel"},React.createElement("div",{style:{display:"flex",justifyContent:"center",left:0,flexDirection:"column",gap:20}},rt.map((mt,_t)=>{const{icon:Lt,name:Vt,type:Gt,modelName:$t}=mt,Qt=$t===Ce[Gt];return React.createElement("div",{key:`${$t}-${_t}`,className:`${styles.item} carousel-item`,style:{height:pixelsToVH(185),width:pixelsToVW(151),padding:`${pixelsToVH(10)} ${pixelsToVW(10)}`,borderRadius:pixelsToVH(10),outlineWidth:Qt?pixelsToVH(8):0},onClick:()=>ot(Gt,$t)},React.createElement("img",{src:Lt,alt:Vt,style:{height:"auto",width:"100%",objectFit:"contain"}}),React.createElement("div",{style:{fontSize:pixelsToVH(14)}},Vt))})),React.createElement("div",{style:{display:"flex",gap:pixelsToVW(9)}},React.createElement("div",{className:`${styles.item} carousel-item`,style:{width:pixelsToVW(71),padding:`${pixelsToVH(5)} ${pixelsToVW(5)}`,borderRadius:pixelsToVH(10),flex:1,outlineWidth:Se==="glasses"?pixelsToVH(6):0},onClick:async()=>{Se!=="glasses"?(localStorage.setItem("accry","glasses"),Ie({top:"",bottom:""}),qe(!0),Ee("glasses")):(Ee(""),localStorage.removeItem("accry"))}},React.createElement("img",{src:glasses,alt:"glasses",style:{height:pixelsToVH(64),width:"100%",objectFit:"contain",aspectRatio:1}}),React.createElement("div",{style:{fontSize:pixelsToVH(14)}},"Glasses")),React.createElement("div",{className:`${styles.item} carousel-item`,style:{width:pixelsToVW(71),padding:`${pixelsToVH(5)} ${pixelsToVW(5)}`,borderRadius:pixelsToVH(10),flex:1,outlineWidth:Se==="cap"?pixelsToVH(6):0},onClick:async()=>{Se!=="cap"?(localStorage.setItem("accry","hat"),Ie({top:"",bottom:""}),qe(!0),Ee("cap")):(Ee(""),localStorage.removeItem("accry"))}},React.createElement("img",{src:cap,alt:"cap",style:{height:pixelsToVH(64),width:"100%",objectFit:"contain",aspectRatio:1}}),React.createElement("div",{style:{fontSize:pixelsToVH(14)}},"Cap"))))))}function pixelsToVW(H,_=1080){return H/_*100+"vw"}function pixelsToVH(H,_=1920){return H/_*100+"vh"}const App=()=>{const[H,_]=reactExports.useState(0),[b,$]=reactExports.useState(null),[ee,re]=reactExports.useState(!1);return reactExports.useEffect(()=>{!ee&&localStorage.removeItem("genderSelect")},[ee]),React.createElement(React.Fragment,null,H!==1?React.createElement("div",{className:styles$2.appWrapper,style:{textAlign:"center",flexDirection:"column",display:"flex",alignItems:"center",justifyContent:"center"}},H===0?React.createElement(Entry,{setCurrentState:_}):null,H===2?React.createElement(ResultPreview,{camImg:b,setCamImg:$,setRetake:re,setCurrentState:_}):null):null,H===1?React.createElement(ARViewDebug,{setCamImg:$,setCurrentState:_,retake:ee}):null)},container=document.getElementById("root"),root=clientExports.createRoot(container);root.render(React.createElement(App,null));
